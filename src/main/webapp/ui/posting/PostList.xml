<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">

	<head meta_screenName="채용공고 목록">
		<w2:type>COMPONENT</w2:type>
		<w2:buildDate />
		<w2:MSA />
		<xf:model>
			<w2:dataCollection baseNode="map">
				<!-- 공고 목록 조회용 -->
				<w2:dataMap baseNode="map" id="dmp_postVo" style="">
					<w2:keyInfo>
						<w2:key dataType="text" id="pageIndex" name="페이지_번호" defaultValue="1"></w2:key>
						<w2:key dataType="text" id="pageSize" name="페이지_건수" defaultValue="20"></w2:key>
					</w2:keyInfo>
					<w2:data use="false"></w2:data>
				</w2:dataMap>

				<!-- 공고 목록 데이터 -->
				<w2:dataList baseNode="list" id="dlt_postList" repeatNode="map" saveRemovedData="true" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="jobPostingId" name="job_posting_id"></w2:column>
						<w2:column dataType="text" id="companyId" name="company_id"></w2:column>
						<w2:column dataType="text" id="title" name="title"></w2:column>
						<w2:column dataType="text" id="description" name="description"></w2:column>
						<w2:column dataType="text" id="experienceLevel" name="experience_level"></w2:column>
						<w2:column dataType="text" id="salaryRange" name="salary_range"></w2:column>
						<w2:column dataType="text" id="location" name="location"></w2:column>
						<w2:column dataType="text" id="workType" name="work_type"></w2:column>
						<w2:column dataType="text" id="expiresAt" name="expires_at"></w2:column>
						<w2:column dataType="text" id="postedAt" name="posted_at"></w2:column>
						<w2:column dataType="text" id="status" name="status"></w2:column>
						<w2:column dataType="text" id="companyName" name="company_name"></w2:column>
						<w2:column dataType="text" id="industry" name="industry"></w2:column>
						<w2:column dataType="text" id="empCount" name="emp_count"></w2:column>
						<w2:column dataType="text" id="techStackNames" name="tech_stack_names"></w2:column>
						<w2:column dataType="text" id="preferredDeveloperTypes" name="preferred_developer_types"></w2:column>
					</w2:columnInfo>
				</w2:dataList>

				<!-- 개발자 MBTI 목록 데이터 -->
				<w2:dataList baseNode="list" id="dlt_devMbtiList" repeatNode="map" style="">
					<w2:columnInfo>
						<w2:column dataType="text" id="mbti" name="mbti"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dmp_postMatchVo">
					<w2:keyInfo>
						<w2:key dataType="text" name="페이지_번호" id="pageIndex" defaultValue="1"></w2:key>
						<w2:key defaultValue="20" dataType="text" name="페이지_건수" id="pageSize"></w2:key>
						<w2:key defaultValue="0" dataType="text" name="MBTI_매칭_필터" id="mbtiMatchFilter"></w2:key>
						<w2:key defaultValue="AAAA" dataType="text" name="유저_MBTI" id="userMbti"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection />

			<!-- 공고 목록 조회 Submission -->
			<xf:submission id="sbm_selectPostList" ref='data:json,{"id":"dmp_postVo","key":"postVo"}'
				target='data:json,{"id":"dlt_postList","key":"elData.postVoList"}' action="/InsWebApp/POS0001List.pwkjson" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="채용공고 목록을 조회중입니다." ev:submit="" ev:submitdone="scwin.sbm_selectPostList_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>

			<!-- 개발자 MBTI 목록 조회 Submission -->
			<xf:submission id="sbm_selectDevMbtiList" ref='data:json,{"id":"dmp_postMatchVo","key":"postMatchVo"}' target='data:json,{"id":"dlt_postList","key":"elData.postVoList"}'
				action="/InsWebApp/POS0004List.pwkjson" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg="개발자 MBTI 목록을 조회중입니다." ev:submit=""
				ev:submitdone="scwin.sbm_selectDevMbtiList_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		<w2:layoutInfo />
		<w2:publicInfo method="" />

		<style type="text/css"><![CDATA[

            .main-wrap {
                width: 100%;
                background-color: #ffffff;
            }

            /* 메인 컨텐츠 */
            .main-content {
                max-width: 1060px;
                margin: 0 auto;
                padding: 24px 20px;
            }

            /* 공고 목록 섹션 */
            .job-list-section {
                margin-bottom: 40px;
            }

            .section-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
            }

            .section-title {
                font-size: 24px;
                font-weight: 600;
                color: #333;
            }

            .job-count {
                font-size: 16px;
                color: #666;
            }

            .job-count .num {
                font-weight: 700;
                color: #36f;
                margin: 0 4px;
            }

            /* 공고 카드 스타일 */
            .job-cards {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 20px;
                margin-bottom: 40px;
            }

            .job-card {
                background: white;
                border-radius: 12px;
                overflow: hidden;
                cursor: pointer;
                transition: all 0.3s ease;
                border: 1px solid #e8e8e8;
                position: relative;
                box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            }

            .job-card:hover {
                transform: translateY(-4px);
                box-shadow: 0 12px 24px rgba(0,0,0,0.1);
                border-color: #36f;
            }

            .job-content {
                padding: 24px;
            }

            .job-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 16px;
            }

            .job-title {
                font-size: 18px;
                font-weight: 600;
                color: #333;
                margin-bottom: 8px;
                line-height: 1.4;
                flex: 1;
                margin-right: 12px;
            }

            .bookmark-btn {
                background: none;
                border: none;
                font-size: 20px;
                cursor: pointer;
                padding: 4px;
                border-radius: 4px;
                transition: all 0.2s;
            }

            .bookmark-btn:hover {
                background: #f8f9fa;
            }

            .job-company {
                font-size: 16px;
                color: #36f;
                font-weight: 500;
                margin-bottom: 8px;
                cursor: pointer;
            }

            .job-company:hover {
                text-decoration: underline;
            }

            .job-description {
                font-size: 14px;
                color: #666;
                margin-bottom: 16px;
                line-height: 1.5;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .job-meta {
                display: flex;
                flex-wrap: wrap;
                gap: 12px;
                margin-bottom: 16px;
            }

            .job-meta-item {
                display: flex;
                align-items: center;
                gap: 4px;
                font-size: 13px;
                color: #666;
            }

            .job-meta-icon {
                font-size: 14px;
                color: #999;
            }

            .tech-tags {
                display: flex;
                flex-wrap: wrap;
                gap: 6px;
                margin-bottom: 16px;
            }

            .tech-tag {
                background: #f1f5f9;
                color: #475569;
                font-size: 12px;
                padding: 4px 8px;
                border-radius: 6px;
                font-weight: 500;
            }

            .job-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding-top: 16px;
                border-top: 1px solid #f1f1f1;
            }

            .job-salary {
                font-size: 14px;
                font-weight: 600;
                color: #059669;
            }

            .job-date {
                font-size: 12px;
                color: #999;
            }

            /* 페이징 */
            .paging-section {
                display: flex;
                justify-content: center;
                margin-top: 40px;
            }

            .pgl {
                display: flex;
                gap: 8px;
            }

            /* 빈 상태 */
            .empty-state {
                text-align: center;
                padding: 80px 20px;
                color: #666;
            }

            .empty-icon {
                font-size: 48px;
                color: #ddd;
                margin-bottom: 16px;
            }

            .empty-message {
                font-size: 18px;
                font-weight: 500;
                margin-bottom: 8px;
            }

            .empty-submessage {
                font-size: 14px;
                color: #999;
            }

            /* 로딩 상태 */
            .loading-state {
                text-align: center;
                padding: 80px 20px;
                color: #666;
            }

            .loading-spinner {
                width: 40px;
                height: 40px;
                border: 4px solid #f3f3f3;
                border-top: 4px solid #36f;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin: 0 auto 16px;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            /* 반응형 디자인 */
            @media (max-width: 1024px) {
                .main-content {
                    padding: 16px;
                }

                .job-cards {
                    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
                    gap: 16px;
                }
            }

            @media (max-width: 768px) {
                .filter-section {
                    padding: 12px 16px;
                }

                .main-filters {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 12px;
                }

                .filter-tags {
                    overflow-x: auto;
                    flex-wrap: nowrap;
                    padding-bottom: 8px;
                }

                .job-cards {
                    grid-template-columns: 1fr;
                    gap: 16px;
                }

                .section-header {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 8px;
                }
            }
        ]]></style>

		<script lazy="false" type="text/javascript"><![CDATA[
scwin.onpageload = function () {
    // 페이지 로드 시 초기화
    console.log("채용공고 목록 페이지 로드");

    // 초기 공고 목록 조회
    scwin.loadPostList();

    // 로그인 하지 않았을 경우 
    scwin.checkUserStatusAndHideFilter();
};

/**
 * 공고 목록 조회
 */
scwin.loadPostList = function () {
    // 로딩 상태 표시
    scwin.showLoadingState();

    // 페이지 번호 초기화
    dmp_postVo.set("pageIndex", "1");

    // 서버통신 - 공고정보 조회
    $c.sbm.execute($p, sbm_selectPostList);
};

/**
 * 공고 목록 조회 완료
 */
scwin.sbm_selectPostList_submitdone = function (e) {
    console.log("=== 공고 목록 조회 완료 ===");
    console.log("응답 데이터:", e.responseJSON);

    // 로딩 상태 숨김
    scwin.hideLoadingState();

    // error 수신시
    var elData = e.responseJSON.elData;
    var elHeader = e.responseJSON.elHeader;
    if (elHeader == null || elHeader == "" || elHeader == "undefined" || elHeader.resSuc == false) {
        console.error("공고 목록 조회 에러:", elHeader);
        alert(`에러코드 : ${elHeader.resCode}\n에러메시지 : ${elHeader.resMsg}`);
        scwin.showEmptyState();
        return false;
    }

    // 데이터를 DataList에 셋팅
    dlt_postList.setJSON(elData.postVoList || []);

    // 공고 수 업데이트
    spn_jobCount.setLabel(elData.totalCount || 0);

    // 페이지 네비게이터 업데이트
    var totalPageCount = Math.ceil((elData.totalCount || 0) / dmp_postVo.get("pageSize"));
    if (pgl_postList) {
        pgl_postList.setCount(totalPageCount);
    }

    // 공고 카드 UI 동적 생성
    scwin.renderJobCards();
};

/**
 * 공고 카드 UI 동적 생성
 */
scwin.renderJobCards = function () {
    console.log("=== 공고 카드 UI 생성 ===");

    var jobCardsContainer = document.querySelector('.job-cards');
    if (!jobCardsContainer) {
        console.error("job-cards 컨테이너를 찾을 수 없습니다.");
        return;
    }

    // 기존 카드들 제거
    jobCardsContainer.innerHTML = '';

    var rowCount = dlt_postList.getRowCount();

    if (rowCount === 0) {
        scwin.showEmptyState();
        return;
    }

    // 각 공고에 대해 카드 생성
    for (var i = 0; i < rowCount; i++) {
        var jobData = dlt_postList.getRowJSON(i);
        var cardElement = scwin.createJobCard(jobData, i);
        jobCardsContainer.appendChild(cardElement);
    }

    console.log("✅ " + rowCount + "개 공고 카드 생성 완료");
};

/**
 * 개별 공고 카드 생성
 */
scwin.createJobCard = function (jobData, index) {
    var card = document.createElement('xf:group');
    card.className = 'job-card';
    card.setAttribute('data-job-id', jobData.jobPostingId);
    card.setAttribute('data-index', index);
    card.onclick = function () { scwin.openJobDetail(jobData.jobPostingId); };

    // 기술스택 태그 생성
    var techTags = '';
    if (jobData.techStackNames) {
        try {
            var techArray = JSON.parse(jobData.techStackNames);
            techTags = techArray.map(function (tech) {
                return '<span class="tech-tag">' + tech + '</span>';
            }).join('');
        } catch (e) {
            techTags = '<span class="tech-tag">정보없음</span>';
        }
    }

    // 선호 개발자 유형 태그 생성
    var developerTypeTags = '';
    if (jobData.preferredDeveloperTypes) {
        var devTypeArray = [];
        try {
            // JSON 배열로 파싱 시도
            devTypeArray = JSON.parse(jobData.preferredDeveloperTypes);
        } catch (e) {
            // JSON 파싱 실패 시 쉼표로 분리
            devTypeArray = jobData.preferredDeveloperTypes.split(',').map(function (item) { return item.trim(); });
        }

        if (Array.isArray(devTypeArray) && devTypeArray.length > 0) {
            developerTypeTags = devTypeArray.map(function (type) {
                return '<span class="tech-tag">' + type + '</span>';
            }).join('');
        } else {
            developerTypeTags = '<span class="tech-tag">정보없음</span>';
        }
    }

    card.innerHTML =
        '<xf:group class="job-content">' +
        '<xf:group class="job-header">' +
        '<xf:group class="job-title">' + (jobData.title || '제목없음') + '</xf:group>' +
        '<button class="bookmark-btn" onclick="scwin.toggleBookmark(event, \'' + jobData.jobPostingId + '\')">������</button>' +
        '</xf:group>' +
        '<xf:group class="job-company" onclick="scwin.viewCompany(event, \'' + jobData.companyId + '\')">' +
        (jobData.companyName || '회사명 정보없음') +
        '</xf:group>' +
        '<xf:group class="job-description">' +
        (jobData.description || '설명이 없습니다.') +
        '</xf:group>' +
        '<xf:group class="job-meta">' +
        '<xf:group class="job-meta-item">' +
        '<span class="job-meta-icon">������</span>' +
        '<span>' + (jobData.location || '지역정보없음') + '</span>' +
        '</xf:group>' +
        '<xf:group class="job-meta-item">' +
        '<span class="job-meta-icon">������</span>' +
        '<span>' + scwin.getExperienceLevelText(jobData.experienceLevel) + '</span>' +
        '</xf:group>' +
        '<xf:group class="job-meta-item">' +
        '<span class="job-meta-icon">������</span>' +
        '<span>' + scwin.getWorkTypeText(jobData.workType) + '</span>' +
        '</xf:group>' +
        '</xf:group>' +
        (techTags ? '<xf:group class="tech-tags">' + techTags + '</xf:group>' : '') +
        (developerTypeTags ? '<xf:group class="tech-tags">' + developerTypeTags + '</xf:group>' : '') +
        '<xf:group class="job-footer">' +
        '<xf:group class="job-salary">' + scwin.getSalaryRangeText(jobData.salaryRange) + '</xf:group>' +
        '<xf:group class="job-date">' + scwin.formatDate(jobData.postedAt) + '</xf:group>' +
        '</xf:group>' +
        '</xf:group>';

    return card;
};

/**
 * 로딩 상태 표시
 */
scwin.showLoadingState = function () {
    var jobCardsContainer = document.querySelector('.job-cards');
    if (jobCardsContainer) {
        jobCardsContainer.innerHTML =
            '<xf:group class="loading-state">' +
            '<xf:group class="loading-spinner"></xf:group>' +
            '<xf:group>채용공고를 불러오는 중...</xf:group>' +
            '</xf:group>';
    }
};

/**
 * 로딩 상태 숨김
 */
scwin.hideLoadingState = function () {
    var loadingElement = document.querySelector('.loading-state');
    if (loadingElement) {
        loadingElement.remove();
    }
};

/**
 * 빈 상태 표시
 */
scwin.showEmptyState = function () {
    var jobCardsContainer = document.querySelector('.job-cards');
    if (jobCardsContainer) {
        jobCardsContainer.innerHTML =
            '<div class="empty-state">' +
            '<img src="/InsWebApp/images/ws5/not_found.png" alt="빈 상태 이미지" class="empty-image" style="width: 150px; height: 150px; margin-top: 50px; margin-bottom: 50px;" />' +
            '<div class="empty-message">등록된 채용공고가 없습니다</div>' +
            '<div class="empty-submessage">나중에 다시 확인해보세요</div>' +
            '</div>';
    }
};

// =========================
// 이벤트 핸들러
// =========================

/**
 * 공고 상세보기
 */
scwin.openJobDetail = function (jobPostingId) {
    console.log("=== 공고 상세보기 시작 ===");
    console.log("클릭된 공고 ID:", jobPostingId);

    if (!jobPostingId || jobPostingId.trim() === "") {
        console.error("공고 ID가 없습니다.");
        alert("선택된 공고의 정보를 찾을 수 없습니다.");
        return;
    }

    try {
        // 웹스퀘어 환경에서 pageFrame 방식으로 파라미터 전달
        if ($p.parent() && $p.parent().pf_main) {
            console.log("pageFrame을 통한 이동:", jobPostingId);
            $p.parent().pf_main.setSrc("ui/posting/PostDetail.xml", {
                dataObject: {
                    jobPostingId: jobPostingId
                }
            });
        } else {
            // 대안 방법: URL 방식
            console.log("URL 방식으로 이동:", jobPostingId);
            var detailUrl = "PostDetail.xml?jobPostingId=" + encodeURIComponent(jobPostingId);
            $p.url(detailUrl);
        }
        console.log("✅ 페이지 이동 요청 완료");
    } catch (error) {
        console.error("❌ 페이지 이동 중 오류:", error);
        alert("페이지 이동 중 오류가 발생했습니다: " + error.message);
    }
};

/**
 * 북마크 토글
 */
scwin.toggleBookmark = function (event, jobPostingId) {
    event.stopPropagation(); // 카드 클릭 이벤트 방지
    console.log("북마크 토글:", jobPostingId);

    var bookmarkBtn = event.target;
    if (bookmarkBtn.textContent === '������') {
        bookmarkBtn.textContent = '❤️';
        // TODO: 서버에 북마크 추가 요청
    } else {
        bookmarkBtn.textContent = '������';
        // TODO: 서버에 북마크 제거 요청
    }
};

/**
 * 회사 정보 보기
 */
scwin.viewCompany = function (event, companyId) {
    event.stopPropagation(); // 카드 클릭 이벤트 방지
    console.log("회사 정보 보기:", companyId);
    // 회사 상세 페이지로 이동
    // $p.url("../company/CompanyDetail.xml?companyId=" + companyId);
};

/**
 * 검색 실행
 */
scwin.performSearch = function () {
    var searchInput = document.getElementById('searchInput');
    if (searchInput) {
        var searchText = searchInput.value.trim();
        // TODO: 검색 기능은 향후 구현 예정
        // 현재는 기본 목록만 조회
        console.log("검색어:", searchText);
        scwin.loadPostList();
    }
};

/**
 * 페이지 번호 클릭 이벤트
 */
scwin.pgl_postList_onclick = function (idx) {
    console.log("=== 페이지 변경 ===", idx);

    // 페이지 번호 세팅
    dmp_postVo.set("pageIndex", idx);
    // 서버통신 - 공고목록 조회
    scwin.loadPostList();
};

// =========================
// 헤더 이벤트들 (기존 코드 유지)
// =========================

scwin.weaveTypeLogo_onclick = function () {
    $p.url("../common/weaveTypeMain.xml");
};

scwin.searchInput_onkeypress = function (e) {
    if (e.keyCode === 13) {
        scwin.performSearch();
    }
};

scwin.btnSearch_onclick = function () {
    scwin.performSearch();
};

// 필터 이벤트들
scwin.filter_dropdown_onclick = function (filterType) {
    console.log('필터 드롭다운 클릭:', filterType);
    // 실제로는 드롭다운 메뉴 표시
};

scwin.filter_tag_onclick = function (tagName) {
    console.log('필터 태그 클릭:', tagName);
    // 태그 활성화/비활성화 토글
    var tag = event.target;
    tag.classList.toggle('active');

    // 필터 적용 후 목록 새로고침
    scwin.loadPostList();
};

// 햄버거 메뉴 토글
scwin.toggleSideMenu = function () {
    var sideMenu = document.getElementById('sideMenu');
    var overlay = document.getElementById('sideMenuOverlay');

    if (sideMenu && sideMenu.classList.contains('open')) {
        scwin.closeSideMenu();
    } else if (sideMenu && overlay) {
        sideMenu.classList.add('open');
        overlay.classList.add('open');
    }
};

scwin.closeSideMenu = function () {
    var sideMenu = document.getElementById('sideMenu');
    var overlay = document.getElementById('sideMenuOverlay');

    if (sideMenu) sideMenu.classList.remove('open');
    if (overlay) overlay.classList.remove('open');
};

// =========================
// 유틸리티 함수들
// =========================

/**
 * 경력수준 한글 변환
 */
scwin.getExperienceLevelText = function (experienceLevel) {
    switch (experienceLevel) {
        case 'any': return '경력무관';
        case 'junior': return '신입·1-3년';
        case 'senior': return '시니어·3년+';
        default: return experienceLevel || '정보없음';
    }
};

/**
 * 근무형태 한글 변환
 */
scwin.getWorkTypeText = function (workType) {
    switch (workType) {
        case 'remote': return '원격근무';
        case 'onsite': return '출근근무';
        case 'hybrid': return '하이브리드';
        default: return workType || '정보없음';
    }
};

/**
 * 급여범위 한글 변환
 */
scwin.getSalaryRangeText = function (salaryRange) {
    switch (salaryRange) {
        case 'under25': return '~2,500만원';
        case '25to35': return '2,500~3,500만원';
        case '35to50': return '3,500~5,000만원';
        case 'over50': return '5,000만원+';
        default: return salaryRange || '협의';
    }
};

/**
 * 날짜 포맷팅
 */
scwin.formatDate = function (dateString) {
    if (!dateString) return "정보없음";

    try {
        var date = new Date(dateString);
        var now = new Date();
        var diffTime = Math.abs(now - date);
        var diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

        if (diffDays === 1) return "어제";
        if (diffDays < 7) return diffDays + "일 전";
        if (diffDays < 30) return Math.floor(diffDays / 7) + "주 전";

        return date.toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
    } catch (error) {
        return dateString;
    }
};

scwin.slb_dev_mbti_onselected = function () {
    // 쿠키에서 userMbti 가져오기
    var userInfoCookie = WebSquare.cookie.getCookie("userInfo");
    if (!userInfoCookie) {
        console.error("로그인 후 사용가능한 기능입니다.");
        return; // 함수 종료
    }

    var userInfo;
    try {
        userInfo = JSON.parse(userInfoCookie);
    } catch (e) {
        console.error("사용자 정보 파싱 오류:", e);
        return; // 함수 종료
    }

    // userInfo.mbti가 존재하는지 확인
    if (!userInfo || !userInfo.mbti) {
        console.error("mbti 및 성향검사 후 진행 가능합니다.");
        return; // 함수 종료
    }

    // 여기까지 오면 로그인도 되어있고 MBTI도 있는 상태
    // 선택된 값 가져오기
    var selectedValue = slb_dev_mbti.getValue();

    // DataMap에 값 설정
    dmp_postMatchVo.set("userMbti", userInfo.mbti);
    dmp_postMatchVo.set("mbtiMatchFilter", selectedValue);
    dmp_postMatchVo.set("pageIndex", "1");

    // API 호출
    $c.sbm.execute($p, sbm_selectDevMbtiList);
};

scwin.sbm_selectDevMbtiList_submitdone = function (e) {
    // 로딩 상태 숨김
    scwin.hideLoadingState();

    // error 수신시
    var elData = e.responseJSON.elData;
    var elHeader = e.responseJSON.elHeader;
    dlt_postList.setJSON(elData.postVoList || []);
    console.log("✅ 공고 목록 데이터 바인딩 완료 - 총 " + dlt_postList.getRowCount() + "개");

    // 공고 수 업데이트
    spn_jobCount.setLabel(elData.totalCount || 0);

    // 페이지 네비게이터 업데이트
    var totalPageCount = Math.ceil((elData.totalCount || 0) / dmp_postVo.get("pageSize"));
    if (pgl_postList) {
        pgl_postList.setCount(totalPageCount);
    }

    // 공고 카드 UI 동적 생성
    scwin.renderJobCards();

    // 데이터 확인 로그
    for (var i = 0; i < Math.min(dlt_postList.getRowCount(), 3); i++) {
        console.log("공고 " + (i + 1) + ":");
        console.log("- ID:", dlt_postList.getCellData(i, "jobPostingId"));
        console.log("- 제목:", dlt_postList.getCellData(i, "title"));
        console.log("- 회사:", dlt_postList.getCellData(i, "companyName"));
    }
};
]]></script>
	</head>

	<body ev:onpageload="scwin.onpageload">
		<w2:wframe src="../common/Header.xml" id="headerFrame" />
		<xf:group class="main-wrap">

			<!-- 필터 섹션 -->
			<section class="filter-section">
				<!-- 메인 필터 드롭다운 -->

				<!-- 필터 태그들 -->
				<xf:group class="header-container" style="">
					<xf:group class="header-left">
						<xf:group class="main-filters" style="margin-bottom: 0;">
							<xf:select1 id="slb_dev_mbti" chooseOption="" style="width: 148px;height: 21px;" submenuSize="auto" allOption=""
								disabled="false" direction="auto" appearance="minimal" disabledClass="w2selectbox_disabled" chooseOptionLabel="모든 MBTI" ref=""
								ev:onselected="scwin.slb_dev_mbti_onselected">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[모든 MBTI]]></xf:label>
										<xf:value><![CDATA[0]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[4개 이상만 보기]]></xf:label>
										<xf:value><![CDATA[4]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[3개 이상만 보기]]></xf:label>
										<xf:value><![CDATA[3]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[2개 이상만 보기]]></xf:label>
										<xf:value><![CDATA[2]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[1개 이상만 보기]]></xf:label>
										<xf:value><![CDATA[1]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
						</xf:group>
					</xf:group>
					<xf:group class="header-right">
						<xf:group style="display: flex; gap: 12px; margin-left: 24px;">
							<w2:textbox label="최신순" style="font-size: 13px; color: #666;"></w2:textbox>
							<w2:textbox label="추천순" style="font-size: 13px; color: #666;"></w2:textbox>
							<w2:textbox label="인기순" style="font-size: 13px; color: #666;"></w2:textbox>
						</xf:group>
					</xf:group>
				</xf:group>
			</section>

			<!-- 메인 컨텐츠 -->
			<main class="main-content">
				<!-- 채용공고 목록 섹션 -->
				<section class="job-list-section">
					<xf:group class="section-header">
						<w2:textbox class="section-title" label="채용공고"></w2:textbox>
						<xf:group class="job-count">
							<w2:span label="총"></w2:span>
							<w2:span class="num" id="spn_jobCount" label="0"></w2:span>
							<w2:span label="개의 공고"></w2:span>
						</xf:group>
					</xf:group>

					<!-- 공고 카드 컨테이너 (JavaScript로 동적 생성) -->
					<xf:group class="job-cards">
						<!-- 공고 카드들이 동적으로 생성됩니다 -->
					</xf:group>

					<!-- 페이징 -->
					<xf:group class="paging-section">
						<w2:pageList class="pgl" displayButtonType="display" displayFormat="#" id="pgl_postList" pageSize="5" pagingType="0"
							style="" ev:onclick="scwin.pgl_postList_onclick">
						</w2:pageList>
					</xf:group>
				</section>
			</main>
		</xf:group>
    	
    </body>
</html>