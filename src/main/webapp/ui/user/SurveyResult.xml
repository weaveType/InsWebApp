<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" 
    xmlns:xf="http://www.w3.org/2002/xforms">
    
    <head meta_screenName="weaveType 개발자 유형 검사 결과">
        <w2:type>COMPONENT</w2:type>
        <w2:buildDate/>
        <w2:MSA/>
        <xf:model>
            <w2:dataCollection baseNode="map">
                <w2:dataMap baseNode="map" id="dma_result">
                    <w2:keyInfo>
                        <w2:key id="typeCode" name="유형코드" dataType="text" value="BRSD"></w2:key>
                        <w2:key id="B_A_score" name="BA점수" dataType="text" value="75"></w2:key>
                        <w2:key id="R_I_score" name="RI점수" dataType="text" value="60"></w2:key>
                        <w2:key id="S_T_score" name="ST점수" dataType="text" value="80"></w2:key>
                        <w2:key id="D_F_score" name="DF점수" dataType="text" value="70"></w2:key>
                    </w2:keyInfo>
                </w2:dataMap>
            </w2:dataCollection>
        </xf:model>
        <w2:layoutInfo/>
        <w2:publicInfo method=""/>
        
        <script type="text/javascript"><![CDATA[
            var typeDescriptions = {
                'B': { name: 'Builder', desc: '구현 중심형', color: '#28a745' },
                'A': { name: 'Architect', desc: '설계 중심형', color: '#6f42c1' },
                'R': { name: 'Refactor', desc: '안정 추구형', color: '#007bff' },
                'I': { name: 'Innovate', desc: '혁신 추구형', color: '#fd7e14' },
                'S': { name: 'Solo', desc: '독립 작업형', color: '#6c757d' },
                'T': { name: 'Team', desc: '협업 선호형', color: '#20c997' },
                'D': { name: 'Debug', desc: '품질 중심형', color: '#dc3545' },
                'F': { name: 'Feature', desc: '속도 중심형', color: '#ffc107' }
            };
            
            scwin.onpageload = function() {
                console.log("설문조사 결과 페이지 로드됨");
                
                // sessionStorage에서 결과 데이터 가져오기
                var resultData = sessionStorage.getItem('surveyResult');
                if (resultData) {
                    var result = JSON.parse(resultData);
                    scwin.displayResult(result);
                } else {
                    // 기본 테스트 데이터
                    var testResult = {
                        typeCode: 'BRSD',
                        scores: {
                            B_A: 75,
                            R_I: 60,
                            S_T: 80,
                            D_F: 70
                        }
                    };
                    scwin.displayResult(testResult);
                }
                
                // 애니메이션 시작
                setTimeout(function() {
                    scwin.animateProgressBars();
                }, 500);
            };
            
            // 결과 표시
            scwin.displayResult = function(result) {
                // 데이터맵에 결과 저장
                dma_result.set("typeCode", result.typeCode);
                dma_result.set("B_A_score", result.scores.B_A.toString());
                dma_result.set("R_I_score", result.scores.R_I.toString());
                dma_result.set("S_T_score", result.scores.S_T.toString());
                dma_result.set("D_F_score", result.scores.D_F.toString());
                
                // UI 업데이트
                var typeCodeElement = document.querySelector('.type-code');
                var typeNameElement = document.querySelector('.type-name');
                var typeDescElement = document.querySelector('.type-description');
                
                if (typeCodeElement) {
                    typeCodeElement.textContent = result.typeCode;
                }
                
                // 각 유형별 설명 생성
                var typeNames = [];
                var typeDescs = [];
                
                for (var i = 0; i < result.typeCode.length; i++) {
                    var char = result.typeCode[i];
                    if (typeDescriptions[char]) {
                        typeNames.push(typeDescriptions[char].name);
                        typeDescs.push(typeDescriptions[char].desc);
                    }
                }
                
                if (typeNameElement) {
                    typeNameElement.textContent = typeNames.join(' + ');
                }
                
                if (typeDescElement) {
                    typeDescElement.textContent = typeDescs.join(' · ');
                }
                
                // 점수 차트 업데이트
                scwin.updateScoreChart(result.scores);
            };
            
            // 점수 차트 업데이트
            scwin.updateScoreChart = function(scores) {
                var chartItems = [
                    { id: 'ba-chart', label: 'Builder vs Architect', score: scores.B_A, leftType: 'A', rightType: 'B' },
                    { id: 'ri-chart', label: 'Refactor vs Innovate', score: scores.R_I, leftType: 'I', rightType: 'R' },
                    { id: 'st-chart', label: 'Solo vs Team', score: scores.S_T, leftType: 'T', rightType: 'S' },
                    { id: 'df-chart', label: 'Debug vs Feature', score: scores.D_F, leftType: 'F', rightType: 'D' }
                ];
                
                chartItems.forEach(function(item) {
                    var chartElement = document.getElementById(item.id);
                    if (chartElement) {
                        var html = '<div class="chart-header">' +
                                  '<span class="chart-label">' + item.label + '</span>' +
                                  '<span class="chart-score">' + item.score + '%</span>' +
                                  '</div>' +
                                  '<div class="chart-bar-container">' +
                                  '<span class="chart-left-label">' + typeDescriptions[item.leftType].desc + '</span>' +
                                  '<div class="chart-bar">' +
                                  '<div class="chart-fill" data-score="' + item.score + '"></div>' +
                                  '</div>' +
                                  '<span class="chart-right-label">' + typeDescriptions[item.rightType].desc + '</span>' +
                                  '</div>';
                        
                        chartElement.innerHTML = html;
                    }
                });
            };
            
            // 진행바 애니메이션
            scwin.animateProgressBars = function() {
                var progressBars = document.querySelectorAll('.chart-fill');
                progressBars.forEach(function(bar) {
                    var score = parseInt(bar.dataset.score);
                    bar.style.width = score + '%';
                });
                
                // 결과 카드 애니메이션
                var resultCard = document.querySelector('.result-card');
                if (resultCard) {
                    resultCard.classList.add('show');
                }
            };
            
            // 기업 매칭 버튼 클릭
            scwin.btn_find_companies_onclick = function() {
                alert("기업 매칭 기능은 아직 개발 중입니다!");
                // 추후 기업 매칭 페이지로 이동
                // $p.url("CompanyMatching.xml");
            };
            
            // 다시 검사하기 버튼 클릭
            scwin.btn_retake_survey_onclick = function() {
                var promise = confirm("설문조사를 다시 진행하시겠습니까?");
                if (promise) {
                    // sessionStorage 클리어
                    sessionStorage.removeItem('surveyResult');
                    $p.url("SurveyIntro.xml");
                }
            };
            
            // 결과 공유하기 버튼 클릭
            scwin.btn_share_result_onclick = function() {
                var typeCode = dma_result.get("typeCode");
                var shareText = "나의 개발자 유형은 " + typeCode + "입니다! weaveType 개발자 유형 검사에서 확인해보세요.";
                
                if (navigator.share) {
                    navigator.share({
                        title: 'weaveType 개발자 유형 검사 결과',
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    // 클립보드에 복사
                    if (navigator.clipboard) {
                        navigator.clipboard.writeText(shareText).then(function() {
                            alert("결과가 클립보드에 복사되었습니다!");
                        });
                    } else {
                        alert(shareText);
                    }
                }
            };
        ]]></script>
        
        <style type="text/css"><![CDATA[
            .main-container {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                font-family: "Malgun Gothic", "맑은 고딕", sans-serif;
                display: flex;
                flex-direction: column;
                position: relative;
                overflow-x: hidden;
            }
            
            .header {
                width: 100%;
                height: 70px;
                background-color: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-bottom: 1px solid rgba(0, 123, 255, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
                z-index: 10;
            }
            
            .header-logo {
                height: 40px;
                width: auto;
            }
            
            .content-area {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 40px 20px;
                max-width: 900px;
                margin: 0 auto;
                width: 100%;
            }
            
            .result-card {
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-radius: 24px;
                padding: 40px;
                margin-bottom: 40px;
                text-align: center;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
                transform: translateY(30px);
                opacity: 0;
                transition: all 0.8s ease;
                width: 100%;
                max-width: 600px;
            }
            
            .result-card.show {
                transform: translateY(0);
                opacity: 1;
            }
            
            .result-header {
                margin-bottom: 30px;
            }
            
            .result-title {
                font-size: 24px;
                color: #333;
                margin-bottom: 20px;
                font-weight: 600;
            }
            
            .type-display {
                margin-bottom: 30px;
            }
            
            .type-code {
                font-size: 72px;
                font-weight: bold;
                color: #007bff;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
                margin-bottom: 16px;
                font-family: 'Courier New', monospace;
            }
            
            .type-name {
                font-size: 28px;
                font-weight: bold;
                color: #333;
                margin-bottom: 12px;
            }
            
            .type-description {
                font-size: 18px;
                color: #666;
                line-height: 1.5;
            }
            
            .character-placeholder {
                width: 200px;
                height: 200px;
                background: linear-gradient(135deg, #e3f2fd, #bbdefb);
                border: 2px dashed #2196f3;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 20px auto;
                color: #1976d2;
                font-size: 16px;
                font-weight: 500;
            }
            
            .score-charts {
                background: white;
                border-radius: 20px;
                padding: 30px;
                margin-bottom: 40px;
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
                width: 100%;
                max-width: 700px;
            }
            
            .charts-title {
                font-size: 24px;
                font-weight: bold;
                color: #333;
                text-align: center;
                margin-bottom: 30px;
            }
            
            .chart-item {
                margin-bottom: 24px;
            }
            
            .chart-item:last-child {
                margin-bottom: 0;
            }
            
            .chart-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 8px;
            }
            
            .chart-label {
                font-size: 16px;
                font-weight: 600;
                color: #333;
            }
            
            .chart-score {
                font-size: 18px;
                font-weight: bold;
                color: #007bff;
            }
            
            .chart-bar-container {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .chart-left-label,
            .chart-right-label {
                font-size: 12px;
                color: #666;
                min-width: 80px;
                text-align: center;
            }
            
            .chart-bar {
                flex: 1;
                height: 20px;
                background-color: #e9ecef;
                border-radius: 10px;
                overflow: hidden;
                position: relative;
            }
            
            .chart-fill {
                height: 100%;
                background: linear-gradient(90deg, #007bff, #0056b3);
                border-radius: 10px;
                width: 0%;
                transition: width 1s ease-out;
                position: relative;
            }
            
            .action-buttons {
                display: flex;
                flex-direction: column;
                gap: 16px;
                width: 100%;
                max-width: 400px;
                margin: 0 auto;
            }
            
            .btn-primary {
                background: linear-gradient(45deg, #007bff, #0056b3);
                color: white;
                border: none;
                padding: 18px 36px;
                border-radius: 50px;
                font-size: 18px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
            }
            
            .btn-primary:hover {
                background: linear-gradient(45deg, #0056b3, #004494);
                transform: translateY(-3px);
                box-shadow: 0 8px 25px rgba(0, 123, 255, 0.5);
            }
            
            .btn-secondary {
                background: transparent;
                color: rgba(255, 255, 255, 0.9);
                border: 2px solid rgba(255, 255, 255, 0.3);
                padding: 14px 32px;
                border-radius: 50px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }
            
            .btn-secondary:hover {
                border-color: rgba(255, 255, 255, 0.6);
                color: white;
                background: rgba(255, 255, 255, 0.1);
            }
            
            .secondary-buttons {
                display: flex;
                gap: 12px;
                justify-content: center;
                margin-top: 20px;
            }
            
            .btn-small {
                padding: 10px 20px;
                font-size: 14px;
                border-radius: 25px;
            }
            
            .background-decoration {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                overflow: hidden;
            }
            
            .floating-shape {
                position: absolute;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 50%;
                animation: float 8s ease-in-out infinite;
            }
            
            .shape-1 {
                width: 100px;
                height: 100px;
                top: 10%;
                left: 5%;
                animation-delay: 0s;
            }
            
            .shape-2 {
                width: 150px;
                height: 150px;
                top: 70%;
                right: 10%;
                animation-delay: 3s;
            }
            
            .shape-3 {
                width: 80px;
                height: 80px;
                bottom: 15%;
                left: 15%;
                animation-delay: 6s;
            }
            
            @keyframes float {
                0%, 100% {
                    transform: translateY(0px) rotate(0deg);
                }
                50% {
                    transform: translateY(-30px) rotate(180deg);
                }
            }
            
            .achievement-badge {
                display: inline-block;
                background: linear-gradient(45deg, #ffd700, #ffed4e);
                color: #333;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 14px;
                font-weight: bold;
                margin: 10px 5px;
                box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
            }
        ]]></style>
    </head>
    
    <body ev:onpageload="scwin.onpageload">
        <xf:group class="main-container">
            <xf:group class="background-decoration">
                <xf:group class="floating-shape shape-1"></xf:group>
                <xf:group class="floating-shape shape-2"></xf:group>
                <xf:group class="floating-shape shape-3"></xf:group>
            </xf:group>
            
            <xf:group class="header">
                <xf:image src="/InsWebApp/images/ws5/weaveTypeLogo.png" class="header-logo"></xf:image>
            </xf:group>
            
            <xf:group class="content-area">
                <!-- 결과 카드 -->
                <xf:group class="result-card">
                    <xf:group class="result-header">
                        <w2:textbox class="result-title" label="🎉 당신의 개발자 유형이 결정되었습니다!" tagname="h2"></w2:textbox>
                    </xf:group>
                    
                    <xf:group class="type-display">
                        <w2:textbox class="type-code" label="BRSD" tagname="div"></w2:textbox>
                        <w2:textbox class="type-name" label="Builder + Refactor + Solo + Debug" tagname="h3"></w2:textbox>
                        <w2:textbox class="type-description" label="구현 중심형 · 안정 추구형 · 독립 작업형 · 품질 중심형" tagname="p"></w2:textbox>
                    </xf:group>
                    
                    <xf:group class="character-placeholder">
                        <w2:textbox label="캐릭터 이미지 준비중" tagname="div"></w2:textbox>
                    </xf:group>
                    
                    <w2:textbox class="achievement-badge" label="🏆 실용적 완벽주의자" tagname="span"></w2:textbox>
                    <w2:textbox class="achievement-badge" label="🔧 품질 장인" tagname="span"></w2:textbox>
                </xf:group>
                
                <!-- 점수 차트 -->
                <xf:group class="score-charts">
                    <w2:textbox class="charts-title" label="상세 분석 결과" tagname="h3"></w2:textbox>
                    
                    <xf:group class="chart-item" id="ba-chart">
                        <!-- 동적으로 생성됨 -->
                    </xf:group>
                    
                    <xf:group class="chart-item" id="ri-chart">
                        <!-- 동적으로 생성됨 -->
                    </xf:group>
                    
                    <xf:group class="chart-item" id="st-chart">
                        <!-- 동적으로 생성됨 -->
                    </xf:group>
                    
                    <xf:group class="chart-item" id="df-chart">
                        <!-- 동적으로 생성됨 -->
                    </xf:group>
                </xf:group>
                
                <!-- 액션 버튼들 -->
                <xf:group class="action-buttons">
                    <xf:trigger class="btn-primary" ev:onclick="scwin.btn_find_companies_onclick">
                        <xf:label>🏢 나와 맞는 기업 찾아보기</xf:label>
                    </xf:trigger>
                    
                    <xf:group class="secondary-buttons">
                        <xf:trigger class="btn-secondary btn-small" ev:onclick="scwin.btn_retake_survey_onclick">
                            <xf:label>🔄 다시 검사하기</xf:label>
                        </xf:trigger>
                        
                        <xf:trigger class="btn-secondary btn-small" ev:onclick="scwin.btn_share_result_onclick">
                            <xf:label>📤 결과 공유하기</xf:label>
                        </xf:trigger>
                    </xf:group>
                </xf:group>
            </xf:group>
        </xf:group>
    </body>
</html>
