"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[9319],{9319:(t,e,i)=>{i.r(e),i.d(e,{multiupload:()=>u});var s=i(1570),a=i(8548),o=i(866),n=i(2847),r=i(6323),l=i(4171),h=i(3885),p=i(2725),u=function(t,e,i){h.q.call(this,t,e,i)};s.q.extend(u.prototype,h.q.prototype),u.prototype.defaultOptions={useConfig:!0,pluginType:"uiplugin.multiupload",pluginName:"multiupload",userEvents:["ondone","onComplete","onprogress","onerror"],type:"1",className:"w2multiupload_uploader",action:"",maxsize:"20000",subSize:"",maxcount:"5",sizeUnit:"Byte",displaySizeUnit:"MB",lang:"",debugmode:"false",css:"",filter:"",uploadButton:!0,wmode:!1,selectWithUpload:!1,mode:"flash",subDir:"",selectCallback:"",defaultImage:s.q._resourceURI+"uiplugin/multiupload/images/c_upload_off.gif",hoverImage:s.q._resourceURI+"uiplugin/multiupload/images/c_upload.gif",src:s.q._resourceURI+"uiplugin/multiupload/multiupload.swf?ver=2.1",transparentSrc:s.q._resourceURI+"uiplugin/multiupload/multiupload_transparent.swf?ver=2.1",fireEventOnError:!1,clearOnError:!0,preventDuplicatedFileName:!1,callbackSync:!1,msaName:""},u.prototype.initialize=function(t){try{this.type=this.options.type,this.style=this.options.style,this.className=this.options.className,this.action=a.I.getServletURL(this,this.options.msaName,"upload.wq?callbackFunction="+this.id+".callback",this.options.action),this.count=this.options.maxcount,this.subSize=this.options.subSize,this.subSizeValue=this.subSize?a.I.getConfiguration("/WebSquare/multiUpload/"+this.subSize+"/@value"):"",this.maxsize=1024*this.options.maxsize,this.size=this.subSizeValue&&this.subSizeValue<this.maxsize?this.subSizeValue:this.maxsize,this.lang=this.options.lang||WebSquare.BootLoader.getBrowserLanguage(),this.debugmode=this.options.debugmode,this.fireEventOnError=this.options.fireEventOnError?"true":"false",this.options.css?this.css=this.options.css:this.css=s.q._resourceURI+"uiplugin/multiupload/mystyle.css",this.xmlEvents=this.options.xmlEvents,this.disabled=this.options.disabled,this.uploadButton=this.options.uploadButton,this.selectWithUpload=this.options.selectWithUpload,this.mode=this.options.mode,"transparent"!=this.mode&&"html5_transparent"!=this.mode||(this.options.wmode=!0),this.subDir=this.options.subDir,this.selectCallback=this.options.selectCallback,this.sessionId="",this.html5Upload=!1,"undefined"==typeof FormData||"flash"==this.options.mode||"transparent"==this.options.mode?this.html5Upload=!1:"html5"!=this.options.mode&&"html5_transparent"!=this.options.mode||(this.html5Upload=!0);var e=this.options.filter||p.B.getMessage("MultiUpload_image")+":*.jpg;*.gif;*.png"||0,i="|"+p.B.getMessage("MultiUpload_all")+":*.*"||0;this.filter=this.html5Upload?e:e+i,this.filter=this.makeHTML5FilterString(this.filter),this._inx=0,this.fileArray=[],this.selectedRows=[],this.removeRows=[],this.fileNameArr=[],this.xhrArr=[],this.uploadParam=[],this.uploadParamJSON={},this.returnDataArr=[],this.isWork=!1,this.sizeObj={Byte:1,KB:1024,MB:1048576,GB:1073741824,TB:1099511627776},this.sizeUnit=this.sizeObj[this.options.sizeUnit],this.displaySizeUnit=this.sizeObj[this.options.displaySizeUnit]}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.toHTML=function(){try{var t=[],e=this.options.mode.toLowerCase(),i="html5"==e?"w2multiupload_html5_uploader":"",s=""==this.options.style?"":"style='"+this.options.style+"'",a=""==this.options.tabIndex?"":"tabIndex='"+this.options.tabIndex+"'";if("1"==this.type)if(1==this.html5Upload){if("html5"==e){var n=p.B.getMessage("MultiUpload_add")||"add",r=p.B.getMessage("MultiUpload_delete")||"delete",l=p.B.getMessage("MultiUpload_cancel")||"cancel",h=p.B.getMessage("MultiUpload_send")||"send",u=p.B.getMessage("MultiUpload_file")||"file",d=p.B.getMessage("MultiUpload_size")||"size",c=p.B.getMessage("MultiUpload_status")||"status";t.push(" <div id='"+this.id+"' class='"+i+" "+this.options.className+"' "+s+">"),t.push("<div id='"+this.id+"_dropZone' >"),
t.push("<table id='"+this.id+"_table'>"),t.push("<thead id='"+this.id+"_thead'>"),t.push("<tr><th><input type='checkbox' id='"+this.id+"_head_chk' /></th><th>"+u+"</th><th>"+d+"</th><th>"+c+"</th></tr>"),t.push("</thead>"),t.push("<tbody id='"+this.id+"_tbody'></tbody>"),t.push("</table>"),t.push("</div>"),t.push("<div id='"+this.id+"_btnArea' style='margin-top:5px;'>"),t.push("<span class='w2multiupload_html5_inputFile'>"),t.push("<input id='"+this.id+"_btn_dumy' type='button' value='"+n+"' class='w2multiupload_html5_control_btn' style='position:absolute;'></input>"),t.push("<input style='margin: 0pt; padding: 0pt; width:50px; height:17px;opacity: 0.01; filter : alpha(opacity=1);'  name='add' id='"+this.id+"_btn_add' type='file' multiple='multiple'></input>"),t.push("</span>"),t.push("<input id='"+this.id+"_btn_remove' type='button' value='"+r+"' class='w2multiupload_html5_control_btn' ></input> "),t.push("<input id='"+this.id+"_btn_cancel' type='button' value='"+l+"' class='w2multiupload_html5_control_btn' ></input>"),t.push("<input id='"+this.id+"_btn_upload' type='button' value='"+h+"' class='w2multiupload_html5_control_btn' ></input>"),t.push("</div>")}else if("html5_transparent"==e){var m=p.B.getMessage("MultiUpload_addFile")||"send";t.push(" <div id='"+this.id+"' class='"+i+" "+this.options.className+"' "+s+">"),t.push("<span id='"+this.id+"_popBtn' class='w2multiupload_html5_transparent'>"),t.push("<input id='"+this.id+"_file_input' type='file' multiple='multiple' style='width:100%;height:100%;opacity : 0.01;font-size:0px;' title='"+m+"' accept='"+this.filter+"'/>"),t.push("</span>"),t.push("</div>")}}else{t.push("<div id='"+this.id+"' "+a+">");var f=""==this.options.defaultImage?"":"src='"+this.options.defaultImage+"'";t.push("<input type='image' id='"+this.id+"_upload' "+f+" />"),t.push("</div>")}else{t.push("<div id='"+this.id+"' "+a+">");f=""==this.options.defaultImage?"":"src='"+this.options.defaultImage+"'";t.push("<input type='image' id='"+this.id+"_upload' "+f+" />"),t.push("</div>")}return t.join("")}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.setAction=function(){try{if("1"==this.type)this.html5Upload?"html5"==this.options.mode.toLowerCase()||("html5_transparent"==this.options.mode.toLowerCase()?(this.dom.inputZone=this.getElementById(this.id+"_file_input"),this.html5uploadchange=this.event.bindAsEventListener(this,this.handleOnchange),this.event.addListener2(this.dom.inputZone,"onchange",this.html5uploadchange)):a.I.setTimeout(this,(function(){this.rebuild()}),100)):a.I.setTimeout(this,(function(){this.rebuild()}),100);else{this.upload=document.getElementById(this.id+"_upload"),this.multiupload=document.getElementById(this.id+"ExExternalInterface"),a.I.browserCheck.ieAllVersion?this.setAttValue(this.upload,"className","w2multiupload_button"):this.setAttValue(this.upload,"class","w2multiupload_button");var t=this;n.f.addListener(this.upload,"onclick",(function(e){t.handleClickEvent()})),n.f.addListener(this.upload,"onmouseover",(function(e){t.upload.src=t.options.hoverImage,t.style.cursor="hand"})),n.f.addListener(this.upload,"onmouseout",(function(e){t.upload.src=t.options.defaultImage,t.style.cursor="normal"})),this.relateStyle=a.I.makeStyle(this.style,this.className),a.I.applyStyle(this.upload,this.relateStyle)}}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.getFlashString=function(){try{var t=[],e="";return 1==this.options.wmode&&(e="wmode='transparent'"),a.I.browserCheck.ieAllVersion?(a.I.browserCheck.ie?t.push("<object wmode='transparent' classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'  id='"+this.id+"ExExternalInterface'     >"):t.push("<object wmode='transparent' type='application/x-shockwave-flash'  id='"+this.id+"ExExternalInterface' data='"+this.options.src+"' >"),t.push("<param name='movie' value='"+this.options.src+"' />"),t.push("<param name='quality' value='high' />"),
t.push("<param name='flashVars' value='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&subSize="+this.subSize+"&count="+this.count+"&sizeUnit="+this.options.sizeUnit+"&displaySizeUnit="+this.options.displaySizeUnit+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&fireEventOnError="+this.fireEventOnError+"&filter="+this.filter+"' />"),t.push("</object>")):(t.push("<embed "+e+" src='"+this.options.src+"'  class='w2multiupload_uploader'      flashVars='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&subSize="+this.subSize+"&sizeUnit="+this.options.sizeUnit+"&displaySizeUnit="+this.options.displaySizeUnit+"&count="+this.count+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&fireEventOnError="+this.fireEventOnError+"&filter="+this.filter+"' name='"+this.id+"ExExternalInterface' id='"+this.id+"ExExternalInterface' align='middle'     play='true'     loop='false'        quality='high'          allowScriptAccess='sameDomain'      type='application/x-shockwave-flash'                pluginspage='http://www.adobe.com/go/getflashplayer'>"),t.push("</embed>")),t.join("")}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.rebuild=function(){var t=[],e="";if("1"==this.type){e="";a.I.browserCheck.ieAllVersion?(1==this.options.wmode&&(e="wmode='transparent'"),a.I.browserCheck.ie?t.push("<object "+e+" classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'  id='"+this.id+"ExExternalInterface'     >"):t.push("<object "+e+" type='application/x-shockwave-flash'  id='"+this.id+"ExExternalInterface' data='"+("transparent"==this.mode||"html5_transparent"==this.mode?this.options.transparentSrc:this.options.src)+"' >"),"transparent"==this.mode||"html5_transparent"==this.mode?t.push("<param name='movie' value='"+this.options.transparentSrc+"' />"):t.push("<param name='movie' value='"+this.options.src+"' />"),1==this.options.wmode&&t.push("<param name='wmode' value='transparent' />"),t.push("<param name='quality' value='high' />"),t.push("<param name='flashVars' value='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&subSize="+this.subSize+"&sizeUnit="+this.options.sizeUnit+"&displaySizeUnit="+this.options.displaySizeUnit+"&count="+this.count+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&fireEventOnError="+this.fireEventOnError+"&filter="+this.filter+"&selectWithUpload="+this.selectWithUpload+"&subDir="+this.subDir+"&selectCallback="+this.selectCallback+"' />"),a.I.browserCheck.ie&&("transparent"==this.mode||"html5_transparent"==this.mode?t.push("<embed src='"+this.options.transparentSrc+"'  class='w2multiupload_uploader'   flashVars='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&count="+this.count+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&filter="+this.filter+"' name='"+this.id+"ExExternalInterface' id='"+this.id+"ExExternalInterface' align='middle'     play='true'     loop='false'        quality='high'          allowScriptAccess='sameDomain'      type='application/x-shockwave-flash'                pluginspage='http://www.adobe.com/go/getflashplayer'>"):t.push("<embed src='"+this.options.src+"'  class='w2multiupload_uploader'      flashVars='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&subSize="+this.subSize+"&sizeUnit="+this.options.sizeUnit+"&displaySizeUnit="+this.options.displaySizeUnit+"&count="+this.count+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&fireEventOnError="+this.fireEventOnError+"&filter="+this.filter+"' name='"+this.id+"ExExternalInterface' id='"+this.id+"ExExternalInterface' align='middle'     play='true'     loop='false'        quality='high'          allowScriptAccess='sameDomain'      type='application/x-shockwave-flash'                pluginspage='http://www.adobe.com/go/getflashplayer'>"),t.push("</embed>")),
t.push("</object>")):(1==this.options.wmode&&(e="wmode='transparent'"),"transparent"==this.options.mode?t.push("<embed "+e+" src='"+this.options.transparentSrc+"'  class='w2multiupload_uploader'   flashVars='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&subSize="+this.subSize+"&sizeUnit="+this.options.sizeUnit+"&displaySizeUnit="+this.options.displaySizeUnit+"&count="+this.count+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&fireEventOnError="+this.fireEventOnError+"&filter="+this.filter+"&selectWithUpload="+this.selectWithUpload+"&subDir="+this.subDir+"&selectCallback="+this.selectCallback+"' name='"+this.id+"ExExternalInterface' id='"+this.id+"ExExternalInterface' align='middle'        play='true'     loop='false'        quality='high'          allowScriptAccess='sameDomain'      type='application/x-shockwave-flash'                pluginspage='http://www.adobe.com/go/getflashplayer'>"):t.push("<embed "+e+" src='"+this.options.src+"'  class='w2multiupload_uploader'      flashVars='css="+this.css+"&uploadButton="+this.uploadButton+"&url="+this.action+"&size="+this.size+"&subSize="+this.subSize+"&sizeUnit="+this.options.sizeUnit+"&displaySizeUnit="+this.options.displaySizeUnit+"&count="+this.count+"&lang="+this.lang+"&id="+this.id+"&debug="+this.debugmode+"&fireEventOnError="+this.fireEventOnError+"&filter="+this.filter+"&selectWithUpload="+this.selectWithUpload+"&subDir="+this.subDir+"&selectCallback="+this.selectCallback+"' name='"+this.id+"ExExternalInterface' id='"+this.id+"ExExternalInterface' align='middle'        play='true'     loop='false'        quality='high'          allowScriptAccess='sameDomain'      type='application/x-shockwave-flash'                pluginspage='http://www.adobe.com/go/getflashplayer'>"),t.push("</embed>"));var i=document.getElementById(this.id);a.I._safeInnerHTML(i,t.join("")),a.I.browserCheck.ieAllVersion?this.as=document.getElementById(this.id+"ExExternalInterface"):this.as=document[this.id+"ExExternalInterface"];var s=a.I.makeStyle(this.style);i.style.position="",a.I.applyStyle(this.as,s)}},u.prototype.setParam=function(t,e){try{this.as.setParam(t,e)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.setTitleInput=function(t){try{this.html5Upload&&"html5"==this.options.mode.toLowerCase()||"html5_transparent"==this.options.mode.toLowerCase()?this.dom.inputZone&&this.dom.inputZone.setAttribute("title",t):this.as.setAttribute("title",t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.makeHTML5FilterString=function(t){try{if(!this.html5Upload)return t;for(var e=t.split("|"),i=[],s=0,a=e.length;s<a;s++){var o=e[s].split(":"),n=o.length>1?o[1].replaceAll("*","").replaceAll(";",","):o[0];i.push(n)}return i.join("|")}catch(e){return t}},u.prototype.onDone=function(t){try{var e=this.options.mode.toLowerCase();(this.html5Upload&&"html5"==e||"html5_transparent"==e)&&(this.uploadParam=[],this.uploadParamJSON={},this.fileArray=[],this.fileNameArr=[],this.removeRows=[]),n.f.fireEvent(this,"ondone",t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.setCallback=function(t){try{"function"==typeof t&&(this.callbackFunction=t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.setAttValue=function(t,e,i){try{a.I.browserCheck.ie?t[e]=i:t.setAttribute(e,i)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.getValue=function(){try{return this.as.getValue()}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.getFileNames=function(){try{return this.html5Upload?this.fileNameArr:this.as.getFileNames()}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.getFileInfos=function(){try{var t=[];if(this.html5Upload)for(var e=0;e<this.fileArray.length;e++){var i=this.fileArray[e],s={},a=(i.size/this.displaySizeUnit).toFixed(2);s.displaySize=a+" "+this.options.displaySizeUnit,s.name=i.name,s.size=i.size,t.push(s)}else t=this.as.getFileInfos();return t}catch(t){o.Y.printStackTrace(t,null,this)}},
u.prototype.removeAllFiles=function(){try{if(this.html5Upload){if("html5"==this.options.mode.toLowerCase())for(var t=this.getElementById(this.id+"_table"),e=t.rows.length,i=1;i<e;i++)t.deleteRow(1);this.fileArray=[],this.fileNameArr=[],this.selectedRows=[],this.removeRows=[],this.xhrArr=[]}else this.as.removeAllFiles()}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.removeFile=function(t){try{if(this.html5Upload){for(var e=[],i=[],s=-1,a=0;a<this.fileNameArr.length;a++)this.fileNameArr[a]!=t?(e.push(this.fileNameArr[a]),i.push(this.fileArray[a])):this.fileNameArr[a]==t&&(s=a);if(this.fileNameArr=e,this.fileArray=i,"html5"==this.options.mode.toLowerCase()&&-1==s){var n=this.getElementById(this.id+"_table"),r=n.rows.length;for(a=1;a<r;a++)if(s==a){n.deleteRow(1+s);break}}}else this.as.removeFile(t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.browserDisable=function(t){try{if(this.html5Upload){var e=document.getElementById(this.id+"_file_input");e.disabled=1==t||""}else this.as.browserDisable(t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.reset=function(){this.as.reset()},u.prototype.setDisabled=function(t){if(this.disabled=t,this.options.disabled=t,this.html5Upload){var e=document.getElementById(this.id+"_file_input");e.disabled=1==t||""}else{document[this.id+"ExExternalInterface"].setDisabled(t)}},u.prototype.disableUpload=function(t){this.as.disableUpload(t)},u.prototype.disableCancel=function(t){this.as.disableCancel(t)},u.prototype.setLeft=function(t){this.as.style.left=t+"px"},u.prototype.setTop=function(t){this.as.style.top=t+"px"},u.prototype.setWidth=function(t){this.as.style.width=t+"px"},u.prototype.setHeight=function(t){this.as.style.height=t+"px"},u.prototype.setParam=function(t,e,i){var s=this.options.mode.toLowerCase();if(this.html5Upload&&"html5"==s||"html5_transparent"==s){var a={};a[e]=i,this.uploadParam.push(a)}else this.as.setParam(t,e,i)},u.prototype.setParamJSON=function(t){var e=this.options.mode.toLowerCase();(this.html5Upload&&"html5"==e||"html5_transparent"==e)&&(this.uploadParamJSON=t)},u.prototype.getDisabled=function(){return this.html5Upload?h.q.prototype.getDisabled.call(this):this.as.getDisabled()},u.prototype.getFileCount=function(){return this.html5Upload?this.fileArray.length:this.as.getFileCount()},u.prototype.setSubDir=function(t){return!(!t||"string"!=typeof t)&&(this.options.subDir=t,this.subDir=t,!0)},u.prototype.setFAction=function(t){this.as.setUrl(t)},u.prototype.setFileParam=function(t){this.as.setUploadDataFieldName(t)},u.prototype._changeActionWidthMsaName=function(){try{var t=a.I.getServletURL(this,this.options.msaName,"upload.wq?callbackFunction="+this.id+".callback",this.options.action);this.html5Upload?this.action=t:this.as.setUrl(t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.changeAction=function(t){try{this.options.action=t,this._changeActionWidthMsaName()}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.changeMsaName=function(t){try{this.options.msaName=t,this._changeActionWidthMsaName()}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.addParam=function(t,e){l.v.printLog("* addParam not supported. Use setParam API.["+this.id+"]")},u.prototype.setButtonSize=function(t,e){try{this.as.setButtonSize(t,e)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.setMaxFileCount=function(t){this.html5Upload?this.count=t:this.as.setMaxFileCount(t)},u.prototype.setMaxFileSize=function(t){this.html5Upload?(this.maxsize=1024*t,this.size=this.subSizeValue&&this.subSizeValue<this.maxsize?this.subSizeValue:this.maxsize):this.as.setMaxFileSize(t)},u.prototype.setFilter=function(t,e){if(null!=t&&null!=e)if(this.options.filter=t+":"+e,this.html5Upload&&"html5"==this.options.mode.toLowerCase()||"html5_transparent"==this.options.mode.toLowerCase()){if(this.dom.inputZone){var i=this.makeHTML5FilterString(this.options.filter);this.dom.inputZone.setAttribute("accept",i)}}else this.as.setFileFilter(t,e)},u.prototype.startUpload=function(){
"html5"==this.options.mode.toLowerCase()||(this.html5Upload&&"html5_transparent"==this.options.mode.toLowerCase()?this._startHTML5Upload():this.as.startUpload())},u.prototype.setDebugMode=function(t){this.debugmode=t},u.prototype.setColumnWidth=function(t,e){this.as.setColumnWidth(t,e)},u.prototype.callback=function(t){try{this.html5Upload&&(this.fileArray=[],this.fileNameArr=[],this.removeRows=[],this.xhrArr=[],this.uploadParam=[],this.uploadParamJSON={},this.returnDataArr=[],this.isWork=!1),n.f.fireEvent(this,"ondone",t)}catch(t){o.Y.printStackTrace(t)}},u.prototype.onSelectCallback=function(t){try{if(""==this.selectCallback)return;var e=[];try{e=r.Z.isArray(t)?t:"string"==typeof t?JSON.parse(t):[]}catch(t){e=[]}var i="function"==typeof this.selectCallback?this.selectCallback:r.Z.getGlobalFunction(this.selectCallback,this.scope_id);"function"==typeof i&&i.call(this,e)}catch(t){o.Y.printStackTrace(t)}},u.prototype.onErrorCallback=function(t){try{if(!t)return;var e=[];try{if("string"!=typeof t)return;e=JSON.parse("["+t+"]")}catch(t){return}n.f.fireEvent(this,"onerror",e[0])}catch(t){o.Y.printStackTrace(t)}},u.prototype.setSelectCallback=function(t){return!!t&&("string"==typeof t?(this.options.selectCallback=t.wq_trim(),this.selectCallback=t.wq_trim()):"function"==typeof t&&(this.selectCallback=t),!0)},u.prototype.onComplete=function(){try{n.f.fireEvent(this,"onComplete")}catch(t){o.Y.printStackTrace(t)}},u.prototype.setAttValue=function(t,e,i){a.I.browserCheck.moz?t.setAttribute(e,i):a.I.browserCheck.ie?t[e]=i:a.I.browserCheck.ieAllVersion&&t.setAttribute(e,i)},u.prototype.close=function(){var t=document.getElementById("mydiv"),e=document.getElementById("myiframe");t&&(t.style.display="none"),e&&(e.style.display="none")},u.prototype.open=function(){var t=document.getElementById("mydiv"),e=document.getElementById("myiframe"),i=document.getElementById("myldiv");t&&(t.style.display="block"),e&&(e.style.display="block"),i&&(i.innerHTML=this.getFlashString())},u.prototype.setAddText=function(t){this.as.setAddText(t)},u.prototype.setCancelText=function(t){this.as.setCancelText(t)},u.prototype.setDelText=function(t){this.as.setDelText(t)},u.prototype.setUploadText=function(t){this.as.setUploadText(t)},u.prototype.setFileColumnName=function(t){this.setColumn1Text(t)},u.prototype.setColumn1Text=function(t){this.as.setColumn1Text(t)},u.prototype.setFileColumnName=function(t){this.setColumn2Text(t)},u.prototype.setColumn2Text=function(t){this.as.setColumn2Text(t)},u.prototype.setFileColumnName=function(t){this.setColumn3Text(t)},u.prototype.setColumn3Text=function(t){this.as.setColumn3Text(t)},u.prototype.setRefSuccessText=function(t){this.as.setRefSuccessText(t)},u.prototype.setRefProgressText=function(t){this.as.setRefProgressText(t)},u.prototype.setRefCancelText=function(t){this.as.setRefCancelText(t)},u.prototype.setRefUploadText=function(t){this.as.setRefUploadText(t)},u.prototype.setMessageDuplicateText=function(t){this.as.setMessageDuplicateText(t)},u.prototype.setMessageMaxCountText=function(t){this.as.setMessageMaxCountText(t)},u.prototype.setMessageMaxSizeText=function(t){this.as.setMessageMaxSizeText(t)},u.prototype.isUploading=function(){return this.html5Upload?this.isWork:this.as.isUploading()},u.prototype.handleOnchange=function(t){try{this.dom.inputZone=document.getElementById(this.id+"_file_input"),this.dom.imgZone=document.getElementById(this.id+"_popBtn");var e=t.dataTransfer&&t.dataTransfer.files?t.dataTransfer.files:this.dom.inputZone.files,i=[];if(e.length>this.dom.inputZone.count||this.fileArray.length+e.length>this.count)return this._fireError("uploadCountExceed",{count:this.count}),this.options.clearOnError&&(this.fileArray=[],this.fileNameArr=[],this.removeRows=[],this.xhrArr=[],this.uploadParam=[],this.uploadParamJSON={},this.returnDataArr=[],this.isWork=!1),void this._clearInput();if(e){for(var a=0,n=e.length;a<n;a++)if(this.size<e[a].size)return this._fireError("fileSizeExceed",{
size:(this.size/this.displaySizeUnit).toFixed(2)}),void this._clearInput();for(a=0,n=e.length;a<n;a++){for(var r=!1,l=0;l<this.fileArray.length;l++)if(!0===this.options.preventDuplicatedFileName){if(e[a].name===this.fileArray[l].name){r=!0;break}}else if(e[a].name===this.fileArray[l].name&&e[a].size===this.fileArray[l].size&&(p=e[a],u=this.fileArray[l],p.lastModifiedDate?p.lastModifiedDate.toString()===u.lastModifiedDate.toString():p.lastModified?p.lastModified.toString()===u.lastModified.toString():void 0)){r=!0;break}if(0==r){var h=(e[a].size/this.displaySizeUnit).toFixed(2);i.push(s.q.extend({displaySize:h+" "+this.options.displaySizeUnit},e[a])),this.fileArray.push(e[a]),this.fileNameArr.push(e[a].name),this._inx++}else this._fireError("fileExist",{name:e[a].name})}}""!=this.selectCallback&&this.onSelectCallback(i),this._clearInput()}catch(t){o.Y.printStackTrace(t,null,this)}var p,u},u.prototype._handleOndrop=function(t){try{n.f.stopEvent(t);var e=t.dataTransfer.files;if(this.html5Upload&&"html5"==this.options.mode.toLowerCase()){for(var i="",s=0;s<e.length;s++)-1==$.inArray(e[s].name,this.fileNameArr)?(i+="<tr id='_tr"+this._inx+"' trindex='"+this._inx+"'><td><input type='checkbox' name='chk' index='"+this._inx+"'/></td><td>"+e[s].name+"</td><td>"+this._byteCalc(e[s].size)+"</td><td><div id='progress_"+this._inx+"'></div></td></tr>",this.fileArray.push(e[s]),this.fileNameArr.push(e[s].name),this._inx++):this._fireError("fileExist",{name:e[s].name});this.dom.tbody&&(this.dom.tbody.innerHTML+=i,$("#"+this.id+"_tbody tr").click((function(t){$(this).addClass("w2multiupload_html5_uploader_selected").siblings().removeClass("w2multiupload_html5_uploader_selected"),"checkbox"!==t.target.type&&$(":checkbox",this).trigger("click")})))}else for(s=0;s<e.length;s++)-1==$.inArray(e[s].name,this.fileNameArr)?(this.fileArray.push(e[s]),this.fileNameArr.push(e[s].name),this._inx++):this._fireError("fileExist",{name:e[s].name})}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.dropFiles=function(t){try{this.handleOnchange(t)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.handleOnUpload=function(t){try{for(var e=0;e<this.fileArray.length;e++){var i=this.getElementById("progress_"+e),s=new XMLHttpRequest;this.xhrArr.push(s);var a={};a.progress=i,a.xhr=s,this._handleOnUpload(this.fileArray[e],a)}}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype._handleOnUpload=function(t,e){try{var i=this.action,s=new FormData,a=e.xhr;a.open("POST",i,!0);var n=this,r=this.uuid,l=e.progress;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var t=WebSquare.idCache[r],e=a.responseText;t.callback(e.substring(e.indexOf("<ret>"),e.indexOf("</ret>")+6))}},a.upload.addEventListener("progress",(function(t){var e=parseInt(t.loaded/t.total*100);l.innerHTML=e+"%",l.style.width=e+"%"}),!1);var h=p.B.getMessage("MultiUpload_complete");a.addEventListener("load",(function(t){l.innerHTML=h,n._clearInput(),n.fileNameArr=[]}),!1),s.append("Filename",t.name),s.append("FileData",t),this.options.subDir&&s.append("subDir",this.options.subDir),this.options.subSize&&s.append("subSize",this.options.subSize),a.send(s)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype._handleUpload=function(){},u.prototype._startHTML5Upload=function(){try{if(!this.validateFiles(this.fileArray))return;for(var t=0;t<this.fileArray.length;t++){var e=new XMLHttpRequest;this._XHRUpload(e,this.fileArray[t])}}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.validateFiles=function(t,e){try{if(!t)return!1;if(t.length>this.dom.inputZone.count||this.html5Upload&&t.length>this.count)return this._fireError("uploadCountExceed",{count:this.count}),!1;for(var i=0,s=t.length;i<s;i++)if(this.size<t[i].size)return this._fireError("fileSizeExceed",{size:(this.size/this.displaySizeUnit).toFixed(2)}),!1;var a=[],n=!1;for(i=0,s=t.length;i<s;i++)for(var r=0;r<this.fileArray.length;r++)t[i].name===this.fileArray[r]&&t[i].size===this.fileArray[r].size&&a.push(t[i]);for(i=0,
s=a.length;i<s;i++)this._fireError("fileExist",{name:a[i].name}),n=!0;return!n&&(e&&(this.fileArray=[],this.fileNameArr=[],this.removeRows=[],this.xhrArr=[],this.uploadParam=[],this.uploadParamJSON={},this.returnDataArr=[],this.isWork=!1,this._clearInput()),!0)}catch(t){o.Y.printStackTrace(t,null,this)}return!1},u.prototype._XHRUpload=function(t,e){try{var i=this.action,s=this;t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var e=t.responseText;s.callbackXHRHandle(e.substring(e.indexOf("<ret>"),e.indexOf("</ret>")+6)),t.onreadystatechange=function(){},t=null}else t.status>="400"&&(s._fireError("HTTPException",{name:t.status}),t.onreadystatechange=function(){},t=null)},t.open("POST",i,!0),t.addEventListener("load",(function(t){}),!1);var l=new FormData;if(l.append("Filename",e.name),l.append("FileData",e),this.options.subDir&&l.append("subDir",this.options.subDir),this.options.subSize&&l.append("subSize",this.options.subSize),this.uploadParam.length>0)for(var h=0;h<this.uploadParam.length;h++){var p=this.uploadParam[h];for(var u in p)l.append(u,p[u])}if(this.uploadParamJSON[e.name]){p=this.uploadParamJSON[e.name];for(var u in p)l.append(u,p[u])}t.upload.addEventListener("progress",(function(t){var i=Math.round(t.loaded/t.total*100),a={};a.percentData=i,a.fileName=e.name,n.f.fireEvent(s,"onprogress",a)}),!1);var d=a.I.getConfiguration("/WebSquare/handler/requestHeaderFunction/@value");if(""!=d){var c=r.Z.getGlobalFunction(d);c&&c(t,"multiupload")}this.isUploading=!0,t.send(l)}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype.callbackXHRHandle=function(t){if(this.returnDataArr.push(t),this.returnDataArr.length==this.fileNameArr.length){for(var e=[],i=this.fileNameArr,s=0;s<this.returnDataArr.length;s++){for(var a={},o=WebSquare.xml.parse(this.returnDataArr[s]),n=WebSquare.xml.getChildren(o,"ret"),r=0;r<n.length;r++){var l=n[r]["@tagName"],h=n[r].value,p=WebSquare.xml.findNode(o,"ret/"+l),u=WebSquare.xml.getTextNodeValue(p);switch(l){case"deniedCodeList":a.deniedCode=u||h||"";break;case"deniedList":a.deniedFile=u||h||"";break;case"storedFileList":a.file=u||h||"";break;case"key":a.key=u||h||"";break;case"localfileList":a.localFile=u||h;break;case"maxUploadSize":a.maxUploadSize=u/this.sizeUnit||h/this.sizeUnit;break;case"fileSizeList":a.size=u/this.sizeUnit||h/this.sizeUnit;break;case"subSize":a.subSize=p?u/this.sizeUnit:"";break;default:l&&(a[l]=u||h||"")}}if(1==this.options.callbackSync||"true"==this.options.callbackSync){for(var d=0;d<i.length;d++)if(localFileName.replace(";","")==i[d]){e[d]=a;break}}else e.push(a);this.removeFile(a.file)}"function"==typeof this.callback&&this.callback(e)}},u.prototype._byteCalc=function(t){try{t=parseInt(t);var e=["bytes","KB","MB","GB","TB","PB"],i=Math.floor(Math.log(t)/Math.log(1024));return"-Infinity"==i?"0 "+e[0]:(t/Math.pow(1024,Math.floor(i))).toFixed(2)+" "+e[i]}catch(i){o.Y.printStackTrace(i,null,this)}},u.prototype._clearInput=function(){try{if(this.html5Upload&&"html5"==this.options.mode.toLowerCase());else if(""!=this.dom.inputZone.value)if(a.I.browserCheck.ieAllVersion){var t=document.getElementById(this.id+"_file_input"),e=t.cloneNode(!0),i=t.parentNode;this.event.removeListener(this.dom.inputZone,"onchange",this.html5uploadchange),i.insertBefore(e,t),i.removeChild(t),this.dom.inputZone=e,this.event.addListener2(this.dom.inputZone,"onchange",this.html5uploadchange)}else this.dom.inputZone.value=""}catch(t){o.Y.printStackTrace(t,null,this)}},u.prototype._fireError=function(t,e){if(t)try{var i="",s=(e=e||{name:"",size:0,count:0},{});switch(t){case"fileExist":i=p.B.getMessage("MultiUpload_err_fileExist",e.name)||"File already exists. ("+e.name+")",s.deniedCode="1001";break;case"uploadCountExceed":i=p.B.getMessage("MultiUpload_err_maxCountExceed",e.count)||"The upload count is limited to "+e.count+".",s.deniedCode="1002";break;case"fileSizeExceed":
i=p.B.getMessage("MultiUpload_err_fileSizeExceed",e.size+this.options.displaySizeUnit)||"Upload file size is limited to "+e.size+this.options.displaySizeUnit,s.deniedCode="1003";break;case"HTTPException":i=p.B.getMessage("MultiUpload_err_HTTPExcpetion",e.name)||"HTTP error occured. (status : "+e.name+")",s.deniedCode="1004",s.status=e.name}this.options.fireEventOnError?(s.type=t,s.message=i,n.f.fireEvent(this,"onerror",s)):alert(i)}catch(t){o.Y.printStackTrace(t,null,this)}}}}]);