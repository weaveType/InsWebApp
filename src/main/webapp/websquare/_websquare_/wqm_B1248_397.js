"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[397],{397:(t,e,i)=>{i.r(e),i.d(e,{list:()=>d});var s=i(1570),n=i(866),o=i(2847),r=i(6323),l=i(4171),h=i(3885),a=i(4302),d=function(t,e,i){h.q.call(this,t,e,i)};s.q.extend(d.prototype,h.q.prototype),s.q.extend(d.prototype,a.t.prototype),d.prototype.defaultOptions={pluginType:"uiplugin.list",pluginName:"list",userEvents:["onrowclick"],tagName:"div",sortable:!1,virtualized:!1,visibleRowNum:10,useSearch:!1,_listRowHeight:0,wheelRows:0,placeholder:"",useCloseButton:!1,selectedCellColor:"#FCA73C"},d.prototype.initialize=function(t){if(this.uniqueIdSequence=0,this.listRowInfo=WebSquare.xml.getChildren(t.parentNode,"w2:list")[0],this.listColumnInfo=WebSquare.xml.getChildren(t,"w2:listRow"),this.options.nodeset&&(this.modelDataXMLArr=WebSquare.ModelUtil.findInstanceNodes(this.options.nodeset,null,this.scope_id),this.modelControl.itemsetObj={nodeset:this.options.nodeset,label:"",value:""}),this.options.virtualized){this.options.rowHeight=21;for(var e=this.listRowInfo.style.split(";"),i=0;i<e.length;i++){var s=e[i];if(s.indexOf("height")>-1&&s.indexOf(":")>-1){var n=parseInt(s.split(":")[1].wq_trim().replaceAll("px",""));isNaN(n)||(this.options.rowHeight=n+1)}}}this.listRowObjArr=[],this.isIE67=r.Z.isIEAllVersion("6 7"),this.options.useSearch&&(this.myhelper=new WebSquare.korHelper)},d.prototype.toHTML=function(){var t=[],e=""==this.options.style?"":"style='"+this.options.style+"'";if(t.push("<"+this.options.tagName+" id='"+this.id+"' "+e+" class='w2list w2noselect "+this.options.className+"' tabIndex='0'>"),this.options.virtualized){var i=this.isIE67?"position:relative;height:100%;background-color:white;":"position:relative;width:100%;height:100%;box-sizing:border-box;background-color:white;",s=this.isIE67?"position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%'":"";if(t.push("<div id='"+this.id+"_main' style='"+i+"'>"),this.options.useSearch){var n="height:"+(parseInt(this.options._listRowHeight)-3)+"px;";t.push("<input id='"+this.id+"_input' name='"+this.id+"_input' style='"+n+"'class='w2list_input' placeholder='"+this.options.placeholder+"'></input>")}t.push("<div id='"+this.id+"_items_main' style='"+s+"'>")}if(this.options.nodeset){var o=this.modelDataXMLArr.length;this.options.virtualized&&(o=Math.min(this.modelDataXMLArr.length,this.options.visibleRowNum));for(var l=0;l<o;l++){var h=""==this.listRowInfo.style?"":"style='"+this.listRowInfo.style+"'";t.push("<"+this.listRowInfo.tagName+" "+h+" class='w2list_listRow "+this.listRowInfo.class+"' >");for(var a=0;a<this.listColumnInfo.length;a++){var d=this.listColumnInfo[a],c=d.value,u=WebSquare.xml.getValue(this.modelDataXMLArr[l],d.ref);switch(""!=u&&(c=u),d.inputType){case"checkbox":var p=r.Z.getBoolean(c)?'checked="checked"':"",f=""==d.style?"":" style='"+d.style+"' ";t.push("<input type='checkbox' "+p),t.push(f),t.push(" class='w2list_listColumn w2list_listColumn_checkbox "+d.class+"' >"),t.push("</input>");break;case"text":f=""==d.style?"":" style='"+d.style+"' ";t.push("<span "),t.push(f),t.push(" class='w2list_listColumn w2list_listColumn_text "+d.class+"' >"),t.push(c),t.push("</span>");break;case"button":f=""==d.style?"":" style='"+d.style+"' ";t.push("<input type='button'"),t.push(" value='"+c+"' "),t.push(f),t.push(" class='w2list_listColumn w2list_listColumn_button "+d.class+"' >"),t.push("</input>")}}t.push("</"+this.listRowInfo.tagName+">")}}return this.options.virtualized&&(t.push("</div>"),t.push("<div id='"+this.id+"_scroll_main' class='w2list_scroll_main' style='position:absolute;right:0;top:0;height:100%;padding:1px;background-color:#ccc;box-sizing:border-box;'>"),t.push("<div id='"+this.id+"_scroll_track' class='w2list_scroll_track' style='position:relative;width:100%;height:100%;background-color:#eee;box-sizing:border-box;'>"),
t.push("<div id='"+this.id+"_scroll_thumb' class='w2list_scroll_thumb' style='position:absolute;width:100%;height:100%;left:1px;width:8px;background-color:#bbb;border-radius:3px'>"),t.push("</div>"),t.push("</div>"),t.push("</div>"),t.push("</div>")),t.push("</"+this.options.tagName+">"),t.join("")},d.prototype.setPreAction=function(){try{this.options.useSearch&&(this.dom.input=this.getElementById(this.id+"_input"))}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.setAction=function(){if(this.initializeListInfo(),this.options.virtualized){var t=this.getElementById(this.id+"_items_main");r.Z.isTouchDevice()?this.event.addListener(t,"onpointerup",this.event.bindAsEventListener(this,this.handleClickEvent)):this.event.addListener(t,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),this.event.addListener(t,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(t,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),r.Z.isIE()?this.event.addListener(t,"onmousewheel",this.event.bindAsEventListener(this,this.handleMousewheelEvent)):this.event.addListener(t,"onwheel",this.event.bindAsEventListener(this,this.handleMousewheelEvent)),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent))}else r.Z.isTouchDevice()?this.event.addListener(this.render,"onpointerup",this.event.bindAsEventListener(this,this.handleClickEvent)):this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent));if(this.options.sortable&&(1==this.isMobile||this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent))),this.options.virtualized){this.adjustRender();var e=this.getElementById(this.id+"_scroll_thumb"),i=this.getElementById(this.id+"_scroll_track");this.event.addListener(e,"onmouseenter",this.event.bindAsEventListener(this,(function(t){e.style.backgroundColor="#aaa"}))),this.event.addListener(e,"onmouseleave",this.event.bindAsEventListener(this,(function(t){this.scrollStarted||(e.style.backgroundColor="#bbb")}))),this.event.addListener(e,"onmousedown",this.event.bindAsEventListener(this,(function(t){this.listRowObjArr.length>0&&(this.scrollStarted=!0,this.scrollStartMouseEvent={},this.scrollStartMouseEvent.clientY=t.clientY,this.scrollStartMouseEvent.original_top=e.offsetTop,this.scrollStartMouseEvent.max_top=e.parentElement.offsetHeight-e.offsetHeight,e.style.backgroundColor="#999")}))),this.event.addListener(i,"onclick",this.event.bindAsEventListener(this,(function(t){if(!this.scrollStarted){if((r.Z.isIE()?t.srcElement:t.target)!=i)return;o.f.stopPropagation(t);var s=t.offsetY-e.offsetHeight/2;if(s<0&&(s=0),s>e.parentElement.offsetHeight-e.offsetHeight&&(s=e.parentElement.offsetHeight-e.offsetHeight),e.offsetTop!=s){e.style.top=s+"px";var n=this.listRowObjArr.length-this.options.visibleRowNum;if(n>0){var l=(i.offsetHeight-e.offsetHeight)/n,h=Math.floor(s/l);this.setFirstRowIndex(h,!0)}else this.setFirstRowIndex(0,!0)}}}))),this.event.addListener(this.parentControl.render,"onmouseup",this.event.bindAsEventListener(this,(function(t){this.scrollStarted&&(this.scrollStarted=!1,e.style.backgroundColor="#bbb")}))),this.event.addListener(this.parentControl.render,"onmouseleave",this.event.bindAsEventListener(this,(function(t){this.scrollStarted&&(this.scrollStarted=!1,e.style.backgroundColor="#bbb")}))),this.event.addListener(this.parentControl.render,"onmousemove",this.event.bindAsEventListener(this,(function(t){if(this.scrollStarted){var s=t.clientY-this.scrollStartMouseEvent.clientY,n=this.scrollStartMouseEvent.original_top+s;if(n<0&&(n=0),
n>this.scrollStartMouseEvent.max_top&&(n=this.scrollStartMouseEvent.max_top),e.offsetTop!=n){e.style.top=n+"px";var o=this.listRowObjArr.length-this.options.visibleRowNum;if(o>0){var r=(i.offsetHeight-e.offsetHeight)/o,l=Math.floor(n/r);this.setFirstRowIndex(l,!0)}else this.setFirstRowIndex(0,!0)}}})))}},d.prototype.setLayout=function(){},d.prototype.initializeListInfo=function(){try{if(this.options.nodeset){for(var t=r.Z.getDataPrefix("unique_id"),e=0;e<this.modelDataXMLArr.length;e++){var i,s,o,l=this.id+"_"+this.uniqueIdSequence;WebSquare.xml.setAttribute(this.modelDataXMLArr[e],t,l),this.render.childNodes[e].setAttribute(t,l);for(var h={},a=0;a<this.listColumnInfo.length;a++)s=(i=this.listColumnInfo[a]).value,""!=(o=WebSquare.xml.getValue(this.modelDataXMLArr[e],i.ref))&&(s=o),h[i.id]=s;h[t]=l,this.listRowObjArr.push(h),this.uniqueIdSequence++}this.onListRowObjArrChanged()}}catch(t){n.Y.printStackTrace(t)}},d.prototype.refreshItemset=function(){try{if(this.modelControl.isItemsetBinded()){var t=WebSquare.ModelUtil.findInstanceNodes(this.options.nodeset,null,this.scope_id);this.modelDataXMLArr=t;var e=this.listRowObjArr;this.listRowObjArr=[];for(var i=0;i<this.modelDataXMLArr.length;i++)this.listRowObjArr[i]=this.createObjByXML(this.modelDataXMLArr[i]);var s=r.Z.getDataPrefix("unique_id");for(i=0;i<e.length;i++)for(var o=0;o<this.listRowObjArr.length;o++)if(e[i][s]==this.listRowObjArr[o][s]){e[i].exist=!0;break}for(i=0;i<e.length;i++)if(1!=e[i].exist){var l=this.getRenderByUniqueId(e[i][s]);l.parentNode.removeChild(l)}for(i=0;i<this.listRowObjArr.length;i++){var h=this.listRowObjArr[i],a=this.getRenderByUniqueId(h[s]);if(a){for(o=0;o<e.length;o++){var d=e[o];if(d[s]==h[s])for(var c=0;c<this.listColumnInfo.length;c++){var u=h[this.listColumnInfo[c].id];if(d[this.listColumnInfo[c].id]!=u)switch(this.listColumnInfo[c].inputType){case"checkbox":a.childNodes[c].checked=r.Z.getBoolean(u);break;case"text":a.childNodes[c].innerHTML=u;break;case"button":a.childNodes[c].value=u}}}var p;for(o=0;o<this.getLength();o++){var f=this.render.childNodes[o];a.getAttribute(s)==f.getAttribute(s)&&(p=o)}this.moveRowRender(p,i)}else this.insertRowRender(i,this.listRowObjArr[i])}this.onListRowObjArrChanged()}}catch(t){n.Y.printStackTrace(t)}},d.prototype.refresh=function(){},d.prototype.insertInModel=function(t,e,i){try{switch(i){case"append":var s=this.options.nodeset.split("/");s.splice(s.length-1,1);var o=s;o=o.join("/"),WebSquare.ModelUtil.setInstanceNode(e,o,null,"append");break;case"insertBeforeSibling":WebSquare.ModelUtil.setInstanceNode(e,this.options.nodeset+"["+(t+1)+"]",null,"insertBeforeSibling");break;case"appendSibling":WebSquare.ModelUtil.setInstanceNode(e,this.options.nodeset+"["+t+"]",null,"appendSibling");break;default:return}}catch(t){n.Y.printStackTrace(t)}},d.prototype.removeFromModel=function(t){try{WebSquare.ModelUtil.removeInstanceNode(this.options.nodeset+"["+(t+1)+"]")}catch(t){n.Y.printStackTrace(t)}},d.prototype.insertRow=function(t,e){try{var i=this.getChildNodes(),s=i.length;if(t<0)return;if(t>s&&(t=s),this.options.nodeset){var o=this.createXMLByObj(e);0==i.length?this.insertInModel(t,o,"append"):i.length>t&&t>=0?this.insertInModel(t,o,"insertBeforeSibling"):this.insertInModel(t,o,"appendSibling")}else this.insertRowNM(t,e)}catch(t){n.Y.printStackTrace(t)}},d.prototype.insertRowNM=function(t,e){try{var i=this.getLength();e[r.Z.getDataPrefix("unique_id")]=this.id+"_"+this.uniqueIdSequence,this.uniqueIdSequence++,i>t&&t>=0?this.listRowObjArr.splice(t,0,e):this.listRowObjArr.push(e),this.onListRowObjArrChanged(),this.insertRowRender(t,e)}catch(t){n.Y.printStackTrace(t)}},d.prototype.insertRenderStr=function(t){try{var e,i,s=r.Z.getDataPrefix("unique_id");t[s]=this.id+"_"+this.uniqueIdSequence,this.uniqueIdSequence++,this.listRowObjArr.push(t),this.onListRowObjArrChanged()
;for(var o="<"+this.listRowInfo.tagName+" class='w2list_listRow "+this.listRowInfo.class+"' style='"+this.listRowInfo.style+"' "+s+"='"+t[s]+"'>",l=0;l<this.listColumnInfo.length;l++){var h=this.listColumnInfo[l].id;null!=t[h]||null!=t[h]?e=t[h]:(e=this.listColumnInfo[l].value,t[this.listColumnInfo[l].id]=this.listColumnInfo[l].value),i=this.listColumnInfo[l],o+=this.createItemNodeStr(i,e)}return o+="</"+this.listRowInfo.tagName+">"}catch(t){n.Y.printStackTrace(t)}},d.prototype.insertRowRender=function(t,e){try{var i=this.getChildNodes(),s=i.length;if(t<0)return;t>s&&(t=s);var o=this.createRenderByObj(e);i.length>t&&t>=0?this.render.insertBefore(o,i[t]):this.render.appendChild(o)}catch(t){n.Y.printStackTrace(t)}},d.prototype.removeRow=function(t){try{this.getChildNodes().length>t&&t>=0&&(this.options.nodeset?this.removeFromModel(t):this.removeRowNM(t))}catch(t){n.Y.printStackTrace(t)}},d.prototype.removeRowNM=function(t){try{this.removeRowRender(t),this.listRowObjArr.splice(t,1),this.onListRowObjArrChanged()}catch(t){n.Y.printStackTrace(t)}},d.prototype.removeRowRender=function(t){try{var e=this.options.virtualized?this.getElementById(this.id+"_items_main"):this.getElementById(this.id),i=e.children;i.length>t&&t>=0&&e.removeChild(i[t])}catch(t){n.Y.printStackTrace(t)}},d.prototype.removeAll=function(){try{this.options.nodeset?WebSquare.ModelUtil.removeInstanceNodes(this.options.nodeset):(this.listRowObjArr=[],this.render.innerHTML=""),this.onListRowObjArrChanged()}catch(t){n.Y.printStackTrace(t)}},d.prototype.moveRow=function(t,e){try{var i=this.getChildNodes(),s=i.length;if(t>s||e>s)return;if(t>=0&&e>=0)if(this.options.nodeset){var o=this.modelDataXMLArr[t];i.length-1>e&&e>=0?(this.removeFromModel(t),this.insertInModel(e,o,"insertBeforeSibling")):(this.removeFromModel(t),this.insertInModel(e,o,"appendSibling"))}else this.moveRowNM(t,e)}catch(t){n.Y.printStackTrace(t)}},d.prototype.moveRowNM=function(t,e){try{this.moveRowRender(t,e);var i=this.listRowObjArr.splice(t,1)[0];this.listRowObjArr.splice(e,0,i),this.onListRowObjArrChanged()}catch(t){n.Y.printStackTrace(t)}},d.prototype.moveRowRender=function(t,e){try{var i=this.getChildNodes(),s=i.length;if(t>s||e>s)return;if(t>=0&&e>=0){var o=i[t];if(i.length-1>e&&e>=0){var r=e>t?e+1:e;this.render.insertBefore(o,i[r])}else this.render.appendChild(o)}}catch(t){n.Y.printStackTrace(t)}},d.prototype.getLength=function(){try{return this.options.virtualized?this.listRowObjArr?this.listRowObjArr.length:0:this.getChildNodes().length}catch(t){n.Y.printStackTrace(t)}},d.prototype.getChildNodes=function(){try{if("dl"==this.options.tagName||this.options.useCloseButton){for(var t=[],e=0;e<this.render.childNodes.length;e++){var i=this.render.childNodes[e];"3"!=i.nodeType&&t.push(i)}return t}return this.render.getElementsByTagName(this.listRowInfo.tagName)}catch(t){n.Y.printStackTrace(t)}},d.prototype.getRenderByUniqueId=function(t){try{for(var e=r.Z.getDataPrefix("unique_id"),i=0;i<this.getLength();i++){var s=this.render.childNodes[i];if(s.getAttribute(e)==t)return s}}catch(t){n.Y.printStackTrace(t)}},d.prototype.getCellData=function(t,e){try{var i,s=this.getLength();if("string"==typeof t||!(s>t&&t>=0))return;"string"==typeof e?i=e:"number"==typeof e&&(i=this.listColumnInfo[e].id);var o=this.listRowObjArr[t];return o?o[i]:""}catch(t){n.Y.printStackTrace(t)}},d.prototype.setCellData=function(t,e,i){try{var s,o,l,h=this.getLength();if("string"==typeof t||!(h>t&&t>=0))return;if("string"==typeof e){s=e;for(var a=0;a<this.listColumnInfo.length;a++)if(s==this.listColumnInfo[a].id){o=a;break}}else"number"==typeof e&&(o=e,s=this.listColumnInfo[e].id);if(l=this.getCellData(t,s),this.options.nodeset){var d,c;for(a=0;a<this.listColumnInfo.length;a++)if(s==(c=this.listColumnInfo[a]).id){d=c.ref;break}if(!d)return;WebSquare.ModelUtil.setInstanceValue(this.options.nodeset+"["+(t+1)+"]/"+d,i),l!==i&&this.fireOnchange()}else if(this.listRowObjArr[t][s]=i,
this.options.virtualized)this.setFirstRowIndex(this.firstListIndex);else{var u=this.getChildNodes()[t],p=this.listColumnInfo[o].inputType,f=u.childNodes[o];switch(p){case"checkbox":f.checked=r.Z.getBoolean(i);break;case"text":f.innerHTML=i;break;case"button":f.value=i}}}catch(t){n.Y.printStackTrace(t)}},d.prototype.getRowData=function(t){try{var e=this.getLength();if("string"==typeof t||!(e>t&&t>=0))return;var i={},s=this.listRowObjArr[t],o=r.Z.getDataPrefix("unique_id");for(var l in s)l!=o&&"render"!=l&&(i[l]=s[l]);return i}catch(t){n.Y.printStackTrace(t)}},d.prototype.setRowData=function(t,e,i){try{var s=this.getLength();if("string"==typeof t||!(s>=t&&t>=0)||"object"!=typeof e)return;if(!i)return void(this.options.nodeset?this.insertRow(s,e):this.insertRowNM(s,e));e&&(this.options.nodeset?(this.removeRow(t),this.insertRow(t,e)):(this.removeRowNM(t),this.insertRowNM(t,e)))}catch(t){n.Y.printStackTrace(t)}},d.prototype.setXML=function(t,e){null!=t||l.v.printLog("[WebSquare.uiplugin.list.setXML] XML is null["+this.id+"]")},d.prototype.setJSON=function(t,e){try{if(null==t)return void l.v.printLog("[WebSquare.uiplugin.list.setJSON] data is null["+this.id+"]");if(e&&0==t.length)return;var i,s="";if(e||(this.listRowObjArr=[],this.options.virtualized&&(this.getElementById(this.id+"_items_main").innerHTML="")),this.options.virtualized)i=e?this.listRowObjArr.length:0,this.listRowObjArr=this.listRowObjArr.concat(t),this.adjustRender(),this.setFirstRowIndex(i);else{for(var o=0;o<t.length;o++)i=e?this.getLength+o:o,this.options.nodeset?this.insertRow(i,t[o]):e?this.insertRowNM(i,t[o]):s+=this.insertRenderStr(t[o]);e||(this.render.innerHTML=s)}}catch(t){n.Y.printStackTrace(t)}},d.prototype.toggleCheckbox=function(t,e){try{var i=this.getLength();if("string"==typeof t||"number"==typeof e)return;if(i>t&&t>=0){var s=r.Z.getBoolean(this.getCellData(t,e));this.setCellData(t,e,!s)}}catch(t){n.Y.printStackTrace(t)}},d.prototype.createItemNode=function(t,e){try{if(t){var i,s=r.Z.getDataPrefix("check_id"),o=r.Z.getDataPrefix("itemid");switch(t.inputType){case"checkbox":(i=document.createElement("input")).setAttribute("type","checkbox"),i.setAttribute(o,t.id),i.setAttribute("class","w2list_listColumn w2list_listColumn_checkbox "+t.class),this.isIE67&&(i.className="w2list_listColumn w2list_listColumn_checkbox "+t.class),!0===(e=r.Z.getBoolean(e))&&i.setAttribute("checked","checked");break;case"text":(i=document.createElement("span")).setAttribute(o,t.id),i.setAttribute("class","w2list_listColumn w2list_listColumn_text "+t.class),this.isIE67&&(i.className="w2list_listColumn w2list_listColumn_text "+t.class),t.check_id&&i.setAttribute(s,t.check_id),null!=e&&null!=e&&(i.innerHTML=e.toString());break;case"button":(i=document.createElement("input")).setAttribute("type","button"),i.setAttribute(o,t.id),i.setAttribute("class","w2list_listColumn w2list_listColumn_button "+t.class),this.isIE67&&(i.className="w2list_listColumn w2list_listColumn_button "+t.class),e&&i.setAttribute("value",e)}return i&&t.style&&i.setAttribute("style",t.style),i}}catch(t){n.Y.printStackTrace(t)}},d.prototype.createItemNodeStr=function(t,e){try{if(t){var i,s=""==t.style?"":"style='"+t.style+"'";switch(t.inputType){case"checkbox":i="<input type='checkbox' class='w2list_listColumn w2list_listColumn_checkbox "+t["_class".slice(1)]+"' "+s,!0===(e=r.Z.getBoolean(e))&&(i+=" checked='checked'"),i+="/>";break;case"text":var o="w2list_listColumn_text";this.options.useCloseButton&&(o="w2list_listColumn_text_with_closeButton"),i="<span class='w2list_listColumn "+o+" "+t["_class".slice(1)]+"' "+s+">",null!=e&&null!=e&&(i+=WebSquare.xml.encode(e.toString())),i+="</span>",this.options.useCloseButton&&(i+="<div class='w2list_listColumn_close'></div>");break;case"button":i="<input type='button' class='w2list_listColumn w2list_listColumn_button "+t["_class".slice(1)]+"' "+s,(e=r.Z.getBoolean(e))&&(i+=" value='checked'"),i+="/>";break;case"link":
i="<a class='w2list_listColumn w2list_listColumn_link "+t["_class".slice(1)]+"' "+s+" href='javascript:void(null);'>",null!=e&&null!=e&&(i+=WebSquare.xml.encode(e.toString())),i+="</a>"}return i}}catch(t){n.Y.printStackTrace(t)}},d.prototype.getAllData=function(){try{if(this.options.virtualized)return this.listRowObjArr;for(var t=[],e=this.getLength(),i=0;i<e;i++){var s=this.getRowData(i);t.push(s)}return t}catch(t){n.Y.printStackTrace(t)}},d.prototype.createXMLByObj=function(t){try{var e=this.options.nodeset.split("/"),i=e[e.length-1],s=WebSquare.xml.parse("<"+i+" />").documentElement,o=r.Z.getDataPrefix("unique_id");t[o]?WebSquare.xml.setAttribute(s,o,t[o]):(WebSquare.xml.setAttribute(s,o,this.id+"_"+this.uniqueIdSequence),this.uniqueIdSequence++);for(var l=0;l<this.listColumnInfo.length;l++){var h=this.listColumnInfo[l].ref,a=h.lastIndexOf("/");if(a>0){var d=h.substring(0,a),c=h.substring(a+1);if(c.match(/[@'"()=]/i).length>0){var u=WebSquare.xml.createNode(s,d,!1);(p=t[this.listColumnInfo[l].id])||(p=this.listColumnInfo[l].value),c=c.replace(/[@'"()=]/i,""),WebSquare.xml.setAttribute(u,c,p)}else WebSquare.xml.createNode(s,h,!1)}else{var p,f=this.listColumnInfo[l].ref.replace(/[@'"()=]/i,"");(p=t[this.listColumnInfo[l].id])||(p=this.listColumnInfo[l].value),WebSquare.xml.setAttribute(s,f,p)}}return s}catch(t){n.Y.printStackTrace(t)}},d.prototype.createRenderByObj=function(t,e){try{if(t){var i=r.Z.getDataPrefix("unique_id"),s=r.Z.getDataPrefix("check_id");t[i]||(t[i]=this.id+"_"+this.uniqueIdSequence,this.uniqueIdSequence++);var o,l,h,a=document.createElement(this.listRowInfo.tagName);a.setAttribute("class","w2list_listRow "+this.listRowInfo.class),a.setAttribute("style",this.listRowInfo.style),this.isIE67&&(a.className="w2list_listRow "+this.listRowInfo.class,a.style.cssText=this.listRowInfo.style),a.setAttribute(i,t[i]),this.listRowInfo.check_id&&a.setAttribute(s,this.listRowInfo.check_id);for(var d=[],c=0;c<this.listColumnInfo.length;c++){var u=this.listColumnInfo[c].id;null!=t[u]||null!=t[u]?o=t[u]:(o=this.listColumnInfo[c].value,t[this.listColumnInfo[c].id]=this.listColumnInfo[c].value),h=this.listColumnInfo[c],l=this.createItemNode(h,o),d[c]=l}if(0!=d.length)for(c=0;c<d.length;c++)d[c]&&a.appendChild(d[c]);this.options.virtualized&&(a.style.backgroundColor=e?this.options.selectedCellColor:"")}return a}catch(t){n.Y.printStackTrace(t)}},d.prototype.createObjByXML=function(t){try{for(var e,i,s,o={},l=0;l<this.listColumnInfo.length;l++)i=(e=this.listColumnInfo[l]).value,""!=(s=WebSquare.xml.getValue(t,e.ref))&&(i=s),o[e.id]=i;var h=r.Z.getDataPrefix("unique_id");return o[h]=t.getAttribute(h),o}catch(t){n.Y.printStackTrace(t)}},d.prototype.handleClickEvent=function(t){try{var e=r.Z.getDataPrefix("unique_id"),i=r.Z.getDataPrefix("check_id"),s=r.Z.getDataPrefix("itemid");if(this.options.virtualized){for(var l,h,a,d="",c=this.getElementById(this.id+"_items_main"),u=this.event.getTargetIterator(t,this.render);u.next()&&!u.match(null,this.id)&&!u.match(null,c.id);){if(u.match("w2list_listRow")){""==d&&(d="w2list_listRow"),l=(f=u.getElement()).getAttribute(e),this.options.labelCheck&&(a=f.getAttribute(i));break}if(u.match("w2list_listColumn_checkbox"))d="w2list_listColumn_checkbox",h=(f=u.getElement()).getAttribute(s);else if(u.match("w2list_listColumn_text")){d="w2list_listColumn_text",h=(f=u.getElement()).getAttribute(s),this.options.labelCheck&&(a=f.getAttribute(i))}else if(u.match("w2list_listColumn_button")){d="w2list_listColumn_button",h=(f=u.getElement()).getAttribute(s)}}if(u=null,""!=d&&l)for(var p=0;p<this.listRowObjArr.length;p++)if(this.listRowObjArr[p][e]==l){switch(d){case"w2list_listRow":o.f.fireEvent(this,"onrowclick",p,{target:t.target||t.srcElement}),this.options.labelCheck&&this.toggleCheckbox(p,a);break;case"w2list_listColumn_text":this.options.labelCheck&&this.toggleCheckbox(p,a);break;case"w2list_listColumn_checkbox":this.toggleCheckbox(p,h)}this.selectedIndex=p;break}
this.setFirstRowIndex(this.firstListIndex,!0)}else{for(u=this.event.getTargetIterator(t,this.render);u.next()&&!u.match(null,this.id);){if(u.match("w2list_listRow")){var f=u.getElement();for(p=0;p<this.listRowObjArr.length;p++)if(this.getRenderByUniqueId(this.listRowObjArr[p][e])==f)return g=p,void o.f.fireEvent(this,"onrowclick",g,{target:t.target||t.srcElement})}if(u.match("w2list_listColumn_checkbox")){var g,v;for(f=u.getElement(),p=0;p<this.listRowObjArr.length;p++)for(var m=0;m<this.listColumnInfo.length;m++)if(this.getRenderByUniqueId(this.listRowObjArr[p][e])&&this.getRenderByUniqueId(this.listRowObjArr[p][e]).childNodes[m]==f)return g=p,v=this.listColumnInfo[m].id,void this.toggleCheckbox(g,v)}}u=null}}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.fireOnchange=function(){try{o.f.fireEvent(this,"onchange")}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.handleMouseoverEvent=function(t){try{for(var e=this.event.getTargetIterator(t,this.render);e.next()&&!e.match(null,this.id);)e.match("w2list_listRow")&&this.addClass(e.getElement(),"w2list_listRow_over");e=null}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.handleMouseoutEvent=function(t){try{for(var e=this.event.getTargetIterator(t,this.render);e.next()&&!e.match(null,this.id);)e.match("w2list_listRow")&&this.removeClass(e.getElement(),"w2list_listRow_over");e=null}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.handleMousewheelEvent=function(t){try{var e;o.f.stopEvent(t),this.options.wheelRows>0?(e=o.f.getMouseWheelDelta(t),e=-1*Math.round(this.options.wheelRows*e)):e=r.Z.isFF()?t.deltaY:r.Z.isIEAllVersion(11)?t.deltaY/40:t.wheelDelta/-40;var i=Math.floor(e),s=this.firstListIndex+i;this.setFirstRowIndex(s)}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.handleKeydownEvent=function(t){try{if(this.options.useSearch&&this.event.isMe(t,this.dom.input)&&(this.editmode=!0,this.inputKeyDown(t,!1)),this.options.virtualized){var e=t.charCode?t.charCode:t.keyCode;if(38==e){var i=this.firstListIndex?this.firstListIndex:0;null!=this.selectedIndex?(this.selectedIndex--,this.selectedIndex<0&&(this.selectedIndex=0),(this.selectedIndex<this.firstListIndex||this.selectedIndex>this.firstListIndex+(this.options.visibleRowNum-1))&&(i=this.selectedIndex)):i--,this.setFirstRowIndex(i)}else if(40==e){i=this.firstListIndex?this.firstListIndex:0;null!=this.selectedIndex?(this.selectedIndex++,this.selectedIndex>=this.listRowObjArr.length&&(this.selectedIndex=this.listRowObjArr.length-1),(this.selectedIndex<this.firstListIndex||this.selectedIndex>this.firstListIndex+(this.options.visibleRowNum-1))&&(i=this.selectedIndex-(this.options.visibleRowNum-1))):i++,this.setFirstRowIndex(i)}}}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.inputKeyDown=function(t,e){},d.prototype.handleDragEvent=function(t){for(var e=this.event.getTargetIterator(t),i=r.Z.getDataPrefix("unique_id");e.next();)if(e.match("w2list_listRow")){if(!this.options.sortable)return;e.getElement().style.cursor="pointer",r.Z.emptySelection();for(var s,n=this.id,o=e.getElement(),l=this.getChildNodes(),h=0;h<l.length;h++)if(l[h]==o){s=h;break}var a=this;return void WebSquare.dragdrop.gDragManager.activate(t,o,{id:this.id+"_drag",className:"w2list w2list_listRow w2list_drag",contents:this.options.detachMessage||" detached item ",delay:15,detachIdx:s,detachListId:n,applyMousePosition:!0,onDrop:function(t,e,s,n,o,l,h){var d,c,u,p,f=!1,g=this.detachIdx,v=this.detachListId,m=a,b=null;for(this.isMobile?(b=new WebSquare.targetIterator(document.elementFromPoint(h.changedTouches[0].clientX,h.changedTouches[0].clientY)),h.preventDefault()):b=a.event.getTargetIterator(h);b.next();){if(b.match("w2list_listRow")){f=!0;for(var w=(p=b.getElement()).parentNode.childNodes,y=0;y<w.length;y++)if(w[y]==p){u=y;break}}if(b.match("w2list")){f=!0,c=b.getElement().id,d=r.Z.getComponentById(c);break}if(b.match(null,null,"body"))return}if(f){var I=!1;if("object"==typeof p&&"number"==typeof u||(I=!0,p=t,
u=d?0==d.getLength()?0:d.getLength():0),v==c)g!=(u=I?u-1:u)&&(m.options.nodeset?m.moveRow(g,u):m.moveRowNM(g,u));else{var R=m.listRowObjArr[g];if(m.options.nodeset?m.removeRow(g):m.removeRowNM(g),delete R[i],!d)return;d.options.nodeset?d.insertRow(u,R):d.insertRowNM(u,R)}}}})}},d.prototype.getMaxItemWidth=function(t){try{var e,i,s=0;e=this.options.virtualized?document.getElementById(this.id+"_items_main"):this.render;for(var o=0;o<e.childNodes.length;o++){for(var r=0,l=e.childNodes[o],h=0;h<l.childNodes.length;h++)r+=WebSquare.style.getSize(l.childNodes[h],"width");r>s&&(s=r),i=o}if(this.options.virtualized){for(h=i;h<this.listRowObjArr.length;h++){var a=this.listRowObjArr[h].id2,d=0;a&&(d=WebSquare.util.getWidth(a)),d>s&&(s=d)}var c=e.getElementsByTagName("input")[0];if(c&&"checkbox"===c.type){var u=WebSquare.style.getSize(c,"outerMarginWidth");u>0&&(s+=u)}return s}return s+10}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.setFirstRowIndex=function(t,e){try{t=Math.max(0,Math.min(this.listRowObjArr.length-this.options.visibleRowNum,t)),this.firstListIndex=t;var i=this.getAllData();if(i.length>0){e||this.adjustScrollYThumb(t);for(var s=0;s<Math.min(this.options.visibleRowNum,this.listRowObjArr.length);s++){if(this.fastDrawRawData(s,t+s),this.isIE67)this.getElementById(this.id+"_items_main").getElementsByTagName("input")[s].checked=i[s].id1}}}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype._setSelectedIndex=function(){try{for(var t=0;t<this.getLength();t++){var e=this.render.childNodes[t];t===this.selectedIndex?(this.addClass(e,"w2list_listRow_over"),e.setAttribute("aria-selected","true"),e.firstChild.focus()):(this.removeClass(e,"w2list_listRow_over"),e.setAttribute("aria-selected","false"))}}catch(t){n.Y.printStackTrace(t,null,this)}},d.prototype.adjustRender=function(){var t=this.options.rowHeight,e=this.options.useSearch?1:0;this.render.style.height=t*(Math.min(this.listRowObjArr.length,this.options.visibleRowNum)+e)+"px";var i=this.getElementById(this.id+"_main"),s=this.getElementById(this.id+"_scroll_main"),n=this.listRowObjArr.length>this.options.visibleRowNum;if(i&&s){var o=12;n?(o=12,i.style.paddingRight=this.isIE67?"0":"12px",s.style.width=o+"px",s.style.display="block"):(o=0,i.style.paddingRight="0",s.style.width=o+"px",s.style.display="none"),this.options.useSearch}this.onListRowObjArrChanged()},d.prototype.adjustScrollYThumb=function(t){if(this.options.virtualized){var e=this.getElementById(this.id+"_scroll_thumb"),i=this.getElementById(this.id+"_scroll_track"),s=this.listRowObjArr.length-this.options.visibleRowNum;if(t>s)e.style.top=i.offsetHeight-i.offsetHeight+"px";else{var n=(i.offsetHeight-e.offsetHeight)/s;isNaN(n)&&(n=0),e.style.top=t*n+"px"}}},d.prototype.fastDrawRawData=function(t,e){var i,s=this.getElementById(this.id+"_items_main");if(s.children.length>t){var n=r.Z.getDataPrefix("unique_id"),o=s.children[t];this.selectedIndex===e?o.style.backgroundColor=this.options.selectedCellColor:o.style.backgroundColor="";var l=this.listRowObjArr[e];l[n]||(l[n]=this.id+"_"+this.uniqueIdSequence,this.uniqueIdSequence++),s.children[t].setAttribute(n,l[n]);for(var h=0;h<this.listColumnInfo.length;h++){var a=this.listColumnInfo[h].id;null!=l[a]||null!=l[a]?(i=l[a],this.options.virtualized&&"id2"==a&&(i=l.formattedValue||i)):(i=this.listColumnInfo[h].value,l[this.listColumnInfo[h].id]=this.listColumnInfo[h].value);var d=this.listColumnInfo[h];this.updateItemNode(d,i,t,h)}}else{var c=this.createRenderByObj(this.listRowObjArr[e],this.selectedIndex===e);s.appendChild(c)}},d.prototype.updateItemNode=function(t,e,i,s){try{if(t){var o=this.getElementById(this.id+"_items_main").children[i].children[s];switch(t.inputType){case"checkbox":e=r.Z.getBoolean(e),o.checked=!0===e;break;case"text":null!=e&&null!=e&&(o.innerHTML=e.toString());break;case"button":e&&o.setAttribute("value",e)}}}catch(t){n.Y.printStackTrace(t)}},d.prototype.saveState=function(t){try{if(null==t)return;t=t.toString(),
this.state||(this.state={}),this.state[t]={selectedIndex:this.selectedIndex,firstListIndex:this.firstListIndex}}catch(t){n.Y.printStackTrace(t)}},d.prototype.loadState=function(t){try{if(null==t)return;t=t.toString(),this.state||(this.state={}),this.state[t]?(this.selectedIndex=this.state[t].selectedIndex,this.firstListIndex=this.state[t].firstListIndex):(this.selectedIndex=void 0,this.firstListIndex=0),this.setFirstRowIndex(this.firstListIndex)}catch(t){n.Y.printStackTrace(t)}},d.prototype.onListRowObjArrChanged=function(){try{if(this.options.virtualized){var t=this.getElementById(this.id+"_scroll_thumb"),e=this.getElementById(this.id+"_scroll_track");if(this.options.visibleRowNum>=this.listRowObjArr.length)t.style.height="100%";else{var i=e.offsetHeight*(this.options.visibleRowNum/this.listRowObjArr.length);i<28&&(i=28),i=i.toString()+"px",t.style.height=i}}}catch(t){n.Y.printStackTrace(t)}},d.prototype.setCellDataNM=function(t,e,i){try{var s,o,l=this.getLength();if("string"==typeof t||!(l>t&&t>=0))return;if("string"==typeof e){s=e;for(var h=0;h<this.listColumnInfo.length;h++)if(s==this.listColumnInfo[h].id){o=h;break}}else"number"==typeof e&&(o=e,s=this.listColumnInfo[e].id);if(this.options.virtualized){if(this.getElementById(this.id+"_items_main").children.length>t&&this.updateItemNode(this.listColumnInfo[o],i,t,o),"id2"==e&&this.listRowObjArr&&this.listRowObjArr[t])i!=this.listRowObjArr[t][e]&&(this.listRowObjArr[t].formattedValue=i)}else{var a=this.getChildNodes()[t],d=this.listColumnInfo[o].inputType,c=a.childNodes[o];switch(d){case"checkbox":c.checked=r.Z.getBoolean(i);break;case"text":c.innerHTML=i;break;case"button":c.value=i}}}catch(t){n.Y.printStackTrace(t)}}}}]);