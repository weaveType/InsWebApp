<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title></title>
    <script type="text/javascript" src="htmlCommon.js"></script>
    <script>
        function _safeInnerHTML(elem, str) {
        try {
            if (!elem || typeof elem.textContent !== "string") {
                return;
            }
            if (typeof str !== "string") {
                str = "";
            }
            if (str.indexOf("<") >= 0) {
                elem.textContent = "";
                var pattern1 = /<\s*script/ig;
                var pattern2 = /\s*\/\s*script\s*>/ig;
                var safeElem = "wq-safescr";
                str = str.replace(pattern1, "<" + safeElem).replace(pattern2, "/" + safeElem +">");
                if (location.hostname !== window.document.domain) {
                    var tempDiv = document.createElement("div");
                    tempDiv.innerHTML = str;
                    while (tempDiv.firstChild) {
                        elem.appendChild(tempDiv.firstChild);
                    }
                } else {
                    var parser = new DOMParser();
                    var bodyContent = parser.parseFromString(str, "text/html").body;
                    for (var i = 0; i < bodyContent.childNodes.length; i++) {
                        var node = bodyContent.childNodes[i];
                        if (node.nodeType !== 1 || node.tagName.toUpperCase() !== "SCRIPT") {
                            elem.appendChild(node.cloneNode(true));
                        }
                    }
                }
            } else {
                elem.textContent = str;
            }
        } catch (e) {
            console.error(e);
        }
    }
		try {
		    var domain = getParameter("domain");  
		    if(domain) {
		        document.domain = domain;   
		    }
		} catch (e) {
			opener.WebSquare.exception.printStackTrace(e);
		}
		
		window.onload = doInit;
		
		function doInit() {
			var id = getParameter( "id" );
			var css = "";
			for( var i = 0; i < opener.document.styleSheets.length ; i++ ) {
				css += opener.document.styleSheets[i].cssText + "\n";
			}
		//	showObject( css );
			document.styleSheets[0].cssText = css;
			_safeInnerHTML(out, opener.document.all[id].outerHTML);
		//	document.styleSheets[0].cssText = opener.getStylesheet();
		//	_safeInnerHTML(out, opener.getObject( id ));
			print();
		}
    </script>
</head>    
<body>
    <div id="out" >
    </div>
</body>
</html>