"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[6790],{6790:function(t,e,i){i.r(e),i.d(e,{editor:function(){return p}});var o=i(467),n=i(4756),s=i.n(n),a=i(5461),r=i(5375),c=i(8971),l=i(2338),d=i(1204),h=i(2256),u=i(2406),p=function(t,e,i){u.q.call(this,t,e,i)};a.q.extend(p.prototype,u.q.prototype),p.prototype.defaultOptions={pluginType:"uiplugin.editor",pluginName:"editor",userEvents:["onload","onchange"],menubar:"simple",editorType:"3.0",useConfig:!0,absolutePath:!1,imageUploadURL:"",imageLoadURL:"",subDir:"",language:"en",transParentDisabled:!1,resizable:!1,version:"",_defaultVersion:"5.44",_noAlert:!1,editorHeight:"",editorWidth:"",useCKFinder:!1,placeholder:"",useLocale:!1,placeholderLocaleRef:"",maxCharCount:0,msaName:"",accessibility:!1,pasteBase64:!1,extraContentsCss:"",useMarkdown:!1},p.prototype.initialize=function(t){try{this.loaded=!1,this.startText="",this.startHtml="",this.orgHTML="",this.options.version||(d.Z.isSpartan()?this.options.version="4.5.1":d.Z.isIEAllVersion(9)||d.Z.isIEAllVersion(11)||d.Z.isIEAllVersion(10)||r.I.browserCheck.ipad?this.options.version="4.3":this.options.version="")}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.initAsync=(0,o.A)(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,p.isImported){t.next=24;break}if(e=this._getResourcePath("checkVersion"),window.CKEDITOR_BASEPATH=a.q._resourceURI+e,"5.44"!=this.options.version){t.next=9;break}return t.next=7,this._loadEditorESM();case 7:t.next=11;break;case 9:return t.next=11,this._loadEditorUMD(e);case 11:if(window.CKEDITOR&&"loaded"===window.CKEDITOR.status||window.CKEDITOR&&window.CKEDITOR.ClassicEditor){t.next=21;break}if(e=this._getResourcePath("noResource"),window.CKEDITOR_BASEPATH=a.q._resourceURI+e,"5.44"!=this.options.version){t.next=19;break}return t.next=17,this._loadEditorESM();case 17:t.next=21;break;case 19:return t.next=21,this._loadEditorUMD(e);case 21:CKEDITOR.EDITOR_VERSION=this.options.version,CKEDITOR.EDITOR_MAJOR_VERSION=this.options.version.charAt(0),p.isImported=!0;case 24:this.options.version=CKEDITOR.EDITOR_VERSION,"5"==CKEDITOR.EDITOR_MAJOR_VERSION?(this._defaultImageUploadURL="imageupload.wq",this._defaultImageLoadURL="loadImg.wq",this.options.imageUploadURL=r.I.getServletURL(this,this.options.msaName,this._defaultImageUploadURL,this.options.imageUploadURL),this.options.imageLoadURL=r.I.getServletURL(this,this.options.msaName,this._defaultImageLoadURL,this.options.imageLoadURL)):(this.options.imageUploadURL=this.options.imageUploadURL||WebSquare.baseServletURI+"imageupload.wq",this.options.imageLoadURL=this.options.imageLoadURL||a.q._resourceURI+"externalJS/editor/loadImg.wq"),t.next=31;break;case 28:t.prev=28,t.t0=t.catch(0),c.Y.printStackTrace(t.t0,null,this);case 31:case"end":return t.stop()}}),t,this,[[0,28]])}))),p.prototype._loadEditorESM=(0,o.A)(s().mark((function t(){var e,i,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,window.CKEDITOR||(window.CKEDITOR={}),t.next=4,inquires("externalJS/editor"+this.options.version+"/config_3.js");case 4:return t.next=6,a.q._dynamicImport(CKEDITOR_BASEPATH+"config_modules.js");case 6:e=t.sent,CKEDITOR.ClassicEditor=e.ClassicEditor,CKEDITOR.EDITOR_PLUGINS=[],t.t0=s().keys(e);case 10:if((t.t1=t.t0()).done){t.next=20;break}if("ClassicEditor"===(i=t.t1.value)){t.next=18;break}if("Markdown"!=i||this.options.useMarkdown){t.next=15;break}return t.abrupt("continue",10);case 15:if("CKFinder"!=i&&"CKFinderUploadAdapter"!=i||this.options.useCKFinder){t.next=17;break}return t.abrupt("continue",10);case 17:CKEDITOR.EDITOR_PLUGINS.push(e[i]);case 18:t.next=10;break;case 20:if(!this.options.useCKFinder||window.CKFinder){t.next=23;break}return t.next=23,inquires("externalJS/ckfinder3/ckfinder.js");case 23:if("en"===this.options.language){t.next=28;break}return t.next=26,a.q._dynamicImport(CKEDITOR_BASEPATH+"translations/"+this.options.language+".js")
;case 26:o=t.sent,CKEDITOR.coreTranslations=Object.values(o)[0];case 28:WebSquare.skin.addImport(CKEDITOR_BASEPATH+"ckeditor5.css",!0,{noClear:!0}),t.next=34;break;case 31:t.prev=31,t.t2=t.catch(0),c.Y.printStackTrace(t.t2,null,this);case 34:case"end":return t.stop()}}),t,this,[[0,31]])}))),p.prototype._loadEditorUMD=function(){var t=(0,o.A)(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,inquires(e+"ckeditor.js");case 3:if("5.41.1"!=this.options.version){t.next=16;break}return window.CKEDITOR||(window.CKEDITOR={}),window.ClassicEditor&&(window.CKEDITOR.ClassicEditor=window.ClassicEditor,delete window.ClassicEditor),t.next=8,inquires("externalJS/editor"+this.options.version+"/config_3.js");case 8:if(!d.Z.getBoolean(this.options.useCKFinder)||window.CKFinder){t.next=11;break}return t.next=11,inquires("externalJS/ckfinder3/ckfinder.js");case 11:if("en"==this.options.language){t.next=14;break}return t.next=14,inquires(e+"translations/"+this.options.language+".js");case 14:t.next=19;break;case 16:if(!d.Z.getBoolean(this.options.useCKFinder)||window.CKFinder){t.next=19;break}return t.next=19,inquires("externalJS/ckfinder/ckfinder.js");case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(0),c.Y.printStackTrace(t.t0,null,this);case 24:case"end":return t.stop()}}),t,this,[[0,21]])})));return function(e){return t.apply(this,arguments)}}(),p.prototype.toHTML=function(){try{var t,e=[],i=""==this.options.tabIndex?"":"tabIndex='"+this.options.tabIndex+"'",o=this.options.accessibility?"w2editor_accessibility ":"";return t=""==this.options.style?"":"style='"+this.options.style+"'",e.push("<div id='"+this.id+"' "+t+" class='w2editor "+o+this.options.className+"' "+i+">"),e.push("<div id='"+this.id+"_'>"),e.push("</div>"),"5"==CKEDITOR.EDITOR_MAJOR_VERSION&&this.options.maxCharCount>0&&(e.push("<span id='"+this.id+"_bottom' class='w2editor_bottom' role='presentation'>"),e.push("<div class='w2editor_charcount'>"),e.push("<span id='"+this.id+"_charcount'>"),e.push("</span>"),e.push("</div>"),e.push("</span>")),e.push("</div>"),e.join("")}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setAction=function(){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION){var t={};for(var e in t.plugins=CKEDITOR.EDITOR_PLUGINS,CKEDITOR.EDITOR_CONFIG)"toolbar_default"!==e&&"toolbar_simple"!==e&&"toolbar_defaultImage"!==e&&(t[e]=CKEDITOR.EDITOR_CONFIG[e]);var i=[];switch(this.options.accessibility&&"5.41.1"!=this.options.version&&(i.push("accessibilityHelp"),i.push("|")),this.options.menubar){case"default":i=i.concat(CKEDITOR.EDITOR_CONFIG.toolbar_default);break;case"simple":i=i.concat(CKEDITOR.EDITOR_CONFIG.toolbar_simple);break;case"defaultImage":i=i.concat(CKEDITOR.EDITOR_CONFIG.toolbar_defaultImage)}if(d.Z.getBoolean(this.options.useCKFinder))for(var o=0;o<i.length;o++)if("imageUpload"===i[o]||"insertImage"===i[o]){i[o]="ckfinder";break}this.options.useLocale&&this.options.placeholderLocaleRef&&(C=this.getLocaleValue(this.options.placeholderLocaleRef));var n=C||this.options.placeholder,s=WebSquare.core.getConfiguration("/WebSquare/editor/license/@value");t.licenseKey=s,t.toolbar={items:i,shouldNotGroupWhenFull:!0},t.language=this.options.language,t.translations=CKEDITOR.coreTranslations,t.placeholder=n,d.Z.getBoolean(this.options.useCKFinder)?t.ckfinder={uploadUrl:r.I.getServletURL(this,this.options.msaName,null,"/ckfinder/connector?command=FileUpload&type=Files")}:t.simpleUpload={uploadUrl:this.options.imageUploadURL+"?callbackFunction="+this.id+".callback&version=5&imageLoadURL="+encodeURIComponent(this.options.imageLoadURL)+"&subDir="+this.options.subDir};var h=this;CKEDITOR.ClassicEditor.create(document.getElementById(this.id+"_"),t).then((function(t){CKEDITOR[h.id+"_"]=t,t.setData(" ");var e=h.uuid,i=WebSquare.idCache[e];t.editing.view.document.on("focus",(function(t){i.handleOnFocusEvent(t)})),t.editing.view.document.on("blur",(function(t){i.handleOnBlurEvent(t)}))
;for(var o=i.render.querySelectorAll(".ck-dropdown__panel"),n=0;n<o.length;n++)o[n].style.maxHeight="22em",o[n].style.overflowY="auto";if(i.options.maxCharCount>0){var s=WebSquare.language.getMessage("Editor_currentChar")||"Characters";i.dom.charCount=document.getElementById(i.id+"_charcount");var a=t.plugins.get("WordCount"),r=i.options.maxCharCount;i.dom.charCount.textContent=s+": 0/"+r,a.on("update",(function(t,e){i.dom.charCount.textContent=s+": "+e.characters+"/"+r,e.characters>r?i.addClass(i.dom.charCount,"w2editor_charcount_limitReached"):i.removeClass(i.dom.charCount,"w2editor_charcount_limitReached")})),t.model.document.on("change:data",(function(){a.characters>r&&d.Z.requestAnimationFrame((function(){i._undo||t.execute("undo")}))})),t.editing.view.document.on("blur",(function(){var t=a.characters;i.dom.charCount.textContent=s+": "+t+"/"+r,t>r?i.addClass(i.dom.charCount,"w2editor_charcount_limitReached"):i.removeClass(i.dom.charCount,"w2editor_charcount_limitReached")})),t.editing.view.document.on("clipboardInput",(function(t,e){d.Z.requestAnimationFrame((function(){i._updateCharCount()}))}))}if(i.handleOnLoadEvent(),i.options.accessibility){var c=t.ui.view.toolbar.items,u=null;if(c.forEach((function(t){t.buttonView&&t.buttonView.element.addEventListener("focus",(function(){u=t.buttonView.element}))})),l.f.addListener(i.render,"onclick",(function(t){for(var e=i.event.getTargetIterator(t);e.next();)if(e.match("ck-button-cancel")){u&&setTimeout((function(){u.focus()}),0);break}e=null})),l.f.addListener(i.render,"onkeydown",(function(t){for(var e=i.event.getTargetIterator(t);e.next();)if(e.match("ck-button-cancel")){var o=t.charCode?t.charCode:t.keyCode;13!==o&&32!==o||u&&u.focus();break}e=null})),"5.41.1"!=i.options.version)t.plugins.get("Dialog").on("change:id",(function(t,e,o){"accessibilityHelp"===o&&d.Z.requestAnimationFrame((function(){if(!0!==i._dialogLoaded){for(var t=document.querySelector(".ck-accessibility-help-dialog__content"),e=t.querySelectorAll("p, h3, h4, dt, dd"),o=[],n=0;n<e.length;n++)o.push(e[n]);for(n=0;n<o.length;n++)o[n].setAttribute("tabindex","0");l.f.addListener(t,"onkeydown",(function(e){var i=e.charCode?e.charCode:e.keyCode;if(38===i||40===i){l.f.preventDefault(e);var n=document.activeElement,s=o.indexOf(n);if(n===t&&o.length>0)return void(40===i?o[0].focus():38===i&&o[o.length-1].focus());if(-1!==s){var a=-1;40===i?a=s===o.length-1?0:s+1:38===i&&(a=0===s?o.length-1:s-1),-1!==a&&o[a].focus()}}})),i._dialogLoaded=!0}}))}))}i.options.pasteBase64&&t.editing.view.document.on("clipboardInput",(function(e,o){var n=o.dataTransfer,s=/^image\//;if(n){for(var a=n.files,r=Promise.resolve(),c=0;c<a.length;c++)!function(o){var n=a[o];s.test(n.type)&&(e.stop(),r=r.then((function(e,o){return new Promise((function(e,o){i._readImageAsBase64(n,t,i,e,o)}))})))}(c);r.finally((function(){i._lastPosition=null}))}}),{priority:"high"})})).catch((function(t){console.error(t)}))}else{var u,p=this._getResourcePath(),f="skins/",g=!1;"4.17.1"==this.options.version||"4.19.1"==this.options.version||"4.22.1"==this.options.version?u="moono-lisa":"4.5.11"===this.options.version||"4.11.3"===this.options.version||"4.14.0"==this.options.version?u="moono":"4.5.1"===this.options.version?u="office2013":"4.3"===this.options.version?u="office2003":(f="",u="office2003",g=!0);var m,b,R,E,C,I=u+","+CKEDITOR.basePath+p+f+u+"/",_=CKEDITOR.basePath+"contents.css"+WebSquare.BootLoader.getEngineCachePostfix("");if(-1==CKEDITOR.basePath.indexOf(p)?(CKEDITOR.config.skin=I,CKEDITOR.basePath=CKEDITOR.basePath+p,CKEDITOR.config.contentsCss=_):!0===g&&(CKEDITOR.config.skin="office2003,"+CKEDITOR.basePath+"/office2003/",CKEDITOR.config.contentsCss=_),this.options.extraContentsCss){var T=WebSquare.util.getAbsolutePath(r.I.getURL(this.options.extraContentsCss));CKEDITOR.config.contentsCss=[_,T]}this.filebrowserUploadBaseUrl=this.options.imageUploadURL+"?callbackFunction="+this.id+".callback&version=4&subDir="+this.options.subDir,
"4.5.11"==this.options.version?(b=69,R=102,E=72):(b=55,R=111,E=83),m="simple"==this.options.menubar?parseInt(this.render.style.height)-b+"px":parseInt(this.render.offsetWidth)<1395?parseInt(this.render.style.height)-R+"px":parseInt(this.render.style.height)-E+"px",this.options.useLocale&&this.options.placeholderLocaleRef&&(C=this.getLocaleValue(this.options.placeholderLocaleRef));n=C||this.options.placeholder;var y={customConfig:"config_3.js",resize_enabled:this.options.resizable,width:"100%",height:m,toolbarCanCollapse:!1,toolbar:this.options.menubar,language:this.options.language,editorplaceholder:n,filebrowserUploadUrl:this.filebrowserUploadBaseUrl},v=this.uuid;"4.5.11"!=this.options.version&&"4.11.3"!==this.options.version&&"4.14.0"!==this.options.version&&"4.17.1"!=this.options.version&&"4.19.1"!=this.options.version&&"4.22.1"!=this.options.version||this.options.maxCharCount>0&&(y.extraPlugins="wordcount",y.wordcount={showParagraphs:!1,showWordCount:!1,showCharCount:!0,countSpacesAsChars:!0,countByTesAsChars:!0,maxWordCount:-1,maxCharCount:this.options.maxCharCount,charCountGreaterThanMaxLengthEvent:function(t,e){}}),d.Z.getBoolean(this.options.useCKFinder)&&(y.filebrowserBrowseUrl=a.q._resourceURI+"externalJS/ckfinder/ckfinder.html",y.filebrowserImageBrowseUrl=a.q._resourceURI+"externalJS/ckfinder/ckfinder.html?type=Images",y.filebrowserFlashBrowseUrl=a.q._resourceURI+"externalJS/ckfinder/ckfinder.html?type=Flash",y.filebrowserUploadUrl=a.q._resourceURI+"ckfinder/core/connector/java/connector.ckfinder?command=QuickUpload&type=Files",y.filebrowserImageUploadUrl=a.q._resourceURI+"ckfinder/core/connector/java/connector.ckfinder?command=QuickUpload&type=Images",y.filebrowserFlashUploadUrl=a.q._resourceURI+"ckfinder/core/connector/java/connector.ckfinder?command=QuickUpload&type=Flash",y.image_previewText="&nbsp;"),y.id=this.id+"_";var O=CKEDITOR.replace(this.id+"_",y);if(d.Z.getBoolean(this.options.useCKFinder)&&CKFinder.setupCKEditor(O,"/externalJS/ckfinder/"),CKEDITOR.instances[this.id+"_"].setData(" "),CKEDITOR.instances[this.id+"_"].on("instanceReady",(function(t){var e=WebSquare.idCache[v];if(e.handleOnLoadEvent(),"source"!==this.config.startupMode){var i=e.render.getElementsByTagName("iframe")[0].contentDocument;e.event.addListener(i,"onclick",e.event.bindAsEventListener(e,e.handleOtherClick))}})),CKEDITOR.instances[this.id+"_"].on("focus",(function(t){WebSquare.idCache[v].handleOnFocusEvent(t)})),CKEDITOR.instances[this.id+"_"].on("blur",(function(t){WebSquare.idCache[v].handleOnBlurEvent(t)})),CKEDITOR.instances[this.id+"_"].on("contentPreview",(function(t){if(t.data&&t.data.dataValue){var e=t.data.dataValue.indexOf("<body"),i=t.data.dataValue.substring(0,e),o=t.data.dataValue.substring(e);o=(o=(o=o.wq_replaceAll("<script","&lt;script")).wq_replaceAll("alert","")).wq_replaceAll("eval",""),t.data.dataValue=i+o}})),this.options.accessibility){var D=null;CKEDITOR.on("instanceReady",(function(t){O.ui.space("top").find("a.cke_button").toArray().forEach((function(t){t.on("click",(function(){D=t.$})),t.on("focus",(function(){D=t.$,t.setStyle("background-color","#e5e5e5")})),t.on("blur",(function(){t.removeStyle("background-color")}))}))})),CKEDITOR.on("dialogDefinition",(function(t){var e=t.data.definition,i=e.onShow;e.onShow=function(){i&&i.apply(this,arguments);var t=this,e=t.getElement().findOne(".ImagePreviewBox");if(e){e.setAttribute("tabindex","0");var o=t._.focusList,n={element:e,focus:function(){t._.currentFocusIndex=this.focusIndex,this.element.focus()},isFocusable:function(){return!0},focusIndex:23},s=o.pop();s.focusIndex=25;var a=o.pop();a.focusIndex=24,o.push(n),o.push(a),o.push(s)}};var o=e.onCancel;e.onCancel=function(){o&&o.apply(this,arguments),D&&d.Z.requestAnimationFrame((function(){D.focus()}))}}))}}}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype._readImageAsBase64=function(t,e,i,o,n){try{var s=new FileReader;s.onload=function(t){e.model.change((function(o){var n=o.createElement("imageBlock",{
src:t.target.result});e.model.insertContent(n,i._lastPosition),i._lastPosition=o.createPositionAfter(n),o.setSelection(n,"on")})),o()},s.readAsDataURL(t)}catch(t){c.Y.printStackTrace(t,null,this),n()}},p.prototype._updateCharCount=function(t){try{this._undo=!1;var e=window.CKEDITOR[this.id+"_"],i=e.plugins.get("WordCount").characters,o=this.options.maxCharCount,n=WebSquare.language.getMessage("Editor_currentChar")||"Characters";this.dom.charCount.textContent=n+": "+i+"/"+o,i>o&&(this._showWarning(WebSquare.language.getMessage("Editor_maxChar_warning",this.options.maxCharCount)),t?e.setData(this.orgHTML):(e.execute("undo"),this._undo=!0))}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype._showWarning=function(t){try{if(document.getElementById("w2editor_notifications_area_"+this.id))return;var e=window.CKEDITOR[this.id+"_"].ui.view.element.querySelector(".ck-content").getBoundingClientRect(),i=e.width,o=1*i/2,n=document.createElement("div");n.id="w2editor_notifications_area_"+this.id,n.className="w2editor_notifications_area",n.style.top=e.top+window.scrollY+"px",n.style.left=e.left+window.scrollX+(i-o)/2+"px",n.style.width=o+"px";var s=document.createElement("div");s.className="w2editor_notification w2fadeIn";var a=document.createElement("p");a.className="w2editor_notification_message",a.textContent=t,s.appendChild(a),n.appendChild(s),document.body.appendChild(n);var r=this;setTimeout((function(){r.removeClass(s,"w2fadeIn"),r.addClass(s,"w2fadeOut"),setTimeout((function(){document.body.removeChild(n)}),700)}),2e3)}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.finalize=function(){try{u.q.prototype.finalize.call(this);var t="5"==CKEDITOR.EDITOR_MAJOR_VERSION?CKEDITOR[this.id+"_"]:CKEDITOR.instances[this.id+"_"];t&&(t.destroy(!0),"5"==CKEDITOR.EDITOR_MAJOR_VERSION&&(window.CKEDITOR[this.id+"_"]=null,delete window.CKEDITOR[this.id+"_"]))}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setText=function(t){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION){var e=this.uuid;if(!this.loaded)return void(this.startText=t);this.orgHTML=this.getHTML();var i=window.CKEDITOR[this.id+"_"];if(i.setData(WebSquare.xml.encode1(t)),this.options.maxCharCount>0){var o=this;d.Z.requestAnimationFrame((function(){o._updateCharCount(!0)}))}i.getData()!==this.orgHTML&&(l.f.fireEvent(this,"onchange"),this.orgHTML=this.getHTML())}else{if(CKEDITOR.version.charAt(0)<"4"){var n=this.getReadOnly(),s=this.getDisabled();(n||s)&&(this.setDisabled(!1),this.options.disabled=s)}e=this.uuid;if(!this.loaded)return void(this.startText=t);this.orgHTML=this.getHTML(),CKEDITOR.instances[this.id+"_"].setData("",(function(){this.insertText(t);var i=WebSquare.idCache[e];i.applyReadOnlyDisabled(),this.getData()!=i.orgHTML&&(l.f.fireEvent(i,"onchange"),i.orgHTML=i.getHTML())}))}}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.getText=function(){try{return"5"==CKEDITOR.EDITOR_MAJOR_VERSION?window.CKEDITOR[this.id+"_"].getData().replace(/<[^>]+>/g,"").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,'"').replace(/&apos;/gi,"'"):CKEDITOR.instances[this.id+"_"].document.getBody().getText()}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.getInnerText=function(){try{return"5"==CKEDITOR.EDITOR_MAJOR_VERSION?window.CKEDITOR[this.id+"_"].editing.view.domRoots.get("main").innerText:CKEDITOR.instances[this.id+"_"].document.getBody().$.innerText}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setHTML=function(t){try{var e=this.uuid;if("5"==CKEDITOR.EDITOR_MAJOR_VERSION){var i=window.CKEDITOR[this.id+"_"];if(!this.loaded)return void(this.startHtml=t);if(this.orgHTML=this.getHTML(),i.setData(t),this.options.maxCharCount>0){var o=this;d.Z.requestAnimationFrame((function(){o._updateCharCount(!0)}))}i.getData()!==this.orgHTML&&(l.f.fireEvent(this,"onchange"),this.orgHTML=this.getHTML())}else{if(CKEDITOR.version.charAt(0)<"4"){var n=this.getReadOnly(),s=this.getDisabled()
;(n||s)&&(this.setDisabled(!1),this.options.disabled=s)}var a=CKEDITOR.instances[this.id+"_"];if(CKEDITOR.version.charAt(0)<"4"){if(!this.loaded)return void(this.startHtml=t);this.orgHTML=this.getHTML(),a.setData(t,(function(){var t=WebSquare.idCache[e];t.applyReadOnlyDisabled(),this.getData()!=t.orgHTML&&(l.f.fireEvent(t,"onchange"),t.orgHTML=t.getHTML()),t.resetDirty()}))}else{if(!this.loaded)return void(this.startHtml=t);if(this.orgHTML=this.getHTML(),!this.orgHTML&&!t)return;!this.orgHTML&&t&&this.options.placeholder&&this._changePlaceholder(""),a.editable().setData(t,!0),this.getHTML()||this._changePlaceholder(this.options.placeholder),this.getHTML()!=this.orgHTML&&(l.f.fireEvent(this,"onchange"),this.orgHTML=this.getHTML()),this.resetDirty()}}}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.getHTML=function(){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION){if(this.options.useMarkdown)return"";var t=window.CKEDITOR[this.id+"_"].getData(),e=r.I.getConfiguration("/WebSquare/editor/tagHandler/@value")||"";return"function"==typeof(i=d.Z.getGlobalFunction(e,this.scope_id))&&(t=i.call(this,t)),t}var i;t=CKEDITOR.instances[this.id+"_"].getData(),e=r.I.getConfiguration("/WebSquare/editor/tagHandler/@value")||"";return"function"==typeof(i=d.Z.getGlobalFunction(e,this.scope_id))&&(t=i.call(this,t)),t}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.focus=function(){try{return"5"==CKEDITOR.EDITOR_MAJOR_VERSION?window.CKEDITOR[this.id+"_"].focus():CKEDITOR.instances[this.id+"_"].focus()}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.callback=function(t){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION)return;var e,i,o,n,s=WebSquare.xml.parse(t);if(e=WebSquare.xml.getValue(s,"ret/key"),e=WebSquare.xml.decode(e),i=WebSquare.xml.getValue(s,"ret/storedFileList"),o=WebSquare.xml.getValue(s,"ret/funcNum"),n=WebSquare.xml.getValue(s,"ret/deniedCodeList"),i&&i.length>0)1==this.options.absolutePath?(e=e.wq_replaceAll("/","\\"),CKEDITOR.tools.callFunction(o,e+"\\"+i)):this.options.imageLoadURL.indexOf("?")>-1?CKEDITOR.tools.callFunction(o,this.options.imageLoadURL+"&subDir="+this.options.subDir+"&fileName="+escape(encodeURIComponent(i))):CKEDITOR.tools.callFunction(o,this.options.imageLoadURL+"?subDir="+this.options.subDir+"&fileName="+escape(encodeURIComponent(i)));else{var a="";a="101"==n?"Invalid file extension.":"102"==n?"File Size has been exceed.":"Unknown server error.",CKEDITOR.tools.callFunction(o,"",a)}}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setDisabled=function(t){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION){t=d.Z.getBoolean(t),this.options.disabled=t;var e=this.render.querySelector(".ck.ck-editor"),i=e.querySelector(".ck-editor__editable");if(!e)return;var o=document.getElementById(this.id+"_disabled_div");if(0==t&&o)o.style.visibility="hidden",o.style.display="none",o.hidden=!0,i&&(i.contentEditable=!0);else if(1!=t||o){if(1==t&&o){o.style.visibility="visible",o.style.display="block",o.hidden=!1,i&&(i.contentEditable=!1);n=null;n=1==this.options.transParentDisabled?"background-color: black; position: absolute; left:0px; top:0px; height: 100%; width: 100%; filter : alpha(opacity=0); opacity : 0.0;":d.Z.isSpartan()?"background-color: black; position: absolute; left:0px; top:0px; height: 100%; width: 100%; filter : alpha(opacity=30); opacity : 0.3; border:1px solid black;":"background-color: black; position: absolute; left:0px; top:0px; height: 100%; width: 100%; filter : alpha(opacity=30); opacity : 0.3;",o.style.cssText=n}}else{(u=document.createElement("div")).setAttribute("id",this.id+"_disabled_div"),i&&(i.contentEditable=!1);var n=null
;n=1==this.options.transParentDisabled?"background-color: black; position: absolute; left:0px; top:0px; height: 100%; width: 100%; filter : alpha(opacity=0); opacity : 0.0;":d.Z.isSpartan()?"background-color: black; position: absolute; left:0px; top:0px; height: 100%; width: 100%; filter : alpha(opacity=30); opacity : 0.3; border:1px solid black;":"background-color: black; position: absolute; left:0px; top:0px; height: 100%; width: 100%; filter : alpha(opacity=30); opacity : 0.3;",u.style.cssText=n,this.render.appendChild(u)}return t}t=d.Z.getBoolean(t),this.options.disabled=t;var s=null,a=null;if(CKEDITOR.version.charAt(0)<"4"){o=document.getElementById(this.id+"_disabled_div");s=document.getElementById("cke_top_"+this.id+"_"),a=document.getElementById("cke_contents_"+this.id+"_")}else{o=document.getElementById(this.id+"_disabled_div");s=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_top"),a=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_contents")}if(!s&&!a)return;var r=a.getElementsByTagName("iframe")[0],l=r?r.contentWindow:"",h=a.getElementsByTagName("textarea")[0];if(0==t&&o)o.style.visibility="hidden",o.style.display="none",o.hidden=!0,l&&!this.getReadOnly()&&(l.document.documentElement.contentEditable=!0,l.document.body.contentEditable=!0),h&&(h.disabled=!1);else if(1!=t||o)1==t&&o&&(l&&(l.document.documentElement.contentEditable=!1,l.document.body.contentEditable=!1),h&&(h.disabled=!0),o.hidden=!1,o.style.visibility="visible",o.style.display="block");else{var u;(u=document.createElement("div")).setAttribute("id",this.id+"_disabled_div");var p;if(CKEDITOR.version.charAt(0)<"4")var f=document.getElementById("cke_top_"+this.id+"_").offsetHeight,g=document.getElementById("cke_contents_"+this.id+"_").offsetHeight,m=document.getElementById("cke_bottom_"+this.id+"_").offsetHeight;else f=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_top").offsetHeight,g=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_contents").offsetHeight,m=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_bottom").offsetHeight;p=f+g+m;n=null;n=1==this.options.transParentDisabled?"background-color: black; position: absolute; left:0px; top:0px; height:"+p+"px; width: 100%; filter : alpha(opacity=0); opacity : 0.0;":d.Z.isSpartan()?"background-color: black; position: absolute; left:0px; top:0px; height:"+p+"px; width: 100%; filter : alpha(opacity=30); opacity : 0.3; border:1px solid black;":"background-color: black; position: absolute; left:0px; top:0px; height:"+p+"px; width: 100%; filter : alpha(opacity=30); opacity : 0.3;",u.style.cssText=n,this.render.appendChild(u),l&&(l.document.documentElement.contentEditable=!1,l.document.body.contentEditable=!1),h&&(h.disabled=!0)}return t}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setReadOnly=function(t){try{return"5"==CKEDITOR.EDITOR_MAJOR_VERSION?(t=d.Z.getBoolean(t),this.options.readOnly=t,window.CKEDITOR&&(t?window.CKEDITOR[this.id+"_"].enableReadOnlyMode("EditorLock"):window.CKEDITOR[this.id+"_"].disableReadOnlyMode("EditorLock")),t):(t=d.Z.getBoolean(t),this.options.readOnly=t,"4.5.11"==this.options.version||"4.11.3"===this.options.version||"4.14.0"===this.options.version||"4.17.1"==this.options.version||"4.19.1"==this.options.version||"4.22.1"==this.options.version?CKEDITOR.instances[this.id+"_"].editable()&&CKEDITOR.instances[this.id+"_"].setReadOnly(t):CKEDITOR.instances[this.id+"_"].setReadOnly(t),t)}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setDomain=function(t){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION)return;if(t||(t=WebSquare.domain),t&&t.wq_trim().length>0){var e=this.filebrowserUploadBaseUrl;e.indexOf("?")>-1?e+="&":e+="?",e+="domain="+WebSquare.text.URLEncoder(t),CKEDITOR.instances[this.id+"_"].config.filebrowserUploadUrl=e}else CKEDITOR.instances[this.id+"_"].config.filebrowserUploadUrl=this.filebrowserUploadBaseUrl}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.getDomain=function(){try{
return"5"==CKEDITOR.EDITOR_MAJOR_VERSION?this.options.useCKFinder?window.CKEDITOR[this.id+"_"].config._config.ckfinder.uploadUrl:window.CKEDITOR[this.id+"_"].config._config.simpleUpload.uploadUrl:CKEDITOR.instances[this.id+"_"].config.filebrowserUploadUrl}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.getImageLoadURL=function(){try{return this.options.imageLoadURL}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setImageLoadURL=function(t){try{if(!t)return;this.options.imageLoadURL=r.I.getServletURL(this,this.options.msaName,this._defaultImageLoadURL,t)}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.handleOnLoadEvent=function(){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION){var t=this.render.clientWidth||this.render.style.width||WebSquare.style.getComputedStyle(this.render,"width"),e=this.render.clientHeight||this.render.style.height||WebSquare.style.getComputedStyle(this.render,"height"),i=window.CKEDITOR[this.id+"_"],o=this.render.querySelector(".ck-sticky-panel__content").offsetHeight,n=this.options.maxCharCount>0?this.render.querySelector(".w2editor_bottom").offsetHeight:0;i.editing.view.change((function(t){t.setStyle("height",e-o-n+"px",i.editing.view.document.getRoot()),t.setStyle("box-sizing","border-box",i.editing.view.document.getRoot())}));var s=this,a=this.render.querySelector(".ck-source-editing-button");if(a&&a.addEventListener("click",(function(){if(a.classList.contains("ck-on")){var t=s.render.querySelector(".ck-source-editing-area"),i=s.render.querySelector(".ck-source-editing-area textarea");t&&i&&(t.style.height=e-o-n+"px",i.style.height=e-o-n+"px",i.style.overflow="auto")}})),r.I.browserCheck.ipad){var d=i.ui.view.editable.element,h=d.getAttribute("style");d.setAttribute("style",h+"overflow-y: auto;-webkit-overflow-scrolling: touch")}this.applyReadOnlyDisabled(),this.loaded=!0,""!=this.startText&&this.setText(this.startText),""!=this.startHtml&&this.setHTML(this.startHtml),this.options.useCKFinder&&CKFinder.config({connectorPath:r.I.getServletURL(s,s.options.msaName,null,"/ckfinder/connector")}),l.f.fireEvent(this,"onload")}else{t=this.render.clientWidth||this.render.style.width||WebSquare.style.getComputedStyle(this.render,"width"),e=this.render.clientHeight||this.render.style.height||WebSquare.style.getComputedStyle(this.render,"height");if(this.options.editorWidth&&(t=this.options.editorWidth),this.options.editorHeight&&(e=this.options.editorHeight),CKEDITOR.instances[this.id+"_"].document&&CKEDITOR.instances[this.id+"_"].document.getWindow().$&&CKEDITOR.instances[this.id+"_"].resize(t,e),r.I.browserCheck.ipad){var u=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_contents");h=u.getAttribute("style");u.setAttribute("style",h+"overflow-y: auto;-webkit-overflow-scrolling: touch")}if(this.applyReadOnlyDisabled(),this.loaded=!0,""!=this.startText&&this.setText(this.startText),""!=this.startHtml&&this.setHTML(this.startHtml),this.options.accessibility){var p=document.getElementById(CKEDITOR.instances[this.id+"_"].id+"_contents").querySelector(".cke_voice_label"),f=CKEDITOR.instances[this.id+"_"].editable().$;if(p&&f){var g,m=f.getAttribute("aria-label");g=m?m.slice(0,-(this.id.length+1))+p.textContent:WebSquare.language.getMessage("Editor_ariaLabel"),f.setAttribute("aria-label",g)}}l.f.fireEvent(this,"onload")}}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.handleOnFocusEvent=function(t){},p.prototype.handleOnBlurEvent=function(t){try{var e=this.getHTML();this.orgHTML!=e&&(l.f.fireEvent(this,"onchange"),this.orgHTML=e)}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.applyReadOnlyDisabled=function(){try{this.getDisabled()?this.setDisabled(!0):this.getReadOnly()&&this.setReadOnly(!0)}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.resize=function(t,e){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION)if(this.options.resizable){this.render.style.width=t+"px",this.render.style.height=e+"px"
;var i=window.CKEDITOR[this.id+"_"],o=this.render.querySelector(".ck-toolbar").offsetHeight,n=this.options.maxCharCount>0?this.render.querySelector(".w2editor_bottom").offsetHeight:0;i.editing.view.change((function(t){t.setStyle("height",e-o-n+"px",i.editing.view.document.getRoot()),t.setStyle("box-sizing","border-box",i.editing.view.document.getRoot())}));var s=this,a=this.render.querySelector(".ck-source-editing-button");a&&a.addEventListener("click",(function(){if(a.classList.contains("ck-on")){var t=s.render.querySelector(".ck-source-editing-area"),i=s.render.querySelector(".ck-source-editing-area textarea");t&&i&&(t.style.height=e-o-n+"px",i.style.height=e-o-n+"px",i.style.overflow="auto")}})),this.options.disabled&&this.setDisabled(!0)}else h.v.printLog("Set configuration resize true");else this.options.resizable?CKEDITOR.instances[this.id+"_"].resize(t,e,!0):h.v.printLog("Set configuration resize true")}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.handleOtherClick=function(t){try{WebSquare.getBody().getLayerListener().hideAll()}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.resetDirty=function(t){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION)return;CKEDITOR.instances[this.id+"_"].resetDirty()}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.setPlaceholder=function(t){try{if("5"==CKEDITOR.EDITOR_MAJOR_VERSION)window.CKEDITOR[this.id+"_"].editing.view.document.getRoot("main").placeholder=t,this.options.placeholder=t;else"4.17.1"==this.options.version||"4.19.1"==this.options.version||"4.22.1"==this.options.version?(this._changePlaceholder(t),this.options.placeholder=t):h.v.printLog("setPlaceholder is only supported in version 4.17.1 or higher.["+this.id+"]")}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype._changePlaceholder=function(t){try{var e=t;if("4.17.1"==this.options.version||"4.19.1"==this.options.version||"4.22.1"==this.options.version){var i=CKEDITOR.instances[this.id+"_"].document.getBody();if(i){var o=this.getText();""!=o&&"\n"!=o||!i||i.setAttribute("data-cke-editorplaceholder",e),CKEDITOR.instances[this.id+"_"].config.editorplaceholder=e}}}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype.checkDirty=function(t){try{return"5"==CKEDITOR.EDITOR_MAJOR_VERSION?void 0:CKEDITOR.instances[this.id+"_"].checkDirty()}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype._getResourcePath=function(t){try{return"checkVersion"===t&&!0!=={5.44:!0,"5.41.1":!0,"4.22.1":!0,"4.19.1":!0,"4.17.1":!0,"4.14.0":!0,"4.11.3":!0,"4.5.11":!0,"4.5.1":!0,4.3:!0}[this.options.version]?this._setDefaultVersion("Editor_warning_incorrect_editor_version"):"noResource"===t&&this._setDefaultVersion("Editor_warning_no_resource"),"5.41.1"==this.options.version&&this.options.useCKFinder?"externalJS/editor"+this.options.version+"/CKFinder/":"externalJS/editor"+this.options.version+"/"}catch(t){c.Y.printStackTrace(t,null,this)}},p.prototype._setDefaultVersion=function(t){try{var e=WebSquare.language.getMessage(t)+"\n"+WebSquare.language.getMessage("Editor_warning_load_default_version",this.options._defaultVersion);d.Z.getBoolean(WebSquare.net.getParameter("bySelenium"))||!0===this.options._noAlert?h.v.printLog(e):alert(e),this.options.version=this.options._defaultVersion}catch(t){c.Y.printStackTrace(t,null,this)}}}}]);