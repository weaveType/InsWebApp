<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>DEFAULT</w2:type>
        <w2:buildDate />
        <xf:model>
            <xf:instance>
                <data xmlns="" />
            </xf:instance>
            <w2:dataCollection baseNode="map"></w2:dataCollection>
            <w2:workflowCollection></w2:workflowCollection>
        </xf:model>
        <style type="text/css">
        <![CDATA[ 
                /*
                html, body {margin:0px; padding:0px; font-family:"Malgun Gothic"; font-size:11px;}
                p {margin:0px; padding:0px;}
                img, fieldset {border:0;}
                table {width:100%; background:#fff; border-collapse:collapse; border-spacing:0; empty-cells:show;}
                table caption, table summary {width:0; height:0; font-size:0; line-height:0; overflow:hidden; visibility:hidden;}
                */

                .none {display:none;}
                .block {display:block;}

                .exup_wrap {width:444px; min-height:106px; border:1px solid #b3b3b3;}
                .exup_header {height:27px;}
                .exup_header .title {padding-left:28px; font-weight:bold; line-height:23px;}
                .exup_header .title2 {padding-left:28px; font-weight:bold; line-height:23px; float:left;}
                .exup_header span {padding-right:20px; float:right; display:block;}
                .exup_header span input[type=checkbox] {position:relative; top:1px;}
                /*.exup_header span table {position:relative; top:1px;}*/
                .exup_spanGroup {background-color:transparent;}
                .exup_content {padding:15px 10px 12px;}
                .exup_content .filebox {padding:8px 0 0 11px; width:408px; height:33px; border:1px solid #d3d3d3; background:#f6f6f6;}
                .exup_content .filebox input[type=file] {width:397px; height:24px; font-family:Verdana; font-size:12px; background:#fff;}

                .exup_tbl {margin:15px auto 0; width:400px;}
                .exup_tbl th, .tbl td {min-width:100px; height:24px; text-align:left;}
                .exup_tbl th .dot {padding-left:14px;}
                .exup_tbl td .ipt {width:74px; height:16px; /*bordeR:1px solid #abadb3;*/}
                .exup_tbl td .sel {width:80px; height:20px;}
                .btn_exup_file {margin-bottom:14px; width:90px; position:relative; left:333px; border-radius:4px;}
        ]]>
        </style>
        <script type="text/javascript" lazy="false">
            <![CDATA[
                window.WebSquare.csvPopUUID = $p.getFrameId();
                scwin.sizeInfo = {};
                scwin.osName = "";
                scwin.vActionUrl = "";
                scwin.domain = "";
                scwin.processMsg = "";
                scwin.type = "";
                scwin.vappend = "";
                scwin.gridID = "";
                scwin.vfooter = "";
                scwin.action = "";
                scwin.dataList = "";
                scwin.columnIds = "";
                scwin.expression = "";
                scwin.status = "";
                scwin.optionParam = "";
                scwin.maxFileSize = -1;
                scwin.useModalDisable = "";
                scwin.columnOrder = "";
                scwin.useXHR = false;
                scwin.filePath = "";
                scwin.useDialog = "";
                scwin.postMsg = "";
                scwin.trim = "";

                scwin.Upload_ignore_spaces = "";
                scwin.Upload_include_spaces = "";
                scwin.Upload_advanced = "";
                scwin.Upload_include = "";
                scwin.Upload_not_include = "";
                scwin.Upload_fill_hidden = "";
                scwin.Upload_sheet_no = "";
                scwin.Upload_starting_row = "";
                scwin.Upload_starting_col = "";
                scwin.Upload_footer = "";
                scwin.Upload_file = "";
                scwin.Upload_header = "";
                scwin.Upload_file_choose = "";
                scwin.Upload_file_span = "";

                scwin.Upload_msg1 = "";
                scwin.Upload_msg2 = "";
                scwin.Upload_msg3 = "";
                scwin.Upload_msg4 = "";
                scwin.Upload_msg5 = "";
                scwin.Grid_warning9 = "";
                
                scwin.onpageload = function() {
                    scwin.setImgURL();
                    scwin.uploadInfo = $p.getParameter("csvPopupParam");
                    try {
                        scwin.domain = scwin.uploadInfo.domain;
                        if(scwin.domain) {
                            document.domain = scwin.domain;
                        }
                    } catch (e) {
                        WebSquare.exception.printStackTrace(e);
                    }

                    scwin.postMsg = scwin.uploadInfo.postMsg + "";
                    if(scwin.postMsg == "true") {
                        if(window.addEventListener) {
                            window.addEventListener ("message", scwin.receiveMessage, false);
                        } else {
                            if(window.attachEvent) {
                                window.attachEvent("onmessage", scwin.receiveMessage);
                            }
                        }
                    }

                    scwin.useModalDisable = scwin.uploadInfo.useModalDisable;
                    if(scwin.useModalDisable == "true") {
                        WebSquare.layer.showModal();
                    }
                    scwin.Upload_ignore_spaces = WebSquare.language.getMessage( "Upload_ignore_spaces" ) || "Ignore blank spaces";
                    scwin.Upload_include_spaces = WebSquare.language.getMessage( "Upload_include_spaces" ) || "Include blank spaces";
                    scwin.Upload_advanced = WebSquare.language.getMessage( "Upload_advanced" ) || "Advanced";
                    scwin.Upload_hidden_values = WebSquare.language.getMessage( "Upload_hidden_values" ) || "Hidden values";
                    scwin.Upload_include = WebSquare.language.getMessage( "Upload_include" ) || "Include";
                    scwin.Upload_not_include = WebSquare.language.getMessage( "Upload_not_include" ) || "Not include";
                    scwin.Upload_fill_hidden = WebSquare.language.getMessage( "Upload_fill_hidden" ) || "Fill Hidden";
                    scwin.Upload_starting_row = WebSquare.language.getMessage( "Upload_starting_row" ) || "Start row";
                    scwin.Upload_file = WebSquare.language.getMessage( "Upload_file" ) || "File Upload";
                    scwin.Upload_fill = WebSquare.language.getMessage( "Upload_fill" ) || "Fill";
                    scwin.Upload_ignore = WebSquare.language.getMessage( "Upload_ignore" ) || "Ignore";
                    scwin.Upload_header = WebSquare.language.getMessage( "Upload_header" ) || "Header";
                    scwin.Upload_file_choose = WebSquare.language.getMessage( "Upload_file_choose" ) || "Choose File";
                    scwin.Upload_file_span = WebSquare.language.getMessage( "Upload_file_span" ) || "No file chosen";

                    scwin.Upload_msg2 = WebSquare.language.getMessage( "Upload_msg2" ) || "File size exceeding the limit.";
                    scwin.Upload_msg3 = WebSquare.language.getMessage( "Upload_msg3" ) || "Normal processing failed.";
                    scwin.Upload_msg4 = WebSquare.language.getMessage( "Upload_msg4" ) || "Check the file extension.";
                    scwin.Upload_msg5 = WebSquare.language.getMessage( "Upload_msg5" ) || "Failed to reflect on the grid.";
                    scwin.maxFileSize = scwin.uploadInfo.maxFileSize;
                    scwin.maxFileSize = parseInt( scwin.maxFileSize, 10 );
                    scwin.Grid_warning9 = WebSquare.language.getMessage( "Grid_warning9", scwin.maxFileSize ) || "Data size exceeding the limit.\n limit : %1 byte";

                    WebSquare.core._safeInnerHTML(setting.render, scwin.Upload_advanced);
                    sub.render.setAttribute( "csvPop_summary", scwin.Upload_ignore_spaces + "," + scwin.Upload_hidden_values + "," + scwin.Upload_fill_hidden + "," + scwin.Upload_footer );
                    WebSquare.core._safeInnerHTML(advanced.render, scwin.Upload_advanced);
                    WebSquare.core._safeInnerHTML(bul_title.render, scwin.Upload_file);
                    choose_file.setValue(scwin.Upload_file_choose);
                    choose_span.setValue(scwin.Upload_file_span);

                    space_option.setValue(scwin.Upload_ignore_spaces);
                    spaceSelect.render.name = "skip_space";
                    scwin.sel1 = document.getElementsByName("skip_space")[0];
                    scwin.sel1[0].text = scwin.Upload_ignore_spaces;
                    scwin.sel1[1].text = scwin.Upload_include_spaces;
                    scwin.sel1[0].value = "true";
                    scwin.sel1[1].value = "false";

                    start_option.setValue(scwin.Upload_starting_row);
                    hidden_option.setValue(scwin.Upload_hidden_values);

                    hiddenSelect.render.name = "hidden";
                    scwin.sel2 = document.getElementsByName("hidden")[0];
                    scwin.sel2[0].text = scwin.Upload_include;
                    scwin.sel2[1].text = scwin.Upload_not_include;
                    scwin.sel2[0].value = "true";
                    scwin.sel2[1].value = "false";

                    fillHidden.render.name = "fillHidden";
                    scwin.sel3 = document.getElementsByName("fillHidden")[0];
                    scwin.sel3[0].text = scwin.Upload_fill;
                    scwin.sel3[1].text = scwin.Upload_ignore;
                    scwin.sel3[0].value = "true";
                    scwin.sel3[1].value = "false";
                    
                    hidden_fill.setValue(scwin.Upload_hidden_values);
                    sendFILE.setValue(scwin.Upload_file);
                    header_option.setValue(scwin.Upload_header);
                    
                    header.render.name = "header";
                    scwin.sel4 = document.getElementsByName("header")[0];
                    scwin.sel4[0].text = scwin.Upload_include;
                    scwin.sel4[1].text = scwin.Upload_not_include;
                    scwin.sel4[0].value = "true";
                    scwin.sel4[1].value = "false";

                    scwin.sizeInfo.height = scwin.uploadInfo.sizeInfo.height;
                    scwin.sizeInfo.width = scwin.uploadInfo.sizeInfo.width;
                    scwin.osName = scwin.uploadInfo.osName;
                    
                    scwin.choose_file_onclick = function(e) {
                        scwin.file.click();
                    };

                    scwin.change_span = function() {
                        if (scwin.file.render.value) {
                            scwin.name = scwin.file.render.value.split("\\").pop();
                            scwin.fileName.render.textContent = scwin.name;
                        }
                    };
                    scwin.file = filename;
                    scwin.fileBtn = choose_file;
                    scwin.fileName = choose_span;
                    scwin.file.render.addEventListener ("change", scwin.change_span);

                    //  header, append, hidden, columnNum, hiddenColumns, action
                    scwin.type = scwin.uploadInfo.type;
                    scwin.uploadType = scwin.uploadInfo.uploadType;
                    scwin.delim = scwin.uploadInfo.delim;
                    scwin.escapeChar = scwin.uploadInfo.escapeChar;
                    scwin.vheader = scwin.uploadInfo.header;
                    scwin.vfooter = scwin.uploadInfo.footer;
                    scwin.vappend = scwin.uploadInfo.append;
                    scwin.vhidden = scwin.uploadInfo.hidden;
                    scwin.fillHidden = scwin.uploadInfo.fillHidden;
                    scwin.advancedHidden = scwin.uploadInfo.advancedHidden;
                    scwin.skipSpace = scwin.uploadInfo.skipSpace;
                    scwin.vremoveColumns = scwin.uploadInfo.removeColumns;
                    scwin.actionUrl = scwin.uploadInfo.action;
                    scwin.gridID = scwin.uploadInfo.gridID;
                    scwin.vcolumnNum = scwin.uploadInfo.columnNum;
                    scwin.expressionColumns = scwin.uploadInfo.expressionColumns;
                    scwin.vhiddenColumns = scwin.uploadInfo.hiddenColumns;
                    scwin.vheaderRows = scwin.uploadInfo.headerRows;
                    scwin.gridStartRow = scwin.uploadInfo.gridStartRow;
                    //var gridStartCol = getParameter("gridStartCol");

                    scwin.columnIds = scwin.uploadInfo.columnIds;
                    scwin.processMsg = scwin.uploadInfo.processMsg;
                    scwin.processMsg = WebSquare.text.BASE64URLDecoder( scwin.processMsg );
                    scwin.dataList = scwin.uploadInfo.dataList;
                    scwin.expression = scwin.uploadInfo.expression;
                    scwin.status = scwin.uploadInfo.status;
                    scwin.optionParam = scwin.uploadInfo.optionParam;
                    scwin.columnOrder = scwin.uploadInfo.columnOrder;
                    scwin.trim = scwin.uploadInfo.trim;
                    scwin.useXHR = scwin.uploadInfo.useXHR + "";
                    scwin.filePath = scwin.uploadInfo.filePath;
                    scwin.useDialog = scwin.uploadInfo.useDialog;
                    scwin.msaName = scwin.uploadInfo.msaName;

                    domain.setValue(scwin.domain);
                    delim.setValue(scwin.delim);
                    escapeChar.setValue(scwin.escapeChar);
                    
                    // advancedHidden
                    scwin.advancedSetting = advancedSetting;
                    if( typeof scwin.advancedHidden == "string") {
                        scwin.advancedHidden = WebSquare.util.getBoolean(scwin.advancedHidden);
                    }

                    if( scwin.advancedHidden ) {
                        scwin.advancedSetting.setStyle("display", "none");
                        scwin.advancedSetting.setStyle("visibillity", "hidden");
                    }
                    
                    // skipSpace
                    if( typeof scwin.skipSpace == "string" ) {
                        scwin.skipSpace  = WebSquare.util.getBoolean(scwin.skipSpace);
                    }

                    if( scwin.skipSpace ) {
                        scwin.sel1[0].selected = true;
                    } else {
                        scwin.sel1[1].selected = true;
                    }

                    // hidden
                    if( typeof scwin.vhidden == "string") {
                        scwin.vhidden  = WebSquare.util.getBoolean(scwin.vhidden);
                    }

                    if( scwin.vhidden ) {
                        scwin.sel2[0].selected = true;
                    } else {
                        scwin.sel2[1].selected = true;
                    }

                    // fillHidden
                    if( typeof scwin.fillHidden == "string" ) {
                        scwin.fillHidden  = WebSquare.util.getBoolean(scwin.fillHidden);
                    }

                    if( scwin.fillHidden ) {
                        scwin.sel3[0].selected = true;
                    } else {
                        scwin.sel3[1].selected = true;
                    }

                    if( typeof scwin.vheader == "string" ) {
                        scwin.vheader  = WebSquare.util.getBoolean(scwin.vheader);
                    }

                    if( scwin.vheader ) {
                        scwin.sel4[0].selected = true;
                        //scwin.header[0].selected;
                    } else {
                        scwin.sel4[1].selected = true;
                        //scwin.header[1].selected;
                    }

                    removeColumns.setValue(scwin.vremoveColumns);
                    columnNum.setValue(scwin.vcolumnNum);
                    expressionColumns.setValue(scwin.expressionColumns);
                    hiddenColumns.setValue(scwin.vhiddenColumns);
                    //document.getElementById("footer").value = vfooter;
                    //document.getElementById("header").value = scwin.vheader;
                    headerRows.setValue(scwin.vheaderRows);

                    scwin.el = WebSquare.Elem.api.getElementsByTagName(window[scwin.gridID].element, "w2:gBody");
                    scwin.rows = WebSquare.Elem.api.getElementsByTagName(scwin.el[0],"w2:row");
                    scwin.myrows = scwin.rows.length;
                    bodyRows.setValue(scwin.myrows);

                    gridStartRow.setValue(scwin.gridStartRow);
                    ////document.getElementById("gridStartCol").value = gridStartCol;
                    ////document.getElementById("gridEndCol").value = gridEndCol;

                    var elemType = window[scwin.gridID].element._elementType;
                    var gridStyleStr = "";
                    if (elemType === "json") {
                        gridStyleStr = WebSquare.xmljs.json2xml(window[scwin.gridID].element._element, {
                            "changeKey": {
                                "w2:select": "w2:column"
                            }
                         });
                    } else {
                        gridStyleStr = WebSquare.xml.noNameSpaceSerialize(window[scwin.gridID].element._element);
                    }
                    gridStyle.setValue(gridStyleStr);
                    expression.setValue(scwin.expression);
                    optionParam.setValue(scwin.optionParam);
                    columnOrder.setValue(scwin.columnOrder);
                    trim.setValue(scwin.trim);
                    useXHR.setValue(scwin.useXHR);
                    filePath.setValue(scwin.filePath);
                    useDialog.setValue(scwin.useDialog);
                    msaName.setValue(scwin.msaName);

                    with( document.__uploadForm__ ) {
                        action = scwin.actionUrl;
                    }
                };

                scwin.onpageunload = function() {
                    
                };

                scwin.setImgURL = function() {
                    scwin.headerURL = "url(" + "'" + WebSquare.baseURI + "/_websquare_/uiplugin/grid/upload/images/bg_header.gif" + "')" + "repeat-x left top";
                    scwin.titleURL = "url(" + "'" + WebSquare.baseURI + "/_websquare_/uiplugin/grid/upload/images/bul_title.gif" + "')" + "no-repeat 11px 6px";
                    scwin.dotURL = "url(" + "'" + WebSquare.baseURI + "/_websquare_/uiplugin/grid/upload/images/dot.gif" + "')" + "no-repeat left center";

                    bg_header.setStyle("background", scwin.headerURL);
                    bul_title.setStyle("background", scwin.titleURL);
                    space_option.setStyle("background", scwin.dotURL);
                    start_option.setStyle("background", scwin.dotURL);
                    hidden_option.setStyle("background", scwin.dotURL);
                    hidden_fill.setStyle("background", scwin.dotURL);
                    header_option.setStyle("background", scwin.dotURL);
                };

                window.returnData = function( vData ) {
                    with (WebSquare.util.getComponentById(WebSquare.csvPopUUID).scope) {
                        if( scwin.processMsg != "" ) {
                            scwin.hideProcessMessage();
                        }
                
                        scwin.doc = WebSquare.xml.parse( vData );
                        scwin.exception = scwin.doc.getElementsByTagName("Exception");

                        if( scwin.exception.length > 0) {
                            scwin.code = scwin.doc.getElementsByTagName("deniedCodeList")[0].firstChild;
                            if( typeof scwin.code == "undefined" || scwin.code == null || scwin.code == "" ) {
                                scwin.code = "";
                            } else {
                                scwin.code = scwin.code.nodeValue;
                            }
                
                            if( scwin.code == "102" ) {
                                scwin.msg = scwin.Upload_msg2;
                            } else {
                                scwin.msg = scwin.doc.getElementsByTagName("message")[0].firstChild;
                                if( typeof scwin.msg == "undefined" || scwin.msg == null || scwin.msg == "" ) {
                                    scwin.msg = scwin.Upload_msg3;
                                } else {
                                    scwin.msg = scwin.msg.nodeValue;
                                }
                            }

                            alert(scwin.msg);
                        } else {
                            scwin.child = (scwin.doc.getElementsByTagName("array"))[0].firstChild.nodeValue;

                            if( typeof scwin.vappend =="string" ) {
                                scwin.vappend = WebSquare.util.getBoolean(scwin.vappend);
                            }

                            scwin.compId = "";
                            try {

                                scwin.jsonArray = {
                                    columnInfo:scwin.columnIds.split(","),
                                    data:scwin.child
                                };

                                if( scwin.dataList != "" ) {
                                    scwin.compId = scwin.dataList;
                                    scwin.dcComp = WebSquare.util.getComponentById(scwin.compId);
                                    scwin.preCnt = scwin.dcComp.getRowCount();

                                    if( scwin.uploadType == 1 || scwin.uploadType == 2 ) {
                                        window[scwin.compId].setArrayFile(scwin.jsonArray, scwin.vappend, scwin.gridID, scwin.uploadType);
                                    } else {
                                        window[scwin.compId].setArray(scwin.jsonArray, scwin.vappend);
                                    }

                                    if( status == "C" ) {
                                        scwin.postCnt = scwin.dcComp.getRowCount();
                                        if( scwin.vappend ) {
                                            scwin.dcComp.modifyRangeStatus( scwin.preCnt, scwin.postCnt, "C" );
                                        } else {
                                            scwin.dcComp.modifyRangeStatus( 0, scwin.postCnt, "C" );
                                        }
                                    }

                                } else {
                                    scwin.compId = scwin.gridID;
                                    scwin.gridObj = window[scwin.compId];
                                    scwin.preCnt = scwin.gridObj.getRowCount();
                                    if( scwin.uploadType == 1 || scwin.uploadType == 2 ) {
                                        window[scwin.compId].setDataFile(scwin.child, scwin.vappend, scwin.jsonArray.columnInfo, scwin.compId, scwin.uploadType);
                                    } else {
                                        window[scwin.compId].setData(scwin.child, scwin.vappend);
                                    }
                
                                    if( scwin.status == "C" ) {
                                        scwin.postCnt = scwin.gridObj.getRowCount();
                                        if( scwin.vappend ) {
                                            scwin.gridObj.modifyRangeStatus( scwin.preCnt, scwin.postCnt, "C" );
                                        } else {
                                            scwin.gridObj.modifyRangeStatus( 0, scwin.postCnt, "C" );
                                        }
                                    }

                                }

                                scwin.fileNameDom = filename;
                                scwin.fileName = scwin.fileNameDom.getValue();
                                scwin.fileNameArr = scwin.fileName.split("\\");
                                window[scwin.gridID].fireFileReadEnd( scwin.fileNameArr[scwin.fileNameArr.length-1] );
                            } catch (e) {
                                WebSquare.exception.printStackTrace(e);
                                alert( scwin.Upload_msg5 );
                            }
                        }
                        gridStyle.setValue(null);
                        $p.getFrame().getParent().close();
                        scwin.deleteElements();
                    }
                }

                scwin.deleteElements = function() {
                    if (scwin.processMsg != "") {
                        scwin.parentElem.removeChild(scwin.processbar2);
                        scwin.parentElem.removeChild(scwin.processbar2i);
                    }
                    if (!scwin.find) {
                        scwin.parentElem.removeChild(scwin.layerUP);
                    }
                }

                scwin.receiveMessage = function(retObj) {
                    try {
                        if (retObj.currentTarget.WebSquare) {
                            returnData(retObj.data);
                        }
                    } catch (e) {
                        WebSquare.exception.printStackTrace(e);
                        alert( scwin.Upload_msg5 );
                    }
                };

                scwin.showProcessMessage = function( processMsg ) {
                    try {
                        if(!processMsg || processMsg == "" ) { 
                            return;
                        }

                        scwin.processbar2_main = document.getElementById( "___processbar2" );
                        scwin.processbar2 = document.getElementById( "___processbar2_i" );
                        scwin.processMsgURL = WebSquare.core.getConfiguration( "processMsgURL" );
                        scwin.processMsgHeight = WebSquare.core.getConfiguration( "processMsgHeight" );
                        scwin.processMsgWidth = WebSquare.core.getConfiguration( "processMsgWidth" );
                        scwin.processMsgBackground = WebSquare.core.getConfiguration( "processMsgBackground" );
                        scwin.processMsgBackgroundColor = WebSquare.core.getConfiguration( "/WebSquare/processMsgBackground/@backgroundColor" );
                        if (scwin.processMsgBackgroundColor == ""){
                            scwin.processMsgBackgroundColor = "#112233";
                        }
                        if( scwin.processMsgURL == "" ) {
                            scwin.processMsgURL = WebSquare.baseURI + WebSquare.BootLoader.inquiresPath("message/processMsg.html");
                        }

                        scwin.processMsgURL = scwin.processMsgURL + "?param=" + WebSquare.text.URLEncoder(processMsg);

                        if( scwin.processMsgHeight == "" || scwin.processMsgWidth == "" ) {
                            scwin.processMsgHeight = "74";
                            scwin.processMsgWidth = "272";
                        }

                        WebSquare.layer.processMsg = processMsg;

                        if(!scwin.processbar2_main){
                            scwin.node2Main = document.createElement( "div" );
                            scwin.node2Main.id = "___processbar2";
                            scwin.node2Main.className = "w2modal";
                            scwin.node2Main.style.backgroundColor = scwin.processMsgBackgroundColor;
                            scwin.node2Main.tabIndex = 1;
                            if(scwin.processMsgBackground == "true"){
                                scwin.node2Main.style.visibility = "visible";
                            } else{
                                scwin.node2Main.style.visibility = "hidden";
                            }

                            scwin.node2Main.style.height = document.documentElement.clientHeight + "px";
                            document.body.appendChild( scwin.node2Main );

                            scwin.e = scwin.e || event;
                            if( scwin.e.preventDefault ) {
                                if( scwin.e.type == "keydown" ) {
                                    scwin.e.preventDefault();
                                }
                            } else {
                                if( scwin.e.type == "keydown" ) {
                                    scwin.e.returnValue = false;
                                }
                            }

                        } else {
                            scwin.processbar2_main.tabIndex = 1;
                            scwin.processbar2_main.style.zIndex = 10000;
                            scwin.processbar2_main.style.display = "block";
                            scwin.processbar2_main.style.top = "0px";
                            scwin.processbar2_main.style.left = "0px";
                        }

                        if( !scwin.processbar2 ) {
                            scwin.nTop = document.documentElement.scrollTop + document.documentElement.clientHeight/2 - parseInt(scwin.processMsgHeight)/2;
                            scwin.nLeft = document.documentElement.scrollLeft + document.documentElement.clientWidth/2 - parseInt(scwin.processMsgWidth)/2;

                            scwin.node2 = document.createElement("div");
                            scwin.node2.id = "___processbar2_i";
                            scwin.node2.style.position = "absolute";
                            scwin.node2.style.top = parseInt(scwin.nTop) + "px";
                            scwin.node2.style.left = parseInt(scwin.nLeft) + "px";
                            scwin.node2.style.overflow = "hidden";
                            scwin.node2.style.zIndex = 10001;
                            scwin.node2.style.visibility = "visible";
                            scwin.node2.style.height = scwin.processMsgHeight + "px";
                            scwin.node2.style.width = scwin.processMsgWidth + "px";

                            document.body.appendChild( scwin.node2 );
                            WebSquare.core._safeInnerHTML(scwin.node2, "<iframe frameborder='0' scrolling='no' name='__processbarIFrame' style='position:absolute; width:"+scwin.processMsgWidth+"px; height:"+ scwin.processMsgHeight +"px; top:0px; left:0px' src='" + scwin.processMsgURL + "'></iframe>");

                        } else {
                            scwin.nTop = document.documentElement.scrollTop + document.documentElement.clientHeight/2 - parseInt(scwin.processMsgHeight)/2;
                            scwin.nLeft = document.documentElement.scrollLeft + document.documentElement.clientWidth/2 - parseInt(scwin.processMsgWidth)/2;
                            scwin.processbar2.style.top = parseInt(scwin.nTop) + "px";
                            scwin.processbar2.style.left = parseInt(scwin.nLeft) + "px";
                            scwin.processbar2.style.zIndex = 10001;
                            window.frames["__processbarIFrame"].location.replace( scwin.processMsgURL );
                            scwin.processbar2.style.display = "block";
                        }
                    } catch( e ) {
                        WebSquare.exception.printStackTrace(e);
                    }
                };

                scwin.hideProcessMessage = function() {
                    try {
                        scwin.processbar2 = document.getElementById( "___processbar2" );
                        scwin.processbar2i = document.getElementById( "___processbar2_i" );
                        if( typeof scwin.processbar2 != "undefined" && scwin.processbar2 != null ) {
                            scwin.processbar2.style.zIndex = -1;
                            scwin.processbar2.style.display = "none";
                            scwin.processbar2.tabIndex = "-1";
                            scwin.processbar2.textContent = '';
                        }
                        if( typeof scwin.processbar2i != "undefined" && scwin.processbar2i != null ) {
                            scwin.processbar2i.style.zIndex = -1;
                            scwin.processbar2i.style.display = "none";
                        }
                    } catch( e ) {
                        WebSquare.exception.printStackTrace(e);
                    }
                };

                scwin.crossBrowserHeight = function() {
                    scwin.height = 255;
                    if(WebSquare.util.isIE(6)) {
                        scwin.height = 255;
                    } else if(WebSquare.util.isIE(7)) {
                        scwin.height = 255;
                    } else if(WebSquare.util.isIE(8)) {
                        scwin.height = 255;
                    } else if(WebSquare.util.isIE(9)) {
                        scwin.height = 255;
                    } else if(WebSquare.util.isIE(10)) {
                        scwin.height = 253;
                    } else if(WebSquare.util.isIEAllVersion(11)) {
                        scwin.height = 297;
                    } else if(WebSquare.util.isFF()) {
                        if(scwin.osName == "window") {
                            scwin.height = 255;
                        } else if(scwin.osName == "mac") {
                            scwin.height = 253;
                        }
                    } else if(WebSquare.util.isChrome()) {
                        if (navigator.userAgent.indexOf("OPR") != -1) {  //opera
                            if (scwin.osName == "window") {
                                scwin.height = 307;
                            } else if (scwin.osName == "mac") {
                                scwin.height = 302;
                            }
                        } else { //chrome
                            if(scwin.osName == "window") {
                                    scwin.height = 298;
                            } else if(scwin.osName == "mac") {
                                    scwin.height = 298;
                            }
                        }
                    } else if(WebSquare.util.isSafari()) {
                        if(scwin.osName == "mac") {
                            scwin.height = 250;
                        }
                    } else if(WebSquare.util.isOpera()) {
                        if(scwin.osName == "window") {
                            scwin.height = 250;
                        } else if(scwin.osName == "mac") {
                            scwin.height = 250;
                        }
                    }
                    return scwin.height;
                };

                scwin.checkWidth = function() {
                    if(scwin.uploadInfo.sFeatures.width == undefined) {
                        return scwin.sizeInfo.width;
                    } else {
                        return scwin.uploadInfo.sFeatures.width;
                    }
                };
    
                scwin.checkHeight = function(flag) {
                    if(scwin.uploadInfo.sFeatures.height == undefined) {
                        if(flag == true) {
                            return scwin.crossBrowserHeight();
                        } else {
                            return scwin.sizeInfo.height;
                        }
                    } else {
                        return scwin.uploadInfo.sFeatures.height;
                    }
                };
                
                scwin.subcheck_oncheckboxclick = function(index,checked,value) {
                    if(checked == true) {
                        $p.getFrame().getParent().setSize(scwin.checkWidth(), scwin.checkHeight(true));
                        sub.setStyle("display", "block");
                    } else {
                        $p.getFrame().getParent().setSize(scwin.checkWidth(), scwin.checkHeight(false));
                        sub.setStyle("display", "none");
                    }
                };
                
                scwin.endsWith = function(str, s) {
                    return str.substring(str.length - s.length, str.length) == s;
                };

                scwin.sendFILE_onclick = function(e) {
                    try {
                        scwin.thisForm = document.getElementsByName("__uploadForm__")[0];
                        scwin.filename = filename.getValue();
                        if( !scwin.filename || scwin.filename =="" ) {
                            return false;
                        }
                        
                        scwin.isCSVFile = scwin.endsWith(scwin.filename.toLowerCase(), ".csv") == true ||
                                        scwin.endsWith(scwin.filename.toLowerCase(), ".txt") == true;
                        if( !scwin.isCSVFile ) {
                            alert( scwin.Upload_msg4 );
                            return false;
                        }

                        if( scwin.maxFileSize != -1 ) {
                            scwin.uploadFile = filename.getValue();
                            if( scwin.uploadFile && scwin.uploadFile.files ) {
                                if( scwin.maxFileSize < scwin.uploadFile.files[0].size ) {
                                    alert( scwin.Grid_warning9 );
                                    return;
                                }
                            }
                        }

                        scwin.frm = window.frames;
                        scwin.find = false;
                        for( var i = 0; i < scwin.frm.length; i++ ) {
                            if( scwin.frm[i].name == scwin.thisForm.target ) {
                                scwin.find = true;
                            }
                        }
                        
                        if( !scwin.find ) {
                            scwin.layerUP= document.createElement("div");
                            scwin.src = "";
                            scwin.layerUP.style.border="1px solid blue";
                            scwin.layerUP.style.width="100px";
                            scwin.layerUP.style.height="100px";
                            scwin.layerUP.style.visibility = "hidden";
                            document.body.appendChild(scwin.layerUP);
                            scwin.src = WebSquare.net.getSSLBlankPage();
                            WebSquare.core._safeInnerHTML(scwin.layerUP, "<iframe frameborder='0px' name='" + scwin.thisForm.target + "' scrolling='no' style='width:100px; height:100px' " + scwin.src + "></iframe>");
                            scwin.parentElem = scwin.layerUP.parentElement;
                        }
                        
                        scwin.showProcessMessage( scwin.processMsg );

                        if (scwin.useXHR == "true") {
                            var form = document.getElementsByName("__uploadForm__");
                                                    fileSelected = form[0].filename.files[0];

                            var formData = new FormData();
                            formData.append("filename", fileSelected);

                            var paramList = form[0].getElementsByTagName("input");
                            for (var i=0; i<paramList.length; i++) {
                                formData.append(paramList[i].name, paramList[i].value);
                            }

                            paramList = form[0].getElementsByTagName("select");
                            for (var i=0; i<paramList.length; i++) {
                                formData.append(paramList[i].name, paramList[i].value);
                            }

                            var xhr = new XMLHttpRequest();
                            xhr.onreadystatechange = function() {
                                if (xhr.readyState == 4 && xhr.status == 200) {
                                    var result = xhr.responseText;

                                    var idx1 = result.indexOf("'");
                                    var idx2 = result.lastIndexOf("'");
                                    result = result.substring(idx1+1, idx2);

                                    returnData(result);
                                }
                            };
                            xhr.open("POST", scwin.actionUrl, true);
                            var fileName = encodeURIComponent(fileSelected.name);
                            xhr.setRequestHeader("X-File-Name", fileName);

                            var reqHeaderFuncName = WebSquare.core.getConfiguration("/WebSquare/handler/requestHeaderFunction/@value");
                            if(reqHeaderFuncName != "") {
                                var reqHeaderFunc = WebSquare.util.getGlobalFunction(reqHeaderFuncName);
                                if (reqHeaderFunc) {
                                    reqHeaderFunc(xhr, "csvupload");
                                }
                            }

                            xhr.send(formData);
                        } else {
                            scwin.thisForm.submit();
                        }
                    } catch(e) {
                        alert(e.description);
                    }
                };
            ]]>
        </script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
        <form name="__uploadForm__" method="post" action="" enctype="multipart/form-data" target="__targetFrame__">
            <xf:group id="" style="" class="exup_wrap">
                <xf:group id="bg_header" style="" class="exup_header">
                    <xf:group id="advancedSetting" style="" tagname="span" class="exup_spanGroup">
                        <w2:textbox label="Advanced" id="setting" style="" for="subcheck" tagname="p" class="title2"></w2:textbox>
                        <xf:select appearance="full" id="subcheck" style="" selectedindex="-1" cols="" rows="" ref="" class="subcheck" ev:oncheckboxclick="scwin.subcheck_oncheckboxclick" tagname="" renderType="native">
                            <xf:choices>
                                <xf:item>
                                    <xf:label>
                                        <![CDATA[]]>
                                    </xf:label>
                                    <xf:value>
                                        <![CDATA[]]>
                                    </xf:value>
                                </xf:item>
                            </xf:choices>
                        </xf:select>
                    </xf:group>
                    <xf:group id="bul_title" style="" class="title" tagname="p" text="File Upload"></xf:group>
                </xf:group>
                <xf:group id="" style="" class="exup_content">

                    <xf:group id="" style="" class="filebox">
                        <xf:trigger type="button" id="choose_file" style="width: 80px;height: 23px;" ev:onclick="scwin.choose_file_onclick">
                            <xf:label><![CDATA[Choose File]]></xf:label>
                        </xf:trigger>
                        <w2:span label="Insert Text" style="" id="choose_span" class="fileName">No file chosen</w2:span>
                        <xf:input adjustMaxLength="false" id="filename" name="filename" style="width:95%;display:none;" type="file" class="filename">
                            <w2:attributes>
                                <w2:name>filename</w2:name>
                            </w2:attributes>
                        </xf:input>
                    </xf:group>
                    <xf:group id="sub" style="width: 100%" tagname="table" class="exup_tbl none">
                        <w2:attributes>
                            <w2:summary>Ignore blank spaces,Hidden values,Fill Hidden,Footer,Start Row</w2:summary>
                        </w2:attributes>
                        <xf:group tagname="caption" id="advanced"></xf:group>
                        <xf:group tagname="colgroup">
                            <xf:group style="width:25.00%" tagname="col"></xf:group>
                            <xf:group style="width:25.00%" tagname="col"></xf:group>
                            <xf:group style="width:25.00%" tagname="col"></xf:group>
                            <xf:group style="width:25.00%" tagname="col"></xf:group>
                        </xf:group>
                        <xf:group tagname="tr">
                            <xf:group style="" tagname="th">
                                <w2:attributes>
                                    <w2:scope>row</w2:scope>
                                </w2:attributes>
                                <w2:textbox label="" id="space_option" style="" for="mf_mf_csvPop_wframe_spaceSelect" class="dot"></w2:textbox>
                            </xf:group>
                            <xf:group style="" tagname="td">
                                <xf:select1 allOption="" appearance="minimal" chooseOption="" class="sel" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="spaceSelect" name="skip_space" ref="" renderType="select" style="" submenuSize="auto">
                                    <xf:choices>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                    </xf:choices>
                                </xf:select1>
                            </xf:group>
                            <xf:group style="" tagname="th">
                                <w2:attributes>
                                    <w2:scope>row</w2:scope>
                                </w2:attributes>
                                <w2:textbox label="" id="start_option" style="" for="gridStartRow" class="dot"></w2:textbox>
                            </xf:group>
                            <xf:group style="" tagname="td">
                                <xf:input adjustMaxLength="false" id="gridStartRow" name="gridStartRow" style="" class="ipt" type="text"></xf:input>
                            </xf:group>
                        </xf:group>
                        <xf:group tagname="tr">
                            <xf:group style="" tagname="th">
                                <w2:attributes>
                                    <w2:scope>row</w2:scope>
                                </w2:attributes>
                                <w2:textbox label="" id="hidden_option" style="" class="dot" for="mf_mf_csvPop_wframe_hiddenSelect"></w2:textbox>
                            </xf:group>
                            <xf:group style="" tagname="td">
                                <xf:select1 allOption="" appearance="minimal" chooseOption="" class="sel" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="hiddenSelect" name="hidden" ref="" renderType="select" style="" submenuSize="auto">
                                    <xf:choices>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                    </xf:choices>
                                </xf:select1>
                            </xf:group>
                            <xf:group style="" tagname="th">
                                <w2:attributes>
                                    <w2:scope>row</w2:scope>
                                </w2:attributes>
                                <w2:textbox label="" id="hidden_fill" style="" class="dot" for="mf_mf_csvPop_wframe_fillHidden"></w2:textbox>
                            </xf:group>
                            <xf:group style="" tagname="td">
                                <xf:select1 allOption="" appearance="minimal" chooseOption="" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="fillHidden" name="fillHidden" ref="" renderType="select" style="" submenuSize="auto">
                                    <xf:choices>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                    </xf:choices>
                                </xf:select1>
                            </xf:group>
                        </xf:group>
                        <xf:group tagname="tr">
                            <xf:group style="" tagname="th">
                                <w2:attributes>
                                    <w2:scope>row</w2:scope>
                                </w2:attributes>
                                <w2:textbox label="" id="header_option" style="" class="dot" for="mf_mf_csvPop_wframe_header"></w2:textbox>
                            </xf:group>
                            <xf:group style="" tagname="td">
                                <xf:select1 allOption="" appearance="minimal" chooseOption="" direction="auto" disabled="false" disabledClass="w2selectbox_disabled" id="header" name="header" ref="" renderType="select" style="" submenuSize="auto">
                                    <xf:choices>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                        <xf:item>
                                            <xf:label>
                                                <![CDATA[new row]]>
                                            </xf:label>
                                            <xf:value>
                                                <![CDATA[]]>
                                            </xf:value>
                                        </xf:item>
                                    </xf:choices>
                                </xf:select1>
                            </xf:group>
                            <xf:group style="" tagname="th">
                                <w2:attributes>
                                    <w2:scope>row</w2:scope>
                                </w2:attributes>
                            </xf:group>
                            <xf:group style="" tagname="td"></xf:group>
                        </xf:group>
                    </xf:group>
                </xf:group>
                <xf:group id="" style="" class="foot">
                    <xf:group id="" style="" tagname="p">
                        <xf:trigger type="button" id="sendFILE" name="sendFILE" style="" class="btn_exup_file" ev:onclick="scwin.sendFILE_onclick">
                            <xf:label>
                                <![CDATA[File Upload]]>
                            </xf:label>
                        </xf:trigger>
                    </xf:group>
                </xf:group>
            </xf:group>
            <xf:input adjustMaxLength="false" name="domain" id="domain" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="delim" id="delim" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="escapeChar" id="escapeChar" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="footer" id="footer" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="removeColumns" id="removeColumns" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="expressionColumns" id="expressionColumns" style="" type="hidden" initValue="CC"></xf:input>
            <xf:input adjustMaxLength="false" name="hiddenColumns" id="hiddenColumns" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="headerRows" id="headerRows" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="columnNum" id="columnNum" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="bodyRows" id="bodyRows" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="gridStyle" id="gridStyle" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="expression" id="expression" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="optionParam" id="optionParam" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="columnOrder" id="columnOrder" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="useXHR" id="useXHR" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="filePath" id="filePath" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="useDialog" id="useDialog" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="msaName" id="msaName" style="" type="hidden"></xf:input>
            <xf:input adjustMaxLength="false" name="trim" id="trim" style="" type="hidden"></xf:input>
        </form>

    </body>
</html>
