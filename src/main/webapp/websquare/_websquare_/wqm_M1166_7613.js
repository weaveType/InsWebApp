"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[7613],{7613:(t,e,i)=>{i.r(e),i.d(e,{cellInfo:()=>E,drilldown:()=>L,gridView:()=>O,headerInfo:()=>I,linkedMappingController:()=>F,mappingController:()=>k.b});var o=i(582),s=i(2710),r=i(2536),a=i(1263),n=i(7249),l=function(){};l.prototype._notifySettedGridDataAll=function(t,e){try{this.dataList.clearFilter(!0),t||(this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.extraData={grid:{},row:[],col:[],cell:[]},e=0,this._removeAllTDCellClass(),this._cellSelectedIndex=[],this.hiddenRowObj.init&&this.clearRowVisible({noDraw:!0})),this.hasFooter&&(this.footerTempSum=[]),this.beforeDataLength=-1,1==this.isDrillDown&&(this.setCellInfo(),1==this.isPaste?this.initPasteDrilldown():this.initDrilldown()),this.initStyleArr(e),this.lastTopRowIndex=null,this.loadFlag=!0,this.settedData=!0}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySettedGridData=function(t,e,i,o,r,a){try{if(this.options.scrollFix&&this.settedData){for(var n=this.getTopRowIndex(),l=0;l<=this.lastIndex;l++){var h=n+l;this.drawRowData(h-this.rowIndex,h)}return}this.dataList.clearFilter(!0),this._oldFilterArrStr||this.notifyClearFilter(!0),this.settedData=!1;i=i;var d=[];if(!(e=e||!1)&&this.hiddenRowObj.init)for(var p in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[p]&&d.push(p);this._notifySettedGridDataAll(e,i),0==this.loadFlag&&e?this.loadFlag=!1:this.loadFlag=!0,this.lastTopRowIndex=null;var u={gridData:!0!==a};if(e&&(u.append=!0,u.keepTop=!0),this.notifyDataChanged(u),!e)for(l=0;l<d.length;l++)this.setRowVisible(d[l]);this.loadFlag=!0,0==this.getTotalRow()&&this.removeFocusedCell(),this.options.focusOnSetData&&this._setFocusedCell(0,0),!0!==this._isBrowserScroll()&&this.setScrollYHeight(),this.settedData=!0,this.options.fixedRightColumn>0&&this._handleScrollX(),(!e&&this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0),(!0===r||this.options.instanceBindBySetData)&&this.options.ref&&this._refreshInstance(t,e),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeSettedCellData=function(){try{if(null!=this.editedCell)return this.options.keepEditMode&&"onclick"==this.options.editModeEvent&&(this._reEditCell={_editTd:this.editedCell.editTd,_rowIndex:this.editedCell.editRowIndex}),void this.editedCell.handleEndEdit()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySettedCellData=function(t,e,i,o){try{this.hasFooter&&(this.footerTempSum=[]);var r=this.getColumnIndex(e);t=this._getGroupbyGroupedRowIndex(t);this.notifyCellChanged(t,r,o),null==r&&null!=this._dataList.getColumnIndex(e)&&this._refreshExpression(t,e),this.isDrillDown&&(null==r&&this._dataList.options.depthColumn&&(r=this._dataList.getColumnIndex(e)),this.drilldown.options.depthColumn==r&&(this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight()));var n=a.Z.getDataPrefix("colMerged"),l=this.getCellInfo(e),h=t,d=this.getTotalRow();if(l&&l.options.colMerge&&l.options.colMergeEdit&&!this.groupbyStatus.grouped){var p=this.data_td_list[(h-this.rowIndex)*this.oneRowDataLength+r];if(p){var u,c=p.getAttribute(n);if("1"==c&&i!=this.dataList.getCellData(h-1,r))if(p.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex,h,r),h<d-1)(u=this.data_td_list[(h-this.rowIndex+1)*this.oneRowDataLength+r])&&(i==this.dataList.getCellData(h+1,r)?u.setAttribute(n,"1"):u.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex+1,h+1,r));if("0"==c)if(h>=1&&i==this.dataList.getCellData(h-1,r)&&(p.setAttribute(n,"1"),this.drawCellData(h-this.rowIndex,h,r)),
h<d-1)(u=this.data_td_list[(h-this.rowIndex+1)*this.oneRowDataLength+r])&&(i==this.dataList.getCellData(h+1,r)?u.setAttribute(n,"1"):u.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex+1,h+1,r))}}this._reEditCell&&this._reEditCell._editTd&&(this.editMode=!0,this.setCellEditMode(this._reEditCell._editTd,this._reEditCell._rowIndex),this._reEditCell={}),this.moveDirection=null,!0===this._isHybridScroll()&&this._setHybridVisibleHeight()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeInsertedRow=function(t){try{!this.isDrillDown&&t>this.getDataLength()&&(t=this.getDataLength());var e=!1,i=[];if(this.isDrillDown){for(var o=this.drilldown.getParentRowIndex(t);o>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(o))||(e=!0,i.push(o)),o=this.drilldown.getParentRowIndex(o);if(e)for(var r=i.length-1;r>=0;r--)if(!this.drilldown.isOpen(i[r])){var a=this.drilldown.getDisplayRowIndex(i[r]);this._toggle(a)}}}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyAfterInsertedRow=function(t,e){try{this.settedData=!1;var i=this.dataList.getRealRowIndex(t),o=this.getTotalCol();function v(t,e,i){var o=i,s=[],r=t.length;for(var a in t)if(!isNaN(a)){var n=Number(a);n>=e&&s.push(n)}s.sort((function(t,e){return e-t}));for(var l=0;l<s.length;l++){var h=s[l];t[h+o]=t[h],delete t[h]}t.length=r+o}this.resetExpressionFunc();var r=i*o;v(this.cellStyleArr,r,o),v(this.cellClassArr,r,o),v(this.cellReadOnlyArr,r,o),v(this.cellDisabledArr,r,o),v(this._cellSelectedIndex,r,o),this.extraData.row.splice(t,0,null),this.extraData.cell.splice(t,0,null);for(var a=this.getColumnCount(),n=0;n<a;n++){var l=this.getCellInfo(n);if("custom"==l.options.inputType){var h=this.getDataLength();l.isValidTypeGetter||(l.cellManagerHashByRowIndex.splice(i,0,null),l.cellManagerIDByRowIndex.splice(i,0,null),l.cellManagerInfoByRowIndex.splice(i,0,null));for(var d=h;d>i;d--){var p=l.cellManagerHashByRowIndex[d];if(p){var u,c=l.cellManagerIDByRowIndex[d];u=p.options.embeddedInput?this.id+"_"+c:l.mainGridId+c,this._removeDom(u),l.isValidTypeGetter||(l.cellManagerHashByRowIndex[d]=null,l.cellManagerIDByRowIndex[d]=null)}}}}if(this.isDrillDown&&this.drilldown.statusArr.splice(i,0,!0),this.hasFooter&&(this.footerTempSum=[]),this._mergeNotifyRowChanged("insertRow",t),!0!==e&&(this.notifyRowInserted(t),this.notifyStatusChanged({rowIndex:[t]})),this.options.ref&&1!=this.insertRowByInstance&&!0!==e&&this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){var g;g=1==this.repeatNodeTagNameFilter&&1==this.repeatNodeTagName.length?this.filteredRepeatNodeTagName[0]:this.repeatNodeTagName[0];var f,m=WebSquare.xml.parse("<"+g+"></"+g+">").documentElement,y=m,b=g;this.repeatNodeTagName.length>1&&(b=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(n=1;n<this.repeatNodeTagName.length;n++)y=WebSquare.xml.createNode(y,this.repeatNodeTagName[n],!1);f=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(m,b):m;for(n=0;n<this.repeatNodeChildTagName.length;n++)WebSquare.xml.createNode(f,this.repeatNodeChildTagName[n],!1);t>=this.maxRowLength?WebSquare.ModelUtil.setInstanceNode(m,this.options.ref,null,"append",!1,this.scope_id):WebSquare.ModelUtil.setInstanceNode(m,this.options.ref+"/"+g+"["+(t+1)+"]",null,"insertBeforeSibling",!1,this.scope_id)}return this.settedData=!0,this.loadFlag=null==this.loadFlag||this.loadFlag,this._refreshColumnClass(),this._autoFitRefreshNative(),t}catch(w){s.Y.printStackTrace(w,null,this)}},l.prototype.notifyBeforeRemovedRow=function(t){try{if(this.options.ref&&1!=this.removeRowByInstance){var e=this.getRealRowIndex(t)+1;WebSquare.ModelUtil.removeInstanceNode(this.options.ref+"/"+this.repeatNodeTagName[0]+"["+e+"]",!1,this.scope_id)}if(this.isDrillDown&&this._dataList.options.depthColumn){for(var i=!1,o=[],r=this.drilldown.getParentRowIndex(t);r>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(r))||(i=!0,o.push(r)),r=this.drilldown.getParentRowIndex(r)
;if(i)for(var a=o.length-1;a>=0;a--)if(!this.drilldown.isOpen(o[a])){var n=this.drilldown.getDisplayRowIndex(o[a]);this._toggle(n)}t=this.drilldown.getDisplayRowIndex(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeKeepFilter=function(){try{var t=this._dataList.getFilterList();if(t.length<=0||isNaN(t.length))return;this._oldFilterArrStr=JSON.stringify(t,(function(t,e){return"function"==typeof e||e&&"object"==typeof e&&e.constructor===RegExp?e.toString():e})),this.customFilterStatusObj&&(this._oldStatusObj=JSON.stringify(this.customFilterStatusObj)),this.customFilterList&&this.customFilterList.customFilterListFilterInfo?this._oldFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})):this.groupbyStatus.grouped&&this.groupbyStatus.filter&&(this._oldFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})))}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyAfterKeepFilter=function(){try{if(!this._oldFilterArrStr)return;this._refreshCustomFilterHistory(this._oldFilterArrStr,this._oldFilterInfo,this._oldStatusObj),this._oldFilterArrStr=null,this._oldFilterInfo=null,this._oldStatusObj=null,this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyAfterRemovedRow=function(t,e,i,o){try{function _(t,e,i){if(!(e>t.length)){var o=Math.min(i,t.length-e),s=[];for(var r in t)if(!isNaN(r)){var a=Number(r);a>=e&&a<e+o?delete t[r]:a>=e+o&&s.push(a)}s.sort((function(t,e){return t-e}));for(var n=0;n<s.length;n++){var l=s[n];t[l-o]=t[l],delete t[l]}t.length-=o}}this.removed=!0,this.isDrillDown&&this.drilldown.statusArr.splice(i,1);var r=this.getTotalCol(),n=r*i;_(this.cellStyleArr,n,r),_(this.cellClassArr,n,r),_(this.cellReadOnlyArr,n,r),_(this.cellDisabledArr,n,r),_(this._cellSelectedIndex,n,r);for(var l=this.getColumnCount(),h=0;h<l;h++){var d=this.getCellInfo(h);if("custom"==d.options.inputType){var p=this.getDataLength(),u=d.cellManagerHashByRowIndex[i];if(u){var c,g=d.cellManagerIDByRowIndex[i];if(c=u.options.embeddedInput?this.id+"_"+g:d.mainGridId+g,this._removeDom(c),d.isValidTypeGetter&&(delete d.cellManagerHashByID[g],delete d.cellManagerHashByRowIndex[i],delete d.cellManagerIDByRowIndex[i],i<p)){for(var f=i;f<p;f++)d.cellManagerHashByRowIndex[f]=d.cellManagerHashByRowIndex[f+1],d.cellManagerIDByRowIndex[f]=d.cellManagerIDByRowIndex[f+1];delete d.cellManagerHashByRowIndex[p],delete d.cellManagerIDByRowIndex[p]}}d.isValidTypeGetter||(d.cellManagerInfoByRowIndex.splice(i,1),d.cellManagerHashByRowIndex.splice(i,1),d.cellManagerIDByRowIndex.splice(i,1))}}if(this.itemValueObj)for(var m in this.itemValueObj){var y=o.split(",")[this._dataList.bodyIdColIndexMap[m]];for(var b in this.itemValueObj[m])-1!=b.indexOf("auto")&&this.itemValueObj[m][b]===y&&(this.itemValueObj[m][b]="")}if(!0!==e){var v=this.checkScrollEnd,w=this.scrollEvent;if(this.checkScrollEnd=!1,this.scrollEvent=!1,this._getFocusedRowIndex()==this.getDataLength()){var C=this._getFocusedRowIndex(),I=this.getFocusedColumnIndex();this.removeRowFocus(this.getDataLength()),this._setFocusedCell(C-1,I)}this.resetExpressionFunc(),this.hasFooter&&(this.footerTempSum=[]),this._mergeNotifyRowChanged("removeRow",t),this.notifyRowChanged(t),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.notifyStatusChanged({rowindex:[t]}),a.Z.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e,this._autoFitRefreshNative()}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[v,w]})}}catch(x){s.Y.printStackTrace(x,null,this)}},l.prototype.notifyRemovedRows=function(t,e){try{if(!0!==e){var i=this.checkScrollEnd,o=this.scrollEvent;this.checkScrollEnd=!1,this.scrollEvent=!1,this.resetExpressionFunc()
;for(var r=t.split(","),n=0;n<r.length;n++)this._mergeNotifyRowChanged("removeRow",r[n]);this.notifyRowChanged(),a.Z.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[i,o]}),this._autoFitRefreshNative()}}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyRemovedAll=function(t){try{this.removed=!0;var e=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this.clearCellVisible({skipDraw:!0}),this.loadFlag=!0,this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.cellReadOnlyArr=[],this.cellDisabledArr=[],this.extraData={grid:{},row:[],col:[],cell:[]},this._removeAllTDCellClass(),this._cellSelectedIndex=[],this.resetExpressionFunc();for(var i=this.getTotalCol(),o=0;o<i;o++){var r=this.getCellInfo(o);if(r&&r.options&&"expression"==r.options.inputType)for(var a=this.drawedRowLength,n=0;n<a;n++)r.options.expressionFunc&&r.options.expressionFunc[n]&&(r.options.expressionFunc[n]={});else if("custom"==r.options.inputType){for(var l=0;l<r.cellManagerIDByRowIndex.length;l++){var h,d=r.cellManagerHashByRowIndex[l],p=r.cellManagerIDByRowIndex[l];h=d.options.embeddedInput?this.id+"_"+p:r.mainGridId+p,this._removeDom(h)}r.isValidTypeGetter?(r.cellManagerHashByID={},r.cellManagerHashByRowIndex={},r.cellManagerIDByRowIndex={}):(r.cellManagerInfoByRowIndex=[],r.cellManagerHashByRowIndex=[],r.cellManagerIDByRowIndex=[])}}this.removeFocusedCell();for(o=0;o<this.dataRowList.length;o++){var u=this.dataRowList[o];u.style.display="none",this.__addClass(u,"w2grid_hidedRow"),this.__hasClass(u,"w2grid_lastRow")&&this.__removeClass(u,"w2grid_lastRow")}this.lastDisplayedRow=-1,this.subtotalHidden(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.maxRowLength=0,this.displayNoResultMessage(),this.drawFooter();var c={sortIcon:this.options.hideSortIconOnNoData};this.drawHeader(void 0,c),this._setCheckboxHead(),0==this.getDataLength()&&(this.removeFocusedCell(),"all"===this.options.visibleRowNum&&this.setSize(null,this.defaultDataLayerHeight)),this.setScrollYHeight(),this.displayFixedColumnLine(),this.options.ref&&1!=this.removeRowByInstance&&WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],gridNoRefresh:!0,scopeId:this.scope_id}),this.options.groupbyFilterBox&&!1!==t&&this.clearFilterHistory(),1==this.isDrillDown&&this.initDrilldown(),this.itemValueObj={},this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyRemovedRange=function(t){try{this.removed=!0,this.notifyRowChanged(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyCreatedRowStatus=function(t){try{function e(t,e,i){var o=i,s=[],r=t.length;for(var a in t)if(!isNaN(a)){var n=Number(a);n>=e&&s.push(n)}s.sort((function(t,e){return e-t}));for(var l=0;l<s.length;l++){var h=s[l];t[h+o]=t[h],delete t[h]}t.length=r+o}e(this.rowStyleArr,t,1),e(this.rowReadOnlyArr,t,1),e(this.rowDisabledArr,t,1),e(this.rowStyleFixedArr,t,1),e(this.rowStyleDataArr,t,1)}catch(i){s.Y.printStackTrace(i)}},l.prototype.notifyRemovedRowStatus=function(t){try{function e(t,e,i){if(!(e>t.length)){var o=Math.min(i,t.length-e),s=[];for(var r in t)if(!isNaN(r)){var a=Number(r);a>=e&&a<e+o?delete t[r]:a>=e+o&&s.push(a)}s.sort((function(t,e){return t-e}));for(var n=0;n<s.length;n++){var l=s[n];t[l-o]=t[l],delete t[l]}t.length-=o}}e(this.rowStyleArr,t,1),e(this.rowReadOnlyArr,t,1),e(this.rowDisabledArr,t,1),e(this.rowStyleFixedArr,t,1),e(this.rowStyleDataArr,t,1)}catch(i){s.Y.printStackTrace(i)}},l.prototype.notifyDeleteRow=function(t){try{if(this.getFocusedRowIndex()===t&&this.removeFocusedCell(),!0!==this.options.hideDeletedRow||this.groupbyStatus.grouped||this.isDrillDown){this._drawRowStatus(t-this.rowIndex,t)
;for(var e=0;e<this.oneRowDataLength;e++)this._drawCellStatus(t-this.rowIndex,t,e)}else this.setRowVisible(t,!1);this.displayNoResultMessage(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var i=0;i<this.getColCnt();i++){var o=this.getColumnID(i),r=this.expressionAssArr[o];if(null!=r)for(e=0;e<r.length;e++){var a=this.getColumnIndex(r[e]);this.drawCellData(t-this.rowIndex,t,a)}}}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyUndeleteRow=function(t){try{if(!0!==this.options.hideDeletedRow||this.groupbyStatus.grouped||this.isDrillDown){this._drawRowStatus(t-this.rowIndex,t);for(var e=0;e<this.oneRowDataLength;e++)this._drawCellStatus(t-this.rowIndex,t,e)}else this.setRowVisible(t,!0);this.displayNoResultMessage(),this.displayFixedColumnLine(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var i=0;i<this.getColCnt();i++){var o=this.getColumnID(i),r=this.expressionAssArr[o];if(null!=r)for(e=0;e<r.length;e++){var a=this.getColumnIndex(r[e]);this.drawCellData(t-this.rowIndex,t,a)}}}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyReformed=function(){try{if(this.options.rowStatusVisible)for(var t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)this._drawRowStatus(e,this.rowIndex+e);if(this.options.cellStatusVisible)for(t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)for(var i=0;i<this.oneRowDataLength;i++)this._drawCellStatus(e,this.rowIndex+e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyModifyAllStatus=function(t){try{for(var e=0;e<this.getDataLength();e++)this._drawRowStatus(e-this.rowIndex,e);this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:"all"})}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyModifyRangeStatus=function(t,e,i){try{var o=this.getDataLength();if(0<=t&&e<=o)for(var r=t;r<=e;r++)this._drawRowStatus(r-this.rowIndex,r);this.displayNoResultMessage(),this.notifyStatusChanged({startIndex:t,endIndex:e})}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyModifyRowStatus=function(t,e){try{t>-1&&t<this.getDataLength()&&(this._drawRowStatus(t-this.rowIndex,t),this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:[t]}))}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifyModifyMatchedStatus=function(t,e,i){try{for(var o=[],r=this.getDataLength(),a=0;a<r;a++){var n=this.getColumnID(t),l=this.dataList.getRealRowIndex(a);if(this.dataList._getCellData(l,n)+""==e+"")i!=this.dataList._setRowStatus(l,i)&&o.push(a),this._drawRowStatus(a-this.rowIndex,a),this.displayNoResultMessage()}this.notifyStatusChanged({rowIndex:o})}catch(t){s.Y.printStackTrace(t)}},l.prototype.notifySetColumnDefaultValue=function(t,e){try{this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySettedData=function(t){try{this.groupbyStatus.grouped&&this.clearGroupby(),this.loadCheck=[],t||this.options.focusOnSetData||this.removeFocusedCell()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySetRowXML=function(t,e){e?this.notifyRowChanged(t):this.notifyRowInserted(t)},l.prototype.notifyRowMoveUp=function(t){try{var e=this.extraData.row[t-1];this.extraData.row[t-1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t-1],this.extraData.cell[t-1]=this.extraData.cell[t],this.extraData.cell[t]=e,this._getFocusedRowIndex()==t&&this._setFocusedCell(t-1,this.getFocusedColumnIndex()),this.notifyRowChanged(t-1)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyRowMoveDown=function(t){try{var e=this.extraData.row[t+1];this.extraData.row[t+1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t+1],this.extraData.cell[t+1]=this.extraData.cell[t],
this.extraData.cell[t]=e,this._getFocusedRowIndex()==t&&this._setFocusedCell(t+1,this.getFocusedColumnIndex()),this.notifyRowChanged(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyRowModified=function(t){try{this.changeCount++,this.drawRowData(t-this.rowIndex,t),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyStatusChanged=function(t){try{var e,i,o=!1;"object"==typeof t.rowIndex?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getDataLength()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var r=e;r<i;r++){var a;if(a=o?t.rowIndex[r]:r,null!=this.rowStatusColIDArr)for(var n=0;n<this.rowStatusColIDArr.length;n++){var l=this.getColumnIndex(this.rowStatusColIDArr[n]);this.drawCellData(a-this.rowIndex,a,l)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySaveFocusedCell=function(){try{this.focusedCellInfo.beforeFocusedCell=!(0==this.focusedCell.length),this.focusedCellInfo.beforeFocusedCell&&(this.focusedCellInfo.beforeFocusedCellRealRowIndex=this.dataList.getRealRowIndex(this.focusedCell[0].focusedRowIndex),this.focusedCellInfo.beforeFocusedCellRealColumnIndex=this.focusedCell[0].focusedColIndex)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySetFocusedCell=function(t){try{var e=this.options.filterFocusMode,i=this.focusedCellInfo.beforeFocusedCellRealRowIndex;if("outfocus"!==e&&"infocus"!==e){if(this.focusedCellInfo.beforeFocusedCell)for(var o=0;o<this.getDataLength();o++)if(this.dataList.getRealRowIndex(o)==i){this._setFocusedCell(o,this.focusedCellInfo.beforeFocusedCellRealColumnIndex,!1,{isSort:t});break}}else"outfocus"==e&&this.outFocusedCell();this.focusedCellInfo={}}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySettedFilter=function(t){try{var e=t&&t.isSort,i=t&&t.fiteredColID;if(this.notifySetFocusedCell({isSort:e}),e&&this.syncWithSortStatus(),this.groupbyStatus.grouped)for(var o in this.customFilterStatusObj)if(this.customFilterStatusObj[o]){this.rowNumArr=[];for(var r=0;r<this.getDataLength();r++)this.rowNumArr.push(r);break}1==this.isDrillDown&&this._linkedDataList&&(this.setCellInfo(),this.initDrilldown());var a=!t||!1!==t.keepTop,n=[];if(this.hiddenRowObj.init){for(var l in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[l]&&n.push(l);this.clearRowVisible({noDraw:!0})}if(this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:a}),0==this.getDataLength()&&this.removeFocusedCell(),!0!==(a&&!0===this._isHybridScroll())&&this.setScrollYHeight(),e&&!this.groupbyStatus.grouped&&this.drawHeaderSortImages(),i&&!e&&this.options.useFilterList){var h=this.bodyToHeaderRelation[i];if(h){var d=this.getElementById(this.id+"_"+h+"_filter");d&&WebSquare.style.addClass(d,"w2grid_customFilter_filter")}}for(r=0;r<n.length;r++)this.setRowVisible(n[r]);this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifySettedFilterByUser=function(t){try{if(this.options.useFilterListSync){var e=t.colID,i=JSON.parse(t.oldFilteredRowIndexArr),o=JSON.parse(t.newFilteredRowIndexArr);if(this.groupbyStatus.grouped);else if(this.options.useFilterList){this.customFilterList||this.createCustomFilterList(null,!0),this.customFilterList.filterHistory.column[0]!==e&&(this.customFilterList.filterHistory.column.unshift(e),this.customFilterList.filterHistory.filteredRowIndexArr.unshift(i));var r=this.dataList.getColData(e,o),a=this.getUniqueValueOfArray(r),n=this.changeItemValue("label",e,a);this.customFilterList.customFilterListFilterInfo||(this.customFilterList.customFilterListFilterInfo={}),this.customFilterList.customFilterListFilterInfo[e]=[]
;for(var l=0;l<n.length;l++){var h=n[l],d=this;"string"==typeof h&&(h=h.replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return d.replacechar(t)}))),this.customFilterList.customFilterListFilterInfo[e].push(h)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeClearSort=function(){try{this.notifySaveFocusedCell(),this.clearHeaderSort()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyClearSortFilter=function(){try{var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex();this.syncWithSortStatus(),this.rowNumArr=null,this.applyFocusedCellOut(),this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),"infocus"==this.options.filterFocusMode&&this._setFocusedCell(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeSettedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyAfterSettedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeRemovedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyAfterRemovedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyRemovedFilter=function(t){try{!0===t&&this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null,!0!==this._isHybridScroll()&&this.setScrollYHeight(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyClearFilter=function(t){try{this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),t||(this.adjustDraw_keepTop=!0,this.notifyDataChanged({keepTop:!0}),this.adjustDraw_keepTop=null),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null;var e={};for(var i in!0===t&&!0===this._isHybridScroll()&&(e.skipResize=!0),this.setScrollYHeight(e),this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.itemValueObj={},this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterList.customFilterListFilterInfo={}),this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyMultisort=function(){try{this.syncWithSortStatus(),this.drawHeaderSortImages()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyBeforeInitDataList=function(){try{this.removeAllFinish=!0}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyAfterInitDataList=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj(),1==this.isDrillDown&&this.initDrilldown(),this.removeAllFinish=!1,this.initColumns(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.notifyRefresh=function(t){try{!this.startedDisplayNone&&this.rowIndex>=0&&(t&&this.setDataTable(),this._mergeRefresh(),this.drawData(this.rowIndex,0),t&&this.setScrollYHeight(),this.displayNoResultMessage(),this.displayFixedColumnLine())}catch(t){s.Y.printStackTrace(t,null,this)}},
l.prototype.notifyBroadcast=function(t){try{t=t||{},this.isDrillDown&&!0!==t.skipInitDrilldown&&this.initDrilldown(),this.notifyDataChanged(t)}catch(t){s.Y.printStackTrace(t,null,this)}};var h,d=i(9107),p=i(2327),u=i(8713),c=function(){};c.prototype.toHTML=function(){try{var t=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/mainZIndex/@value")||"10",e=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/xScrollZIndex/@value")||"20",i=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/yScrollZIndex/@value")||"15";if(this.uncompleted)return;var o=[],a="scroll"===this.options.overflowY,n=(this._isHybridScroll(),"overflow:hidden"),l=!0===this.options.scrollXNative?"display:none;":"",h=!0===this._isNativeScroll()?"visibility:hidden;":"",d=this.options.title?" title='"+this.options.title.wq_replaceAll("'","&#39;")+"'":"",p=this.options.moreButtonTitle?this.options.moreButtonTitle.wq_replaceAll("'","&#39;"):WebSquare.language.getMessage("Grid_more_Button")||"more",u=p?" title='"+p+"'":"",c="none"==this.options.focusMode||"linear"==this.options.focusFlow?"":" tabIndex='0'",g=this.options.scrollFocus?" tabIndex='0'":"",f=""==this.options.style?"style='"+n+";'":"style='"+this.options.style+";"+n+";'",m=this.options.readOnly?" w2grid_readonly_outer":"",y=function(t){return this._useRole()?" role='"+t+"' ":""};if(o.push("<div id='"+this.id+"' class='w2grid "+this.options.className+m+"' "+f+d+c+">"),this.options.senseReader&&this.options.useStartEndDiv){var b=WebSquare.language.getMessage("Grid_dom_start")||"Grid start";o.push("<div id='"+this.id+"_gridstart_div' class='w2grid_start_div' tabindex='0'>"+b+"</div>")}if(this.options.groupbyZone&&this.options.groupbyFilterBox&&"top"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='top:0px;left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete" />'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+y.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),this.options.groupbyZone){var v="<div id='"+this.id+"_groupbyZone_div' class='w2grid_groupbyZone' style='width:0px; height:0px;'>",w="";this.options.groupbyZoneSearch&&(w="<div id='"+this.id+"_groupbyZone_search' class='w2grid_groupbyZone_search'></div>"),o.push(v+w+"</div>")}if(o.push("<div id='"+this.id+"_main_div' class='w2grid_main' style='z-index:"+t+";"+n+";position:absolute;left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px; top:0px; bottom:"+this.scrollLayerWidthSize+"px;float:left;'>"),o.push(this.mainDataGridLayout()),this.options.useMoreButton&&o.push("<button id='"+this.id+"_grid_more_button' class='w2_grid_more_button'"+u+"></button>"),o.push("</div>"),this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px; bottom:0px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main' >"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete"/>'),
o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+y.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),o.push("<div id='"+this.id+"_scrollX_div' class='w2grid_scrollX' style='z-index:"+e+";overflow-x:hidden;overflow-y:hidden;position:absolute; height:0px; left:0px; right:"+(a?this.scrollWidthSize:"0")+"px; bottom:0px;"+l+"'>"),o.push(this.getScrollX()),o.push("</div>"),o.push("<div id='"+this.id+"_scrollY_div' class='w2grid_scrollY' style='z-index:"+i+";position:absolute; overflow-x:hidden;overflow-y:scroll;width:"+(a||!0===this._isNativeScroll()?this.scrollLayerWidthSize:"0")+"px; height: 100%;right:0px;"+h+"'"+g+">"),o.push(this.getScrollY()),o.push("</div>"),o.push("<div id='"+this.id+"_iScrollX' class='w2grid_iScrollX' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_iScrollY' class='w2grid_iScrollY' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_resize_line' class='w2grid_resize_line' style='display:none;position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px;'></div>"),this.options.useNoResultMessageURL?o.push("<div id='"+this.id+"_noresult' style='display:none;' class='w2grid_noresult'></div>"):o.push("<div id='"+this.id+"_noresult' style='display:none;position:absolute;"+this.options.noResultMessageStyle+"' class='"+this.options.noResultMessageClass+"'>"+this.options.noResultMessage+"</div>"),this.options.senseReader&&this.options.useStartEndDiv||1==this.options.moveKeyEditModeAll){var C=WebSquare.language.getMessage("Grid_dom_end")||"Grid end";o.push("<div id='"+this.id+"_gridend_div' class='w2grid_end_div' tabindex='0'>"+C+"</div>")}return o.push("</div>"),o.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getScrollY=function(){try{return"<div id='"+this.id+"_size_y' style='height:0px; position:absolute; top:0px; left:0px; width:18px;'></div>"}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getScrollX=function(){try{for(var t=this.getFixedColumnLastIndex(),e=0,i=0;i<t;i++)this.hiddenList[i]||(e+=this.colWidthList[i]);var o=this.getFixedRightColumnLastIndex(),r=0;for(i=this.colWidthList.length-1;i>=o;i--)this.hiddenList[i]||(r+=this.colWidthList[i]);var a=this.options.scrollFocus?" tabIndex='0'":" tabIndex='-1'",n=[],l=this.options.fixedColumnScrollHidden?"hidden":"scroll";return n.push("<table id='"+this.id+"_scrollX_table' style='height:18px;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:100%'>"),n.push("<tr>"),n.push("<td id='"+this.id+"_scrollX_left' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+e+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:"+l+";overflow-y:hidden'></div>"),n.push("</td>"),n.push("<td style='border:0px solid orange;padding:0px 0px 0px 0px;height:18px;'>"),n.push("<div id='"+this.id+"_scrollX_right' style='height:18px;border:0px solid blue; overflow-x:scroll;overflow-y:hidden;padding:0px 0px 0px 0px;'"+a+">"),n.push("<div id='"+this.id+"_scroll_size' style='height:1px;width:"+parseInt(this.gridWidth-e-r)+"px'></div>"),n.push("</div>"),n.push("</td>"),n.push("<td id='"+this.id+"_scrollX_fixedRight' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+r+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:scroll;overflow-y:hidden'></div>"),n.push("</td>"),n.push("</tr>"),n.push("</table>"),n.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.mainDataGridLayout=function(){try{this.setTableStruct();var t=[];return t.push(this.getBodyTable()),t.push(this.getFooterTable()),this.setInitialCSS(),t.join("")}catch(t){
s.Y.printStackTrace(t,null,this)}},c.prototype.setColArr=function(){try{this.colGroupArr=[],this.setColWidth(),this.gridWidth=0;var t,e,i=-1;if(this.options.rowStatusVisible){var o=40;this.options.rowStatusWidth.length>0&&(this.options.rowStatusWidth.indexOf("*")>-1?(o=this.options.rowStatusWidth,i++):this.options.rowStatusWidth-0>-1&&(o=this.options.rowStatusWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(this.options.rowNumVisible){o=40;this.options.rowNumWidth.length>0&&(this.options.rowNumWidth.indexOf("*")>-1?(o=this.options.rowNumWidth,i++):this.options.rowNumWidth-0>-1&&(o=this.options.rowNumWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(i>-1){this.autofitColumn=!0;for(var r=0;r<2;r++)this.colWidthList[r]&&"string"==typeof this.colWidthList[r]&&this.colWidthList[r].indexOf("*")>-1&&(this.autofitColumnIndexArr.push(r),this.autofitColumnWidthArr[r]=this.colWidthList[r])}if(this.isIE6or7){t=[],e=this.colIndexes.bodyColInfo.colSpanArr;var a=this.colIndexes.bodyColInfo.colIndexArr.length;for(r=0;r<a;r++)if(e[r])for(var n=0;n<e[r];n++)t[n]=!0}this.colGroupArr.push("<colgroup>");for(r=0;r<this.colWidthList.length;r++){null==this.colWidthList[r]&&(this.colWidthList[r]=70);var l=isNaN(this.colWidthList[r])?0:this.colWidthList[r];this.hiddenList[r]?l=0:(this.gridWidth+=l,this.isIE6or7&&(r<this.defaultColCnt||!t[r])&&(l--,r==this.defaultColCnt&&l--)),this.colGroupArr.push("<col id='colGroupID_"+r+"' style='width:"+l+"px;white-space:nowrap' />")}this.colGroupArr.push("</colgroup>")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setCss=function(){try{if(this.options.headerTableClass=this.struct.head.attr.class||"gridHeaderTableDefault",this.options.headerTrClass=this.struct.head.attr.rowClass||"gridHeaderTRDefault",this.options.headerTdClass=this.struct.head.attr.columnClass||"gridHeaderTDDefault",this.options.bodyTableClass=this.struct.body.attr.class||"gridBodyTableDefault",this.options.bodyTrClass=this.struct.body.attr.rowClass||"gridBodyTRDefault",this.options.bodyTdClass=this.struct.body.attr.columnClass||"gridBodyDefault",a.Z.isIEAllVersion()&&!0===this._isNativeScroll()?this.options.gridNativeClass="gridNativeIE":this.options.gridNativeClass="gridNative",this.options.gridHybridClass="gridHybrid",this.hasFooter&&(this.options.footerTableClass=this.struct.foot.attr.class||"gridFooterTableDefault",this.options.footerTrClass=this.struct.foot.attr.rowClass||"gridFooterTRDefault",this.options.footerTdClass=this.struct.foot.attr.columnClass||"gridFooterTDDefault"),this.hasSubtotal){this.options.subtotalTrClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.rowClass||"gridSubtotalTRDefault",this.options.subtotalTdClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.columnClass||"gridSubtotalDefault";for(var t=0;t<this.struct.subtotalArr.length;t++)if(this.struct.subtotalArr[t].attr.subtotalClass){this.subtotalClassList=[];break}if(this.subtotalClassList)for(t=0;t<this.struct.subtotalArr.length;t++){var e=this.struct.subtotalArr[t].attr.subtotalClass||"gridSubtotalDefault";this.subtotalClassList.push(e)}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setInitialCSS=function(){try{this.options.oddEvenColorDisplay&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" .evenTd","background-color:"+this.options.evenRowBackgroundColor),WebSquare.cssStyleSheet.addRule("#"+this.id+" .oddTd","background-color:"+this.options.oddRowBackgroundColor)),this.rowStyleIndex=0,this.cellStyleIndex=0,this.readOnlyTdStyle="",this.readOnlyTdImg="",this.disabledTdStyle="",this.rowOverStyle="",""!=this.options.readOnlyBackgroundColor&&(this.readOnlyTdStyle="background-color:"+this.options.readOnlyBackgroundColor),
""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(this.options.readOnlyBackgroundImgCSS?this.readOnlyTdImg=this.options.readOnlyBackgroundImgCSS:this.readOnlyTdImg="background:url("+this.options.readOnlyBackgroundImg+") no-repeat center center; background-size: cover"),""!=this.options.disabledBackgroundColor&&(this.disabledTdStyle="background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(this.disabledTdStyle=""!=this.disabledTdStyle?this.disabledTdStyle+";":"",this.disabledTdStyle+="color:"+this.options.disabledFontColor),""!=this.options.rowNumBackgroundColor&&WebSquare.cssStyleSheet.addRule("#"+this.id+" ."+this.options.bodyTdClass+"_rowNumber","background-color:"+this.options.rowNumBackgroundColor),this.options.rowMouseOver&&(this.rowOverStyle="background-color:"+this.options.rowMouseOverColor),-1!=this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultHeaderCellHeight+"px"),-1!=this.options.defaultCellHeight&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" td."+this.options.bodyTdClass,"height:"+this.options.defaultCellHeight+"px"),-1==this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultCellHeight+"px"))}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getGridClassName=function(t,e){try{return null==t||""==t?e:t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.grid2TableXml=function(t){try{var e=WebSquare.Elem.api.getElementsByTagName(this.element,t,r.I._XML_NAMESPACE.W2);return e.length>0?this.oneGrid2TableXml(e[0]):null}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.xml2JSON=function(t){try{var e={attr:{},rowArr:[],rowAttrArr:[]};e.attr=WebSquare.Parser.parseAttribute(t);for(var i=WebSquare.Elem.api.getElementsByTagName(t,"row",r.I._XML_NAMESPACE.W2),o=0;o<i.length;o++){e.rowAttrArr[o]=WebSquare.Parser.parseAttribute(i[o]);for(var a=WebSquare.Elem.api.getElementsByTagName(i[o],"column",r.I._XML_NAMESPACE.W2),n=[],l=0;l<a.length;l++){var h=WebSquare.Parser.parseAttribute(a[l]);h["@xml"]=a[l],n.push(h)}e.rowArr.push(n)}return e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.oneGrid2TableXml=function(t){try{var e=WebSquare.xml.serialize(t),i=e.indexOf("w2:header")>=0?"th":"td";return e=(e=(e=(e=(e=e.wq_replaceAll("w2:header",this.options.fixPrint?"tbody":"thead")).wq_replaceAll("w2:gBody","tbody")).wq_replaceAll("w2:footer","tbody")).wq_replaceAll("w2:row","tr")).wq_replaceAll("w2:column",i),WebSquare.xml.parse(e)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setColWidth=function(){try{var t=this.getColCnt();this.colWidthList=[],this.autoFitColWidthList=null,this.hiddenList=[],this.hiddenAdaptiveList=[];for(var e=0;e<t;e++)this.colWidthList[e]=null,this.hiddenList[e]=!1,this.hiddenAdaptiveList[e]=!1;this.initializeTableInfo()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getColCnt=function(){try{for(var t=0,e=this.htmlInfo?this.htmlInfo.head.rowArr[0]:this.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.initializeTableInfo=function(){try{var t=this,e=function(e){if(null==e)return null;for(var i=[],o=[],s=[],r=[],a=[],n=e.rowArr,l=[],h=0;h<n.length;h++){for(var d=[],p=0;p<t.colWidthList.length;p++)d.push(!1);l.push(d)}var u=0;t.options.rowNumVisible&&(i.push(0),s.push(0),r.push(n.length),a.push([u++])),t.options.rowStatusVisible&&(i.push(!0===t.options.rowNumVisible?1:0),s.push(0),r.push(n.length),a.push([u++]));for(h=0;h<n.length;h++){var c=n[h],g=0;for(p=0;p<c.length;p++){for(var f=c[p],m=parseInt(f.colSpan||1),y=parseInt(f.rowSpan||1);void 0!==l[h][g]&&l[h][g];)g++;f.colIndex=g+t.defaultColCnt,i.push(g+t.defaultColCnt),s.push(h),r.push(y);var b=f.width||"";if(m>1){if("string"==typeof b&&b.indexOf("*")>-1){
t.autofitColumn=!0;for(var v=0;v<m;v++){var w=g+v;t.colWidthList[w]=b,t.autofitColumnWidthArr[w+t.defaultColCnt]=b,t.autofitColumnIndexArr.push(w+t.defaultColCnt)}}o[i.length-1]=m}if(1==m&&null==t.colWidthList[g])if("string"==typeof b&&b.indexOf("*")>-1){t.autofitColumn=!0;w=g;t.colWidthList[w]=b,t.autofitColumnIndexArr.push(w+t.defaultColCnt),t.autofitColumnWidthArr[w+t.defaultColCnt]=b}else t.colWidthList[g]=parseInt(b||0);for(var C=0;C<m;C++){a[g+t.defaultColCnt+C]||(a[g+t.defaultColCnt+C]=[]),a[g+t.defaultColCnt+C].push(u),l[h][g+C]=!0,"true"==f.hidden&&(t.hiddenList[g+C]=!0);for(var I=1;I<y;I++)l[h+I][g+C]=!0}u++,delete f.hidden}}return{colIndexArr:i,colSpanArr:o,trIndexArr:s,rowSpanArr:r,colIndexMatch:a}};if(this.colIndexes={headerColInfo:e(this.struct.head),bodyColInfo:e(this.struct.body),footerColInfo:e(this.struct.foot)},this.hasSubtotal){this.colIndexes.subtotalColInfo=[];for(var i=0;i<this.struct.subtotalArr.length;i++){var o=e(this.struct.subtotalArr[i]);this.colIndexes.subtotalColInfo.push(o),this.colIndexes.subtotalColInfo[this.struct.subtotalArr[i].attr.targetColumnID]=o}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getFooterTable=function(){try{if(!this.hasFooter)return"";this.hasFooter=!0;var t="";this.options.footerSummary?t=this.options.footerSummary?" summary='"+this.options.footerSummary.wq_replaceAll("'","&#39;")+"'":"":this.options.captionTitle&&this.options.footerSummaryAuto&&(t=" summary='"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"'"),"html5"==WebSquare.docType&&(t="");var e="";if(e="<table id='"+this.id+"_foot_table' class='"+this.options.footerTableClass+"' style='position:absolute; bottom:0px; table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px;'"+t+">",this.options.footerCaption?e+="<caption>"+this.options.footerCaption+"</caption>":this.options.captionTitle&&this.options.footerCaptionAuto&&(e+="<caption>"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"</caption>"),e+=this.getColGroup(this.id+"_col_footer"),a.Z.isSafari()||a.Z.isChrome()&&a.Z._getChromeVersion()<94)this._checkHeaderColSpan(this.htmlInfo.foot.rowArr)||(e+="<thead><tr></tr></thead>");else if(a.Z.isIE()){for(var i="",o=0;o<this.getColCnt();o++)i+="<td></td>";e+="<thead style='visibility:collapse;'><tr>"+i+"</tr></thead>"}e+=this.getTableHtml(this.htmlInfo.foot,"tbody","td",this.options.footerTdClass),e+="</table>";var r=a.Z.getDataPrefix("or_wd="),n=a.Z.getDataPrefix("dis="),l=a.Z.getDataPrefix("width=");return e=(e=e.wq_replaceAll(l,r)).wq_replaceAll("disabled=",n)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getBodyTable=function(){try{var t="width:"+this.gridWidth+"px;'";this.isIE6or7&&(t="'");var e="";this.options.summary&&"html5"!=WebSquare.docType&&(e=" summary = '"+(this.element.getAttribute("summary")||"").wq_replaceAll("'","&#39;")+"' ");var i="",o=!0===this._isNativeScroll()?"auto":"hidden",r=!0===this.options.scrollXNative?"auto":"hidden",n="";!0===this._isNativeScroll()?n=" "+this.options.gridNativeClass:!0===this._isHybridScroll()&&(n=" "+this.options.gridNativeClass+" "+this.options.gridHybridClass);var l=!0===this._isBrowserScroll()?"":" border-collapse:collapse";if(this.options.fixedColumnLineDiv?(i="<div id='"+this.id+"_fixedColumnDiv' style='display:none;' class='w2grid_fixedcolumn_line_div' tabindex='-1'></div>",i+="<div id='"+this.id+"_fixedRightColumnDiv' style='display:none;' class='w2grid_fixedrightcolumn_line_div' tabindex='-1'></div>",i+="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:"+r+";overflow-y:"+o+";'>"):i="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:"+r+";overflow-y:"+o+";'>",
i+=this.getGridHeaderFillerTable(this.headerXml,this.options.headerTdClass,this.options.headerTrClass,this.id+"_head_table",this.options.headerTableClass),i+="<table id='"+this.id+"_body_table' class='"+this.options.headerTableClass+n+"' style='position:absolute;left:0px;top:0px;table-layout:fixed;"+l+"; border-spacing:0px;"+t+e+">",this.captionXml){var h=WebSquare.xml.parse("<caption/>"),d=null,p=WebSquare.Parser.parseAttribute(this.captionXml);for(var u in p){if("id"==u){var c=p[u];c&&h.documentElement.setAttribute("id",this.id+"_"+c)}else h.documentElement.setAttribute(u,p[u]);"value"==u&&(d=p[u])}if(d)h.documentElement.appendChild(h.createTextNode(d)),h.documentElement.removeAttribute("value");else for(var g=this.captionXml.getChildNodes(),f=0;f<g.length;f++)if(3===g[f].getNodeType()){var m=h.createTextNode(g[f].getNodeValue());h.documentElement.appendChild(m)}i+=WebSquare.xml.noNameSpaceSerialize(h)}if(this.isWebKit){if(!this.captionXml){var y="transparent",b="0";try{for(f=0;f<document.styleSheets.length;f++){var v=document.styleSheets[f];try{v.cssRules}catch(t){continue}for(var w=0;v.cssRules&&w<v.cssRules.length;w++){var C=v.cssRules[w];if(C.selectorText=="."+this.options.headerTableClass){y=C.style["border-top-color"],b=parseInt(C.style["border-top-width"])/2,f=document.styleSheets.length;break}}}}catch(t){s.Y.printStackTrace(t,null,this)}i+="<caption style='height:"+b+"px;background-color:"+y+";'></caption>"}a.Z.isSafari()||a.Z.isChrome()&&a.Z._getChromeVersion()<94?(i+=this.getColGroup(this.id+"_col_body"),this._checkHeaderColSpan(this.htmlInfo.head.rowArr)||(i+="<thead><tr></tr></thead>")):i+=this.getColGroup(this.id+"_col_body")}else i+=this.getColGroup(this.id+"_col_body");i+=this.getTableHtml(this.htmlInfo.head,"thead","th",this.options.headerTdClass),n="",!0===this._isBrowserScroll()&&(n=" class='"+this.options.gridNativeClass+"'"),i+="<tbody id='"+this.id+"_body_tbody'"+n+"></tbody>",i+="</table>",i+="</div>";var I=a.Z.getDataPrefix("or_wd="),_=a.Z.getDataPrefix("width=");return i=i.wq_replaceAll(_,I)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._checkHeaderColSpan=function(t){try{var e=!0;if(1==t.length)for(var i=t[0],o=0;o<i.length;o++){if((parseInt(i[o].colspan)||parseInt(i[o].colSpan)||1)>1)return!1}else e=!1;return e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getTableInfo=function(t,e,i){try{var r=o.q.extend({},t.attr),a=[],n=t.rowAttrArr||[{}],l=t.rowArr;r.id=this.id+"_"+e+"_tbody",r.style="";for(var h=0;h<l.length;h++){a.push([]);for(var d=0;d<l[h].length;d++){var p=o.q.extend({},l[h][d]);if(p.class=e+" "+e+"_data",this.isIE6or7){var u=parseInt(p.colSpan||"1"),c=parseInt(p.colIndex);if(u>1){for(var g=1;g<u;g++)0!=this.hgap[i+"_"+c]&&(this.hgap[i+"_"+(c+g)]=!0);this.hgap[i+"_"+c]=!0}else this.hgap[i+"_"+c]=!1}var f=p.textAlign,m=p.style?p.style+";":"";m=m+"text-align:"+(f||"center"),p.style=m,a[h].push(p)}}return{attr:r,rowArr:a,rowAttrArr:n}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getBodyHtmlInfo=function(){try{var t=this.options.bodyTdClass,e=this.options.bodyTrClass,i=this.getTableInfo(this.struct.body,t,e),o=i.attr,a=i.rowArr,n=i.rowAttrArr;this.oneRowLength=a.length,this.oneRowDataLength=0,this.tdIdList=[],this.bodyIdColIndexMap={},this._bodyIdMultiRowIndexMap={},this.colMoveIndexMap={};for(var l=0,h={},d=0;d<a.length;d++){n[d].trIndex=d,this.oneRowDataLength+=a[d].length;for(var u=0;u<a[d].length;u++){var c=a[d][u],g=c.style.split(";");if(g.length>0)for(var f=0;f<g.length;f++)if(g[f].indexOf(":")>-1){try{var m=g[f].split(":")[0].wq_trim(),y=g[f].split(":")[1].wq_trim();this.options.useDefaultStyle?this.setDefaultStyle(l,m,y):"text-align"!==m||c.textAlign?this.setColumnStyle(l,m,y):this._setInitStyle(l,m,y)}catch(t){s.Y.printStackTrace(t,null,this)}if(!this.options.applyAllColumnStyle)break}var b=this.options.adaptiveStyle||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/adaptiveStyle/@value");if("none"==this.options.adaptiveStyle&&(b=""),
b=c.adaptiveStyle||b,"none"==c.adaptiveStyle&&(b=""),b){var v=b.split(";");if(v.length>0)for(var w=0;w<v.length;w++)if(v[w].indexOf(":")>-1)try{var C=v[w].split(":")[0].wq_trim(),I=v[w].split(":")[1].wq_trim();this.setAdaptiveColumnStyle(l,C,I)}catch(t){s.Y.printStackTrace(t,null,this)}}"textarea"==c.inputType&&"all"==c.displayType&&(c.style+=";word-break:break-all;white-space:normal;");var _=c.id;if(null==c.col_id?(c.col_id=_,c.id=this.id+"_"+_,c["@xml"]=c["@xml"].cloneNode(!0),c["@xml"].setAttribute("col_id",_),c["@xml"].setAttribute("id",this.id+"_"+_)):_=c.col_id,this._setCellInfo(_,c["@xml"]),this.bodyIdColIndexMap[_]=l,this._bodyIdMultiRowIndexMap[_]=d,0==d&&(this.colMoveIndexMap[_]=l),h[_]){var x=WebSquare.language.getMessage("E_comp_duplicated_Msg",_)||"id["+_+"] was used repeatedly. Check the source code.";$l(x)}else h[_]=_;this.tdIdList.push(_),""===_&&p.v.printLog("warning : The "+this.id+" column name for column index "+l+" is missing."),l++}}return{attr:o,rowArr:a,rowAttrArr:n}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getHeaderHtmlInfo=function(){try{var t=this.options.headerTdClass,e=this.options.headerTrClass,i=this.getTableInfo(this.struct.head,t,e),o=i.attr,r=i.rowArr,a=i.rowAttrArr,n=[];this.thIdList=[],this.colMoveHeaderIndexMap={},o.id=this.id+"_head_table",o.class=this.options.headerTableClass;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.head.attr.style);l&&2==l.length&&(this.headerHeight=parseInt(l[1])),o.style=this.options.hideHeader?"display:none":"",this.headCellInfoHash={};for(var h=0;h<r.length;h++){n.push([]);for(var d=0;d<r[h].length;d++){var p=r[h][d],u=null,c=p.inputType,g=p.dataType,f=p.value;if(void 0!==f&&null!=f||void 0!==(f=p.defaultValue)&&null!=f||(f=""),"checkbox"==c)u="<input type='checkbox' style='border:0px solid blue;background-color:transprent;' />";else if("select"==c){var m="";if(this.options.chooseOption){if(m=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(b=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(m=b)}else if(this.options.allOption){m=WebSquare.language.getMessage("Grid_all")||"-all-"}else if("json"!==p["@xml"]._elementType){var y=(WebSquare.xml.serialize(p["@xml"]).match(/label\s*>[^<]+<\//)||"").toString();""!==y&&(m=y.slice(y.toString().indexOf(">")+1,-2))}u="<div style='width:100%;height:20px;top:0px;left:0px;position:relative;background-color:#ffffff' class='w2selectbox "+this.options.headerTdClass+" "+this.options.headerTdClass+"_data'><span style='display:none'></span><table class='w2selectbox_table_main'><tr class='w2selectbox_row w2selectbox_row_main'><td class='w2selectbox_col_label'><div class='w2selectbox_label'>"+m+"</div></td><td class='w2selectbox_col_button'></td></tr></table></div>"}else if("text"==c&&"own"==g)u="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";else{var b;if(this.options.useLocale&&p.localeRef)(b=this.getLocaleValue(p.localeRef))&&(f=b);f=null!=f?f:"";var v="";"span"==this.options.dataTag&&(v="class='w2grid_span'"),u="<"+this.options.dataTag+" "+v+" style='padding-top:0px; padding-left:4px;padding-right:4px' >"+f+this.dataTagClose}n[h].push(u),this.thIdList.push(p.id),this.headCellInfoHash[p.id]=p["@xml"],this._setHeaderInfo(p.id,p["@xml"]),null==p.col_id&&(p.col_id=p.id)}}return{attr:o,rowArr:r,rowAttrArr:a,headerTdHtml:n}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getFooterHtmlInfo=function(){try{for(var t=this.options.footerTdClass,e=this.options.footerTrClass,i=this.getTableInfo(this.struct.foot,t,e),o=i.attr,r=i.rowArr,a=i.rowAttrArr,n=0;n<r.length;n++)a[n]["data-trindex"]=n;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.foot.attr.style);return l&&2==l.length&&(this.footerHeight=parseInt(l[1])),{attr:o,rowArr:r,rowAttrArr:a}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getSubtotalHtmlInfo=function(t){try{
var e=this.options.subtotalTdClass;this.subtotalClassList&&(e=t.attr.subtotalClass||"gridSubtotalDefault");for(var i=this.options.subtotalTrClass,o=this.getTableInfo(t,e,i),r=o.attr,a=o.rowArr,n=o.rowAttrArr,l=0;l<a.length;l++){n[l].trIndex=l,n[l].targetColumnID=r.targetColumnID;for(var h=0;h<a[l].length;h++)a[l][h].class=a[l][h].class+" "+this.id+"_subtotal__column"+h,delete a[l][h].hidden}return{attr:r,rowArr:a,rowAttrArr:n}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getTableHtml=function(t,e,i,r){try{var n=t.attr,l=t.rowArr,h=t.rowAttrArr,d=[],p="";if(!0===this._isBrowserScroll()){var u={};o.q.extend(u,n);var c=this.options.gridNativeClass;!0===this._isHybridScroll()&&"string"==typeof e&&"thead"===e.toLowerCase()&&(c=this.options.gridHybridClass),u.class?u.class+=" "+c:u.class=c,p=this.getAttributesString(u)}else p=this.getAttributesString(n);d.push("<"+e+p+">");var g="",f="";l.length>=2&&(g=!1===this.options.rowNumRowSpan?" rowSpan='1'":" rowSpan='"+l.length+"'",f=!1===this.options.rowStatusRowSpan?" rowSpan='1'":" rowSpan='"+l.length+"'");var m="";!0===this._isBrowserScroll()&&t===this.htmlInfo.head&&(m=" "+this.options.gridNativeClass);for(var y=a.Z.getDataPrefix("colIndex"),b=a.Z.getDataPrefix("value"),v=0;v<l.length;v++){t==this.htmlInfo.head?d.push("<tr"+this.getAttributesString(h[v])+" class='gridHeaderStyle_"+v+m+"'>"):t==this.htmlInfo.foot?d.push("<tr"+this.getAttributesString(h[v])+" class='gridFooterStyle_"+v+"'>"):d.push("<tr"+this.getAttributesString(h[v])+">");var w="",C="";t==this.htmlInfo.head&&(C=r+"_background ",w=this.options.rowNumHeaderValue),0==this.options.rowNumRowSpan&&this.options.rowNumVisible?v===l.length-1?d.push("<"+i+g+" class='"+r+" "+r+"_rowNumber "+C+"' "+b+"='"+w+"' "+y+"='0' id='_headerRowNumber'></"+i+">"):d.push("<"+i+g+" class='"+r+" "+r+"_rowNumber "+C+"' "+b+"='' "+y+"='0' id='_headerRowNumber'></"+i+">"):0===v&&this.options.rowNumVisible&&d.push("<"+i+g+" class='"+r+" "+r+"_rowNumber "+C+"' "+b+"='"+w+"' "+y+"='0' id='_headerRowNumber'></"+i+">");var I="";if(!1===this.options.rowStatusRowSpan){if(v===l.length-1)t==this.htmlInfo.head&&(I=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&d.push("<"+i+f+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='"+I+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">");else if(this.options.rowStatusVisible)if(this.options.rowStatusColSpan&&0==v){var _=1;l[v][0].colSpan?_+=Number(l[v][0].colSpan):_++;var x=" colSpan='"+_+"'",S=l[v][0].value;d.push("<"+i+f+x+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='"+S+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else d.push("<"+i+f+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else 0==v&&(t==this.htmlInfo.head&&(I=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&d.push("<"+i+f+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='"+I+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">"));for(var R=0;R<l[v].length;R++){if(r!==this.options.subtotalTdClass&&r!==this.options.footerTdClass||null==l[v][R].columnClass)if(this.subtotalClassList&&l[v][R].columnClass){for(var D=0;D<this.subtotalClassList.length;D++)if(this.subtotalClassList[D]&&r===this.subtotalClassList[D]){T=l[v][R].class;l[v][R].class=l[v][R].columnClass+" "+l[v][R].class,d.push("<"+i+this.getAttributesString(l[v][R])+">"),l[v][R].class=T;break}}else l[v][R].class=l[v][R].class+" "+C,d.push("<"+i+this.getAttributesString(l[v][R])+">");else{var T=l[v][R].class;l[v][R].class=l[v][R].columnClass+" "+l[v][R].class,d.push("<"+i+this.getAttributesString(l[v][R])+">"),l[v][R].class=T}t.headerTdHtml&&t.headerTdHtml[v][R]&&d.push(t.headerTdHtml[v][R]),d.push("</"+i+">")}d.push("</tr>")}return d.push("</"+e+">"),d.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getGridHeaderFillerTable=function(t,e,i,o,r){try{if(!this.options.headFiller)return""
;var a=[],n="";return this.options.hideHeader&&(n="display:none"),a.push("<table class='"+this.options.headerTableClass+"' style='z-index:-1;position:absolute;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px; '>"),a.push("<tbody id='"+this.id+"_"+e+"_tbody_tmp' style='"+n+"' class='"+r+"'>"),a.push("<tr class='"+i+"'>"),a.push("<td style='' id='"+this.id+"_header_bg_td' class='"+e+" "+e+"_rowNumber'>&nbsp;</td>"),a.push("</tr>"),a.push("</tbody>"),a.push("</table>"),a.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getColGroup=function(t){try{return this.colGroupArr.join("").wq_replaceAll("colGroupID",t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.initializeLayoutEvents=function(){try{if(!0!==this.options.scrollXNative&&this.event.addListener2(this.getElementById(this.id+"_scrollX_right"),"onscroll",this.handleScrollX,this),!0!==this._isBrowserScroll()&&(this.event.addListener2(this.render,"onmousewheel",this.handleWheel,this),this.event.addListener2(document.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollY,this)),!0===this._isHybridScroll())if(this.event.addListener2(document.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollYHybrid,this),a.Z.isMobile())this.event.addListener2(document.getElementById(this.id+"_main_div"),"ontouchstart",this.handleTouchStartHybrid,this),this.event.addListener2(document.getElementById(this.id+"_main_div"),"ontouchmove",this.handleTouchMoveHybrid,this);else{var t="onwheel"in window?"onwheel":"onmousewheel";this.event.addListener2(document.getElementById(this.id+"_main_div"),t,this.handleWheelHybrid,this)}this.options.groupbyZone&&(this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onclick",this.handleGroupbyZoneClick,this),this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onmousedown",this.handleChangeGroupDepth,this)),this.options.resize&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousemove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endColumnResize)),this.options.rowResize&&(this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousemove",this.event.bindAsEventListener(this,this.handleRowResize)),this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousedown",this.event.bindAsEventListener(this,this.doRowResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endRowResize))),a.Z.isIE()&&r.I.browserVersion()<=8&&this.event.addListener(this.render,"onmousemove",this.event.bindAsEventListener(this,(function(t){(this.resizeStarted||this.options.rowResize&&this.rowResizeStarted||null!=this.columnMoveTarget)&&d.f.preventDefault(t)})))),this.options.resize&&a.Z.isTouchDevice()&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchmove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchstart",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"ontouchend",this.event.bindAsEventListener(this,this.endColumnResize)))}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleScrollX=function(t){try{var e=d.f.getTarget(t);e&&(this._scrollXPrev||(this._scrollXPrev={}),this._scrollXPrev.scrollLeft===e.scrollLeft&&this._scrollXPrev.scrollTop===e.scrollTop&&this._scrollXPrev.scrollWidth===e.scrollWidth&&this._scrollXPrev.scrollHeight===e.scrollHeight&&(this.scrollXPreventEndEdit=!0),this._scrollXPrev.scrollLeft=e.scrollLeft,this._scrollXPrev.scrollTop=e.scrollTop,this._scrollXPrev.scrollWidth=e.scrollWidth,
this._scrollXPrev.scrollHeight=e.scrollHeight),r.I.clearTimer(this.id+"_completiveDrawData",!0),r.I.clearTimer(this.id+"_applyStyleOptions",!0),null==this.editedCell||this.scrollXPreventEndEdit||this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t]),this._handleScrollX(),this.scrollXPreventEndEdit&&this.editedCell&&this.editedCell.setPosition&&this.editedCell.setPosition(),this.scrollXPreventEndEdit=!1,d.f.fireEvent(this,"onscrollx",t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._handleScrollX=function(){try{this.body_table||(this.head_table=this.getElementById(this.id+"_head_table"),this.body_table=this.getElementById(this.id+"_body_table"),this.hasFooter&&(this.foot_table=this.getElementById(this.id+"_foot_table")),this.scrollX_right=this.getElementById(this.id+"_scrollX_right")),void 0!==this.colGroup&&null!=this.colGroup||(this.colGroup={},this.colGroup.bodyColList=this.body_table.getElementsByTagName("col"),this.hasFooter?this.colGroup.footerColList=this.foot_table.getElementsByTagName("col"):this.colGroup.footerColList=null);var t=0;if(this.options.scrollByColumn){var e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;e>1?t=1+Math.round(e):e<1&&(t=1+Math.round(1/e))}var i=this.getFixedColumnLastIndex(),o=this.scrollX_right.scrollLeft,r=this.gridWidth-o-t-this.fixedWidth-1-this.fixedWidthRight,n=r;r=r>0?r:0;var l=this.options.fixedRightColumn>0;if(!l){if(this.head_table.style.width=r+"px",this.isWebKit){for(var h=[],d=this.defaultColCnt;d<this.hiddenList.length;d++)1==this.hiddenList[d]&&h.push(d-this.defaultColCnt);(A=r-this.colGroup.bodyColList.length-h.length-1)<0&&(A=0),this.body_table.style.width=A+"px",this.hasFooter&&(this.foot_table.style.width=A+"px")}else this.body_table.style.width=r+"px",this.hasFooter&&(this.foot_table.style.width=r+"px");this.hasFooter&&(this.foot_table.style.width=r+"px")}var p=[],u=[],c=0,g=-1,f=0;if(l||this.options.scrollByColumn||a.Z.isIE(8)){var m=this._getScrollYWidth()-1;if(c=(f=this.resizeObj&&this.resizeObj.clientWidth?this.resizeObj.clientWidth:this.render.clientWidth)-1-this.fixedWidth-this.fixedWidthRight,a.Z.isChrome()&&(c+=1),-1!=m&&(c-=m),l){this.options.scrollByColumn=!1;var y=f-1-m;y<this.gridWidth&&(this.head_table.style.width=f-1-m+"px",this.body_table.style.width=f-1-m+"px",this.hasFooter&&(this.foot_table.style.width=f-1-m+"px"))}}var b=this.getFixedRightColumnLastIndex(),v=l,w=-1;for(d=this.colWidthList.length-1;d>=b;d--)this.hiddenList[d]||(this.colGroup.bodyColList[d].style.width=this.colWidthList[d]+"px");for(d=b-1;d>=0;d--){var C=0,I=parseInt(this.colWidthList[d],10)||0;if(this.hiddenList[d]&&(I=0),l&&v)if(r>c+I)r-=I,I=0;else{var _=I;y<this.gridWidth&&(I-=r-c),r-=_,v=!1,w=d}else r>I?r-=I:(r>0&&n<=c&&(g=d,this.options.scrollByColumn&&(C=r)),I=r,r=0),d<i&&!this.hiddenList[d]&&(I=parseInt(this.colWidthList[d],10)||0);var x=0,S=0;if(this.isIE6or7&&0!=I&&(1==this.hgap[this.options.headerTrClass+"_"+d]?0:1,x=1==this.hgap[this.options.bodyTrClass+"_"+d]?0:1,this.hasFooter&&(S=1==this.hgap[this.options.footerTrClass+"_"+d]?0:1)),a.Z.isIE(8)&&0==this.defaultColCnt&&0==d&&0==I&&(I=1,g>=0&&(p[g]=p[g]-1,this.colGroup.bodyColList[g].style.width=p[g]+"px",this.hasFooter&&(u[g]=u[g]-1,this.colGroup.footerColList[g].style.width=u[g]+"px"))),this.options.scrollByColumn){var R=this.colWidthList[d];1==I&&a.Z.isIE(8)&&0==this.defaultColCnt&&0==d&&(R=1),0==I&&(R=0),C>0&&(R=C),w===d&&(R=0),(0==R||1==R||R==this.colWidthList[d]||C>0||w===d)&&(this.colGroup.bodyColList[d].style.width=R-x+"px",p[d]=R-x,this.hasFooter&&(this.colGroup.footerColList[d].style.width=R-S+"px",u[d]=R-S))}else this.hiddenList[d]&&(I=0),this.colGroup.bodyColList[d].style.width=I-x+"px",p[d]=I-x,this.hasFooter&&(this.colGroup.footerColList[d].style.width=I-S+"px",u[d]=I-S)}m=this._getScrollYWidth("offsetWidth");if(this.isWebKit&&-1==this.options.className.indexOf("w2gridViewItemTable")&&0===m&&"allColumn"===this.options.autoFit&&!this.options.autoFitMinWidth){
var D=WebSquare.style.getSize(this.render,"outerwidth")-WebSquare.style.getSize(this.render,"width"),T=this.render.getBoundingClientRect().width-D,L=!0;this.head_table.getBoundingClientRect().width<=0&&(L=!1);for(d=b-1;d>=0;d--){var k=T-(L?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width),F=1;if(!(k>=0))break;if(!this.hiddenList[d]){if(k<2)break;var A=parseInt(this.colGroup.bodyColList[d].style.width);this.colGroup.bodyColList[d].style.width=A+F+"px",p[d]=A+F,(k=T-(L?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width))<1&&(F=-1,this.colGroup.bodyColList[d].style.width=A+F+"px",p[d]=A+F),this.hasFooter&&(this.colGroup.footerColList[d].style.width=A+F+"px",u[d]=A+F)}}}this.setColIndexInfo(p,u),this._setGridBorder(),(this.groupbyZoneStatus.groupbyZoneRender||this.options.useFilterList)&&(this.resizeGroupbyZone(),this.resizeGridList()),this.options.fixedColumnLineDiv&&a.Z.setTimeout(this.displayFixedColumnLine,{key:this.id+"_displayFixedColumnLine",caller:this,delay:10})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.redrawTable=function(){try{if(this.isWebKit)if(!0===this._isBrowserScroll()){var t=this.colGroup.bodyColList[0],e=t.offsetWidth,i=t.id;t.style.width=e+1+"px",a.Z.setTimeout((function(){document.getElementById(i).style.width=e+"px"}),{key:this.id+"_redrawTable",delay:20})}else{null==this._redrawTable_transform&&(this._redrawTable_transform=this.body_table.style.webkitTransform),this.body_table.style.webkitTransform="rotateZ(0deg)";var o=this.uuid;a.Z.setTimeout((function(){var t=WebSquare.idCache[o];t.body_table.style.webkitTransform=t._redrawTable_transform,delete t._redrawTable_transform}),{key:this.id+"_redrawTable",delay:20})}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setColIndexInfo=function(t,e){try{if(void 0===this.colGroup||null==this.colGroup){this.colGroup={},this.colGroup.bodyColList=this.getElementById(this.id+"_body_table").getElementsByTagName("col");var i=this.getElementById(this.id+"_foot_table");this.colGroup.footerColList=i?i.getElementsByTagName("col"):null}this.colIndexInfo={};var o=this.getVisibleColRange(this.colGroup.bodyColList,t),r=this.getVisibleTds(this.colIndexes.bodyColInfo,o);if(this.colIndexInfo.body={colInfo:this.colIndexes.bodyColInfo,visibleTds:r.visibleTds,invisibleTds:r.invisibleTds,visibilityArr:r.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.isIE6or7){var a=this.getVisibleTds(this.colIndexes.headerColInfo,o);if(this.colIndexInfo.header={colInfo:this.colIndexes.headerColInfo,visibleTds:a.visibleTds,invisibleTds:a.invisibleTds,visibilityArr:a.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.hasFooter){var n=this.getVisibleColRange(this.colGroup.footerColList,e),l=this.getVisibleTds(this.colIndexes.footerColInfo,n);this.colIndexInfo.footer={colInfo:this.colIndexes.footerColInfo,visibleTds:l.visibleTds,invisibleTds:l.invisibleTds,visibilityArr:l.visibilityArr,firstCoveredColIndex:n.firstCoveredColIndex}}if(this.hasSubtotal)for(var h in this.colIndexInfo.subtotal={},this.subtotalRowHash){var d=this.getVisibleTds(this.colIndexes.subtotalColInfo[h],o);this.colIndexInfo.subtotal[h]={colInfo:this.colIndexes.subtotalColInfo[h],visibleTds:d.visibleTds,invisibleTds:d.invisibleTds,visibilityArr:d.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex}}}this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.hideInvisibleTds=(h=!0,function(){try{if(h){if(h=!1,this.groupbyStatus.grouped){this.options.lazyDrawHiddenColumn=!1;var t=WebSquare.language.getMessage("Grid_warning6",this.id)||this.id+" The groupby is enabled and the lazyDrawHiddenColumn is disabled.";return void $l(t)}for(var e=this.defaultColCnt;e<this.colIndexes.bodyColInfo.rowSpanArr.length;e++)if(this.colIndexes.bodyColInfo.rowSpanArr[e]>=2){this.options.lazyDrawHiddenColumn=!1
;var i=WebSquare.language.getMessage("Grid_warning7",this.id)||this.id+" : rowSpan is enabled the lazyDrawHiddenColumn is disabled.";return void $l(i)}}var o=this.colIndexInfo.body.visibilityArr,r=[];for(e=0;e<this.drawedRowLength;e++)if("none"!=this.dataRowList[e].style.display)for(var a=0,n=0,l=this.defaultColCnt;l<o.length;l++){this.colIndexes.bodyColInfo.trIndexArr[l]>a&&(n=0,a++);var d=this._getColumnMoveIndex(l-this.defaultColCnt),p=this.data_td_list[d+e*this.oneRowDataLength],u=this.colIndexes.bodyColInfo.colSpanArr[l]||1;o[l]?(this.initVisibilityArr[l]||(this.drawCellData(e,e+this.rowIndex,d),this.applyCellStyleOptions(e+this.rowIndex,d),r[l]=!0),p.style.display="",u+n>1?(p.setAttribute("colSpan",u+n),p.setAttribute("data-lazydrawtd","true")):(p.removeAttribute("colSpan"),p.removeAttribute("data-lazydrawtd")),n=0):(p.style.display="none",n+=u)}for(e=0;e<r.length;e++)r[e]&&(this.initVisibilityArr[e]=!0)}catch(t){s.Y.printStackTrace(t,null,this)}}),c.prototype.getVisibleColRange=function(t,e){try{for(var i=this.render.clientWidth,o=[],r=0,a=-1,n=-1,l=e?e.length:t.length,h=0;h<l;h++){var d=e?e[h]:parseInt(t[h].style.width);if((r+=d)>i){a>=0?(d<3?o.push([a,h]):o.push([a,h+1]),n=h+1,a=-1):(o.push([h,h+1]),n=h+1);break}d<3?-1!=a&&(o.push([a,h]),a=-1):-1==a&&(a=h)}return-1!=a&&a<h&&o.push([a,h]),o.firstCoveredColIndex=-1!==n?n:l,-1==n&&(n=l),o}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getVisibleTds=function(t,e){try{for(var i=[],o=[],r=[],a=0;a<t.colIndexArr.length;a++){for(var n=t.colIndexArr[a],l=t.colSpanArr[a]||1,h=0;h<e.length;h++)if(e[h][0]<=n&&n<e[h][1]||e[h][0]<=n+l-1&&n+l-1<e[h][1]||n<=e[h][0]&&e[h][0]<n+l||n<=e[h][1]-1&&e[h][1]-1<n+l){i[i.length]=a,r[r.length]=!0;break}h==e.length&&(o[o.length]=a,r[r.length]=!1)}return{visibleTds:i,invisibleTds:o,visibilityArr:r}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setGridBorder=function(){try{var t=a.Z.getDataPrefix("colIndex");if(a.Z.isIE(8)){if(0==this.defaultColCnt){var e=this.colGroup.bodyColList[0].style.width,i="1px"==e||"0px"==e?"0px":"";if(!this.leftMostTds){this.leftMostTds=[];for(var o=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),r=this.hasFooter?this.getElementById(this.id+"_foot_table").getElementsByTagName("td"):[],n=0;n<o.length;n++)0==o[n].getAttribute(t)&&this.leftMostTds.push(o[n]);for(n=0;n<r.length;n++)0==r[n].getAttribute(t)&&this.leftMostTds.push(r[n])}for(n=0;n<this.leftMostTds.length;n++)this.leftMostTds[n].style.borderLeftWidth=i,this.leftMostTds[n].style.borderRightWidth=i;if(this.all_data_td_list.length>0){if(!this.leftMostIndexArr){this.leftMostIndexArr=[];for(n=0;n<this.oneRowDataLength;n++)0==this.all_data_td_list[n].getAttribute(t)&&this.leftMostIndexArr.push(n)}for(n=0;n<this.leftMostIndexArr.length;n++)for(var l=0;l<this.drawedRowLength;l++){(h=this.all_data_td_list[this.leftMostIndexArr[n]+l*this.oneRowDataLength]).style.borderLeftWidth=i,h.style.borderRightWidth=i}}if(this.hasSubtotal&&this.drawedSubtotal)for(n=0;n<this.drawedSubtotal.length;n++)for(l=0;l<this.drawedSubtotal[n].length;l++){var h;0==(h=this.drawedSubtotal[n][l].cells[0]).cellIndex&&(h.style.borderLeftWidth=i,h.style.borderRightWidth=i)}}if(!this._setGridBorderNoRefresh){var d=(u=this.getElementById(this.id+"_dataLayer")).style.display,p=document.activeElement;u.style.display="none",u.offsetHeight,u.style.display=d,document.activeElement!=p&&this.hasClass(p,this.options.bodyTdClass)&&p.focus()}}if(this.isIE6or7&&(this.colIndexInfo||this.setColIndexInfo(),this.colGroup&&(this._setBorderFolding(this.all_data_td_list,this.colIndexInfo.body,this.drawedRowLength),this.headerTds||(this.headerTds=this.getElementById(this.id+"_head_table").getElementsByTagName("th")),this._setBorderFolding(this.headerTds,this.colIndexInfo.header)),this.hasFooter&&(this.footerTds||(this.footerTds=this.getElementById(this.id+"_foot_table").getElementsByTagName("td")),this._setBorderFolding(this.footerTds,this.colIndexInfo.footer)),
this.hasSubtotal&&this._setSubtotalBorder(),!this._setGridBorderNoRefresh)){var u,c=(u=this.getElementById(this.id+"_dataLayer")).style.filter;p=document.activeElement;u.style.filter="alpha(opacity=99)",u.style.filter=c,document.activeElement!=p&&this.hasClass(p,this.options.bodyTdClass)&&p.focus()}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setBorderFolding=function(t,e,i){try{if(this.groupbyStatus.grouped)return;if(!t||0==i)return;i=i||1;for(var o=e.firstCoveredColIndex,r=this.oneRowDataLength+this.defaultColCnt,a=0,n=e.visibilityArr.length;a<n;a++){var l=e.colInfo.colIndexArr[a],h=e.visibilityArr[a],d="0px"===t[a].style.borderWidth;if(i>1&&(d=d||"0px"===t[a+r].style.borderWidth),l<o&&!h&&!d)for(var p=0;p<i;p++)t[a+p*r].style.borderWidth="0px";else if((l>=o||h)&&d)for(p=0;p<i;p++)t[a+p*r].style.borderWidth="",t[a+p*r].style.borderStyle=""}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setSubtotalBorder=function(){try{if(!this.drawedSubtotal)return;for(var t={},e=0;e<this.drawedSubtotal.length;e++){var i=this.drawedSubtotal[e];if(!t[i.targetID]){t[i.targetID]=!0;for(var o=this.colIndexInfo.subtotal[i.targetID],r=o.firstCoveredColIndex,a=0,n=0;n<i.length;n++)for(var l=i[n],h=0;h<l.cells.length;h++,a++){var d=o.colInfo.colIndexArr[a],p=o.visibilityArr[a],u="0px"===l.cells[h].style.borderWidth;if(d<r&&!p&&!u)for(var c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="0px");else if((d>=r||p)&&u)for(c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="")}}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleWheel=function(t){try{if(this.options.groupbyZone||this.options.useFilterList)for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone_scrollView")||e.match("w2grid_customFilter_scrollView"))return void d.f.stopPropagation(t);var i=d.f.getMouseWheelDelta(t),o=t.wheelDeltaY,r=t.wheelDeltaX,n=Math.floor(this.options.wheelRows*Math.abs(i));if("wheelDeltaX"in t&&Math.abs(r)>Math.abs(o))return this.getElementById(this.id+"_scrollX_right").scrollLeft-=r,void d.f.stopEvent(t);var l=this.getElementById(this.id+"_scrollY_div");if(this.scrollEvent=!0,i>0){if(0==l.scrollTop)return void(this.options.wheelStop&&d.f.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)-n)}else if(i<0){var h=this.getElementById(this.id+"_scrollY_div"),p=this._getEpsilon(),u=h.scrollHeight-h.clientHeight,c=Math.min(Math.round(h.scrollTop)+p,u);if(this.rowIndex<0||0==h.clientHeight||c==u)return void(this.options.wheelStop&&d.f.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)+n)}a.Z.isMobile()&&this.moveYScroll(0),this.hideTooltip(),d.f.stopEvent(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleWheelHybrid=function(t){try{if(!0!==this._useHybridScroll())return;d.f.preventDefault(t);var e=0;if("wheel"===t.type)e=t.deltaY;else e=-100*d.f.getMouseWheelDelta(t);this._setHybridWheelDeltaY(e)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleTouchStartHybrid=function(t){try{this._hybridMobileStartX=t.touches[0].clientX,this._hybridMobileStartY=t.touches[0].clientY}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleTouchMoveHybrid=function(t){try{if(!0!==this._useHybridScroll())return;var e=this._hybridMobileStartX-t.touches[0].clientX,i=this._hybridMobileStartY-t.touches[0].clientY;Math.abs(e)>Math.abs(i)?this._setHybridWheelDeltaX(e):this._setHybridWheelDeltaY(i),d.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleColumnResize=function(t){try{if(2==t.button)return;var e,i,o,r,n,l,h=a.Z.getDataPrefix("colIndex"),p=a.Z.getDataPrefix("header_id");if("drag"!==this.resizeStatus){for(var u=this.event.getTargetIterator(t,this.render),c=null;u.next();){var g=u.getElement()
;if("TH"!=g.tagName&&"TD"!=g.tagName||(c=g),"NOBR"==g.tagName||"SPAN"==g.tagName&&g.className.indexOf("w2grid_span")>-1){c=null;break}}if(null!=c){e=d.f.getMouseX(t),i=WebSquare.style.getAbsoluteLeft(c),o=parseInt(c.getAttribute("colSpan")||1,10),r=parseInt(c.getAttribute(h),0),n=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;var f=WebSquare.style.getComputedStyle(document.body,"zoom");1==n&&f&&(n=parseFloat(f)),e/=n,l=i;var m=r,y=c.getAttribute(p);"_headerRowNumber"!=y&&"_headerRowStatus"!=y&&(m=this._getRealColIndex("head",y)+this.defaultColCnt),m=this._getMouseColumnIndex({colIndex:r,offsetX:e,offsetLeft:l,colSpan:o}),"col-resize"===this.resizeStatus&&!1===this.isColumnResizable(m)&&(this.resizeStatus="init")}}switch(this.resizeStatus){case"init":this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="";break;case"col-resize":this.getElementById(this.id+"_head_table").style.cursor="col-resize",this.getElementById(this.id+"_head_table").cursor="col-resize";break;case"drag":return this.resizeStatus="drag",this.handleResizeLine(t),void(a.Z.isMobile()&&d.f.stopEvent(t))}if(null!=this.columnMoveTarget)return;if(null==c)return void(this.resizeStatus="init");if(e-l<(v=.3*this.colWidthList[r]>10?10:parseInt(.3*this.colWidthList[r],10))&&0!=r){if("init"===this.resizeStatus||"col-resize"===this.resizeStatus)return void(this.isColumnResizable(r)&&(this.resizeStatus="col-resize"))}else this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus;if(y&&"_headerRowNumber"!=y&&"_headerRowStatus"!=y)for(var b=0;b<o;b++){if(1==this.options.columnMove){c.getAttribute(p);r=this._getRealColIndex("head",y)+this.defaultColCnt}var v,w=parseInt(this.colGroup.bodyColList[r+b].style.width,10);if((l+=w)-(v=.3*w>10?10:parseInt(.3*w,10))<e&&e<l+v)return void("init"!==this.resizeStatus&&"col-resize"!==this.resizeStatus||this.isColumnResizable(r)&&(this.resizeStatus="col-resize"));this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.doColumnResize=function(t){try{if(2==t.button)return;if(a.Z.isMobile()&&this.handleColumnResize(t),!this.options.columnMove&&!this.options.groupbyZone&&"init"==this.resizeStatus||"drag"==this.resizeStatus)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_colIndex=null,this.resize_colId=null;e.next();)e.match(this.options.headerTdClass)&&(i=e.getElement());if(null==i)return;this.startResizeX=d.f.getScreenX(t);var o=a.Z.getDataPrefix("header_id"),r=a.Z.getDataPrefix("colindex"),n=a.Z.getDataPrefix("value"),l=i.getAttribute(o);if("col-resize"==this.resizeStatus){d.f.preventDefault(t),this.resizeStarted=!0,this.resizeStatus="drag";var h=d.f.getMouseX(t),p=WebSquare.style.getAbsoluteLeft(i),u=parseInt(i.getAttribute("colSpan")||1,10),c=this._getRealColIndex("head",l)+this.defaultColCnt;"_headerRowNumber"!=l&&"_headerRowStatus"!=l||(c=parseInt(i.getAttribute(r),10));var g=p;this.resizeColIndex=this._getMouseColumnIndex({colIndex:c,offsetX:h,offsetLeft:g,colSpan:u})}else if(this.options.columnMove&&(0===this.getHeaderRowIndex(l)||this.options.allColumnMove)){this.resizeStatus="drag";var f=null,m=this.htmlInfo.head.rowArr[0],y=!0;if(0!=parseInt(this.options.stopColumnMoveRow,10))for(var b=0;b<m.length;b++)if(m[b].id==l){y=!1;break}if(this.options.allColumnMove)for(b=1;b<this.htmlInfo.head.rowArr.length;b++)if(parseInt(this.options.stopColumnMoveRow,10)!=b)for(var v=0;v<this.htmlInfo.head.rowArr[b].length;v++)if(this.htmlInfo.head.rowArr[b][v].id==l){y=!1,f=l,l=this.htmlInfo.head.rowArr[0][v].id;break}if(y)return;this.resizeStauts="init","_headerRowNumber"!=l&&"_headerRowStatus"!=l&&(null!=f&&(this.realColumnMoveTarget=this.getHeaderIndex(f)),this.columnMoveTarget=this.getHeaderIndex(l),this.columnMoveTargetId=l,this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),a.Z.emptySelection())
}else if(this.options.groupbyZone&&(this.resizeStatus="drag","_headerRowNumber"!=l&&"_headerRowStatus"!=l)){if(this.groupbyZoneStatus.clickedHeaderInfo={},this.groupbyZoneStatus.clickedHeaderInfo.index=this._getRealHeaderColIndex(l),this.groupbyZoneStatus.clickedHeaderInfo.value=i.getAttribute(n),this.groupbyZoneStatus.clickedHeaderInfo.headerID=l,null==this.groupbyStatus.sortIndexArr||null==this.groupbyStatus.sortOrderArr||this.options.groupbyFilterIcon)this.showGroupbyHeaderGhost(t,l);else{this.resizeStatus="init";var w=!1,C={};C.render=i,C.parentRender=this.render.getElementsByTagName("div")[0],C.headerID=i.getAttribute(o),C.headerIndex=this.getHeaderIndex(C.headerID);for(b=0;b<this.groupbyStatus.sortIndexArr.length;b++)if(C.headerIndex==this.groupbyStatus.sortIndexArr[b]){w=!0;break}w?this.groupbyFilterList?this.toggleGroupbyFilterList(C):this.createGroupbyFilterList(C):(this.hideGroupbyFilterList(),this.showGroupbyHeaderGhost(t,l))}this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),a.Z.emptySelection()}this.handleResizeLine(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.endColumnResize=function(t){try{if(2==t.button)return;if("drag"!==this.resizeStatus&&(this.resizeStatus="init"),this.options.columnMove&&null!=this.columnMoveTarget){var e=this.event.getTargetIterator(t,this.render),i=null;if(this.event.isMe(t,this.render))for(;e.next();)e.match(this.options.headerTdClass)&&(e.match(this.options.headerTdClass+"_rowNumber")||e.match(this.options.headerTdClass+"_rowStatus")||(i=e.getElement()),e.stop());var o=this.resize_colId;if(null!=i){var r=a.Z.getDataPrefix("header_id");o=i.getAttribute(r)||this.resize_colId}this.moveColumnByHeaderId(this.columnMoveTargetId,o),this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),a.Z.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo){for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone")){e.getElement(),null==this.groupbyStatus.sortIndexArr&&(this.groupbyStatus.sortIndexArr=[]),null==this.groupbyStatus.sortOrderArr&&(this.groupbyStatus.sortOrderArr=[]);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)if(this.groupbyZoneStatus.clickedHeaderInfo.index==this.groupbyStatus.sortIndexArr[n])return this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<=this.groupbyStatus.sortIndexArr.length)return p.v.printLog("groupby max column count has been exceeded.["+this.id+"]"),this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);this.groupbyStatus.sortIndexArr.push(this.groupbyZoneStatus.clickedHeaderInfo.index),this.groupbyStatus.sortOrderArr.push(1);var l={};if(l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,null!=this.groupbyStatus.filter&&(l.filter=this.groupbyStatus.filter),!1===d.f.fireEvent(this,"ongroupby",l)){var h=this.getColCnt()+this.defaultColCnt,u=WebSquare.language.getMessage("Grid_cases")||"cases";l.rowNumHeader={colSpan:h,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+u+" ] ' ",align:"left"},l.footerVisible=!1,l.rowNumFooter={colSpan:h},this.groupby(l)}this.groupbyFilterList&&this.hideGroupbyFilterList();break}this.groupbyZoneStatus.clickedHeaderInfo=null,this.resizeStatus="init",this.handleResizeLine(t),a.Z.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if("drag"===this.resizeStatus){this.endResizeX=d.f.getScreenX(t);for(var c=this.resizeColIndex;1==this.hiddenList[c]&&!(--c<0););var g=this.colWidthList[c];if(c>=0&&this.isColumnResizable(c)){g=this.colWidthList[c]
;var f=this.getElementById(this.id+"_dataLayer").offsetWidth,m=g+this.endResizeX-this.startResizeX,y=0;if(this.options.fixedColumn>0){var b=this.getFixedColumnLastIndex();if(b>=c){for(n=0;n<b;n++)this.hiddenList[n]||(y+=n==c?m:this.colWidthList[n]);var v=30;null==this.colWidthList[b]&&(v=1),y>f-v&&(m=m-(y-f)-v-1)}}var w=this.cellInfoHash[this.getColumnID(this.columnOrder[c-this.defaultColCnt])];(m=w&&m<w.options.minWidth?w.options.minWidth:m)&&g&&this.resizeObj.width&&(this.resizeObj.width=this.resizeObj.width+m-g),0!=Math.abs(g-m)&&(this.setColumnWidth(c,m,!0),d.f.fireEvent(this,"onaftercolumnresize",c-this.defaultColCnt,g,m))}this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),a.Z.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");if(this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.options.columnMove&&null!=this.columnMoveTarget){for(var i=this.event.getTargetIterator(t,this.render),o=null;i.next();)i.match(this.options.headerTdClass)&&(o=i.getElement());if(null!=o){this.columnBlock||this.createBlockedHeaderInfo();var r=this.columnMoveTargetId,n=this.getHeaderColIndex(r);n=this.columnBlock.hash[n-this.defaultColCnt],r=this.getHeaderColID(n+this.defaultColCnt);var l=a.Z.getDataPrefix("header_id"),h=o.getAttribute(l),p=this.getHeaderColIndex(h);p=this.columnBlock.hash[p-this.defaultColCnt],h=this.getHeaderColID(p+this.defaultColCnt);var u=this.getHeaderIndex(r),c=this.getHeaderIndex(h);if(u<c)for(var g=this.columnBlock.info[p],f=g.length-1;f>=0;f--){var m=this.getHeaderColID(g[f]+this.defaultColCnt,{firstRow:!0});if(m){h=m,c=this.getHeaderIndex(h);break}}var y=this._getRealColIndex("head",h),b=this.htmlInfo.head.rowArr[0],v=!0;for(f=0;f<b.length;f++)if(b[f].id==h){v=!1;break}if(this.options.allColumnMove)for(f=1;f<this.htmlInfo.head.rowArr.length;f++)for(var w=0;w<this.htmlInfo.head.rowArr[f].length;w++)if(this.htmlInfo.head.rowArr[f][w].id==h){v=!1,h=this.htmlInfo.head.rowArr[0][w].id,c=this.getHeaderIndex(h),y=this.colMoveHeaderIndexMap[h];break}if(v)return;if("_headerRowNumber"==h||"_headerRowStatus"==h||u==c)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else{if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>u+this.defaultColCnt||this.getFixedColumnLastIndex()>c+this.defaultColCnt))return e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",void(!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor=""));this.resize_colIndex=c,this.resize_colId=h;var C=null;for(f=0;f<this.htmlInfo.body.rowArr.length;f++){for(w=0;w<this.htmlInfo.body.rowArr[f].length;w++)if(this.htmlInfo.body.rowArr[f][w]["@col"]==y){C=this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[f][w].col_id];break}if(null!==C)break}var I=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),_=WebSquare.style.getAbsoluteTop(this.render),x=WebSquare.style.getAbsoluteLeft(this.render),S=I[c+this.defaultColCnt],R=S.offsetLeft,D=S.offsetWidth,T=R+(u<c?D:0);null!=this.realColumnMoveTarget?this.resize_ghost.innerHTML=I[this.realColumnMoveTarget+this.defaultColCnt].innerHTML:this.resize_ghost.innerHTML=I[this.columnMoveTarget+this.defaultColCnt].innerHTML,this.resize_ghost.style.display="block",
this.resize_ghost.style.top=_+I[this.columnMoveTarget].offsetHeight+5+"px",this.resize_ghost.style.left=x+T+5+"px",!this.resize_ghost.firstChild||!this.resize_ghost.firstChild.tagName||"NOBR"===this.resize_ghost.firstChild.tagName.toUpperCase()||"SPAN"==this.resize_ghost.firstChild.tagName.toUpperCase()&&this.resize_ghost.firstChild.className.indexOf("w2grid_span")>-1?this.resize_ghost.style.width="auto":this.resize_ghost.style.width=D+"px",this.resize_arrow.style.display="block",this.resize_arrow.style.top=_-this.resize_arrow.offsetHeight+"px",this.resize_arrow.style.left=x+T-parseInt(this.resize_arrow.offsetWidth/2,10)+1+"px",e.style.display="block",e.style.zIndex=9999,e.style.border="1px solid #3a3f44",e.style.top=0,e.style.left=T+"px",e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px"),a.Z.emptySelection()}}}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else if("drag"==this.resizeStatus&&this.resizeStarted&&this.isColumnResizable(this.resizeColIndex)){e.style.cssText="position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px; cursor:col-resize;",e.style.display="block",e.style.zIndex=100,e.style.top=0,e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px");var L=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1,k=WebSquare.style.getComputedStyle(document.body,"zoom");1==L&&k&&(L=parseFloat(k)),e.style.left=(d.f.getMouseX(t)-WebSquare.style.getAbsoluteLeft(this.render)*L)/L+"px",this.resize_ghost.style.display="none"}else e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return void(this.rowResizeTarget&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""));if(this.handleRowResizeLine(t),null!=this.rowMoveTarget)return;for(var e=this.event.getTargetIterator(t,this.render),i=null;e.next();){var o=e.getElement();if("TD"==o.tagName&&(i=o),"TH"==o.tagName){i=null;break}}if(null==i)return;i.style.cursor="",i.cursor="";var r=d.f.getMouseY(t),n=WebSquare.style.getAbsoluteTop(i),l=a.Z.getDataPrefix("tdIndex"),h=parseInt(i.getAttribute(l),0),p=parseInt(h/this.realRowDataLength)+this.rowIndex;if(r-n<10&&0!=p)return i.style.cursor="row-resize",i.cursor="row-resize",this.rowResizeTarget&&this.rowResizeTarget!=i&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""),void(this.rowResizeTarget=i)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.doRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_rowIndex=null;e.next();)e.match(this.options.bodyTdClass)&&(i=e.getElement());if(null==i)return;if(this.startResizeY=d.f.getScreenY(t),"row-resize"==i.cursor){d.f.preventDefault(t),this.rowResizeStarted=!0,this.rowResizeTarget=i;var o=a.Z.getDataPrefix("tdIndex"),r=parseInt(i.getAttribute(o),0),n=parseInt(r/this.realRowDataLength)+this.rowIndex;this.resizeRowIndex=n-1}this.handleRowResizeLine(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.endRowResize=function(t){try{if(this.rowResizeStarted){this.endResizeY=d.f.getScreenY(t);var e=this.resizeRowIndex||0;if(e>=0){
var i=this.rowResizeTarget.offsetHeight+this.endResizeY-this.startResizeY;i=i<20?20:i,this.rowStyleArr[e]="rowResizeStyle_"+e,this.rowStyleValueObj[this.rowStyleArr[e]]||(this.rowStyleValueObj[this.rowStyleArr[e]]={}),this.rowStyleValueObj[this.rowStyleArr[e]].style="height:"+i+"px;",this.applyRowStyleOptions(e),this.drawData(this.rowIndex,e+1,"async")}if(this.rowResizeStarted=!1,this.rowResized=!0,this.rowMoveTarget=null,this.handleRowResizeLine(t),window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)try{document.selection.empty()}catch(t){s.Y.printStackTrace(t,null,this)}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleRowResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.rowResizeStarted?(e.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",e.style.display="block",e.style.zIndex=100,e.style.top=d.f.getMouseY(t)-WebSquare.style.getAbsoluteTop(this.render)+"px",e.style.width=this.render.offsetWidth+"px",e.style.left=0,this.resize_ghost.style.display="none"):(e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none")}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setColumnWidth=function(t,e){try{if(this.autoFitColWidthList=null,this.hiddenList[t])this.colWidthList[t]=e;else{var i=isNaN(this.colWidthList[t])?0:this.colWidthList[t];if(this.colWidthList[t]=e,this.gridWidth+=e-i,this.options.senseReader){var o=document.activeElement;if(o&&o.className.match("w2grid_embedded_input")){var r=this.getLastFocusedCell();r&&r.focusedTd&&o.blur()}}this.arrangeOverflowXScroll(),this.setOverflowX(),this.handleScrollX();var a=t-this.defaultColCnt;if(a>=0){var n=this.getCellInfo(a);if("textarea"==n.options.inputType)this.drawColumnData(a);else if(("text"==n.options.inputType||"secret"==n.options.inputType||"calendar"==n.options.inputType)&&n.options.embeddedInput&&!this.groupbyStatus.grouped)for(var l=this.struct.body.rowArr,h=0,d=0;d<l.length;d++){for(var p=0,u=0,c=0;c<l[d].length;c++){var g=l[d][c].id;if((p+=(n=this.getCellInfo(g)).options.colSpan-0)-1==a){u=this.getColumnIndex(g),h+=l[d].length;break}if(p-1>a){u=h+a;break}}this.embeddedWidthObj[u]&&(this.embeddedWidthObj[u].isChanged=!0),this.drawColumnData(u)}}this.handlerResize_drawInitializer()}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setColumnVisible=function(t,e){try{e=a.Z.getBoolean(e);var i=this.getCellInfo(t);if(null==(t=this.getColumnIndex(t)))return;var o=this._getRealColIndex("body",i.options.col_id)+this.defaultColCnt;if(this.hiddenList[o]!=e)return;for(var n=0;n<this.getColumnCount();n++){var l=this.getCellInfo(n);"textarea"==l.options.inputType&&"all"==l.options.displayType&&(this.setScrollTop(0),this.setScrollLeft(0))}if(this.options.fixedColumn>0&&e&&this.options.fixedColumn>t){var h=0,d=this.getFixedColumnLastIndex();for(n=0;n<d;n++)this.hiddenList[n]&&n-this.defaultColCnt!=t||(h+=this.colWidthList[n]);if(h>this.getElementById(this.id+"_dataLayer").offsetWidth-30)return void WebSquare.logger.printLog(this.id+" setColumnVisible error : not enough space to show the column.  ")}for(n=0;n<i.options.colSpan;n++)this.hiddenList[o+n]=!e;this.gridWidth=0;for(n=0;n<this.colWidthList.length;n++)this.hiddenList[n]||(this.gridWidth+=this.colWidthList[n]);if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),
""!=this.options.hiddenClass||""!=i.options.hiddenClass){this.drawData(this.rowIndex,0);var p=this.getColumnID(t),u=this.options.hiddenClass;""!=i.options.hiddenClass&&(u=i.options.hiddenClass);var c=null!=this.bodyToHeaderRelation[p]?this.getHeaderLayer(this.bodyToHeaderRelation[p]):null;e?null!=c&&this.hasClass(c,u)&&this.removeClass(c,u):null==c||this.hasClass(c,u)||this.addClass(c,u)}if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[o]){var g=this.colIndexInfo.body.colInfo.colIndexArr;for(n=0;n<g.length;n++)if(g[n]==o)for(var f=0;f<=this.lastIndex;f++)this.drawCellData(f,f+this.rowIndex,n-this.defaultColCnt),this.applyCellStyleOptions(f+this.rowIndex,n-this.defaultColCnt);this.initVisibilityArr[o]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(o,e),r.I.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit(),e&&this._setRedrawTextAreaColumn()}catch(t){s.Y.printStackTrace(t,null,this)}}),{key:this.id+"_setColumnVisible",caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setRowVisible=function(t,e,i){try{if((t=parseInt(t,10))<0||t>=this.getTotalRow()||isNaN(t))return void p.v.printLog(this.id+" setRowVisible error : invalid rowIndex "+t);var o=a.Z.getBoolean(e);if(this.hiddenRowObj.row[t]===!o||null==this.hiddenRowObj.row[t]&&!0===o)return;this.hiddenRowObj.row[t]=!o,this.hiddenRowObj.init=!0;var r=this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)});if(!1===o?(this.hiddenRowObj.length++,"all"===this.options.visibleRowNum||r||this.hiddenRowObj.extraRow<this.hiddenRowObj.length&&this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.length-1)):(delete this.hiddenRowObj.row[t],this.hiddenRowObj.length--),r)return;a.Z.setTimeout((function(){this.lastTopRowIndex=null,this.initHeightCompleted=!1;var t=this.getDataLength();if(t-this.hiddenRowObj.length<=this.lastIndex+1&&0!==this.rowIndex)return this.bScrollY=0,this.setScrollTop(0),void this.drawData(0);var e=t-this._getVisibleLastIndex(this.lastIndex+1);if(e<this.rowIndex){var i=this.getLastFocusedCell();return this.removeFocusedCell(),this.rowIndex=e,e<this.bScrollTop&&(this.bScrollTop=e),this.setScrollYHeight({restRowCnt:this._getScrollRowIndex(e),skipScrollEnd:!0}),this.drawData(e),void(i.focusedRowIndex>-1&&null!=i.focusedColIndex&&!0===this.getRowVisible(i.focusedRowIndex)&&this.setFocusedCell(i.focusedRowIndex,i.focusedColIndex))}this._applyRowVisible({applyStyle:!0,refreshColumn:!0}),this.setScrollYHeight(),this.dynamicMergeHTML(),this._setRedrawTextAreaColumn(!0)}),{key:this.id+"_setRowVisible",caller:this,delay:100})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setRowNumVisible=function(t){this.options.rowNumVisible&&0===Object.keys(this.groupbyStatus).length&&this._setRowNumStatusVisible("rowNum",t)},c.prototype.setRowStatusVisible=function(t){this.options.rowStatusVisible&&0===Object.keys(this.groupbyStatus).length&&this._setRowNumStatusVisible("rowStatus",t)},c.prototype._setRowNumStatusVisible=function(t,e){try{var i,o;if(null==t||"rowNum"!==t&&"rowStatus"!==t)return;this.options.rowNumVisible&&this.options.rowStatusVisible?(i="rowNum"===t?0:1,o="rowNum"===t?0:1):(this.options.rowNumVisible&&!this.options.rowStatusVisible||!this.options.rowNumVisible&&this.options.rowStatusVisible)&&(i=0,o=0);e=a.Z.getBoolean(e);var n=this.getCellInfo(i);if(this.hiddenList[o]!=e)return;for(var l=0;l<this.getColumnCount();l++){var h=this.getCellInfo(l);"textarea"==h.options.inputType&&"all"==h.options.displayType&&(this.setScrollTop(0),this.setScrollLeft(0))}if(this.options.fixedColumn>0&&e&&this.options.fixedColumn>i){var d=0,p=this.getFixedColumnLastIndex();for(l=0;l<p;l++)this.hiddenList[l]&&l-this.defaultColCnt!=i||(d+=this.colWidthList[l])
;if(d>this.getElementById(this.id+"_dataLayer").offsetWidth-30)return void WebSquare.logger.printLog(this.id+" setColumnVisible error : not enough space to show the column.  ")}for(l=0;l<n.options.colSpan;l++)this.hiddenList[o+l]=!e;this.gridWidth=0;for(l=0;l<this.colWidthList.length;l++)this.hiddenList[l]||(this.gridWidth+=this.colWidthList[l]);if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),""!=this.options.hiddenClass||""!=n.options.hiddenClass){this.drawData(this.rowIndex,0);var u=this.getColumnID(i),c=this.options.hiddenClass;""!=n.options.hiddenClass&&(c=n.options.hiddenClass);var g=null!=this.bodyToHeaderRelation[u]?this.getHeaderLayer(this.bodyToHeaderRelation[u]):null;e?null!=g&&this.hasClass(g,c)&&this.removeClass(g,c):null==g||this.hasClass(g,c)||this.addClass(g,c)}if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[o]){var f=this.colIndexInfo.body.colInfo.colIndexArr;for(l=0;l<f.length;l++)if(f[l]==o)for(var m=0;m<=this.lastIndex;m++)this.drawCellData(m,m+this.rowIndex,l-this.defaultColCnt),this.applyCellStyleOptions(m+this.rowIndex,l-this.defaultColCnt);this.initVisibilityArr[o]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(o,e),r.I.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit(),e&&this._setRedrawTextAreaColumn()}catch(t){s.Y.printStackTrace(t,null,this)}}),{key:this.id+"_setRowNumStatusVisible",caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.clearRowVisible=function(t){try{var e=this.hiddenRowObj.extraRow;if(this.hiddenRowObj.init&&(this.lastTopRowIndex=null),this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),t&&!0===t.noDraw)return;0!==this.rowIndex?(this.bScrollY=0,this.setScrollTop(0),this.drawData(0),this.setScrollYHeight()):(this.setScrollYHeight(),this.dynamicMergeHTML(),this.applyStyleOptions(this.lastIndex))}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&!0!==this.hiddenRowObj.row[t]}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&(!(this.hiddenRowObj.length>0)||this.getRowVisible(this.dataList.getRealRowIndex(t)))}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHiddenRowCount=function(t){try{var e=this.hiddenRowObj.length;if(this.isDrillDown&&isNaN(t)&&(t=0),this.hiddenRowObj.length>0&&(t||this.isDrillDown)){e=0;for(var i=this.getDataLength(),o=t;o<i;o++)this._getRowVisible(o)||e++}return e}catch(t){return s.Y.printStackTrace(t,null,this),0}},c.prototype._getVisibleRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;var e=this.getDataLength();if(t>=e)return e;for(var i=t,o=0;i>=0&&o<e;)this._getRowVisible(o)&&i--,i>=0&&o++;return o}catch(e){return s.Y.printStackTrace(e,null,this),t}},c.prototype._getVisibleTrRowIndex=function(t,e){try{if(this._getHiddenRowCount()<=0)return t;for(var i=this.getDataLength(),o=0,r=this.drawedRowLength+this.hiddenRowObj.extraRow-1,a=t,n=e;a>=0&&n<i&&r>o;n++)this._getRowVisible(n)&&a--,a>=0&&o++;return o}catch(e){return s.Y.printStackTrace(e,null,this),t}},c.prototype._getScrollRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;if(t<=0)return 0;for(var e=0,i=this._getScrollMaxRowIndex(),o=t-1;o>=0&&i>e;o--)this._getRowVisible(o)&&e++;return e}catch(e){return s.Y.printStackTrace(e,null,this),t}},c.prototype._getScrollMaxRowIndex=function(){try{
var t=parseInt(document.getElementById(this.id+"_size_y").style.height,10)-document.getElementById(this.id+"_scrollY_div").offsetHeight;return Math.floor((t+this._getEpsilon())/this.oneRowScrollHeight)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getEpsilon=function(){try{var t=Math.min(2,Math.round(this.oneRowScrollHeight/10)),e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;return e<1&&(t=Math.min(Math.round(t/e),Math.round(this.oneRowScrollHeight/2.4))),t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getVisibleLastIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;for(var e=t,i=this.getDataLength(),o=0,r=i-1;r>=0&&e>0;r--)this._getRowVisible(r)&&e--,o++;return o}catch(e){return s.Y.printStackTrace(e,null,this),t}},c.prototype._getTrIndex=function(t){try{var e=t;return this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>t||this.options.lastFixedRow>0&&t>this.lastIndex-this.options.lastFixedRow||(e-=this.rowIndex)),e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getTdElem=function(t,e){try{for(var i=0,o=this.rowIndex;o<t&&this.hiddenRowObj.length>0;o++)this._getRowVisible(o)||i++;var r=this._getTrIndex(t);if(r<0||r-i>=this.drawedRowLength)return;return this.data_td_list[r*this.oneRowDataLength+e]}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._addHiddenRow=function(t){try{var e=[];0==this.drawedRowLength&&this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(-1)));for(var i=[],o=0;o<this.oneRowLength;o++){var r=this.tempTr.rows[o].cloneNode(!0);i[o]=r,e.push(r)}this.addBodyRow(t,i),this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(t)));var a=this.getElementById(this.id+"_body_table"),n=this.getElementById(this.id+"_body_tbody");0==this.drawedRowLength?a.style.borderWidth="0px":a.style.borderWidth="";for(o=0;o<e.length;o++)n.appendChild(e[o]);this._setRowDisplay(t,"none"),this.hiddenRowObj.extraRow++}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._applyRowVisible=function(t){try{if(void 0!==t&&null!=t||(t={}),this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)}))return;var e=0,i=!0,o=this._getLastSubtotalCount();t.subtotalDraw&&-1==this.options.initFixedHeightByRowNum&&(o=0);var r=this.getDataLength()+o,a=this.lastIndex;a=""===this.options.visibleRowNum?Math.min(this.drawedRowLength,r-this.rowIndex)-1:"all"===this.options.visibleRowNum?t.subtotalDraw?Math.min(this.drawedRowLength,this.getDataLength())-1:this.drawedRowLength:Math.min(parseInt(this.options.visibleRowNum,10),r)-1;var n=r-this._getVisibleLastIndex(a+1),l=this.rowIndex;this.subtotalHidden();for(var h=!1,d={skipSubtotal:!0,refreshColumn:t.refreshColumn},p=0,u=a,c=0;c<=a;c++){var g=c+this.rowIndex;if(!0===t.drawRow&&(this.options.fixedRow>0&&this.options.fixedRow>c?(g=c,this.fastDrawRowData(c,g,d)):this.options.lastFixedRow>0&&c>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(c,g,d)),this._getRowVisible(c+this.rowIndex)?(this._setRowDisplay(c,""),i=!1,h=!0):(this._setRowDisplay(c,"none"),e++,i&&l<n&&l++),this.hasSubtotal&&h)this.options.initFixedHeightByRowNum>-1&&(y={maxCount:a-c+e}),(b=this.drawSubtotalRow(c+1,g,y))>0&&(h=!1,this.options.initFixedHeightByRowNum>-1&&(c>=(a-=b)&&(e-=c-a),p+=b));u=c}var f=this.hiddenRowObj.extraRow+p,m=0;for(c=0;c<f&&a>=0;c++){var y,b,v=c+u+1;g=v+this.rowIndex;if(this._getRowVisible(g)&&e>0&&g<r?(this._setRowDisplay(v,""),this.fastDrawRowData(v,g,d),e--,i=!1,h=!0):(this._setRowDisplay(v,"none"),i&&l<n&&l++,e<=0&&(h=l>=n),!0===t.drawRow&&this.fastDrawRowData(v,g,d)),this.hasSubtotal&&v+this.rowIndex<r&&h)this.options.initFixedHeightByRowNum>-1&&(y={maxCount:e}),(b=this.drawSubtotalRow(v+1,g,y))>0&&(h=!1,this.options.initFixedHeightByRowNum>-1&&(m+=b,e-=b))}l!==this.rowIndex&&!0!==t.noDraw?this.drawData(l):""===this.options.visibleRowNum?(!0===t.applyStyle&&this.applyStyleOptions(a),this.cutGridBottom()):this.lastIndex=a-m}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setCellVisible=function(t,e,i){
try{if(!0!==i&&!1!==i)return;e=this.getColumnIndex(e);var o,r=!0===this.hiddenCellObj[t+"_"+e],n=!1;if(!0===i&&r?(this.hiddenCellObj[t+"_"+e]=!1,o=!0,this.hiddenCellObj.length--):!1!==i||r||(this.hiddenCellObj[t+"_"+e]=!0,o=!0,this.hiddenCellObj.length++,this.hiddenCellObj.init||(n=!0),this.hiddenCellObj.init=!0),!0===o){var l=this._getTdElem(t,e);null!=l&&(l.style.display=!0===i?"":"none")}n&&(""!==this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&"all"!==this.options.visibleRowNum&&(this.options.visibleRowNum=""),this.setDataTable()),!0!==this._isBrowserScroll()&&"all"!==this.options.visibleRowNum&&a.Z.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:100})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setCellVisibleRefresh=function(){try{if(!0===this._isBrowserScroll()||"all"===this.options.visibleRowNum)return;this.lastTopRowIndex=null;var t=this.rowIndex,e=Math.max(this.getDataLength()-this.drawedRowLength,0);this.rowIndex=e,this.subtotalHidden();var i=this.completiveDrawData(0,{extraRowByCellHidden:!0});if(this.lastTopRowIndex=e+i,0===e&&0===i){0!==(o=this.getElementById(this.id+"_size_y")).offsetHeight&&(o.style.height="0px",this.handlerResize_drawInitializer())}else{var o=this.getElementById(this.id+"_size_y"),r=this.getElementById(this.id+"_scrollY_div"),a=o.offsetHeight;if(a<1e6&&(a=parseInt(o.style.height,10)),o.style.height=r.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",t=Math.min(t,this.lastTopRowIndex),this.hasSubtotal&&this.struct.subtotalArr&&this.struct.subtotalArr.length>0)this.lastTopRowIndex+=this.struct.subtotalArr.length,this.drawData(t);else{var n=this.oneRowScrollHeight*t;t!==this.rowIndex?this.drawData(t):r.scrollTop!==n&&(this.bScrollY=n,r.scrollTop=n),this.handlerResize_drawInitializer()}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getCellVisible=function(t,e){try{e=this.getColumnIndex(e);return!0!==this.hiddenCellObj[t+"_"+e]}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.clearCellVisible=function(t){try{for(var e in void 0!==t&&null!=t||(t={}),this.hiddenCellObj)if(!0===this.hiddenCellObj[e]){var i=e.split("_"),o=Number(i[0]),r=Number(i[1]),a=this._getTdElem(o,r);null!=a&&(a.style.display="")}this.hiddenCellObj={length:0,init:!1},!0!==t.skipDraw&&this.cutGridBottom(this.lastIndex)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._moveCellVisible=function(t,e,i){try{if(!(this.hiddenCellObj.length>0))return;void 0!==i&&null!=i||(i={});var r=[];t.sort((function(t,e){return t-e}));for(var a={},n=0;n<t.length;n++)a[t[n]]=!0;var l=this.getRowCount();for(n=0;n<l;n++)!0===i.remove&&!0===a[n]||r.push(n);!0===i.insert&&(r=r.slice(0,e).concat(t).concat(r.slice(e)));var h={};for(n=0;n<r.length;n++)r[n]!==n&&(h[r[n]]=n);var d=o.q.extend({},this.hiddenCellObj),p=this.getColumnCount();for(var u in h){var c=Number(u),g=h[c];if(c!==g)for(var f=0;f<p;f++)this.setCellVisible(g,f,!d[c+"_"+f])}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._refreshRowVisible=function(t){try{this._applyRowVisible(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setScrollLeft=function(t){t=parseInt(t,10);try{this.getElementById(this.id+"_scrollX_right").scrollLeft=t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setScrollTop=function(t){t=parseInt(t,10);try{this.scrollEvent=!0,this.getElementById(this.id+"_scrollY_div").scrollTop=t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getScrollLeft=function(){try{return this.getElementById(this.id+"_scrollX_right").scrollLeft}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getScrollTop=function(){try{return this.getElementById(this.id+"_scrollY_div").scrollTop}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setGridStyle=function(t){try{if(!t)return;if("string"==typeof t){t=t.match(/"\s*N\s*"\s*:\s*"\s*w2:gridView\s*"/)?JSON.parse(t):WebSquare.xml.parse(t)}t instanceof WebSquare.Elem&&(t=t._element),
!0===WebSquare.convertPageXML&&r.I.isXML(t)&&(t=WebSquare.xmljs.xml2json(t).E[0]),!0===r.I.isXML(t)&&9==t.nodeType&&(t=t.documentElement);var e=this.getParent();e&&e.parentControl&&("wframe"==e.parentControl.options.pluginName||"pageFrame"==e.parentControl.options.pluginName)&&(e=e.parentControl);var i,o=this.scope_obj,a=this.parentFrame;this.options.groupbyFilterBox&&this.options.customFilterBox&&this.groupbyFilterBox_history.length>0&&(i=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo),this.remove(),this.__removed_object__=!0;var n=WebSquare.controlFactory.create(null,null,t,o,a);n.options&&isNaN(n.options.fixedRightColumn)&&(n.options.fixedRightColumn=0),n.writeTo(e),n.activate(),n.onComplete(),n.options.groupbyFilterBox&&n.options.customFilterBox&&(n.refreshGroupbyFilterBox(),n.applyFilterHistory(),i?(n.customFilterList.customFilterListFilterInfo=JSON.parse(i,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})),n.groupbyFilterBox_history[n.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo=i):n.customFilterList&&(n.customFilterList.customFilterListFilterInfo={}));var l=n.options._sortStatus;if(l){for(var h=JSON.parse(l),d=[],p=[],u=[],c=0;c<h.length;c++){var g=h[c];d.push(g.colID),p.push(g.sortOrder),u.push(g.dataType)}n.dataList.setFilter({type:"sort",sortIndex:d.join(" "),sortOrder:p.join(" "),dataType:u.join(" "),focuseMode:n.options.filterFocusMode,ignoreEmptyStringOnSort:n.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:n.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:n.options.setEmptyStringSortableOnSort}),n.drawHeaderSortImages()}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getGridStyle=function(){try{return"json"===this.element._elementType?WebSquare.jsonUtil.serialize(this.element._element):WebSquare.xml.serialize(this.element._element)}catch(t){s.Y.printStackTrace(t)}},c.prototype.getCurrentGridStyle=function(){try{var t=this.element.cloneNode(!0);t.setAttribute("columnOrder",this.getColumnOrder()),t.setAttribute("fixedColumn",this.options.fixedColumn),t.setAttribute("fixedRow",this.options.fixedRow),t.setAttribute("fixedRightColumn",this.options.fixedRightColumn);for(var e=t.getChildNodes(),i=0;i<e.length;i++){if("w2:header"==e[i].getTagName())for(var o=e[i].getChildNodes(),r={},n=0,l=this.htmlInfo.head.rowAttrArr.length,h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){for(var d=o[h].getChildNodes(),p=[],u=0;u<d.length;u++)"w2:column"==d[u].getTagName()&&p.push(d[u]);for(var c=0,g=0,f={},m=0;m<p.length;m++){for(;null!=r[i]&&null!=r[i][m+c+g];)g+=r[i][m+c+g];f[m+c-0+g]=m;var y=parseInt(p[m].getAttribute("colSpan"),10)||1;if((x=parseInt(p[m].getAttribute("rowSpan"),10)||1)>1)for(var b=n;b<n+x-1;b++)null==r[b+1]&&(r[b+1]={}),null==r[b+1][m-0+c+g]?r[b+1][m-0+c+g]=y:r[b+1][m-0+c+g]+=y;y>1&&(c+=y-1)}if(n===l-1){var v=0,w=0;for(m=0;m<p.length;m++){for(;null!=r[n]&&null!=r[n][this.columnOrder[m+w+v]];)w+=r[n][this.columnOrder[m+w+v]];null==(_=f[[this.columnOrder[m-0+v+w]]])&&(_=0);var C=p[_];(y=parseInt(C.getAttribute("colSpan"),10))>1&&(v+=y-1),C.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v+w]),this.hiddenList[m+this.defaultColCnt+v+w]?C.setAttribute("hidden","true"):C.setAttribute("hidden","false")}}else if(0===n){var I=0;for(u=0;u<p.length;u++){var _,x=parseInt(p[u].getAttribute("rowSpan"),10)||1;null==(_=f[[this.columnOrder[u-0+I]]])&&(_=0);C=p[_];(y=parseInt(C.getAttribute("colSpan"),10))>1&&(I+=y-1),x===l&&(C.setAttribute("width",this.colWidthList[u+this.defaultColCnt+I]),this.hiddenList[u+this.defaultColCnt+I]?C.setAttribute("hidden","true"):C.setAttribute("hidden","false"))}}n++}if("w2:gBody"==e[i].getTagName())for(o=e[i].getChildNodes(),
h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){var S=o[h].getChildNodes(),R=[];for(u=0;u<S.length;u++)"w2:column"==S[u].getTagName()&&R.push(S[u]);for(c=0,f={},m=0;m<R.length;m++){f[m+c]=m,(y=parseInt(R[m].getAttribute("colSpan"),10))>1&&(c+=y-1)}for(v=0,m=0;m<R.length;m++){C=R[f[[this.columnOrder[m+v]]]];(y=parseInt(C.getAttribute("colSpan"),10))>1&&(v+=y-1),C.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v]),a.Z.isChrome()?C.setAttribute("hidden",this.hiddenList[m+this.defaultColCnt+v]):this.hiddenList[m+this.defaultColCnt+v]?C.setAttribute("hidden","true"):C.setAttribute("hidden","false");var D=C.getAttribute("col_id");D&&(C.setAttribute("id",D),C.removeAttribute("col_id"))}}}var T=this.getSortableStatus();return T&&T.length>0&&t.setAttribute("_sortStatus",JSON.stringify(T)),t.serialize()}catch(t){s.Y.printStackTrace(t)}},c.prototype.setTableStruct=function(){try{if(this.headerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"header",r.I._XML_NAMESPACE.W2)[0],this.bodyXml=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",r.I._XML_NAMESPACE.W2)[0],this.struct={head:this.xml2JSON(this.headerXml),body:this.xml2JSON(this.bodyXml)},this.updateStruct(this.struct.head.rowArr),this.updateStruct(this.struct.body.rowArr),this.changeRowID(this.struct.head.rowAttrArr),this.changeRowID(this.struct.body.rowAttrArr),this.footerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0],this.footerXml&&(this.hasFooter=!0,this.struct.foot=this.xml2JSON(this.footerXml),this.updateStruct(this.struct.foot.rowArr)),this.subtotalXmlArr=WebSquare.Elem.api.getElementsByTagName(this.element,"subTotal",r.I._XML_NAMESPACE.W2),this.subtotalXmlArr.length>0){this.options.showLastRow=!1,this.hasSubtotal=!0,this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0,this.struct.subtotalArr=[];for(var t=0;t<this.subtotalXmlArr.length;t++){var e=this.xml2JSON(this.subtotalXmlArr[t]);this.struct.subtotalArr.push(e),this.struct.subtotalArr[e.attr.id]=e,this.updateStruct(e.rowArr)}}if(this.setCss(),this.setColArr(),this.htmlInfo={head:this.getHeaderHtmlInfo(),body:this.getBodyHtmlInfo()},this.footerXml&&(this.htmlInfo.foot=this.getFooterHtmlInfo()),this.subtotalXmlArr.length>0){this.htmlInfo.subtotalArr=[],this.subtotalStrList={};for(t=0;t<this.struct.subtotalArr.length;t++){e=this.getSubtotalHtmlInfo(this.struct.subtotalArr[t]);this.htmlInfo.subtotalArr.push(e),this.htmlInfo.subtotalArr[e.attr.id]=e,this.subtotalStrList[e.attr.targetColumnID]=e}}this.captionXml=WebSquare.Elem.api.getElementsByTagName(this.element,"caption",r.I._XML_NAMESPACE.W2)[0];var i=this.getColCnt();this.columnOrder=[];for(t=0;t<i;t++)this.columnOrder.push(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.updateStruct=function(t){try{for(var e=0,i=[],o=this.getColCnt(),r=0;r<t.length;r++){for(var a=[],n=0;n<o;n++)a.push(null);i.push(a)}for(r=0;r<t.length;r++)for(n=0;n<t[r].length;n++){var l;for(l=0;l<i[r].length&&null!==i[r][l];l++);var h=t[r][n];h["@col"]=l;for(var d=h.colSpan||h.colspan||1,p=h.rowSpan||h.rowspan||1,u=0;u<p;u++)for(var c=0;c<d;c++)i[r+u][l+c]=e;e++}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.changeRowID=function(t){try{for(var e=0;e<t.length;e++){var i=t[e];null!=i.id&&(i["data-tr-id"]=i.id,delete i.id)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getRealColIndex=function(t,e){try{for(var i=0;i<this.htmlInfo[t].rowArr.length;i++)for(var o=0;o<this.htmlInfo[t].rowArr[i].length;o++)if(this.htmlInfo[t].rowArr[i][o].col_id==e)return this.htmlInfo[t].rowArr[i][o]["@col"];return null}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getRealHeaderColIndex=function(t){try{return this.getColumnIndex(this.headerToBodyRelation[t])}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getDataColIndex=function(t){try{return this._dataList.getColumnIndex(this.getColumnID(t))}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._moveColumn=function(t,e,i,o,r,a){try{
e=e||"td";for(var n=[],l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&n.push(t[i].childNodes[l]);var h=n[o];h.parentNode.removeChild(h);var d=[];for(l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&d.push(t[i].childNodes[l]);if(a<d.length){var p=d[a];p.parentNode.insertBefore(h,p)}else t[r].appendChild(h)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.moveBodyColumn=function(t,e,i,o){try{var r=this.htmlInfo.body.rowArr[t].splice(e,1);this.htmlInfo.body.rowArr[i].splice(o,0,r[0]),this.updateStruct(this.htmlInfo.body.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=this.getElementById(this.id+"_body_tbody"),n=0;this.hasSubtotal&&this.drawedSubtotal&&this.drawedSubtotal.length>0&&(n=this.drawedSubtotal[0].length);for(var l=0;l<this.drawedRowLength;l++){for(var h=[],d=0;d<this.oneRowLength;d++)h.push(a.rows[l*(this.oneRowLength+n)+d+n]);this._moveColumn(h,"td",t,e,i,o);for(d=0;d<n;d++)if(0===t&&0===i){var p=d>0?this.defaultColCnt:0;this._moveColumn([a.rows[l*(this.oneRowLength+n)+d]],"td",0,e-p,0,o-p)}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.moveHeadColumn=function(t,e,i,o){try{var r=this.htmlInfo.head.rowArr[t].splice(e,1);this.htmlInfo.head.rowArr[i].splice(o,0,r[0]),this.updateStruct(this.htmlInfo.head.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=this.getElementById(this.id+"_head_table");this._moveColumn(a.rows,"th",t,e,i,o)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._moveFooterColumn=function(t,e,i,o){try{var r=this.htmlInfo.foot.rowArr[t].splice(e,1);this.htmlInfo.foot.rowArr[i].splice(o,0,r[0]),this.updateStruct(this.htmlInfo.foot.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumn(a.rows,"td",t,e,i,o)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.moveFooterColumn=function(t,e){try{var i,o,r=parseInt(t,10),a=[];"string"==typeof t&&isNaN(r)?(o="id",i=t):(o="@col",i=this.colIndexes.footerColInfo.colIndexArr[r+this.defaultColCnt]-this.defaultColCnt);for(var n=0;n<this.htmlInfo.foot.rowArr.length;n++)for(var l=0;l<this.htmlInfo.foot.rowArr[n].length;l++)this.htmlInfo.foot.rowArr[n][l][o]==i&&a.push({row:n,col:l});var h,d,p=parseInt(e,10);"string"==typeof e&&isNaN(p)?(d="id",h=e):(d="@col",h=this.colIndexes.footerColInfo.colIndexArr[p+this.defaultColCnt]-this.defaultColCnt);for(n=0;n<a.length;n++){var u=null;for(l=0;l<this.htmlInfo.foot.rowArr[a[n].row].length;l++)if(this.htmlInfo.foot.rowArr[a[n].row][l][d]==h){u=l;break}null!==u?this._moveFooterColumn(a[n].row,a[n].col,a[n].row,u):this._moveFooterColumn(a[n].row,a[n].col,a[n].row,p)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.moveColumnByHeaderId=function(t,e){try{if(!t||!e||t===e)return!1;var i=this.getHeaderColIndex(t),o=this.getHeaderColIndex(e);if(isNaN(i)||isNaN(o))return!1;var r=this.columnBlock.hash[i-this.defaultColCnt],a=this.columnBlock.hash[o-this.defaultColCnt];if(r===a)return!1;var n=this.getFixedColumnLastIndex();if(this.options.fixedColumnNoMove&&(n>r||n>a))return!1;for(var l=-1,h=-1,p=0;p<this.columnOrder.length;p++){var u=this.columnOrder[p];if(u===r&&(l=p),u===a&&(h=p),l>-1&&h>-1)break}var c=this.headerToBodyRelation[t],g=this.headerToBodyRelation[e];if(!1===d.f.fireEvent(this,"onbeforecolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}))return!1;this.columnBlock||this.createBlockedHeaderInfo();var f=this.getColumnOrder(),m=-1,y=-1;for(p=0;p<f.length;p++){var b=f[p];if(b===r?m=p:b===a&&(y=p),-1!==m&&-1!==y)break}var v=this.columnBlock.info[r],w=this.columnBlock.info[a],C=f.slice(0);C.splice(m,v.length);var I=y+(m<y?w.length-v.length:0),_=C.slice(0,I).concat(v).concat(C.slice(I)),x=this.setColumnOrder(_);return d.f.fireEvent(this,"onaftercolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}),x}catch(t){
s.Y.printStackTrace(t,null,this)}},c.prototype.moveColumn=function(t,e){try{if(t==e)return;if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>t+this.defaultColCnt||this.getFixedColumnLastIndex()>e+this.defaultColCnt))return;var i=this.getHeaderID(t),o=this._getRealColIndex("head",i)+this.defaultColCnt,r=this.headerToBodyRelation[i];if(!r||this.colMoveBolockedHeaderObj[i])return;var a=this.colMoveIndexMap[r],n=this._getRealColIndex("body",r)+this.defaultColCnt,l=this.getHeaderID(e),h=this.headerToBodyRelation[l];if(!h||this.colMoveBolockedHeaderObj[l])return;var p=this._getRealColIndex("head",l)+this.defaultColCnt,u=this.colMoveIndexMap[h],c=this.colIndexes.bodyColInfo.colIndexArr[u+this.defaultColCnt];if(!1===d.f.fireEvent(this,"onbeforecolumnmove",{startColumnID:r,startColumnIndex:a,endColumnID:h,endColumnIndex:u}))return!1;for(var g=[],f=n-this.defaultColCnt,m=0;m<this.htmlInfo.body.rowArr.length;m++)for(var y=0;y<this.htmlInfo.body.rowArr[m].length;y++)this.htmlInfo.body.rowArr[m][y]["@col"]==f&&g.push({row:m,col:y});var b=c-this.defaultColCnt;for(m=0;m<g.length;m++){var v=null;for(y=0;y<this.htmlInfo.body.rowArr[g[m].row].length;y++)if(this.htmlInfo.body.rowArr[g[m].row][y]["@col"]==b){v=y;break}null!==v?this.moveBodyColumn(g[m].row,g[m].col,g[m].row,v):this.moveBodyColumn(g[m].row,g[m].col,g[m].row,u)}g=[];var w=o-this.defaultColCnt;for(m=0;m<this.htmlInfo.head.rowArr.length;m++)for(y=0;y<this.htmlInfo.head.rowArr[m].length;y++)this.htmlInfo.head.rowArr[m][y]["@col"]==w&&g.push({row:m,col:y});var C=p-this.defaultColCnt;for(m=0;m<g.length;m++){for(v=null,y=0;y<this.htmlInfo.head.rowArr[g[m].row].length;y++)if(this.htmlInfo.head.rowArr[g[m].row][y]["@col"]==C){v=y;break}null!==v?this.moveHeadColumn(g[m].row,g[m].col,g[m].row,v):this.moveHeadColumn(g[m].row,g[m].col,g[m].row,e)}this.hasFooter&&this.options.columnMoveWithFooter&&this.moveFooterColumn(t,e);var I=function(t,e,i){var o=t.splice(e,1);t.splice(i,0,o[0])};if(null!=this.initVisibilityArr)for(m=0;m<this.htmlInfo.body.rowArr.length;m++)I(this.initVisibilityArr,n+m*this.getColCnt(),c+m*this.getColCnt());for(var _ in I(this.columnOrder,n-this.defaultColCnt,c-this.defaultColCnt),I(this.colIndexInfo.body.colInfo.colIndexMatch,n,c),I(this.colWidthList,n,c),I(this.hiddenList,o,p),this.colMoveIndexMap)this.colMoveIndexMap[_]==a?this.colMoveIndexMap[_]=u:a<u?a<this.colMoveIndexMap[_]&&this.colMoveIndexMap[_]<=u&&(this.colMoveIndexMap[_]-=1):a>u&&a>this.colMoveIndexMap[_]&&this.colMoveIndexMap[_]>=u&&(this.colMoveIndexMap[_]+=1);for(var _ in this.colMoveHeaderIndexMap)this.colMoveHeaderIndexMap[_]==a?this.colMoveHeaderIndexMap[_]=u:a<u?a<this.colMoveHeaderIndexMap[_]&&this.colMoveHeaderIndexMap[_]<=u&&(this.colMoveHeaderIndexMap[_]-=1):a>u&&a>this.colMoveHeaderIndexMap[_]&&this.colMoveHeaderIndexMap[_]>=u&&(this.colMoveHeaderIndexMap[_]+=1);this.arrangeOverflowXScroll(),this._handleScrollX(),d.f.fireEvent(this,"onaftercolumnmove",{startColumnID:r,startColumnIndex:a,endColumnID:h,endColumnIndex:u})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.resetMoveColumn=function(){try{for(var t=this.getColCnt(),e=[],i=0;i<t;i++)e.push(i);this.setColumnOrder(e)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setColumnOrder=function(t){try{if(!a.Z.isEmptyObject(this.cellMergeInfo))return void p.v.printLog("warning : setColumnOrder refused due to mergeCells. ["+this.id+"]");t=t.slice();if(!this.render||0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0},this.setRedrawStatus("stop"),void this.delayedDraw({newColumnOrder:t});var e=this.getColCnt(),i=[];"string"==typeof t&&(t=t.split(","));for(var o=0;o<t.length;o++){if(null!=this.bodyIdColIndexMap[t[o]]&&(t[o]=this.bodyIdColIndexMap[t[o]]),t[o]=Number(t[o]),"number"!=typeof t[o])return void $l(this.id+".setColumnOrder : wrong column order array.");i[t[o]]=!0}if(e>t.length){
for(o=0;o<t.length;o++)t[o]=this.colIndexes.headerColInfo.colIndexArr[t[o]+this.defaultColCnt]-this.defaultColCnt;for(o=0;o<t.length;o++){var r=this.getCellInfo(t[o]).options.colSpan;if(r>1)for(var n=1;n<r;n++)t.splice(o+n,0,t[o]+n)}for(o=0;o<t.length;o++)i[t[o]]=!0}for(o=t.length-1;o>=0;o--)for(n=o-1;n>=0;n--)t[o]===t[n]&&t.splice(o,1);for(o=0;o<e;o++)i[o]||t.push(o);if(e!=t.length)return $l(this.id+".setColumnOrder : wrong column order array."),!1;var l=[];for(o=0;o<t.length;o++)for(n=0;n<this.columnOrder.length;n++)if(this.columnOrder[n]==t[o]){l[o]=n;break}if(!0===this.checkRefreshAdaptive()&&this.removeAdaptive(),this.columnOrder=l.slice(0),this.drawedRowLength<=0&&this.drawDataTable(),this._moveColumnByOrder(this.id+"_body_tbody",this.htmlInfo.body.rowArr),this._moveColumnByOrder(this.id+"_head_table",this.htmlInfo.head.rowArr),this.hasFooter&&this.options.columnMoveWithFooter){var h=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumnByOrder(h.getAttribute("id"),this.htmlInfo.foot.rowArr)}if(null!=this.initVisibilityArr){var d=[];for(o=0;o<this.initVisibilityArr.length-this.defaultColCnt;o++){var u=Math.floor(o/this.columnOrder.length),c=o%this.columnOrder.length,g=u*this.columnOrder.length+this.columnOrder[c]+this.defaultColCnt;d.push(this.initVisibilityArr[g])}for(o=0;o<d.length;o++)this.initVisibilityArr[o+this.defaultColCnt]=d[o]}this._swapItem(this.colIndexInfo.body.colInfo.colIndexMatch,this.columnOrder,this.defaultColCnt),this._swapItem(this.colWidthList,this.columnOrder,this.defaultColCnt),this.initialColWidthList=this.colWidthList.slice(),this._swapItem(this.hiddenList,this.columnOrder,this.defaultColCnt),"allColumn"===this.options.autoFit&&this._swapItem(this.autoFitColWidthList,this.columnOrder,this.defaultColCnt);for(o=0;o<this.tdIdList.length;o++)for(n=0;n<t.length;n++)if(o==t[n]){this.colMoveIndexMap[this.tdIdList[o]]=n,this.colMoveHeaderIndexMap[this.thIdList[o]]=n;break}return this.columnOrder=t.slice(0),this.arrangeOverflowXScroll(),this._handleScrollX(),!0===this.checkRefreshAdaptive()&&this.addAdaptive(),!0}catch(t){return s.Y.printStackTrace(t,null,this),!1}},c.prototype._moveColumnByOrder=function(t,e){try{var i=document.getElementById(t),o=[],r={},n=e.length;(isNaN(n)||n<=0)&&(n=1);for(var l=0;l<n;l++){if(!(I=i.rows[l]))break;var h=0;0===l&&(h=this.defaultColCnt);for(var d={},p=0,u=0,c=h;c<I.childNodes.length;c++){for(;null!=r[l]&&null!=r[l][c+p+u];)u+=r[l][c+p+u];d[c+p-h+u]=c;var g=parseInt(I.childNodes[c].getAttribute("colSpan"),10)||1;this.options.lazyDrawHiddenColumn&&"true"==I.childNodes[c].getAttribute("data-lazydrawtd")&&(g=1);var f=parseInt(I.childNodes[c].getAttribute("rowSpan"),10)||1;if(f>1)for(var m=l;m<l+f-1;m++)null==r[m+1]&&(r[m+1]={}),null==r[m+1][c-h+p+u]?r[m+1][c-h+p+u]=g:r[m+1][c-h+p+u]+=g;g>1&&(p+=g-1)}var y=0,b=0;o[l]=[];for(c=h;c<I.childNodes.length;c++){for(;null!=r[l]&&null!=r[l][this.columnOrder[c+b+y]];)b+=r[l][this.columnOrder[c+b+y]];var v=d[[this.columnOrder[c-h+y+b]]];null==v&&(v=0),o[l].push(v-h);var w=I.childNodes[v];g=parseInt(w.getAttribute("colSpan"),10);this.options.lazyDrawHiddenColumn&&"true"==w.getAttribute("data-lazydrawtd")&&(g=1),g>1&&(y+=g-1)}}for(l=0;l<i.rows.length;l++){h=0;var C=l%n;0===C&&(h=this.defaultColCnt);var I=i.rows[l];a.Z.isIEAllVersion()&&"11"==a.Z.browserVersion()&&l>=(this.lastIndex+1)*this.oneRowLength&&(I.style.backgroundColor="");var _=[];for(c=0;c<o[C].length;c++)_.push(I.childNodes[o[C][c]+h]);for(c=0;c<_.length;c++)I.appendChild(_[c])}for(var x,S=n-o.length;S>0;)x||(x=this.columnOrder.slice(0)),o.push(x),S--;for(l=0;l<n;l++)this._swapItem(e[l],o[l],0);this.updateStruct(e)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._swapItem=function(t,e,i){try{for(var o=[],r=null==i?0:i,a=0;a<e.length;a++)o.push(t[e[a]+r]);for(a=0;a<o.length;a++)t[a+r]=o[a]}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getColumnOrder=function(t){try{if(t){
for(var e=[],i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.defaultColCnt;o<i.length;o++){if(0==i[o].length)return void $l(this.id+".getColumnOrder : use getColumnOrder(false). cannot express column order by name.");for(var r=this.tdIdList[i[o][0]-this.defaultColCnt],a=!1,n=0;n<e.length;n++)if(e[n]===r){a=!0;break}a||e.push(r)}return e}return this.columnOrder.slice(0)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getDisplayColumnIndex=function(t){try{for(var e=parseInt(t,10),i=0;i<this.columnOrder.length;i++)if(e===this.columnOrder[i])return i;return t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getColumnMoveIndex=function(t){try{if(t<0||isNaN(t))return t;for(var e=this.colIndexInfo.body.colInfo.colIndexArr[t+this.defaultColCnt],i=this.colIndexInfo.body.colInfo.trIndexArr[t+this.defaultColCnt],o=this.colIndexInfo.body.colInfo.colIndexMatch[e],r=0;r<o.length;r++){var a=o[r];if(a>=t+this.defaultColCnt)break;var n=this.colIndexInfo.body.colInfo.rowSpanArr[a];n>1&&(i=i-n+1)}return o[i]-this.defaultColCnt}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleGroupbyZoneClick=function(t){try{for(var e=a.Z.getDataPrefix("header_id"),i=a.Z.getDataPrefix("col_id"),o=this.event.getTargetIterator(t,this.render);o.next()&&(!this.options.groupbyZoneSearch||!o.match("w2grid_groupbyZone_search"));){if(o.match("w2grid_groupbyZone_column")){var r=o.getElement(),n={};n.render=r,n.parentRender=this.render.getElementsByTagName("div")[0],n.headerID=r.getAttribute(e);var l=this.headerToBodyRelation[n.headerID],h=this.getColumnIndex(l);n.headerIndex=this._getColumnMoveIndex(h),n.dataIndex=this._getDataColIndex(this._getRealHeaderColIndex(n.headerID)),this.toggleGroupbyFilterList(n),d.f.stopEvent(t);break}if(o.match("w2grid_groupbyZone_column_closeButtonImg")){r=o.getElement();this.hideGroupbyFilterList(),this.ungroupColumn(r.getAttribute(i));break}if(o.match("w2grid_groupbyZone")){this.hideGroupbyFilterList(),d.f.stopEvent(t);break}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.toggleGroupbyFilterList=function(t){try{var e=t.render.tagName,i=t.headerIndex;"number"==typeof this.groupbyZoneStatus.beforeOpenedColIndex?(this.groupbyFilterList.saveState(this.groupbyZoneStatus.beforeOpenedColIndex.toString()),i==this.groupbyZoneStatus.beforeOpenedColIndex&&e==this.groupbyZoneStatus.beforeOpenedColTagName?"block"==this.groupbyFilterList.render.style.display?this.hideGroupbyFilterList():this.showGroupbyFilterList(t,!0):this.showGroupbyFilterList(t,!0,!0)):this.createGroupbyFilterList(t)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.applyFilterListFormat=function(t,e){try{var i=this.headerToBodyRelation[e],o=this.getCellInfo(i);if(this.options.displayValueOnUseFilterList)for(var r=0;r<t.length;r++)null!=t[r].id3&&(this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(r,"id2",t[r].id3):this.customFilterList.setCellDataNM(r,"id2",t[r].id3));else if(this.options.useFilterListFormat&&!this.options.useFilterSearch&&!this.options.useSearchFilter&&!o.useCustomFormatter){var a=0,n=this.headerInfoHash[e];if(n&&n.options.hideCustomFilter&&(a=1),o.options.displayFormat||o.options.displayFormatter||o.options.ioFormat)for(r=2-a;r<t.length;r++){var l=o.formatter.format(t[r].id2);this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(r,"id2",l):this.customFilterList.setCellDataNM(r,"id2",l)}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.createGroupbyFilterList=function(t){try{var e=t.render,i=t.parentRender,o=t.headerIndex,r=t.headerID;if(!this.groupbyFilterList){this.groupbyStatus.filter={};"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >",
"        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>","        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>","    </w2:listRow>","</w2:list>";var n=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>    </w2:listRow></w2:list>",!0).documentElement;this.groupbyFilterList=new WebSquare.uiplugin.list(this.id+"_groupbyZone_list","",n),this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]};var l=this;this.groupbyFilterList._handleClickEvent=this.groupbyFilterList.handleClickEvent,this.groupbyFilterList.handleClickEvent=function(t){try{d.f.stopPropagation(t);var e=d.f.getTarget(t),i=e;if((e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")||e.className.match("w2grid_groupbyZone_list_listColumn_text"))&&(i=e.parentElement),!i.className.match("w2grid_groupbyZone_list_listRow"))return;var o=i.children[0],r=l.getHeaderID(this.headerIndex),n=l.getColumnID(this.headerIndex);0==this.isGroupbyColumn&&(r=this.currentHeaderID,n=l.headerToBodyRelation[r]);var h=a.Z.getDataPrefix("unique_id"),p=i.getAttribute(h),u=this.getAllData(),c=l.getCellInfo(n);if(this.options.useFilterSearch&&this.options.useFilterListFormat&&c.formatter&&(c.options.displayFormat||c.options.displayFormatter||c.options.ioFormat))for(var g=2;g<u.length;g++)u[g].id2=c.formatter.unformat(u[g].id2);u[0].customerFilter&&u[0][h]==p?e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")&&this._handleClickEvent(t):this._handleClickEvent(t);var f=o.checked,m=!1,y=!1,b=!1;if(u[0].customerFilter&&u[0][h]==p){if(!e.className.match("w2grid_groupbyZone_list_listColumn_checkbox"))return l.firstOpenCustomFilter[r]||(l.firstOpenCustomFilter[r]=!0),void(l.options.groupbyFilterIcon?l._showCustomFilter(r):l.showCustomFilter(r));if(f)return l.firstOpenCustomFilter[r]?(l._dataList.filterManager.headerID=r,l._dataList.filterManager.targetColID=n,void l.setCustomFilterExpression()):(l.hideGroupbyFilterList(),l.firstOpenCustomFilter[r]||(l.firstOpenCustomFilter[r]=!0),void(l.options.groupbyFilterIcon?l._showCustomFilter(r):l.showCustomFilter(r)));for(var v in l.customFilterStatusObj[r]=!1,l.dataList.removeColumnFilter(n),l.customFilterStatusObj)if(l.customFilterStatusObj[v])return;m=!0,y=!0,b=!0;for(g=1;g<u.length;g++)u[g].id1=!0}else if(u[1].gridCheckedAll&&u[1][h]==p){y=!0,f&&(b=!0);for(g=2;g<u.length;g++)u[g].id1=f}if(!m&&!b&&u.length-2>0){l.groupbyStatus.filter[n]=[];for(g=2;g<u.length;g++)u[g].id1&&l.groupbyStatus.filter[n].push(u[g].id2);l.groupbyStatus.filter[n]=l.changeItemValue("value",n,l.groupbyStatus.filter[n]);var w=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(g=0;g<l.groupbyStatus.filter[n].length;g++){var C=l.groupbyStatus.filter[n][g];"string"==typeof C&&(l.groupbyStatus.filter[n][g]=C.replace(w,(function(t){return l.replacechar(t)})))}}if(y){if(b&&this.filterHistory.column[0]===n)this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),delete l.groupbyStatus.filter[n];else if(!b&&this.filterHistory.column[0]!==n&&u.length-2>0){for(g=1;g<this.filterHistory.column.length;g++)if(this.filterHistory.column[g]===n){l.dataList.removeColumnFilter(n,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(n),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else{
var I=u.length-2;if(I>l.groupbyStatus.filter[n].length){if(u[1].id1=!1,this.filterHistory.column[0]!==n){for(var g=1;g<this.filterHistory.column.length;g++)if(this.filterHistory.column[g]===n){l.dataList.removeColumnFilter(n,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(n),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else l.groupbyStatus.filter[n].length==I&&(u[1].id1=!0,delete l.groupbyStatus.filter[n],this.filterHistory.column[0]===n&&(this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()))}this.setFirstRowIndex(this.firstListIndex,!0);var _={};if(_.sortIndex=l.groupbyStatus.sortIndexArr,_.sortOrder=l.groupbyStatus.sortOrderArr,null!=l.groupbyStatus.filter&&(_.filter=l.groupbyStatus.filter,l.groupbyStatus.filter[n]&&2*l.groupbyStatus.filter[n].length>u.length)){var x=[],S="*";for(g=2;g<u.length;g++)if(!u[g].id1){if(u[g].id2===l.filterEmptyStr){S="+";continue}x.push(u[g].id2)}((c=l.getCellInfo(n)).itemsetObj||c.itemArr)&&(x=l.changeItemValue("value",n,x));var R="^\\n*(?:(?!^";for(w=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,g=0;g<x.length;g++){var D=x[g];"string"==typeof D&&(D=D.replace(w,(function(t){return l.replacechar(t)}))),R+=D+="$)(?!^"}R+="$).)"+S+"\\n*$",_.filterRegExp={},_.filterRegExp[n]=new RegExp(R,"gi")}if(_.noRefreshAfter=!0,!1===d.f.fireEvent(l,"ongroupby",_)){var T=l.getColCnt()+l.defaultColCnt,L=WebSquare.language.getMessage("Grid_cases")||"cases";_.rowNumHeader={colSpan:T,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+L+" ] ' ",align:"left"},_.footerVisible=!1,_.rowNumFooter={colSpan:T},l.groupby(_)}l.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},this.groupbyFilterList.writeTo(this),this.groupbyFilterList.activate()}if(!0===t.noDraw)return;var h=e.clientWidth,p=WebSquare.style.getRelativeTop(e,i)+e.offsetHeight,u=WebSquare.style.getRelativeLeft(e,i);this.groupbyFilterList.setPosition(u,p),this.groupbyFilterList.render.style.width=h+"px";var c=this.render.offsetHeight-p;this.groupbyFilterList.options.visibleRowNum=Math.floor(c/21);var g=this.getGroupbyDepthInfo(t);if(this.groupbyFilterList.setJSON(g),this.applyFilterListFormat(g,r),this.groupbyFilterList.currentHeaderID=r,this.groupbyFilterList.headerIndex=o,this.groupbyFilterList.isGroupbyColumn=t.isGroupbyColumn,WebSquare.style.show(this.groupbyFilterList.render),a.Z.getBoolean(this.headerInfoHash[r].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)){var f=this.groupbyFilterList.getMaxItemWidth();f>h&&(this.groupbyFilterList.render.style.width=f+"px")}this.groupbyFilterList.focus(),this.groupbyZoneStatus.beforeOpenedColIndex=o,this.groupbyZoneStatus.beforeOpenedColTagName=e.tagName}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.showGroupbyFilterList=function(t,e,i){try{var o=t.render,r=t.parentRender,n=t.headerIndex,l=t.headerID;if(this.groupbyFilterList.currentHeaderID=t.headerID,this.groupbyFilterList.headerIndex=n,this.groupbyZoneStatus.beforeOpenedColIndex=n,this.groupbyZoneStatus.beforeOpenedColTagName=o.tagName,WebSquare.style.show(this.groupbyFilterList.render),this.groupbyFilterList.focus(),e){var h,d=WebSquare.style.getRelativeTop(o,r)+o.offsetHeight,p=WebSquare.style.getRelativeLeft(o,r),u=this.render.offsetHeight-d;this.groupbyFilterList.options.visibleRowNum=Math.floor(u/21);var c=this.getGroupbyDepthInfo(t);this.groupbyFilterList.setJSON(c),!0===i&&this.groupbyFilterList.loadState(n),a.Z.getBoolean(this.headerInfoHash[l].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)?(h=this.groupbyFilterList.getMaxItemWidth(),o.clientWidth>h&&(h=o.clientWidth)):h=o.clientWidth,this.groupbyFilterList.setPosition(p,d),this.groupbyFilterList.render.style.width=h+"px",this.applyFilterListFormat(c,l)}else if(!0===i){this.groupbyFilterList.loadState(n);c=this.getGroupbyDepthInfo(t);this.applyFilterListFormat(c,l)}}catch(t){
s.Y.printStackTrace(t,null,this)}},c.prototype.hideGroupbyFilterList=function(){try{this.groupbyFilterList&&(WebSquare.style.hide(this.groupbyFilterList.render),this.groupbyFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.groupbyFilterList.isChanged=!1))}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getGroupbyDepthInfo=function(t){try{t.headerIndex;var e,i=t.headerID,o=this.headerToBodyRelation[i];0==t.isGroupbyColumn&&(o=this.headerToBodyRelation[i]),e=this.groupbyFilterList.filterHistory.column[0]===o?this.groupbyFilterList.filterHistory.filteredRowIndexArr[0]:this._dataList.filteredRowIndexArr;var r=this.dataList.getColData(o,e),a=this.getCellInfo(o),n=this.getUniqueValueOfArray(r),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("");var h,d,p=this.changeItemValue("label",o,n.slice(0)),u=this.customFilterStatusObj[i]||!1,c=WebSquare.language.getMessage("Grid_Customized_Filter")||"Customized Filter",g=WebSquare.language.getMessage("Grid_checked_all")||"choose all",f=[];f.push({id1:u,id2:c,customerFilter:!0}),f.push({id1:!u,id2:g,gridCheckedAll:!0}),!u&&this.groupbyStatus.filter&&o in this.groupbyStatus.filter&&(d=(h=this.groupbyStatus.filter[o]).slice(0));for(var m=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,y=this,b=0;b<p.length;b++){var v={};if(d){var w=!1,C=a.itemArr?a.itemHash[p[b]]:p[b];"string"==typeof C&&(C=C.replace(m,(function(t){return y.replacechar(t)})));for(var I=d.length-1;I>-1;I--){if(C==d[I]){w=!0,d.splice(I,1);break}if("string"==typeof d[I]){for(var _=!1,x=0;x<l.length;x++)if(l[x]==d[I]){_=!0;break}if(_&&(p[b]==this.options.useFilterEmptyMsg||p[b]==this.filterEmptyStr)){w=!0;break}}}v.id1=w}else v.id1=!u;v.id2=p[b],this.options.displayValueOnUseFilterList&&(v.id3=n[b]),f.push(v)}if(h){var S=!0,R=f;for(b=2;b<R.length;b++)if(!R[b].id1){S=!1;break}f[1].id1=!!S}return this._dataList.getDataLength()||(f[1].id1=!1),f}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.showGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(this.groupbyZoneStatus.groupbyZoneRender.offsetHeight>0)return;if(WebSquare.style.show(this.groupbyZoneStatus.groupbyZoneRender),this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.Y.printStackTrace(t,null,this)}this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.hideGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(0==this.groupbyZoneStatus.groupbyZoneRender.offsetHeight)return;if(this.dom[this.id+"_main_div"].style.top="0px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight+this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.Y.printStackTrace(t,null,this)}WebSquare.style.hide(this.groupbyZoneStatus.groupbyZoneRender),this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.showGroupbyZoneMessage=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.show(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.hideGroupbyZoneMessage=function(){try{if(this.options.groupbyZone&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.hide(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.syncWithGroupbyZone=function(){try{if(this.groupbyStatus.grouped&&this.options.groupbyZone){this.clearGroupbyZone()
;for(var t=a.Z.getDataPrefix("header_id"),e=a.Z.getDataPrefix("col_id"),i=this.groupbyStatus.sortIndexArr,o=0;o<i.length;o++){var r=i[o],n=this.getColumnID(r),l=this.bodyToHeaderRelation[n],h=document.createElement("div");h.setAttribute(t,l),h.className="w2grid_groupbyZone_column";var d=document.createElement("div");d.className="w2grid_groupbyZone_column_closeButtonDiv";var p=document.createElement("div");p.className="w2grid_groupbyZone_column_closeButtonImg",p.setAttribute(e,n);var u=document.createElement("div");u.className="w2grid_groupbyZone_column_labelDiv";var c=document.createElement("span"),g="textContent"in c?"textContent":"innerText";c[g]=this.getHeaderValue(l).replace(/<(\/)?br(\\s)*(\/)?>/gi," "),c.setAttribute("title",c[g]),u.appendChild(c),d.appendChild(p),h.appendChild(u),h.appendChild(d),this.groupbyZoneStatus.groupbyZoneRender.appendChild(h),c.className="w2grid_groupbyZone_column_value"}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.clearGroupbyZone=function(){try{if((this.groupbyStatus.grouped||this.clearGrouping)&&this.options.groupbyZone){for(var t=this.groupbyZoneStatus.groupbyZoneRender,e=t.childNodes,i=[],o=0;o<e.length;o++)null!=e[o].className.match("w2grid_groupbyZone_column")&&i.push(e[o]);for(o=0;o<i.length;o++)t.removeChild(i[o])}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.handleChangeGroupDepth=function(t){try{for(var e=a.Z.getDataPrefix("header_id"),i=this.event.getTargetIterator(t);i.next();)if(i.match("w2grid_groupbyZone_column")){this.addClass("w2noselect"),a.Z.emptySelection();var o=i.getElement().getAttribute(e),r=this.getHeaderIndex(o),n=this.getHeaderValue(o),l=this;return void WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_column_drag",contents:n,delay:15,applyMousePosition:!0,onDrop:function(t,i,o,s,a,n,h){var d,p=null;for(this.isMobile?(p=new WebSquare.targetIterator(document.elementFromPoint(h.changedTouches[0].clientX,h.changedTouches[0].clientY)),h.preventDefault()):p=l.event.getTargetIterator(h);p.next();){if(p.match("w2grid_groupbyZone_column")){d=l.getHeaderIndex(p.getElement().getAttribute(e));break}if(p.match("w2grid_groupbyZone")){var u=l.groupbyStatus.sortIndexArr;d=u[u.length-1];break}if(p.match(null,null,"body"))return}r!=d&&(!1===l.options.noSelect&&!1===l.options.preventCopy&&l.removeClass("w2noselect"),l.hideGroupbyFilterList(),l.changeGroupDepth(r,d))}})}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.createContextMenu=function(t,e){try{if("object"==typeof e&&!0===e.hideSystemMenu)return;"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>","        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>","    </w2:listRow>","</w2:list>";var i=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>    </w2:listRow></w2:list>",!0).documentElement;this.contextMenu=new WebSquare.uiplugin.list(this.id+"_contextMenu_list","",i),this.contextMenu.writeTo(WebSquare.getBody()),this.contextMenu.activate();var o=this;this.contextMenu.event.addListener(this.contextMenu.render,"onclick",(function(t){try{d.f.stopPropagation(t);for(var e,i,r=o.event.getTargetIterator(t,this.render),a=o.contextMenu;r.next();){if(r.match("w2grid_contextMenu_column")){e=r.getElement().parentNode;break}if(r.match("w2grid_contextMenu_row")){e=r.getElement();break}if(r.match("w2grid_contextMenu"))break}for(var n=0;n<a.getLength();n++)if(e==a.render.childNodes[n]){i=n;break}
o.callSelectedAPI(a.getRowData(n).col1,a.info),o.hideContextMenu();var l=o.contextMenu.getAllData()[i],h={row:a.info.rowIndex,col:a.info.colIndex,focusedCell:a.info.focusedCell,userMenuId:l.userMenuId,isSystemMenu:l.isSystemMenu,systemMenu:l.systemMenu};a.info=null,d.f.fireEvent(o,"oncontextclick",h.row,h.col,h.userMenuId,h.isSystemMenu,h.systemMenu,h.focusedCell)}catch(t){s.Y.printStackTrace(t,null,this)}}));var r=this.getContextMenuData(t);if(e&&e.hideSystemMenu&&"object"==typeof e.hideSystemMenu&&e.hideSystemMenu.indexOf)for(var a=0;a<r.length;a++){var n=r[a].systemMenu;e.hideSystemMenu.indexOf(n)>-1&&(r.splice(a,1),a--)}if(e&&e.appendMenu&&"object"==typeof e.appendMenu&&e.appendMenu.length)for(a=0;a<e.appendMenu.length;a++){var l=e.appendMenu[a];l.col1=l.label,l.isSystemMenu=!1,r.push(l)}if(r.length>0){this.showContextMenu(t,r);for(a=0;a<r.length;a++){var h=r[a];h.className&&(this.contextMenu.render.children[a].className=this.contextMenu.render.children[a].className+" "+h.className)}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getContextMenuData=function(t){try{var e=[],i=!0;if(this.groupbyStatus.grouped)for(var o=WebSquare.language.getMessage("Grid_ungroup")||"Ungroup",r=0;r<this.groupbyStatus.sortIndexArr.length;r++)if(t.focusedCell&&t.focusedCell.length>1){for(var a=0;a<t.focusedCell.length;a++)if(this.groupbyStatus.sortIndexArr[r]==t.focusedCell[a].focusedColIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(!i)break}else if(this.groupbyStatus.sortIndexArr[r]==t.colIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(i){var n=WebSquare.language.getMessage("Grid_group")||"Group";e.push({col1:n,isSystemMenu:!0,systemMenu:"Group"})}var l=WebSquare.language.getMessage("Grid_column_hide")||"Hide";if(e.push({col1:l,isSystemMenu:!0,systemMenu:"ColumnHide"}),0==this.options.fixedColumn||this.options.fixedColumn-1<t.colIndex){var h=WebSquare.language.getMessage("Grid_column_fix")||"Fix";e.push({col1:h,isSystemMenu:!0,systemMenu:"ColumnFix"})}if(this.options.fixedColumn>0){var d=WebSquare.language.getMessage("Grid_column_unfix")||"Unfix All Columns";e.push({col1:d,isSystemMenu:!0,systemMenu:"ColumnUnfixAll"})}var p=WebSquare.language.getMessage("Grid_column_adjustWidth")||"Adjust Width",u=WebSquare.language.getMessage("Grid_column_showAll")||"Show All Columns";e.push({col1:p,isSystemMenu:!0,systemMenu:"ColumnAdjustWidth"});for(r=0;r<this.hiddenList.length;r++)if(this.hiddenList[r]){e.push({col1:u,isSystemMenu:!0,systemMenu:"ColumnShowAll"});break}var c=WebSquare.language.getMessage("Grid_column_adjustAuto")||"Adjust All Column Widths";e.push({col1:c,isSystemMenu:!0,systemMenu:"ColumnAdjustAuto"});var g=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"UnAdjust All Column Widths";if(e.push({col1:g,isSystemMenu:!0,systemMenu:"ColumnAdjustAutoNone"}),this.groupbyStatus.grouped){var f=WebSquare.language.getMessage("Grid_fold_all")||"Fold All",m=WebSquare.language.getMessage("Grid_unfold_all")||"Unfold All",y=WebSquare.language.getMessage("Grid_ungroup_all")||"Ungroup All";e.push({col1:f,isSystemMenu:!0,systemMenu:"FoldAll"}),e.push({col1:m,isSystemMenu:!0,systemMenu:"UnfoldAll"}),e.push({col1:y,isSystemMenu:!0,systemMenu:"UngroupAll"})}return e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.showContextMenu=function(t,e){try{e||(e=this.getContextMenuData(t),this.contextMenu.setPosition(0,0));var i=e.length*(this.options.contextMenuRowHeight+1);this.contextMenu.show(),this.contextMenu.setSize(null,i),this.contextMenu.setJSON(e);var o=d.f.getMouseX(t.event),r=d.f.getMouseY(t.event),a=document.body.scrollTop;a<document.documentElement.scrollTop&&(a=document.documentElement.scrollTop);var n=(r-a)*WebSquare.style.getScale(),l=document.documentElement.clientHeight-n,h=Math.max(l,n),p=WebSquare.style.getSize(this.contextMenu.render,"outerheight");(h<p&&e.length>0||l<p&&n>p)&&(r-=p),r<0&&(r=0),
document.documentElement.clientWidth<o+this.contextMenu.render.offsetWidth&&(o-=this.contextMenu.render.offsetWidth)<0&&(o=WebSquare.style.getAbsoluteLeft(this.render)),this.contextMenu.setPosition(o,r),this.contextMenu.info=t}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.hideContextMenu=function(){try{this.contextMenu&&this.contextMenu.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.callSelectedAPI=function(t,e){try{var i=WebSquare.language.getMessage("Grid_column_hide")||"Hide",r=WebSquare.language.getMessage("Grid_column_showAll")||"Show All Columns",a=WebSquare.language.getMessage("Grid_column_fix")||"Fix",n=WebSquare.language.getMessage("Grid_column_unfix")||"Unfix All Columns",l=WebSquare.language.getMessage("Grid_column_adjustWidth")||"Adjust Width",h=WebSquare.language.getMessage("Grid_column_adjustAuto")||"Adjust All Column Widths",p=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"UnAdjust All Column Widths",c=WebSquare.language.getMessage("Grid_fold_all")||"Fold All",g=WebSquare.language.getMessage("Grid_unfold_all")||"Unfold All",f=WebSquare.language.getMessage("Grid_ungroup_all")||"Ungroup All",m=WebSquare.language.getMessage("Grid_ungroup")||"Ungroup",y=WebSquare.language.getMessage("Grid_group")||"Group",b=e.focusedCell||[],v=[];if(b.length>0){for(var w=0;w<e.focusedCell.length;w++)v.push(e.focusedCell[w].colIndex);v.sort((function(t,e){return t-e}));for(w=0;w<v.length-1;)v[w]===v[w+1]?v.splice(w,1):w++}switch(t){case i:if(-1===e.colIndex)break;if(v.length>1)for(w=0;w<v.length;w++)this.setColumnVisible(v[w],!1),this.groupbyStatus.grouped&&this.ungroupColumn(v[w]);else this.setColumnVisible(e.colIndex,!1),this.groupbyStatus.grouped&&this.ungroupColumn(e.colIndex);break;case r:for(w=0;w<this.hiddenList.length;w++)this.hiddenList[w]&&this.setColumnVisible(this.columnOrder[w-this.defaultColCnt],!0);break;case a:if(-1===e.colIndex)break;if(v.length>1)for(w=0;w<v.length;w++)this.setFixedColumn(parseInt(v[w],10)+1);else this.setFixedColumn(parseInt(e.colIndex,10)+1);break;case n:if(-1===e.colIndex)break;this.setFixedColumn(0);break;case l:if(-1===e.colIndex)break;if(!this.autofitColumn){var C={type:"selectedColumn",colIndex:e.colIndex};this.setAutoFit(C)}break;case h:C={type:"allColumn"};this.setAutoFit(C);break;case p:this.clearAutoFit();break;case c:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.foldAll();break;case g:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.unfoldAll();break;case f:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.clearGroupby();break;case m:if(-1===e.colIndex)break;if(v.length>1)for(w=0;w<v.length;w++)this.ungroupColumn(v[w]);else this.ungroupColumn(e.colIndex);break;case y:if(-1===e.colIndex)break;if(this.groupbyStatus.grouped){if((C={}).sortIndex=this.groupbyStatus.sortIndexArr,C.sortOrder=this.groupbyStatus.sortOrderArr,v.length>1)for(w=0;w<v.length;w++)C.sortIndex.push(v[w]),C.sortOrder.push(1);else C.sortIndex.push(e.colIndex),C.sortOrder.push(1);!1===d.f.fireEvent(this,"ongroupby",C)&&((C=o.q.extend({},this.groupbyDisplayOptions)).sortIndex=this.groupbyStatus.sortIndexArr,C.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(C,!0))}else{C={};if(v.length>1){C.sortIndex=v,C.sortOrder=[];for(w=0;w<v.length;w++)C.sortOrder.push(1)}else C.sortIndex=[e.colIndex],C.sortOrder=[1];if(!1===d.f.fireEvent(this,"ongroupby",C)){var I=this.getColCnt()+this.defaultColCnt,_=u.B.getMessage("Grid_groupby_count")||"items";C.rowNumHeader={colSpan:I,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+_+" ] ' ",align:"left"},C.rowNumFooter={colSpan:I},this.groupby(C,!0)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.createCustomFilterList=function(t,e){try{var i;this.headerID=t,!0!==e&&(i=this.headerToBodyRelation[t])
;var o=this.options.filterListRowHeight+1,r=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum,n=WebSquare.language.getMessage("Grid_filter_search")||"search",l=this.getElementById(this.id+"_head_table");this._dataLayerHeight=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight,this._dataLayerHeight=this._dataLayerHeight-l.offsetHeight;var h=0;this.options.useFilterSearch?(h=Math.min(parseInt(this._dataLayerHeight/o),r),this.customFilterScrollViewRenderHeight=h*o):this.customFilterScrollViewRenderHeight=r*o;"<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'>","</w2:scrollView>";var p=WebSquare.xml.parse("<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'></w2:scrollView>",!0).documentElement;WebSquare.xml.setAttribute(p,"bounce",!1),WebSquare.xml.setAttribute(p,"paging",!1),a.Z.isMobile()||(WebSquare.xml.setAttribute(p,"horizontalScroll",!1),WebSquare.xml.setAttribute(p,"scrollType","auto"),WebSquare.xml.setAttribute(p,"showHorizontalScroll",!1),WebSquare.xml.setAttribute(p,"showVerticalScroll",!1),WebSquare.xml.setAttribute(p,"verticalScroll",!1)),this.customFilterScrollView=new WebSquare.uiplugin.scrollView(this.id+"_customFilter_scrollView","",p);var u="";if(this.options.useFilterSearch)u+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list' placeholder='"+n+"' virtualized='true' visibleRowNum='"+(h-1)+"' useSearch='true' wheelRows='1' _listRowHeight='"+o+"'>";else{this.options.useSearchFilter&&(useSearchFilterStr=" useSearchFilter='true'"),u+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list'>"}u+="    <w2:listRow tagName='div' style='height: "+this.options.filterListRowHeight+"px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_customFilter_list_listRow'>",u+="        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_customFilter_list_listColumn_checkbox'/>",u+="        <w2:listColumn id='id2' inputType='text' style='' class='w2grid_customFilter_list_listColumn_text'/>",u+="        <w2:listColumn id='id3' inputType='text' style='display:none;'/>",u+="    </w2:listRow>",u+="</w2:list>";var c=WebSquare.xml.parse(u,!0).documentElement;if(this.customFilterList=new WebSquare.uiplugin.list(this.id+"_customFilter_list","",c),this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterList._useLabelTag=!0,this.customFilterScrollView.addControl(this.customFilterList),this.customFilterScrollView.writeTo(this),this.customFilterScrollView.activate(),this.customFilterScrollView.render.setAttribute("role","dialog"),this.options.useSearchFilter){this.customFilterList.myhelper=new WebSquare.korHelper;var g=WebSquare.document.createElement("div");g.id=this.id+"_filter_Search_div",g.style.position="relative",g.style.backgroundColor="white",g.style.boxSizing="border-box",this._filter_searchInput=WebSquare.document.createElement("input"),this._filter_searchInput.id=this.id+"_filter_search_input",this._filter_searchInput.className="w2grid_filter_search_input",this._filter_searchInput.name=this.id+"_filter_search_input",this._filter_searchInput.style.height=o-3+"px",a.Z.isIEAllVersion(),this._filter_searchInput.placeholder=n,g.appendChild(this._filter_searchInput),this.customFilterScrollView.render.insertBefore(g,this.customFilterScrollView.render.firstChild);var f=this.uuid,m=this.id;d.f.addListener(g,"onkeydown",(function(t){d.f.stopPropagation(t),a.Z.setTimeout((function(){WebSquare.idCache[f].customFilterList.find()}),{key:m+"_customFilterList_search",delay:100})})),
d.f.addListener(g,"onkeyup",(function(t){d.f.stopPropagation(t);var e=WebSquare.idCache[f],i=e.getHeaderDIV(e.customFilterList.currentHeaderID).getElementsByClassName("w2grid_customFilter_open")[0];if(13==t.keyCode){(e.options.useFilterSearch?this.dom.input.value:e._filter_searchInput.value)&&(e.hideCustomFilterList(),i&&i.focus())}else 27==t.keyCode&&(e.hideCustomFilterList(),i&&i.focus())})),this.customFilterScrollViewRenderHeight+=o}var y=this;if(this.customFilterScrollView.event.addListener(this.customFilterScrollView.render,"onkeydown",this.customFilterScrollView.event.bindAsEventListener(this.customFilterList,(function(t){try{var e,i,o,r=t.charCode?t.charCode:t.keyCode,a=t.target||t.srcElement,n=this.getAllData().length,l=!1;if(!0===this.options.virtualized){if(e=(e=Math.min(this.options.visibleRowNum,n))!==(i=document.getElementById(this.id+"_items_main")).children.length?i.children.length:e,9===r)if(t.shiftKey)if(o=-1,this.dom.input&&this.dom.input===a)l=!0;else{var h=this.firstListIndex+o;if(a===i.getElementsByTagName("input")[0])if(h<0)this.dom.input.focus(),d.f.stopEvent(t);else this.setFirstRowIndex(h),i.getElementsByTagName("input")[0].focus(),d.f.stopEvent(t)}else{var p=i.getElementsByTagName("input")[e-1];if(o=1,a===p)if((h=this.firstListIndex+o)>this.listRowObjArr.length-this.options.visibleRowNum)l=!0;else this.setFirstRowIndex(h),(p=i.getElementsByTagName("input")[e-1]).focus(),d.f.stopEvent(t)}}else if(e=(e=n)!==(i=document.getElementById(this.id)).children.length?i.children.length:e,9===r)if(t.shiftKey){var u=this.render.getElementsByTagName("input")[0];u&&u===a&&(l=!0)}else{var c=this.render.getElementsByTagName("input")[n-1];c&&c===a&&(l=!0)}!0===l&&(this.parentControl.parentControl.hideCustomFilterList(),d.f.stopEvent(t))}catch(t){s.Y.printStackTrace(t,null,this)}}))),this.customFilterScrollView.event.addListener(this.customFilterScrollView.render,"onclick",this.customFilterScrollView.event.bindAsEventListener(this.customFilterList,(function(t){try{d.f.stopPropagation(t);var e=d.f.getTarget(t);if(e.className.match("w2list_input")||e.className.match("w2list_scroll_thumb")||e.className.match("w2grid_filter_search_input")||e.className.match("w2grid_customFilter_scrollView"))return;var i,o=e.parentNode,r=0;if(this.options.virtualized?(i=this.getElementById(this.id+"_items_main").childNodes,r=this.firstListIndex):i=this.render.childNodes,e.className.match("w2grid_customFilter_list_listRow")){e=(o=e).firstChild;for(var a=0;a<this.getLength();a++)if(o==i[a]){this.setCellData(a+r,"id1",!e.checked);break}}if(e.className.match("w2grid_customFilter_list_listColumn_text")&&(i[0]!=o||this.options.virtualized&&r>0)){e=o.firstChild;for(a=0;a<this.getLength();a++)if(o==i[a]){this.setCellData(a+r,"id1",!e.checked),d.f.preventDefault(t);break}}var n=this.currentHeaderID,l=y.headerToBodyRelation[n],h=y._dataList.getColumnIndex(l),p=y.headerInfoHash[n],u=0;if(p&&p.options.hideCustomFilter&&(u=1),1!==u&&o==i[0]&&0===r){if(e.className.match("w2grid_customFilter_list_listColumn_checkbox")){if(e.checked){if(y.firstOpenCustomFilter[n]){y.headerID=n,y.targetColID=l,(y.options.useFilterSearch||y.options.useSearchFilter)&&y.setAutoCompleteItem(l,n),y.setCustomFilterExpression();for(a=1;a<this.getLength();a++)this.setCellData(a,"id1",!1);if(y.options.useFilterSearch||y.options.useSearchFilter){var c=y.getCustomFilterListJSON({colID:l,headerID:n});y._setFilterListHeight(n,c.length)}return}return y.hideCustomFilterList(),y.firstOpenCustomFilter[n]||(y.firstOpenCustomFilter[n]=!0),void y._showCustomFilter(n)}if(y.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],y.dataList.removeColumnFilter(l),y.options.useFilterSearch||y.options.useSearchFilter){(c=y.getCustomFilterListJSON({colID:l,headerID:n}))[0].id1=!1;for(a=1-u;a<c.length;a++)c[a].id1=!0}for(a=1;a<this.getLength();a++)this.setCellData(a,"id1",!0);y.options.useFilterSearch&&(this.setJSON(c),y._setFilterListHeight(n,c.length))
}else if(e.className.match("w2grid_customFilter_list_listColumn_text"))return void y._showCustomFilter(n)}else if(1!==u&&this.setCellData(0,"id1",!1),y.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],o==i[1-u-r]){var g=e.checked;if(e.className.match("w2grid_customFilter_list_listColumn_text"))g=!i[1-u].firstChild.checked;for(a=1-u;a<this.getLength();a++)this.setCellData(a,"id1",g)}var f=[],m=[],b=[],v=this.getLength();for(a=2-u;a<v;a++)this.getCellData(a,"id1")?m.push(a):b.push(a);var w=m.length>b.length,C=(y._dataList.getFilterList(),this.getLength()-2+u),I=y.getCellInfo(l),_=w?b:m,x="*";for(a=0;a<_.length;a++){var S=this.getCellData(_[a],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&I.formatter&&(I.options.displayFormat||I.options.displayFormatter||I.options.ioFormat)&&(S=I.formatter.unformat(S)),y.options.useFilterListFormat&&I.useCustomFormatter&&""===(S=this.getCellData(_[a],"id3"))&&(x="+"),w&&S===y.filterEmptyStr?x="+":f.push(S)}y.options.useFilterListFormat&&I.useCustomFormatter||(f=y.changeItemValue("value",l,f));var R=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(a=0;a<f.length;a++){var D=f[a];"string"==typeof D&&(f[a]=D.replace(R,(function(t){return y.replacechar(t)})))}var T="";0==m.length?T+="/^[a-z0-9_-]{3,16}$/":T+=w?"^\\n*(?:(?!^"+f.join("$)(?!^")+"$).)"+x+"\\n*$":"^"+f.join("$|^")+"$";var L,k="";if(I&&(k=y.getColumnOption(I.options.col_id,"dataType")),L="number"==k?new RegExp(T):new RegExp(T,"gi"),d.f.fireEvent(y._dataList,"onbeforecolumnfilterchange"),m.length<C&&(WebSquare.DataCollection.stopBroadCast=!0),y.dataList.removeColumnFilter(l,{noRefreshAfter:!0}),this.filterHistory.column[0]!==l&&(this.filterHistory.column.unshift(l),this.filterHistory.filteredRowIndexArr.unshift(y._dataList.filteredRowIndexArr.slice(0))),m.length<C){if(WebSquare.DataCollection.stopBroadCast=!1,w){this.customFilterListFilterInfo[l]=[];for(a=0;a<m.length;a++){S=this.getCellData(m[a],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&I.formatter&&(I.options.displayFormat||I.options.displayFormatter||I.options.ioFormat)&&(S=I.formatter.unformat(S)),y.options.useFilterListFormat&&I.useCustomFormatter&&(S=this.getCellData(m[a],"id3")),this.customFilterListFilterInfo[l].push(S)}(I.itemsetObj||I.itemArr)&&(y.options.useFilterListFormat&&I.useCustomFormatter||(this.customFilterListFilterInfo[l]=y.changeItemValue("value",l,this.customFilterListFilterInfo[l])));for(a=0;a<this.customFilterListFilterInfo[l].length;a++){var F=this.customFilterListFilterInfo[l][a];F===y.filterEmptyStr?this.customFilterListFilterInfo[l][a]="":"string"==typeof F&&(F=F.replace(R,(function(t){return y.replacechar(t)})),this.customFilterListFilterInfo[l][a]=F)}}else this.customFilterListFilterInfo[l]=f;y.dataList.setColumnFilter({type:"regExp",colIndex:h,key:L,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[l];var A=y.getElementById(y.id+"_"+n+"_filter");1!==u&&this.getCellData(0,"id1")||WebSquare.style.removeClass(A,"w2grid_customFilter_filter");var E=!0,M=(C=this.getLength()-2+u,this.getAllData());for(a=2-u;a<M.length;a++)if(!M[a].id1){E=!1;break}E?(this.setCellData(1-u,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()):(this.setCellData(1-u,"id1",!1),WebSquare.style.addClass(A,"w2grid_customFilter_filter")),d.f.fireEvent(y._dataList,"onaftercolumnfilterchange"),y.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){s.Y.printStackTrace(t,null,this)}}))),(this.options.useFilterSearch||this.options.useSearchFilter)&&(this.customFilterList.find=function(){this.search="contain";var t="";t=y.options.useFilterSearch?this.dom.input.value:y._filter_searchInput.value,!y.options.caseSensitive&&t&&(t=t.toLowerCase());var e=[],i=this.currentHeaderID,o=y.headerToBodyRelation[i],s=y._dataList.getColumnIndex(o),r=y.getCellInfo(o),a=y.headerInfoHash[i],n=0
;a&&a.options.hideCustomFilter&&(n=1);for(var l=0;l<2-n;l++)e.push({id1:l-n==1,id2:b[l].id2});if(""!=t){y.itemValueObj={},y.customFilterStatusObj[i]=!1,y.firstOpenCustomFilter[i]=!1;var h=e.length;y.dataList.removeColumnFilter(o),delete this.customFilterListFilterInfo[o];for(N=y.getCustomFilterListJSON({colID:o,headerID:i,useFormat:!1}),l=2-n;l<N.length;l++){var p=!1,u=N[l].id2+"";if(y.options.caseSensitive||(u=u.toLowerCase()),"contain"==this.search?p=this.myhelper.containWith(u,t):"start"==this.search?p=this.myhelper.startWith(u,t):"none"==this.search&&(p=u==t),p){var c,g=N[l].id2;(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.formatter&&(r.options.displayFormat||r.options.displayFormatter||r.options.ioFormat)&&(g=r.formatter.format(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.useCustomFormatter&&(g=N[l].id2,c=N[l].id3),e.push({id1:!0,id2:g,id3:c})}}h===e.length&&e.splice(1-n,1),this.setJSON(e),y._setFilterListHeight(i,N.length,e.length);var f=[],m=[],v=[],w=this.getLength();for(l=2-n;l<w;l++)this.getCellData(l,"id1")?m.push(l):v.push(l);if(0!=m.length||0!=v.length){var C=m.length>v.length;0===v.length&&(C=!1);var I=C?v:m,_="*";for(l=0;l<I.length;l++){g=this.getCellData(I[l],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.formatter&&(r.options.displayFormat||r.options.displayFormatter||r.options.ioFormat)&&(g=r.formatter.unformat(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.useCustomFormatter&&(g=this.getCellData(I[l],"id3")),C&&g===y.filterEmptyStr?_="+":f.push(g)}y.options.useFilterListFormat&&r.useCustomFormatter||(f=y.changeItemValue("value",o,f));var x=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(l=0;l<f.length;l++){var S=f[l];"string"==typeof S&&(f[l]=S.replace(x,(function(t){return y.replacechar(t)})))}var R="";0==m.length?R+="/^[a-z0-9_-]{3,16}$/":R+=C?"^\\n*(?:(?!^"+f.join("$)(?!^")+"$).)"+_+"\\n*$":"^"+f.join("$|^")+"$";var D,T="";(r=y.getCellInfo(o))&&(T=y.getColumnOption(r.options.col_id,"dataType")),D="number"==T?new RegExp(R):new RegExp(R,"gi"),d.f.fireEvent(y._dataList,"onbeforecolumnfilterchange");var L=this.getLength()-2+n;if(m.length<L&&(WebSquare.DataCollection.stopBroadCast=!0),y.dataList.removeColumnFilter(o,{noRefreshAfter:!0}),this.filterHistory.column[0]!==o&&(this.filterHistory.column.unshift(o),this.filterHistory.filteredRowIndexArr.unshift(y._dataList.filteredRowIndexArr.slice(0))),m.length<=L){if(WebSquare.DataCollection.stopBroadCast=!1,C){this.customFilterListFilterInfo[o]=[];for(l=0;l<m.length;l++){g=this.getCellData(m[l],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.formatter&&(r.options.displayFormat||r.options.displayFormatter||r.options.ioFormat)&&(g=r.formatter.unformat(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.useCustomFormatter&&(g=this.getCellData(m[0],"id3")),this.customFilterListFilterInfo[o].push(g)}(r.itemsetObj||r.itemArr)&&(this.customFilterListFilterInfo[o]=y.changeItemValue("value",o,this.customFilterListFilterInfo[o]));for(l=0;l<this.customFilterListFilterInfo[o].length;l++){var k=this.customFilterListFilterInfo[o][l];k===y.filterEmptyStr?this.customFilterListFilterInfo[o][l]="":"string"==typeof k&&(k=k.replace(x,(function(t){return y.replacechar(t)})),this.customFilterListFilterInfo[o][l]=k)}}else this.customFilterListFilterInfo[o]=f;y.dataList.setColumnFilter({type:"regExp",colIndex:s,key:D,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[o];O=y.getElementById(y.id+"_"+i+"_filter");1!==n&&this.getCellData(0,"id1")||WebSquare.style.removeClass(O,"w2grid_customFilter_filter");var F=!0,A=(L=this.getLength()-2+n,this.getAllData());for(l=2-n;l<A.length;l++)if(!A[l].id1){F=!1;break}F?(this.setCellData(1-n,"id1",!0),this.filterHistory.column.shift(),
this.filterHistory.filteredRowIndexArr.shift(),this.listRowObjArr.length!==this.jsonData.length&&WebSquare.style.addClass(O,"w2grid_customFilter_filter")):(this.setCellData(1-n,"id1",!1),WebSquare.style.addClass(O,"w2grid_customFilter_filter")),d.f.fireEvent(y._dataList,"onaftercolumnfilterchange"),y.options.groupbyFilterBox&&(this.isChanged=!0)}}else{for(var E=y._dataList.getFilterList(),M=!1,l=0;l<E.length;l++)if(E[l]&&E[l].colIndex===s&&"func"!==E[l].type){M=!0;break}if(this.listRowObjArr.length!==this.jsonData.length&&M){y.itemValueObj={},y.customFilterStatusObj[i]=!1,delete this.customFilterListFilterInfo[o],y.firstOpenCustomFilter[i]=!1,y.dataList.removeColumnFilter(o);var O=y.getElementById(y.id+"_"+i+"_filter");1!==n&&this.getCellData(0,"id1")||WebSquare.style.removeClass(O,"w2grid_customFilter_filter");for(var N=y.getCustomFilterListJSON({colID:o,headerID:i}),l=2-n;l<N.length;l++)e.push({id1:!0,id2:N[l].id2});this.setJSON(e),y._setFilterListHeight(i,e.length)}else M||e.length-(2-n)!=0||(this.setJSON(this.jsonData),y._setFilterListHeight(i,this.jsonData.length))}},this.customFilterList._inputKeyDown=this.customFilterList.inputKeyDown,this.customFilterList.inputKeyDown=function(t,e){if(9!==(t.charCode?t.charCode:t.keyCode)){var i=this;this.mytime=setTimeout((function(t){i.find()}),100,t)}}),!0===e)return;var b=this.getCustomFilterListJSON({colID:i,headerID:t});if(this.customFilterList.jsonData=b,this.customFilterList.setJSON(b),this.applyFilterListFormat(b,t),this._setFilterListSize({headerID:t,dataLen:b.length,type:"create"}),this.options.useFilterSearch){this.removeFocusedCell();var v=this.customFilterList.getElementById(this.customFilterList.id+"_input");WebSquare.style.getSize(v,"innerwidth"),WebSquare.style.getSize(v,"width");this.customFilterList.dom.input.focus()}else if(this.options.useSearchFilter){this.removeFocusedCell();v=this.customFilterScrollView.getElementById(this.id+"_filter_search_input"),WebSquare.style.getSize(v,"innerwidth"),WebSquare.style.getSize(v,"width");v.focus()}else{var w=this.customFilterList.render.getElementsByTagName("input")[0];w&&w.focus()}this.customFilterList.currentHeaderID=t,this.customFilterList.customFilterListFilterInfo={},this.customFilterList.customFilterListAction=!1,this.customFilterList.customUserFilterListAction=!1;var C=this.getElementById(this.id+"_"+t+"_filter");"false"===C.getAttribute("aria-expanded")&&C.setAttribute("aria-expanded","true");for(var I=(!0===this.options.useFilterSearch?document.getElementById(this.customFilterList.id+"_items_main"):document.getElementById(this.customFilterList.id)).getElementsByClassName("w2grid_customFilter_list_listColumn_text"),_=0;_<I.length;_++){var x=I[_];if(x&&x.textContent===WebSquare.language.getMessage("Grid_Customized_Filter")){x.setAttribute("aria-haspopup","true");break}}WebSquare.style.show(this.customFilterScrollView.render)}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setFilterListSize=function(t){try{var e,i,o=t.headerID,r=t.dataLen,n=t.type,l=this.getElementById(this.id+"_"+o),h=this.options.filterListRowHeight+1,d=(this.options.useFilterSearch?r+1:r)*h-1,p=d;if("height"!=n){var u=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum;if(this.options.useFilterSearch){var c=Math.min(parseInt(this._dataLayerHeight/h),u);this.customFilterScrollViewRenderHeight=c*h}else this.customFilterScrollViewRenderHeight=u*h}var g=WebSquare.style.getSize(this.customFilterScrollView.render,"outerwidth")-WebSquare.style.getSize(this.customFilterScrollView.render,"width"),f=WebSquare.style.getSize(this.customFilterScrollView.render,"outerHeight")-WebSquare.style.getSize(this.customFilterScrollView.render,"height"),m=WebSquare.style.getRelativeTop(l,this.render)+l.offsetHeight+1,y=WebSquare.style.getRelativeLeft(l,this.render),b=0,v=this.getElementById(this.id+"_head_table"),w=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight
;w-=v.offsetHeight,this.options.useSearchFilter&&(b=h);var C=Math.min(this.customFilterScrollViewRenderHeight+b,d+b,w-f),I=this.getElementById(this.id+"_customFilter_scrollView_container");this.options.useFilterSearch?d=C:WebSquare.style.setStyle(I,"overflow-x","auto");var _=this.getElementById(this.id+"_size_y").clientWidth,x=this.getElementById(this.id+"_body_table"),S=WebSquare.style.getSize(x,"outerwidth")-WebSquare.style.getSize(x,"width"),R=this.getElementById(this.id+"_dataLayer").clientWidth-l.offsetLeft-g-S,D=e=this.customFilterList.getMaxItemWidth();if(a.Z.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList))l.clientWidth>e&&(e=l.clientWidth),i=Math.min(R,e),this.options.useSearchFilter||(this.options.useFilterSearch?p>C&&(e+=_,i+=_):C<d&&i+_<=R&&(i+=_)),this.options.useSearchFilter?e>D&&WebSquare.style.setStyle(I,"overflow-x","hidden"):this.options.useFilterSearch&&WebSquare.style.setStyle(I,"overflow-x","hidden");else{var T=parseInt(this.headerInfoHash[o].options.filterListWidth);T>0?e<(i=T-g)&&(e=i):this.options.filterListWidth>0?e<(i=this.options.filterListWidth-g)&&(e=i):(i=l.clientWidth,l.clientWidth>e&&(e=l.clientWidth)),R<i&&(i=R),(this.options.useFilterSearch||e>D)&&WebSquare.style.setStyle(I,"overflow-x","hidden")}"height"!=n&&this.customFilterScrollView.setPosition(y,m-1);var L=0;if(this.options.useSearchFilter){var k=this.customFilterScrollView.getElementById(this.id+"_filter_search_input");L=k.offsetHeight,I.style.height=C-L+"px"}this.customFilterScrollView.setSize(i,C),this.customFilterList.setSize(e,d);var F,A,E=0;if(this.options.useFilterSearch||(I.clientWidth<D?(E=I.offsetHeight-I.clientHeight,this._dataLayerHeight>C+E&&(this.customFilterScrollView.setSize(null,C+E),this.options.useSearchFilter&&(I.style.height=I.offsetHeight+E+"px"))):WebSquare.style.setStyle(I,"overflow-x","hidden")),this.options.useResizeFilterList)this.customFilterScrollView.addClass("w2scrollView_resize"),a.Z.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)?(F=l.clientWidth,A=i):(F=i,A=Math.min(R,e)),this.customFilterScrollView.render.style.minWidth=F+"px",this.customFilterScrollView.render.style.maxWidth=A+"px",this.customFilterScrollView.render.style.minHeight=I.offsetHeight+L+"px",this.customFilterScrollView.render.style.maxHeight=Math.min(this._dataLayerHeight,d+L)+E+"px","create"==n&&(scrollViewObserver=new ResizeObserver((function(t){var e=t[0].contentRect.height-L;I.offsetHeight!=e&&(I.style.height=e+"px")})),scrollViewObserver.observe(this.customFilterScrollView.render))}catch(t){s.Y.printStackTrace(t)}},c.prototype._setFilterListHeight=function(t,e,i){try{var o=i||e;this._setFilterListSize({headerID:t,dataLen:o,type:"height"})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.toggleCustomFilterList=function(t){try{this.customFilterScrollView&&this.customFilterList&&("none"==this.customFilterScrollView.render.style.display||this.customFilterList.currentHeaderID!=t?this.moveCustomFilterList(t):this.hideCustomFilterList())}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.showCustomFilterList=function(t,e){try{if(this.customFilterScrollView&&this.customFilterList){if(e){WebSquare.style.show(this.customFilterScrollView.render),this.options.useResizeFilterList&&(this.customFilterScrollView.render.style.minWidth="",this.customFilterScrollView.render.style.maxWidth="",this.customFilterScrollView.render.style.minHeight="",this.customFilterScrollView.render.style.maxHeight="");var i=t.headerID,o=t.dataLength;this._setFilterListSize({headerID:i,dataLen:o})}var r,a=this.getElementById(this.id+"_customFilter_scrollView_container");if(this.customFilterList.currentHeaderID=i,a.scrollLeft=0,a.scrollTop=0,this.options.useFilterSearch){this.removeFocusedCell(),this.customFilterList.dom.input.value="";var n=this.customFilterList.getElementById(this.customFilterList.id+"_input")
;WebSquare.style.getSize(n,"innerwidth"),WebSquare.style.getSize(n,"width");this.customFilterList.dom.input.focus(),r=document.getElementById(this.customFilterList.id+"_items_main")}else if(this.options.useSearchFilter){this.removeFocusedCell();n=this.customFilterScrollView.getElementById(this.id+"_filter_search_input"),WebSquare.style.getSize(n,"innerwidth"),WebSquare.style.getSize(n,"width"),a.offsetWidth,a.clientWidth;WebSquare.style.getSize(n,"outerwidth")-WebSquare.style.getSize(n,"width"),n.value="",n.focus()}else{var l=this.customFilterList.render.getElementsByTagName("input")[0];l&&l.focus(),r=document.getElementById(this.customFilterList.id)}var h=document.getElementById(this.id+"_"+i+"_filter");"false"===h.getAttribute("aria-expanded")&&h.setAttribute("aria-expanded","true");for(var d=r.getElementsByClassName("w2grid_customFilter_list_listColumn_text"),p=0;p<d.length;p++){var u=d[p];if(u&&u.textContent===WebSquare.language.getMessage("Grid_Customized_Filter")){u.setAttribute("aria-haspopup","true");break}}WebSquare.style.show(this.customFilterScrollView.render)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.moveCustomFilterList=function(t){try{if(this.customFilterScrollView&&this.customFilterList){var e=this.headerToBodyRelation[t];WebSquare.style.show(this.customFilterScrollView.render);var i=this.getCustomFilterListJSON({colID:e,headerID:t});this.customFilterList.jsonData=i,this.customFilterList.setJSON(i),this.applyFilterListFormat(i,t),this.customFilterList.currentHeaderID=t,this.showCustomFilterList({headerID:t,dataLength:i.length},!0)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.hideCustomFilterList=function(){try{if(this.customFilterScrollView&&this.customFilterList){var t=this.getElementById(this.id+"_"+this.headerID+"_filter");"true"===t.getAttribute("aria-expanded")&&t.setAttribute("aria-expanded","false"),t.focus(),WebSquare.style.hide(this.customFilterScrollView.render),this.customFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.customFilterList.isChanged=!1)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.getCustomFilterListJSON=function(t){try{var e;if(this.customFilterList.filterHistory.column[0]!==t.colID||this.options.showAllFilterList)if(this.options.useFilterSearch||this.options.useSearchFilter){var i=this._dataList.getFilterList();if(i.length>0){var o=!1;1==i.length&&this.getColumnID(i[0].colIndex)===t.colID&&(o=!0)}e=o?this._dataList.filterManager.allRowIndexArr:this._dataList.filteredRowIndexArr}else this.options.showAllFilterList?(this.customFilterList.customFilterListFilterInfo,e=this._dataList.filterManager.firstFiltering?this._dataList.filteredRowIndexArr:this._dataList.filterManager.allRowIndexArr):e=this._dataList.filteredRowIndexArr;else e=this.customFilterList.filterHistory.filteredRowIndexArr[0];var r=this.dataList.getColData(t.colID,e),a=this.getCellInfo(t.colID),n=this.getUniqueValueOfArray(r,a.options.dataType),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("");var h,d,p=("select"==a.options.inputType||"text"==a.options.inputType)&&this.options.useFilterListFormat&&a.useCustomFormatter?"customFormatted":"label",u=this.changeItemValue(p,t.colID,n.slice(0)),c=this.customFilterStatusObj[t.headerID]||!1,g=WebSquare.language.getMessage("Grid_Customized_Filter")||"Customized Filter",f=WebSquare.language.getMessage("Grid_checked_all")||"choose all",m=!c;if(!c)if(this.customFilterList.customFilterListFilterInfo&&Object.keys(this.customFilterList.customFilterListFilterInfo).length>0)t.colID in this.customFilterList.customFilterListFilterInfo&&(d=(h=this.customFilterList.customFilterListFilterInfo[t.colID]).slice(0));else if(this.options.showAllFilterList){var y=this._dataList.getFilteredColData(t.colID);d=this.getUniqueValueOfArray(y).slice(0),c||r.length==y.length||(m=!1)}for(var b=[{id1:c,id2:g},{id1:m,id2:f}],v=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,w=this,C=0;C<u.length;C++){
var I={};if(d){var _,x=!1;"string"==typeof(_=a.useCustomFormatter&&a.mainGrid.options.useFilterListFormat?n[C]:a.itemArr?a.itemHash[u[C]]:u[C])&&(_=_.replace(v,(function(t){return w.replacechar(t)})));for(var S=d.length-1;S>-1;S--){if(_==d[S]){x=!0,d.splice(S,1);break}if("string"==typeof d[S]){for(var R=!1,D=0;D<l.length;D++)if(l[D]==d[S]){R=!0;break}if(R&&(u[C]==this.options.useFilterEmptyMsg||u[C]==this.filterEmptyStr)){x=!0;break}}}I.id1=x}else I.id1=!c;var T=u[C],L=n[C];(this.options.useFilterSearch||this.options.useSearchFilter)&&this.options.useFilterListFormat&&a.useCustomFormatter&&(T=this._applyFormatter(a,L)),I.id2=T,(this.options.displayValueOnUseFilterList||this.options.useFilterListFormat&&a.useCustomFormatter)&&(I.id3=n[C]),b.push(I)}var k=0,F=this.headerInfoHash[t.headerID];if(F&&F.options.hideCustomFilter&&(b.shift(),k=1),h){var A=!0,E=b;for(C=2-k;C<E.length;C++)if(!E[C].id1){A=!1;break}b[1-k].id1=!!A}return this._dataList.getDataLength()||(b[1-k].id1=!1),b}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.changeItemValue=function(t,e,i,o){try{var r,n=[],l=!1,h=this.getCellInfo(e),d=h.options.inputType;if("custom"==d&&(h=h.cellManagerHashByRowIndex[h.editRowIndex]?h.cellManagerHashByRowIndex[h.editRowIndex]:h),h.itemHash={},!1===o||(r=h.options.filterDisplayMode?h.options.filterDisplayMode:"label"),h.itemsetObj&&""!=h.itemsetObj.nodeset&&h.itemsetObj.nodeset.wq_replaceAll(" ","").indexOf("data:")>=0&&(!h.itemArr||h.itemArr.length<1)){h.itemArr=[];var p=h.itemsetObj.nodeset.replace("data:",""),u=this.modelControl.getDataComp(p),c=function(t,e){var i=t,o=h.options.delimiter?h.options.delimiter:"";switch(r){case"value delim label":i=e+o+i;break;case"label delim value":i=i+o+e;break;case"value":i=e}return i};if(u&&WebSquare.idCache[u.uuid])switch(u.initializeType){case"linkedDataList":for(var g=[],f={},m=u.getAllNoFilteredData(),y=0;y<u._dataList.getDataLength();y++){var b=m[y*u.cellIdList.length+u.bodyIdColIndexMap[h.itemsetObj.label]],v=m[y*u.cellIdList.length+u.bodyIdColIndexMap[h.itemsetObj.value]];a.Z.isNumber(v)&&(v+=""),f[b]!=v&&(f[b]=v,g.push({orgLabel:b,label:c(b,v),value:v}))}h.itemArr=g;break;case"dataList":for(g=[],f={},y=0;y<u.getDataLength();y++){b=u.getCellData(y,h.itemsetObj.label),v=u.getCellData(y,h.itemsetObj.value);a.Z.isNumber(v)&&(v+=""),f[b]!=v&&(f[b]=v,g.push({orgLabel:b,label:c(b,v),value:v}))}h.itemArr=g;break;case"dataMap":for(g=[],f={},y=0;y<u.getCount();y++){b=u.get(h.itemsetObj.label),v=u.get(h.itemsetObj.value);a.Z.isNumber(v)&&(v+=""),f[b]!=v&&(f[b]=v,g.push({orgLabel:b,label:c(b,v),value:v}))}h.itemArr=g}}if(h.itemArr){if("customFormatted"==t){for(y=0;y<i.length;y++){var w=this._applyFormatter(h,i[y]);n.push(w),h.itemHash[w]=i[y]}return n}var C="label"==t?"value":"label";"label"==t&&!1===o&&h.itemArr.length>0&&h.itemArr[0].orgLabel&&(t="orgLabel");var I=h.itemArr.slice(0);for(y=0;y<i.length;y++){var _=i[y];if(a.Z.isNumber(_)&&(_+=""),"custom"==d)-1==this.modelControl.getDataComp(h.dataComp).dataArr.indexOf(i[y])&&n.push(i[y]);for(var x=I.length-1;x>-1;x--){var S=I[x];if(S[C]==_){n.push(S[t]),I.splice(x,1),"label"==t&&(h.itemHash[S[t]]=S[C]);break}if("label"==t||"orgLabel"==t){if(!_||this.useFilterEmptyValueInfo[_]){l||(l=!0,n.push(this.filterEmptyStr));break}}else if("value"==t&&_==this.filterEmptyStr){for(var R in this.useFilterEmptyValueInfo)n.push(R);break}}}}else{if("customFormatted"==t){for(y=0;y<i.length;y++){w=this._applyFormatter(h,i[y]);n.push(w),h.itemHash[w]=i[y]}return n}for(y=0;y<i.length;y++){if("label"==t){if(!i[y]&&0!==i[y]||this.useFilterEmptyValueInfo[i[y]]){l||(l=!0,n.push(this.filterEmptyStr));continue}}else if("value"==t&&i[y]==this.filterEmptyStr){for(var R in this.useFilterEmptyValueInfo)n.push(R);continue}n.push(i[y]),h.itemHash[i[y]]=i[y]}}return n}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.resizeGridList=function(){try{var t,e;if(this.groupbyFilterList)return;if(!this.customFilterList)return;t=this.customFilterList,
e=this.customFilterScrollView;var i=document.getElementById(this.id+"_"+t.currentHeaderID);if(i){var o,r=i.clientWidth,n=(this.options.useFilterSearch?t.listRowObjArr.length+1:t.listRowObjArr.length)*(this.options.filterListRowHeight+1)-1,l=e.render.clientHeight,h=WebSquare.style.getSize(this.customFilterScrollView.render,"outerwidth")-WebSquare.style.getSize(this.customFilterScrollView.render,"width"),d=WebSquare.style.getRelativeTop(i,this.render)+i.offsetHeight+1,p=WebSquare.style.getRelativeLeft(i,this.render),u=this.getElementById(this.id+"_customFilter_scrollView_container");this.options.useSearchFilter&&WebSquare.style.setStyle(u,"overflow-x","auto");var c=this.getElementById(this.id+"_size_y").clientWidth,g=this.getElementById(this.id+"_body_table"),f=WebSquare.style.getSize(g,"outerwidth")-WebSquare.style.getSize(g,"width"),m=this.getElementById(this.id+"_dataLayer").clientWidth-i.offsetLeft-h-f,y=r=this.customFilterList.getMaxItemWidth();if(a.Z.getBoolean(this.getHeaderInfo(t.currentHeaderID).options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList))this.customFilterList?(i.clientWidth>r&&(r=i.clientWidth),o=Math.min(m,r),this.options.useSearchFilter||(this.options.useFilterSearch?n>l&&(r+=c,o+=c):l<t.render.clientHeight&&o+c<=m&&(o+=c)),this.options.useSearchFilter?r>y&&WebSquare.style.setStyle(u,"overflow-x","hidden"):this.options.useFilterSearch&&WebSquare.style.setStyle(u,"overflow-x","hidden")):this.groupbyFilterList&&(o=r=y);else if(this.customFilterList){var b=parseInt(this.headerInfoHash[t.currentHeaderID].options.filterListWidth);b>0?r<(o=b-h)&&(r=o):this.options.filterListWidth>0?r<(o=this.options.filterListWidth-h)&&(r=o):(o=i.clientWidth,i.clientWidth>r&&(r=i.clientWidth)),m<o&&(o=m),(this.options.useFilterSearch||r>y)&&WebSquare.style.setStyle(u,"overflow-x","hidden")}e.setPosition(p,d-1),t.setSize(r,null),e.setSize(o,l)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.showGroupbyHeaderGhost=function(t,e){try{var i=this.getHeaderValue(e);WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_header_drag",contents:i,delay:15,applyMousePosition:!0,onDrop:function(t,e,i,o,s,r,a){}})}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setAdaptiveColumnVisible=function(t,e){try{if(this.hiddenAdaptiveList[t]==!e||t>=this.hiddenAdaptiveList.length)return;var i=this;function D(t){var e=i.getColumnID(t),o=null!=i.bodyToHeaderRelation[e]?i.getHeaderLayer(i.bodyToHeaderRelation[e]):null;return null!=o?o:D(t-1)}var o=D(t),r=document.getElementsByClassName(this.id+"_columnstyle_"+(t-this.defaultColCnt)+"_"),n=this.getColumnStyleValue(t-this.defaultColCnt,"height");if(null==this.oldOptions.headerColBorder&&null!=o&&(this.oldOptions.headerColBorder=WebSquare.style.getStyle(o,"border-top")),null==this.oldOptions.headerPaddingTop&&null!=o&&(this.oldOptions.headerPaddingTop=WebSquare.style.getStyle(o,"padding-top")),null==this.oldOptions.headerPaddingBottom&&null!=o&&(this.oldOptions.headerPaddingBottom=WebSquare.style.getStyle(o,"padding-bottom")),r.length>0&&""!=this.oldOptions.bodyColBorder&&(this.oldOptions.bodyColBorder=WebSquare.style.getStyle(r[0],"border-top")),this.hasSubtotal)for(var l=0,h=0,d=this.drawedSubtotal[0][0].childNodes,p=0;p<d.length&&((w=parseInt(d[p].getAttribute("colSpan")))||(w=1),!(h<=t&&t<h+w));p++)h+=w,l++;if(this.hasFooter){var u=0,c=0,g=this.htmlInfo.foot.rowArr;for(p=0;p<g.length;p++)for(var f=g[p],m=0;m<f.length;m++){var y=f[m];if((w=parseInt(y.colSpan))||(w=1),c<=t-this.defaultColCnt&&t-this.defaultColCnt<c+w)break;c+=w,u++}}if(e){o.style.height=n,o.style.removeProperty("padding"),o.style.borderTop=this.oldOptions.headerColBorder;for(p=0;p<r.length;p++)r[p].style.height=n,r[p].style.removeProperty("padding"),r[p].style.borderTop=this.oldOptions.bodyColBorder;if(this.setAdaptiveColumnStyle(t,"height",n),this.setAdaptiveColumnStyle(t,"padding",""),this.setAdaptiveColumnStyle(t,"border-top",this.oldOptions.bodyColBorder),
this.hasFooter)for(p=0;p<g.length;p++){y=g[p][u];var b=parseInt(this.getFooterStyle(y.id,"height"))+parseInt(o.offsetHeight);!(w=parseInt(y.colSpan))||parseInt(this.getFooterStyle(y.id,"height"))<=0?(this.setFooterStyle(y.id,"height",o.style.height),this.setFooterStyle(y.id,"padding",o.style.padding),this.setFooterStyle(y.id,"borderTop",o.style.borderTop)):this.setFooterStyle(y.id,"height",b+"px")}if(this.hasSubtotal)for(p=0;p<this.drawedSubtotal.length;p++)for(m=0;m<this.drawedSubtotal[p].length;m++){var v=this.drawedSubtotal[p][m].childNodes;b=parseInt(v[l].style.height)+parseInt(o.offsetHeight);!(w=parseInt(v[l].getAttribute("colSpan")))||parseInt(v[l].style.height)<=0?(v[l].style.height=o.style.height,v[l].style.padding=o.style.padding,v[l].style.borderTop=o.style.borderTop):v[l].style.height=b+"px"}}else{if(this.hasFooter)for(p=0;p<g.length;p++){y=g[p][u],b=parseInt(this.getFooterStyle(y.id,"height"))-parseInt(o.offsetHeight);!(w=parseInt(y.colSpan))||b<=0?(this.setFooterStyle(y.id,"height","0px"),this.setFooterStyle(y.id,"padding","0px"),this.setFooterStyle(y.id,"borderTop","0px")):this.setFooterStyle(y.id,"height",b+"px")}if(this.hasSubtotal)for(p=0;p<this.drawedSubtotal.length;p++)for(m=0;m<this.drawedSubtotal[p].length;m++){var w;v=this.drawedSubtotal[p][m].childNodes,b=parseInt(v[l].style.height)-parseInt(o.offsetHeight);!(w=parseInt(v[l].getAttribute("colSpan")))||b<=0?(v[l].style.height="0px",v[l].style.padding="0px",v[l].style.borderTop="0px"):v[l].style.height=b+"px"}var C=parseInt(o.colSpan,10),I=!1;if(C>1)for(var _=a.Z.getDataPrefix("header_id"),x=this.headerToBodyRelation[o.getAttribute(_)],S=this.getColumnIndex(x),R=S;R<S+C;R++)this.hiddenList[R]||(I=!0);(C<2||!I)&&(o.style.height="0px",o.style.padding="0px",o.style.borderTop="0px");for(p=0;p<r.length;p++)r[p].style.height="0px",r[p].style.padding="0px",r[p].style.borderTop="0px";this.setAdaptiveColumnStyle(t,"height","0px"),this.setAdaptiveColumnStyle(t,"padding","0px"),this.setAdaptiveColumnStyle(t,"border-top","0px")}parseInt(o.colSpan,10)>1&&this.setAdaptiveGridHeaderHeight(),this.hiddenAdaptiveList[t]=!e}catch(T){s.Y.printStackTrace(T,null,this)}},c.prototype.applyFilterHistory=function(){try{if(this.getElementById(this.id+"_groupbyFilterBox_apply").checked=this.groupbyFilterBox_history.length>0,!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var t=this.groupbyFilterBox_select.getSelectedIndex(),e=this.groupbyFilterBox_history[t];if(e.groupbyOptions)this.groupby(JSON.parse(e.groupbyOptions,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:e}catch(t){return e}}))),this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={};else{for(var i in this.groupbyStatus.grouped&&this.clearGroupby(),this._dataList.clearFilter(e.filterOption.length>0),this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.refreshCustomFilterHistory(t),this._dataList.broadcast({gridView:["clearHeaderSort"]}),this._dataList.broadcast({gridView:["notifyMultisort"]})}}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._refreshCustomFilterHistory=function(t,e,i){try{for(var o=t?JSON.parse(t,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):[],r="",a="",n=0;n<o.length;n++){var l=o[n];l.noRefresh=n<o.length-1,l.keepTop=!1,l.internal=!0;var h="";for(var d in l.bodyIdColIndexMap)l.bodyIdColIndexMap[d]===l.colIndex&&(h=d);"sort"!==l.type&&(r=',"'+h+'"'+r,
a=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+a),this._dataList.setFilter(l);var p=this.bodyToHeaderRelation[this._dataList.cellIdList[l.colIndex]],u=this.getElementById(this.id+"_"+p+"_filter");u&&WebSquare.style.addClass(u,"w2grid_customFilter_filter")}r=r.slice(1)+"],",a=a.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var c='{"column":['+r+'"filteredRowIndexArr":['+a;this.customFilterList.filterHistory=JSON.parse(c),this.customFilterList.customFilterListFilterInfo=e?JSON.parse(e,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):{},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),this.customFilterStatusObj=i?JSON.parse(i):{},this.groupbyStatus.grouped||this.drawHeaderSortImages()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.refreshCustomFilterHistory=function(t){try{for(var e=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()],i="",o="",r=0;r<e.filterOption.length;r++){var a=e.filterOption[r];a.noRefresh=r<e.filterOption.length-1,a.keepTop=!1,a.internal=!0;var n="";for(var l in a.bodyIdColIndexMap)a.bodyIdColIndexMap[l]===a.colIndex&&(n=l);"sort"!==a.type&&(i=',"'+n+'"'+i,o=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+o),this._dataList.setFilter(a);var h=this.bodyToHeaderRelation[this._dataList.cellIdList[a.colIndex]],d=this.getElementById(this.id+"_"+h+"_filter");d&&WebSquare.style.addClass(d,"w2grid_customFilter_filter")}i=i.slice(1)+"],",o=o.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var p='{"column":['+i+'"filteredRowIndexArr":['+o;this.customFilterList.filterHistory=JSON.parse(p),e.customFilterListFilterInfo?this.customFilterList.customFilterListFilterInfo=JSON.parse(e.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):this.customFilterList.customFilterListFilterInfo={},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.clearFilterHistory=function(){try{this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!1,this.groupbyFilterBox_history=[],this.groupbyFilterBox_select.removeAll(),this.groupbyStatus.grouped?this.clearGroupby():this._dataList.clearFilter()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.refreshGroupbyFilterBox=function(){try{var t=this._dataList.getFilterList(),e="",i=!(!this.options.customFilterBox||!this.groupbyStatus.groupbyOptions),o=i?"[Groupby] ":"";if(!this.options.customFilterBox&&!this.groupbyStatus.groupbyOptions)return;e+=o,e+="(";for(var r,n=null,l="",h=!0,d=o,p=!1,u=this.options.groupbyFilterBoxLabelSize,c=0;c<t.length;c++){var g="regExp"===(S=t[c]).type,f="func"===S.type&&S.param;if(g||f){h||(e+=" "+S.condition+" ",d+=S.condition),e+="(";var m=this._dataList.cellIdList[S.colIndex],y=this.getHeaderValue(this.bodyToHeaderRelation[m])||m;if(g){var b=this.dataList.getColData(m,this._dataList.filteredRowIndexArr);if((T=this.getUniqueValueOfArray(b)).length<=0){if(a.Z.isNullReg(S.key)){n=m,l=y;break}continue}for(var v=0,w=0;w<T.length;w++){var C=T[w];this.useFilterEmptyValueInfo[C]&&(C=this.filterEmptyStr),v>0&&(v<u&&(e+=" OR "),d+="OR"),v<u&&(e+=y+" = "+C),d+=m+"="+C,v++}v>u&&(e+=" OR ... ("+(v-u)+" omitted)")}else if(f)for(w=0;w<S.param.length;w++){null!=(F=S.param[w]).radio&&(e+=1===F.radio?" OR ":" AND ",d+=1===F.radio?" OR ":" AND ")
;var I="string"==typeof F.auto?F.auto.replace(/[\\](?![\\])/g,""):F.auto;e+=y+" "+this.selectboxItemSet[F.select-1]+" "+I,d+=m+" "+this.selectboxItemSet[F.select-1]+" "+F.auto}e+=")",h=!1}}if(e+=")",n&&(e=o+"("+l+" = NULL)",d=o+n+"_NULL_"),"()"!==e&&e!==o+"()"||(e=o+"ALL",d=o+"_ALL_",p=!0),!p&&this.options.groupbyFilterBoxFormatter){var _=a.Z.getGlobalFunction(this.options.groupbyFilterBoxFormatter,this.scope_id);if("function"==typeof _){var x=[];if(d===o+n+"_NULL_")x.push({header:l,filter:[]});else for(c=0;c<t.length;c++){var S;g="regExp"===(S=t[c]).type,f="func"===S.type&&S.param;if(g||f){m=this._dataList.cellIdList[S.colIndex];var R=this.getHeaderValue(this.bodyToHeaderRelation[m])||m;if(g){var D={header:R,filter:[]},T=(b=this.dataList.getColData(m,this._dataList.filteredRowIndexArr),this.getUniqueValueOfArray(b)),L=[];for(w=0;w<T.length;w++){C=T[w];this.useFilterEmptyValueInfo[C]&&(C=this.filterEmptyStr),L.push(C)}var k=this.getCellInfo(m);D.filter.push({operator:"in",values:L,labels:k.itemsetObj||k.itemArr?this.changeItemValue("label",m,T.slice(0)):L}),x.push(D)}else if(f){for(D={header:R,filter:[]},w=0;w<S.param.length;w++){var F=S.param[w],A={};null!=F.radio&&(A.gate=1===F.radio?"or":"and"),A.operator=this.selectboxItemSet[F.select-1];I="string"==typeof F.auto?F.auto.replace(/[\\](?![\\])/g,""):F.auto;A.values=I;k=this.getCellInfo(m);A.labels=k.itemsetObj||k.itemArr?this.changeItemValue("label",m,[I])[0]:I,D.filter.push(A)}S.param.length>0&&x.push(D)}}}var E=_.call(this,x,i);null!=E&&!1!==E&&(e=E)}}if(!p&&!1===this.groupbyFilterBox_select.setValueNM(d))this.groupbyFilterBox_select.addItem(d,e),this.groupbyFilterBox_select.setValueNM(d),d===o+"_ALL_"?r={filterOption:[],customFilterStatusObj:"{}"}:(r={filterOption:t,customFilterStatusObj:JSON.stringify(this.customFilterStatusObj)},this.groupbyStatus.grouped&&this.groupbyStatus.filter?r.customFilterListFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})):this.customFilterList&&this.customFilterList.customFilterListFilterInfo&&(r.customFilterListFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})))),this.groupbyStatus.groupbyOptions&&(r.groupbyOptions=this.groupbyStatus.groupbyOptions),this.groupbyFilterBox_history.push(r);this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!p}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getMouseColumnIndex=function(t){try{var e=t.colIndex,i=t.offsetX,o=t.offsetLeft,r=t.colSpan;if(i-o<(l=.3*this.colWidthList[e]>10?10:parseInt(.3*this.colWidthList[e],10))&&0!=e)e--;else{for(var a=e-1;a>=0&&!0===this.hiddenList[a];a--)r--;for(var n=0;n<r;n++){var l,h=parseInt(this.colGroup.bodyColList[e+n].style.width,10);if((o+=h)-(l=.3*h>10?10:parseInt(.3*h,10))<i&&i<o+l){e+=n;break}}}return e}catch(t){return s.Y.printStackTrace(t,null,this),e}},c.prototype._useRole=function(){try{return!a.Z.isMobile()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype.setAdaptive=function(){try{var t=this.options.adaptive,e=parseInt(this.options.adaptiveThreshold)||480;for(var i in this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=a.Z._getBrowserWidth()?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}"crosstab"==t&&(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10||(a.Z._getBrowserWidth()<=e?this.addAdaptive():this.removeAdaptive()))}catch(t){s.Y.printStackTrace(t)}},c.prototype.addAdaptive=function(){try{var t,e=this.options.adaptive;for(var i in"crosstab"==e&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=a.Z._getBrowserWidth()?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}if(!this.hasClass(t)){this.oldOptions.visibleRowNum=this.options.visibleRowNum,
this.oldOptions.drawType=this.options.drawType,this.options.visibleRowNum="all",this.options.drawType="virtual",this.adjustDraw(this.lastIndex),this.addClass(t),this.setAdaptiveGridBodyHeight(),this.setAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(var o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}if(this.options.adaptiveSlideHeader){var r=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody");this.slideHeadObj||(this.slideHeadObj={},this.slideHeadObj.render=r,this.slideHeadObj.headTableWidth=r.offsetWidth,this.slideHeadObj.hidden=!1),"absolute"!=this.slideHeadObj.render.style.position?n.scrollWidth>n.clientWidth+this.slideHeadObj.headTableWidth&&(this.slideHeadObj.render.style.position="absolute",this.options.adaptiveSlideHeaderOnScroll||($(this.slideHeadObj.render.firstChild).animate({width:"hide"}),this.slideHeadObj.hidden=!0)):n.scrollWidth==n.clientWidth&&(a.Z.clearTimeout(this.id+"_adaptiveSlideHeader"),this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1)}}catch(t){s.Y.printStackTrace(t)}},c.prototype.removeAdaptive=function(){try{var t;if("crosstab"==this.options.adaptive&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.options.adaptiveSlideHeader&&this.slideHeadObj&&(this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1),this.hasClass(t)){this.options.visibleRowNum=this.oldOptions.visibleRowNum,this.options.drawType=this.oldOptions.drawType;for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);if(this.removeClass(t),this.removeAdaptiveGridBodyHeight(),this.removeAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),this._isBrowserScroll()){if(this._refreshDataChanged(),this._isHybridScroll())document.getElementById(this.id+"_scrollY_div").scrollTop=0}else if(""!=this.options.visibleRowNum){this.focusedCell=[],this.initializeDrawController(),this.dataRowList=[],this.drawedRowLength=0,this.lastDisplayedRow=-1;for(var i=this.getElementById(this.id+"_body_tbody");i.firstChild;)i.removeChild(i.firstChild);if(this.options.senseReader){for(e=0;e<this.adaptiveEmbeddedInputIdList.length;e++)delete this.dom[this.adaptiveEmbeddedInputIdList[e]];this.adaptiveEmbeddedInputIdList=[]}this.drawDataTable(0)}this.event.removeEvent(this.id+"_body_tbody","onscroll")}}catch(t){s.Y.printStackTrace(t)}},c.prototype.doAdaptive=function(){try{if(""!=this.options.adaptive)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="9999999",this.setAdaptive(),this.adaptiveDoneBy="doAdaptive"}catch(t){s.Y.printStackTrace(t)}},c.prototype.undoAdaptive=function(){try{if("doAdaptive"!=this.adaptiveDoneBy)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="1",this.setAdaptive(),this.options.adaptive="",this.options.adaptiveThreshold="",this.adaptiveDoneBy=""}catch(t){s.Y.printStackTrace(t)}},c.prototype.checkRefreshAdaptive=function(){try{var t=!1;if(!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)){var e=WebSquare.BootLoader.fullViewed||!1,i=a.Z.fullViewed||!1;if(!e&&!i&&this.checkAdaptiveGridType()&&(""!=this.options.adaptive||0!=Object.keys(this.hideThresholdObj).length)){var o=this.options.adaptive,n=parseInt(this.options.adaptiveThreshold)||480;"crosstab"==o&&a.Z._getBrowserWidth()<=n&&(t=!0)}}return t}catch(t){s.Y.printStackTrace(t)}},c.prototype.refreshAdaptive=function(t){try{if(!0===this.checkRefreshAdaptive())if(t&&!0===t.simple){
for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);for(var i in this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=a.Z._getBrowserWidth()?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!1)}else this.removeAdaptive(),this.addAdaptive()}catch(t){s.Y.printStackTrace(t)}},c.prototype._applyFormatter=function(t,e){try{var i=a.Z.getGlobalFunction(t.options.customFormatter,this.scope_id),o=e,r=e;if("text"==t.options.inputType)(t.options.displayFormat||t.options.displayFormatter||t.options.ioFormat)&&(r=t.formatter.format(e));else if("select"==t.options.inputType)for(var n=t.itemArr.slice(0),l=0;l<=n.length-1;l++)if(n[l].value==e){r=n[l].label;break}return"function"==typeof(i=a.Z.getGlobalFunction(t.options.customFormatter,this.scope_id))&&(o=i.call(t.mainGrid,o,r)),""!=o?o:this.filterEmptyStr}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getScrollYWidth=function(t){try{var e=0,i=document.getElementById(this.id+"_scrollY_div");if(!0!==this._isBrowserScroll()||this.options.autoFitFixYScroll)e="offsetWidth"===t?i.offsetWidth:this.options.autoFitFixYScroll?this.scrollLayerWidthSize:parseInt(i.style.width,10);else{var o=this.id+"_dataLayer",r=0;!0===this._isHybridScroll()&&(i.offsetWidth>this._getEpsilon()?(o=this.id+"_scrollY_div",r=1):o=this.id+"_main_div");var a=document.getElementById(o);e=a.offsetWidth-a.clientWidth+r}return e}catch(t){return s.Y.printStackTrace(t,null,this),0}},c.prototype._autoFitRefreshNative=function(){try{if(!0===this._isNativeScroll())this._getScrollYWidth()!==this._bScrollYWidth&&this._setAutoFit()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._isBrowserScroll=function(){try{return"native"===this.options.drawType||"hybrid"===this.options.drawType}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._isNativeScroll=function(t){try{return"X"===t?!0===this.options.scrollXNative:"both"===t?"native"===this.options.drawType||!0===this.options.scrollXNative:"native"===this.options.drawType}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._isHybridScroll=function(){try{return"hybrid"===this.options.drawType}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridRowNum=function(){try{return Math.abs(this.options.hybridRowNum)||1}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridVisibleHeightInfo=function(t){try{if(t<=0)return{height:0,cnt:0};var e=document.getElementById(this.id+"_body_tbody").childNodes;isNaN(t)&&(t=this._getHybridRowNum(),this.oneRowLength>1&&(t*=this.oneRowLength));for(var i=0,o=0,r=0,a=0;a<e.length&&t>0;a++){var n=e[a].offsetHeight,l=n>0;if(l&&(i+=n),!this.hasSubtotal||null==e[a].getAttribute("data-subtotal")){if(--t<=0||a>=e.length-1)for(var h=0;h<e[a].childNodes.length;h++){var d=e[a].childNodes[h].clientHeight;if(d>0){o=n-d;break}}l||r++}}return{height:i,cnt:t+r,borderHeight:o}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setHybridVisibleHeight=function(t,e){try{null==t&&(t=this._hybridRowIndex);var i=this._getHybridLastIndex();null==e&&(e=this._getHybridVisibleHeightInfo());var o=e.height,r=this._hybridScrollHash[t];null==r&&(r=this._hybridScrollHeight),this._hybridScrollHash[t]=o;var a=this._hybridScrollDupHeight,n=0;t===i&&(this._hybridScrollDupHeight=this._getHybridDupHeight(),n=this._hybridScrollDupHeight-a);for(var l=0,h=!0,d=0,p=0;p<=i;p++){if(null==this._hybridScrollHash[p]){h=!1;break}d+=this._hybridScrollHash[p]}var u=document.getElementById(this.id+"_size_y"),c=this.getFooterHeight();if(!0!==this._hasHybridScroll()){var g=document.getElementById(this.id+"_body_table"),f=document.getElementById(this.id+"_main_div");l=Math.max(g.offsetHeight,f.offsetHeight-1)+c+this._getHybridScrollXHeight()-u.offsetHeight+1,
this._hybridScrollLastTop=0}else if(!0===h){l=d+document.getElementById(this.id+"_head_table").offsetHeight-u.offsetHeight-this._hybridScrollDupHeight+c+this._getHybridScrollXHeight()+1,this._hybridScrollLastTop=d-this._hybridScrollHash[i]-this._getHybridLastSubtotalHeight()-e.borderHeight}else l=o-r-n;if(0!==l&&!0===this._useHybridScroll()){var m=u.offsetHeight+l;this._setHybridSizeY(m)}return l}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridVisibleTop=function(){try{var t=document.getElementById(this.id+"_scrollY_div"),e=1;return a.Z.isIEAllVersion()||(e=document.getElementById(this.id+"_head_table").offsetHeight),t.scrollTop-e-this._hybridScrollYPos}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._adjustHybridEditedPosition=function(t,e){try{isNaN(e)&&(e=3);var i=document.getElementById(t),o=document.getElementById(this.id+"_head_table").offsetHeight;if(i.offsetTop<o)i.style.top=o+"px";else if(i.offsetTop+i.offsetHeight>this.render.offsetHeight){var r=document.getElementById(this.id+"_scrollX_div").offsetHeight;i.style.top=Math.max(this.render.offsetHeight-i.offsetHeight-r-e,o)+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridLastIndex=function(){try{var t=this.getDataLength(),e=0,i=t;return this.oneRowLength>1&&(i*=this.oneRowLength),i>this._getHybridTrCount()&&(e=Math.max(Math.ceil(t/this._getHybridRowNum())-1,0)),e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._hasHybridScroll=function(){try{if(document.getElementById(this.id+"_body_tbody").offsetHeight<this._getEpsilon())return!1;var t=this.getDataLength(),e=this._getHybridTrCount(),i=this._getHybridRowNum();return this.oneRowLength>1&&(i*=this.oneRowLength,t*=this.oneRowLength),e>i&&t>e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridTrCount=function(){try{var t=document.getElementById(this.id+"_body_tbody").childNodes,e=t.length;if(this.hasSubtotal)for(var i=0;i<t.length;i++)null!=t[i].getAttribute("data-subtotal")&&e--;return e}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridDupHeight=function(){try{if(!0!==this._hasHybridScroll())return 0;var t=this._getHybridRowNum(),e=this.getDataLength(),i=e-Math.floor(e/t)*t,o=0;if(i>0){var r=t-i;this.oneRowLength>1&&(r*=this.oneRowLength),o=this._getHybridVisibleHeightInfo(r).height}return o}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridLastSubtotalHeight=function(){try{var t=0;if(this.hasSubtotal)for(var e=this.lastSubtotalRow;null!=e&&null!=e.getAttribute("data-subtotal");e=e.previousSibling)t+=e.offsetHeight;return t}catch(t){return s.Y.printStackTrace(t,null,this),0}},c.prototype._setHybridYPosition=function(t){try{if(isNaN(t))return;var e=a.Z.isIEAllVersion(),i=e?"_body_table":"_body_tbody",o=document.getElementById(this.id+i);if(!o||!o.style)return;if("relative"!=o.style.position&&(o.style.position="relative;"),o.style.transform="translate3d(0,"+-t+"px,0)",e)for(var r=o.getElementsByTagName("th"),n=0;n<r.length;n++){var l=r[n];"relative"!=l.style.position&&(l.style.position="relative"),l.style.transform="translate3d(0,"+t+"px,0)";var h=parseInt(l.style.zIndex);(h<10||isNaN(h))&&(l.style.zIndex=10)}}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._getHybridWheelDeltaY=function(t){try{var e=t;this._hybridWheelCntY>0?this._hybridWheelCntY++:this._hybridWheelCntY=1;var i=this._hybridWheelCntY/10,o=Math.min(i,1),r=Math.max(i,1);r>1&&a.Z.isMobile()&&(r=1+.1*r),r=Math.min(r,5),e=Math.round(e*(l=o,1-Math.pow(1-l,3))*r);var n=this.uuid;return a.Z.setTimeout((function(){WebSquare.idCache[n]._hybridWheelCntY=0}),{key:this.id+"_getHybridWheelDeltaY",delay:100}),e}catch(e){return s.Y.printStackTrace(e,null,this),t}var l},c.prototype._setHybridWheelDeltaY=function(t){try{var e=document.getElementById(this.id+"_scrollY_div"),i=e.scrollTop+this._getHybridWheelDeltaY(t);e.scrollTop=i}catch(e){return s.Y.printStackTrace(e,null,this),t}},c.prototype._setHybridWheelDeltaX=function(t){try{
var e=document.getElementById(this.id+"_scrollX_right"),i=e.scrollLeft+t;e.scrollLeft=i}catch(t){return s.Y.printStackTrace(t,null,this),deltaY}},c.prototype._getHybridScrollXHeight=function(){try{var t=0,e=document.getElementById(this.id+"_scrollX_div");return null!=e&&(t=e.offsetHeight),t}catch(t){return s.Y.printStackTrace(t,null,this),0}},c.prototype._drawDataHybrid=function(t,e){try{if(!0!==this._isHybridScroll())return this.drawData(t);void 0!==e&&null!=e||(e={});var i=this._getHybridRowNum(),o=this.getDataLength(),r=Math.floor(t/i),a=t-r*i;if(this._hybridRowIndex===r&&!0!==e.redraw)return!1;this._hybridRowIndex=r;var n=Math.min(r*i,o-i);n=Math.max(n,0),this.drawData(n),!0===e.redraw&&this.setScrollYHeightHybrid(),this._setHybridVisibleHeight();for(var l=0,h=0;h<r;h++){l+=null==this._hybridScrollHash[r]?this._hybridScrollHeight:this._hybridScrollHash[r]}if(a>0){this._getHybridVisibleHeightInfo(a);this.oneRowLength>1&&(a*=this.oneRowLength),l+=this._getHybridVisibleHeightInfo(a).height}e={scrollTop:l,maxRepeat:5,skipEndEdit:!0};return document.getElementById(this.id+"_scrollY_div").scrollTop=l,this.handleScrollYHybrid({},e),!0}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._useHybridScroll=function(){try{var t=document.getElementById(this.id+"_main_div"),e=document.getElementById(this.id+"_body_table"),i=this.getFooterHeight();return t.offsetHeight<e.offsetHeight+i}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setHybridSizeY=function(t,e){try{if(!0===this._useHybridScroll()){this.setOverflowYScroll();var i=document.getElementById(this.id+"_size_y");i.offsetHeight!==t&&(i.style.height=t+"px")}else this.setOverflowYHidden()}catch(t){s.Y.printStackTrace(t,null,this)}},c.prototype._setHybridDataLayerTop=function(){try{var t=document.getElementById(this.id+"_dataLayer");0!==t.scrollTop&&(t.scrollTop=0)}catch(t){s.Y.printStackTrace(t,null,this)}};var g=function(){};g.prototype.setTableLayout=function(){try{this.initializeHead(),this.initializeFooter(),this.setDataLayerPosition(),this.arrangeOverflowXScroll(),this.handlerResize_drawInitializer(),this.setTrRowTable(),this.setTrSubtotalRowTable(),this.initialColWidthList=this.colWidthList.slice(),this.initialGridWidth=this.gridWidth,this._setAutoFit(),this.realRowDataLength=this.oneRowDataLength+this.defaultColCnt,this.associateHeaderBody(),this.options.columnMove&&this.createBlockedHeaderInfo(),this.lastDisplayedRow=-1;for(var t=0;t<this.oneRowDataLength;t++){var e=this.cellInfoHash2[this.tdIdList[t]],i=new WebSquare.uiplugin.cellInfo(e,this);"textarea"==i.options.inputType&&(this.isExistTextarea=!0),i.options.colMerge&&(this.isColMerge=!0,a.Z.getBoolean(this.options.colMergeAnd)&&(this.isColMergeAnd=!0),i.options.upperColumn&&(this.upperToLowerColumnRelation[i.options.upperColumn]||(this.upperToLowerColumnRelation[i.options.upperColumn]=[]),this.upperToLowerColumnRelation[i.options.upperColumn].push(i.options.id))),null!=i.options.maxLength&&""!==i.options.maxLength&&(i.options.maxlength=i.options.maxLength),this.cellInfoHash[i.id]=i,this.cellIdList.push(i.id);var o=i.options.hideThreshold;void 0!==o&&(this.hideThresholdObj[i.id]=o)}this.drawFooter(),this.drawHeader();for(var r=0;r<this.thIdList.length;r++){var n=this.headerInfoHash2[this.thIdList[r]];if(n){var l=new WebSquare.uiplugin.headerInfo(n,this);this.headerInfoHash[l.id]=l,this.colMoveHeaderIndexMap[l.id]=r}}}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.setDataLayerPosition=function(){try{var t=this.getElementById(this.id+"_dataLayer");if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table").offsetHeight;e=0==e?this.footerHeight:e,t.style.bottom=e+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.arrangeOverflowXScroll=function(t){try{this.fixedWidth=0;for(var e=this.getFixedColumnLastIndex(),i=0;i<e;i++)this.hiddenList[i]||(this.fixedWidth+=this.colWidthList[i]);this.fixedWidth=parseInt(this.fixedWidth,10)||0,this.fixedWidthRight=0
;var o=this.getFixedRightColumnLastIndex(),r=this.colWidthList.length;for(i=r-1;i>=o;i--)this.hiddenList[i]||(this.fixedWidthRight+=this.colWidthList[i]);if(this.fixedWidthRight=parseInt(this.fixedWidthRight,10)||0,e>this.defaultColCnt||o<r)for(var a=this.getColumnCount(),n=this.data_td_list.length/a,l=0;l<n+1;l++){if(e>this.defaultColCnt){var h=e-this.defaultColCnt;(p=this.data_td_list[l*a+(e-this.defaultColCnt)])&&this.addClass(p,"w2grid_fixedColumn");for(var d=0;d<h;d++){(g=this.data_td_list[l*a+d])&&this.addClass(g,"w2grid_fixedColumn_td")}}if(o<r){var p,u=o-this.defaultColCnt;(p=this.data_td_list[l*a+(o-this.defaultColCnt)])&&this.addClass(p,"w2grid_fixedRightColumn");for(var c=a-1;c>=u;c--){var g;(g=this.data_td_list[l*a+c])&&this.addClass(g,"w2grid_fixedRightColumn_td")}}}if(!0!==t){var f=this.getElementById(this.id+"_scrollX_div"),m=this.getElementById(this.id+"_scrollX_table"),y=0===f.offsetWidth?0:f.offsetWidth-m.offsetWidth,b=this.getElementById(this.id+"_scrollX_left"),v=this.getElementById(this.id+"_scroll_size"),w=this.getElementById(this.id+"_scrollX_fixedRight");b.style.width=this.fixedWidth+"px",v.style.width=this.gridWidth-this.fixedWidth-this.fixedWidthRight-y+"px",w.style.width=this.fixedWidthRight+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.handlerResize_drawInitializer=function(){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;if(this.setOverflowY(),this.setOverflowX(),this.setIE6Fix(),this.options.headFiller){var t=this.getElementById(this.id+"_header_bg_td"),e=this.getElementById(this.id+"_dataLayer").offsetWidth-1,i=this.getElementById(this.id+"_head_table").offsetHeight,o=e,r=i;for(t.style.width=e+"px";t.offsetWidth!=o;)t.offsetWidth>o?e--:e++,t.style.width=e+"px";for(t.style.height=i+"px";t.offsetHeight!=r;)t.offsetHeight>r?i--:i++,t.style.height=i+"px"}if(this.options.groupbyZone){var a=this.getElementById(this.id+"_main_div"),n=this.groupbyZoneStatus.groupbyZoneRender?this.groupbyZoneStatus.groupbyZoneRender.offsetHeight:0;if(this.isIE6or7&&(a.style.height=a.offsetHeight-n),this.options.groupbyFilterBox){var l=this.getElementById(this.id+"_groupbyFilterBox_div"),h=this.getElementById(this.id+"_groupbyFilterBox_buttons");if(this.isIE6or7){a.style.height=a.offsetHeight-(this.scrollLayerWidthSize+l.offsetHeight)-3+"px",h.style.left=-h.offsetWidth;var d=this.scrollLayerWidthSize+l.offsetHeight+n,p=Math.ceil(d/this.oneRowScrollHeight),u=this.getElementById(this.id+"_scrollY_div");this.lastIndex>-1&&this.lastIndex>p&&u.offsetHeight<u.scrollHeight&&this.cutGridBottom(this.lastIndex-p)}else"bottom"===this.options.groupbyFilterBoxLocation&&(a.style.bottom=this.scrollLayerWidthSize+l.offsetHeight+"px",a.style.height="")}else this.isIE6or7&&this.cutGridBottom(this.lastIndex-Math.ceil(n/this.oneRowScrollHeight))}}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.setIE6Fix=function(){try{var t=this.options.fixPrint&&(a.Z.isIE(9)||a.Z.isIE(10)||r.I.browserCheck.ieAllVersion&&"11"==document.documentMode||a.Z.isFF());if(this.isIE6or7||a.Z.isOpera()||t){var e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_scrollY_div"),o=this.getElementById(this.id+"_main_div"),n=this.render.offsetHeight-e.offsetHeight,l=this.render.offsetWidth-i.offsetWidth+2;n=n<0?0:n,l=l<0?0:l,o.style.height=n+"px",o.style.width=l+"px";var h,d=0;if(this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d),""!==this.options.visibleRowNum){var p=this.getElementById(this.id+"_body_table");h=!this.defaultDataLayerHeight||p.offsetHeight>this.defaultDataLayerHeight?p.offsetHeight+d:this.defaultDataLayerHeight+d}else h=n-d-1;h=h<0?0:h;var u=this.getElementById(this.id+"_dataLayer");u.style.height=h+"px",this.dataLayerHeight=h;var c=this.getElementById(this.id+"_scrollX_right");c.style.width=c.parentNode.offsetWidth+"px",t&&(o.style.position="relative",o.style.bottom="",o.style.right="",u.style.position="relative",u.style.bottom="")}
}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype._setOverflowXNative=function(t){if(!0===this._isBrowserScroll()){var e=document.getElementById(this.id+"_scrollX_div"),i=document.getElementById(this.id+"_dataLayer");if(!1===t||this.options.fixedColumn<=0&&this.options.fixedRightColumn<=0)return e.style.visibility="hidden",void(i.style.overflowX="auto");!0===t&&(e.style.visibility="visible",i.style.overflowX="hidden")}},g.prototype.setOverflowX=function(t){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowX=t):e=!1,t=this.isMobile?"hidden":this.options.overflowX){case"auto":this.setOverflowXAuto();break;case"hidden":this.setOverflowXHidden();break;default:this.setOverflowXScroll()}this.isMobile&&this.setIScrollX(),e&&this.setIE6Fix()},g.prototype.setOverflowXAuto=function(){var t=this.getElementById(this.id+"_scrollX_div"),e=this.getElementById(this.id+"_scrollX_left"),i=this.getElementById(this.id+"_scrollX_right"),o=e.offsetWidth;if(this.options.fixedRightColumn){var s=this.getElementById(this.id+"_scrollX_fixedRight");s&&(o+=s.offsetWidth)}i.firstChild.offsetWidth>t.offsetWidth-o?this.setOverflowXScroll():this.setOverflowXHidden()},g.prototype.setOverflowXScroll=function(){try{var t=(l=this.getElementById(this.id+"_scrollX_div")).style.height;if(l.style.height=this.scrollLayerWidthSize+"px",this.options.scrollFocus){var e=this.getElementById(this.id+"_scrollX_right"),i=this.getElementById(this.id+"_scrollX_left");e.setAttribute("aria-hidden","true"),e.firstChild.offsetWidth>l.offsetWidth-i.offsetWidth?e.setAttribute("tabIndex","0"):e.setAttribute("tabIndex","-1")}var o=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"===t&&!o&&!0!==this._isBrowserScroll())if(""!==this.options.visibleRowNum){var r=parseInt(this.render.style.height,10);this.setSize(null,r+this.scrollWidthSize)}else{this.dataLayerHeight-=this.scrollWidthSize;var a=this.dataRowList[(this.lastIndex+1)*this.oneRowLength-1];a&&a.offsetTop+a.offsetHeight>this.dataLayerHeight&&(this._setRowDisplay(this.lastIndex,"none"),this.lastIndex=this.lastIndex-1,this.maxRowLength=this.maxRowLength-1,this.lastDisplayedRow=this.lastIndex,this.lastTopRowIndex=null,this.setScrollYHeight({noDraw:!0}),this.setOverflowYAuto())}if(!this.isIE6or7){var n=this.getElementById(this.id+"_main_div"),l=this.getElementById(this.id+"_scrollX_div"),h=parseInt(l.style.height,10);if(n.style.bottom=h+"px",this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation){var d=this.getElementById(this.id+"_groupbyFilterBox_div");n.style.bottom=this.scrollLayerWidthSize+d.offsetHeight+"px"}}if(o)(d=this.getElementById(this.id+"_groupbyFilterBox_div")).style.bottom=this.scrollLayerWidthSize+"px"}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.setOverflowXHidden=function(){try{var t=this.getElementById(this.id+"_scrollX_div"),e=t.style.height;if(t.style.height="0px",this.options.scrollFocus){var i=this.getElementById(this.id+"_scrollX_right"),o=this.getElementById(this.id+"_scrollX_left");i.setAttribute("aria-hidden","true"),i.firstChild.offsetWidth>t.offsetWidth-o.offsetWidth?i.setAttribute("tabIndex","0"):i.setAttribute("tabIndex","-1")}"0px"!=e&&this.handleScrollX();var r=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"!==e&&!r&&!0!==this._isBrowserScroll())if(""!==this.options.visibleRowNum){var a=parseInt(this.render.style.height,10);this.setSize(null,a-this.scrollWidthSize)}else{this.dataLayerHeight+=this.scrollWidthSize,this.maxRowLength=this.maxRowLength+1;var n=this.getDataLength();this.maxRowLength>=n&&(this.getElementById(this.id+"_size_y").style.height="0px"),this.setOverflowYAuto(),this.drawData(this.rowIndex,this.lastIndex);for(var l=0;l<this.tdIdList.length;l++){var h=this.cellInfoHash[this.tdIdList[l]];if(h.dataComp){
var d=this.modelControl.getDataComp(h.dataComp);"linkedDataList"===d.initializeType&&d.syncWithParent()}}this.lastTopRowIndex=null}var p=this.getElementById(this.id+"_main_div");if(this.isIE6||(p.style.bottom="0px"),r)this.getElementById(this.id+"_groupbyFilterBox_div").style.bottom="0px"}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.setOverflowY=function(t){if(!0!==this._isBrowserScroll()){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowY=t):e=!1,t=this.isMobile?"hidden":this.options.overflowY){case"auto":this.setOverflowYAuto();break;case"hidden":this.setOverflowYHidden();break;default:this.setOverflowYScroll()}this.isMobile&&this.setIScrollY(),e&&this.setIE6Fix()}},g.prototype.setOverflowYAuto=function(){if(!0!==this._isBrowserScroll()){var t=this.getElementById(this.id+"_scrollY_div");t.offsetHeight<t.scrollHeight?this.setOverflowYScroll():this.setOverflowYHidden()}},g.prototype.setOverflowYScroll=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_main_div"),o=parseInt(t.style.width,10);if(t.style.width=this.scrollLayerWidthSize+"px",t.style.overflowY="scroll",this.isIE6){var s=this.render.offsetWidth-this.scrollWidthSize;e.style.width=(s>0?s:0)+"px",t.style.height=this.render.offsetHeight+"px"}else i.style.right=this.scrollWidthSize-1+"px",e.style.right=this.scrollWidthSize+"px";this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);0==o&&!0!==this._setOverflowYScrollFlag&&(this._setOverflowYScrollFlag=!0,this._setAutoFit(),this._setOverflowYScrollFlag=!1),this.options.scrollFocus&&(t.setAttribute("aria-hidden","true"),t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1"))},g.prototype.setOverflowYHidden=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=parseInt(t.style.width,10);t.style.width="0px",t.style.overflowY="hidden";var i=this.getElementById(this.id+"_main_div");this.isIE6||(i.style.right="0px",this.getElementById(this.id+"_scrollX_div").style.right="0px");this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);if(0!=e&&!0!==this._setOverflowYHiddenFlag&&(this._setOverflowYHiddenFlag=!0,this._setAutoFit(),this._setOverflowYHiddenFlag=!1),this.options.scrollFocus&&(t.setAttribute("aria-hidden","true"),t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1")),!0===this._isHybridScroll()){var o=document.getElementById(this.id+"_size_y"),s=t.offsetHeight;o.offsetHeight!==s&&(o.style.height=s+"px")}},g.prototype.setTrRowTable=function(){try{this.tempDiv=document.createElement("div"),this.tempDiv.style.width="0px",this.tempDiv.style.height="0px",this.tempDiv.style.overflow="hidden",this.tempDiv.innerHTML="<table id='tempTable' style='table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.htmlInfo.body,"tbody","td",this.options.bodyTdClass)+"</table>",this.tempTr=this.tempDiv.getElementsByTagName("table")[0];var t=this.tempTr.getElementsByTagName("td");this.aria_labelledby=[];for(var e=0;e<t.length;e++)this.aria_labelledby[e]=t[e].getAttribute("aria-labelledby"),t[e].innerHTML="";this.tempDiv.id=this.id,this.tempDiv.className=this.options.className+" w2grid",this.render.parentNode.appendChild(this.tempDiv);var i,o=this.tempDiv.getElementsByTagName("tbody")[0],r=o.getElementsByTagName("tr")[0];0==(i=r?r.offsetHeight:o.offsetHeight)?(i=-1!=this.options.defaultCellHeight?this.options.defaultCellHeight:20,this._visibleRowNumFixResetFlag=!0):this._visibleRowNumFixResetFlag=!1,this.oneRowHeight=i+(a.Z.isIE(6)||a.Z.isIE(7)?1:0),this.options.scrollRowHeight&&(this.oneRowScrollHeight=this.oneRowHeight),this.render.parentNode.removeChild(this.tempDiv)}catch(t){s.Y.printStackTrace(t,null,this)}},
g.prototype.setTrSubtotalRowTable=function(){try{for(var t in this.subtotalTableList={},this.subtotalStrList){var e=document.createElement("div");e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",this.subtotalClassList&&this.subtotalStrList[t].attr?e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.subtotalStrList[t].attr.subtotalClass)+"</table>":e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.options.subtotalTdClass)+"</table>";for(var i=e.getElementsByTagName("table")[0],o=i.getElementsByTagName("td"),r=a.Z.getDataPrefix("or_wd"),n=a.Z.getDataPrefix("width"),l=!0===this._isHybridScroll(),h=0;h<o.length;h++){var d=o[h],p=d.getAttribute(n);p&&(d.removeAttribute(n),d.setAttribute(r,p)),l&&this.defaultColCnt,this.setConfigOptions(d,"subtotal")}this.subtotalTableList[t]=i}}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype._setAutoFit=function(t){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;this.autofitDone=!0;var e=(t=t||{}).type?t.type:this.options.autoFit;"none"!==e&&e||(e="clear");var i=t.exceptCol,o=t.exceptWidth||0,r=this._getScrollYWidth();!0===this._isNativeScroll()&&(this._bScrollYWidth=r);var n=this.render.clientWidth;a.Z.isIEAllVersion()&&(n=this.render.clientWidth||parseInt(this.render.style.width,10)||parseInt(WebSquare.style.getComputedStyle(this.render,"width"),10)),this.autofit_clientWidth=n;for(var l=0,h=this.colWidthList.length-1;h>=0;h--)if(0==this.hiddenList[h]){l=h;break}if("selectedColumn"==e&&!this.autofitColumn){if(this.gridWidth>=n)return;this.autofitColumn=!0;var d=this.defaultColCnt+t.colIndex;this.gridWidth-=this.colWidthList[d],this.autofitColumnIndexArr.push(d),this.colWidthList[d]="*",this.autofitColumnWidthArr[d]="*"}if(this.autofitColumn){var p=n,u=this.autofitColumnIndexArr.slice();r>0&&(p-=r);for(h=u.length-1;h>=0;h--){var c=u[h];1!=this.hiddenList[c]&&c!==i||u.splice(h,1)}var g=0,f=[];for(h=0;h<this.colWidthList.length;h++)if(1!=this.hiddenList[h])if(h===i)this._setColumnWidth(h,o),p-=o;else if(h<this.autofitColumnWidthArr.length&&this.autofitColumnWidthArr[h]){var m=this.autofitColumnWidthArr[h].substring(0,this.autofitColumnWidthArr[h].indexOf("*"));m.length>0?f.push(parseInt(m,10)):0==m.length&&f.push(1)}else p-=this.colWidthList[h];var y=function(t){if(!t.length)return 0;for(var e,i=t.length-1,o=t[i];i;)for(var s=t[--i];e=s%o;s=o,o=e);return o}(f);for(h=0;h<f.length;h++)f[h]=f[h]/y,g+=f[h];var b=Math.floor(p/g),v=p-b*g;for(h=0;h<u.length;h++){var w=this.options.autoFitMinWidth||0,C=b*f[h];f[h]=Math.max(C,w)}if(v>0)if(1==u.length)f=[p];else{var I=f.slice();for(h=v;h>0;h--){for(var _={},x=0;x<f.length;x++)if(1!=this.hiddenList[u[x]]){var S=Math.abs((I[x]-(f[x]+1))*(this.gridWidth/I[x]));(null==_.distortion||_.distortion>S)&&(_.distortion=S,_.index=x)}f[_.index]++}}for(var R=0;R<f.length;R++)this._setColumnWidth(u[R],f[R])}if("lastColumn"==e){this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth,this.orgLastWidth=this.colWidthList[l],this.orgLastVisibleCol=l),"number"==typeof i&&i!=l&&(this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o));var D=n-r-this.gridWidth+this.colWidthList[l];D>this.orgLastWidth?this._setColumnWidth(l,D):this._setColumnWidth(l,this.orgLastWidth)}else if("allColumn"==e){if(!this.autofitColumn){var T=this.autoFitColWidthList||this.colWidthList,L=n-r,k={};if(this.options.keepDefaultColumnWidth)for(h=0;h<this.defaultColCnt;h++)k[h]=!0;for(h=this.defaultColCnt;h<T.length;h++)!1===this.isColumnResizable(h)&&(this.hiddenList[h]||(k[h]=!0));w=parseInt(t.minWidth?t.minWidth:this.options.autoFitMinWidth,10);for(var F in!isNaN(w)&&w>L&&(L=w),L-=o,k)L-=this.colWidthList[F];var A=0;for(h=0;h<T.length;h++)A+=this.hiddenList[h]||h===i||k[h]?0:T[h]
;var E=0,M=A?L/A:0,O=[];if(M){for(h=0;h<T.length;h++)if(h==i)this.colWidthList[h]=o;else if(k[h]);else{O[h]=M*T[h];var N=Math.round(O[h]);this.colWidthList[h]=N,E+=this.hiddenList[h]?0:N}var H=L-E,G=H>0?1:-1;for(h=0;h<H*G;h++){var B={};for(x=0;x<T.length;x++)if(!this.hiddenList[x]&&x!=i&&!k[x]){S=Math.abs(O[x]-(this.colWidthList[x]+G))*(E/this.colWidthList[x]);(null==B.value||B.value>S)&&(B.value=S,B.index=x)}this.colWidthList[B.index]+=G,E+=G}if(this.hiddenList[0]&&a.Z.isIE(8))for(h=0;h<this.colWidthList.length;h++)if(!this.hiddenList[h]){this.colWidthList[h]=this.colWidthList[h]-2;break}}for(var F in this.autoFitColWidthList||(this.autoFitColWidthList=this.colWidthList.slice(0)),this.gridWidth=E+o,k)this.gridWidth+=this.colWidthList[F];this.arrangeOverflowXScroll();var W="";this.options.autoFitMinWidth||(W="hidden"),this.setOverflowX(W),this.scrollXPreventEndEdit=!0,this.handleScrollX(),this.scrollXPreventEndEdit=!1,this.handlerResize_drawInitializer()}if(!this.groupbyStatus.grouped)for(h=0;h<this.oneRowDataLength;h++){var V=this.getCellInfo(h);"text"!=V.options.inputType&&"secret"!=V.options.inputType&&"calendar"!=V.options.inputType||!V.options.embeddedInput||!this.options.autoResizeEmbeddedInput&&"calendar"!=V.options.inputType||this.hiddenList[h]||(this.embeddedWidthObj[h]&&(this.embeddedWidthObj[h].isChanged=!0),this.drawColumnData(h))}}else"clear"==e&&"number"==typeof i&&(this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth),this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o))}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.setAutoFit=function(t){try{t&&(this.options.autoFit=t.type),this._setAutoFit(t)}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.clearAutoFit=function(t){try{this.options.autoFit="",-1===this.initialColWidthList.indexOf("*")&&(this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autoFitColWidthList=null,this.gridWidth=this.initialGridWidth,this.colWidthList=this.initialColWidthList.slice(),this.arrangeOverflowXScroll(),this.setOverflowX("auto"),this.handleScrollX())}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.autoFitFunc=function(){this.autofit_clientWidth===this.render.clientWidth?r.I.clearTimer(this.id+"_autofit"):r.I.setTimer(this._setAutoFit,{key:this.id+"_autofit",caller:this,delay:100})},g.prototype.setIScrollX=function(){try{if(!0===this.options.scrollXNative)return;var t=this.getElementById(this.id+"_iScrollX");if(!t)return;var e=this.getElementById(this.id+"_scrollX_right");if(e.offsetWidth>=e.firstChild.offsetWidth)return void(t.style.visibility="hidden");var i=this.getElementById(this.id+"_dataLayer"),o=parseInt(this.getElementById(this.id+"_scrollX_left").style.width,10),r=e.firstChild.offsetWidth-e.offsetWidth,a=parseInt(e.offsetWidth*e.offsetWidth/e.firstChild.offsetWidth,10);t.style.width=(a<30?30:a)+"px",t.style.left=o+e.scrollLeft/r*(i.offsetWidth-o-t.offsetWidth)+"px",t.style.visibility=""}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.setIScrollY=function(){try{if(!0===this._isBrowserScroll())return;var t=this.getElementById(this.id+"_iScrollY");if(!t)return;var e=this.getDataLength(),i=this.rowIndex,o=this.getElementById(this.id+"_size_y").parentNode.offsetHeight;if(0==o&&(o=parseInt(this.getStyleValue("height"))),-1==i||0==i&&i+this.lastIndex+1==e){var r=!this.hasSubtotal;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var a=this.drawedSubtotal[this.drawedSubtotal.length-1];if(a.rowIndex==e-1)"none"!=a[a.length-1].style.display&&(r=!0)}if(r)return void(t.style.visibility="hidden")}var n=this.getElementById(this.id+"_scrollY_div"),l=n.firstChild.offsetHeight,h=this.getElementById(this.id+"_dataLayer"),d=l-h.offsetHeight,p=parseInt(h.offsetHeight*h.offsetHeight/l,10);t.style.height=(p<30?30:p)+"px",t.style.top=n.scrollTop/d*(h.offsetHeight-t.offsetHeight)+"px",t.style.visibility=""}catch(t){s.Y.printStackTrace(t,null,this)}},g.prototype.createBlockedHeaderInfo=function(){try{
this.columnBlock={info:{},hash:{}};for(var t=[],e=this.getColCnt(),i=0;i<e;i++)t.push(1);for(var o in this.struct){var r;if("subtotalArr"===o)r=this.struct[o][0].rowArr;else{if(!this.struct[o]||!this.struct[o].rowArr)continue;r=this.struct[o].rowArr}for(var a=0;a<r.length;a++)for(var n=0,l=0;l<r[a].length;l++){var h=parseInt(r[a][l].colSpan,10)||1;for(i=1;i<h;i++)t[n+i]=0;n+=h}}var d=0;for(i=0;i<t.length;i++){var p=t[i];1===p?(this.columnBlock.info[i]=[i],this.columnBlock.hash[i]=i,d=i):0===p&&(this.columnBlock.info[d].push(i),this.columnBlock.hash[i]=d)}}catch(t){s.Y.printStackTrace(t,null,this)}};var f=function(){};f.prototype.initializeEvent=function(){try{if(this.otherClickEvent(),this.checkResize(),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblClickEvent)),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),a.Z.isIEAllVersion()){if(a.Z.isIEAllVersion()){if(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||d.f.preventDefault(t)}))),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||d.f.preventDefault(t)}))),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,(function(t){this.options.preventPaste&&!this.editedCell&&"native"!==this.options.copyType&&d.f.preventDefault(t)}))),!0===this.options.noSelect)document.getElementById(this.id+"_main_div").onselectstart=function(t){if(a.Z.isIEAllVersion()&&t&&t.srcElement){var e=t.srcElement;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName)return!0}return!1};else!0===this.options.preventCopy&&(this.render.onselectstart=function(){return!1})}}else r.I.browserCheck.safari?(this.event.addListener(WebSquare.getBody().render,"onbeforecopy",this.event.bindAsEventListener(this,this.handleBeforeCopyEvent)),this.event.addListener(WebSquare.getBody().render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(WebSquare.getBody().render,"onbeforecut",this.event.bindAsEventListener(this,this.handleBeforeCutEvent)),this.event.addListener(WebSquare.getBody().render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent))):!1===a.Z.isExecCommandSupported()&&(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent)));this.isMobile||(this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollX_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)),this.options.useMoreButton&&this.event.addListener(this.getElementById(this.id+"_grid_more_button"),"onclick",this.event.bindAsEventListener(this,(function(t){WebSquare.event.fireEvent(this,"onscrollend")}))),this.hasFooter&&this.event.addListener(this.getElementById(this.id+"_foot_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)));var t=this.isHammerEnabled();if(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"oncontextmenu",this.event.bindAsEventListener(this,this.clickRightButtonCell)),
t||(this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.gridOut)),this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseout",this.event.bindAsEventListener(this,this.gridHeaderOut))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeyDownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyUpEvent)),a.Z.isOpera()&&this.event.addListener(this.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||d.f.preventDefault(t)})),this.options.dataDragDrop||this.options.dataDragDropSelf)if(1==this.isMobile){if(t){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}}else this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0;else this.options.dataDragDrop||this.options.dataDragDropSelf||!this.options.dataDragSelect||this.isMobile||this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.handleDragSelectEvent));if(r.I.setTimer((function(){this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(t){var e=WebSquare.getBody().getLayerListener();if(e.layers[this.id]){for(var i=e.layers[this.id].component,o={};i.parentControl;)for(var s in i=i.parentControl,e.useOtherComponentId)e.useOtherComponentId[s]==i.id&&(o[s]=!0);WebSquare.getBody().getLayerListener().hideAll(o)}this.parentControl&&this.parentControl.options&&("gridItemTable"==this.parentControl.options.pluginName||"gridViewItemTable"==this.parentControl.options.pluginName)||d.f.stopPropagation(t)})))}),{key:this.id+"initializeEvent",caller:this,delay:100}),!0===this._isBrowserScroll()&&this.options.scrollXNative||(a.Z.isTouchDevice()&&!window.navigator.msPointerEnabled?(this.iScroll={},this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,this.handleTouchStart)),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"ontouchend",this.event.bindAsEventListener(this,this.handleTouchEnd))):window.navigator.msPointerEnabled&&-1!=window.navigator.userAgent.toLowerCase().indexOf("touch")?(this.iScroll={},this.render.style.touchAction="none",this.event.addListener(this.render,"onMSPointerDown",this.event.bindAsEventListener(this,this.handleTouchStart)),this.event.addListener(this.render,"onMSPointerMove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"onMSPointerUp",this.event.bindAsEventListener(this,this.handleTouchEnd))):!0===this._isBrowserScroll()||(this.options.senseReader?(this.options.useStartEndDiv&&(this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onfocus",this.event.bindAsEventListener(this,this.handleStartDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleStartDivKeyDown)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onfocus",this.event.bindAsEventListener(this,this.handleEndDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeyup",this.event.bindAsEventListener(this,this.handleEndDivKeyUp))),
this.options.scrollFocus?this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)):this.options.useStartEndDiv&&this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleEndDivKeyDown))):this.options.scrollFocus&&this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)))),t&&!this._bindPressEvent)try{e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.render),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){if(!o._bindPressEvent){for(var e,i=d.f.getTarget(t),s=-1;i&&"BODY"!=i.tagName;){if("TD"==i.tagName&&o.hasClass(i,o.options.bodyTdClass)){s=o.getElemRowIndex(i),e=i;break}i=i.parentNode}o.removeFocusedCell(),o._dataList.setRowPosition(s),e&&o.__setFocusedCell({},e,{editMode:"none"}),o.handleDblClickEvent(t),d.f.fireEvent(o,"ondblclick",t)}})))}))}catch(t){s.Y.printStackTrace(t,null,this)}if(this._isNativeScroll("both")){var o=document.getElementById(this.id+"_dataLayer");i=this.uuid;o&&(o.onscroll=function(t){var e=WebSquare.idCache[i];e._endEdit();var o=document.getElementById(e.id+"_dataLayer"),s=o.scrollTop,r=o.offsetHeight,a=o.scrollLeft;e._nativeScrollInfo||(e._nativeScrollInfo={x:0,y:0});var n=a-e._nativeScrollInfo.x,l=s-e._nativeScrollInfo.y;if(Math.abs(l)>0&&!0===e._isNativeScroll()){if(WebSquare.util.isIEAllVersion())for(var h=document.getElementById(e.id+"_head_table").getElementsByTagName("th"),p=s+"px",u=0;u<h.length;u++){var c=h[u];"relative"!=c.style.position&&(c.style.position="relative"),c.style.top=p}r+s>=o.scrollHeight&&d.f.fireEvent(e,"onscrollend"),d.f.fireEvent(e,"onscrolly",t)}Math.abs(n)>0&&!0===e.options.scrollXNative&&d.f.fireEvent(e,"onscrollx",t),e._nativeScrollInfo={x:a,y:s}})}this.initializeLayoutEvents(),n.q.addCheckResize(this.uuid,"checkResize")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleStartDivFocus=function(t){try{if(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[],"true"!==this.options.keepScrollForSenseReader&&!0!==this._isBrowserScroll()){var e=this.getElementById(this.id+"_scrollY_div"),i=this.getElementById(this.id+"_size_y");i&&i.offsetHeight>0&&(this.addGridScroll(0-this.rowIndex),0!=e.scrollTop&&this.addGridScroll(0-this.rowIndex)),this._dataList.setRowPosition(-1)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleEndDivFocus=function(t){this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[]},f.prototype.handleScrollDivKeyDown=function(t){if(t.shiftKey&&9==t.keyCode){for(var e=this.getRowCount()-1,i=this.getRightMostFocusableColIndex(e);e>=0&&null==i;)e-=1,i=this.getRightMostFocusableColIndex(e);if(null!==i){var o=this.getCellInfo(i),s=0;if("radio"===o.options.inputType){var r=this.getCheckedIndex(o.colID)[0];r>0&&(s=r),this._setFocusedCell(s,i,!1,{tabDirection:"left"}),d.f.stopEvent(t)}else this.options.senseReader&&"link"===o.options.inputType&&(null==this.focusedCell||this.focusedCell&&0==this.focusedCell.length)&&(s=this.rowIndex+this._getVisibleLastIndex(this.lastIndex),this._setFocusedCell(s,i,!1,{tabDirection:"left"}),d.f.stopEvent(t))}}else switch(t.keyCode){case 38:case 40:case 9:d.f.stopPropagation(t)}},f.prototype.handleStartDivKeyDown=function(t){try{if("Tab"===t.key)if(t.shiftKey){if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID){var e=a.Z.getPreTabbableComp(this.id);e&&e.focus(t),d.f.preventDefault(t)}}else t.shiftKey||9!=t.keyCode||this._lastHeaderElementId||this._setFirsCellFocus(t)}catch(t){s.Y.printStackTrace(t,null,this)}},
f.prototype.handleEndDivKeyDown=function(t){try{if(9==t.keyCode)if(t.shiftKey){if("none"===this.options.focusMode)return;var e=this.getElementById(this.id+"_main_div").offsetHeight,i=parseInt(this.getElementById(this.id+"_size_y").style.height,10)-e,o=this.getElementById(this.id+"_scrollY_div").scrollTop,r=this._getEpsilon();if(o<i&&(o=Math.min(Math.round(o)+r,i)),i!=o){for(var n=0,l=0;l<this.getRowCount();l++)n+=this.getHasSubtotalCount(l);this.addGridScroll(this.getRowCount()-this.rowIndex-this.lastIndex-1+n)}for(var h=this.getRowCount()-1,p=this.getRightMostFocusableColIndex(h,{shiftTab:!0});h>=0&&null==p;)h-=1,p=this.getRightMostFocusableColIndex(h);null!=p&&(this._setFocusedCell(h,p,!1,{tabDirection:"left"}),d.f.stopEvent(t))}else if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID){var u=a.Z.getNextTabbableComp(this.id);u&&u.focus(t),d.f.preventDefault(t)}}catch(t){return s.Y.printStackTrace(t,null,this),!1}},f.prototype.handleEndDivKeyUp=function(t){try{38==t.keyCode&&"all"!=this.options.visibleRowNum&&(this.getElementById(this.id+"_scrollY_div").scrollTop=0)}catch(t){return s.Y.printStackTrace(t,null,this),!1}},f.prototype.handleTdFocus=function(t){var e,i=d.f.getTarget(t),o=this.getLastFocusedCell(),s=a.Z.getDataPrefix("tdIndex"),r=a.Z.getDataPrefix("col_id");if("TD"==i.tagName&&o.focusedTd!=i&&!this.focusedByApi){var n,l,h,p,u,c,g=parseInt(i.getAttribute(s)),f=parseInt(g/this.realRowDataLength)+this.rowIndex,m=i.getAttribute(r);if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&(e=null!=this.editedCell)){var y=this.getCellInfo(this.editedCell.colID);n=y.editRowIndex,l=this._dataList.getColumnIndex(y.id),h=this.getColumnIndex(y.id),p=this.getRealRowIndex(n),u=this._dataList.dataArr[p*this._dataList.getColumnCount()+l],c=y.comp&&y.comp.selectedIndex}if(this._setFocusedCell(f,m),e){var b=this._dataList.dataArr[p*this._dataList.getColumnCount()+l];if(0===u&&(u="0"),0===b&&(b="0"),u!=b){var v={oldValue:u,newValue:b,rowIndex:n,colIndex:h,colId:this.getColumnID(h)};isNaN(c)||(v.oldSelectedIndex=c,v.newSelectedIndex=y&&y.comp&&y.comp.selectedIndex),d.f.fireEvent(this,"onviewchange",v)}}}this.focusedByApi=!1},f.prototype.handleDragSelectEvent=function(t){if(!this._bindDrag)for(var e=this.body_table.offsetHeight,i=this.event.getTargetIterator(t);i.next();)if(i.match(this.options.bodyTdClass,null,"td")){var o=this,s=i.getElement();return void WebSquare.dragdrop.gDragManager.activate(t,this.render,{id:this.id+"_dragSelect",delay:15,handleStart:function(t){a.Z.isIEAllVersion()&&(a.Z.emptySelection(),d.f.preventDefault(t));var e,i,r,n,l,h,p=null!=o.editedCell;if(p&&(e=o.editedCell.editRowIndex,i=o._dataList.getColumnIndex(o.editedCell.id),r=o.getColumnIndex(o.editedCell.id),n=o._grid.getRealRowIndex(e),l=o._dataList.dataArr[n*o._dataList.getColumnCount()+i]),o.__setFocusedCell(t,s,{editMode:!1}),p&&l!=(h=o._dataList.dataArr[n*o._dataList.getColumnCount()+i])){var u={oldValue:l,newValue:h,rowIndex:e,colIndex:r,colId:o.getColumnID(r)};d.f.fireEvent(o,"onviewchange",u)}},handleUpdate:function(t,i,s,r,a){for(var n=null,l=null,h=o.event.getTargetIterator(a);h.next();){if(h.match("w2grid")){n=h.getElement().id;break}h.match(o.options.bodyTdClass,null,"td")&&(l=h.getElement())}var p=o.focusedCell[0];o.options.dataDragSelectAutoScroll&&p.focusedColIndex>-1&&o.dragSelectAutoScroll(d.f.getMouseY(a),e,d.f.getMouseX(a)),null!=n&&null!=l&&o.id==n&&p.focusedColIndex>-1&&(l.className.indexOf("_rowNum")>=0||l.className.indexOf("_rowStatus")>=0||o.__setFocusedCell({shiftKey:!0},l,{editMode:!1}))},handleFinish:function(){o.dragSelectAutoScrollFinish()}})}},f.prototype.handleDragEvent=function(t){
if((!this.options.rowResize||!this.rowResizeStarted)&&(!this.isDrillDown||this.drillDownDragDrop)&&!this.editedCell&&(0!=this.options.dataDragDrop||0!=this.options.dataDragDropSelf))for(var e=a.Z.getDataPrefix("tdIndex"),i=a.Z.getDataPrefix("col_id"),o=a.Z.getDataPrefix("colindex"),s=a.Z.getDataPrefix("index"),n=this.event.getTargetIterator(t);n.next();)if(n.match(null,null,"td")){var l=n.getElement(),h=[],p=l.getAttribute(e);if(null==p)return;var u=this.rowIndex+parseInt(parseInt(p)/(this.oneRowDataLength+this.defaultColCnt));""==this.options.dragDisplayColumn?h.push(l.getAttribute(i)):h=this.options.dragDisplayColumn.split(",");for(var c=[],g=0;g<h.length;g++){var f;f=null==h[g]||null==h[g]?(u+1).toString():this._getCellDisplayData(u,h[g].wq_trim()),c.push(f)}if(c=c.join(","),this.isMobile){for(var m=d.f.getTarget(t);m&&"TD"!=m.tagName&&"TH"!=m.tagName&&"DIV"!=m.tagName;)m=m.parentNode;this.__setFocusedCell(t,m)}var y=this,b={id:this.id+"_drag",component:y,className:"w2grid_drag",contents:c,delay:15,applyMousePosition:!0,showNoData:!0,handleStart:function(t){d.f.fireEvent(y,"ondatadragstart",u)},handleUpdate:function(t,e,i,o,s){var r=null;for(r=y.isMobile?new WebSquare.targetIterator(document.elementFromPoint(s.changedTouches[0].clientX,s.changedTouches[0].clientY)):y.event.getTargetIterator(s);r.next();)if(r.match(null,null,"td"))var a=r.getElement();var n=y.getElementById(y.id+"_resize_line");if(a&&!y.options.dataDragDropOther&&y.options.useDataDragDropGuideLine){var l=a.offsetHeight+a.offsetTop+"px";n.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",n.style.display="block",n.style.zIndex=999,n.style.top=l,n.style.width=y.render.offsetWidth+"px",n.style.left=0,n.style.border="1px solid #3a3f44"}},handleFinish:function(){y.getElementById(y.id+"_resize_line").style.display="none"},onDragover:function(t,e,i,o,s,r,n){if(t&&e){var l=null;for(l=y.isMobile?new WebSquare.targetIterator(document.elementFromPoint(n.changedTouches[0].clientX,n.changedTouches[0].clientY)):y.event.getTargetIterator(n);l.next();)if(l.match("w2grid")||l.match("w2grid_tooltip")){if(l.match("w2grid_tooltip"))l.getElement().style.display="none",l=new WebSquare.targetIterator(document.elementFromPoint(d.f.getClientX(n),d.f.getClientY(n)));var h=a.Z.getComponentById(l.getElement().id);y.id!=h.id&&d.f.fireEvent(h,"ondatadragover",y.id,u),l.stop()}}},onDrop:function(t,n,l,h,p,c,g){var f,m=null,b=null,v=null,w=null,C={},I=null,_=null;for(w=y.isMobile?new WebSquare.targetIterator(document.elementFromPoint(g.changedTouches[0].clientX,g.changedTouches[0].clientY)):y.event.getTargetIterator(g);w.next();){if(w.match(null,null,"body"))return;if(w.match("w2grid")){m=w.getElement().id;break}if(w.match("w2grid_tooltip"))w.getElement().style.display="none",w=new WebSquare.targetIterator(document.elementFromPoint(d.f.getClientX(g),d.f.getClientY(g)));if(null==v&&w.match(null,null,"td")){var x=w.getElement();v=parseInt(x.getAttribute(e),10),"number"!=typeof(f=parseInt(x.getAttribute(o),10))&&(f=void 0)}if(w.match("w2treeview")||w.match("w2treeview_virtual")||w.match("w2input")||w.match("w2textarea")||y.options.dataDragDropClass&&w.match(y.options.dataDragDropClass)){I=w.getElement().id;break}(w.match("w2treeview_node")||w.match("treeview_virtual_node"))&&(_=w.getElement().getAttribute(s))}if((!y.options.dataDragDropSelf||y.id===m)&&(!y.options.dataDragDropOther||y.id!=m)&&(null!=m&&(b=(m=a.Z.getComponentById(m)).getDataLength(),null!=v&&(b=m.rowIndex+parseInt(v/(m.oneRowDataLength+m.defaultColCnt)))),null!=I&&(I=a.Z.getComponentById(I)),m||I)){var S,R,D=m&&""==m.options.dragEndFunction&&""==y.options.dragStartFunction;if(y.focusedCell.length>1&&(y.options.dataDragDropClass||D)){q=[],V=[];for(var T=[],L=0;L<y.focusedCell.length;L++){var k=y.focusedCell[L].focusedRowIndex;T.push(k)}V=T.filter((function(t,e,i){return i.indexOf(t)===e})),V.sort((function(t,e){return t-e}))
;for(L=0;L<V.length;L++)for(var F=y.dataList.getRowArray(V[L]).data,A=0;A<F.length;A++)q.push(F[A])}else S=y.dataList.getRowArray(u).data;var E=t.getAttribute(i),M=y.getColumnIndex(E);if(""!=y.options.dragStartFunction){var O=a.Z.getGlobalFunction(y.options.dragStartFunction,y.scope_id);if("function"==typeof O)if(y.drillDownDragDrop){var N,H;y.getRowCount()<=b?(N=void 0,H=void 0):(N=y.getRealRowIndex(b),H=y.dataList.getRowData(b));var G=[Z=y.getRealRowIndex(u)].concat(y.drilldown.getRecursiveRowIndex(Z)),B=[];for(L=0;L<G.length;L++)B=B.concat(y.dataList.getRowData(y.getDisplayRowIndex(G[L])));if(!O.call(y,{parentRowIndex:N,parentRowData:H,beforeRemoveData:B,beforeRemoveRowIndex:G}))return}else{var W={fromColumnId:E,fromColumnIndex:M,rowJSON:y.dataList.getRowJSON(u)};null==R&&(R=y.dataList.getRowXML(u)),R=O.call(y,u,R,W)}}else if(m&&y.id!==m.id&&y.drillDownDragDrop){var V=[Z=y.getRealRowIndex(u)].concat(y.drilldown.getRecursiveRowIndex(Z)),q=[];for(L=0;L<V.length;L++)q=q.concat(y.dataList.getRowData(y.getDisplayRowIndex(V[L])))}if(m&&""!=m.options.dragEndFunction){var Y=a.Z.getGlobalFunction(m.options.dragEndFunction,m.scope_id);if("function"==typeof Y)if(y.drillDownDragDrop){if(y.id==m.id){if(y.isDrillDown&&b!=u){var Z=y.getRealRowIndex(u);if(y.getRowCount()<=b)y.drilldown.bodyDrop=!0,X=(K=y.getRealRowIndex(b-1))+y.drilldown.getRecursiveRowCount(K);else X=y.getRealRowIndex(b)+1;var j=[Z].concat(y.drilldown.getRecursiveRowIndex(Z)),P=y.drilldown.moveNode(Z,X),z=[P.insertedRowIndex].concat(y.drilldown.getRecursiveRowIndex(P.insertedRowIndex)),U=[];for(L=0;L<j.length;L++)U.push(y.dataList.getRowJSON(j[L]));C={removedData:P.detachedData,removedRowIndex:j,insertedData:P.insertedData,insertedRowIndex:z,fromRowIndex:Z,toRowIndex:z[0],rowJSON:U},Y.call(y,X,y.dataList.getRowXML(u),C)}}else if(m.drillDownDragDrop&&m.isDrillDown){Z=y.getRealRowIndex(u);if(m.getRowCount()<=b)m.drilldown.bodyDrop=!0,X=(K=m.getRealRowIndex(b-1))+m.drilldown.getRecursiveRowCount(K);else X=m.getRealRowIndex(b);for(G=[Z].concat(y.drilldown.getRecursiveRowIndex(Z)),B=[],L=0;L<G.length;L++)B=B.concat(y.dataList.getRowData(y.getDisplayRowIndex(G[L])));R=y.dataList.getRowXML(u);for(U=[],L=0;L<G.length;L++)U.push(y.dataList.getRowJSON(G[L]));C={removedData:B,removedRowIndex:G,fromRowIndex:Z,toRowIndex:X,rowJSON:U},Y.call(y,X,R,C)&&y._dataList.removeRow(Z)}}else{W={fromColumnId:E,fromColumnIndex:M,toColumnId:"number"==typeof f?m.getColumnID(f):void 0,toColumnIndex:f,rowJSON:y.dataList.getRowJSON(u)};!0!==r.I.isXML(R)&&(R=y.dataList.getRowXML(u)),Y.call(y,b,R,W)&&y.dataList.removeRow(u)}}else if(m){if(y.isDrillDown)if(y.id==m.id&&b!=u){if(y.drillDownDragDrop){Z=y.getRealRowIndex(u);if(y.getRowCount()<=b)y.drilldown.bodyDrop=!0,X=(K=y.getRealRowIndex(b-1))+y.drilldown.getRecursiveRowCount(K);else X=y.getRealRowIndex(b)+1;return void y.drilldown.moveNode(Z,X)}}else if(m.drillDownDragDrop&&m.isDrillDown){var X,K;Z=y.getRealRowIndex(u);if(m.getRowCount()<=b)m.drilldown.bodyDrop=!0,X=(K=m.getRealRowIndex(b-1))+m.drilldown.getRecursiveRowCount(K);else X=m.getRealRowIndex(b)+1;for(B=[],L=(G=[Z].concat(y.drilldown.getRecursiveRowIndex(Z))).length-1;L>=0;L--)B=B.concat(y.dataList.getRowData(y.getDisplayRowIndex(G[L])));return m.drilldown.appendNode(X,B),void y.dataList.removeRow(Z)}var J=m._dataList.getBroadcast();if(m._dataList.setBroadcast(!1),q&&V){var $=-1;if(y.id==m.id)for(L=0;L<V.length;L++)V[L]<b&&$++;$=Math.max(0,$);var Q=m.dataList.getRealRowIndex(b),tt={};if(y.options.dataDragDropStatus)for(var et=0;et<V.length;et++)tt[et]=y.dataList.getRowStatus(V[et]);y.dataList.removeRows(V),void 0===Q&&(Q=b,$=0);var it=Q-$;y.id==m.id&&(it=Math.min(it,y.getRowCount())),m._dataList.insertData(it,q);var ot=0;if(y.options.dataDragDropStatus){for(var st in tt){var rt=it+ot,at=y._dataList.options.depthColumn?rt:y._dataList.getRealRowIndex(rt);y._dataList._setRowStatus(at,tt[st]),ot++}y.setFocusedMultiCell(it,0,it+ot-1,0)}y.id===m.id?y._moveCellVisible(V,it,{remove:!0,insert:!0
}):(y._moveCellVisible(V,it,{remove:!0}),m._moveCellVisible(V,it,{insert:!0}))}else{var nt=y.dataList.getRowStatus(u);if(y.dataList.removeRow(u),!0===r.I.isXML(R)?m.dataList.setRowXML(b,R):m.dataList.setRowData(b,S),y.options.dataDragDropStatus){at=y._dataList.options.depthColumn?b:y._dataList.getRealRowIndex(b);y._dataList._setRowStatus(at,nt),y.setFocusedCell(at,0)}y.id===m.id?y._moveCellVisible([u],b,{remove:!0,insert:!0}):(y._moveCellVisible(V,it,{remove:!0}),m._moveCellVisible(V,it,{insert:!0}))}!1!==J&&m._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0}]}),y.removeFocusedCell(),y.id!=m.id?d.f.fireEvent(m,"ondatadrop",{fromId:y.id,fromRowIndex:u,toRowIndex:b}):d.f.fireEvent(m,"ondatadropself",{id:y.id,fromRowIndex:u,toRowIndex:b}),t.blur()}else if(I){var lt;null!=_&&(lt=I.tree.findNodeByIndex(_),_=parseInt(_,10)),d.f.fireEvent(I,"ondropfromgrid",{dataListId:y._dataList.id,fromId:y.id,fromRowIndex:u,value:this.contents,dropNode:lt,toRowIndex:_,rowIndexArr:V||[u]}),y.removeFocusedCell(),t.blur()}}}};return this.isMobile&&(b.passive=!1,b.showGhostOnActivate=!0,b.ghostRightTop=!0,b.delay=0),void WebSquare.dragdrop.gDragManager.activate(t,l,b)}},f.prototype.dragSelectAutoScroll=function(t,e,i){try{this._dragSelectAutoScrollStartTime=new Date,a.Z.setInterval((function(t,e,i){this._dragSelectAutoScroll(t,e,i)}),{key:this.id+"_dragSelectAutoScroll",caller:this,delay:this.options.dataDragSelectAutoScrollPeriod,args:[t,e,i]})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._dragSelectAutoScroll=function(t,e,i){try{var o=0,r=this.getRowCount(),n=null==this.lastTopRowIndex?r-this.lastIndex:this.lastTopRowIndex,l=WebSquare.style.getAbsoluteTop(this.render),h=l+e,d=1;if(t>h?o=t-h:l>t&&(o=l-t,d=-1),0!==o){var p=new Date-this._dragSelectAutoScrollStartTime,u=Math.floor(p/this.options.dataDragSelectAutoScrollLevel),c=Math.pow(2,u),g=Math.ceil(o*this.options.dataDragSelectAutoScrollDPI/100)*c*d,f=Math.max(Math.min(this.rowIndex+g,n-1),0);this.rowIndex!==f&&(this.scrollEvent=!1,this.checkScrollEnd=!0,this.rowIndex=f,this.fastDrawData(0,{scroll:!0}),this._dragSelectAutoScrollFlag=!0,document.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(f))}for(var m=0,y=WebSquare.style.getAbsoluteLeft(this.render),b=y+this.render.offsetWidth,v=0;v<this.defaultColCnt;v++)y+=this.colWidthList[v];d=1;if(i>b?m=i-b:y>i&&(m=y-i,d=-1),0!==m){var w=a.Z.getDataPrefix("tdIndex"),C=this.focusedCell[0],I=this.getLastFocusedCell().focusedTd,_=parseInt(I.getAttribute(w)),x=parseInt(_/this.realRowDataLength),S=C.focusedRowIndex,R=C.focusedColIndex,D=x+this.rowIndex,T=_%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);T=d<0?Math.max(0,T-1):Math.min(this.oneRowDataLength-1,T+1),this._applyFocusedMultiCell(S,R,D,T),d<0?this.fixScrollLeftDirection():this.fixScrollRightDirection()}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.dragSelectAutoScrollFinish=function(){try{if(a.Z.clearInterval(this.id+"_dragSelectAutoScroll"),!0!==this._dragSelectAutoScrollFlag)return;this._dragSelectAutoScrollFlag=!1,this._dragSelectAutoScrollStartTime=0;var t=a.Z.getDataPrefix("tdIndex");r.I.setTimer((function(){var e=this.focusedCell[0],i=this.getLastFocusedCell().focusedTd,o=parseInt(i.getAttribute(t)),s=parseInt(o/this.realRowDataLength),r=e.focusedRowIndex,a=e.focusedColIndex,n=s+this.rowIndex,l=o%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),h=null==this.lastTopRowIndex?this.getRowCount()-this.lastIndex-1:this.lastTopRowIndex,d=r<=n?1:-1,p=Math.max(Math.min(this.rowIndex+d,h),0);this.drawData(p,0),this._applyFocusedMultiCell(r,a,n,l)}),{key:this.id+"__dragSelectAutoScroll_drawData",caller:this,delay:this.options.dataDragSelectAutoScrollDelay})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.otherClickEvent=function(){try{this.isMobile?(this.event.addListener(document.documentElement,"ontouchstart",this.event.bindAsEventListener(this,this.handleClickEventDocument)),
this.options.tooltipDisplay&&this.hideTooltip()):WebSquare.getBody().getLayerListener().addListener({component:this,event:{},otherClick:this.handleClickEventDocument,frameClick:this.handleClickEventFrame})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleClickEventFrame=function(t){try{this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,!0]),this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),this.hideContextMenu(),this.groupbyFilterList&&this.hideGroupbyFilterList(),this.options.focusAutoRemove&&this.removeFocusedCell()}catch(t){s.Y.printStackTrace(t)}},f.prototype.handleClickEventDocument=function(t){this.lastEvent=t,this.isHammerEnabled()&&!t.srcElement.id==this.id+"_toGoButton"&&this.hideTooltip(),this.event.isMe(t,this.render)||this.isMine(t)?this.handleClickEventDocumentAfter(t):(this.editedCell?this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,{otherClick:!0}],{beforeFunc:function(t,e){t.handleClickEventDocumentAfter(e);var i=WebSquare.getBody();i.layerListener.handleMouseDownEventDocument.call(i,e),i=null},beforeFuncArgs:[this,t]}):this.handleClickEventDocumentAfter(t),this.options.tooltipDisplay&&this.isMobile&&(!t.srcElement.id==this.id+"_toGoButton"&&this.hideTooltip(),t.srcElement.id==this.id+"_tooltip"&&d.f.stopEvent(t)))},f.prototype.handleClickEventDocumentAfter=function(t){if(this.contextMenu){var e=d.f.getTarget(t);e&&e.className.match("contextMenu")||this.hideContextMenu()}if(this.groupbyFilterList||this.customFilterScrollView){var i=this.event.getTargetIterator(t,this.render),o=!0;if(this.customFilterScrollView&&this.customFilterScrollView.render&&"none"==this.customFilterScrollView.render.style.display)o=!1;else for(;i.next();)if(i.match("gridHeaderTDDefault")||i.match("w2grid_groupbyZone_scrollView")||i.match("w2grid_groupbyZone_column")||i.match("w2grid_customFilter_scrollView")||i.match("w2grid_customFilter_column")){o=!1;break}o&&this.hideCustomFilterList()}if(this.options.groupbyZone&&this.options.groupbyFilterBox)for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_filterBox_select_tbody")||i.match("w2grid_filterBox_itemTable")){o=!1;break}if(this.groupbyFilterList){for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_groupbyZone_list")||i.match("w2grid_groupbyZone_column")||i.match("gridHeaderTDDefault")){o=!1;break}o&&this.hideGroupbyFilterList()}this.options.focusAutoRemove&&this.removeFocusedCell()},f.prototype.isMine=function(t){try{for(var e=d.f.getTarget(t);null!=e;){if(e.id&&e.id.indexOf&&e.id.indexOf("G_"+this.id+"__")>=0)return!0;e=e.parentNode}return!1}catch(t){s.Y.printStackTrace(t)}},f.prototype.handleResize=function(t){try{var e=t||{},i=this.render.offsetWidth,o=this.render.offsetHeight;if(i>0&&o>0)if(this.delayedDrawObj)this.resizeObj={width:i,height:o,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.setRedrawStatus("draw");else{var n=i-this.resizeObj.width,l=o-this.resizeObj.height,h=!1,d=this.hiddenCellObj.length>0;if(!0===this._isHybridScroll()&&0!==l)this.setScrollYHeightHybrid();else if(l>0){if(this.options.adaptive){var p=parseInt(this.options.adaptiveThreshold)||480;if(!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)&&a.Z._getBrowserWidth()<=p)return}this._setGridHeightBefore(),h=!0;var u=this.getDataLength(),c=this.drawedRowLength;this.lastTopRowIndex=null,this.setDataTable(),this.setScrollYHeight();var g=this._getVisibleLastIndex(this.lastIndex+1);if(u<=0);else if(this.rowIndex+g-1+this.drawedRowLength-c<u){var f=u-this.drawedRowLength+1,m=this.rowIndex;this.rowIndex+1>f&&f>=-1&&(m=f>=0?f:0),d?(this.rowIndex=m,this._setCellVisibleRefresh()):this.drawData(m)}else{var y,b;if((m=u-this.drawedRowLength>0?u-this.drawedRowLength:0)==this.rowIndex)y=g-1;else this.scrollEvent=!1,this.checkScrollEnd=!0,
this.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(m);if(d)this.rowIndex=m,this._setCellVisibleRefresh();else e.startPoint&&(b=parseInt(e.startPoint),isNaN(b)||(y=b)),this.drawData(m,y)}this._setGridHeightAfter()}else if(l<0&&"all"!=this.options.visibleRowNum){this._setGridHeightBefore(),this._setGridHeightAfter(),h=!0;var v=this.getElementById(this.id+"_body_table");this.dataLayerHeight=v.parentNode.offsetHeight;var w=Number(this.options.visibleRowNum),C=this.getVisibleRowNum();d?this._setCellVisibleRefresh():(!isNaN(w)&&w>0&&w>=C||(this.lastTopRowIndex=null,this.cutGridBottom(this.lastIndex)),this.setScrollYHeight())}0!=n&&(h=!0,this.resizeObj.clientWidth=this.render.clientWidth,this.setScrollYHeight(),this.options.autoFit||this.setOverflowX(),this._handleScrollX(),this.options.autoFit&&this.autoFitFunc(),d&&this._setCellVisibleRefresh(),this.displayFixedColumnLine()),h&&this.groupbyZoneStatus.groupbyZoneRender&&this.resizeGroupbyZone()}else this.setRedrawStatus("stop");this.groupbyZoneStatus.groupbyZoneRender&&!this.adjustGroupbyZone&&(this.adjustGroupbyZone=!0,this.resizeGroupbyZone()),this.resizeObj={width:i,height:o,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.resizeObj.width>0&&this.resizeObj.height>0&&(this.resizeObj.scrollLeft=this.getElementById(this.id+"_scrollX_right").scrollLeft,this.resizeObj.scrollTop=this.getElementById(this.id+"_scrollY_div").scrollTop)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.resizeGroupbyZone=function(){if(this.groupbyZoneStatus.groupbyZoneRender){var t=this.resizeObj.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder,e=this.dom[this.id+"_scrollY_div"].offsetWidth;0!=e&&(t-=e),t+="px",this.groupbyZoneStatus.groupbyZoneRender.style.width!=t&&(this.groupbyZoneStatus.groupbyZoneRender.style.width=t)}},f.prototype.checkResize=function(){try{if(this.render){var t=!0;if(WebSquare.getBody().modalStack&&WebSquare.getBody().modalStack.length>0&&this.getDisabled()){for(var e=this.parentControl;e&&(!e.options||"floatingLayer"!=e.options.pluginName&&("wframe"!==e.options.pluginName&&"pageFrame"!==e.options.pluginName||!e._isWframePopup));)e=e.parentControl;null==e&&(t=!1)}t&&!this.startedDisplayNone&&this.handleResize()}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleDblClickEvent=function(t){try{for(var e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match(this.options.bodyTdClass)||WebSquare.idToUUID[e.getElement().getAttribute("id")]){this.bodyDblClick(t,e.getElement());break}if(e.match(this.options.headerTdClass)){this.headerDdlClick(t,e.getElement());break}if(this.hasFooter&&e.match(this.options.footerTdClass)){this.footerDblClick(t,e.getElement());break}if(this.hasSubtotal){if(this.subtotalClassList){for(var i=!1,o=0;o<this.subtotalClassList.length;o++)if(this.subtotalClassList[o].length>0&&e.match(this.subtotalClassList[o])){this.subtotalDblClick(t,e.getElement()),i=!0;break}if(i)break}else if(e.match(this.options.subtotalTdClass)){this.subtotalDblClick(t,e.getElement());break}}else e.match("w2grid_customFilter_sortable_open")&&(d.f.stopEvent(t),e.stop())}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleClickEvent=function(t){try{if(this.lastEvent=t,d.f.fireEvent(this,"onclick",t),this.isMobile&&this.iScroll&&this.iScroll.moveDirection&&this.iScroll.moveDistance>10)return;var e,i,o,r,a,n,l,h=this.event.getTargetIterator(t,this.render),p=null!=this.editedCell,u=this.lastEvent;p&&(e=this.editedCell.editRowIndex,i=this._dataList.getColumnIndex(this.editedCell.id),l=this.getCellInfo(this.editedCell.id),o=this.getColumnIndex(this.editedCell.id),r=this._grid.getRealRowIndex(e),a=this._dataList.dataArr[r*this._dataList.getColumnCount()+i],n=l.comp&&l.comp.selectedIndex);for(var c=function(t,e){var i=!1
;if(e.subtotalClassList)for(var o=0;o<e.subtotalClassList.length;o++)if(e.subtotalClassList[o].length>0&&t.match(e.subtotalClassList[o])){i=!0;break}return i},g=!1;h.next();){if(h.match(this.options.bodyTdClass)){g=!0,this.bodyClick(t,h.getElement(),{from_handleClickEvent:!0});break}if(h.match(this.options.headerTdClass)){g=!0,this.headerClick(t,h.getElement(),{from_handleClickEvent:!0}),p&&null==this.editedCell&&(e=this.getDisplayRowIndex(r));break}if(this.hasFooter&&h.match(this.options.footerTdClass)){g=!0,this.footerClick(t,h.getElement(),{from_handleClickEvent:!0});break}if(this.hasSubtotal&&(h.match(this.options.subtotalTdClass)||c(h,this))){g=!0,this.subtotalClick(t,h.getElement(),{from_handleClickEvent:!0});break}if(this.isMine(t));else{if(h.match(this.options.headerTableClass))break;if(h.getElement().getAttribute("id")==this.id+"_dataLayer"){g=!0,null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,{from_handleClickEvent:!0}),d.f.fireEvent(this,"onblankclick",t);break}}}if(p){var f=this._dataList.dataArr[r*this._dataList.getColumnCount()+i];if(0===a&&(a="0"),0===f&&(f="0"),a!=f){var m={oldValue:a,newValue:f,rowIndex:e,colIndex:o,colId:this.getColumnID(o)};isNaN(n)||(m.oldSelectedIndex=n,m.newSelectedIndex=l&&l.comp&&l.comp.selectedIndex),d.f.fireEvent(this,"onviewchange",m)}var y=this._getGroupbyDisplayRowIndex(e);this.options.viewChangeAfterEdit&&g&&d.f.fireEvent(this,"onafteredit",y,o,f,u)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.gridDataLayerOut=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},f.prototype.gridHeaderOver=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},f.prototype.gridOver=function(t){for(var e=a.Z.getDataPrefix("colIndex"),i=a.Z.getDataPrefix("col_id"),o=d.f.getTarget(t);o&&("TD"!=o.tagName||null==o.getAttribute(e)||!(this.hasClass(o,this.options.bodyTdClass)||this.hasClass(o,this.options.subtotalTdClass)||this.hasClass(o,this.options.footerTdClass)));){if("TD"==o.tagName&&null!=o.getAttribute(e)&&this.subtotalClassList){for(var s=!1,r=0;r<this.subtotalClassList.length;r++)if(this.subtotalClassList[r].length>0&&this.hasClass(o,this.subtotalClassList[r])){s=!0;break}if(s)break}if(this.options.tooltipHeader&&"TH"==o.tagName&&null!=o.getAttribute(e))break;if("DIV"==o.tagName&&o.getAttribute("id")==this.id+"_dataLayer")break;if("TABLE"==o.tagName&&o.getAttribute("id")==this.id+"_foot_table")break;if("TH"==o.tagName&&this.hasClass(o,this.options.headerTdClass))break;o=o.parentNode}if(o.id==this.id+"_dataLayer")this.overElem&&(this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null);else if(o.id==this.id+"_foot_table")this.overElem&&(this.bodyOut(t,this.overElem),this.overElem=null);else if(o&&"TD"==o.tagName){if(this.overElem!=o&&-1==o.className.indexOf(this.options.headerTdClass)){this.bodyOut(t,this.overElem),(this.options.tooltipDisplay||this.options.rowStatusTooltipDisplay)&&this.bodyOver(t,o),this.options.rowMouseOver&&(this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.hasClass(o,"w2grid_groupby")||this.addRowOverStyle(o.parentNode)),this.overElem=o;var n={};o.getAttribute(i)&&(n.rowIndex=this._getGroupbyDisplayRowIndex(this.getElemRowIndex(o)),n.colIndex=this.getColumnIndex(o.getAttribute(i))),d.f.fireEvent(this,"onbodymouseover",n)}}else if(o&&"TH"==o.tagName&&this.overElem!=o){this.bodyOut(t,this.overElem),(this.options.tooltipHeader||this.options.headerTooltipDisplay)&&this.headerOver(t,o),this.options.rowMouseOver&&this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.overElem=o;n={};var l=a.Z.getDataPrefix("header_id"),h=this.overElem.getAttribute(i),p=this.overElem.getAttribute(l);if(p&&p===this._headerOverElemId)return
;this.getHeaderInfo(h)&&(n.header_id=p,n.id=this.overElem.id,this._headerOverElemId=p),d.f.fireEvent(this,"onheadermouseover",n)}},f.prototype.gridOver1=function(t){var e=d.f.getTarget(t);("NOBR"==e.tagName||"SPAN"==e.tagName&&e.className.indexOf("w2grid_span")>-1)&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem&&this.removeRowOverStyle(this.overElem.parentNode),this.addRowOverStyle(e.parentNode)),this.overElem=e)},f.prototype.gridOver2=function(t){var e=d.f.getTarget(t);("NOBR"==e.tagName||"SPAN"==e.tagName&&e.className.indexOf("w2grid_span")>-1)&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem,this.addRowOverStyle(e.parentNode)),this.overElem=e)},f.prototype.handlePasteEvent=function(t){try{var e=this.options.preventPasteColumn,i=e?e.split(","):[];if(this.options.preventPaste&&!this.editedCell||d.f.getTarget(t)&&d.f.getTarget(t).getAttribute("class")&&d.f.getTarget(t).getAttribute("class").indexOf("w2grid_head_input")>-1)return;if(!1===d.f.fireEvent(this,"oncustompaste",t))return;var o,n,l,h,p=a.Z.isIEAllVersion()?window.clipboardData:t.clipboardData;if("native"!==this.options.copyType&&!0===this.options.noUseCSVParser&&(o=p.getData("gridView")),o||(o=p.getData("Text")),1==this.options.ctrlShiftKey&&(n=p.getData("Nofocus")),"\r\n"==o.slice(-2)?o=o.slice(0,o.length-2):"\n"==o.slice(-1)&&(o=o.slice(0,o.length-1)),this.options.customPasteFormatter)if("string"==typeof this.options.customPasteFormatter){var u=a.Z.getGlobalFunction(this.options.customPasteFormatter.wq_trim(),this.scope_id);if("function"==typeof u){var c=u.call(this,o);o=c||o}}else $l("The type of customPasteFormatter must be string.");if("native"===this.options.copyType?l=[[o]]:(1==this.options.ctrlShiftKey&&(h=Papa.parse(n,{delimiter:"\t"}).data),l=Papa.parse(o,{delimiter:"\t"}).data),a.Z.isIEAllVersion("6 7")&&'"'===o.slice(0,1)&&'"'===o.slice(-1)&&-1==o.slice(1,-1).indexOf("\t")&&(l=[[o.slice(1,o.length-1)]]),!l||null==l||"undefined"==l||0==l.length)return;if(this.focusedCell.length>0){for(var g,f=this.getColumnOrder(),m=this.htmlInfo.body.rowAttrArr.length,y=this.getDataLength()*m,b=0,v=f.length,w=0,C=null,I=0,_=0;_<this.focusedCell.length;_++){var x=this.focusedCell[_],S=x.focusedRowIndex,R=x.focusedColIndex,D=this.getLocationRowCol(S,R);S=D.rowIndex,R=D.colIndex,I+=D.rowSize*D.colSize-1,y>S&&(y=S),b<S+D.rowSize-1&&(b=S+D.rowSize-1),v>R&&(v=R),w<R+D.colSize-1&&(w=R+D.colSize-1),y==S&&v==R&&(C=x)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(v=0,w=f.length-1);var T=0;for(_=this.defaultColCnt+v;_<this.defaultColCnt+w;_++)1==this.hiddenList[_]&&(T+=1);if(this.focusedCell.length>1&&this.focusedCell.length+I!=(b-y+1)*(w-v-T+1))return;var L=!1;if(I>0&&(L=!0),g={focusedRange:{minRow:y,maxRow:b,minCol:v,maxCol:w},startCell:C},C.focusedRowIndex>=0&&C.focusedColIndex>=0){var k=C.focusedTd;if(k){var F=a.Z.getDataPrefix("col_id"),A=a.Z.getDataPrefix("colMerged"),E=k.getAttribute(F);if(null==E||""==E.wq_trim())return;if("1"==k.getAttribute(A))return}else{var M=this.getCellInfo(C.focusedColIndex);if(M&&(M.options.colMerge||M.options.colMergeAnd))return}var O=y,N=v,H=this.getOriginalRowCol(y,v),G=(R=H.colIndex,S=H.rowIndex,this.getTotalRow()),B=(this.getTotalCol(),G*m),W=f.length;if(this.options.checkBlankRowOnPaste)for(_=l.length-1;_>-1;_--){for(var V=!0,q=0;q<l[0].length;q++)if(""!=l[_][q].wq_trim()){V=!1;break}V&&l.splice(_,1)}if(!1===d.f.fireEvent(this,"onbeforepaste",{rowIndex:this._getGroupbyDisplayRowIndex(S),colIndex:R,data:l.slice(0)}))return;this.isPaste=!0;var Y,Z=this,j=function(t){for(var e=Z.defaultColCnt+t;e<Z.hiddenList.length;e++)if(0==Z.hiddenList[e])return e-Z.defaultColCnt},P=this.uuid,z=!1,U=function(t){var e=WebSquare.idCache[P],o=e.options.checkReadOnlyOnPasteEnable,s=o?o.split(","):[];if(O+l.length>B&&!a.Z.getBoolean(Z.options.preventAddRowOnPaste)&&"focus"!==Z.options.pasteOption){
var r=Math.ceil((O+l.length-B)/m),n=Array(Z._dataList.getTotalCol()*r);if(""!=Z.depthColumn)for(var p=Z._dataList.getCellInfo(Z.depthColumn).options.defaultValue,u=0;u<r;u++)n[u*Z._dataList.getTotalCol()+Z._dataList.getColumnIndex(Z.depthColumn)]=p;if(Z.options.setDefaultValueOnPaste){var c=Z._dataList.getTotalCol();for(u=0;u<c;u++)for(var g=Z._dataList.getCellInfo(u).options.defaultValue,f=0;f<r;f++)n[f*c+Z._dataList.getColumnIndex(u)]=g}if(Z.options.checkReadOnlyOnPaste){var C=!0,I=!1;for(u=0;u<l.length;u++){var _=N,x=O+u;for(f=0;f<l[0].length&&!(null==_||_>=W);f++){var S=(k=Z.getOriginalRowCol(x,_)).colIndex,R=k.rowIndex;I=!1;for(var D=0;D<s.length;D++)if(s[D]==e.getColumnID(S)){I=!0;break}if(!Z.___getEditReadOnly(R,S)||Z.___getEditReadOnly(R,S)&&I){C=!1;break}_=j(_+1)}}if(C)return}if(Z.options.checkDisabledOnPaste){var T=!0;for(u=0;u<l.length;u++)for(_=N,x=O+u,f=0;f<l[0].length&&!(null==_||_>=W);f++){var k;S=(k=Z.getOriginalRowCol(x,_)).colIndex,R=k.rowIndex;if(!Z._getEditDisabled(R,S)){T=!1;break}_=j(_+1)}if(T)return}if(n.length>0){z=!0,Z._dataList.setData(n,!0);u=0;for(var F=r,A=new Array(r);u<F;u++)A[u]="C";Y=A.length,Z._dataList.rowStatusArr=Z._dataList.rowStatusArr.slice(0,G).concat(A)}}var E=function(o,r,n){for(var p=function(t,e,i,o){var s=Z.data_td_list[e+(t-Z.rowIndex)*Z.oneRowDataLength];if(t<Z.rowIndex&&(s=null),!(Z.groupbyStatus.grouped&&s&&Z.hasClass(s,"w2grid_groupby"))){var r=Z.getCellInfo(e),a=Z._getRealColIndex("body",r.options.col_id)+Z.defaultColCnt;if(!r.options.blockSelect&&!Z.hiddenList[a]){if(1==Z.options.ctrlShiftKey)if("true"!=(h[o].length>1?h[o][e]:h[o]))return;var n={focusedTd:s,focusedRowIndex:t,focusedColIndex:e};Z.options.groupbyDisplayRowIndex&&(n.groupbyDisplayRowIndex=Z._getGroupbyDisplayRowIndex(t)),i?Z.focusedCell.push(n):Z.focusedCell.unshift(n),null!=s&&Z.applyFocusedCellIn(s,i)}}},u=o,c=0;c<l.length;c++){for(var g=r,f=0;f<l[c].length&&!(null==g||g>=W);f++){var y=Z.getOriginalRowCol(u,g),b=y.colIndex,v=y.rowIndex;if(y.noLeftTop)y.leftCell&&(g=j(g+y.colSize));else{1==Z.options.ctrlShiftKey?p(v,b,n,c):p(v,b,n);for(var w=!1,C=0;C<s.length;C++)if(s[C]==e.getColumnID(b)){w=!0;break}if(Z.options.checkReadOnlyOnPaste&&Z.___getEditReadOnly(v,b)&&!w)g=j(g+y.colSize);else if(Z.options.checkDisabledOnPaste&&Z._getEditDisabled(v,b))g=j(g+y.colSize);else{var I=!1;for(C=0;C<i.length;C++)if(i[C]==e.getColumnID(b)){g=j(g+y.colSize),I=!0;break}if(!I&&!(a.Z.getBoolean(Z.options.preventAddRowOnPaste)&&Z.dataList.getRowCount()*m-1<v||"focus"===Z.options.pasteOption&&(g>t.focusedRange.maxCol||g<t.focusedRange.minCol||u>t.focusedRange.maxRow||u<t.focusedRange.minRow))){var _,x=b,S=Z.tdIdList[x],R=Z._dataList.getColumnIndex(S),D=Z._dataList.dataArr[Z.getRealRowIndex(v)*Z._dataList.getColumnCount()+R],T=l[c][f];1==Z.options.ctrlShiftKey&&(_=h[c][f]);var L=Z.getCellInfo(x),k=!(!Z.isDrillDown||!Z._dataList.options.depthColumn)?Z.getRealRowIndex(v):v;if("number"!=L.options.dataType&&"float"!=L.options.dataType||"."!==(T=T.wq_trim())&&"-"!==T&&"+"!==T){if((L.options.selectedDataOnPaste||Z.options.selectByLabel)&&("autoComplete"===L.options.inputType||"select"===L.options.inputType)){var F,A=L.getItemArray(),E=L.dataComp;if(L.existGridViewItemsetNode||"gridViewItemset"===L.options.itemTableType){var M=L.itemsetObj.nodeset;M.indexOf("data:")>=0&&(E=M.slice(5))}if(E&&(F=L.mainGrid.modelControl.getDataComp(E)),F&&(!A||0==A.length||1==A.length&&(!0===L.options.chooseOption||!0===L.option.allOption)||2==A.length&&!0===L.options.chooseOption&&!0===L.option.allOption)){var O=F.bodyIdColIndexMap[L.itemsetObj.label],N=F.bodyIdColIndexMap[L.itemsetObj.value],H=F.cellIdList.length,G=F.filteredRowIndexArr.length;if(A=[],F&&"linkedDataList"===F.initializeType&&null!=F.conditionInfo&&F.conditionInfo.filterInfo.useRef)for(var B=0;B<F._dataList.getDataLength();B++){(V={}).label=F._dataList.dataArr[B*H+O],V.value=F._dataList.dataArr[B*H+N],A[B]=V}else for(C=0;C<G;C++){var V={}
;"linkedDataList"!=F.initializeType&&F.dataArr?(V.label=F.dataArr[F.filteredRowIndexArr[C]*H+O],V.value=F.dataArr[F.filteredRowIndexArr[C]*H+N]):(V.label=F._dataList.dataArr[F.filteredRowIndexArr[C]*H+O],V.value=F._dataList.dataArr[F.filteredRowIndexArr[C]*H+N]),A[C]=V}}var q=!1;if(L.options.selectedDataOnPaste)if(0===A.length)q=!0;else for(var P=0;P<A.length;P++){var U=A[P];switch(L.options.selectedDataOnPaste){case"true":case"both":U.value!==T&&U.label!==T||(q=!0);break;case"value":U.value===T&&(q=!0);break;case"label":U.label===T&&(q=!0);break;default:q=!0}if(q)break}if(!q&&L.options.selectedDataOnPaste){l.length<=Y+c&&0===f&&z&&Z._drawRowStatus(k-Z.rowIndex,k),g=j(g+y.colSize);continue}if(Z.options.selectByLabel)for(P=0;P<A.length;P++){if((U=A[P]).label===T){T=U.value;break}}}var X=L.comp&&L.comp.selectedIndex;if("true"===Z.options.unformatOnPaste||"true"===L.options.unformatOnPaste){if("calendar"==L.options.inputType&&"date"==L.options.dataType){var K=0;"yearMonthDate"==L.options.calendarValueType?K=8:"yearMonth"==L.options.calendarValueType?K=6:"yearMonthDateHour"==L.options.calendarValueType?K=10:"yearMonthDateTime"==L.options.calendarValueType?K=12:"yearMonthDateTimeSec"==L.options.calendarValueType?K=14:"year"==L.options.calendarValueType&&(K=4);var J=new WebSquare.validator.validateInvoker;J.addCommand(new WebSquare.validator.allowCharCommand("0-9")),J.addCommand(new WebSquare.validator.maxLengthCommand(K)),T=J.validateString(T)}var $=T,Q=L.formatter.masking,tt=L.formatter.type;T=$=void 0===tt||null==tt||"number"!=tt&&"float"!=tt?void 0!==tt&&null!=tt&&"date"==tt?WebSquare.text.unformatDate2(Q,$):void 0!==tt&&null!=tt&&"time"==tt?WebSquare.text.unformatTime(Q,$):WebSquare.text.unformatText(Q,$):WebSquare.text.unformatCurrency(Q,$)}if(L.options.maxLength)if("float"==L.options.dataType)T=new WebSquare.validator.maxFloatLengthCommand(L.options.maxLength,L.options.decimalDelimiter,L.options.delimiter).executeValidateString(T);else if("number"==L.options.dataType||"bigDecimal"==L.options.dataType){T=new WebSquare.validator.maxLengthCommand(L.options.maxLength).executeValidateString(T)}else{G=parseInt(L.options.maxLength);isNaN(G)||(T=T.slice(0,G))}else if(L.options.maxByteLength){if("number"==L.options.dataType||"bigDecimal"==L.options.dataType)T=new WebSquare.validator.maxByteLengthCommand(L.options.maxByteLength,L.options.byteCheckIgnoreChar).executeValidateString(T)}var et=L.options.allowChar;if(L.options.allowChar||"float"!=L.options.dataType&&"number"!=L.options.dataType&&"bigDecimal"!=L.options.dataType||(et="0-9+-"+L.options.decimalDelimiter),et&&void 0!==et&&null!=et&&""!=et){var it=new RegExp("["+et+"]"),ot=!0;for(C=0;C<T.length;C++){if(null==T.charAt(C).match(it)){ot=!1;break}}!1===ot&&(T="")}if(L.options.ignoreChar)T=new WebSquare.validator.ignoreCharCommand(L.options.ignoreChar).executeValidateString(T);if((""!==L.options.escape?L.options.escape:Z.options.escape)+""=="true"&&(T=WebSquare.xml.decode(T)),"radio"===L.options.inputType&&L.options.trueValue===T)for(var st=Z.getCheckedIndex(x),rt=0;rt<st.length;rt++)Z._dataList.setCellData(st[rt],R,L.options.falseValue);if("text"===L.options.inputType||"textImage"===L.options.inputType){var at=a.Z.getGlobalFunction(L.options.customModelFormatter,Z.scope_id);"function"==typeof at?(Z.useCustomModelFormatter=!0,T=at.call(Z,T,T,L.editRowIndex,L.getColumnIndex(S))):Z.useCustomModelFormatter=!1}if("text"===L.options.inputType&&"float"===L.options.dataType&&T.charAt(T.length-1)===L.options.decimalDelimiter&&(T=T.substr(0,T.length-1)),1==Z.options.ctrlShiftKey?"true"==_&&Z._dataList.setCellData(k,R,T):Z._dataList.setCellData(k,R,T),!T&&z&&l.length<=Y+c&&Z._drawRowStatus(k-Z.rowIndex,k),D!=T){if(1==Z.options.ctrlShiftKey)var nt={oldValue:D,newValue:"true"==_?T:D,rowIndex:v,colIndex:x,colId:Z.getColumnID(x)};else nt={oldValue:D,newValue:T,rowIndex:v,colIndex:x,colId:Z.getColumnID(x)};isNaN(X)||(nt.oldSelectedIndex=X,nt.newSelectedIndex=L.comp&&L.comp.selectedIndex),
d.f.fireEvent(Z,"onviewchange",nt)}g=j(g+y.colSize)}}}}}u+=1}},M=y,H=v;if(l.length>0&&!L)for(u=1;u<l.length;u++)if(l[u].length!==l[0].length){L=!0;break}if(Z.applyFocusedCellOut(),Z.focusedCell=[],L)E(y,v,!1);else if(b-y+1>=l.length&&w-v+1>=l[0].length)for(;M<=b-l.length+1;){for(H=v;H<=w-l[0].length+1;){var V=!0;M+l.length>b-l.length+1&&H+l[0].length>w-l[0].length+1&&(V=!1),E(M,H,V),H+=l[0].length}M+=l.length}else if(b-y+1>=l.length)for(;M<=b-l.length+1;){V=!0;M+l.length>b-l.length+1&&(V=!1),E(M,H,V),M+=l.length}else if(w-v+1>=l[0].length)for(;H<=w-l[0].length+1;){V=!0;H+l[0].length>w-l[0].length+1&&(V=!1),E(M,H,V),H+=l[0].length}else E(y,v,!1)};if("true"===this.options.showMessageOnPaste){var X=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/pasteMessage/@value");WebSquare.layer.pasteMessageLoaded=!1,WebSquare.layer.showProcessMessage(X,{type:"pasteMsg",scope:this.scope_id||""});var K=function(){WebSquare.layer.pasteMessageLoaded?(a.Z.clearTimeout(Z.id+"_pasteMessageLoaded"),U(),WebSquare.layer.hideProcessMessage({type:"pasteMsg",scope:this.scope_id||""}),d.f.fireEvent(Z,"onafterpaste")):a.Z.setTimeout(K,{delay:500,key:Z.id+"_pasteMessageLoaded"})};K()}else U(g),d.f.fireEvent(this,"onafterpaste")}}this.isPaste=!1,d.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._doPaste=function(){try{if(a.Z.isIEAllVersion())this.handlePasteEvent({});else if(!a.Z.isIEAllVersion()&&(r.I.browserCheck.moz||r.I.browserCheck.chrome||r.I.browserCheck.safari)){var t=document.createElement("textarea"),e=this;t.style.opacity="0",t.onpaste=function(t){e.handlePasteEvent(t),i.removeChild(this)},t.textContent="temp";var i=document.getElementsByTagName("body")[0];i.appendChild(t),t.select();try{document.execCommand("paste")}catch(t){p.v.printLog(this.id+"_doPaste skip.")}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleBeforeCopyEvent=function(t){d.f.preventDefault(t)},f.prototype.handleBeforeCutEvent=function(t){d.f.preventDefault(t)},f.prototype.handleCopyEvent=function(t,e){try{if(!1===d.f.fireEvent(this,"oncustomcopy",t))return;var i=this.options.preventCopyColumn,o=i?i.split(","):[];if(this.options.preventCopy||"native"===this.options.copyType)return;if(r.I.browserCheck.safari){for(var n=document.activeElement,l=!1;null!=n;)n.id&&n.id==this.id&&(l=!0),n=n.parentNode;if(!l)return}var h=a.Z.isIEAllVersion()?window.clipboardData:t.clipboardData,p=this.options.copyAmount;if(p||(p="cell"),"cell"==p&&this.focusedCell.length>0){for(var u=[],c=[],g=this.getColumnOrder(),f=this.htmlInfo.body.rowAttrArr.length,m=this.getDataLength()*f,y=0,b=g.length,v=0,w=0,C=0;C<this.focusedCell.length;C++){var I=this.focusedCell[C],_=I.focusedRowIndex,x=I.focusedColIndex,S=this.getLocationRowCol(_,x);_=S.rowIndex,x=S.colIndex,w+=S.colSize*S.rowSize-1,m>_&&(m=_),y<_+S.rowSize-1&&(y=_+S.rowSize-1),b>x&&(b=x),v<x+S.colSize-1&&(v=x+S.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(b=0,v=g.length-1);var R=0;for(C=this.defaultColCnt+b;C<v+this.defaultColCnt;C++)1==this.hiddenList[C]&&(R+=1);if(this.focusedCell.length+w==(y-m+1)*(v-b-R+1)||1==this.options.ctrlShiftKey||"row"==this.options.focusMode&&1==this.options.rowCopy&&this.focusedCell.length==y-m+1)if(this.isDrillDown){var D=function(t){var e=t[t.length-1];F=F<e?e:F;for(var i=0;i<t.length;i++){var o=this.drilldown.getChildrenRowArr(t[i]);o.length>0&&D.call(this,o)}},T=this._dataList.getRealRowIndex(y),L=this.drilldown.getChildrenRowArr(T),k=this._dataList.getRealRowIndex(m),F=T;this.drilldown.isOpen(y)||D.call(this,L);for(C=k;C<=F;C++){for(var A=[],E=[],M=b;M<=v;M++){var O=(j=this.getOriginalRowCol(C,M)).colIndex,N=j.rowIndex;if((!j.noLeftTop||j.leftCell)&&1!=this.hiddenList[M+this.defaultColCnt]){for(var H=this.getCellInfo(O),G=!1,B=0;B<o.length;B++)if(o[B]==H.colID){G=!0;break}if(!G){var W=""!==H.options.escape?H.options.escape:this.options.escape,V=this.drilldown.statusArr
;if("display"==H.options.copyOption)X=!1===V[C]?this._getDisplayData(N,this.getColumnID(O)):this._getDisplayData(this.getRealRowIndex(N),this.getColumnID(O));else{var q=this.getColumnID(O);X=this.dataList.getColData(q)[N]}j.noLeftTop&&(X=""),K=W+""=="true"?WebSquare.xml._encode(X+""):X,(X||this.focusedCell.length>1)&&(A.push(K),E.push(X))}}}u.push(A),c.push(E)}}else{var Y=[];for(C=m;C<=y;C++){A=[],E=[];var Z=[];for(M=b;M<=v;M++){var j;O=(j=this.getOriginalRowCol(C,M)).colIndex,N=j.rowIndex;if((!j.noLeftTop||j.leftCell)&&1!=this.hiddenList[M+this.defaultColCnt]){for(H=this.getCellInfo(O),G=!1,B=0;B<o.length;B++)if(o[B]==H.colID){G=!0;break}if(!G){W=""!==H.options.escape?H.options.escape:this.options.escape;var P=!1;if(1==this.options.ctrlShiftKey){var z=this.getAllFocusedIndex();for(B=0;B<z.length;B++)if(N===z[B].row&&O===z[B].col){P=!0;break}Z.push(P)}X="display"==H.options.copyOption?this._getDisplayData(this.getRealRowIndex(N),this.getColumnID(O)):this.dataList.getCellData(N,this.getColumnID(O)),j.noLeftTop&&(X=""),K=W+""=="true"?WebSquare.xml._encode(X+""):X,(X||this.focusedCell.length>1)&&(1==this.options.ctrlShiftKey?!0===P&&(A.push(K),E.push(X)):(A.push(K),E.push(X)))}}}u.push(A),c.push(E),1==this.options.ctrlShiftKey&&Y.push(Z)}}else{var U=this.focusedCell[this.focusedCell.length-1];if(null!=U){var X,K;for(W=""!==(H=this.getCellInfo(U.focusedColIndex)).options.escape?H.options.escape:this.options.escape,C=0;C<o.length;C++)if(o[C]==H.colID)return;X="display"==H.options.copyOption?this._getDisplayData(this.getRealRowIndex(U.focusedRowIndex),this.getColumnID(U.focusedColIndex)):this.dataList._getCellData(U.focusedRowIndex,this.getColumnID(U.focusedColIndex)),K=W+""=="true"?WebSquare.xml._encode(X+""):X,u.push([K]),c.push([X])}}var J=Papa.unparse(u,{delimiter:"\t"});if(1==this.options.ctrlShiftKey){var $=Papa.unparse(Y,{delimiter:"\t"});h.setData("noFocus",$)}for(var Q="",tt=0;tt<c.length;tt++)0!=tt&&(Q+="\n"),Q+=c[tt].join("\t");if(this.options.noUseCSVParser)if(t.shiftKey||e){J=Papa.unparse(c,{delimiter:"\t"});h.setData("Text",J)}else h.setData("Text",Q),h.setData("gridView",J);else h.setData("Text",J)}d.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleCutEvent=function(t,e,i){try{if(!e)if(!1===d.f.fireEvent(this,"oncustomcut",t))return;var o=this.options.preventCopyColumn,n=o?o.split(","):[];if(this.options.preventCopy)return;if(r.I.browserCheck.safari){for(var l=document.activeElement,h=!1;null!=l;)l.id&&l.id==this.id&&(h=!0),l=l.parentNode;if(!h)return}var p=a.Z.isIEAllVersion()?window.clipboardData:t.clipboardData,u=this.options.copyAmount;if(u||(u="cell"),"cell"==u&&this.focusedCell.length>0){for(var c=[],g=[],f=this.getColumnOrder(),m=this.htmlInfo.body.rowAttrArr.length,y=this.getDataLength()*m,b=0,v=f.length,w=0,C=0,I=0;I<this.focusedCell.length;I++){var _=this.focusedCell[I],x=_.focusedRowIndex,S=_.focusedColIndex,R=this.getLocationRowCol(x,S);x=R.rowIndex,S=R.colIndex,C+=R.rowSize*R.colSize-1,y>x&&(y=x),b<x+R.rowSize-1&&(b=x+R.rowSize-1),v>S&&(v=S),w<S+R.colSize-1&&(w=S+R.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(v=0,w=f.length-1);var D=0;for(I=this.defaultColCnt+v;I<w+this.defaultColCnt;I++)1==this.hiddenList[I]&&(D+=1);if(this.focusedCell.length+C==(b-y+1)*(w-v-D+1)||1==this.options.ctrlShiftKey||"row"==this.options.focusMode&&1==this.options.rowCopy&&this.focusedCell.length==b-y+1)for(I=y;I<=b;I++){for(var T=[],L=[],k=v;k<=w;k++){var F=this.getOriginalRowCol(I,k),A=F.colIndex,E=F.rowIndex,M=k+this.defaultColCnt;if(1!=this.hiddenList[M]&&!(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(E,A)||e&&this.___getEditReadOnly(E,A)||this.options.checkDisabledOnCut&&this._getEditDisabled(E,A)||e&&this._getEditDisabled(E,A))){for(var O=this.getCellInfo(A),N=!1,H=0;H<n.length;H++)if(n[H]==O.colID){N=!0;break}if(!N&&!F.noLeftTop){var G=""!==O.options.escape?O.options.escape:this.options.escape
;if(Z="display"==O.options.copyOption?this._getDisplayData(this.getRealRowIndex(E),this.getColumnID(A)):this.dataList.getCellData(E,this.getColumnID(A)),j=G+""=="true"?WebSquare.xml._encode(Z+""):Z,""!==Z){var B={oldValue:Z,newValue:"",rowIndex:E,colIndex:A,colId:this.getColumnID(A)};d.f.fireEvent(this,"onviewchange",B)}T.push(j),L.push(Z),this.dataList.setCellData(E,this.getColumnID(A),"")}}}c.push(T),g.push(L)}else{var W=this.focusedCell[this.focusedCell.length-1],V=W.focusedRowIndex,q=this.getColumnID(W.focusedColIndex),Y=!1;if(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(V,q)&&(Y=!0),this.options.checkDisabledOnCut&&this._getEditDisabled(V,q)&&(Y=!0),null!=W&&!0!==Y){var Z,j;for(O=this.getCellInfo(q),I=0;I<n.length;I++)if(n[I]==O.colID)return;G=""!==O.options.escape?O.options.escape:this.options.escape;if(Z="display"==O.options.copyOption?this._getDisplayData(this.getRealRowIndex(V),q):this.dataList.getCellData(V,q),j=G+""=="true"?WebSquare.xml._encode(Z+""):Z,""!==Z){B={oldValue:Z,newValue:"",rowIndex:V,colIndex:W.focusedColIndex,colId:this.getColumnID(W.focusedColIndex)};d.f.fireEvent(this,"onviewchange",B)}this.dataList.setCellData(V,q,""),c.push([j]),g.push([Z])}}if(!e){for(var P=Papa.unparse(c,{delimiter:"\t"}),z="",U=0;U<g.length;U++)0!=U&&(z+="\n"),z+=g[U].join("\t");if(this.options.noUseCSVParser)if(t.shiftKey||i){P=Papa.unparse(g,{delimiter:"\t"});p.setData("Text",P)}else p.setData("Text",z),p.setData("gridView",P);else p.setData("Text",P)}}d.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.clickRightButtonCell=function(t){for(var e=a.Z.getDataPrefix("header_id"),i=a.Z.getDataPrefix("colIndex"),o=a.Z.getDataPrefix("tdIndex"),s=a.Z.getDataPrefix("rowIndex"),r=d.f.getTarget(t);r&&"TD"!=r.tagName&&"TH"!=r.tagName&&"DIV"!=r.tagName;)r=r.parentNode;var n=r&&this.hasClass(r,this.options.headerTdClass);if(r&&this.hasClass(r,this.options.bodyTdClass)&&(n=!1),n)d.f.preventDefault(t),d.f.fireEvent(this,"onheaderrightbuttonclick",r.getAttribute(e));else{for(var l=r;l;){if("TH"===l.tagName&&this.hasClass(l,this.options.headerTdClass)){n=!0;break}if("TD"===l.tagName&&this.hasClass(l,this.options.bodyTdClass)){n=!1;break}if("DIV"===l.tagName&&this.hasClass(l,"w2grid_dataLayer")&&0===this.getRowCount()){n=!1;break}l=l.parentNode}r=l}var h,p,u,c,g,f,m=null!=this.editedCell;if(!n&&m&&(h=this.editedCell.editRowIndex,p=this._dataList.getColumnIndex(this.editedCell.id),I=this.getCellInfo(this.editedCell.id),u=this.getColumnIndex(this.editedCell.id),c=this._grid.getRealRowIndex(h),g=this._dataList.dataArr[c*this._dataList.getColumnCount()+p],f=I.comp&&I.comp.selectedIndex),n&&this.options.useHeaderContextMenu){var y=void 0,b=-1,v=parseInt(r.getAttribute(i),10)-this.defaultColCnt;(L={}).result=y,L.rowIndex=b,L.colIndex=v,L.event=t;var w=[];if(this.focusedCell)for(var C=0;C<this.focusedCell.length;C++)w.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[C].focusedRowIndex),colIndex:this.focusedCell[C].focusedColIndex});L.focusedCell=w,(T={isHeader:!0}).headerId=r.getAttribute(e),(k=d.f.fireEvent(this,"oncontextopen",b,v,w,T))?this.createContextMenu(L,k):this.contextMenu?this.showContextMenu(L):this.createContextMenu(L)}else if(r&&"TD"==r.tagName&&this.hasClass(r,this.options.bodyTdClass)){var I;if(!1===(y=this.__setFocusedCell(t,r,{allowContextMenuMultiCell:this.options.allowContextMenuMultiCell}))){if(this.focusedCell.length>0)for(C=0;C<this.focusedCell.length;C++)this._applyFocusedCellOut(this.focusedCell[C]);var _=r.className,x=parseInt(r.getAttribute(o)),S=parseInt(x/this.realRowDataLength);null!=_.match("rowNum")?(b=S,v="rowNum"):null!=_.match("rowStatus")?(b=S,v="rowStatus"):null!=_.match("groupby")?(b="groupby",v=-1):null!=_.match("Subtotal")&&(b="subtotal",v="number"==typeof(v=parseInt(r.getAttribute(i),10))?v:-1)}else r&&(this.hasClass(r,"w2grid_textImage")||this.hasClass(r,"w2grid_textImage_image"))?(b=parseInt(r.getAttribute(s),10),v=parseInt(r.getAttribute(i),10),
this._setFocusedCell(b,v)):n?(b=parseInt(r.getAttribute(s),10),v=parseInt(r.getAttribute(i),10)):(b=this.getFocusedRowIndex(),v=this.getFocusedColumnIndex());if(!n&&r&&m){var R=this._dataList.dataArr[c*this._dataList.getColumnCount()+p];if(g!=R){var D={oldValue:g,newValue:R,rowIndex:h,colIndex:u,colId:this.getColumnID(u)};isNaN(f)||(D.oldSelectedIndex=f,D.newSelectedIndex=I&&I.comp&&I.comp.selectedIndex),d.f.fireEvent(this,"onviewchange",D)}}if(this.options.senseReader)("text"!=(I=this.getCellInfo(v)).options.inputType&&"secret"!=I.options.inputType||this.___getEditReadOnly(b,v)||this.options.contextMenu)&&d.f.preventDefault(t);else d.f.preventDefault(t);if(d.f.fireEvent(this,"onrightbuttonclick",this._getGroupbyDisplayRowIndex(b),v,t),this.options.contextMenu){(L={}).result=y,L.rowIndex=b,L.colIndex=v;w=[];if(this.focusedCell)for(C=0;C<this.focusedCell.length;C++)w.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[C].focusedRowIndex),colIndex:this.focusedCell[C].focusedColIndex});L.focusedCell=w,L.event=t;var T={isHeader:!1};(k=d.f.fireEvent(this,"oncontextopen",this._getGroupbyDisplayRowIndex(b),v,w,T))?this.createContextMenu(L,k):this.contextMenu?this.showContextMenu(L):this.createContextMenu(L)}}else if(r&&"DIV"==r.tagName&&this.hasClass(r,"w2grid_dataLayer")&&0===this.getRowCount()&&(d.f.preventDefault(t),d.f.fireEvent(this,"onrightbuttonclick",-1,-1,t),this.options.contextMenu)){var L;(L={result:!1,rowIndex:-1,colIndex:-1,focusedCell:null}).event=t;var k;T={isHeader:!1};(k=d.f.fireEvent(this,"oncontextopen",-1,-1,null,T))?this.createContextMenu(L,k):this.contextMenu?this.showContextMenu(L):this.createContextMenu(L)}},f.prototype.fireImageClick=function(t,e){var i=this.getCellInfo(e),o=this._getEditDisabled(t,e);if(this.options.useImageClick||0==o){var s=a.Z.getGlobalFunction(i.options.imageClickFunction,this.scope_id);"function"==typeof s&&s.call(this,t,e,this.dataList._getCellData(t,e))}},f.prototype.gridHeaderOut=function(t){try{for(var e=d.f.getRelatedTarget(t);!this.hasClass(e,this.options.headerTdClass)&&null!=e&&e!=this.render&&e!=document.documentElement;)e=e.parentNode;if(!e)return;var i=a.Z.getDataPrefix("header_id"),o=e.getAttribute(i);if(o===this._headerOverElemId)return;var r={};r.newHeaderId=o;for(var n=d.f.getTarget(t),l=!1,h=this.event.getTargetIterator(t,this.render);h.next();)h.match(this.options.headerTdClass)&&(n=h.getElement(),h.stop(),l=!0);r.oldHeaderId=l?n.getAttribute(i):null,r.header_id=r.oldHeaderId,r.id=n.id,this._headerOverElemId="",d.f.fireEvent(this,"onheadermouseout",r)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.gridOut=function(t){var e=d.f.getTarget(t);if(this.overElem&&(e.id==this.id+"_dataLayer"||e.id==this.overElem.id||""==e.id)){if(this.options.rowMouseOver&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),"TD"===this.overElem.tagName){var i=a.Z.getDataPrefix("col_id"),o={};this.overElem.getAttribute(i)&&(o.rowIndex=this.getElemRowIndex(this.overElem),o.colIndex=this.getColumnIndex(this.overElem.getAttribute(i))),d.f.fireEvent(this,"onbodymouseout",o)}this.bodyOut(t,this.overElem),this.overElem=null}},f.prototype.addRowOverStyle=function(t){for(var e=a.Z.getDataPrefix("trIndex"),i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("style_bak");null!=t&&(1!=t.nodeType||null==t.getAttribute(e));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var s=parseInt(t.getAttribute(e));s>0;)s--,t=a.Z.prev(t);var r=a.Z.first(t),n=parseInt(r.getAttribute(i));if(!isNaN(n)){n=parseInt(n/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var l=this.options.rowMouseOverColor.wq_trim(),h=""==this.options.selectedCellOverColor?"":this.options.selectedCellOverColor.wq_trim(),d=""==this.options.selectedRowOverColor?"":this.options.selectedRowOverColor.wq_trim(),p=0;p<this.realRowDataLength;p++){var u=this.all_data_td_list[n+p],c=l
;if(!(""==d||"row"!=this.options.focusMode&&"both"!=this.options.focusMode||"row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&p<this.options.fixedColumn))for(var g=parseInt(u.getAttribute(i)),f=parseInt(g/this.realRowDataLength)+this.rowIndex,m=0;m<this.focusedCell.length;m++)if(f==this.focusedCell[m].focusedRowIndex){c=d;break}if(""!=h&&("cell"==this.options.focusMode||"both"==this.options.focusMode)){g=parseInt(u.getAttribute(i)),f=parseInt(g/this.realRowDataLength)+this.rowIndex;var y=g%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);for(m=0;m<this.focusedCell.length;m++)if(f==this.focusedCell[m].focusedRowIndex&&y==this.focusedCell[m].focusedColIndex){c=h;break}}if(!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&p<this.options.fixedColumn)){if(p<this.defaultColCnt){var b=u.className;((""===this.options.rowNumBackgroundColor||!0===this.options.rowNumRowMouseOverColor)&&b.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||b.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)&&(u.style.backgroundColor=c,a.Z.isIEAllVersion(11)&&this.__addClass(u,"w2BackgroundClip"))}else u.style.backgroundColor=c,a.Z.isIEAllVersion(11)&&this.__addClass(u,"w2BackgroundClip");this.options.rowMouseOverClass&&this.__addClass(u,this.options.rowMouseOverClass)}u.removeAttribute(o)}}}},f.prototype.removeRowOverStyle=function(t,e){if(!(this.options.tooltipHeader&&t&&t.getElementsByTagName("TH").length>0)){for(var i=a.Z.getDataPrefix("trIndex"),o=a.Z.getDataPrefix("tdIndex"),s=a.Z.getDataPrefix("or_bgColor"),r=a.Z.getDataPrefix("style_bak");null!=t&&(1!=t.nodeType||null==t.getAttribute(i));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var n=parseInt(t.getAttribute(i));n>0;)n--,t=a.Z.prev(t);var l=a.Z.first(t),h=parseInt(l.getAttribute(o));if(!isNaN(h)){h=parseInt(h/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var d=0;d<this.realRowDataLength;d++){var p=this.all_data_td_list[h+d];if(d<this.defaultColCnt){var u=p.className;if((""===this.options.rowNumBackgroundColor||!0===this.options.rowNumRowMouseOverColor)&&u.indexOf(this.options.bodyTdClass+"_rowNumber")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(var c=parseInt(p.getAttribute(o)),g=parseInt(c/this.realRowDataLength)+this.rowIndex,f=!1,m=0;m<this.focusedCell.length;m++)if(g==this.focusedCell[m].focusedRowIndex){f=!0;break}p.style.backgroundColor=f?this.options.selectedRowColor.wq_trim():""}else p.style.backgroundColor="";else if(u.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(c=parseInt(p.getAttribute(o)),g=parseInt(c/this.realRowDataLength)+this.rowIndex,f=!1,m=0;m<this.focusedCell.length;m++)if(g==this.focusedCell[m].focusedRowIndex){f=!0;break}p.style.backgroundColor=f?this.options.selectedRowColor.wq_trim():""}else p.style.backgroundColor=""}else!0!==e&&(p.style.backgroundColor=p.getAttribute(s)||"");this.hasClass(p,"w2BackgroundClip")&&this.__removeClass(p,"w2BackgroundClip"),!0!==e&&p.removeAttribute(r),this.options.rowMouseOverClass&&this.hasClass(p,this.options.rowMouseOverClass)&&this.__removeClass(p,this.options.rowMouseOverClass)}}}}},f.prototype.handleKeyDownEvent=function(t){if(!(this.parentControl&&this.parentControl.options&&"gridViewItemTable"===this.parentControl.options.pluginName||"gridItemTable"===this.parentControl.options.pluginName)&&0!=d.f.fireEvent(this,"onkeydown",t)){this.lastEvent=t;var e=WebSquare.event.getTarget(t);if(this.headerFocus);else{var i,o;if(e&&(e.className.match("w2grid_head_sort_div_main_btn")||e.className.match("w2grid_customFilter_open")))for(var s=e;s;){if("TH"===s.tagName&&this.hasClass(s,this.options.headerTdClass)){var r=WebSquare.util.getDataPrefix("header_id");i=s.getAttribute(r),e.className.match("w2grid_head_sort_div_main_btn")?o="sort":e.className.match("w2grid_customFilter_open")&&(o="filter");break}
s=s.parentNode}if(!t.shiftKey&&9==t.keyCode&&i&&this.options.senseReader&&i===this._lastHeaderElementId&&o===this._lastHeaderElementType)this._setFirsCellFocus(t);else{if(e&&e.className.match("w2grid_start_div")&&this.options.senseReader&&"none"===this.options.focusMode)return;this.handleBodyKeyDown(t)}}}},f.prototype.handleKeyUpEvent=function(t){try{if(0==d.f.fireEvent(this,"onkeyup",t))return;if(this.lastEvent=t,this.editedCell&&this.editedCell._getEditedValue){var e=this.editedCell.options.inputType;if("custom"===e&&!this.editedCell.internal&&this.editedCell.editRowIndex){var i=this.getRealRowIndex(this.editedCell.editRowIndex);e=this.editedCell.cellManagerHashByRowIndex[i].options.inputType}if("text"===e||"textarea"===e||"calendar"===e||"textImage"===e||"secret"===e){var o=t.charCode?t.charCode:t.keyCode,r={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:e,keyCode:o};d.f.fireEvent(this,"oneditkeyup",r)}}else null!=this.beforeEditedCellInfo&&d.f.fireEvent(this,"oneditkeyup",this.beforeEditedCellInfo);if(this.beforeEditedCellInfo=null,!0===this.options.accessibility)for(var a=this.event.getTargetIterator(t,this.render);a.next();)a.match(this.options.bodyTdClass)&&a.stop(),a.match(this.options.headerTdClass)&&(this.removeFocusedCell(),a.stop())}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.headerOver=function(t,e){if(!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)){var i=e.offsetWidth;if(!(i<2)&&e.firstChild){var o=a.Z.getDataPrefix("col_id"),r=e.getAttribute(o),n=null;if(r){var l=this.getHeaderInfo(r),h=(f=this.getHeaderInputType(r),l.options.embeddedInput);if(h&&"text"==f){var d=this.getElemRowIndex(e),u=this.getColumnIndex(e.getAttribute(o));h=!this._getEditDisabled(d,u)&&!this.___getEditReadOnly(d,u)}if("textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)n=e.getElementsByTagName("th")[0];else{var c=this.event.getTargetIterator(t),g="w2grid_textImage_image";for("true"===l.options.viewTypeIconImage&&("autoComplete"==f?g=this.options.bodyTdClass+"_autoComplete_img":"calendar"==f&&(g=this.options.bodyTdClass+"_calendar_div_img"));c.next();)if(c.match(null,null,"th")&&c.getElement().id){n=this.hasClass(e,g)?e.previousSibling:e,e=c.getElement();break}}}else var f="text";if("text"==f||"textarea"==f||"textImage"==f||"link"==f||"calendar"==f||"expression"==f||"select"==f&&!h||"drilldown"==f||"autoComplete"==f||"checkcombobox"==f||"button"==f||this.options.showImageTooltip&&"image"==f){var m;"textarea"==f?(m=e.cloneNode(!0)).firstChild.style.width="":m=n||e;var y=i,b=e.offsetHeight,v=WebSquare.style.getStyle(e,"text-overflow"),w=20,C=b+3;try{this.options.tooltipPositionX&&(w=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(y,b)),this.options.tooltipPositionY&&(C=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(y,b))}catch(t){p.v.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.Y.printStackTrace(t,null,this)}this.options.tooltipShowAlwaysColumns;if(this.options.tooltipHeaderShowAlways){var I=WebSquare.style.getAbsoluteLeft(e)+w,_=WebSquare.style.getAbsoluteTop(e)+C,x="";if("text"==f&&h)x=m.firstChild.value;else if("link"==f)"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span"),
x=m.firstChild.innerHTML;else if("textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage)x="NOBR"==n.firstChild.tagName||"SPAN"==n.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?m.firstChild.innerHTML:m.innerHTML;else if("image"==f)x=m.firstChild.innerHTML;else if("drilldown"==f)x="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else{x="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?m.firstChild.innerHTML:m.innerText.wq_trim(),"TABLE"==e.firstChild.tagName&&"sort"==e.firstChild.getAttribute("sort")&&x.split("\t")&&x.split("\t").length>1&&(x=x.split("\t")[0])}if(this.options.tooltipFormatterHeader)try{if("function"==typeof(F=a.Z.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=F(e.getAttribute(o),x)}catch(t){s.Y.printStackTrace(t,null,this)}""!=x&&this.showTooltip(I,_,x,C)}else if("ellipsis"==v){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=m.className,"text"==f&&h?(this.toolTipRuler.innerHTML="<div>"+m.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(m.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(m.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(m.firstChild,"font-weight")):(this.toolTipRuler.innerHTML=m.innerHTML,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(m,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(m,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(m,"font-weight"));var S=this.toolTipRuler.firstChild.offsetWidth;if("textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage)var R=n.clientWidth;else R=e.clientWidth;if(3!=m.firstChild.nodeType){var D=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),T=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");S-=parseInt(D||"0",10),S-=parseInt(T||"0",10),"textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage?(R-=parseInt(WebSquare.style.getStyle(n.firstChild,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(n.firstChild,"padding-right"),10),R-=parseInt(WebSquare.style.getStyle(n,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(n,"padding-right"),10)):(R-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),R-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(R<S||"image"==f||R==S&&e.clientWidth<e.scrollWidth){I=WebSquare.style.getAbsoluteLeft(e)+w,_=WebSquare.style.getAbsoluteTop(e)+C,x="";if("text"==f&&h?x=m.firstChild.value:"link"==f?("NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span"),x=m.firstChild.innerHTML):x="textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage?"NOBR"==n.firstChild.tagName||"SPAN"==n.firstChild.tagName&&n.firstChild.className.indexOf("w2grid_span")>-1?m.firstChild.innerHTML:m.innerHTML:"image"==f?m.firstChild.innerHTML:"drilldown"==f?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?m.firstChild.innerHTML:m.innerText.wq_trim(),
this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatterHeader)try{if("function"==typeof(F=a.Z.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=F(e.getAttribute(o),x)}catch(t){s.Y.printStackTrace(t,null,this)}x.match('href=""')&&(x=x.wq_replaceAll('href=""',"")),this.showTooltip(I,_,x,C)}else this.render.removeChild(this.toolTipRuler)}else{var L=e.firstChild.offsetWidth;if(!0===this.options.showSortableImage){var k=e.firstChild.getElementsByTagName(this.options.dataTag)[0];k&&("NOBR"==k.tagName||"SPAN"==k.tagName&&k.className.indexOf("w2grid_span")>-1)&&(L=k.offsetWidth+parseInt(WebSquare.style.getStyle(e.firstChild,"margin-left"),10))}if(i+3<L){I=WebSquare.style.getAbsoluteLeft(e)+w,_=WebSquare.style.getAbsoluteTop(e)+C,x="";if("text"==f&&h?x=m.firstChild.value:"link"==f?("NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span"),x=m.firstChild.innerHTML):x="image"==f?m.firstChild.innerHTML:"drilldown"==f?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?m.firstChild.innerHTML:m.innerText.wq_trim(),this.options.tooltipFormatterHeader)try{var F;if("function"==typeof(F=a.Z.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=F(e.getAttribute(o),x)}catch(t){s.Y.printStackTrace(t,null,this)}this.showTooltip(I,_,x,C)}}}}}},f.prototype.bodyOver=function(t,e){var i=a.Z.getDataPrefix("col_id");if(this.options.rowStatusTooltipDisplay&&e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0){var o=c=e.offsetWidth,r="",n=20,l=(x=e.offsetHeight)+3;try{this.options.tooltipPositionX&&(n=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(o,x)),this.options.tooltipPositionY&&(l=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(o,x))}catch(t){p.v.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.Y.printStackTrace(t,null,this)}var h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,u=this.getElemRowIndex(e);switch(this.getRowStatus(u)){case"C":r=WebSquare.language.getMessage("Grid_rowStatus_insert");break;case"R":r=WebSquare.language.getMessage("Grid_rowStatus_initialValue");break;case"U":r=WebSquare.language.getMessage("Grid_rowStatus_update");break;case"D":r=WebSquare.language.getMessage("Grid_rowStatus_delete");break;case"V":r=WebSquare.language.getMessage("Grid_rowStatus_D_After_C");break;default:return}this.options.tooltipFormatter&&(r=this._showTooltopFormatter(e.id,r,!0)),""!=r&&this.showTooltip(h,d,r,l)}else{if(!this.options.tooltipDisplay)return;if(e.className.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)return;var c;if((c=e.offsetWidth)<2||!e.firstChild)return;var g=e.getAttribute(i);if(this.options.tooltipDisplayColumn&&g&&-1===this.options.tooltipDisplayColumn.indexOf(g))return;var f=null;if(g){var m=this.getCellInfo(g),y=m.options.escape;if(0==m.internal&&"custom"==m.options.inputType){u=this.getRealRowIndex(this.getElemRowIndex(e));m=m.cellManagerHashByRowIndex[u]?m.cellManagerHashByRowIndex[u]:m}I=m.options.inputType;var b=m.options.embeddedInput;if(b&&"text"==I){u=this.getElemRowIndex(e);var v=this.getColumnIndex(e.getAttribute(i));b=!this._getEditDisabled(u,v)&&!this.___getEditReadOnly(u,v)}if("textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)f=e.getElementsByTagName("td")[0];else{var w=this.event.getTargetIterator(t),C="w2grid_textImage_image"
;for("true"===m.options.viewTypeIconImage&&("autoComplete"==I?C=this.mainGrid.options.bodyTdClass+"_autoComplete_img":"calendar"==I&&(C=this.mainGrid.options.bodyTdClass+"_calendar_div_img"));w.next();)if(w.match(null,null,"td")&&w.getElement().id){f=this.hasClass(e,C)?e.previousSibling:e,e=w.getElement();break}}}else var I="text";if("checkbox"==I||"radio"==I||"text"==I||"textarea"==I||"textImage"==I||"link"==I||"calendar"==I||"expression"==I||"select"==I||"drilldown"==I||"autoComplete"==I||"checkcombobox"==I||"button"==I||this.options.showImageTooltip&&"image"==I){var _;"textarea"==I?(_=e.cloneNode(!0)).firstChild.style.width="":_=f||e;o=c;var x=e.offsetHeight,S=WebSquare.style.getStyle(e,"text-overflow");n=20,l=x+3;try{this.options.tooltipPositionX&&(n=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(o,x)),this.options.tooltipPositionY&&(l=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(o,x))}catch(t){p.v.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.Y.printStackTrace(t,null,this)}var R=this.options.tooltipShowAlwaysColumns.split(",");if(this.options.tooltipShowAlways||R.indexOf(g)>-1){h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,r="";if("text"==I&&b)r=_.firstChild.value;else if("link"==I)r="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML;else if("textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage)r="NOBR"==f.firstChild.tagName||"SPAN"==f.firstChild.tagName&&f.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:_.innerHTML;else if("image"==I)r=_.firstChild.src;else if("drilldown"==I)r="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else if("select"==I&&"ul"===m.options.tableRender)r=_.innerText.wq_trim();else if("select"==I&&b)r=e.querySelector("select").value;else if("checkbox"==I||"radio"==I){(T=_.getElementsByTagName("label")[0])&&(r=T.innerText)}else r="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim();if(this.options.tooltipFormatter){var D=c<e.scrollWidth;r=this._showTooltopFormatter(e.id,r,D)}""!=r&&this.showTooltip(h,d,r,l,y)}else if("ellipsis"==S){var T,L;if(("checkbox"==I||"radio"==I)&&!(T=_.getElementsByTagName("label")[0]))return;if(this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=_.className,"text"==I&&b)this.toolTipRuler.innerHTML="<div>"+_.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(_.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(_.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(_.firstChild,"font-weight");else{if("drilldown"==I&&"line"==m.options.depthType){var k,F=this.options.dataTag.toUpperCase();"NOBR"===F?"NOBR"==(k=_.getElementsByTagName(this.options.dataTag)[0]).tagName&&(this.toolTipRuler.innerHTML=k.outerHTML):"SPAN"===F&&"SPAN"==(k=_.getElementsByClassName("w2grid_span")[0]).tagName&&k.className.indexOf("w2grid_span")>-1&&(this.toolTipRuler.innerHTML=k.outerHTML)}else if("checkbox"==I||"radio"==I)this.toolTipRuler.innerHTML=T.outerHTML;else if("select"==I&&b){w=this.event.getTargetIterator(t);for(var A=null;w.next();)if(w.match(this.options.bodyTdClass,null,"td")&&w.getElement().id){A=w.getElement();break}if(null!=A){
var E=this.getInput(m,A).dom.select,M=document.createElement("div"),O=document.createElement("select");O.className=E.className;var N=document.createElement("option");N.value=E.value,N.text=E.value,O.add(N),M.appendChild(O),this.toolTipRuler.innerHTML=M.innerHTML,L=E.value}}else this.toolTipRuler.innerHTML=_.innerHTML;this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(_,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(_,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(_,"font-weight")}var H=this.toolTipRuler.firstChild.offsetWidth;if(null!=e.getBoundingClientRect&&(H=this.toolTipRuler.firstChild.getBoundingClientRect().width),"textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage){var G=f.clientWidth;null!=e.getBoundingClientRect&&(G=f.getBoundingClientRect().width)}else{G=e.clientWidth;if(null!=e.getBoundingClientRect){var B=(WebSquare.style.getSize(e,"outerwidth")-WebSquare.style.getSize(e,"width"))/2;G=e.getBoundingClientRect().width-B}"drilldown"==I&&"line"==m.options.depthType?G=e.clientWidth-e.firstChild.clientWidth:"checkbox"!=I&&"radio"!=I||(G=e.clientWidth-WebSquare.style.getSize(e.firstChild,"outerMarginWidth"))}if(3!=_.firstChild.nodeType){var W=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),V=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");H-=parseInt(W||"0",10),H-=parseInt(V||"0",10),"textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage?(G-=parseInt(WebSquare.style.getStyle(f.firstChild,"padding-left"),10),G-=parseInt(WebSquare.style.getStyle(f.firstChild,"padding-right"),10),G-=parseInt(WebSquare.style.getStyle(f,"padding-left"),10),G-=parseInt(WebSquare.style.getStyle(f,"padding-right"),10)):(G-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),G-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),G-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),G-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(G<H||"image"==I||G==H&&e.clientWidth<e.scrollWidth){h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,r="";r=L||("text"==I&&b?_.firstChild.value:"link"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML:"textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage?"NOBR"==f.firstChild.tagName||"SPAN"==f.firstChild.tagName&&f.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:_.innerHTML:"image"==I?_.firstChild.src:"drilldown"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim()),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatter&&(r=this._showTooltopFormatter(e.id,r,!0)),r.match('href=""')&&(r=r.wq_replaceAll('href=""',"")),this.showTooltip(h,d,r,l,y)}else this.render.removeChild(this.toolTipRuler)}else{if(c+3<e.firstChild.offsetWidth){h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,r=""
;r="text"==I&&b?_.firstChild.value:"link"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML:"image"==I?_.firstChild.src:"drilldown"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim(),this.options.tooltipFormatter&&(r=this._showTooltopFormatter(e.id,r,!0)),this.showTooltip(h,d,r,l,y)}}}}},f.prototype._showTooltopFormatter=function(t,e,i){try{var o=document.getElementById(t),r=a.Z.getDataPrefix("col_id"),n=a.Z.getDataPrefix("colindex"),l=a.Z.getDataPrefix("trindex"),h=a.Z.getGlobalFunction(this.options.tooltipFormatter,this.scope_id);if("function"==typeof h){var d,p,u="body";this.hasClass(o,this.options.subtotalTdClass)?(u="subtotal",d=parseInt(o.parentNode.getAttribute(l),10),p=parseInt(o.getAttribute(n),10)):this.hasClass(o,this.options.footerTdClass)?(u="footer",d=parseInt(o.parentNode.getAttribute("data-trindex"),10),p=parseInt(o.getAttribute(n),10)):(d=this.getElemRowIndex(o),p=this.getColumnIndex(o.getAttribute(r))),e=h(d,p,e,i,u)}return e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.bodyOut=function(t,e){var i=this;(i.options.tooltipDisplay||i.options.headerTooltipDisplay||this.options.tooltipHeader||i.options.rowStatusTooltipDisplay)&&e&&i.hideTooltip()},f.prototype.showTooltip=function(t,e,i,o,n){if(null==this.editedCell){try{var l=r.I.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(l){var h=a.Z.getGlobalFunction(l,this.scope_id),p=!0;if("function"==typeof h&&(p=h(this)),!p)return}}catch(t){s.Y.printStackTrace(t)}var u=document.body.scrollWidth,c=this.options.useMobileTooltip&&this.isMobile?"w2grid_mobileTooltip":"";this.tooltip||(this.tooltip=new WebSquare.uiplugin.output(this.id+"_tooltip",{className:"w2grid_tooltip "+this.options.tooltipClass+c,style:"position:absolute;"+this.options.tooltipStyle}),this.tooltip.parentFrame=this.parentFrame,this.tooltip.writeTo(WebSquare.getBody()),this.tooltip.activate(),"click"===this.options.tooltipHide?this.tooltip.render.onclick=function(){this.style.display="none"}:this.tooltip.render.onmouseover=function(){this.style.display="none"}),"click"===this.options.tooltipHide&&(1==WebSquare.getBody().hasClass("w2drag_activate")?(this.tooltip.render.onclick=null,this.tooltip.render.onmouseover=function(){this.style.display="none"}):(this.tooltip.render.onclick=function(){this.style.display="none"},this.tooltip.render.onmouseover=null)),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",t+"px"),this.tooltip.setStyle("top",e+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip");var g=n?WebSquare.xml._encode(i):i,f=this,m=this.getCellInfo(this.getFocusedColumnIndex()).options.inputType;if(this.options.useMobileTooltip&&(a.Z.isMobile()||this.isHammerEnabled())){var y="",b="<button type='button' id='"+this.id+"_mobileTooltipCloseButton' onclick='' class='w2grid_mobileTooltipClose_button'>X</button>";if("link"==m){y="<p id='"+this.id+"_toGoButton'><a href class='w2grid_mobileTooltip_anchor' onClick='event.returnValue=false; return false;'>"+g+"</a></p>";y+=b,this.tooltip.render.innerHTML=y,this.tooltip.event.addListener(this.tooltip.render.querySelector(".w2grid_mobileTooltip_anchor"),"onclick",(function(t){try{var e=f.getFocusedColumnIndex();d.f.fireEvent(f,"oncellclick",f._getGroupbyDisplayRowIndex(f._getFocusedRowIndex()),e,f.getFocusedColumnID())}catch(t){s.Y.printStackTrace(t,null,this)}}))}else"text"==m&&(y="<p>"+g+"</p>"+b,this.tooltip.render.innerHTML=y)}else this.tooltip.render.innerHTML=g;d.f.fireEvent(this,"ontooltipshow")
;var v=this.tooltip.render.offsetTop+this.tooltip.render.offsetHeight+20,w=document.body.scrollHeight;if(null!=WebSquare.BootLoader.fullViewRatio&&(w=document.body.clientHeight+Math.abs(document.body.getBoundingClientRect().top)),v>w){var C=e-(o+this.tooltip.render.offsetHeight);C<0&&(C=0),this.tooltip.setStyle("top",C+"px")}if(document.body.scrollWidth>u){var I=t-(document.body.scrollWidth-u);I<0&&(I=0),this.tooltip.setStyle("left",I+"px")}this.options.tooltipDisplayTime>0&&r.I.setTimer(this.hideTooltip,{key:this.id+"_tooltip_hide_timer",caller:this,delay:this.options.tooltipDisplayTime})}},f.prototype.hideTooltip=function(){this.tooltip&&(this.options.tooltipDisplayTime>0&&r.I.clearTimer(this.id+"_tooltip_hide_timer"),d.f.fireEvent(this,"ontooltiphide"),this.tooltip.setStyle("display","none"))},f.prototype.bodyClick=function(t,e,i){try{var r=this.getLastFocusedCell().focusedTd;this.options.rowMouseOver&&this.removeRowOverStyle(this.lastOverSrc,"grid_body_row_over","grid_body_row");var n=a.Z.getDataPrefix("tdIndex"),l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("colIndex"),p=this.rowIndex,u=parseInt(e.getAttribute(n)),c=(E=parseInt(u/this.realRowDataLength))+this.rowIndex,g=e.getAttribute(l),f=this._dataList.getRowPosition(),m=this.getColumnIndex(this._dataList.getColumnPosition()),y=E+p,b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(g&&(z=this.getCellInfo(g)),"number"!=typeof(N=this.dataList.getRealRowIndex(c)))return void(N&&"header"==N.type&&this.toggleGroup(N.groupId));if(this.options.focusDefaultColumn){var v=e.getAttribute("id")||"",w="_headerRowNumber"===v.slice(0,16),C="_headerRowStatus"===v.slice(0,16);if(w||C)return this.__setFocusedCell(t,e,{editMode:!1}),void(C?d.f.fireEvent(this,"onrowstatusclick",y):d.f.fireEvent(this,"onrownumclick",y))}if(null==g)return;this.moveDirection=null;var I=m-b,_=f-y;0==I&&0==_?this.moveDirection="none":(I>0||I<0)&&(_>0||_<0)?this.moveDirection="both":I>0||I<0?this.moveDirection="column":(_>0||_<0)&&(this.moveDirection="row");var x=a.Z.getDataPrefix("editModeEvent"),S=e.getAttribute(x)||"",R=!1;if(""!=S&&"onsecondclick"==S.toLowerCase()||""==S&&"onsecondclick"==this.options.editModeEvent.toLowerCase())for(var D=0;D<this.focusedCell.length;D++)this.focusedCell[D].focusedRowIndex==y&&this.focusedCell[D].focusedColIndex==b&&(R=!0);z=this.getCellInfo(e);var T,L=!0,k=d.f.getTarget(t);if(!z.options.blockSelect&&("button"!==z.options.inputType||"button"===z.options.inputType&&k&&"TD"===k.tagName)){var F,A=!0;if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&"link"!==z.options.inputType&&(A=!1),this.options.preventMultipleClick&&"checkbox"===z.options.inputType&&k&&"LABEL"===k.tagName&&(A=!1),A){if("enter"===this.options.drilldownToggle&&this.isMobile&&this.isHammerEnabled())if(1==this.focusedCell.length)if((z=this.getCellInfo(this.focusedCell[0].focusedColIndex))&&"drilldown"==z.options.inputType){u=parseInt(e.getAttribute(n));var E=parseInt(u/this.realRowDataLength),M=(g=parseInt(e.getAttribute(h)),y=this._getGroupbyDisplayRowIndex(E+p),b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),this.focusedCell[0].focusedColIndex),O=this.focusedCell[0].focusedRowIndex;if(y===O&&b===M){var N=this.dataList.getRealRowIndex(O);this.toggle(N)}}var H={editMode:"none"==z.options.focusMode,dont_fixScroll:this.options.CellClickFixScrollX};o.q.extend(H,i),F=this.__setFocusedCell(t,e,H)}"multiCell"===F&&(L=!1),z.options.embeddedInput&&(this.focusedByApi=!1)}if(t.altKey&&!0===this.options.contextMenuAltClick)return void this.clickRightButtonCell(t);var G=!0;switch(T=a.Z.isIE()?t.srcElement:t.target,z.options.inputType){case"radio":case"checkbox":if("INPUT"!=T.tagName)if(!this.options.checkOnCellClick||"LABEL"==T.tagName||this._getEditDisabled(y,b)||this.___getEditReadOnly(y,b))G=!1;else{var B=e.getElementsByTagName("input")[0];!B||"checkbox"!=z.options.inputType&&B.checked||(B.checked=!B.checked)}break;case"drilldown":
this.options.ignoreToggleOnDisabled&&this._getEditDisabled(c,g)&&(G=!1)}var W,V=!1,q=this.isHammerEnabled();if(G&&!(W=this.setCellClickEdit(e))){S=e.getAttribute(x)||z.options.editModeEvent||"";var Y=null!=r&&r===e,Z=""!=S&&"onclick"==S.toLowerCase()||""==S&&"onclick"==this.options.editModeEvent.toLowerCase()||R;if((!q||Y)&&Z){if(!this._getEditDisabled(c,g)){u=parseInt(e.getAttribute(n)),E=parseInt(u/this.realRowDataLength),g=parseInt(e.getAttribute(h));var j=e.getAttribute(l);y=this._getGroupbyDisplayRowIndex(E+p),b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.hideTooltip(),!("button"===(z=this.getCellInfo(b)).options.inputType||!z.options.embeddedInput&&("checkbox"===z.options.inputType||"radio"===z.options.inputType)&&this.options.preventMultipleClick)){var P=!1;if(0==z.internal&&"custom"==z.options.inputType)("button"===(U=z.cellManagerHashByRowIndex[this.getRealRowIndex(y)]?z.cellManagerHashByRowIndex[this.getRealRowIndex(y)]:z).options.inputType||!U.options.embeddedInput&&("checkbox"===U.options.inputType||"radio"===U.options.inputType)&&this.options.preventMultipleClick)&&(P=!0);P||"drilldown"==z.options.inputType&&this.options.ignoreCellClick&&W||d.f.fireEvent(this,"oncellclick",y,b,j)}V=!0}L&&this.setEditMode(e)}}if(!V&&!this._getEditDisabled(c,g)){var z;u=parseInt(e.getAttribute(n)),E=parseInt(u/this.realRowDataLength),g=parseInt(e.getAttribute(h)),j=e.getAttribute(l),y=E+p,b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(q||this.options.tooltipDisplay&&this.isMobile?this.bodyOver(t,e):this.hideTooltip(),!("button"===(z=this.getCellInfo(b)).options.inputType||!z.options.embeddedInput&&("checkbox"===z.options.inputType||"radio"===z.options.inputType&&this.options.preventDuplicateFocusedCell)&&this.options.preventMultipleClick&&!(this.options.checkOnCellClick&&"LABEL"!=T.tagName))){var U;if(0==z.internal&&"custom"==z.options.inputType)if("button"===(U=z.cellManagerHashByRowIndex[this.getRealRowIndex(y)]?z.cellManagerHashByRowIndex[this.getRealRowIndex(y)]:z).options.inputType||!U.options.embeddedInput&&"checkbox"===U.options.inputType&&this.options.preventMultipleClick)return;y=this._getGroupbyDisplayRowIndex(y),"drilldown"==z.options.inputType&&this.options.ignoreCellClick?W||d.f.fireEvent(this,"oncellclick",y,b,j):("radio"===z.options.inputType||"checkbox"===z.options.inputType)&&("LABEL"===T.tagName||"TD"===T.tagName)||"link"===z.options.inputType&&this.options.contentCellClick&&"A"!==T.tagName||"link"===z.options.inputType&&this.options.useMobileTooltip&&(q||this.options.tooltipDisplay&&this.isMobile)||"image"===z.options.inputType&&this.options.contentCellClick&&"IMG"!==T.tagName||d.f.fireEvent(this,"oncellclick",y,b,j)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.bodyDblClick=function(t,e){var i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("col_id"),s=a.Z.getDataPrefix("editModeEvent");if("INPUT"==e.tagName)var r=this.getLastFocusedCell(),n=r.focusedRowIndex,l=r.focusedColIndex;else{var h=parseInt(e.getAttribute(i));n=parseInt(h/this.realRowDataLength)+this.rowIndex,l=e.getAttribute(o)}if(null!=l){var p=e.getAttribute(s)||"";if((""!=p&&"ondblclick"==p.toLowerCase()||""==p&&"ondblclick"==this.options.editModeEvent.toLowerCase())&&this.setEditMode(e),!this._getEditDisabled(n,l)){this.rollbackCommitFlag=!1;var u=this.isHammerEnabled(),c=this.getCellInfo(l);if(u||c.options.blockSelect)d.f.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(n),this.getColumnIndex(l),this.getColumnID(l));else{var g=this.getFocusedColumnIndex();d.f.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(this._getFocusedRowIndex()),g,this.getColumnID(g))}this.rollbackCommitFlag=!0}}},f.prototype.headerClick=function(t,e,i){this.focusedByApi=!1,this.options.tooltipHeader&&this.hideTooltip();var o=a.Z.getDataPrefix("header_id"),s=e.getAttribute(o)
;if((this.options.preventMultipleClick||this.options.senseReader)&&this.headerInfoHash[s]&&this.headerInfoHash[s].options&&"checkbox"===this.headerInfoHash[s].options.inputType||1!=this._getHeaderDisabled(s)&&d.f.fireEvent(this,"onheaderclick",s),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i),1==this.noevent);else if(this.getDataLength()>0&&"onclick"==this.options.sortEvent&&this._checkSortable(e)&&!this.groupbyStatus.grouped&&(this.fireSortEvent(t,e),this.options.sortHeaderDiv)){var r=e.getElementsByTagName("button");if(r.length>0){var n=r[r.length-1];if(!0!==this.options.accessibility){var l=this.getElementById(this.id+"_scrollX_div"),h=this.getElementById(this.id+"_scrollX_right").scrollLeft;if(l.offsetHeight){h=this.getElementById(this.id+"_scrollX_right").scrollLeft;for(var p=parseInt(e.getAttribute("colSpan"))||1,u=this.headerToBodyRelation[s],c=this.getColumnIndex(u),g=e.offsetWidth,f=this.colWidthList[c],m=1;m<p;m++)f+=this.colWidthList[c+m];var y=this.getColumnIndex(u)+p-1,b=0;for(m=0;m<=y;m++)b+=this.colWidthList[m];var v=b-(h+l.offsetWidth);v>0?this.setScrollLeft(h+v):g<f&&this.setScrollLeft(h-(f-g))}}a.Z.requestAnimationFrame((function(){n.focus()})),1==this.options.senseReader&&this.addGridScroll(0-this.rowIndex)}}this.noevent=!1},f.prototype.headerDdlClick=function(t,e){var i=a.Z.getDataPrefix("header_id");d.f.fireEvent(this,"onheaderdblclick",e.getAttribute(i));var o=this._checkSortable(e);this.getDataLength()>0&&"ondblclick"==this.options.sortEvent&&o&&!this.groupbyStatus.grouped&&this.fireSortEvent(t,e),this.groupbyStatus.grouped&&o||(this.noevent=!1)},f.prototype.fireGroupByRangeSortEvent=function(t,e){try{return}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.recursiveRangeSort=function(t,e,i){try{return}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.fireSortEvent=function(t,e){if(!e.disabled&&!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)&&this._checkSortable(e)){var i=a.Z.getDataPrefix("header_id"),o=e.getAttribute(i),s=this.headerToBodyRelation[o],r=a.Z.getDataPrefix("orderByColumn"),n=e.getAttribute(r);n&&this.bodyIdColIndexMap[n]&&(s=n);var l=this.options.useCtrlOnMultisort?t.ctrlKey||t.metaKey:!(t.ctrlKey||t.metaKey);this.options.preventMultisort&&(l=!1);var h=this.cellInfoHash[s];if("gridView"!=this.initializeType||("expression"!=h.options.inputType||"true"==h.options.expressionSort)&&"drilldown"!=h.options.inputType){if(null==this.headerSortStatusArr&&(this.headerSortStatusArr=[]),this.headerSortStatusArr[s]){if(this.options.noSortInit?-1==this.headerSortStatusArr[s].sortOrder?this.headerSortStatusArr[s].sortOrder=1:this.headerSortStatusArr[s].sortOrder=-1:this.options.sortOrderReverse?this.headerSortStatusArr[s].sortOrder=(this.headerSortStatusArr[s].sortOrder+3)%3-1:this.headerSortStatusArr[s].sortOrder=(this.headerSortStatusArr[s].sortOrder-3)%3+1,!l){var u=this.headerSortStatusArr[s];this.clearHeaderSort(),this.headerSortStatusArr.push(u),this.headerSortStatusArr[s]=this.headerSortStatusArr[0]}}else{if(this.headerSortStatusArr.length>0&&l){if(isNaN(this._grid._dataList.getColumnIndex(s)))return void p.v.printLog("fake columns do not supported multiple sort.["+this.id+"]");for(var c=0;c<this.headerSortStatusArr.length;c++)if(isNaN(this._grid._dataList.getColumnIndex(this.headerSortStatusArr[c].colID)))return void p.v.printLog("fake columns do not supported multiple sort.["+this.id+"]")}(u={}).headerId=o,u.colID=s,this.options.sortOrderReverse?u.sortOrder=-1:u.sortOrder=1;h=this.getCellInfo(s);var g=this.getColumnOption(h.options.col_id,"dataType"),f=this._dataList.getCellInfo(s).options.dataType;u.dataType="number"==g||"bigDecimal"===g||"float"==g?g:f,l?(this.headerSortStatusArr.push(u),this.headerSortStatusArr[s]=this.headerSortStatusArr[this.headerSortStatusArr.length-1]):(this.clearHeaderSort(),this.headerSortStatusArr.push(u),
this.headerSortStatusArr[s]=this.headerSortStatusArr[0])}var m=[],y=[],b=(g=[],{});if(b.headerId=o,b.bodyColId=s,b.sortOrder=this.headerSortStatusArr[s].sortOrder,0==this.headerSortStatusArr.length)this.dataList.clearSortFilter();else{for(c=this.headerSortStatusArr.length-1;c>=0;c--)if(0==this.headerSortStatusArr[c].sortOrder){var v=this.headerSortStatusArr[c].colID;if(this.setHeaderSortImage(o,0,0),this.headerSortStatusArr.splice(c,1),delete this.headerSortStatusArr[v],0==this.headerSortStatusArr.length)return d.f.fireEvent(this,"onbeforesort",b),this.dataList.clearSort(),void d.f.fireEvent(this,"onsort",b)}else m.push(this.headerSortStatusArr[c].colID),y.push(this.headerSortStatusArr[c].sortOrder),g.push(this.headerSortStatusArr[c].dataType);if(m.reverse(),y.reverse(),g.reverse(),0==d.f.fireEvent(this,"onbeforesort",b))return;this.dataList.setFilter({type:"sort",sortIndex:m.join(" "),sortOrder:y.join(" "),dataType:g.join(" "),focuseMode:this.options.filterFocusMode,ignoreEmptyStringOnSort:this.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:this.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:this.options.setEmptyStringSortableOnSort})}this.drawHeaderSortImages(),d.f.fireEvent(this,"onsort",b)}}},f.prototype.footerClick=function(t,e,i){var o=a.Z.getDataPrefix("footer_id");d.f.fireEvent(this,"onfooterclick",e.getAttribute(o)),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)},f.prototype.footerDblClick=function(t,e,i){var o=a.Z.getDataPrefix("footer_id");d.f.fireEvent(this,"onfooterdblclick",e.getAttribute(o)),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)},f.prototype.subtotalClick=function(t,e,i){try{for(var o=e.getAttribute("id"),r=a.Z.getDataPrefix("targetcolumnid"),n=e.parentNode.getAttribute(r),l=0,h=-1,p=0;p<this.subtotalRowHash[n].length;p++)if(this.subtotalRowHash[n][p]===e.parentNode){h=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(h>-1){var u=this._dataList.getCellData(h,n);for(l=h-1;this._dataList.getCellData(l,n)==u&&l>=0;l--);l++}var c={colID:o,startRowIndex:l,endRowIndex:h,element:e};d.f.fireEvent(this,"onsubtotalclick",c),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.subtotalDblClick=function(t,e){try{for(var i=e.getAttribute("id"),o=a.Z.getDataPrefix("targetcolumnid"),r=e.parentNode.getAttribute(o),n=0,l=-1,h=0;h<this.subtotalRowHash[r].length;h++)if(this.subtotalRowHash[r][h]===e.parentNode){l=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(l>-1){var p=this._dataList.getCellData(l,r);for(n=l-1;this._dataList.getCellData(n,r)==p&&n>=0;n--);n++}var u={colID:i,startRowIndex:n,endRowIndex:l,element:e};d.f.fireEvent(this,"onsubtotaldblclick",u)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleTouchStart=function(t){!this.isHammerEnabled()&&this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),r.I.clearTimer(this.id+"_iScroll_slideX");var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;(e||i)&&(this.iScrollAddMoveClass(),this.iScroll.moveDirection=null,this.iScroll.propagation=null,this.iScroll.prevTouches=[{x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY}],r.I.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime}))},f.prototype.handleTouchMove=function(t){if("pass"!=this.iScroll.propagation){this.iScroll.addMoveClass&&(this.iScrollAddMoveClass(),this.iScroll.addMoveClass=!1);var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;if(e||i){var o=this.scrollX_right,s=this.getElementById(this.id+"_scrollY_div");this.iScroll.prevTouches.push({x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY});var a=this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2)
;if(a.length<2)return;var n=a[0].x-a[1].x,l=a[0].y-a[1].y,h=this.iScroll.moveDirection;if(h||(h=this.iScroll.moveDirection=Math.abs(l)>=Math.abs(n)?"Y":"X",this.iScroll.moveDistance=Math.abs(l)>=Math.abs(n)?Math.abs(l):Math.abs(n)),this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===h)return void d.f.stopEvent(t);var p=this.hasSubtotal&&this.lastSubtotalRow&&"none"==this.lastSubtotalRow.style.display;if("X"==h&&n<0&&0==o.scrollLeft||"X"==h&&n>0&&o.scrollLeft>=o.firstChild.offsetWidth-o.offsetWidth||"Y"==h&&l<0&&0==s.scrollTop||"Y"==h&&l>0&&this.rowIndex+this.lastIndex+1==this.getDataLength()&&!p||"Y"==h&&this.hasClass("w2grid_adaptive_crosstab")||"Y"==h&&0===this.getDataLength())return void("stop"==this.iScroll.propagation?d.f.stopEvent(t):(this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"));"X"==h?this.moveXScroll(n):!0!==this._isBrowserScroll()&&this.moveYScroll(l),this.iScroll.propagation="stop",!0===this._isBrowserScroll()&&"X"!=h||d.f.stopEvent(t),r.I.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.addMoveClass=!0}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime})}}},f.prototype.handleTouchEnd=function(t){if(this.isMobile||window.navigator.msPointerEnabled&&this.iScroll.prevTouches&&"touch"==t.pointerType){r.I.clearTimer(this.id+"_iScroll"),this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2);var e=this.iScroll.prevTouches;if(e.length>=2){var i=e[0].x-e[1].x;if(this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===this.iScroll.moveDirection){var o=this.getElementById(this.id+"_body_tbody"),s=o.firstChild.offsetWidth,a=0;return i>0?a=Math.ceil(i/s)*s:i<0&&(a=Math.floor(i/s)*s),void(o.scrollLeft=Math.floor((o.scrollLeft+a)/s)*s)}var n=new Date;this.slideX(i,n)}else this.iScrollRemoveMoveClass()}},f.prototype.iScrollAddMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__addClass(t,"w2grid_iScrollX_move"),this.__addClass(e,"w2grid_iScrollY_move")},f.prototype.iScrollRemoveMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__removeClass(t,"w2grid_iScrollX_move"),this.__removeClass(e,"w2grid_iScrollY_move")},f.prototype.moveXScroll=function(t){var e=this.getElementById(this.id+"_iScrollX"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_scrollX_left"),s=this.scrollX_right;s.scrollLeft+=t;var r=parseInt(o.style.width,10),a=s.firstChild.offsetWidth-s.offsetWidth,n=parseInt(s.offsetWidth*s.offsetWidth/s.firstChild.offsetWidth,10);e.style.width=(n<30?30:n)+"px",e.style.left=r+s.scrollLeft/a*(i.offsetWidth-r-e.offsetWidth)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},f.prototype.slideX=function(t,e){var i=new Date,o=parseInt(t/3,10);this.moveXScroll(o),t-=o,Math.abs(t)>=0&&i-e<this.options.iScrollSlideTime?(r.I.clearTimer(this.id+"_iScroll_slideX"),r.I.setTimer(this.slideX,{key:this.id+"_iScroll_slideX",caller:this,delay:this.options.iScrollSlidePeriod,args:[t,e]})):this.iScrollRemoveMoveClass()},f.prototype.moveYScroll=function(t){t*=parseInt(this.options.touchScrollDelta,10)||5;var e=this.getElementById(this.id+"_iScrollY"),i=this.getElementById(this.id+"_scrollY_div");i.scrollTop+=t;var o=i.firstChild.offsetHeight,s=this.getElementById(this.id+"_dataLayer"),r=o-s.offsetHeight,a=parseInt(s.offsetHeight*s.offsetHeight/o,10);e.style.height=(a<30?30:a)+"px",e.style.top=i.scrollTop/r*(s.offsetHeight-e.offsetHeight)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},f.prototype.tbodyMoveXScroll=function(t){if(this.editedCell&&this.editedCell.handleEndEdit(),!this.mobile&&this.options.scrollByColumnAdaptive,this.options.adaptiveSlideHeader){var e=this.options.adaptive,i=parseInt(this.options.adaptiveThreshold)||480
;if("crosstab"==e&&!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)&&a.Z._getBrowserWidth()<=i&&this.slideHeadObj&&"absolute"==this.slideHeadObj.render.style.position){this.slideHeadObj.hidden&&($(this.slideHeadObj.render.firstChild).animate({width:"show"}),this.slideHeadObj.hidden=!1);var o=this,s=function(){a.Z.setTimeout((function(){null!=WebSquare.userTimerHash[o.id+"_adaptiveSlideHeader"]?(a.Z.clearTimeout(o.id+"_adaptiveSlideHeader"),s()):o.slideHeadObj.hidden||($(o.slideHeadObj.render.firstChild).animate({width:"hide"}),o.slideHeadObj.hidden=!0)}),{delay:1e3,key:o.id+"_adaptiveSlideHeader"})};s()}}};var m=function(){};m.prototype.nonCharKeys={4:"insert",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",9:"tab",13:"enter",46:"del",16:"shift",17:"ctrl",18:"alt",21:"hanyoung",25:"hanja",91:"window",20:"capslock",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"numlock",145:"scrolllock"},m.prototype.handleBodyKeyDown=function(t){this.isKeyPressed=!0;for(var e=this.event.getTargetIterator(t,this.render),i=!1;e.next()&&e.element;)e.match(this.options.bodyTdClass)?(i=!1,e.stop()):e.match(this.options.headerTdClass)&&(i=!0,e.stop());if(this.editMode){var o=this.editedCell.options.inputType;switch("text"!==o&&"textarea"!==o&&"calendar"!==o&&"textImage"!==o&&"secret"!==o||(this.beforeEditedCellInfo={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:o,keyCode:t.charCode?t.charCode:t.keyCode}),A=t.keyCode){case 9:if(d.f.stopEvent(t),"down"==this.options.tabKeyMove){if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;u=!1,"calendar"===o&&(u=this.options.keyMoveEditMode&&"down"==this.options.tabKeyMove);var n=this.editedCell.id}if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,u],{checkFunc:function(t){return t+""!="false"}})){var l=!1;if("down"===this.options.tabKeyMove){var h=this.getLastFocusedCell().focusedColIndex;l=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,n);var p=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===l?(this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))]),this.focusNextTabOrder()):(!l||h!==p&&null!=h&&null!=p)&&this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))])}else l=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);l||this._setFocusedCell(this.editMode)}break;case 13:if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;var u=!1;a.Z.isIEAllVersion()&&"calendar"===o&&(u=this.options.keyMoveEditMode&&"right"!=this.options.enterKeyMove&&"none"!=this.options.enterKeyMove);n=this.editedCell.id;if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}}))if(u){L=this;setTimeout((function(){var e=!1;if("right"==L.options.enterKeyMove||"editRight"==L.options.enterKeyMove)e=L.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=L.options.enterKeyMove&&"edit"!=L.options.enterKeyMove){var i=L.getLastFocusedCell().focusedColIndex;e=L.moveVertical(t,t.shiftKey?"up":"down",L.options.keyMoveEditMode,n)
;var o=L.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===e?(L._fireOnviewchange(n,"_handleEndEdit_focus",[L.getInput(L.getCellInfo(n))]),L.focusNextTabOrder()):(!e||i!==o&&null!=i&&null!=o)&&L._fireOnviewchange(n,"_handleEndEdit_focus",[L.getInput(L.getCellInfo(n))])}e||L._setFocusedCell(L.editMode)}),1)}else{l=!1;if("right"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove)l=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=this.options.enterKeyMove&&"edit"!=this.options.enterKeyMove){h=this.getLastFocusedCell().focusedColIndex;l=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,n);p=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===l?(this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))]),this.focusNextTabOrder()):(!l||h!==p&&null!=h&&null!=p)&&this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))])}l||this._setFocusedCell(this.editMode)}break;case 27:this.editedCell.handleCancelEdit(t),this._setFocusedCell(),d.f.stopEvent(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){d.f.stopEvent(t);break}this.options.checkEditOnPaste&&this._doPaste()}default:var c={};c.rowIndex=this.editedCell.editRowIndex,c.colIndex=this._dataList.getColumnIndex(this.editedCell.id),c.colID=this.editedCell.id,c.keyCode=t.charCode?t.charCode:t.keyCode,this.editedCell._getEditedValue&&(this.editedCell.beforeEditValue=this.editedCell._getEditedValue()),d.f.fireEvent(this,"oneditkeydown",c)}}else{if(i){if(35===t.keyCode&&t.ctrlKey)return void this.focusToEnd();if(36===t.keyCode&&t.ctrlKey)return void this.focusToStart();this.removeFocusedCell()}if(this.options.ignoreKeyCheckFunction){var g=null,f=!1;try{if("function"==typeof this.options.ignoreKeyCheckFunction?g=this.options.ignoreKeyCheckFunction:"function"==typeof(g=a.Z.getGlobalFunction(this.options.ignoreKeyCheckFunction,this.scope_id))&&(this.options.ignoreKeyCheckFunction=g),"function"==typeof g&&(f=g.call(this,t)),f)return void d.f.preventDefault(t)}catch(t){g=null}}var m=a.Z.getDataPrefix("tdIndex"),y=a.Z.getDataPrefix("colIndex"),b=a.Z.getDataPrefix("col_id"),v=a.Z.getDataPrefix("directItemChoice");if("none"!=this.options.focusMode&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){if(13==t.keyCode&&document.activeElement==this.render&&(this._setFocusedCell(),d.f.stopEvent(t)),"A"!=d.f.getTarget(t).tagName)return;e=this.event.getTargetIterator(t,this.render);for(var w=!1;e.next();)if(e.match(this.options.bodyTdClass)){w=!0;var C=e.getElement(),I=parseInt(C.getAttribute(m)),_=parseInt(I/this.realRowDataLength),x=C.getAttribute(b),S=this.getColumnIndex(x);this.focusedCell.push({focusedTd:C,focusedRowIndex:_,focusedColIndex:S});var R=C.getElementsByTagName("a");if(-1==this.focusedCellLinkIndex)for(var D=0;D<R.length;D++)document.activeElement==R[D]&&(this.focusedCellLinkIndex=D);this.focusedCellLinkLength=R.length;break}if(!w)return}var T=!1;if(r.I.browserCheck.safari&&(t.ctrlKey||t.metaKey)){this.tempEditableCell=document.activeElement,this.tempEditableCell.contentEditable="true",this.tempEditableCell.style.textShadow="0 0 0 "+WebSquare.style.getStyle(this.tempEditableCell,"color"),this.tempEditableCell.style.color="transparent";var L=this;r.I.setTimer((function(){L.tempEditableCell.contentEditable="inherit",this.tempEditableCell.style.color="",this.tempEditableCell.style.textShadow=""}),{key:this.id+"_tempEditableCell_contentEditable",caller:this,delay:500})}switch(t.keyCode){case 37:case 39:if(this.options.moveKeyEditMode){var k=37==t.keyCode?"left":"right";return this.moveHorizontal({byApi:!0},k,this.options.moveKeyEditModeAll),void d.f.stopEvent(t)}case 38:case 40:if(this.skipScrollEndEvent=!1,this.skipScrollStartEvent=!1,this.options.moveKeyEditMode){k=38==t.keyCode?"up":"down";return this.moveVertical({},k,!0),void d.f.stopEvent(t)}case 33:case 34:case 35:case 36:
case 9:T=!0;break;case 13:if(this.options.senseReader&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex)if((O=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"image"==O.options.inputType)for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_image")){var F=a.Z.getGlobalFunction(O.options.imageClickFunction,this.scope_id);"function"==typeof F&&F.call(this,this.getLastFocusedCell().focusedRowIndex,O.id,this.dataList.getCellData(this.getLastFocusedCell().focusedRowIndex,O.id))}if(this.options.senseReader&&null!=this.getLastFocusedCell().focusedColIndex)if((O=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"select"==O.options.inputType&&"ul"==O.options.tableRender)return this.setEditHtml(t),void d.f.stopEvent(t);T=!0;break;default:T=!1}if(1==T&&"false"==this.options.focusMove){var A=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return;if(9!=A){if(38!=A&&40!=A||!this.options.focusMoveByUpDownKey){if(35===A&&t.ctrlKey)return void this.focusToEnd();if(36===A&&t.ctrlKey)return void this.focusToStart();if(13==A){O=this.getCellInfo(this.focusedCell[0].focusedColIndex);if("enter"===this.options.drilldownToggle&&1==this.focusedCell.length&&O&&"drilldown"==O.options.inputType){var E=this.focusedCell[0].focusedRowIndex,M=this.dataList.getRealRowIndex(E);this.toggle(M)}}return}for(C=d.f.getTarget(t);C&&("TD"!=C.tagName||null==C.getAttribute(y));)C=C.parentNode;if(C){x=C.getAttribute(b);if("radio"!=(O=this.getCellInfo(x)).options.inputType)return}}}if(this.F2Mode)switch(t.keyCode){case 8:case 46:case 35:case 36:case 37:case 38:case 39:case 40:return}switch(t.keyCode){case 4:break;case 46:this.removeCellData(t),d.f.stopEvent(t);break;case 32:this.doDefaultAction(t);break;case 33:this.movePageUp(t),d.f.stopEvent(t);break;case 34:this.movePageDown(t),d.f.stopEvent(t);break;case 35:this.moveHorizontal(t,"end"),d.f.stopEvent(t);break;case 36:this.moveHorizontal(t,"home"),d.f.stopEvent(t);break;case 37:this.moveHorizontal(t,"left"),d.f.stopEvent(t);break;case 38:this.moveVertical(t,"up"),d.f.stopEvent(t);break;case 39:this.moveHorizontal(t,"right"),d.f.stopEvent(t);break;case 40:this.moveVertical(t,"down"),d.f.stopEvent(t);break;case 9:var O=this.getCellInfo(this.getLastFocusedCell().focusedColIndex);if(this.options.senseReader&&O&&"image"==O.options.inputType&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex){d.f.stopPropagation(t);for(e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match("w2grid_image"))if(d.f.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else(this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)||"linear"!=this.options.focusFlow)&&d.f.stopEvent(t)}}else if(d.f.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else{(("down"==this.options.tabKeyMove?this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode):"none"==this.options.tabKeyMove||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode))||"linear"!=this.options.focusFlow)&&d.f.stopEvent(t)}break;case 13:O=this.getCellInfo(this.focusedCell[0].focusedColIndex);var N=this.focusedCell[0].focusedRowIndex,H=this.focusedCell[0].focusedColIndex,G=!0===this.options.senseReader&&WebSquare.util.isIEAllVersion()&&(this.___getEditReadOnly(N,H)||this._getEditDisabled(N,H));if("enter"===this.options.drilldownToggle&&1==this.focusedCell.length&&O&&"drilldown"==O.options.inputType){E=this.focusedCell[0].focusedRowIndex,M=this.dataList.getRealRowIndex(E);this.toggle(M);break}if(this.editMode||"autoComplete"!==O.options.inputType&&"select"!==O.options.inputType||!O.options.directOpen)if("edit"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove||"editDown"==this.options.enterKeyMove)this.setEditHtml(t);else if("none"==this.options.enterKeyMove);else if("right"==this.options.enterKeyMove){
if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===O.options.inputType)if(!G)(B=this.getInput(O,this.focusedCell[0].focusedTd))&&B.blur();G||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)}else{var B;if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===O.options.inputType)if(!G)(B=this.getInput(O,this.focusedCell[0].focusedTd))&&B.blur();G||this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode)}else"autoComplete"===O.options.inputType&&(O.autoCompleteImageClicked=!0),this.setEditHtml(t);d.f.stopEvent(t);break;case 67:if("native"===this.options.copyType)break;if(t.ctrlKey||t.metaKey){if(a.Z.isIEAllVersion())this.handleCopyEvent({});else if(!a.Z.isIEAllVersion()&&(r.I.browserCheck.moz||r.I.browserCheck.chrome&&!this.options.preventCopy)&&a.Z.isExecCommandSupported()){var W=document.activeElement,V=document.createElement("textarea"),L=this,q=document.getElementsByTagName("body")[0],Y=!!t&&t.shiftKey;V.oncopy=function(t){L.handleCopyEvent(t,Y),q.removeChild(this),document.activeElement!=W&&W.focus()},V.textContent="temp",q.appendChild(V),V.select();try{document.execCommand("copy")}catch(t){s.Y.printStackTrace(t,null,this)}}}else a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 88:if(t.ctrlKey||t.metaKey){if(a.Z.isIEAllVersion())this.handleCutEvent({});else if(!a.Z.isIEAllVersion()&&(r.I.browserCheck.moz||r.I.browserCheck.chrome)&&a.Z.isExecCommandSupported()){V=document.createElement("textarea"),L=this,q=document.getElementsByTagName("body")[0],Y=!!t&&t.shiftKey;V.oncut=function(t){L.handleCutEvent(t,!1,Y),q.removeChild(this)},V.textContent="temp",q.appendChild(V),V.select();try{document.execCommand("cut")}catch(t){s.Y.printStackTrace(t,null,this)}}}else a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){d.f.stopEvent(t);break}this._doPaste()}else{a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}break;case 90:if(t.ctrlKey);else a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 27:"none"!=this.options.focusMode&&"linear"!=this.options.focusFlow&&(this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1),this.render.focus());break;case 16:case 17:case 18:case 21:case 229:case 25:case 91:case 20:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:break;case 65:if(this.options.useSelectAll&&t.ctrlKey){this.setFocusedMultiCell(0,0,this.getRowCount()-1,this.getColumnCount()-1);break}default:if(!t.ctrlKey&&!t.metaKey&&!t.altKey)a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}}this.isKeyPressed=!1},m.prototype.handleOnfocus=function(t){if(this.getDataLength()>0&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){for(var e=null,i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.colIndexes.bodyColInfo.trIndexArr,s=o[this.defaultColCnt],r=0;r<i.length;r++){var a=i[r];if(!this.hiddenList[r]){for(var n=a.length-1;n>=0;n--){var l=a[n]-this.defaultColCnt;if(o[a[n]]<=s){if(this.options.readOnlyTabIgnore&&this.___getEditReadOnly(0,l))break;if(this.options.ignoreNonEditableCell&&(this.___getEditReadOnly(0,l)||this._getEditDisabled(0,l)))break;e=l;break}}if(null!==e)break}}null!==e&&this._setFocusedCell(0,e)}},m.prototype.removeCellData=function(t){this.handleCutEvent(t,!0)},m.prototype.doDefaultAction=function(t){
if("none"==this.options.focusMode){for(var e=d.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;e&&this.getCellInfo(e).doDefaultAction(t)}else this.getCellInfo(this.getLastFocusedCell().focusedColIndex).doDefaultAction(t)},m.prototype.setEditHtml=function(t){var e=d.f.getTarget(t);if(this.options.fastEditMode||"INPUT"==e.tagName||d.f.stopEvent(t),this.focusedCell.length>0){var i=this.focusedCell[this.focusedCell.length-1];null!=i.focusedTd&&this.setEditMode(i.focusedTd)}},m.prototype.getFirstTdTrIndex=function(t){for(var e=t.parentNode,i=a.Z.getDataPrefix("trIndex");"0"!=e.getAttribute(i);)e=a.Z.prev(e);return e},m.prototype.fixScrollRightDirection=function(){if(!0!==this.options.scrollXNative){var t=this.getLastFocusedCell(),e=this.getElementById(this.id+"_dataLayer").offsetWidth,i=this.getElementById(this.id+"_scrollX_right");if(t&&t.focusedTd){var o=t.focusedTd.offsetLeft,s=t.focusedTd.offsetWidth+1;a.Z.isFF()&&(s-=1),a.Z.isOpera()&&(s+=2);var r=o+s-e;if(this.options.lazyDrawHiddenColumn){var n=this.focusedCell[0].focusedTd;if("none"==n.style.display||r>0)if(this.options.scrollByColumn){for(var l=e-this.fixedWidth,h=0;h<this.columnOrder.length;h++)if(this.columnOrder[h]==t.focusedColIndex){m=h+this.defaultColCnt;break}var d=-1,p=0;a.Z.isOpera()&&(p=2);for(var u=m;u>=0;u--)if(!this.hiddenList[u]&&(l-=this.colWidthList[u])<0){d=u;break}u=0;for(this.fixedWidth>0&&(u=this.getFixedColumnLastIndex());u<=d;u++)this.hiddenList[u]||(p+=this.colWidthList[u]);this.scrollXPreventEndEdit=!0,i.scrollLeft=p,this._handleScrollX()}else{var c=a.Z.getDataPrefix("colIndex"),g=parseInt(n.getAttribute(c),10),f=0;a.Z.isOpera()&&(f=2);for(h=0;h<=g;h++)this.hiddenList[h]||(f+=this.colWidthList[h]);this.scrollXPreventEndEdit=!0,i.scrollLeft=f-e,this._handleScrollX()}}else if(r>0)if(this.options.scrollByColumn){l=e-this.fixedWidth;var m,y=t.focusedColIndex%this.columnOrder.length;for(h=0;h<this.columnOrder.length;h++)if(this.columnOrder[h]==y){m=h+this.defaultColCnt;break}for(d=-1,p=0,u=m;u>=0;u--)if(!this.hiddenList[u])if(0!=this.colIndexes.bodyColInfo.colSpanArr.length){if((l-=this.colWidthList[u]*(this.colIndexes.bodyColInfo.colSpanArr[u]?this.colIndexes.bodyColInfo.colSpanArr[u]:1))<0){d=u;break}}else if((l-=this.colWidthList[u])<0){d=u;break}u=0;for(this.fixedWidth>0&&(u=this.getFixedColumnLastIndex());u<=d;u++)this.hiddenList[u]||(0!=this.colIndexes.bodyColInfo.colSpanArr.length?p+=this.colWidthList[u]*(this.colIndexes.bodyColInfo.colSpanArr[u]?this.colIndexes.bodyColInfo.colSpanArr[u]:1):p+=this.colWidthList[u]);this.scrollXPreventEndEdit=!0,i.scrollLeft=p,this._handleScrollX()}else this.scrollXPreventEndEdit=!0,i.scrollLeft=i.scrollLeft+r,this._handleScrollX()}}},m.prototype.fixScrollLeftDirection=function(){if(!0!==this.options.scrollXNative){var t=this.getLastFocusedCell();if(t&&t.focusedTd){var e=a.Z.getDataPrefix("colIndex"),i=t.focusedTd.getAttribute(e);i=parseInt(i);for(var o=this.getElementById(this.id+"_scrollX_right"),s=0,r=this.getFixedColumnLastIndex();r<i;r++){if(!this.hiddenList[r])s+=this.colWidthList[r]}o.scrollLeft>s&&(this.scrollXPreventEndEdit=!0,o.scrollLeft=s,this._handleScrollX())}}},m.prototype.getLeftMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.dataList.getRowCount()||t<0)return i;for(var o=0;o<e.length-this.defaultColCnt;o++){var s=!1,r=this.getCellInfo(o);if(!0!==r.options.skipKeyMove){if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==r.options.inputType&&this.getCellData(t,o)!=r.options.trueValue){var a=this.getCheckedIndex(r.colID);a?s=a[0]!==t:0!=t&&(s=!0)}if((this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))&&("user"==r.options.inputType||"link"==r.options.inputType)){var n=this.data_td_list[o+(t-this.rowIndex)*this.oneRowDataLength];if(n){
var l=n.getElementsByTagName("a");0==l.length&&(l=n.getElementsByTagName("input")),0!=l.length&&(s=!1)}else s=!1}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var h=this.dataList.getCellData(t-1,o),d=this.upperGroupingTest(t,o);h==this.dataList.getCellData(t,o)&&d&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o]&&!s){i=o;break}}}return i},m.prototype.getRightMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.getRowCount()||t<0)return i;for(var o=e.length-1-this.defaultColCnt;o>=0;o--){var s=!1,r=this.getCellInfo(o);if(!0!==r.options.skipKeyMove){if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==r.options.inputType&&this.getCellData(t,o)!=r.options.trueValue){var a=this.getCheckedIndex(r.colID);a?s=a[0]!==t:0!=t&&(s=!0)}if((this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))&&("user"==r.options.inputType||"link"==r.options.inputType))if(t<this.rowIndex)s=!0;else{var n=this.data_td_list[o+(t>=this.rowIndex?t-this.rowIndex:t)*this.oneRowDataLength],l=n.getElementsByTagName("a");0==l.length&&(l=n.getElementsByTagName("input")),s=0==l.length}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var h=this._dataList.getCellData(t-1,o),d=this.upperGroupingTest(t,o);h==this._dataList.getCellData(t,o)&&d&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o+this.defaultColCnt]&&!s){i=o;break}}}return i},m.prototype.moveHorizontal=function(t,e,i,o){if("false"==this.options.focusMove||"vertical"==this.options.focusMove){o=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return!1;if(9!=o)return!1}var s,r=this.getLastFocusedCell(),n=r.focusedRowIndex,l=r.focusedColIndex,h=(this.colIndexInfo.body.colInfo.colIndexArr,this._getRealColIndex("body",this.tdIdList[l])+this.defaultColCnt),p=this.colIndexInfo.body.colInfo.colIndexMatch,u=this.columnOrder,c=this.colIndexes.bodyColInfo.trIndexArr,g=c[l+this.defaultColCnt],f=!!t&&9==t.keyCode,m=!!t&&(9==t.keyCode||13==t.keyCode),y=!!t&&t.shiftKey,b=(e=e||"right",0==t||t&&!0===t.byApi);s=1==this.options.moveKeyEditModeAll&&b?!!o&&(37==o||39==o):!!t&&(37<=t.keyCode&&t.keyCode<=40),r.bTrIndex&&(g=r.bTrIndex);var v=null,w=n;if(this.options.focusMultiRow){if("left"==e)var C=h-1,I=this.defaultColCnt-1,_=-1;else if("right"==e)C=h+1,I=p.length,_=1;else if("home"==e)C=this.defaultColCnt,I=p.length,_=1;else C=p.length-1,I=this.defaultColCnt-1,_=-1;for(var x=C;x!=I;x+=_){var S=p[x];if(!this.hiddenList[x]){for(var R=S.length-1;R>=0;R--){var D=S[R]-this.defaultColCnt;if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,D)||this.cellMergeInfo[n+"_"+D])if(!0!==(k=this.getCellInfo(D)).options.skipKeyMove)if(c[S[R]]<=g&&("left"!=e&&"right"!=e||D!=l)){if((this.options.readOnlyTabIgnore||this.options.senseReader)&&this.___getEditReadOnly(n,D))break;if(m&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,D)||this._getEditDisabled(n,D)))break;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[D]].options.colMerge){var T=this.dataList.getCellData(n-1,D),L=this.upperGroupingTest(n,D);if(T==this.dataList.getCellData(n,D)&&L)break}v=D;break}}if(null!==v)break}}}else{var k=this.getCellInfo(l),F=!1;this.options.senseReader&&"user"==k.options.inputType&&this.___getEditReadOnly(n,l)?F=!0:(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0);var A=this.getLocationRowCol(n,l),E=A.rowIndex,M=A.colIndex,O=this.htmlInfo.body.rowAttrArr.length;r.bMovedRow&&(E=r.bMovedRow);var N=E%O;if("left"==e)if(F&&this.focusedCellLinkIndex>0)C=M,I=u.length,_=1;else C=M-1,
I=-1,_=-1;else if("right"==e)if(F&&this.focusedCellLinkIndex+1<this.focusedCellLinkLength)C=M,I=u.length,_=1;else{this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0;C=M+A.colSize,I=u.length,_=1}else if("home"==e){C=0,I=u.length,_=1;E-=N}else{C=u.length-1,I=0,_=-1;E=E+O-N-1}for(x=C;;x+=_){if(x==I)if("left"==e&&N>0)x=u.length-1,N--,E--;else{if(!("right"==e&&N<O-1))break;x=0,N++,E++}var H=this.getOriginalRowCol(E,x);if(!H.noLeftTop){_>0&&(_=H.colSize);D=H.colIndex;if(!this.hiddenList[x+this.defaultColCnt])if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,D)||this.cellMergeInfo[n+"_"+D])if(!(k=this.getCellInfo(D)).options.blockSelect&&!0!==k.options.skipKeyMove){if(this.options.senseReader&&"radio"==k.options.inputType&&this.getCellData(n,D)!=k.options.trueValue&&0!=n){if(this.getCheckedIndex(k.colID))continue;if(0!=n)continue}if("left"!=e&&"right"!=e||(F||D!=l)){var G=!1;if(f&&this.___getEditReadOnly(n,D)&&(this.options.readOnlyTabIgnore||this.options.senseReader)){if("user"!=k.options.inputType&&"link"!=k.options.inputType||!this.options.senseReader)continue;var B=this.data_td_list[D+(w-this.rowIndex)*this.oneRowDataLength],W=B.getElementsByTagName("a");if(0==W.length&&(W=B.getElementsByTagName("input")),"right"==e)for(var V=0;V<W.length;V++){if(document.activeElement==W[V]){this.focusedCellLinkIndex=V;break}this.focusedCellLinkIndex=-1}else if("left"==e)for(V=W.length-1;V>-1;V--){if(document.activeElement==W[V]){this.focusedCellLinkIndex=V;break}this.focusedCellLinkIndex=-1}if(!W[0])continue;("right"==e&&this.focusedCellLinkIndex!=W.length-1||"left"==e&&0!=this.focusedCellLinkIndex)&&(G=!0)}if((m||s)&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,D)||this._getEditDisabled(n,D))&&(!f||1!=G))continue;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[D]].options.colMerge){T=this.dataList.getCellData(n-1,D),L=this.upperGroupingTest(n,D);if(T==this.dataList.getCellData(n,D)&&L)continue}v=D;break}if(null!==v)break}}}}if(null===v&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),null!==v){if(i&&(this.___getEditReadOnly(w,v)||this._getEditDisabled(w,v))&&(i=!1),i&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){k=this.getCellInfo(v);a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setFocusedCell(n,v,i,{tabDirection:e}),(r=this.getLastFocusedCell()).bTrIndex=g,r.bMovedRow=E,!0}if("linear"==this.options.focusFlow){if(n>0&&y){var q=this.getRightMostFocusableColIndex(n-1);if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&null==q)for(;n>=0&&null==q;){this._setGridBorderNoRefresh=!0;var Y=-1;this.hasSubtotal&&(Y-=this.getHasSubtotalCount(n-1)),"true"!==this.options.keepScrollForSenseReader&&!0!==this._isBrowserScroll()&&this.addGridScroll(Y),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(q=this.getRightMostFocusableColIndex(n-1)),null==q&&(n-=1)}else for(;n>=0&&null==q;)n-=1,q=this.getRightMostFocusableColIndex(n-1);if(null==q)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),n-1<this.rowIndex){this._setGridBorderNoRefresh=!0;Y=-1;this.hasSubtotal&&(Y-=this.getHasSubtotalCount(n-1)),!0!==this._isBrowserScroll()&&this.addGridScroll(Y),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&null!=q&&"all"!=this.options.visibleRowNum&&(q=this.getRightMostFocusableColIndex(n-1))}return"custom"==(k=this.getCellInfo(q)).options.inputType&&n-1>=0&&(w=n-1),i&&(this.___getEditReadOnly(w,q)||this._getEditDisabled(w,q))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)&&a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1),this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,q,i,{tabDirection:e}),
this._setGridBorderNoRefresh=!1,!0}if("left"==e&&n>0&&!y){for(var Z=this.getRightMostFocusableColIndex(n-1);n>0&&null==Z;)n-=1,Z=this.getRightMostFocusableColIndex(n-1);if(null==Z)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(n-1>0&&n==this.rowIndex){this._setGridBorderNoRefresh=!0;Y=-1;!0!==this._isBrowserScroll()&&this.addGridScroll(Y),this._setGridBorderNoRefresh=!1}if(i&&(this.___getEditReadOnly(w,Z)||this._getEditDisabled(w,Z))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){k=this.getCellInfo(Z);a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,Z,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}if("right"!=e||y){if("left"===e&&0===n&&f&&l-1==0){!0===(k=this.getCellInfo(l-1)).options.skipKeyMove&&d.f.preventDefault(t)}}else{if(n<this.getDataLength()-this._getVisibleLastIndex(1)){for(Z=this.getLeftMostFocusableColIndex(n+1);n!=this.dataList.getRowCount()&&null==Z;)n+=1,Z=this.getLeftMostFocusableColIndex(n+1);if(null==Z)return this.editedCell&&this.editedCell.handleEndEdit(t),1==this.options.moveKeyEditModeAll&&n==this.dataList.getRowCount()&&document.getElementById(this.id+"_gridend_div").focus(),!1;var j=this._getVisibleLastIndex(this.lastIndex+1);if(n+1>this.rowIndex+j-1){this._setGridBorderNoRefresh=!0;Y=1;this.hasSubtotal&&(Y+=this.getHasSubtotalCount(n+1)),1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(Y+=n-(this.rowIndex+j-1),this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),!0!==this._isBrowserScroll()&&this.addGridScroll(Y),this._setGridBorderNoRefresh=!1}if(i)"custom"==(k=this.getCellInfo(Z)).options.inputType&&(w=n+1),(this.___getEditReadOnly(w,Z)||this._getEditDisabled(w,Z))&&(i=!1);if(i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var k=this.getCellInfo(Z);a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n+1,Z,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}f&&!0===(k=this.getCellInfo(l+1)).options.skipKeyMove&&d.f.preventDefault(t)}}if(f&&null!=WebSquare.tabOrder[this.id])if(0===h&&0===n&&"left"==e){if(this.options.senseReader&&this.options.useStartEndDiv);else if(null!=WebSquare.tabOrder[this.id].preTabID&&(P=a.Z.getPreTabbableComp(this.id)))return P.focus(t),!0}else if(h===p.length-1&&n===this.getDataLength()-this._getVisibleLastIndex(1)&&"right"==e){var P;if(this.options.senseReader&&this.options.useStartEndDiv);else if(null!=WebSquare.tabOrder[this.id].nextTabID)if(P=a.Z.getNextTabbableComp(this.id))return P.focus(t),!0}return this.editedCell?(this._setGridBorderNoRefresh=!0,this.editedCell.handleEndEdit(t),this._setGridBorderNoRefresh=!1):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(n,l,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!1},m.prototype.moveVertical=function(t,e,i){this.moveDirection="row";var o=this.getLastFocusedCell(),s=o.focusedRowIndex,r=o.focusedColIndex,n=this.getCellInfo(r).options.inputType,l=this.options.focusMoveByUpDownKey&&this.options.senseReader&&"radio"==n&&(38==t.keyCode||40==t.keyCode);if(("false"==this.options.focusMove||"horizontal"==this.options.focusMove)&&!l)return!1;var h=this.defaultColCnt,p=this.colIndexInfo.body.colInfo.colIndexArr,u=this.colIndexInfo.body.colInfo.colIndexMatch,c=this.colIndexes.bodyColInfo.trIndexArr,g=this.colIndexes.bodyColInfo.colSpanArr,f=this.colIndexes.bodyColInfo.rowSpanArr,m=p[r+h],y=c[r+h],b=g[r+h],v=f[r+h],w=r,C=s,I=!!t&&13==t.keyCode,_=!!t&&9==t.keyCode,x=this.getDataLength()-this._getVisibleLastIndex(1),S=!1,R=!!(this.oneRowLength>1&&this.options.skipMultiRowMove);if(b&&o.bColIndex&&(m=o.bColIndex),"up"==e)var D=0==y?this.oneRowDataLength-1:r-1,T=-1,L=-1;else D=y+v==this.oneRowLength?0:r+1,T=this.oneRowDataLength,L=1;if(R){
for(var k=f[0],F=(k=f[this.defaultColCnt],this.defaultColCnt+1);F<f.length;F++)if(k!=f[F]){R=!1;break}R&&(D=r)}var A=!1;for(F=D;F!=T;F+=L){var E=p[F+h],M=E+(g[F+h]?g[F+h]:1)-1,O=this._getArrayIndexOf(this.columnOrder,p[F+h]-h)+h;if(E<=m&&m<=M&&(!this.hiddenList[O]||A)){if(w=F,O=this._getArrayIndexOf(this.columnOrder,p[w]+1)+this.defaultColCnt,C==x&&"down"==e&&this.hiddenList[O]){A=!0,m++;continue}if(O=this._getArrayIndexOf(this.columnOrder,p[w]-1)+this.defaultColCnt,0==C&&"up"==e&&this.hiddenList[O]){A=!0,m--;continue}if("up"==e){for(var N=s;N>=0;N--)if(C=0==y?N-1:N,R&&(C=0==y?C:C-1),(!(this.hiddenRowObj.length>0)||this._getRowVisible(C))&&(!this.getMerged(C,w)||this.cellMergeInfo[C+"_"+w])){if(this.hiddenCellObj.length>0&&!1===this.getCellVisible(C,w))for(;!1===this.getCellVisible(C,w);){if(0===(W=c[w+this.defaultColCnt])&&C>0){C--;for(var H=!1,G=w+1+h;G<p.length;G++)if(p[G]===r+h&&c[G]===this.oneRowLength-1){w=G-h,H=!0;break}if(!H)break}else if(W>0){for(H=!1,G=w+h;G>=0;G--)if(p[G]===r+h&&c[G]===W-1){w=G-h,H=!0;break}if(!H)break}}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(C,w)&&!this._getEditDisabled(C,w))break;if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(C,w))break;if(this.oneRowLength>1&&!R){var B=y;for(F=0;F<u[m].length;F++){if(0>--B&&(B=u[m].length-1,0!==y&&C--),w=u[m][B],C<0){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(C,w)&&!this._getEditDisabled(C,w)){P=!0;break}if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(C,w)){P=!0;break}}}if(P){P=!1;break}}}else for(N=s;N<=x;N++)if(C=y+v==this.oneRowLength?N+1:N,R&&(C=y+v==this.oneRowLength?C:C+1),(!(this.hiddenRowObj.length>0)||this._getRowVisible(C))&&(!this.getMerged(C,w)||this.cellMergeInfo[C+"_"+w])){if(this.hiddenCellObj.length>0)for(;!1===this.getCellVisible(C,w);){var W;if((W=c[w+this.defaultColCnt])>=this.oneRowLength-1&&C<=x){C++;for(H=!1,G=h;G<p.length;G++)if(p[G]===r+h&&0===c[G]){w=G-h,H=!0;break}if(!H)break}else if(W<this.oneRowLength-1){for(H=!1,G=w+1+h;G<p.length;G++)if(p[G]===r+h&&c[G]===W+1){w=G-h,H=!0;break}if(!H)break}}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(C,w)&&!this._getEditDisabled(C,w))break;if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(C,w))break;if(this.oneRowLength>1&&!R)for(B=y,F=0;F<u[m].length;F++){if(B++,u[m].length<=B&&(B=0,y+v!==this.oneRowLength&&C++),w=u[m][B],C>x){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(C,w)&&!this._getEditDisabled(C,w)){P=!0;break}if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(C,w)){P=!0;break}}if(P){P=!1;break}}break}}if(0<=C&&C<=x&&(s!=C||r!=w)){if(d.f.stopEvent(t),i&&(this.___getEditReadOnly(C,w)||this._getEditDisabled(C,w))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var V=this.getCellInfo(w);a.Z.getBoolean(V.options.skipKeyMoveEditMode)&&(i=!1)}if(this.setFocusedCell2(C,w,i,{tabDirection:e})){if((o=this.getLastFocusedCell()).bColIndex=m,l){var q=this.tdIdList.length;this.data_td_list[(C-this.rowIndex)*q+w].firstChild.click()}return!0}return!1}if("linear"==this.options.focusFlow){var Y=!1;if((-1==C&&"up"==e&&0==r||C==x+1&&"down"==e&&null==p[r+h+1]||-1==C&&"up"==e&&-1!==u[0].indexOf(r)&&R||C==x+1&&"down"==e&&-1!==u[this.columnOrder.length-1].indexOf(r)&&R)&&(Y=!0),!Y&&(-1==C||C==x+1)){var Z=this.getLastFocusedCell().focusedTd;if("text"==(V=this.getCellInfo(Z)).options.inputType&&V.options.embeddedInput){var j=this.getInput(V,Z);this.showFakeInput(j),
this.fakeInput.setValue(j.getValue()),this.F2Mode=!1,j.select()}else{var P=!1;if("up"==e&&-1==C&&w-1>-1){for(var z=w-1;null!=p[z+h]&&(!R||-1===u[p[p.length-1]].indexOf(z));z--)if(O=this._getArrayIndexOf(this.columnOrder,z)+this.defaultColCnt,!this.hiddenList[O]){for(var U=x;U>-1;U--){if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(U,z)&&!this._getEditDisabled(U,z)){C=U,w=z,P=!0;break}if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(U,z)){C=U,w=z,P=!0;break}if(this.oneRowLength>1&&!R){C=U,w=z;var X=p[z+h];for(B=y,F=0;F<u[X].length;F++){if(0>--B&&(B=u[X].length-1),w=u[X][B],C<0){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(C,w)&&!this._getEditDisabled(C,w)){P=!0;break}if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(C,w)){P=!0;break}}}if(P)break}if(P)break}}else if("down"==e&&C==x+1)for(z=w+1;null!=p[z+h]&&(!R||-1===u[p[h]].indexOf(z));z++)if(O=this._getArrayIndexOf(this.columnOrder,z)+this.defaultColCnt,!this.hiddenList[O]){for(U=0;U<=x;U++){if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(U,z)&&!this._getEditDisabled(U,z)){C=U,w=z,P=!0;break}if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(U,z)){C=U,w=z,P=!0;break}if(this.oneRowLength>1&&!R){C=U,w=z;for(X=p[z+h],B=y,F=0;F<u[X].length;F++){if(B++,u[X].length<=B&&(B=0),w=u[X][B],!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(C,w)&&!this._getEditDisabled(C,w)){P=!0;break}if(!_&&!I&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(C,w)){P=!0;break}}}if(P)break}if(P)break}if(P){if(d.f.stopEvent(t),i&&(this.___getEditReadOnly(C,w)||this._getEditDisabled(C,w))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){V=this.getCellInfo(w);a.Z.getBoolean(V.options.skipKeyMoveEditMode)&&(i=!1)}return!!this.setFocusedCell2(C,w,i,{tabDirection:e})&&((o=this.getLastFocusedCell()).bColIndex=m,!0)}_&&WebSquare.tabOrder[this.id]&&WebSquare.tabOrder[this.id].nextTabID&&(S=!0)}}}return this.editedCell?this.editedCell.handleEndEdit(t):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(s,r,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!0===S&&"focusNextTabOrder"},m.prototype.moveEnd=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(var e=a.Z.getDataPrefix("colIndex");this._moveRight(t););for(var i=!1;!i;){for(var o=!0,s=this.getLastFocusedCell(),r=parseInt(s.focusedTd.getAttribute(e)),n=parseInt(s.focusedTd.getAttribute("colSpan")||1),l=0;l<n;l++)if(0==this.hiddenList[r+l]){o=!1;break}1==o?this._moveLeft(t):i=!0}this.fixScrollRightDirection()}},m.prototype.moveHome=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(var e=a.Z.getDataPrefix("colIndex");this._moveLeft(t););for(var i=!1;!i;){for(var o=!0,s=this.getLastFocusedCell(),r=parseInt(s.focusedTd.getAttribute(e)),n=parseInt(s.focusedTd.getAttribute("colSpan")||1),l=0;l<n;l++)if(0==this.hiddenList[r+l]){o=!1;break}1==o?this._moveRight(t):i=!0}this.fixScrollLeftDirection()}},m.prototype.movePageUp=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(this.rowIndex<=0)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e),this.focusedCell&&this.focusedCell.pop();var s,r=this._getScrollRowIndex(this.rowIndex);return(s=r<this.lastIndex?-1:this._getVisibleRowIndex(r-this.lastIndex))>=0?(this.setTopRowIndex(s),
this._setFocusedCell(i+this.rowIndex,o)):(this.setTopRowIndex(0),this._setFocusedCell(0,o)),!0}}},m.prototype.movePageDown=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(null!=this.lastTopRowIndex&&this.rowIndex>=this.lastTopRowIndex)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e);var s=this.rowIndex+this.lastIndex,r=this.getDataLength(),a=r-this._getVisibleLastIndex(1),n=r-this._getVisibleLastIndex(this.lastIndex+1);return s<=n?(this.setTopRowIndex(s),this._setFocusedCell(Math.min(i+this.rowIndex,a),o)):(this.setTopRowIndex(n),this._setFocusedCell(a,o)),!0}}},m.prototype.findTd=function(t,e,i){for(var o=0,s=a.Z.getDataPrefix("colIndex");null!=t;){for(var r=a.Z.first(t);null!=r;){var n=parseInt(r.getAttribute(s));if(n<=e&&e<=n+r.colSpan-1&&o<=i&&i<=o+r.rowSpan-1)return r;if(n>e)break;r=a.Z.next(r)}if(t=a.Z.next(t),o>i)break;o++}},m.prototype.pasteFromClipboard=function(){for(var t=this.parseClipboardExcel(),e=this._getFocusedRowIndex(),i=this.getFocusedColumnIndex(),o=[],r=0;r<t.length;r++){o.push([]);for(var a=0;a<t[0].length;a++)o[r][a]=this.dataList._getCellData(r+e,this.getColumnID(a+i))}for(r=0;r<t.length;r++)for(a=0;a<t[0].length;a++){var n=t[r][a];try{n=n.wq_trim();var l=this.getCellInfo(a+i),h=this.mainGrid.getColumnOption(l.options.col_id,"dataType");"number"==h&&(n=n.replace(/[^(\-0-9)]/g,""))}catch(t){s.Y.printStackTrace(t,null,this)}1!=this.___getEditReadOnly(r+e,a+i)&&1!=this._getEditDisabled(r+e,a+i,!0)&&this.dataList.__setCellData(r+e,this.getColumnID(a+i),n)}var d=this;WebSquare.historyManager.set("grid","grid1",{focusRowIndex:e,focusColIndex:i,data2d:o},{onRestore:function(t){for(var o=t.data2d,s=0;s<o.length;s++)for(var r=0;r<o[0].length;r++){var a=o[s][r];d.dataList.__setCellData(s+e,this.getColumnID(r+i),a)}}})},m.prototype.parseClipboardExcel=function(){for(var t=[],e=window.clipboardData.getData("Text").split("\n"),i=0;i<e.length-1;i++){var o=e[i].split("\t");t.push(o)}return t},m.prototype.copyToClipboard=function(){var t=this.options.copyAmount;if(t||("cell"==this.options.focusMode?t="cell":"both"!=this.options.focusMode&&"row"!=this.options.focusMode||(t="row")),"cell"==t){for(var e=this.getDataLength(),i=this.getTotalCol(),o=[],s=0;s<this.focusedCell.length;s++){var r=(p=this.focusedCell[s]).focusedRowIndex,a=p.focusedColIndex;null==o[r]&&(o[r]=[]),o[r][a]=p,e>r&&(e=r),i>a&&(i=a)}var n=[];for(s=e;s<o.length;s++){var l=[];if(void 0!==(u=o[s]))for(var h=i;h<u.length;h++){o[s][h]?l.push(this.dataList._getCellData(s,this.getColumnID(h))):l.push("")}n.push(l.join("\t"))}window.clipboardData.setData("Text",n.join("\n"))}else if("row"==t){var d=[];for(s=0;s<this.focusedCell.length;s++){var p;d[(p=this.focusedCell[s]).focusedRowIndex]=1}var u=[];for(var r in d)u.push(r);function g(t,e){return parseInt(t)>parseInt(e)?1:-1}u.sort(g);for(o=[],s=0;s<u.length;s++){r=u[s];var c=this.getRowData(r);o.push(c.join("\t"))}window.clipboardData.setData("Text",o.join("\n"))}},m.prototype.getEditCursorEnable=function(t,e){try{if(!t)return!1;var i=d.f.getTarget(t);if(!i)return!1;var o=i.tagName.toUpperCase();if(("INPUT"==o||"TEXTAREA"==o)&&null!=i.value){if(a.Z.isIEAllVersion("6 7 8")){var r=document.selection.createRange();if(r.text.length>0)return!0;r.moveStart("character",-i.value.length);var n=r.text.length;if("left"===e){if(n>0)return!0}else if("right"===e&&n<i.value.length)return!0;return!1}if(null!=i.selectionStart&&i.selectionStart!=i.selectionEnd)return!0;if("left"===e){if(i.selectionEnd>0)return!0}else if("right"===e&&i.selectionEnd<i.value.length)return!0}return!1}catch(t){return s.Y.printStackTrace(t,null,this),!1}},m.prototype._moveKeyEdit=function(t,e,i){try{if(void 0!==i&&null!=i||(i={}),!(this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.moveKeyEditMode))return;var o=this.uuid,r=WebSquare.idCache[t];r["_"+e]=r[e]
;var a=i.itemTable,n=i.skipVertical,l=i.skipHorizontal,h=this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.arrowMove;r[e]=function(t,i){this["_"+e]&&this["_"+e](t,i);var s=WebSquare.idCache[o],r=!1;if(s&&s.editedCell){var p=s.getCellInfo(s.editedCell.colID);(s.options.keyMoveEditMode||s.options.moveKeyEditMode||s.options.moveKeyEditModeAll)&&p.options.skipKeyMoveEditMode&&(r=!0);var u=!1;!r||"select"!=p.options.inputType&&"autoComplete"!=p.options.inputType&&"checkcombobox"!=p.options.inputType||(u=!0)}var c={37:"left",38:"up",39:"right",40:"down"}[t.keyCode];if(c)switch(c){case"left":case"right":if(!0!==l&&(a||0==this.getValue().length||h&&!s.getEditCursorEnable(t,c)))s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"&&s.moveHorizontal({byApi:!0},c,!0,t.keyCode),d.f.stopEvent(t);break;case"up":case"down":if(!0!==u&&!0!==n&&(!a||0==this.getItemCount()||this._keyIndex<0||this._keyIndex===this.getItemCount())){if(s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"){var g=!0!==r;s.moveVertical({},c,g,t.keyCode)}d.f.stopEvent(t)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype._directEdit=function(t){var e=this.focusedCell[this.focusedCell.length-1],i=this.getCellInfo(e.focusedTd);if("textarea"!==i.options.inputType||!this._getEditDisabled(e.focusedRowIndex,e.focusedColIndex)&&!this.___getEditReadOnly(e.focusedRowIndex,e.focusedColIndex)){var o,s=i.comp,r=this.getInput(i);r&&(r.reFocus=!0,r._focusStatus="cancel");var a=s.render.tagName.toLowerCase();(o="input"===a||"textarea"===a?s.render:s.render.getElementsByTagName("input")[0])&&WebSquare.text.setCaretPos(o,o.value.length);var n=t.keyCode,l=null;t.key&&1===t.key.length?l=t.key:!t.shiftKey&&65<=n&&n<=90?(n+=32,l=String.fromCharCode(n)):l=n>=96||n<65?{96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"}[n+""]||"":String.fromCharCode(n),"autoComplete"===i.options.inputType?(s.dom.input.value=l,s.inputKeyDown(t)):r&&r.setValueNM(l)}};var y=i(4885),b=function(t){};b.prototype.initializeDrawController=function(){this.data_td_list=[],this.data_num_td_list=[],this.data_status_td_list=[],this.all_data_td_list=[]},b.prototype.showAllBodyTR=function(t){t=t||"";for(var e=0;e<this.drawedRowLength;e++)this._setRowDisplay(e,t);this.lastDisplayedRow="none"===t?-1:this.drawedRowLength-1},b.prototype._setRowDisplay=function(t,e){for(var i=null,o=0;o<this.oneRowLength;o++)(i=this.dataRowList[this.oneRowLength*t+o])&&(i.style.display=e,"none"==e?this.__addClass(i,"w2grid_hidedRow"):this.__removeClass(i,"w2grid_hidedRow"));return i},b.prototype.drawColumnData=function(t,e){var i=this._dataList.rowPosition,o=!1;t=this.getColumnIndex(t);var s=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,r=this.getCellInfo(t);if(r.dataComp){var a=this.modelControl.getDataComp(r.dataComp);null!=a&&"linkedDataList"===a.initializeType&&null!=a.conditionInfo&&a.conditionInfo.filterInfo.useRef&&"number"==typeof i&&(o=!0)}for(var n=0;n<=s;n++){var l=n+this.rowIndex;e&&r.select&&r.hasRef&&(r.select.itemArr=r.getRefItemArr(l),r.select.setSelectOptions(),r.select.setValueNM(r.mainGrid._dataList._getData(l,t))||r.mainGrid._dataList._setData(l,t,"")),o&&n===i||this.drawCellData(n,l,t)}o&&this.drawCellData(i,i+this.rowIndex,t)},b.prototype._setMouseOverTr=function(t,e){this.setOverClass(e,"overTd",!0)},b.prototype._setMouseOutTr=function(t,e){this.setOverClass(e,"overTd",!1)},b.prototype.setOverClass=function(t,e,i){for(var o=t.parentNode,s=a.Z.getDataPrefix("trIndex"),r=a.Z.getDataPrefix("row_out_style"),n=parseInt(o.getAttribute(s));n>0;)n--,o=a.Z.prev(o);do{for(var l=a.Z.first(o);null!=l&&!(l.offsetLeft>this.render.offsetWidth);)l.offsetWidth>0&&(i?(l.setAttribute(r,l.style.cssText),
l.style.cssText=l.style.cssText+";background-color:"+this.options.rowMouseOverColor):l.style.cssText=l.getAttribute(r)),l=a.Z.next(l);o=a.Z.next(o)}while(null!=o&&"0"!=o.getAttribute(s))},b.prototype.changeFocusedCellPosition=function(t,e,i,o){try{if(0==this.focusedCell.length)return;o=o||{};this.applyFocusedCellOut();for(var r=0;r<this.focusedCell.length;r++){var a=this.focusedCell[r].focusedRowIndex-t,n=this.focusedCell[r].focusedColIndex,l=null;if(this.options.focusDefaultColumn&&n<0&&this.defaultColCnt&&("row"===this.options.focusMode||"both"===this.options.focusMode))l=this.all_data_td_list[this.defaultColCnt+n+a*(this.oneRowDataLength+this.defaultColCnt)];else if(this.options.fixedRow>0&&this.options.fixedRow>this.focusedCell[r].focusedRowIndex||this.options.lastFixedRow>0&&this.focusedCell[r].focusedRowIndex>this.lastIndex-this.options.lastFixedRow)l=this.data_td_list[n+this.focusedCell[r].focusedRowIndex*this.oneRowDataLength],this.applyFocusedCellIn(l,e);else if(a<0||a>this.maxRowLength+this.hiddenRowObj.extraRow)l=null;else if(l=this.data_td_list[n+a*this.oneRowDataLength]){var h=this.getCellInfo(n);i&&h.options.embeddedInput&&(e=!1),this.applyFocusedCellIn(l,e,o)}this.focusedCell[r].focusedTd=l}}catch(t){s.Y.printStackTrace(t)}},b.prototype.setTRClass=function(t,e,i){for(var o=t.parentNode,s=a.Z.getDataPrefix("trIndex"),r=parseInt(o.getAttribute(s));r>0;)r--,o=a.Z.prev(o);do{for(var n=a.Z.first(o);null!=n;)i?this.addClass(n,e):this.removeClass(n,e),n=a.Z.next(n);o=a.Z.next(o)}while(null!=o&&"0"!=o.getAttribute(s))},b.prototype.setEditMode=function(t){try{var e=a.Z.getDataPrefix("tdIndex"),i=a.Z.getDataPrefix("col_id"),o=a.Z.getDataPrefix("colMerged"),n=t.getAttribute(i);if(null==n||""==n.wq_trim())return;var l,h=parseInt(t.getAttribute(e)),p=parseInt(h/this.realRowDataLength);if(this.options.fixedRow>0&&this.options.fixedRow>p)l=p;else if(this.options.lastFixedRow>0&&p>this.lastIndex-this.options.lastFixedRow){l=this.getDataLength()-1-(this.lastIndex-p)}else l=p+this.rowIndex;var u=a.Z.getBoolean(r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/colIdToColIndex/@value"))?this.getColumnIndex(t.getAttribute(i)):t.getAttribute(i),c=this.getCellInfo(u);if(!c.options.colMergeEdit&&"1"==t.getAttribute(o))return;if(c.options.embeddedInput||this.groupbyStatus.grouped)return;var g=this.__getEditReadOnly(t,l);if(g)return this.editMode=!1,void(c.options.showReadOnly&&(this.editMode=!0,c.showReadonly(t,l)));if(this._getEditDisabled(l,u))return this.editMode=!1,void(c.options.showReadOnly&&(this.editMode=!0,c.showReadonly(t,l)));if(0!=d.f.fireEvent(this,"onbeforeedit",l,u,this.dataList._getCellData(l,this.getColumnID(u)))&&null==this.editedCell)if(this.editMode=!0,this.setCellEditMode(t,l),c.comp)c.comp.setReadOnly(g);else if("custom"===c.options.inputType&&!c.internal){var f=this.getRealRowIndex(l),m=c.cellManagerHashByRowIndex[f];m.comp&&m.comp.setReadOnly(g)}}catch(t){s.Y.printStackTrace(t)}},b.prototype.getEditReadOnly=function(t,e){var i=a.Z.getDataPrefix("col_id"),o=t.getAttribute(i);return this._getEditReadOnly(e,o)},b.prototype.getReadOnly=function(){var t=a.Z.getBoolean,e=arguments[0];if("grid"==e||0==arguments.length)return t(this.options.readOnly);if("row"==e)return t(this.getRowReadOnly(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnReadOnly(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellReadOnly(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this._getEditReadOnly(o,i)}},b.prototype.setReadOnly=function(){try{var t=arguments[0];if(1==arguments.length||"grid"==t){var e=arguments[arguments.length-1],i=this.options.readOnly,o=a.Z.getBoolean(e);if("clear"==e?(this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],2===arguments.length?(o=!1,this.options.readOnly=o):3===arguments.length&&(o=a.Z.getBoolean(arguments[arguments.length-2]),this.options.readOnly=o)):this.options.readOnly=o,
0!=this.getDataLength()&&(i!==o||"clear"===e)){var r=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex;for(var n in this.cellInfoHash){"clear"===e&&(this.cellInfoHash[n].options.readOnly="");var l=this.getColumnIndex(n);if(!isNaN(l)){for(var h=0;h<=r;h++)this.drawCellData(h,h+this.rowIndex,l);this.applyColumnStyleOptions(l)}}}this.options.readOnly?this.addClass(" w2grid_readonly_outer"):this.removeClass("w2grid_readonly_outer")}else"row"==t?this.setRowReadOnly(arguments[1],arguments[2]):"column"==t?this.setColumnReadOnly(arguments[1],arguments[2]):"cell"==t&&this.setCellReadOnly(arguments[1],arguments[2],arguments[3])}catch(t){s.Y.printStackTrace(t)}},b.prototype._getEditReadOnly=function(t,e,i){try{e=this.getColumnID(e);var o=this.getCellReadOnly(t,e,i),r=this.cellInfoHash[e];if(null==r)return;var n=a.Z.getBoolean;if(o+""!="")return n(o);var l=this.options.readOnlyPriority,h=r.options.readOnly,d=this.getRowReadOnly(t,i);return"column"==l&&""!==h?n(h):"row"==l&&""!==d?n(d):h+""=="true"||d+""=="true"||h+""!="false"&&d+""!="false"&&(this.options.readOnly+""!=""&&n(this.options.readOnly))}catch(t){s.Y.printStackTrace(t)}},b.prototype.__getEditReadOnly=function(t,e){var i=a.Z.getDataPrefix("col_id"),o=t.getAttribute(i);return this.___getEditReadOnly(e,o)},b.prototype.___getEditReadOnly=function(t,e,i){var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)?this.dataList.getRealRowIndex(t):this._getGroupbyDisplayRowIndex(t);return this._getEditReadOnly(o,e,i)},b.prototype.getDisabled=function(){var t=a.Z.getBoolean,e=arguments[0];if("grid"==e||null==e)return t(this.options.disabled);if("row"==e)return t(this.getRowDisabled(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnDisabled(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellDisabled(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this.getEditDisabled(o,i)}},b.prototype.setDisabled=function(t,e,i,o){try{for(var r=[t,e,i,o];r.length>0&&null==r[r.length-1];)r.pop();var n=r[0],l=1==r.length||"grid"==n,h=2==r.length&&"boolean"==typeof r[0]&&"boolean"==typeof r[1],d=a.Z.getDataPrefix("header_id");if(l||h){var p=l?r[r.length-1]:r[0];if((p=a.Z.getBoolean(p))!=this.options.disabled){this.options.disabled=p;var u=this.getElementById(this.id+"_dataLayer");!l&&p||(u.disabled=p),(h||!p&&u.disabledW2)&&(u.disabledW2=p),p?(this.addClass(u,"w2grid_disabled"),this.addClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowXHidden(),this.setOverflowYHidden())):(this.removeClass(u,"w2grid_disabled"),this.removeClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowX(),!0===this._isHybridScroll()?this.setScrollYHeightHybrid():this.setOverflowY()));for(var c=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),g=0;g<c.length;g++){var f=c[g].getAttribute(d),m=this.headerObj[f];m?m.setDisabled?m.setDisabled(p):m.render?m.render.disabled=p:m.disabled=p:c[g].disabled=p}for(var y in this.cellInfoHash){var b=this.cellInfoHash[y];b&&"checkbox"===b.options.inputType&&(""===b.options.disabled?(b._oriDisabled=b.options.disabled,b.options.disabled=p):""===b._oriDisabled&&(b.options.disabled=p));var v=this.getColumnIndex(y);this.drawColumnData(v),this.applyColumnStyleOptions(v)}}return p}"row"==n?this.setRowDisabled(r[1],r[2]):"column"==n?this.setColumnDisabled(r[1],r[2]):"cell"==n&&this.setCellDisabled(r[1],r[2],r[3])}catch(t){s.Y.printStackTrace(t)}},b.prototype.getEditDisabled=function(t,e,i){return this._getEditDisabled(this._getGroupbyGroupedRowIndex(t),e,i)},b.prototype._getEditDisabled=function(t,e,i){try{var o=-1,r="";"number"==typeof e?(o=e,r=this.cellIdList[e]):(o=this.bodyIdColIndexMap[e],r=e);var a=-1;if(!0===i)a=t;else if(this._linkedDataList)a=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var n=!0
;for(var l in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[l]){a=this._dataList.filteredRowIndexArr[t],n=!1;break}n&&(a=this.groupbyStatus.groupedRowIndexArr[t])}else a=this._dataList.filteredRowIndexArr[t];var h=this.cellInfoHash[r]||{options:{}},d=this.cellDisabledArr[a*this.oneRowDataLength+o];if(!0!==d&&!1!==d){var p=h.options.disabled,u=this.rowDisabledArr[a],c=this.options.disabledPriority;!0!==u&&!1!==u&&(u=""),d="column"===c&&""!==p?p:"row"===c&&""!==u?u:p+""=="true"||u+""=="true"||p+""!="false"&&u+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}return d}catch(t){s.Y.printStackTrace(t)}},b.prototype.getElemRowIndex=function(t){var e=a.Z.getDataPrefix("tdIndex"),i=parseInt(t.getAttribute(e));return parseInt(i/this.realRowDataLength)+this.rowIndex},b.prototype.notifyDataChanged=function(t){try{if("active"!=this.activeStatus)return;void 0!==t&&null!=t||(t={}),this.initHeightCompleted=!1,this.checkResize();var e=t&&t.append||!1,i=t&&t.keepTop||!1,o=t&&t.refreshScroll||!1,r=t&&t.refreshInstance||!1,a=i&&this.rowIndex>=0?this.rowIndex:0,n=t&&!0===t.gridData,l={sortIcon:this.options.hideSortIconOnNoData};if(this.delayedDraw({rowIndex:a}))return!0===r&&this._refreshInstance(void 0,e),void this.changeCount++;if(this._mergeRefresh(),!0===this._isBrowserScroll())return t.sync=!i,this.changeCount++,this._refreshDataChanged(t);var h=this._setGridBorderNoRefresh||!1;if(this._setGridBorderNoRefresh=!0,this.options.senseReader&&this.rowIndex<=0)return this.changeCount++,this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),o&&"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(void 0,l),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),this._setGridBorderNoRefresh=h,!0===r&&this._refreshInstance(void 0,e),void this.refreshAdaptive({simple:!0});if(e&&!this.loadFlag)return this.drawFooter(),this.drawHeader(void 0,l),void(!0===r&&this._refreshInstance(void 0,e));if(this.changeCount++,!0===e&&"true"===this.options.keepScrollForSenseReader&&!0===this.options.senseReader&&this.options.visibleRowNum>0)var d=this.drawDataTable(0,{keepScrollTop:!0});else d=this.drawDataTable(0);for(var p in o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),0==d&&(e&&!o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.hiddenCellObj.length>0?(this.rowIndex=a,!0!==n&&this._setCellVisibleRefresh()):this.drawData(a)),this.displayNoResultMessage(),this.displayFixedColumnLine(),this.drawFooter(),this.drawHeader(void 0,l),this._setGridBorderNoRefresh=h,this.refreshAdaptive({simple:!0}),this.cellInfoHash)this.cellInfoHash[p].refreshCell();if(this.hasCustomInputType)for(var u=0;u<this.cellIdList.length;u++){var c=this.cellInfoHash[this.cellIdList[u]];c&&c.options&&"custom"===c.options.inputType&&c.options.typeGetter&&c.refreshCellManagerHash()}!0===r&&this._refreshInstance(void 0,e)}catch(t){s.Y.printStackTrace(t)}},b.prototype.notifyCellChanged=function(t,e,i,o){if(this.changeCount++,!this.delayedDraw({})){var s=this._getTrRowIndex(t);if(e=this.getColumnIndex(e),this._drawRowStatus(s,t),this._drawCellStatus(s,t,e),!0!==i&&(this.drawCellData(s,t,e),this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex)){for(var r=t+1,n=s+1;"number"==typeof this.groupbyStatus.groupedRowIndexArr[r]&&r<this.groupbyStatus.groupedRowIndexArr.length;)r++,n++;if("object"==typeof this.groupbyStatus.groupedRowIndexArr[r]&&"footer"===this.groupbyStatus.groupedRowIndexArr[r].type){var l=this.dataList.getRealRowIndex(r);if(null!=l){var h=this.all_data_td_list[n*this.realRowDataLength];h&&this.drawGroupData(h,l,n)}}}var d=this.getColumnID(e);this._refreshExpression(t,d);var p=this.labelColumnAssArr[d];if(null!=p)for(var u=0;u<p.length;u++){var c=this.getColumnIndex(p[u]);this.drawCellData(s,t,c)}this.displayNoResultMessage(),this.hasSubtotal&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex)),
this.drawFooter(d),this.drawHeader(d),o||this._setCheckboxHead(d),"never"!==this.options.mergeCellsFixedCols&&a.Z.setTimeout((function(){var t={fixedCols:!0,fixedRows:!1};this._mergeCells(this.options.mergeCellsFixedCols,t,{type:"mergeCellsFixedCols"})}),{key:this.id+"notifyCellChanged_mergeRefresh",caller:this,delay:200})}},b.prototype._getTrRowIndex=function(t){try{var e=t;if(this.rowIndex>=0){var i=this.getDataLength();this.options.fixedRow>0&&this.options.fixedRow>t||(this.options.lastFixedRow>0&&e>=i-this.options.lastFixedRow?e=this.lastIndex-(i-1-e):e-=this.rowIndex)}return e}catch(t){s.Y.printStackTrace(t)}},b.prototype._refreshExpression=function(t,e){try{var i=this._getTrRowIndex(t),o=this.expressionAssArr[e];if(null!=o){var r=this.searchExpression(o);for(var a in r){var n=this.getColumnIndex(a);this.drawCellData(i,t,n),this.drawFooter(n),this.drawHeader(n)}}}catch(t){s.Y.printStackTrace(t)}},b.prototype.searchExpression=function(t){for(var e={},i=[t];i.length>0;)for(var o=i.pop(),s=0;s<o.length;s++)if(e[o[s]]=!0,this.expressionAssArr[o[s]]){var r=this.expressionAssArr[o[s]];if(r.length>1)i.push(r);else null!=this.expressionAssArr[r]&&i.push(r),e[r]=!0}return e},b.prototype.notifyRowChanged=function(t,e){if(this.changeCount++,!this.delayedDraw({rowIndex:t})){if(!0===this._isBrowserScroll())return this._refreshDataChanged(e);var i={sortIcon:this.options.hideSortIconOnNoData};if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(void 0,i),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),void this.refreshAdaptive({simple:!0});if(-1==this.rowIndex)this.drawDataTable(0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(e&&!0===e.keepScrollTop)this.lastTopRowIndex=null,this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0});else{this.lastTopRowIndex=null;var o=this._dataList.options.depthColumn?this.getDrawCount()+this.rowIndex:this.getDataLength(),s=(t=t||this.rowIndex)-this.rowIndex,r=this.rowIndex;if(0<=s&&s<=this.lastIndex&&(this.rowIndex<=0||this.rowIndex+this.lastIndex<o))if(this.isDrillDown&&!this.drilldown.isOpen(t)){var n=("linkedDataList"===this.drilldown.mode?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr).length-(t+1),l=this.lastIndex-s-n;r=h=l<=0?this.rowIndex:(h=this.rowIndex-l)>0?h:0}else r=this.rowIndex;else if(0<=s&&s<=this.lastIndex||s<0){var h;(h=this.rowIndex-1)+this.lastIndex>=o&&(h=o-this.lastIndex-1),r=h=h>0?h:0}this.hiddenCellObj.length>0?(this.rowIndex=r,a.Z.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200})):this.drawData(r,0)}this.displayNoResultMessage(),this.displayFixedColumnLine(),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader(void 0,i),this.refreshAdaptive({simple:!0})}},b.prototype.notifyRowInserted=function(t){if(t=parseInt(t,10),this.changeCount++,!this.delayedDraw({rowIndex:t})){if(!0===this._isBrowserScroll())return this._refreshDataChanged();var e={sortIcon:this.options.hideSortIconOnNoData};if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(void 0,e),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),void this.refreshAdaptive({simple:!0});if(this.lastTopRowIndex=null,-1==this.rowIndex)0==this.drawDataTable(0)&&this.drawData(0,0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(""!==this.options.visibleRowNum||this.options.initFixedHeightByRowNum>0)this.setDataTable(),this.drawData(0);else{var i=t-this.rowIndex,o=this.getElementById(this.id+"_scrollY_div");if(i<0){var s=this.getElementById(this.id+"_scrollY_div")
;this.scrollEvent=!1,s.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0)}else(o.offsetHeight>=o.scrollHeight||i<=this.lastIndex)&&(this.hasSubtotal&&(i=0),this.drawData(this.rowIndex,i))}0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight();var r=this._getVisibleLastIndex(this.lastIndex+1);if(this.rowIndex+r-1<t){this.scrollEvent=!1,(s=this.getElementById(this.id+"_scrollY_div")).scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t);var n=this._getEpsilon(),l=Math.round(s.scrollTop)+n,h=this._getVisibleRowIndex(parseInt(l/this.oneRowScrollHeight));this.hiddenCellObj.length>0?(this.rowIndex=h,a.Z.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200}),this.lastTopRowIndex=null):this.drawData(h)}this.displayNoResultMessage(),this.displayFixedColumnLine(),this.drawFooter(),this.drawHeader(void 0,e),this.refreshAdaptive({simple:!0})}},b.prototype.makeNoResultMessage=async function(){try{var t=this.getElementById(this.id+"_noresult"),e=this.options.noResultMessageURL,i=this.getOriginalID()+"_noResultMessageFrame";if(!WebSquare.util.getComponentById(i,this.scope_id)){var o=this.options._scope_obj_uuid,r={className:"noResultDiv",scope:"true",pluginName:"wframe",src:e,preload:!0},a=y.o.create(i,r,null,this.scope_obj,o,!0);await y.o.initAsync(),a.writeTo(t),a.activate(),this.addControl(a)}}catch(t){s.Y.printStackTrace(t)}},b.prototype.calculateBottomFilterBoxHeight=function(t){var e=this.getElementById(this.id+"_foot_table"),i=t?t.offsetHeight:0,o=this.getElementById(this.id+"_main_div");if(e){if(!t||"function"!=typeof t.getBoundingClientRect||!o||"function"!=typeof o.getBoundingClientRect)return i;i+=(t.getBoundingClientRect().top||0)-(o.getBoundingClientRect().bottom||0)}return i},b.prototype.createWrapperDiv=function(t,e,i){var o=document.createElement("div"),s=this.id+"_noresult_wrapper",r=this.getElementById(this.id+"_noresult");if(t=t||0,e=e||0,i&&this.options.groupbyFilterBoxLocation){var a=i.offsetHeight;"top"===this.options.groupbyFilterBoxLocation?t+=a-2:"bottom"===this.options.groupbyFilterBoxLocation&&(e+=this.calculateBottomFilterBoxHeight(i))}return o.style.top=t+"px",o.style.bottom=e+"px",o.id=s,o.classList.add("w2grid_noresult_wrapper"),r.parentNode.insertBefore(o,r),o.appendChild(r),o},b.prototype.displayNoResultMessage=function(){var t="removed"!==this.options.noResultMessageExclude||0==this.removed,e=this.getElementById(this.id+"_noresult");if(e&&this.options.noResultMessageVisible&&t&&0==this.initFlag&&0==this.getDataLength()){var i=this.getElementById(this.id+"_main_div"),o=i.offsetHeight,s=this.getElementById(this.id+"_body_table"),r=this.options.noResultMessageCenter?s.offsetHeight:s.offsetHeight+3,a=this.getElementById(this.id+"_foot_table"),n=0;a&&(n=a.offsetHeight);var l=o-r-n;if(!0!==this.options.useNoResultMessageURL){var h=this.getElementById(this.id+"_noresult");e.innerHTML=this.options.noResultMessage,e.style.display="block";var d=parseInt(WebSquare.style.getStyle(h,"margin-top"),10)||0,p=parseInt(WebSquare.style.getStyle(h,"margin-bottom"),10)||0,u=h.offsetHeight+d+p,c=this.getElementById(this.id+"_scrollX_div").offsetHeight;if(l<=0);else if(l<=u)h.style.top=r+d+"px",this.setSize(i,r+n+u+c+d+p);else{var g=this.getElementById(this.id+"_head_table"),f=0;if(g&&g.childNodes)for(var m=0;m<g.childNodes.length;m++)"string"==typeof g.childNodes[m].tagName&&"TR"===g.childNodes[m].tagName.toUpperCase()&&f++;if(this.options.noResultMessageCenter){var y,b=0;this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(b=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight,(y=this.getElementById(this.id+"_groupbyFilterBox_div"))&&this.options.groupbyFilterBox&&y.offsetHeight);var v=this.id+"_noresult_wrapper",w=this.getElementById(v);if(!w){var C=r+b,I=n+c;w=this.createWrapperDiv(C,I,y)}this.options.noResultMessageStylePriority||h.classList.add("w2grid_noresult_message_default")
}else if((f>1||this.options.groupbyZone)&&!this.options.noResultMessageStylePriority){var _;_=this._noResultMessageDivTop.indexOf("px")>0?o-parseInt(this._noResultMessageDivTop):o*parseInt(this._noResultMessageDivTop)/100;b=0;this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(b=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),h.style.top=parseInt(f*this.oneRowHeight/2+_)+b+"px"}}}else{var x=this.makeNoResultMessage(),S=this.id+"_noresult";x.then(function(t){var e=this.getElementById(S);if(e){var i=this.getElementById(this.id+"_main_div").offsetHeight,o=this.getElementById(this.id+"_body_table"),s=this.options.noResultMessageCenter?o.offsetHeight:o.offsetHeight+3,r=this.getElementById(this.id+"_foot_table"),a=0;r&&(a=r.offsetHeight);var n=i-s-a;e.style.display="flex",e.style.top=s+"px",e.style.height=n+"px"}}.bind(this))}}else e.style.display="none";this.removed=!1,this.delayedDrawObj||this.removeAllFinish||(this.initFlag=!1)},b.prototype.displayFixedColumnLine=function(){try{if(!this.options.fixedColumnLineDiv)return;var t,e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_head_table").offsetHeight,r=this.getRowCount(),n=this.getElementById(this.id+"_fixedColumnDiv"),l=Math.min(e.offsetHeight,i.offsetHeight);if(this.options.fixedColumn>0){var h=this.getElementById(this.id+"_scrollX_left"),d=parseInt(a.Z.getStyleProperty(n,"border-right-width"),10)||0;"tbody"===this.options.fixedColumnLineDivStart?(t=0==r?0:l-o,n.style.top=o+"px"):t=0==r?o:l;var p=h.offsetWidth;n.style.left=p-(d-1)/2+"px",n.style.height=t+"px",n.style.display="block"}else n.style.display="none";var u=this.getElementById(this.id+"_fixedRightColumnDiv");if(this.options.fixedRightColumn>0){var c=this.getElementById(this.id+"_scrollX_fixedRight");d=parseInt(a.Z.getStyleProperty(u,"border-right-width"),10)||0;"tbody"===this.options.fixedColumnLineDivStart?(t=0==r?0:l-o,u.style.top=o+"px"):t=0==r?o:l;p=e.offsetWidth-c.offsetWidth;u.style.left=p-(d-1)/2-1+"px",u.style.height=t+"px",u.style.display="block"}else u.style.display="none"}catch(t){s.Y.printStackTrace(t)}},b.prototype.delayedDraw=function(t){return(0==this.resizeObj.width||0==this.resizeObj.height)&&(this.delayedDrawObj||(this.delayedDrawObj={}),this.delayedDrawObj.redraw=!0,t.hasOwnProperty("rowIndex")?this.delayedDrawObj.rowIndex=t.rowIndex:t.hasOwnProperty("subTotalVisible")?this.delayedDrawObj.subTotalVisible=t.subTotalVisible:t.hasOwnProperty("newColumnOrder")&&(this.delayedDrawObj.newColumnOrder=t.newColumnOrder),!0)},b.prototype.delayedAction=function(){this.startedDisplayNone=!1,this.setPreAction(),this.getRowCount&&this.getRowCount()>0&&this.notifyDataChanged(),this.options.focusOnSetData&&this._setFocusedCell(0,0);var t=WebSquare.BootLoader.fullViewed||!1,e=a.Z.fullViewed||!1;t||e||this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),a.Z.isMobile()&&this.options.fixAdaptive||this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),this.delayedDrawObj=null,this.initFlag=!1},b.prototype.setRedrawStatus=function(t){if(!this.startedDisplayNone||"stop"!=t)if("stop"==t)this.delayedDrawObj||(this.delayedDrawObj={});else{this.setDataLayerPosition(),this.scrollX_right.scrollLeft=this.resizeObj.scrollLeft,this.getElementById(this.id+"_scrollY_div").scrollTop=this.resizeObj.scrollTop,this.handlerResize_drawInitializer(),this._handleScrollX();for(var e=!1,i=0;i<this.colWidthList.length;i++)if(this.colWidthList[i].toString().indexOf("*")>-1){e=!0;break}if((this.options.autoFit||e)&&this.autoFitFunc(),this.delayedDrawObj.redraw){this.lastTopRowIndex=null,this.setDataTable(),this.setTrRowTable(),this.setColIndexInfo();var o=this.delayedDrawObj.rowIndex||0,s=o,r=this.getDataLength()
;if(r-this.drawedRowLength<s&&(s=r-this.drawedRowLength)<0&&(s=0),"all"!==this.options.visibleRowNum)for(;this.hiddenRowObj.extraRow<this.hiddenRowObj.length;)this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.extraRow);if(!0===this._isHybridScroll())this._drawDataHybrid(s,{redraw:!0}),null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal&&this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible);else{this.drawData(s),null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal?this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible):this.setScrollYHeight();var a=this.rowIndex+this.lastIndex,n=this._getScrollRowIndex(o);if(a<o||n<o){this.scrollEvent=!1;var l=this.getElementById(this.id+"_scrollY_div");l.scrollTop=this.oneRowScrollHeight*n;var h=this._getVisibleRowIndex(parseInt(l.scrollTop/this.oneRowScrollHeight));this.drawData(h)}}this.drawFooter(),this.drawHeader(),this.displayNoResultMessage(),this.displayFixedColumnLine();var d="never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols;for(var p in d||(this._mergeRefresh(),this.dynamicMergeHTML()),this.cellInfoHash)this.cellInfoHash[p].refreshCell();this._drawGroupbyZone(),void 0!==this.delayedDrawObj.newColumnOrder&&this.delayedDrawObj.newColumnOrder.length>0&&this.setColumnOrder(this.delayedDrawObj.newColumnOrder)}this._setVisibleRowNumFix(),this.delayedDrawObj=null,this.initFlag=!1}},b.prototype._refreshDataChanged=function(t){try{void 0!==t&&null!=t||(t={}),this._hybridRefreshCnt++;var e={sortIcon:this.options.hideSortIconOnNoData};this.setDataTable();var i=t.keepTop||t.keepScrollTop||!0===this._isHybridScroll();if(!0!==i&&this.drawData(0),this.drawFooter(),this.drawHeader(void 0,e),this.displayNoResultMessage(),t.refreshInstance&&this._refreshInstance(void 0,t.append),!0===i){var o=this.uuid;!0===t.sync||this._hybridRefreshCnt<this._hybridRefreshMax?(!0===t.sync?this._hybridRefreshCnt=0:(this._hybridRefreshCnt++,a.Z.setTimeout((function(){WebSquare.idCache[o]._hybridRefreshCnt=0}),{key:this.id+"_refreshDataChanged_reset",delay:100})),this._refreshScrollYHybrid(t)):a.Z.setTimeout((function(t){var e=WebSquare.idCache[o];e._refreshScrollYHybrid(t),e._hybridRefreshCnt=0}),{key:this.id+"_refreshDataChanged",delay:50,args:[t]})}else this._autoFitRefreshNative();return void this.refreshAdaptive({simple:!0})}catch(t){s.Y.printStackTrace(t)}};var v=function(){};v.prototype.setScrollYHeight=function(t){if(!0!==this._isNativeScroll()){if(!0===this._isHybridScroll())return this.setScrollYHeightHybrid(t);void 0!==t&&null!=t||(t={});var e=this.getDataLength(),i=this.rowIndex,o=!0===t.noDraw,s=!0===t.keepScrollTop,n=this.getElementById(this.id+"_size_y"),l=this.getElementById(this.id+"_scrollY_div"),h=n.parentNode.offsetHeight;0==h&&(h=parseInt(this.getStyle("height")));var d=this._getScrollRowIndex(i);if(-1==i||0==d&&d+this._getVisibleLastIndex(this.lastIndex+1)==e){var p=!0;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var u=this.drawedSubtotal[this.drawedSubtotal.length-1];u.length>0&&(u.rowIndex+1!=e||"none"===u[u.length-1].style.display||this._getLastSubtotalCount()>this.drawedSubtotal.length)&&(p=!1)}else this.hasSubtotal&&0==this.drawedSubtotal.length&&this.lastSubtotalRow&&e>0&&(p=!1);if(p)return"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),void(0!==n.offsetHeight&&(n.style.height="0px",this.handlerResize_drawInitializer()))}var c=l.scrollTop;if(!0!==t.skipResize){var g;if("number"==typeof t.restRowCnt)g=t.restRowCnt;else if(""!==this.options.visibleRowNum)this.options.senseReader&&"all"===this.options.visibleRowNum||this.isDrillDown?g=e-(this.lastIndex+1):(g=e-this.drawedRowLength,this._dynamicVisibleRowNum>0&&(g=e-this._dynamicVisibleRowNum),this.options.initFixedHeightByRowNum>-1&&(g+=this._getLastSubtotalCount())),
g<0&&(g=0),g=Math.max(0,g-this._getHiddenRowCount());else if(this.lastTopRowIndex&&this.lastTopRowIndex>0)g=this._getScrollRowIndex(Math.ceil(this.lastTopRowIndex));else{var f=this.getElementById(this.id+"_head_table"),m=this.dataLayerHeight-f.offsetHeight,y=parseInt(m/this.oneRowHeight),b=this.drawedRowLength;this.oneRowLength>1&&(b=Math.ceil(this.drawedRowLength/this.oneRowLength)),y+(this.isMobile?0:1)<b&&(b=y+(this.isMobile?0:1)),g=this.options.fixHeight||this.hasSubtotal?0===i?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-y>1?e-y:1:this.options.senseReader?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-b+1>1?e-b+(this.isMobile?0:1):1,g=Math.max(0,g-this._getHiddenRowCount())}var v=h+this.oneRowScrollHeight*g;if(h=l.offsetHeight,v<=1e6&&"table"!=n.tagName.toLowerCase())n.style.height=v+"px";else if(v<=1e6)l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,(n=this.getElementById(this.id+"_size_y")).style.height=v+"px";else if(r.I.browserCheck.ieAllVersion&&!this.isIE6or7||a.Z.isSpartan()){var w=[];for(w.push("<table id='"+this.id+"_size_y' style='border-collapse:collapse; border-spacing:0px;height:0px; position:absolute; top:0px; left:0px; width:18px'><tbody>");v>1e6;)w.push("<tr style='height:1000000px'><td></td></tr>"),v-=1e6;w.push("<tr style='height:"+v+"px'><td></td></tr></tbody></table>"),l.innerHTML=w.join(""),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")}else"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),r.I.browserCheck.moz?n.style.height=v+1+"px":n.style.height=v+"px"}else h=l.offsetHeight;if(!0!==t.skipScrollEnd){var C=n.offsetHeight;C<1e6&&(C=parseInt(n.style.height,10));var I=C-h,_=this._getEpsilon(),x=Math.min(Math.round(c)+_,I),S=this._getScrollMaxRowIndex();if(S>e-this._getHiddenRowCount())this._applyScrollEnd(S,{noDraw:!0});else{var R=this.options.syncWithScrollTrack?Math.ceil:Math.floor;if(I>=0&&R.call(this,x/this.oneRowScrollHeight)!=this._getScrollRowIndex(i)){this.lastTopRowIndex&&this.lastTopRowIndex==i&&(i=this.lastTopRowIndex+1);var D=this._getScrollRowIndex(i);o&&l.scrollTop!=this.oneRowScrollHeight*D&&(this.scrollEvent=!1),x=Math.min(this.oneRowScrollHeight*D,I),l.scrollTop=x;var T=this._getVisibleRowIndex(parseInt(x/this.oneRowScrollHeight));this.bScrollTop=T,this.rowIndex=T}!s&&I>0&&I==x&&this._applyScrollEnd(this.rowIndex),this.lastScrollYTop=l.scrollTop,!0!==t.skipResize&&this.handlerResize_drawInitializer(),this.isMobile&&this.setIScrollY()}}else this.handlerResize_drawInitializer()}},v.prototype.setScrollYHeightHybrid=function(t){try{if(void 0!==t&&null!=t||(t={}),!0===t.skipResize)return;var e,i,o,r,a,n=document.getElementById(this.id+"_main_div"),l=this.getFooterHeight(),h=!0===this._hasHybridScroll();if(h&&(e=this._getHybridVisibleHeightInfo(),o=this.getDataLength(),a=r=this._getHybridRowNum(),this.oneRowLength>1&&(a*=this.oneRowLength),h=(a-=e.cnt)>=1),h){var d=Math.floor(o/r),p=e.height;e.cnt>0&&(p=Math.round(p*(a+e.cnt)/a));var u=o-d*r,c=0;if(u>0){var g=r-u;this.oneRowLength>1&&(g*=this.oneRowLength);var f=this._getHybridVisibleHeightInfo(g);c=f.height,f.cnt>0&&(c=Math.round(c*g/(g-f.cnt))),d++}var m=document.getElementById(this.id+"_head_table").offsetHeight,y=0,b=!1;if(!0===t.keepHybridHash){b=!0;for(var v=0;v<d;v++)"number"==typeof this._hybridScrollHash[v]?y+=this._hybridScrollHash[v]:"number"==typeof this._hybridScrollHeight?y+=this._hybridScrollHeight:(y+=p,b=!1)}else y=p*d;i=y-c+m+l+this._getHybridScrollXHeight()+1,this._hybridScrollLastTop=NaN,this._hybridScrollDupHeight=c,!0!==b&&(this._hybridScrollHeight=p),e.cnt>0&&(this._hybridScrollHeight=Math.round(e.height*(a+e.cnt)/a))}else{var w=document.getElementById(this.id+"_body_table");i=Math.max(w.offsetHeight,n.offsetHeight-1)+l+this._getHybridScrollXHeight()+1,this._hybridScrollHeight=i,this._hybridScrollLastTop=i,this._hybridScrollDupHeight=0}
document.getElementById(this.id+"_size_y").offsetHeight!==i&&!0!==t.keepHybridHash&&(this._hybridScrollHash={}),this._setHybridSizeY(i,t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._checkScrollEnd=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=t.offsetHeight;o<1e6&&(o=parseInt(t.style.height,10));var r=o-i,a=this._getEpsilon(),n=e.scrollTop,l=Math.min(Math.round(n)+a,r);return r>0&&r===l}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._checkScrollEnd2=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=parseInt(t.style.height,10)-i,r=this._getEpsilon(),a=e.scrollTop,n=Math.min(Math.round(a)+r,o);return o<=0?-1:n<3?1:n<o?0:2}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._applyScrollEnd=function(t,e){try{if(""!==this.options.visibleRowNum||this.lastTopRowIndex>0||0===this.lastTopRowIndex||this.groupbyStatus.grouped)return 0;if(this.hiddenCellObj.length>0)return 0;if(isNaN(t)&&(t=this.rowIndex),void 0!==e&&null!=e||(e={}),this._applyScrollEndCnt){if(this._applyScrollEndCnt>4)return;this._applyScrollEndCnt++}else this._applyScrollEndCnt=0;var i=0,o=this.getDataLength(),r=!1;if(this.hasSubtotal){if(this.drawedSubtotal.length>0){var a=this.drawedSubtotal[this.drawedSubtotal.length-1];if(a.rowIndex==o-1)"none"!=a[a.length-1].style.display&&(r=!0)}}else r=!0;var n=this.lastIndex+1,l=this._getVisibleLastIndex(n);if(t+l==o&&r)!0!==this._onSetHeight&&(this.lastTopRowIndex=t);else{var h=o-l;i=this._getScrollRowIndex(h)-this._getScrollRowIndex(t);var d=this.getElementById(this.id+"_size_y");if(this.hasSubtotal&&!r&&!0!==this._onSetHeight)if(this.struct.subtotalArr.length>1&&""===this.options.visibleRowNum&&!0!==e.noDraw){var p=this._getDrawedRowCount();if(p>0)return this.options.initFixedHeightByRowNum=p,this.options.visibleRowNum=p,this.drawedRowLength=p,this.lastTopRowIndex=null,this.drawedRowLength=this.options.initFixedHeightByRowNum,void this.drawData(this.rowIndex,0);i+=this.struct.subtotalArr.length}else i+=this.struct.subtotalArr.length;if(0!==i){this.lastTopRowIndex=null;var u=d.offsetHeight;u<1e6&&(u=parseInt(d.style.height,10)),d.style.height=u+this.oneRowScrollHeight*i+"px",!0!==e.noDraw&&this.drawData(Math.max(t+i,0)),this.handlerResize_drawInitializer()}}return this._applyScrollEndCnt=0,i}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.addGridScroll=function(t){try{var e=this.rowIndex+t;e=(e=e<0?0:e)>=this.getDataLength()-this.lastIndex?this.getDataLength()-this.lastIndex:e,this.scrollEvent=!1,this.checkScrollEnd=!0,this.drawData(e,0)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.handleScrollY=function(t,e){try{if(!0===this._isBrowserScroll())return;var i=this.getElementById(this.id+"_scrollY_div").scrollTop;if(i==this.bScrollY)return;if(this.bScrollY=i,0===this.getElementById(this.id+"_size_y").offsetHeight)return;var o=this._getEpsilon(),r=Math.round(i)+o,n=this._getVisibleRowIndex(parseInt(r/this.oneRowScrollHeight)),l=this.getDataLength(),h=this._checkScrollEnd();if(this.scrollEvent&&(null!=this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleScrollY",[t]),this.bScrollTop!=n||this.rowIndex!=n)){this.hasClass(document.activeElement,this.options.bodyTdClass)&&document.activeElement.blur&&document.activeElement.blur();var p="async",u=e&&!0===e.changedHeight;(u||h)&&(p="sync",u||this.handleResize()),this.drawData(n,null,p)}this.bScrollTop=n;var c=this._getVisibleLastIndex(this.lastIndex+1);if(0==i&&this.checkScrollStart&&(this.skipScrollStartEvent||(this.scrollEvent=!0,this.checkScrollStart=this.options.alwaysTriggerScrollStart,d.f.stopEvent(t),a.Z.setTimeout((function(){d.f.fireEvent(this,"onscrollstart")}),{key:this.id+"_scrollstart",caller:this,delay:150}))),(this.scrollEvent||this.checkScrollEnd)&&this.options.loadCount>0&&this.loadFlag){var g=n+c-1
;l-this.options.loadCount-1<=g&&null==this.loadCheck[l]&&(this.skipScrollEndEvent||(this.loadCheck[l]=!0,this.scrollEvent=!0,this.loadFlag=!1,d.f.stopEvent(t),a.Z.setTimeout((function(){d.f.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150})))}else(this.scrollEvent||this.checkScrollEnd)&&0==this.options.loadCount&&!0===h&&(!this.scrollEvent||this._applyScrollEnd(this.rowIndex)<=0)&&(d.f.stopEvent(t),a.Z.setTimeout((function(){d.f.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150}));if(this.skipScrollStartEvent=!1,this.skipScrollEndEvent=!1,this.scrollEvent=!0,this.checkScrollEnd=!1,1==this.options.syncScroll&&this.options.syncScrollId)for(var f=this.options.syncScrollId.split(","),m=0;m<f.length;m++){var y=a.Z.getComponentById(f[m],this.scope_id);y&&this.getRowCount()==y.getRowCount()&&y.setScrollTop(i)}d.f.fireEvent(this,"onscrolly",t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.handleScrollYHybrid=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"number"==typeof e.maxRepeat&&e.maxRepeat<=0)return;!0!==e.skipEndEdit&&this._endEdit();var i=this._getHybridVisibleHeightInfo();this._setHybridVisibleHeight(this._hybridRowIndex,i);var o=document.getElementById(this.id+"_scrollY_div"),r=document.getElementById(this.id+"_size_y"),a=this.getDataLength(),n=a;this.oneRowLength>1&&(n*=this.oneRowLength);var l=this._getHybridTrCount(),h=this.getFooterHeight(),p=document.getElementById(this.id+"_body_table");if(n<=l){this._setHybridYPosition(o.scrollTop),this._hybridScrollYPos=0;var u=o.scrollHeight-o.offsetHeight;return void(u>0&&o.scrollTop>=u&&d.f.fireEvent(this,"onscrollend"))}var c=o.scrollTop;"number"==typeof e.scrollTop&&(c=e.scrollTop);var g=0,f=c,m=this._getHybridLastIndex(),y=this._hybridScrollDupHeight;if(f>0&&f>=this._hybridScrollLastTop)g=m,f=c-this._hybridScrollLastTop+this._hybridScrollDupHeight;else{for(;f>0&&g<m;){var b=null==this._hybridScrollHash[g]?this._hybridScrollHeight:this._hybridScrollHash[g];if(!(f>=b))break;f-=b,g++}g===m&&(f+=y+this._getHybridLastSubtotalHeight()+i.borderHeight)}var v=c-f,w=c-v;if(this._setHybridYPosition(w),g!==this._hybridRowIndex){var C=this._getHybridRowNum(),I=Math.min(g*C,a-C);this.drawData(I),this._hybridRowIndex=g;var _=null==this._hybridScrollHash[g]?this._hybridScrollHeight:this._hybridScrollHash[g];if(this._setHybridVisibleHeight(),_!==this._hybridScrollHash[g])return"number"==typeof e.maxRepeat?e.maxRepeat--:e.maxRepeat=10,e.scrollEvent=!0,this.handleScrollYHybrid({},e)}var x=0;0!==(x=g===m?r.offsetHeight-p.offsetHeight-v-h-this._getHybridScrollXHeight()-1:y-this._hybridScrollDupHeight)&&(v+=x,this._setHybridYPosition(w-x)),this._hybridScrollYPos=v,"scroll"!==t.type&&"onscroll"!==t.type&&!0!==e.scrollEvent||(d.f.fireEvent(this,"onscrolly",t),o.scrollTop>=o.scrollHeight-o.offsetHeight&&d.f.fireEvent(this,"onscrollend")),this._setHybridDataLayerTop()}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._refreshScrollYHybrid=function(t){try{var e=this._getHybridRowNum(),i=this.getDataLength(),o=Math.max(i-e,0),r=Math.min(this._hybridRowIndex*e,o);this._hybridRowIndex=Math.ceil(r/e),this.drawData(r),this.setScrollYHeightHybrid(t),this._autoFitRefreshNative();this.handleScrollYHybrid({},t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.drawDataTable=function(t,e){try{null==t&&(t=this.rowIndex),-1==t&&(t=0);var i=this.drawedRowLength;return this.setDataTable(),this.headerTds=null,this.footerTds=null,this.drawedRowLength!=i&&(this.setColIndexInfo(),e&&e.keepScrollTop?this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0}):this.drawData(t,0)),this.drawedRowLength-i}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.drawData=function(t,e,i,o,a){try{r.I.clearTimer(this.id+"_drawData"),r.I.clearTimer(this.id+"_completiveDrawData"),r.I.clearTimer(this.id+"_adjustDraw");i=i||"sync";var n=!0;this.options.senseReader&&(n=!1);var l=this.getDataLength();t=Math.min(t,l),l>0&&(t=Math.max(0,t)),
this.changeFocusedCellPosition(t,n,!0,{linkNoFocus:!0});var h=this.maxRowLength;if(this.rowIndex=t,null!=this.editedCell&&this.editedCell.handleEndEdit(null,o),this.subtotalHidden(e?{startRowIndex:e+this.rowIndex}:null),-1!=this.rowIndex&&"sync"!=i&&"all"!==this.options.visibleRowNum||this.startedDisplayNone)e=this.fastDrawData(e,{scroll:!0}),r.I.setTimer((function(e){r.I.setTimer(this.completiveDrawData,{key:this.id+"_completiveDrawData",caller:this,delay:120,args:[e],callback:function(e){r.I.setTimer((function(){this.startedDisplayNone||(this.adjustDraw(e),this._setGridBorder(),this._setCheckboxHead()),h!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}),{key:this.id+"_adjustDraw",caller:this})}})}),{key:this.id+"_drawData",caller:this,delay:1,args:[e]});else{var d=this.completiveDrawData(e,!1);this.adjustDraw(d,a),this._setGridBorder(),this._setCheckboxHead(),h!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.fastDrawData=function(t,e){try{var i=this.options.initFixedHeightByRowNum>-1;i&&(void 0===e||null==e?e={skipSubtotal:!0}:e.skipSubtotal=!0),this.options.measureTime&&r.I.measureTime((function(t){var e=t.aver,i=parseInt(1e3/e*10,10)/10;p.v.printLog("Id : "+this.id+", time : "+e+"ms   ,fps : "+i)}),{key:this.id+"_measureDrawTime",caller:this});var o=this.rowIndex,a=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var n=this._getVisibleTrRowIndex(t,o),l=this.hiddenCellObj.length>0;if(a>0){0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);new Date;var h,d=1;l?(h=a,d=a):""===this.options.visibleRowNum?h=this._getVisibleTrRowIndex(this.drawedRowLength,o):("all"===this.options.visibleRowNum||(d=parseInt(this.options.visibleRowNum,10)-t),h=a);for(this._getVisibleTrRowIndex(this.options.drawLimitRow,o);n<h&&n+o<a&&d>0;n++){var u=!this.hiddenRowObj.length>0||this._getRowVisible(n+o);u&&!0===this.hiddenRowObj.init&&this._setRowDisplay(n,""),this.options.fixedRow>0&&this.options.fixedRow>n?this.fastDrawRowData(n,n,e):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(n,n+o,e);var c=this.options.backgroundColorMode.toLowerCase();if("always"==c?"object"!=typeof this.dataList.getRealRowIndex()&&(this.options.fixedRow>0&&this.options.fixedRow>n?this.applyRowStyleOptions(n):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.applyRowStyleOptions(o+n)):"full"==c&&"object"!=typeof this.dataList.getRealRowIndex()&&(this.options.fixedRow>0&&this.options.fixedRow>n?(this.applyRowStyleOptions(n),this.setEvenOddBackground(n,n)):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||(this.applyRowStyleOptions(o+n),this.setEvenOddBackground(n,o+n))),u?this.lastDisplayedRow<n&&!0!==this.hiddenRowObj.init&&(this._setRowDisplay(n,""),l||(this.lastDisplayedRow=n)):this._setRowDisplay(n,"none"),u&&""!==this.options.visibleRowNum)if(d--,i&&this.hasSubtotal&&d>=1)d-=this.drawSubtotalRow(n+1,n+o,{maxCount:d});if(l)for(var g=0;g<this.oneRowDataLength;g++){var f=n+o,m=this._getTdElem(n+o,g);if(m){var y=!0===this.hiddenCellObj[f+"_"+g];m.style.display=y?"none":""}}}}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),null!==this.lastTopRowIndex&&o>=this.lastTopRowIndex&&!0!==this.hiddenRowObj.init&&!l){for(g=n;g<=this.lastDisplayedRow;g++)this._setRowDisplay(g,"none");this.lastDisplayedRow=n-1}return this.options.mergeRefreshAlways&&this.dynamicMergeHTML(),!0===this.hiddenRowObj.init?t:n}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.completiveDrawData=function(t,e){try{!this.autofitDone&&this.options.autoFit&&this._setAutoFit();var i=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var o=this.rowIndex,r=t-1,n=this.dataLayerHeight,l=this.hiddenCellObj.length>0;if(i>0){if(o=Math.max(0,o),this.rowIndex=o,!0===this.hiddenRowObj.init)this._applyRowVisible({applyStyle:!0,drawRow:!0}),r=this.lastIndex;else{
var h=this.options.initFixedHeightByRowNum>-1;0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);var d,p=this.drawedRowLength;this._dynamicVisibleRowNum>0&&(p=this._dynamicVisibleRowNum),h&&this.hasSubtotal&&this.drawedSubtotal&&(p-=this.drawedSubtotal.drawedRowLength),h&&(d={skipSubtotal:!0});for(var u=t;u<p&&u+o<i;u++){var c=u+this.rowIndex;if(this.options.fixedRow>0&&this.options.fixedRow>u?this.fastDrawRowData(u,u,d):this.fastDrawRowData(u,c,d),r=u,h&&this.hasSubtotal&&u<p-1)p-=this.drawSubtotalRow(u+1,c,{maxCount:p-u-1})}if(h&&this.hasSubtotal&&p>r+1&&(p-=this.drawSubtotalRow(0,o-1,{maxCount:p-r-1})),this.options.rowResize&&this.rowResized){var g=n-this.getElementById(this.id+"_head_table").offsetHeight,f=0;for(u=0;u<this.dataRowList.length;u++){if(!(f<g)){r=u;break}f+=this.dataRowList[u].offsetHeight}}if("native"==this.options.drawType&&0!=t&&(r=this.getDataLength()-1),l){for(u=r+1;u<this.drawedRowLength+this.hiddenRowObj.extraRow;u++)this._setRowDisplay(u,"none");for(u=0;u<=r;u++)this._setRowDisplay(u,"")}else{for(u=r+1;u<=this.lastDisplayedRow+this.hiddenRowObj.extraRow;u++)this._setRowDisplay(u,"none");for(u=this.lastDisplayedRow+1;u<=r;u++)this._setRowDisplay(u,"")}var m=l||""===this.options.visibleRowNum&&-1==this.options.initFixedHeightByRowNum;if(m){var y=0,b=this.options.backgroundColorMode.toLowerCase();if("always"!==b&&"full"!==b||(y=t),this.defaultColCnt)for(u=0;u<this.dataRowList.length;u++)this.removeRowOverStyle(this.dataRowList[u],!0);for(u=y;u<=r;u++)this.options.fixedRow>0&&this.options.fixedRow>u?this.applyRowStyleOptions(u):this.applyRowStyleOptions(o+u);this.options.autoResizeEmbeddedInput&&this.firstEmbeddedInputResize&&(this.setAutoResizeEmbeddedInput(),this.firstEmbeddedInputResize=!1)}this.lastDisplayedRow=r,m&&"all"!==this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&(r=this.cutGridBottom(r,e)),!0===this._isBrowserScroll()&&(this.lastIndex=r)}for(u=0;u<=r;u++)this.options.fixedRow>0&&this.options.fixedRow>u?this.setEvenOddBackground(u,u):this.setEvenOddBackground(u,o+u);if(this.options.lastFixedRow>0)for(u=0;u<this.options.lastFixedRow;u++)this.options.lastFixedRowStartIndex>0?(this.fastDrawRowData(r-u,this.options.lastFixedRowStartIndex+1-u),m&&this.applyRowStyleOptions(r-u),this.setEvenOddBackground(r-u,this.options.lastFixedRowStartIndex+1-u)):(this.fastDrawRowData(r-u,i-1-u),m&&this.applyRowStyleOptions(r-u),this.setEvenOddBackground(r-u,i-1-u));if(!0!==this.hiddenRowObj.init&&!l){var v=this._getVisibleLastIndex(r+1);r+1<this.drawedRowLength&&(this._setRowDisplay(v,""),this.setEvenOddBackground(v,o+v),this.applyRowStyleOptions(o+v),this.options.showLastRow&&!this.hasSubtotal?this.getDataLength()<=o+v&&this._setRowDisplay(v,"none"):this._setRowDisplay(v,"none"))}}else{var w=this.options.showLastRow&&!this.hasSubtotal?1:0,C=this.lastDisplayedRow+w;!0===this.hiddenRowObj.init&&(C=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(u=0;u<=C;u++)this._setRowDisplay(u,"none");r=this.lastDisplayedRow=-1}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),this.focusedCell.length>0&&!this.editedCell){var I,_=this.focusedCell[this.focusedCell.length-1].focusedRowIndex-this.rowIndex,x=this.focusedCell[this.focusedCell.length-1].focusedColIndex;if(0<=_&&_<=r)(I=this.options.focusDefaultColumn&&x<0&&this.defaultColCnt&&("row"===this.options.focusMode||"both"===this.options.focusMode)?this.all_data_td_list[this.defaultColCnt+x+_*(this.oneRowDataLength+this.defaultColCnt)]:this.data_td_list[x+_*this.oneRowDataLength])&&this.applyFocusedCellIn(I)}var S=WebSquare.BootLoader.fullViewed||!1,R=a.Z.fullViewed||!1;if(!S&&!R&&"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")){this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(u=this.defaultColCnt;u<this.hiddenList.length;u++)1==this.hiddenList[u]&&this.setAdaptiveColumnVisible(u,!1)}return r}catch(t){s.Y.printStackTrace(t,null,this)}},
v.prototype.adjustDraw=function(t,e){try{void 0!==e&&null!=e||(e={});var i=this.rowIndex;this.dataLayerHeight;if(this.options.lazyDrawHiddenColumn)this.initVisibilityArr=this.colIndexInfo.body.visibilityArr.slice(0),this.hideInvisibleTds();else{this.rollbackCommitFlag=!1;var o=this.lastDisplayedRow;!0===this.hiddenRowObj.init&&(o=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(var r=0;r<=o-this.options.lastFixedRow;r++)this.groupbyStatus.grouped&&"object"==typeof this.dataList.getRealRowIndex(r+i)||(!0!==this.hiddenRowObj.init||this._getRowVisible(r+i))&&(this.options.fixedRow>0&&r<=this.options.fixedRow-1?this.lazyDrawRowData(r,r):this.lazyDrawRowData(r,r+i));this.rollbackCommitFlag=!0}t=this.options.initFixedHeightByRowNum>-1?this.adjustInitFixedByRowNum(t):""!==this.options.visibleRowNum?this.adjustVisibleRowNum(t):this.adjustDefault(t),this.maxRowLength=t,!this.isIE6or7||1==this.options.senseReader&&""==this.options.visibleRowNum||(this._setRowDisplay(t+1,""),this.dataRowList[(t+1)*this.oneRowLength]&&this.dataRowList[(t+1)*this.oneRowLength].offsetHeight,this._setRowDisplay(t+1,"none")),this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.adjustVisibleRowNum=function(t){try{if(""===this.options.visibleRowNum||!0===this._isBrowserScroll())return t;var e=this.rowIndex,i=this.getDataLength();this.setDataTable();var o={noDraw:!0,skipResize:null!=this.lastTopRowIndex};this.setScrollYHeight(o),!0===this.hiddenRowObj.init&&this.applyStyleOptions(t);var r,n=this.getElementById(this.id+"_scrollX_div"),l=parseInt(n.style.height,10),h=this.getElementById(this.id+"_body_table"),d=0;if(!0===this.hiddenRowObj.init)this.lastDisplayedRow=t,this.lastIndex=t,r=h.offsetHeight,a.Z.isIE(9)&&(r=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d);else{var p="all"==this.options.visibleRowNum?i:p=parseInt(this.options.visibleRowNum,10);this.options.initFixedHeightByRowNum>-1&&this.hasSubtotal&&this.drawedSubtotal&&(p-=this.drawedSubtotal.drawedRowLength);for(var u=t+1;u+e<i&&u<p;u++)this.drawRowData(u,u+e),t++;for(u=this.lastDisplayedRow+1;u<=t;u++)this._setRowDisplay(u,"");this.applyStyleOptions(t);for(u=t+1;u<=this.lastDisplayedRow;u++)this._setRowDisplay(u,"none");this.lastDisplayedRow=t,this.lastIndex=t,r=h.offsetHeight,a.Z.isIE(9)&&(r=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d)}this.options.initFixedHeightByRowNum>-1&&i>this.options.initFixedHeightByRowNum||!(r<this.defaultDataLayerHeight)||!0===this.options.isItemTable||this._dynamicVisibleRowNum>0||(r=this.defaultDataLayerHeight);var c=0;""!==this.options.visibleRowNum&&this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(c=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight,this.options.groupbyFilterBox&&(c+=this.groupbyZoneStatus.groupbyFilterBoxRender.offsetHeight));var g=this.getSize("height"),f=r+l+d+c,m=!0!==this._isBrowserScroll();if(this.options.visibleRowNumFix){var y=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(!isNaN(y)){var b=this.getElementById(this.id+"_head_table").offsetHeight;f<this.oneRowHeight*y+b+l+d+1&&(m=!1)}}if((i>0||"all"==this.options.visibleRowNum)&&g!=f&&(m&&this.setSize(null,f),null!=this.lastTopRowIndex)){var v=this._getScrollRowIndex(this.lastTopRowIndex);v!==this._getScrollMaxRowIndex()&&(o.skipResize=!1,o.restRowCnt=v,this.lastTopRowIndex=null)}if(this.options.autoFit&&this._setAutoFit(),this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight,clientWidth:this.render.clientWidth},this.dataLayerHeight=h.parentNode.offsetHeight,this.setScrollYHeight(o),null==this.lastTopRowIndex){var w=this._getVisibleRowIndex(this._getScrollMaxRowIndex()),C=this._getVisibleLastIndex(this.lastIndex+1)
;this.rowIndex===w&&this.rowIndex+C===i&&(this.lastTopRowIndex=this.rowIndex)}return t}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.adjustInitFixedByRowNum=function(t){try{return this.adjustVisibleRowNum(t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.adjustDefault=function(t){try{return""!==this.options.visibleRowNum||(this.adjustDraw_keepTop?this.adjustDraw_keepTop=null:this.setScrollYHeight({skipResize:!0})),t}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.drawBottomData=function(t){try{if(this.rowIndex<0||0==this.rowIndex&&t<=this.lastIndex||this.rowIndex>=0&&this.rowIndex+this.lastIndex==t||isNaN(Number(t)))return;if(!0===this._isNativeScroll())return void this.drawData(0);if(!0===this._isHybridScroll()){var e=Math.max(drawedRowLength-this._getHybridRowNum(),0),i=Math.min(t-e,0);return void this._drawDataHybrid(i)}var o=this.getDataLength();t>=o&&(t=o-1);var r=0;this.lastIndex>-1&&(r=Math.max(t-this.lastIndex,0)),this.rowIndex!==r&&this.drawData(r);var a=this.rowIndex+this.lastIndex-t,n={};n[this.rowIndex]=a;for(var l=5;Math.abs(a)>0&&null==n[this.rowIndex-a]&&l>0;)this.drawData(this.rowIndex-a),a=this.rowIndex+this.lastIndex-t,n[this.rowIndex]=a,l--}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.cutGridBottom=function(t,e){try{if(!0===this._isBrowserScroll())return;var i=this.rowIndex,o=this.dataLayerHeight,r=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody"),l=WebSquare.style.getStyle(r,"border-top-width");l="thin"==l?a.Z.isIE(6)||a.Z.isIE(7)?2:1:"medium"==l?a.Z.isIE(6)||a.Z.isIE(7)?4:3:"thick"==l?a.Z.isIE(6)||a.Z.isIE(7)||a.Z.isOpera()?6:5:parseInt(l,10);var h=parseInt(l/2,10)-r.offsetTop;if(n.getBoundingClientRect){var d=n.getBoundingClientRect(),p=d.bottom-d.top;h+=p-parseInt(p,10)>0?1:0}for(var u=o-h,c=this.getElementById(this.id+"_body_tbody").childNodes,g=(t=-1,!0),f=this.getDataLength(),m=this.oneRowLength*f-1,y=i*this.oneRowLength,b=this.hiddenCellObj.length>0,v={row:[],cnt:0},w=0;w<c.length;w++){var C=c[w],I=!1,_=!1;if(0!==C.offsetHeight){v.row[w]="visible",v.cnt++,this.hasClass(C,"grid_body_row")?(g&&y+t<m?t++:(C.style.display="none",this.addClass(C,"w2grid_hidedRow")),I=!0):C.getAttribute("data-subtotal")&&(g||this._subtotalHidden([C]),_=!0);var x=C.offsetTop+C.offsetHeight-u;if(g&&x>0){if(g=!1,I){var S=t%this.oneRowLength;if(b){var R=this.oneRowHeight/this.oneRowLength;S=Math.floor(x/R)}for(var D=0;D<=S&&w>=D;D++){var T=c[w-D];T.style.display="none",this.addClass(T,"w2grid_hidedRow"),t--}}_&&this._subtotalHidden([C])}}else v.row[w]="hidden"}if(v.cnt-=t+1,b){var L=-1,k=-1;for(w=0;w<v.row.length&&k<t;w+=this.oneRowLength){var F=!1;for(D=0;D<this.oneRowLength;D++)"visible"===v.row[w+D]&&(!1===F&&(L++,F=!0),k++)}t=L}else if(t=Math.floor(t/this.oneRowLength),!this.senseReaderMode){if(!0!==this.hiddenRowObj.init)for(w=t+1;w<=this.drawedRowLength;w++)this._setRowDisplay(w,"none");this.lastDisplayedRow=t}var A=this.options.showLastRow&&!this.hasSubtotal,E=!(1==this.options.senseReader&&"all"!==this.options.visibleRowNum);if(A&&(!this.senseReaderMode||E)){f=this.getDataLength();var M=b?Math.floor(t/this.oneRowLength):t,O=this._getVisibleRowIndex(this._getScrollRowIndex(this.rowIndex)+M+1);if(f>0){for(;!this._getRowVisible(O)&&O<f;)O++;O<f&&this._getRowVisible(O)&&(this._setRowDisplay(O-this.rowIndex,""),this.lazyDrawRowData(O-this.rowIndex,O))}}this.lastIndex=t,!0===this.hiddenRowObj.init&&(this.lastDisplayedRow=t);var N=t;if(e&&!0===e.extraRowByCellHidden){var H=0;for(w=0;w<v.row.length&&v.cnt>0;w+=this.oneRowLength)for(F=!1,D=0;D<this.oneRowLength;D++)"visible"===v.row[w+D]&&(!1===F&&(H++,F=!0),v.cnt--);N=H}return N}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.getLastIndex=function(t){try{var e=this.dataLayerHeight;if(t<0)return this.lastDisplayedRow=-1,-1;for(;;){var i=this.dataRowList[(t+1)*this.oneRowLength-1];if(!(t>0&&i.offsetTop+i.offsetHeight>e))break;t--}return t}catch(t){s.Y.printStackTrace(t,null,this)}},
v.prototype.lazyDrawRowData=function(t,e){try{for(var i=0;i<this.colIndexInfo.body.invisibleTds.length;i++){var o=this.colIndexInfo.body.invisibleTds[i]-this.defaultColCnt,r=this._getColumnMoveIndex(o);r>=0&&this.drawCellData(t,e,r,!0)}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.fastDrawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),r=this.all_data_td_list[t*this.realRowDataLength],a=0;if("number"==typeof o){if((this.groupbyStatus.grouped||this.clearGrouping)&&this.defaultColCnt>0)for(var n=r,l=!0,h=0;h<this.defaultColCnt;h++){var d=this.colIndexes.bodyColInfo.colSpanArr[h]||1;n.setAttribute("colSpan",d),n.style.display="",n.innerText="",n.textContent="",n.className.match("w2grid_groupby")&&(n.className=r.className.split(" ").splice(0,1),this.options.rowNumVisible&&l?(n.className+=" gridBodyDefault_rowNumber",l=!1):n.className+=" gridBodyDefault_rowStatus"),n=n.nextSibling}if(this.options.rowMerge){var p={rowMergeStartPoint:[],rowMergeSameDataLength:[]},u=this.getRowData(e),c=!1,g=0;for(h=0;h<u.length;h++)u[h]==u[h+1]?(c||p.rowMergeStartPoint.push(h),g++,c=!0):(c&&(g++,p.rowMergeSameDataLength.push(g)),c=!1,g=0)}this._drawRowNumData(t,e,i),this._drawRowStatus(t,e,i);var f=this.colIndexInfo.body.visibleTds,m=f.length;i&&!0===i.refreshColumn&&(m=this.oneRowDataLength);for(h=0;h<m;h++){var y;if(i&&!0===i.refreshColumn)y=h;else{var b=f[h]-this.defaultColCnt;y=this._getColumnMoveIndex(b)}if(y>=0)if(this.options.rowMerge){d=null;for(var v=0;v<p.rowMergeStartPoint.length;v++)y==p.rowMergeStartPoint[v]?d=p.rowMergeSameDataLength[v]:p.rowMergeStartPoint[v]<y&&y<p.rowMergeStartPoint[v]+p.rowMergeSameDataLength[v]&&(d=-1);this.drawCellData(t,e,y,null,d,i)}else this.drawCellData(t,e,y,null,null,i)}i&&!0===i.skipSubtotal||(a=this.drawSubtotalRow(t+1,e))}else"object"==typeof o&&this.drawGroupData(r,o,t);return a}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.clearGroupedRow=function(t,e){try{if(this.defaultColCnt>0)for(var i=this.all_data_td_list[t*this.realRowDataLength],o=i,r=!0,a=0;a<this.defaultColCnt;a++){var n=this.colIndexes.bodyColInfo.colSpanArr[a]||1;o.setAttribute("colSpan",n),o.style.display="",o.innerText="",o.textContent="",o.className.match("w2grid_groupby")&&(o.className=i.className.split(" ").splice(0,1),this.options.rowNumVisible&&r?(o.className+=" gridBodyDefault_rowNumber",r=!1):o.className+=" gridBodyDefault_rowStatus"),o=o.nextSibling}for(a=0;a<this.oneRowDataLength;a++){var l=a,h=this._getColumnMoveIndex(l);h>=0&&this.drawCellData(t,e,h)}this.drawSubtotalRow(t+1,e)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.drawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),r=0;if(null==o)return r;var n=a.Z.getDataPrefix("colMerged"),l=this.all_data_td_list[t*this.realRowDataLength];if("number"==typeof o){this._drawRowNumData(t,e),this._drawRowStatus(t,e);for(var h=0;h<this.oneRowDataLength;h++){var d=h,p=this.getCellInfo(d);if(this.drawCellData(t,e,d),p&&p.options.colMerge&&!this.groupbyStatus.grouped)for(var u=this._dataList.getColumnIndex(this.getColumnID(d)),c=this._dataList.dataArr[e*this._dataList.oneRowDataLength+u],g=0;g<=this.maxRowLength-t;g++){var f=this.data_td_list[(t+g)*this.oneRowDataLength+d];if(f){var m=c==this.dataList.getCellData(t+g+1,d)?"1":"0";f.setAttribute(n,m),this.drawCellData(t+g,e+g,d)}}}i&&!0===i.skipSubtotal||(r=this.drawSubtotalRow(t+1,e))}else this.drawGroupData(l,o,t);return r}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.hideNochangeDataLayer=function(t){if(null==this.hideDataLayer){this.hideDataLayer=document.createElement("div"),this.hideDataLayer.className="w2grid_fastScroll_layer";var e=document.createElement("div");e.innerHTML=this.options.scrollMsg,e.className="w2grid_fastScroll_msg",this.hideDataLayer.appendChild(e),this.getElementById(this.id+"_dataLayer").appendChild(this.hideDataLayer)}var i=this.all_data_td_list[(t-1)*this.realRowDataLength],o=i.offsetHeight
;0!=o?(this.hideDataLayer.style.display="block",this.hideDataLayer.style.top=i.offsetTop+o+1+"px"):this.hideDataLayer.style.display="none"},v.prototype.setEvenOddBackground=function(t,e){if(this.options.oddEvenColorDisplay){var i=this.data_td_list[t*this.oneRowDataLength],o=null;if(i){var s=a.Z.getDataPrefix("trIndex");o=i.parentNode;do{o.style.backgroundColor=e%2==1?this.options.evenRowBackgroundColor:this.options.oddRowBackgroundColor,o=a.Z.next(o)}while(null!=o&&"0"!=o.getAttribute(s))}}},v.prototype._drawRowNumData=function(t,e,i){try{if(this.options.rowNumVisible){var o=this.data_num_td_list[t],r="";r=o&&null!=o.textContent?"textContent":o&&null!=o.innerText?"innerText":"innerHTML";var a=this.startRowNumber;this.rowNumArr?"number"==typeof this.rowNumArr[e]&&(a=1+this.rowNumArr[e]):o&&(a=1+e+this.startRowNumber),a>this.startRowNumber&&("span"===this.options.dataTag?o.innerHTML=this.dataTagOpen+a+this.dataTagClose:o[r]=a)}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._drawRowStatus=function(t,e,i){if(this.options.rowStatusVisible){var o=this.data_status_td_list[t];if(o){var s,r=this._linkedDataList||this._dataList;s="linkedDataList"==r.initializeType?r.getRowStatusValue(e):this._dataList.options.depthColumn||this.groupbyStatus.grouped?r._getRowStatusValue(this.getRealRowIndex(e)):r.getRowStatusValue(e),this._drawStatus(s,o,"w2grid_rowStatus_")}}},v.prototype._drawCellStatus=function(t,e,i,o){if(this.options.cellStatusVisible){var s=this.data_td_list[i+t*this.oneRowDataLength];if(s){var r,a=this.getColumnID(i),n=this._linkedDataList||this._dataList;r="linkedDataList"==n.initializeType?n.getCellStatusValue(e,a):this._dataList.options.depthColumn||this.groupbyStatus.grouped?n._getCellStatusValue(this.getRealRowIndex(e),a):n.getCellStatusValue(e,a),this._drawStatus(r,s,"w2grid_cellStatus_","_"+this.options.cellStatusIconPosition,!0)}}},v.prototype._drawStatus=function(t,e,i,o,r){try{var n="",l="";switch("string"!=typeof o&&(o=""),t){case 0:n="R",l=WebSquare.language.getMessage("Grid_rowStatus_initialValue")||"initial value";break;case 1:n="U",l=WebSquare.language.getMessage("Grid_rowStatus_update")||"updated";break;case 2:n="C",l=WebSquare.language.getMessage("Grid_rowStatus_insert")||"inserted";break;case 3:n="D",l=WebSquare.language.getMessage("Grid_rowStatus_delete")||"deleted";break;case 4:n="V",l=WebSquare.language.getMessage("Grid_rowStatus_D_After_C")||"deleted after insertion"}var h=a.Z.getDataPrefix("imageName"),d=e.getAttribute(h)||"";if((d!=n||this.clearGrouping)&&(this.removeClass(e,i+(d||"R")+o),""!=n&&this.addClass(e,i+n+o),"imageName"===h&&(e.imageName=n),e.setAttribute(h,n),!0===this.options.accessibility)){var p=e.id+"_altspan",u=document.getElementById(p);if(!u){(u=document.createElement("span")).id=p;var c=i+"span";!0===r&&(c="w2blind "+c),u.className=c,e.appendChild(u)}u.textContent=l}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.drawCellData=function(t,e,i,o,r,n){try{o||null==this.editedCell||this.editedCell.options.colIndex+""!=i+""||this.editedCell.handleCancelEdit();var l=this.data_td_list[i+t*this.oneRowDataLength];if(l){var h=this.cellInfoHash[this.tdIdList[i]];if(this.groupbyStatus.grouped||this.clearGrouping){var d=this.colIndexes.bodyColInfo.colSpanArr[i+this.defaultColCnt]||1;l.setAttribute("colSpan",d),l.style.display="",l.style.textAlign=h.options.textAlign}if(this.options.rowMerge)if(null==r)l.setAttribute("colSpan",""),l.style.display="",l.style.textAlign="";else if(r>0){d=r;l.setAttribute("colSpan",d),l.style.display="",l.style.textAlign=h.options.textAlign}else-1==r&&(l.style.display="none");!h.options.embeddedInput&&this.groupbyStatus.grouped&&(l.textContent=""),(this.groupbyStatus.grouped||this.clearGrouping)&&this.hasClass(l,"w2grid_groupby")&&(l.className="gridBodyDefault");var p=this.aria_labelledby[i];if(p){var u=t+e+1;l.setAttribute("aria-labelledby",p+" r"+u)}if(h.options.headers&&this.options.applyScopeHeaders){
var c=this.scope_id?this.scope_id+"_":"",g=a.Z.getDataPrefix("headers");l.setAttribute(g,c+h.options.headers)}this.isColMerge&&h.options.colMerge&&!this.groupbyStatus.grouped?this.setColMergeCellData(t,e,i,n):this.setInnerHTML(l,e,i,n),this._drawCellStatus(t,e,i)}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.setColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.setColMergeAndCellData(t,e,i,o);var s=this.data_td_list[i+t*this.oneRowDataLength],r=this.getHasSubtotalCount(e);if(0==t)return 0!=r&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);var n=this.getColumnID(i),l=this.dataList._getCellData(e-1,n),h=this.data_td_list[i+(t-1)*this.oneRowDataLength],d=this.upperGroupingTest(e,i,t),p=this.dataList._getCellData(e,n),u=this._getWrapperCell(s,e);if(l==p&&d){this.options.readOnly&&this.options.readOnlyBackgroundColor?(h.style.borderBottomColor=s.style.backgroundColor,s.style.borderTopColor=s.style.backgroundColor,s.style.borderBottomColor=s.style.backgroundColor):(h.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px"),u.innerHTML="";var c=a.Z.getDataPrefix("viewType"),g=a.Z.getDataPrefix("inputType");if("icon"==s.getAttribute(c)){var f=s.getAttribute(g);this.removeClass(s,this.options.bodyTdClass+"_"+f)}if(this.options.senseReader&&(0==r&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(h.style.borderBottomWidth="1px")),0!=r&&(s.style.borderBottomWidth="1px"),null!=h)return this.applyCellStyleOptions(e,i,!1),"mergeCellBackgroundColor"}else{var m=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==m&&!this.groupbyStatus.grouped&&(m="1px"),this.options.readOnly&&this.options.readOnlyBackgroundColor?s.style.borderTopColor=s.style.backgroundColor:s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=m}},v.prototype.setColMergeAndCellData=function(t,e,i,o){var s=this.data_td_list[i+t*this.oneRowDataLength],r=this.getHasSubtotalCount(e);if(0==t)return 0!=r&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]};var a=this.getColumnID(i);if(null==this.colMergeObj.colArr[i]){var n=this.dataList._getCellData(e-1,a),l=this.dataList._getCellData(e,a);if(this.colMergeObj.colArr[i]=n==l,this.colMergeObj.colArr[i])for(var h=0;h<this.oneRowDataLength;h++){if(null==this.colMergeObj.colArr[h])if(this.getCellInfo(h).options.colMerge){var d=this.getColumnID(h),p=this.dataList._getCellData(e-1,d),u=this.dataList._getCellData(e,d);this.colMergeObj.colArr[h]=p==u}else this.colMergeObj.colArr[h]=!0}}var c=!0;for(h=0;h<this.colMergeObj.colArr.length;h++)if(!this.colMergeObj.colArr[h]){c=!1;break}var g=this.data_td_list[i+(t-1)*this.oneRowDataLength];if(c){g.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px",this._getWrapperCell(s,e).innerHTML="",this.options.senseReader&&(0==r&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(g.style.borderBottomWidth="1px")),0!=r&&(s.style.borderBottomWidth="1px")}else{var f=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==f&&(f="1px"),s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=f}},v.prototype.drawColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.drawColMergeAndCellData(t,e,i,o);var s=this.getColumnID(i),r=this.data_td_list[i+t*this.oneRowDataLength];if(this.options.readOnly&&this.options.readOnlyBackgroundColor||(r.style.borderBottomWidth="0px"),0!=t||o){var n=this.getHasSubtotalCount(e);0==n&&(this.options.readOnly&&this.options.readOnlyBackgroundColor||(r.style.borderBottomWidth="0px"))
;var l=this.dataList._getCellData(e-1,s),h=this.data_td_list[i+(t-1)*this.oneRowDataLength];this.options.readOnly&&this.options.readOnlyBackgroundColor||(r.style.borderTopWidth="0px");var d=this.upperGroupingTest(e,i,t),p=this.dataList._getCellData(e,i),u=WebSquare.style.getComputedStyle(h,"border-right-width"),c=WebSquare.style.getComputedStyle(h,"border-left-width"),g="";if("0px"!=u?g=WebSquare.style.getComputedStyle(h,"border-right-color"):"0px"!=c&&(g=WebSquare.style.getComputedStyle(h,"border-left-color")),l==p&&d){null!=h&&(this.options.readOnly&&this.options.readOnlyBackgroundColor?h.style.borderBottomColor=r.style.backgroundColor:h.style.borderBottomWidth="0px");var f=a.Z.getDataPrefix("colMerged"),m=a.Z.getDataPrefix("viewType"),y=a.Z.getDataPrefix("inputType");if(this.options.readOnly&&this.options.readOnlyBackgroundColor?(r.style.borderTopColor=r.style.backgroundColor,r.style.borderBottomColor=r.style.backgroundColor,t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(h.style.borderBottomColor=g)):(r.style.borderTopWidth="0px",r.style.borderBottomWidth="0px"),r.setAttribute(f,"1"),this._getWrapperCell(r,e).innerHTML="",0!=n&&(r.style.borderBottomWidth="1px"),"icon"===r.getAttribute(m)){var b=r.getAttribute(y);this.removeClass(r,this.options.bodyTdClass+"_"+b)}if(null!=h&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else this.options.readOnly&&this.options.readOnlyBackgroundColor?h.style.borderBottomColor=g:r.style.borderTopWidth="1px"}},v.prototype.drawColMergeAndCellData=function(t,e,i,o){var s=this.getColumnID(i),r=this.data_td_list[i+t*this.oneRowDataLength];if(r.style.borderBottomWidth="0px",0!=t||o){var n=this.getHasSubtotalCount(e);if(0==n&&(r.style.borderBottomWidth="0px"),this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]},null==this.colMergeObj.colArr[i]){var l=this.dataList._getCellData(e-1,s),h=this.dataList._getCellData(e,s);if(this.colMergeObj.colArr[i]=l==h,this.colMergeObj.colArr[i])for(var d=0;d<this.oneRowDataLength;d++){if(null==this.colMergeObj.colArr[d])if(this.getCellInfo(d).options.colMerge){var p=this.getColumnID(d),u=this.dataList._getCellData(e-1,p),c=this.dataList._getCellData(e,p);this.colMergeObj.colArr[d]=u==c}else this.colMergeObj.colArr[d]=!0}}var g=!0;for(d=0;d<this.colMergeObj.colArr.length;d++)if(!this.colMergeObj.colArr[d]){g=!1;break}if(g){var f=this.data_td_list[i+(t-1)*this.oneRowDataLength];null!=f&&(f.style.borderBottomWidth="0px");var m=a.Z.getDataPrefix("colMerged");if(r.style.borderTopWidth="0px",r.style.borderBottomWidth="0px",r.setAttribute(m,"1"),this._getWrapperCell(r,e).innerHTML="",0!=n&&(r.style.borderBottomWidth="1px"),null!=f&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else r.style.borderTopWidth="1px"}},v.prototype.upperGroupingTest=function(t,e,i){try{var o=this.getCellInfo(e),r=o.options.upperColumn;if(this.hasSubtotal&&this.hasUpperSubtotalRow(t))return!1;if(""!=r){if(i){var n=a.Z.getDataPrefix("colMerged"),l=this.getColumnIndex(r),h=this.data_td_list[l+i*this.oneRowDataLength],d=this.getCellInfo(l);if(h&&""==h.style.width&&(""==d.options.upperColumn||d.options.upperColumn&&"1"!=h.getAttribute(n))&&"1"!=h.getAttribute(n)&&1==d.options.colMerge&&!this.groupbyStatus.grouped)return!1}if(this.dataList._getCellData(t,r)!=this.dataList._getCellData(t-1,r))return!1;var p=this.getCellInfo(r);if(p.options.upperColumn&&""!=p.options.upperColumn&&p.options.upperColumn!=o.id)return this.upperGroupingTest(t,r,i)}else{if(this.dataList._getCellData(t,e)!=this.dataList._getCellData(t-1,e))return!1}return!0}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.setDataTable=function(){try{var t=this.getElementById(this.id+"_head_table"),e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_body_tbody")
;if(this.dataLayerHeight=e.parentNode.offsetHeight,""===this.options.visibleRowNum&&0==this.dataLayerHeight)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex});this.defaultDataLayerHeight||(this.isIE6or7||a.Z.isOpera()?this.defaultDataLayerHeight=this.getElementById(this.id+"_main_div").offsetHeight:this.defaultDataLayerHeight=this.dataLayerHeight);var o=0,r=this.getDataLength();if(!0===this._isHybridScroll()){var n=Math.ceil((this.render.offsetHeight-t.offsetHeight)/this.oneRowHeight),l=Math.min(this._getHybridRowNum()+n,r);o=Math.max(l,1)}else if(this.options.senseReader&&"all"===this.options.visibleRowNum)o=r;else if(""===this.options.visibleRowNum)if(this.options.initFixedHeightByRowNum>-1)o=parseInt(this.options.initFixedHeightByRowNum,10)+1;else{var h=this.oneRowHeight;this.hiddenCellObj.length>0&&(h=this.oneRowHeight/this.oneRowLength),o=parseInt((this.dataLayerHeight-t.offsetHeight)/h)+1}else o="all"===this.options.visibleRowNum?r:parseInt(this.options.visibleRowNum,10);if(0==this.drawedRowLength&&(this.tdCellClassArr=new Array(o*this.oneRowLength)),o>this.drawedRowLength){var d=this.drawedRowLength;this.drawedRowLength=o;var p=[],u=!!(this.subtotalStrList&&Object.keys(this.subtotalStrList).length>0);0==d&&u&&(p=p.concat(this.createSubtotalRows(-1)));for(var c=d;c<this.drawedRowLength;c++){for(var g=[],f=0;f<this.oneRowLength;f++){var m=this.tempTr.rows[f].cloneNode(!0);g[f]=m,p.push(m),this.tdCellClassArr.push(null)}this.addBodyRow(c,g),u&&(p=p.concat(this.createSubtotalRows(c)))}0==this.drawedRowLength?e.style.borderWidth="0px":e.style.borderWidth="";for(f=0;f<p.length;f++)i.appendChild(p[f]);for(c=d+this.hiddenRowObj.extraRow;c<this.drawedRowLength+this.hiddenRowObj.extraRow;c++)this._setRowDisplay(c,"none")}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.applyStyleOptions=function(t){try{for(var e=this.rowIndex>=0?this.rowIndex:0,i=0;i<=t+1+this.hiddenRowObj.extraRow&&i<this.drawedRowLength+this.hiddenRowObj.extraRow;i++)"object"!=typeof this.dataList.getRealRowIndex(i+e)&&(this.options.fixedRow>0&&i<=this.options.fixedRow-1||this.options.lastFixedRow>0&&i>t-this.options.lastFixedRow?this.applyRowStyleOptions(i):(!this.hiddenRowObj.length>0||this._getRowVisible(i+e))&&this.applyRowStyleOptions(i+e))}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._setCheckboxHead=function(t){try{if(t)if(1==this.htmlInfo.head.rowArr.length)this.checkHeader(this.bodyToHeaderRelation[t]);else for(var e in this.headerToBodyRelation)this.headerToBodyRelation[e]==t&&this.checkHeader(e);else for(var e in this.headerInfoHash)this.checkHeader(e)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.applyColumnStyleOptions=function(t){try{t=this.getColumnIndex(t);for(var e=0;e<this.drawedRowLength;e++)this.applyCellStyleOptions(e+this.rowIndex,t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.applyRowStyleOptions=function(t,e){try{var i=this._getTrIndex(t);e&&(i=this._getTrIndex(this.getDisplayRowIndex(t)));for(var o=0,r=this.rowIndex;r<t&&this.hiddenRowObj.length>0;r++)this._getRowVisible(r)||o++;if(i<0||i-o>=this.drawedRowLength)return;var a=this.dataRowList[this.oneRowLength*i];if(!a&&!e)return;if(a&&"none"==a.style.display&&!e)return;if(this.options.fixedRow>0&&i==this.options.fixedRow-1){var n=this.dataRowList[this.oneRowLength*(i+1)-1];this.addClass(n,"w2grid_fixedRow")}if(this.options.lastFixedRow>0&&i==this.lastIndex-this.options.lastFixedRow+1){n=this.dataRowList[this.oneRowLength*(i-1)];this.addClass(n,"w2grid_lastFixedRow")}if(this.options.lazyDrawHiddenColumn){var l=this.colIndexInfo.body.visibleTds,h=i*this.oneRowDataLength;for(r=this.defaultColCnt;r<l.length;r++){var d=l[r]-this.defaultColCnt;this.all_data_td_list[h+d]&&(e?this.applyCellStyleOptions(this.getDisplayRowIndex(t),d):this.applyCellStyleOptions(t,d))}}else for(r=0;r<this.oneRowDataLength;r++){
h=i*this.oneRowDataLength;this.data_td_list[h+r]&&(e?this.applyCellStyleOptions(this.getDisplayRowIndex(t),r):this.applyCellStyleOptions(t,r))}var p=!0===this._isHybridScroll(),u=a,c="w2grid_lastRow_hybrid";if(this.hasSubtotal&&this.lastSubtotalRow?(u=this.lastSubtotalRow,c="w2grid_lastRow_subtotal_hybrid"):this.oneRowLength>1&&(u=this.dataRowList[this.oneRowLength*(i+1)-1]),t===this.getRowCount()-1?(this.__addClass(a,"w2grid_lastRow"),p&&this.__addClass(u,c)):this.hasClass(a,"w2grid_lastRow")&&(this.__removeClass(a,"w2grid_lastRow"),p&&this.__removeClass(u,c)),this.hasSubtotal&&!0===this._isBrowserScroll()){var g="w2grid_firstRow_subtotal_native";0===t?this.__addClass(a,g):this.hasClass(a,g)&&this.__removeClass(a,g)}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.setAutoResizeEmbeddedInput=function(){try{for(var t=this.data_td_list,e="",i=null,o=null,r=0,n=0,l=!1,h=a.Z.getDataPrefix("inputType"),d=a.Z.getDataPrefix("colindex"),p=a.Z.getDataPrefix("col_id"),u=a.Z.getDataPrefix("rowindex"),c=0;c<t.length;c++){var g=this._getWrapperCell(t[c],t[c].getAttribute(u));if("text"==t[c].getAttribute(h)||"secret"==t[c].getAttribute(h)){e=t[c].getAttribute(p),o=this.cellInfoHash[e];var f=!1;if((this.dom[o.mainGridId+o.id]||this.dom[t[c].getAttribute("id")+"_"+t[c].getAttribute(h)])&&(f=!0),1==o.options.embeddedInput&&f){i=this.getInput(o,t[c]),null==this._getWrapperTD(i.render.parentNode)&&(g.innerHTML="",g.appendChild(i.render)),"none"==t[c].parentNode.style.display&&(t[c].parentNode.style.display="",l=!0);var m=parseInt(t[c].getAttribute(d),10);this.embeddedStyleObj||(this.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t[c],"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t[c],"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t[c],"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t[c],"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(i.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(i.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(i.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(i.render,"padding-right"),10)});var y=parseInt(WebSquare.style.getStyle(i.render,"border-top-width"),10),b=parseInt(WebSquare.style.getStyle(i.render,"border-bottom-width"),10),v=parseInt(WebSquare.style.getStyle(i.render,"border-left-width"),10),w=parseInt(WebSquare.style.getStyle(i.render,"border-right-width"),10);r=t[c].offsetHeight-parseInt(WebSquare.style.getStyle(t[c],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[c],"border-bottom-width"),10),r-=this.embeddedStyleObj.top+this.embeddedStyleObj.bottom,r-=y+b,this.embeddedWidthObj[m]&&!this.embeddedWidthObj[m].isChanged||(this.embeddedWidthObj[m]={isChanged:!1,width:t[c].clientWidth}),n=this.embeddedWidthObj[m].width,n-=this.embeddedStyleObj.left+this.embeddedStyleObj.right,n-=v+w,n-=this.embeddedStyleObj.inputLeft+this.embeddedStyleObj.inputRight,a.Z.isOpera()&&(r+=2),l?t[c].parentNode.style.display="none":a.Z.isIE("6 7")&&(r-=2),i.setSize(n-2,r-(this.embeddedStyleObj.inputTop+this.embeddedStyleObj.inputBottom)),i.setStyle("lineHeight",r+"px")}}else if("calendar"==t[c].getAttribute(h)){e=t[c].getAttribute(p),o=this.cellInfoHash[e];var C=null;if(1==o.options.embeddedInput){C=this.getInput(o,t[c]),null==this._getWrapperTD(C.render.parentNode)&&(g.innerHTML="",g.appendChild(C.render)),"none"==t[c].parentNode.style.display&&(t[c].parentNode.style.display="",l=!0),r=t[c].offsetHeight-parseInt(WebSquare.style.getStyle(t[c],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[c],"border-bottom-width"),10),r-=this.embeddedCalendarStyleObj.top+this.embeddedCalendarStyleObj.bottom;m=parseInt(t[c].getAttribute(d),10);this.embeddedWidthObj[m]&&!this.embeddedWidthObj[m].isChanged||(this.embeddedWidthObj[m]={isChanged:!1,width:t[c].clientWidth}),n=this.embeddedWidthObj[m].width,n-=this.embeddedCalendarStyleObj.left+this.embeddedCalendarStyleObj.right,
l?t[c].parentNode.style.display="none":a.Z.isIE("6 7")&&(r-=2),C.setSize(n-2,r)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.applyCellStyleOptions=function(t,e,i,o){try{var r=this._getTrIndex(t),n=this._getTdElem(t,e);if(n){var l,h,d,p=[],u=!1;if("number"==typeof e?(l=e,h=this.cellIdList[e]):(l=this.bodyIdColIndexMap[e],h=e),this._linkedDataList)d=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var c=!0;for(var g in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[g]){d=this._dataList.filteredRowIndexArr[t],c=!1;break}c&&(d=this.groupbyStatus.groupedRowIndexArr[t])}else d=this._dataList.filteredRowIndexArr[t];var f=this.cellInfoHash[h]||{options:{}};if("custom"==f.options.inputType&&(f=f.cellManagerHashByRowIndex[d]?f.cellManagerHashByRowIndex[d]:f),"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&"true"==f.options.hidden)return;null!=this.initStyleValueObj[l]&&p.push(this.initStyleValueObj[l].style),""!=f.options.textAlign&&p.push("text-align:"+f.options.textAlign),this.options.adjustAlign&&"left"==f.options.textAlign&&p.push("padding-left:"+this.options.adjustAlign+"px"),null!=this.defaultStyleValueObj[l]&&p.push(this.defaultStyleValueObj[l].style);var m=null,y=null,b=null,v=null,w=null,C=!1;(t<this.options.fixedRow||l<this.options.fixedColumn||l>=this.tdIdList.length-this.options.fixedRightColumn)&&(C=!0),null!=d?(m="number"==typeof d?this.rowStyleArr[d]:this.rowStyleArr[d.type+"_"+d.groupId],y="number"==typeof d?this.rowStyleFixedArr[d]:this.rowStyleFixedArr[d.type+"_"+d.groupId],b="number"==typeof d?this.rowStyleDataArr[d]:this.rowStyleDataArr[d.type+"_"+d.groupId],v="number"==typeof d?this.cellStyleArr[d*this.oneRowDataLength+l]:this.cellStyleArr[d.type+"_"+d.groupId+"_"+l],w=this.cellClassArr[d*this.oneRowDataLength+l]):w=this.cellClassArr[t*this.oneRowDataLength+l],null!=m&&p.push(this.rowStyleValueObj[m].style),null!=y&&C&&p.push(this.rowStyleFixedValueObj[y].style),null==b||C||p.push(this.rowStyleDataValueObj[b].style);var I=this.columnStyleValueObj[l],_=this.columnStyleFixedValueObj[l],x=this.columnStyleDataValueObj[l];null!=I&&p.push(this.columnStyleValueObj[l].style),null!=_&&C&&p.push(this.columnStyleFixedValueObj[l].style),null==x||C||p.push(this.columnStyleDataValueObj[l].style),null!=this.adaptiveColumnStyleValueObj[l]&&!0===this.checkRefreshAdaptive()&&p.push(this.adaptiveColumnStyleValueObj[l].style),null!=v&&p.push(this.cellStyleValueObj[v].style),m=="rowResizeStyle_"+t&&p.push(this.rowStyleValueObj[m].style);var S=this.___getEditReadOnly(t,e);""!=this.options.readOnlyBackgroundColor&&"number"==typeof d&&(1==S?(p.push(this.readOnlyTdStyle),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0))),""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(1==S?(p.push(this.readOnlyTdImg),this.options.readOnlyBackgroundImgCSS||(a.Z.isIE(8)||a.Z.isIE(6)||a.Z.isIE(7))&&(p.push("filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\""),p.push("-ms-filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\"")),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0))),n.disabled=!1,n.removeAttribute("disabled");var R=this.cellDisabledArr[d*this.oneRowDataLength+l],D=R;if(!0!==R&&!1!==R){var T=f.options.disabled,L=this.rowDisabledArr[d],k=this.options.disabledPriority
;!0!==L&&!1!==L&&(L=""),R="column"===k&&""!==T?T:"row"===k&&""!==L?L:T+""=="true"||L+""=="true"||T+""!="false"&&L+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}!0!==R&&"true"!==R||(p.push(this.disabledTdStyle),this.disabledCellStyleObj&&this.disabledCellStyleObj[t+"_"+e]&&this.disabledCellStyleObj[t+"_"+e].style&&p.push(this.disabledCellStyleObj[t+"_"+e].style));var F=this.options.focusMode;if(o&&(F="cell"),!i&&"transparent"!=this.options.selectedRowColor&&("row"==F||"both"==F))for(var A=0;A<this.focusedCell.length;A++)if(t==this.focusedCell[A].focusedRowIndex&&!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&e<this.options.fixedColumn)){p.push("background-color:"+this.options.selectedRowColor),u=!0;break}if(!i&&"transparent"!=this.options.selectedCellColor&&("cell"==F||"both"==F))for(A=0;A<this.focusedCell.length;A++)if(t==this.focusedCell[A].focusedRowIndex&&e==this.focusedCell[A].focusedColIndex){p.push("background-color:"+this.options.selectedCellColor),u=!0;break}("none"!=n.style.display||this.hiddenCellObj.length>0)&&!0!==this.hiddenCellObj[t+"_"+e]||p.push("display:none");var E=!1;this.hiddenCellObj.length>0&&(!0===this.hiddenCellObj[t+"_"+e]&&"none"!==n.style.display||!0!==this.hiddenCellObj[t+"_"+e]&&"none"===n.style.display)&&(E=!0);var M=p.join(";"),O=a.Z.getDataPrefix("style_bak"),N=a.Z.getDataPrefix("colMerged"),H=a.Z.getDataPrefix("or_bgColor"),G=n.style.borderBottomWidth;(M!=n.getAttribute(O)||this.groupbyStatus.grouped||E)&&(n.style.cssText=M);var B=this.cellStyleValueObj[v];if(B&&B["background-repeat"]?n.style.backgroundRepeat=B["background-repeat"]:B&&B["background-size"]?n.style.backgroundSize=B["background-size"]:B&&B["background-position"]&&(n.style.backgroundPosition=B["background-position"]),this.isColMerge&&f.options.colMerge&&!this.groupbyStatus.grouped){n.setAttribute(N,"0");var W=this.drawColMergeCellData(r,t,e);if(this.options.senseReader&&G&&-1!=G.indexOf("px")&&(n.style.borderBottomWidth=G),"mergeCellBackgroundColor"===W&&!u){var V,q=this.getCellStyleValue(t-1,h,"background-color",!0)||this.getColumnStyleValue(e,"background-color"),Y=!0;n.readOnly||this.__getEditReadOnly(n,t)?(V=q,this.options.readOnlyBackgroundColor?V=this.options.readOnlyBackgroundColor:(f.options.readOnlyClass||this.options.readOnlyClass)&&(Y=!1)):(V=""!=q?q:t%2?this.options.oddRowBackgroundColor:this.options.evenRowBackgroundColor,!this.options.disabledClass||!0!==R&&"true"!==R||(Y=!1)),Y&&(n.style.backgroundColor=V,this._setMergeCellBackground(t,h,V)),""!=f.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,f.options.readOnlyClass):this.removeClass(n,f.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,this.options.readOnlyClass):this.removeClass(n,this.options.readOnlyClass))}}if(n.setAttribute(O,M),n.setAttribute(H,n.style.backgroundColor),this.cellReadOnlyArr[d*this.oneRowDataLength+e]||S?(n.setAttribute("readonly","true"),this.options.senseReader&&!f.options.embeddedInput?"linear"===this.options.focusFlow&&n.setAttribute("tabIndex",-1):"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):!1===this.cellReadOnlyArr[d*this.oneRowDataLength+e]||!1===S?(n.setAttribute("readonly","false"),this.options.senseReader&&!f.options.embeddedInput?"linear"===this.options.focusFlow&&n.setAttribute("tabIndex",0):"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0)):n.removeAttribute("readonly"),null!=w){var Z=r*this.oneRowDataLength+e;this.tdCellClassArr[Z]&&this.tdCellClassArr[Z]!=w&&this.removeClass(n,this.tdCellClassArr[Z]),this.tdCellClassArr[Z]=w,this.addClass(n,w)}else{Z=r*this.oneRowDataLength+e;this.tdCellClassArr[Z]&&(this.removeClass(n,this.tdCellClassArr[Z]),this.tdCellClassArr[Z]=void 0)}
if(""!=f.options.disabledClass&&(!0===R||"true"===R?this.addClass(n,f.options.disabledClass):this.removeClass(n,f.options.disabledClass)),!0!==D&&"true"!==D||(""!=this.options.disabledClass?this.addClass(n,this.options.disabledClass):this.removeClass(n,this.options.disabledClass)),""!=this.options.hiddenClass||""!=f.options.hiddenClass){var j=this.options.hiddenClass;""!=f.options.hiddenClass&&(j=f.options.hiddenClass);var P=this._getRealColIndex("body",f.options.col_id)+this.defaultColCnt;this.hiddenList[P]?this.addClass(n,j):this.removeClass(n,j)}}}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.dynamicMergeHTML=function(){try{for(var t in this.tdMergeInfo){var e=this.data_td_list[t];this.tdMergeInfo[t].orgColSpan>1?e.setAttribute("colSpan",this.tdMergeInfo[t].orgColSpan):e.removeAttribute("colSpan"),this.tdMergeInfo[t].orgRowSpan>1?e.setAttribute("rowSpan",this.tdMergeInfo[t].orgRowSpan):e.removeAttribute("rowSpan"),e.style.display=this.tdMergeInfo[t].display,delete this.tdMergeInfo[t]}var i=this.getRowCount(),o=!0===this._isBrowserScroll()?i:Math.min(this.lastIndex+2,i),r=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=!1;for(var l in this.cellMergeInfo){var h=l.split("_"),d=Number(h[0]),p=d;if(!(r&&(d=this.getDisplayRowIndex(d),isNaN(d)||d<0))){var u=Number(h[1]),c=d;this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>d||this.options.lastFixedRow>0&&d>this.lastIndex-this.options.lastFixedRow||(c-=this.rowIndex));var g=this.cellMergeInfo[l].rowSpan,f=this.cellMergeInfo[l].colSpan;if(r){for(var m=g,y=0;y<m;y++)0==this.drilldown.statusArr[p+y]&&g--;g=Math.max(g,1)}var b=0;if(this.hiddenRowObj.length>0)for(y=this.rowIndex;y<d;y++)this._getRowVisible(y)||b++;if(!(c<0&&c+g<=0||c-b>=o||(c<this.options.fixedRow&&c+g>this.options.fixedRow&&(g=c+g-this.options.fixedRow-b,c=this.options.fixedRow),c<this.options.fixedRow&&d>=this.options.fixedRow))){var v=0,w=0;if(this.hiddenRowObj.length>0)for(y=0;y<g;y++)this._getRowVisible(c+y+this.rowIndex)||(w++,y===v&&v++);c+(g-=w)>o+b&&(g=o-c+b);var C=g,I=this.oneRowLength;for(y=0;y<C;y++){for(var _=!1,x=0;x<f;x++){t=(c+y)*this.oneRowDataLength+(u+x);if(null!=(e=this.data_td_list[t]))if(this.hiddenRowObj.length>0&&!this._getRowVisible(c+y+this.rowIndex))e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),_=!0;else if(this.tdMergeInfo[t]={orgColSpan:e.getAttribute("colSpan"),orgRowSpan:e.getAttribute("rowSpan"),display:e.style.display},y===v&&0===x){f>1?(e.setAttribute("colSpan",f),n=!0):e.removeAttribute("colSpan");var S=g*I;if(S>1)if(I>1){var R=parseInt(e.getAttribute("rowSpan"),10);!isNaN(R)&&R>1&&(e.setAttribute("rowSpan",S),n=!0)}else e.setAttribute("rowSpan",g),n=!0;else e.removeAttribute("rowSpan");e.style.display=""}else e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),e.style.display="none"}!0===_&&C++}}}}!0===n&&this.isWebKit&&a.Z.setTimeout(this.redrawTable,{key:this.id+"_dynamicMergeHTML",delay:50,caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.createSubtotalRows=function(t){var e=[];for(var i in this.subtotalTableList){var o=this.subtotalRowHash[i];null==o&&(o=[]);for(var s=this.subtotalTableList[i],r=0;r<s.rows.length;r++){var a=s.rows[r].cloneNode(!0);if(a.style.display="none",this.options.rowNumStatusUniqueId)for(var n=a.getElementsByTagName("td"),l=0;l<this.defaultColCnt;l++){var h=n[l].getAttribute("id");"_headerRowNumber"!==h&&"_headerRowStatus"!==h||n[l].setAttribute("id",h+"_subtotal_"+t)}a.setAttribute("data-subtotal",i+"_"+r),o.push(a),e.push(a)}this.subtotalRowHash[i]=o}return e},v.prototype.addBodyRow=function(t,e){var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),r=0,n=0,l="grid_body_row";!0===this._isBrowserScroll()&&(l+=" "+this.options.gridNativeClass)
;for(var h=a.Z.getDataPrefix("tdIndex"),d=a.Z.getDataPrefix("or_wd"),p=a.Z.getDataPrefix("col_id"),u=a.Z.getDataPrefix("width"),c=0;c<e.length;c++){this.dataRowList.push(e[c]),e[c].className=l;for(var g=e[c].getElementsByTagName("td"),f=0;f<g.length;f++){var m=g[f],y=m.className;m.setAttribute(h,t*this.realRowDataLength+r),m.removeAttribute("title");var b=m.getAttribute(u);if(b&&(m.removeAttribute(u),m.setAttribute(d,b)),this.options.rowNumStatusUniqueId){var v=m.getAttribute("id");"_headerRowNumber"!==v&&"_headerRowStatus"!==v||m.setAttribute("id",v+"_bodyRow_"+t)}if(r++,this.all_data_td_list.push(m),i.test(y))this.data_num_td_list.push(m);else if(o.test(y))this.data_status_td_list.push(m);else if(!this.hasSubtotal||s.test(y)){this.data_td_list.push(m);var w=this.id+"_columnstyle_"+n+"_";this.addClass(m,w);var C=m.getAttribute(p),I=this.getCellInfo(C);if(this.addClass(m,I.options.className),m.style.cssText=""==I.options.textAlign?"":"text-align:"+I.options.textAlign+";",m.setAttribute("id",this.id+"_cell_"+t+"_"+n),this.options.fixedColumn>0){var _=this.getFixedColumnLastIndex();_==f&&this.addClass(m,"w2grid_fixedColumn"),_>f&&this.addClass(m,"w2grid_fixedColumn_td")}if(this.options.fixedRightColumn>0){var x=this.getFixedRightColumnLastIndex();x==f&&this.addClass(m,"w2grid_fixedRightColumn"),x<=f&&this.addClass(m,"w2grid_fixedRightColumn_td")}n++,"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(I.options.embeddedInput||"custom"==I.options.inputType&&1==this.options.senseReader||("link"!=I.options.inputType&&"button"!=I.options.inputType&&"image"!=I.options.inputType&&"user"!=I.options.inputType&&"ul"!=I.options.tableRender&&("expression"==I.options.inputType&&1==this.options.senseReader||m.setAttribute("tabIndex","0")),this.event.addListener(m,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}!0===this._isBrowserScroll()&&this.addClass(m,this.options.gridNativeClass)}}var S=[];if(!this.options.duplicateColumnId){for(c=0;c<e.length;c++){g=e[c].getElementsByTagName("td");var R=[];for(f=0;f<g.length;f++)R[f]=g[f];for(f=0;f<R.length;f++){y=R[f].className;i.test(y)||o.test(y)||S.push(R[f].parentNode.removeChild(R[f]))}}for(c=0;c<this.htmlInfo.body.rowArr.length;c++)for(f=0;f<this.htmlInfo.body.rowArr[c].length;f++)for(var D=this.htmlInfo.body.rowArr[c][f].col_id,T=0;T<S.length;T++)if(S[T].getAttribute(p)==D){e[c].appendChild(S[T]);break}}},v.prototype.addBodyRow2=function(t,e){for(var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),r=[],n=a.Z.getDataPrefix("tdIndex"),l=a.Z.getDataPrefix("or_wd"),h=a.Z.getDataPrefix("col_id"),d=a.Z.getDataPrefix("width"),p=0;p<e.length;p++){this.dataRowList.push(e[p]),e[p].className="grid_body_row";for(var u=e[p].getElementsByTagName("td"),c=0;c<u.length;c++){var g=u[c],f=g.className,m=parseInt(g.getAttribute(n),10)%this.realRowDataLength;g.setAttribute(n,t*this.realRowDataLength+m),g.removeAttribute("title");var y=g.getAttribute(d);if(y&&(g.removeAttribute(d),g.setAttribute(l,y)),this.options.rowNumStatusUniqueId){var b=g.getAttribute("id");"_headerRowNumber"!==b&&"_headerRowStatus"!==b||g.setAttribute("id",b+"_bodyRow_"+t)}if(i.test(f))this.data_num_td_list.push(g),this.all_data_td_list.push(g);else if(o.test(f))this.data_status_td_list.push(g),this.all_data_td_list.push(g);else if(!this.hasSubtotal||s.test(f)){var v=m-this.defaultColCnt;r[v]=g;var w=this.id+"_columnstyle_"+v+"_";this.addClass(g,w);var C=g.getAttribute(h),I=this.getCellInfo(C);this.addClass(g,I.options.className),g.style.cssText=""==I.options.textAlign?"":"text-align:"+I.options.textAlign+";",g.setAttribute("id",this.id+"_cell_"+t+"_"+v),
"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(I.options.embeddedInput||("link"!=I.options.inputType&&"button"!=I.options.inputType&&"image"!=I.options.inputType&&g.setAttribute("tabIndex","0"),this.event.addListener(g,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}}}[].push.apply(this.all_data_td_list,r),[].push.apply(this.data_td_list,r)},v.prototype.addRows=function(t){for(var e=this.drawedRowLength,i=[],o=0;o<t;o++){for(var s=0;s<this.oneRowLength;s++){var r=this.tempTr.rows[s].cloneNode(!0);i.push(r)}this.addBodyRow(e+o,[]),this.hasSubtotal&&(i=i.concat(this.createSubtotalRows(e+o)))}var a=this.getElementById(this.id+"_body_tbody");for(o=0;o<i.length;o++)a.appendChild(i[o])},v.prototype.notifyStatusChanged=function(t){var e,i,o=!1;"object"==typeof t.rowIndex?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getRowCount()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var s=e;s<i;s++){var r;if(r=o?t.rowIndex[s]:s,null!=this.rowStatusColIDArr)for(var a=0;a<this.rowStatusColIDArr.length;a++){var n=this.getColumnIndex(this.rowStatusColIDArr[a]);this.drawCellData(r-this.rowIndex,r,n)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))},v.prototype.refreshColumn=function(t){try{t=this.getColumnIndex(t),this.redrawColumn(t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.refreshRow=function(t){try{var e=t-this.rowIndex;this.drawRowData(e,t)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype.refreshCell=function(t,e){try{e=this.getColumnIndex(e);var i=t-this.rowIndex;this.drawCellData(i,t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._setVisibleRowNumFix=function(){try{if(!this.options.visibleRowNumFix)return;var t=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(t)||t<0||""==t)return;!0===this._visibleRowNumFixResetFlag&&this.setTrRowTable();var e=this._getVisibleRowNumHeight(!0);this.setSize(null,e)}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._getVisibleRowNumHeight=function(t){try{var e=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(e))return 0;!0===t&&this.oneRowLength>1&&(e*=this.oneRowLength);var i=this.getElementById(this.id+"_scrollX_div"),o=parseInt(i.style.height,10),r=0;this.hasFooter&&(r=0==(r=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:r);var a=this.getElementById(this.id+"_head_table").offsetHeight;return this.oneRowHeight*e+a+o+r+1}catch(t){s.Y.printStackTrace(t,null,this)}},v.prototype._getDrawedRowCount=function(){try{for(var t=0,e=this.getElementById(this.id+"_body_tbody").childNodes,i=0;i<e.length;i++){e[i].offsetHeight>0&&t++}}catch(e){s.Y.printStackTrace(e,null,this),t=this.drawedRowLength}return t};var w=function(){};w.prototype.setCellInfo=function(){for(var t=a.Z.getDataPrefix("inputType"),e=a.Z.getDataPrefix("depthColumn"),i=a.Z.getDataPrefix("showDepth"),o=this.tempDiv.getElementsByTagName("td"),s=0;s<o.length;s++){"drilldown"==o[s].getAttribute(t)&&(this.isDrillDown=!0,this.depthColumn=o[s].getAttribute(e),this.showDepth=o[s].getAttribute(i),this._dataList.options.depthColumn||"grid"==this.options.pluginName&&!this.options.drilldownRealRowIndex||(this._dataList.options.depthColumn=this.depthColumn))}},w.prototype.setDataListCellInfo=function(){if(this.successBinding)for(var t=this.getColCnt(),e=0;e<t;e++){var i=this.getColumnID(e),o=this.getCellInfo(i);if(o&&o.options&&o.options.importExp){var s=this._dataList.getCellInfo(i);s&&s.options&&!s.options.importExp&&(s.options.importExp=o.options.importExp)}}},w.prototype.setInnerHTML=function(t,e,i,o){
var s=this.getColumnID(i),r=this.dataList._getCellData(e,s),a=this.cellInfoHash[this.tdIdList[i]];""===r&&(r=a.options.groupName?this.dataList._getCellData(e,a.options.groupName)==a.options.groupValue?a.options.trueValue:a.options.falseValue:a.options.defaultValue);if(a.setInnerHTML(t,r,e,i,o),""!=a.options.disabledClass&&(this._getEditDisabled(e,i)?this.addClass(t,a.options.disabledClass):this.removeClass(t,a.options.disabledClass)),""!=this.options.disabledClass&&!1===this.options.disabled&&(this._getEditDisabled(e,i)?this.addClass(t,this.options.disabledClass):this.removeClass(t,this.options.disabledClass)),""!=a.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,a.options.readOnlyClass):this.removeClass(t,a.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,this.options.readOnlyClass):this.removeClass(t,this.options.readOnlyClass)),""!=this.options.hiddenClass||""!=a.options.hiddenClass){var n=this.options.hiddenClass;""!=a.options.hiddenClass&&(n=a.options.hiddenClass);var l=this._getRealColIndex("body",s)+this.defaultColCnt;this.hiddenList[l]?this.addClass(t,n):this.removeClass(t,n)}},w.prototype.getCellInfo=function(t){try{var e=a.Z.getDataPrefix("col_id"),i="";return i="string"==typeof t?t:"number"==typeof t?this.tdIdList[t]:t?t.getAttribute(e):null,this.cellInfoHash[i]||{options:{}}}catch(t){s.Y.printStackTrace(t,null,this)}},w.prototype._endEdit=function(){null!=this.editedCell&&this.editedCell.handleEndEdit()},w.prototype.initColumns=function(){for(var t in this.cellInfoHash){var e=this.cellInfoHash[t];if("select"==e.options.inputType&&(e.initializeCellInfo(e.element),e.style="",e.comp=null),this.options.initColumns)for(var i in e.dynamicAttrInfo){var o=e.dynamicAttrInfo[i];o&&(e.options[i]=o.originalValue,"displayFormat"!=i&&"displayFormatter"!=i||e.initFormatter())}}},w.prototype.initHeaders=function(){for(var t in this.headerInfoHash){"checkbox"==this.headerInfoHash[t].options.inputType&&this.setHeaderValue(t,!1)}},w.prototype._setCellInfo=function(t,e){this.cellInfoHash2[t]=e},w.prototype.getColumnCount=function(){return this.tdIdList.length},w.prototype.getColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[t];return e||null},w.prototype.getMovedColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[this.columnOrder[t]];return e||null},w.prototype.getColumnIndex=function(t){return"number"==typeof t?t:this.bodyIdColIndexMap[t]},w.prototype.getDisplayColumnIndex=function(t){return"number"==typeof t?t:this.colMoveIndexMap[t]},w.prototype.setExpressionAssociation=function(t,e){try{null==this.expressionAssArr[t]&&(this.expressionAssArr[t]=[]),this.expressionAssArr[t].push(e)}catch(t){s.Y.printStackTrace(t,null,this)}},w.prototype.setLabelColumnAssociation=function(t,e){try{null==this.labelColumnAssArr[t]&&(this.labelColumnAssArr[t]=[]),this.labelColumnAssArr[t].push(e)}catch(t){s.Y.printStackTrace(t,null,this)}},w.prototype.setCellEditMode=function(t,e){this.hideTooltip();var i=this.getCellInfo(t);this.editedCell=i,this.rollbackCommitFlag=!1;var o=this.render.offsetWidth,s=this.render.offsetHeight;i.setEditMode(t,e),o===this.render.offsetWidth&&s===this.render.offsetHeight||(this.handleResize(),i.setEditMode(t,e)),this.rollbackCommitFlag=!0},w.prototype.setCellClickEdit=function(t){var e=this.getElemRowIndex(t),i=this.getCellInfo(t);if("custom"==i.options.inputType&&!i.internal){var o=e;this.isDrillDown&&this._dataList.options.depthColumn&&(o=this.getRealRowIndex(e)),i=i.cellManagerHashByRowIndex[o]?i.cellManagerHashByRowIndex[o]:i}var s=!1;switch(i.options.inputType){case"checkbox":case"radio":case"drilldown":s=i.handleClick(t,e)}return s},w.prototype.getInput=function(t,e,i){var n=t.options.inputType||"text",l=t.options.embeddedInput,h=this.getColumnOption(t.id,"dataType");"text"===n&&"number"===h&&"true"===this.options.floatNumber&&(h="float",t.options.dataType="float");var u,c="bigDecimal"==h,g=this
;if(this.options.titleFormatter&&e)try{if("function"!=typeof this.options.titleFormatter){var f=a.Z.getGlobalFunction(this.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.options.titleFormatter=f,u=f.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i))}else u=this.options.titleFormatter.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i)}catch(t){s.Y.printStackTrace(t,null,this)}var m,y=a.Z.getDataPrefix("col_id"),b=a.Z.getDataPrefix("rowIndex"),v=a.Z.getDataPrefix("rowindex");if(e&&e instanceof HTMLElement&&(m=this._getWrapperCell(e,e.getAttribute(v))),l){if("custom"==t.options.inputType&&!t.internal){var w=this.getElemRowIndex(e);this.isDrillDown&&this._dataList.options.depthColumn&&(w=this.getRealRowIndex(w)),t=t.cellManagerHashByRowIndex[w]?t.cellManagerHashByRowIndex[w]:t}t.parentColumnInfo?C=this.id+"_"+t.id:e?C=e.getAttribute("id")+"_"+n:"calendar"===n&&(C=this.id+"_cell_0_0_"+n),this.fakeInput||"text"!=n&&"secret"!=n&&"calendar"!=n||(this.makeFakeInput=function(){this.fakeInput=new WebSquare.uiplugin.input(this.id+"_fakeInput",{style:"visibility:hidden;position:absolute;z-index:100;background-color:"+this.options.selectedCellColor,className:"w2grid_embedded_input",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",useKeyupBlur:!1,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){g.lastEvent=t,d.f.stopEvent(t);var e=this;setTimeout((function(){e.lastInput.focus()}),1)}}},{name:"oncontextmenu",action:"script",param:{handler:function(t){g.lastEvent=t}}},{name:"ondblclick",action:"script",param:{handler:function(t){g.lastEvent=t,g.hideFakeInput(this),d.f.stopPropagation(t),g.F2Mode=!0,WebSquare.text.setCaretPos(this.lastInput.render,this.lastInput.render.value.length)}}}]}),this.fakeInput.setAction=function(){},this.fakeInput.writeTo(this.render),this.fakeInput.activate(),this.fakeInput.render.parentNode.removeChild(this.fakeInput.render);var t=null;this.showFakeInput=function(e){var i=this._getWrapperTD(e.render.parentNode);if(this.render.appendChild(this.fakeInput.render),!t){var o=this.all_data_td_list[0];t=1-o.offsetLeft}var s=this.getElementById(this.id+"_dataLayer");this.fakeInput.setPosition(i.offsetLeft+t-s.scrollLeft,i.offsetTop+t-s.scrollTop),this.fakeInput.setSize(i.clientWidth,i.clientHeight),a.Z.isIE()&&this.fakeInput.setVerticalAlign(),this.fakeInput.lastInput=e;var r=e.getStyle("text-align");r?this.fakeInput.setStyle("text-align",r):this.fakeInput.setStyle("text-align","")},this.hideFakeInput=function(t){this.fakeInput.render.parentNode&&this.fakeInput.render.parentNode.removeChild(this.fakeInput.render)}})}else var C=t.mainGridId+t.id;var I=!!(q=this.dom[C]);q&&(q.render?"select"!=n||!l||q.render.parentElement||this.groupbyStatus.grouped||(I=!1):q.ownerDocument&&!q.parentNode&&(I=!1)),I&&""!==u&&null!=u&&("text"==n?q.render.setAttribute("title",u):q.setAttribute("title",u));a.Z.getDataPrefix("dateValidCheck");if(I){if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),A=(L=t.mainGridId+"_checkbox_"+t.id)+"_"+k,E=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(M=t.options.checkboxLabelColumn.split(","),O="",N=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showCheckboxLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showCheckboxLabelUserFormat){B=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+B+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}E=E?O+N+E:O}if(t.options.checkboxLabelFormatter)try{
"function"==typeof(W=a.Z.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(E=W.call(this,F,this.getColumnIndex(t.colID),E))}catch(e){p.v.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}(_=e.getElementsByTagName("label")[0])&&(_.innerText=E)}}else if("radio"==n&&l){if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var _;k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),j=(Z=t.mainGridId+"_radio_"+t.id)+"_"+k,P=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(M=t.options.radioLabelColumn.split(","),O="",N=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showRadioLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showRadioLabelUserFormat){B=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+B+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}P=P?O+N+P:O}if(t.options.radioLabelFormatter)try{"function"==typeof(z=a.Z.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(P=z.call(this,F,this.getColumnIndex(t.colID),P))}catch(e){p.v.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}(_=e.getElementsByTagName("label")[0])&&(_.innerText=P)}}else if("text"==n&&l){if(!(U=u||t.options.title||"")){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";this.options.titleAuto&&(U=""==i||null==i?S:S+" "+i,q.render.title=U)}}this.options.titleFormatter&&l&&u&&q.title!==u&&(q.title=u)}else{if("text"!=n&&"secret"!=n||!l){if("select"==n&&l){var x=u||t.options.title||"";if(this.options.titleAuto&&!x){var S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";x=""!==i&&null!=i?S+" "+(this.changeItemValue("label",t.id,[i])[0]||i):S+WebSquare.language.getMessage("Grid_select")}q=new WebSquare.uiplugin.selectbox_native(C,{className:"w2grid_embedded_select",style:"$blank",pluginName:"selectbox",renderType:"native",title:x,emptyItem:t.options.emptyItem,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.options.accessibility,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){d.f.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:return void d.f.stopPropagation(t)}}}}]},t.xml),m.innerHTML=q.toHTML();var R=WebSquare.uiplugin.selectbox_native.prototype.handleOnchange;q.handleOnchange=function(t){var e=g._getWrapperTD(this.render.parentNode).getAttribute(y),i=parseInt(this.render.getAttribute(v),10),o=g._getGroupbyDisplayRowIndex(i),s=g.getColumnIndex(e),r=this.selectedIndex,a=this.getValue();if(R.call(this,t),g.dataList.__setCellData(i,e,this.getValue()),g._dataList.setRowPosition(i),r!=this.selectedIndex){var n={oldValue:a,newValue:this.getValue(),oldSelectedIndex:r,newSelectedIndex:this.selectedIndex,rowIndex:i,colIndex:s,colId:g.getColumnID(s)};d.f.fireEvent(g,"onviewchange",n)}d.f.fireEvent(g,"onafteredit",o,s,this.getValue(),t)};var D=WebSquare.uiplugin.selectbox.prototype.refreshItemset;q.refreshItemset=function(t){var e=g._getWrapperTD(this.render.parentNode).getAttribute(y),i=parseInt(this.render.getAttribute(v),10);D.call(this,t);var o=g._dataList.getCellData(i,e);this.setValueNM(o)},q.activate();var T=q.uuid;q.event.addListener2(q.dom.select,"onfocus",(function(t){g.lastEvent=t;var e=WebSquare.idCache[T];g.getLastFocusedCell().focusedTd==g._getWrapperTD(e.render.parentNode)||g.focusedByApi||g._setFocusedCell(e.render.getAttribute(v),g._getWrapperTD(e.render.parentNode).getAttribute(y)),g.focusedByApi=!1}))}else if("checkbox"==n&&l){
if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){var L,k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),A=(L=t.mainGridId+"_checkbox_"+t.id)+"_"+k,E=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(var M=t.options.checkboxLabelColumn.split(","),O="",N=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){var G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showCheckboxLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showCheckboxLabelUserFormat){var B=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+B+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}E=E?O+N+E:O}if(t.options.checkboxLabelFormatter)try{var W;"function"==typeof(W=a.Z.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(E=W.call(this,F,this.getColumnIndex(t.colID),E))}catch(e){p.v.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}Y="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check'  id='"+A+"' name='"+L+"'/>";var V="<label class='w2checkbox_label ' for='"+A+"'>"+E+"</label>";"left"===t.options.checkboxLabelPosition?Y=V+Y:Y+=V,m.innerHTML=Y;var q=m.getElementsByTagName("input")[0]}else{Y="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check' />",m.innerHTML=Y;q=m.getElementsByTagName("input")[0];if(u)q.title=u;else if(t.options.title)q.title=t.options.title;else if(this.options.titleAuto){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";q.title=i?S+WebSquare.language.getMessage("Grid_title"):S+WebSquare.language.getMessage("Grid_title_not_choose"),E&&(q.title=q.title+E)}}if(this.event.addListener(q,"onclick",this.event.bindAsEventListener(this,(function(t){var e=d.f.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),r=this.getCellInfo(o),a=r.id,n=this.getColumnIndex(a);if(!0===this.options.useShiftKeyCheck&&t.shiftKey){var l={td:o,rowIndex:s,checked:e.checked};this._ShiftKeyMultiCheck(this,l,o)}!0===this.options.useShiftKeyCheck&&(this.beforeChecked={td:o,rowIndex:s,checked:e.checked}),i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,a),this.focusedByApi=!1,r.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&d.f.preventDefault(t)}))),t.options.noDisabledOnReadOnly){var k=this.getElemRowIndex(e);this._getEditReadOnly(k,t.id)?this.addClass(q,this.options.readOnlyClass+"_nodisabled"):this.removeClass(q,this.options.readOnlyClass+"_nodisabled")}}else if("radio"==n&&l){var Y;if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var Z,k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),j=(Z=t.mainGridId+"_radio_"+t.id)+"_"+k,P=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(var M=t.options.radioLabelColumn.split(","),O="",N=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){var G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showRadioLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showRadioLabelUserFormat){var B=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+B+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}P=P?O+N+P:O}if(t.options.radioLabelFormatter)try{var z;"function"==typeof(z=a.Z.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(P=z.call(this,F,this.getColumnIndex(t.colID),P))}catch(e){p.v.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}
Y="<INPUT style='border-width:0px;' type='radio' class='w2grid_embedded_radio'  id='"+j+"' name='"+Z+"'/>";V="<label class='w2radio_label ' for='"+j+"'>"+P+"</label>";"left"===t.options.radioLabelPosition?Y=V+Y:Y+=V,m.innerHTML=Y;q=m.firstChild}else{Y="<INPUT style='border-width:0px;' type='radio' name='"+(t.mainGridId+"_radio_"+t.id)+"' class='w2grid_embedded_radio' />",m.innerHTML=Y;q=m.firstChild;if(u)q.title=u;else if(t.options.title)q.title=t.options.title;else if(this.options.titleAuto){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";q.title=i?S+WebSquare.language.getMessage("Grid_title"):S+WebSquare.language.getMessage("Grid_title_not_choose"),P&&(q.title=q.title+P)}}if(this.event.addListener(q,"onclick",this.event.bindAsEventListener(this,(function(t){var e=d.f.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),r=this.getCellInfo(o),a=r.id,n=this.getColumnIndex(a);i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,a),this.focusedByApi=!1,r.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&d.f.preventDefault(t)}))),t.options.noDisabledOnReadOnly){k=this.getElemRowIndex(e);this._getEditReadOnly(k,t.id)?this.addClass(q,this.options.readOnlyClass+"_nodisabled"):this.removeClass(q,this.options.readOnlyClass+"_nodisabled")}}else if("calendar"==n&&l){var U=u||t.options.title||"";if(this.options.titleAuto&&!U){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";U=""!==i?S+" "+i:S+WebSquare.language.getMessage("Grid_calendar")}var X=t.options.ioFormat,K={style:"width:0px; height:0px;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:X,ioFormatter:"$blank",displayFormat:t.options.displayFormat||X,displayFormatter:t.options.displayFormatter,displayFormatFunc:t.options.displayFormatFunc,calendarDisplayFormatFunc:t.options.calendarDisplayFormatFunc,footerDiv:!0,renderDiv:!0,keepFocusSelect:!0,focusOnOuterDiv:!0,renderType:"native",readOnly:"$blank",disabled:"$blank",title:U,validCheck:!1,_scope_obj_uuid:t.options._scope_obj_uuid,senseReader:t.options.senseReader,accessibility:this.options.accessibility,disableAfterDate:t.options.disableAfterDate,disableBeforeDate:t.options.disableBeforeDate,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(b),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o=g.getColumnIndex(i);d.f.fireEvent(g,"oncellclick",e,o,i),d.f.stopPropagation(t)}}},{name:"onafterviewchange",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=g._getGroupbyDisplayRowIndex(e),o=g.getColumnIndex(g._getWrapperTD(this.render.parentNode).getAttribute(y));t.oldValue!=t.newValue&&d.f.fireEvent(g,"onviewchange",{oldValue:t.oldValue,newValue:t.newValue,rowIndex:i,colIndex:o,colId:g.getColumnID(o)})}}},{name:"ondateselect",action:"script",param:{handler:function(t,e){this.options.senseReader||this.dom.input.blur();var i=this.render.getAttribute(v),o=g._getWrapperTD(this.render.parentNode).getAttribute(y),s=this.getValue();g.dataList.__setCellData(i,o,s),i=parseInt(i,10);var r=g.getColumnIndex(o);d.f.fireEvent(g,"ondateselect",i,r,t,e)}}},{name:"onconfirm",action:"script",param:{handler:function(){this.options.senseReader||this.dom.input.blur();var t=this.render.getAttribute(v),e=g._getWrapperTD(this.render.parentNode).getAttribute(y),i=q.validator.validateString(this.getValue());g.dataList.__setCellData(t,e,i)}}},{name:"onyearselect",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=g.getColumnIndex(g._getWrapperTD(this.render.parentNode).getAttribute(y));d.f.fireEvent(g,"onyearselect",e,i,{oldValue:t.oldValue,newValue:t.newValue})}}},{name:"onmonthselect",action:"script",param:{handler:function(t){
var e=parseInt(this.render.getAttribute(v),10),i=g.getColumnIndex(g._getWrapperTD(this.render.parentNode).getAttribute(y));d.f.fireEvent(g,"onmonthselect",e,i,{oldValue:t.oldValue,newValue:t.newValue})}}},{name:"onbeforepaste",action:"script",param:{handler:function(t){var e={rowIndex:parseInt(this.render.getAttribute(v),10),colIndex:g.getColumnIndex(this.render.parentNode.getAttribute(y)),data:[[t]]};return d.f.fireEvent(g,"onbeforepaste",e)}}}]};q=new WebSquare.uiplugin.inputCalendar(C,K,t.element);try{t.element&&!t.element.getAttribute("dateValidCheck")&&(q.options.dateValidCheck=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false")}catch(t){s.Y.printStackTrace(t,null,this)}if(l&&!e)return q;m.innerHTML="",q.writeTo(m),q.parentControl||this.addControl(q),X!=q.options.ioFormat&&(t.options.ioFormat=q.options.ioFormat,t.initFormatter()),q.setVerticalAlign=function(){},q.handleKeyupEvent=function(){};var J=WebSquare.uiplugin.inputCalendar.prototype.handleFocusEvent;q.handleFocusEvent=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return d.f.stopEvent(t),!1;var e=this.render.getAttribute(v),i=g._getGroupbyDisplayRowIndex(e),o=g._getWrapperTD(this.render.parentNode).getAttribute(y);if(g.lastEvent=t,g.getLastFocusedCell().focusedTd==g._getWrapperTD(this.render.parentNode)||g.focusedByApi||g._setFocusedCell(e,o),J.call(this,t),g.focusedByApi=!1,!this.reFocus&&(g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),this.select(),this.focus(),g.fakeInput.render.parentNode)){var s=g.getColumnIndex(o);d.f.fireEvent(g,"onbeforeedit",i,s,g._dataList.getCellData(e,s))}g.F2Mode=!1,this.reFocus=!1};var $=WebSquare.uiplugin.inputCalendar.prototype.handleKeyEvent;q.handleKeyEvent=function(t){g.lastEvent=t,$.call(this,t);var e=this.dom[q.id+"_input"];switch(t.keyCode){case 46:return void d.f.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void d.f.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(e,e.value.length),g.hideFakeInput(this),void d.f.stopPropagation(t);case 9:for(var i=this.event.getTargetIterator(t,this.render);i.next();){if(i.match("w2inputCalendar_divInput")){d.f.stopPropagation(t);break}if(i.match("w2inputCalendar_button")&&t.shiftKey){d.f.stopPropagation(t);break}}return}var o=t.which||t.keyCode;g.nonCharKeys[o]||(32!=o?(g.fakeInput.render.parentNode&&g.hideFakeInput(this),d.f.stopPropagation(t)):d.f.stopPropagation(t))};var Q=WebSquare.uiplugin.inputCalendar.prototype.handleBlurEvent;q.handleBlurEvent=function(t){var e,i=this.render.getAttribute(v),o=g._getGroupbyDisplayRowIndex(i),s=g._getWrapperTD(this.render.parentNode).getAttribute(y),r=g.getColumnIndex(s),a=q.validator.validateString(this.getValue()),n=WebSquare.historyManager.get(this.options.pluginName,this.id);if(n&&(e=n.value),this.options.disableDateValidSet&&this.disableValidate(a))return null!=n.value&&this._setValue(n.value,{skipValidate:!0}),!1;if(!1===this.validate(a)&&""!=a){if(this.options.dateValidSet&&this.options.dateValidSetCustom);else if(this.options.dateValidSet&&null!=n.value&&this._setValue(n.value,{skipValidate:!0}),"false"!==this.options.displaymessage){var l=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"Invalid date format";this.options.invalidMessageFunc||alert(l)}return!1}if(d.f.fireEvent(g,"oneditend",o,r,a,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=g._getWrapperTD(this.render.parentNode)&&g._setFocusedCell(i,s),d.f.stopEvent(t),!1;g.editEndFlag=!1,Q.call(this,t);g.getCellInfo(s);g.dataList.__setCellData(i,s,a),a=g._dataList.getCellData(i,s);var h=q.sub_validator.validateString(a);this._setValue(h,{skipValidate:!0}),d.f.fireEvent(this,"onafterviewchange",{oldValue:e,newValue:a})
;d.f.fireEvent(g,"onafteredit",i,r,a,g.lastEvent);g.F2Mode=!1},q.setStyle("z-index","10"),q.activate(),this.fakeInput||this.makeFakeInput()}else if("text"==n||"textImage"==n||"drilldown"==n||"secret"==n){st=t.options.type?t.options.type:"text",U=u||"";"secret"==n&&(st="password"),c&&(h="bigDecimal");at={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;z-index:10;",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"all"==t.options.applyFormat?"":"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",title:U,type:st,dataType:h,editType:t.options.editType,byteCheckIgnoreChar:t.options.byteCheckIgnoreChar,maxlength:t.options.maxLength||t.options.maxlength||-1,maskFormat:t.options.maskFormat,maskFormatModelNumber:t.options.maskFormatModelNumber,customModelFormatter:t.options.customModelFormatter,customModelUnformatter:t.options.customModelUnformatter,customPasteFormatter:this.options.customPasteFormatter,useMaxLength:t.options.useMaxLength,adjustMaxLength:t.options.adjustMaxLength,useKeyupBlur:!1,inputMode:t.options.inputMode||"",_scope_obj_uuid:t.options._scope_obj_uuid,xmlEvents:[{name:"ondblclick",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);d.f.fireEvent(g,"oneditdblclick",i,o,t.id)}}}]};t.options.maskFormat&&"display"==t.options.applyFormat&&(at.displayFormat=t.options.displayFormat),t.internal&&(at=o.q.extend(o.q.extend(at,t.initializeInfo.options))),"float"===t.options.dataType&&(at.dataType=t.options.dataType),(q=new WebSquare.uiplugin.input(C,at,t.element)).writeTo(this),this.options.editInputClass&&"text"==n&&this.addClass(q.render,this.options.editInputClass),q.event.addListener(q.render,"oncopy",this.event.bindAsEventListener(this,(function(t){d.f.stopPropagation(t)}))),q.event.addListener(q.render,"onpaste",this.event.bindAsEventListener(this,(function(t){d.f.stopPropagation(t)}))),q.activate(),"number"==t.options.dataType?""==t.options.displayFormat?q.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):t.options.maskFormat&&t.options.displayFormat||q.validator.addCommand(new WebSquare.validator.numberCommand):"euro"==t.options.dataType?q.validator.addCommand(new WebSquare.validator.euroCommand(q.options.delimiter,q.options.decimalDelimiter)):"text"==t.options.dataType&&(t.options.maskFormat&&t.options.displayFormat||(t.options.applyFormat="display")),q.setVerticalAlign=function(){},this._moveKeyEdit(q.uuid,"handleKeydownEvent",{oldMode:!0})}else if("textarea"==n){if(l){var tt,et,it;e&&(k=this.getElemRowIndex(e),tt=this.getColumnIndex(e.getAttribute(y)),et=this._getEditDisabled(k,tt),it=this.___getEditReadOnly(k,tt));var ot="position:relative;display:none;width:150px;height:60px;resize:none;";!0!==this.options.accessibility&&(ot+="z-index:1000;"),q=new WebSquare.uiplugin.textarea(C,{style:ot,className:"$blank",readOnly:!0===it?it:"$blank",disabled:!0===et?et:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.options.accessibility,xmlEvents:[{name:"onkeydown",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode;9!==e&&35!==e&&36!==e&&d.f.stopPropagation(t)}}}]},t.element);Q=WebSquare.uiplugin.textarea.prototype.handleBlurEvent;q.handleBlurEvent=function(t){Q.call(this,t);var e=parseInt(this.render.getAttribute(v),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o=g.getCellInfo(i),s=this.getValue();"number"==o.mainGrid.getColumnOption(o.options.col_id,"dataType")&&""!=s&&(s=Number(s)),o.mainGrid.dataList.__setCellData(e,i,s)}}else{K={style:"position:absolute;display:none;width:150px;height:60px;z-index:1000;resize:none;",className:"$blank",readOnly:"$blank",disabled:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid};!0===t.options.keepCellClass&&(K.className=""),t.internal&&(K=o.q.extend(o.q.extend(K,t.initializeInfo.options))),
q=new WebSquare.uiplugin.textarea(C,K,t.element)}q.writeTo(this),q.event.addListener(q.render,"oncopy",this.event.bindAsEventListener(this,(function(t){d.f.stopPropagation(t)}))),q.event.addListener(q.render,"onpaste",this.event.bindAsEventListener(this,(function(t){d.f.stopPropagation(t)}))),this._moveKeyEdit(q.uuid,"handleKeydownEvent"),q.activate()}else if("calendar"==n){X=t.options.ioFormat,K={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:X,ioFormatter:"$blank",displayFormat:t.options.displayFormat||X,applyFormat:t.options.applyFormat||"display",displayFormatter:"$blank",holidayRef:t.options.holidayRef||"",keepFocusSelect:!0,focusOnOuterDiv:!0,footerDiv:t.options.footerDiv,_scope_obj_uuid:t.options._scope_obj_uuid,readOnly:"$blank",disabled:"$blank",validCheck:!1,renderDiv:!0,inputReadOnly:t.options.inputReadOnly,unformatOnPaste:t.options.unformatOnPaste,pickerType:t.options.pickerType,fixPickerStatus:t.options.fixPickerStatus,xmlEvents:[{name:"ondateselect",action:"script",param:{handler:function(e,i){var o=t.editRowIndex,s=g.getColumnIndex(t.id);d.f.fireEvent(g,"ondateselect",o,s,e,i)}}},{name:"onmonthselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);d.f.fireEvent(g,"onmonthselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onyearselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);d.f.fireEvent(g,"onyearselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onbeforepaste",action:"script",param:{handler:function(e){var i={rowIndex:t.editRowIndex,colIndex:g.getColumnIndex(t.id),data:[[e]]};return d.f.fireEvent(g,"onbeforepaste",i)}}}]};t.internal&&(K=o.q.extend(o.q.extend(K,t.initializeInfo.options)));q=new WebSquare.uiplugin.inputCalendar(C,K,t.element);try{0==t.internal?t.element&&!t.element.getAttribute("dateValidCheck")&&(q.options.dateValidCheck=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false"):1!=t.options.dateValidCheck&&"true"!=t.options.dateValidCheck||(q.options.dateValidCheck="true")}catch(t){s.Y.printStackTrace(t,null,this)}q.writeTo(this),q.event.addListener(q.render,"oncopy",this.event.bindAsEventListener(this,(function(t){d.f.stopPropagation(t)}))),q.event.addListener(q.render,"onpaste",this.event.bindAsEventListener(this,(function(t){d.f.stopPropagation(t)}))),X!=q.options.ioFormat&&(t.options.ioFormat=q.options.ioFormat,t.initFormatter()),this._moveKeyEdit(q.uuid,"handleKeyEvent"),q.activate(),q.setVerticalAlign=function(){},"display"===t.options.applyFormat&&(q.handleKeyupEvent=function(){}),q.setStyle("z-index","10"),q.options.dateValidSet&&q.options.dateValidSetCustom&&(q._skipDateValidSet=!0)}else if("autoComplete"==n&&l){(K={}).titleStr=u,K.input_id=C,K.dataRowIndex=b,K.dataCol_id=y,q=t.getInput(t,e,i,K)}}else{var U=u||t.options.title||"",S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";U||this.options.titleAuto&&("text"==n&&""!==i?U=S+" "+i:("text"==n&&""==i||"secret"==n)&&(U=S));var st=t.options.type?t.options.type:"text",rt="w2grid_embedded_input";"secret"==n&&(st="password",a.Z.isIEAllVersion()?rt+=" w2grid_secret":rt="w2grid_embedded_secret");var at={className:rt,style:"$blank",ioFormat:"$blank",ioFormatter:"$blank",readOnly:"$blank",disabled:"$blank",hidden:"$blank",title:U,type:st,adjustMaxLength:t.options.adjustMaxLength,useMaxLength:t.options.useMaxLength,useKeyupBlur:!1,accessibility:this.options.accessibility,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(b),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o=g.getColumnIndex(i);d.f.fireEvent(g,"oncellclick",e,o,i),d.f.stopPropagation(t)}}},{name:"oncopy",action:"script",param:{
handler:function(t){d.f.stopPropagation(t)}}},{name:"onpaste",action:"script",param:{handler:function(t){d.f.stopPropagation(t)}}},{name:"oncut",action:"script",param:{handler:function(t){d.f.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){this._SenSeReaderBeforeEditValue=null;var e={},i=g._getWrapperTD(this.render.parentNode).getAttribute(y);e.rowIndex=parseInt(this.render.getAttribute(b),10),e.colIndex=g.getColumnIndex(i),e.colID=i,e.keyCode=t.charCode?t.charCode:t.keyCode,this._SenSeReaderBeforeEditValue=this.render.value,e.oldValue=this.render.value,d.f.fireEvent(g,"oneditkeydown",e)}}},{name:"onkeyup",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode,i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o={rowIndex:parseInt(this.render.getAttribute(b),10),colIndex:g.getColumnIndex(i),colID:i,oldValue:this._SenSeReaderBeforeEditValue||"",newValue:this.render.value,inputType:"text",keyCode:e};this._SenSeReaderBeforeEditValue=null,d.f.fireEvent(g,"oneditkeyup",o)}}}]};!0!==this._isBrowserScroll()&&at.xmlEvents.unshift({name:"onmousedown",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(b),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y);if(e-g.rowIndex>=g.lastIndex+1)return d.f.stopEvent(t),g.addGridScroll(1),void g._setFocusedCell(e,i,!0)}}}),"float"===t.options.dataType&&(at.dataType=t.options.dataType),t.options.delimiter="",q=new WebSquare.uiplugin.input(C,o.q.extend(o.q.extend({},t.options),at)),m.innerHTML="",q.writeTo(m),"number"==t.options.dataType&&(""==t.options.displayFormat?q.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):q.validator.addCommand(new WebSquare.validator.numberCommand)),a.Z.isIE()&&q.setVerticalAlign(),q.setVerticalAlign=function(){};var nt=WebSquare.uiplugin.input.prototype.handleBlurEventBasic,lt=this.uuid;q.handleBlurEventBasic=function(t){var e=parseInt(this.render.getAttribute(v),10),i=g._getGroupbyDisplayRowIndex(e),o=g._getWrapperTD(this.render.parentNode).getAttribute(y),s=g._dataList.getColumnIndex(o),r=g.getColumnIndex(o),n=q.validator.validateString(this.getValue());if(d.f.fireEvent(g,"oneditend",i,r,n,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=g._getWrapperTD(this.render.parentNode)&&g._setFocusedCell(e,o),d.f.stopEvent(t),!1;g.editEndFlag=!1,nt.call(this,t,{skipEditEnd:!0});var l=g.getCellInfo(o),h=g.getColumnOption(l.id,"dataType");if(this._isNumberType(h)){var p=n.wq_trim();"."!==p&&"-"!==p&&"+"!==p&&","!==p&&p!=="+"+l.options.decimalDelimiter&&p!=="-"+l.options.decimalDelimiter||(n="")}var u=!(!g.isDrillDown||!g._dataList.options.depthColumn),c=e,f=g._dataList.getRealRowIndex(c);u&&(c=f);var m=g._dataList.dataArr[f*g._dataList.getColumnCount()+s];if(g.dataList.__setCellData(e,o,n),n=g._dataList.getCellData(c,o),"all"==l.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||l._changeDisplayFormat||(n=l.getDisplayData(n)),this.setValue(n),WebSquare.idCache[lt].options.senseReader&&this.options.customFormatter){var b=null;try{"function"==typeof this.options.customFormatter?b=this.options.customFormatter:"function"==typeof(b=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=b)}catch(t){b=null}var w=n,C=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&C&&(w=this.formatter.format(n)),"function"==typeof b){this.useCustomFormatter=!0;var I=b.call(this.mainGrid,n,w,i,s);this.render.value=I}}d.f.fireEvent(g,"onafteredit",i,r,n,g.lastEvent);m!=n&&d.f.fireEvent(g,"onviewchange",{oldValue:m,newValue:n,rowIndex:i,colIndex:r,colId:g.getColumnID(r)}),g.hideFakeInput(q),g.F2Mode=!1};var ht=WebSquare.uiplugin.input.prototype.handleFocusValueEventAdv;q.handleFocusValueEventAdv=function(t){
if(g.editEndFlag&&g.fakeInput.lastInput!=this)return d.f.stopEvent(t),!1;var e=parseInt(this.render.getAttribute(v),10),i=g._getGroupbyDisplayRowIndex(e),o=g._getWrapperTD(this.render.parentNode).getAttribute(y);g.lastEvent=t;var s,r=g.getLastFocusedCell();if(!(!g.isDrillDown||!g._dataList.options.depthColumn)&&(e=g._dataList.getRealRowIndex(e)),r.focusedTd!=g._getWrapperTD(this.render.parentNode)&&(s=!g.focusedByApi||r.focusedRowIndex===e&&r.focusedColIndex===g.getColumnIndex(o)?g._setFocusedCell(e,o):g._setFocusedCell(e,o,!1)),!1!==s){var a=this.reFocus;if(ht.call(this,t),this.reFocus=a,g.focusedByApi=!1,!this.reFocus){var n=g._dataList.getCellData(e,o);if(n!==this.getValue()&&(this.formatter&&(n=this.formatter.format(n)),this.setValue(n)),g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),"select"===this.options.editType&&this.select(),this.focus(),g.fakeInput.render.parentNode){var l=g.getColumnIndex(o);d.f.fireEvent(g,"onbeforeedit",i,l,g._dataList.getCellData(e,l))}}g.F2Mode=!1,this.reFocus=!1}};var dt=WebSquare.uiplugin.input.prototype.handleKeydownEvent;q.handleKeydownEvent=function(t){switch(g.lastEvent=t,dt.call(this,t),t.keyCode){case 46:return void d.f.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void d.f.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(this.render,this.render.value.length),g.hideFakeInput(this),void d.f.stopPropagation(t);case 9:for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2inputCalendar_divInput")){d.f.stopPropagation(t);break}return}var i=t.which||t.keyCode;if(!g.nonCharKeys[i])if(32!=i){if(g.fakeInput.render.parentNode){var o=this.render.getAttribute(v),s=g._getGroupbyDisplayRowIndex(o),r=g._getWrapperTD(this.render.parentNode).getAttribute(y),a=g.getColumnIndex(r);d.f.fireEvent(g,"onbeforeedit",s,a,g.dataList._getCellData(o,a)),g.hideFakeInput(this)}d.f.stopPropagation(t)}else d.f.stopPropagation(t)},q.activate(),this.fakeInput||this.makeFakeInput()}this.dom[C]=q,l&&this.adaptiveEmbeddedInputIdList.push(C)}return q},w.prototype.getTemporaryDataCollectionItemArr=function(t){try{var e=[],i=this.modelControl.getDataComp(t.dataCompID);if(i)switch(i.initializeType){case"linkedDataList":for(var o={},r=0;r<i.filteredRowIndexArr.length;r++){var a=i.getRealRowIndex(r),n=i._dataList.dataArr[a*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[a*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataList":for(o={},r=0;r<i.filteredRowIndexArr.length;r++){n=i.dataArr[i.filteredRowIndexArr[r]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i.dataArr[i.filteredRowIndexArr[r]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataMap":for(o={},r=0;r<i._dataList.oneRowDataLength;r++){n=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}}return e}catch(t){s.Y.printStackTrace(t)}},w.prototype._getWrapperCell=function(t,e){try{if(!t)return t;var i=t;if(this.options.wrapperCell&&this.options.wrapperCellElem){if(!t.firstChild||t.firstChild.tagName!==this.options.wrapperCellElem.toUpperCase()){var o=document.createElement(this.options.wrapperCellElem);o.id=this.id+"_wrapperCell_"+this.getCellInfo(t).colID+"_"+e,o.className="w2grid_wrapperCell",t.appendChild(o)}i=t.firstChild}return i}catch(e){return s.Y.printStackTrace(e),t}},w.prototype._getWrapperTD=function(t){try{if(!t)return t;var e=t;return this.options.wrapperCell&&this.options.wrapperCellElem&&t.tagName===this.options.wrapperCellElem.toUpperCase()&&(e=t.parentNode),e}catch(e){return s.Y.printStackTrace(e),t}};var C=function(){};C.prototype.initializeHead=function(){try{
this.headerObj={},this.headerConfigOptions={};for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=[],i={},o=0;o<t.length;o++){if(i[t[o].id]){var r=WebSquare.language.getMessage("E_comp_duplicated_Msg",t[o].id)||"id["+t[o].id+"] is duplicated. Check the source code.";$l(r)}else i[t[o].id]=t[o].id;e.push(t[o])}var n=a.Z.getDataPrefix("header_id"),l=a.Z.getDataPrefix("inputType"),h=a.Z.getDataPrefix("dataType"),d=a.Z.getDataPrefix("value"),p=a.Z.getDataPrefix("useLocale"),u=a.Z.getDataPrefix("localeRef"),c=a.Z.getDataPrefix("toolTip");for(o=0;o<e.length;o++){var g=e[o];if(!g.getAttribute(n)){var f=g.getAttribute(l),m=g.getAttribute(h),y=g.getAttribute(d),b=null;if(this.setConfigOptions(g,"header"),"checkbox"==f)g.innerHTML="",(b=this.setCheckboxHead(g,y)).headInputType="checkbox";else if("select"==f)(b=this.setSelectboxHead(g,y)).headInputType="select";else if("text"==f&&"own"==m)(b=this.setInputHead(g,y)).headInputType="input";else if("checkcombobox"==f)(b=this.setCheckcomboboxHead(g,y)).headInputType="checkcombobox";else if("textImage"==f)(b=this.setTextImageHead(g,y)).headInputType="textImage";else{var v=g.getAttribute(d),w=g.getAttribute(p);if("true"===w||this.options.useLocale&&!w){var C=g.getAttribute(u);if(C){(_=this.getLocaleValue(C))&&(v=_)}else{var I=g.getAttribute("id");if(null!=I&&I.match("RowNumber")&&this.options.rowNumLocaleRef)(_=this.getLocaleValue(this.options.rowNumLocaleRef))&&(v=_);else if(null!=I&&I.match("RowStatus")&&this.options.rowStatusLocaleRef){var _;(_=this.getLocaleValue(this.options.rowStatusLocaleRef))&&(v=_)}}}v=null!=v?v:"",g.innerHTML=this.dataTagOpen+v+this.dataTagClose}var x=g.getAttribute("id");g.setAttribute(n,x);var S=g.className;if(!0===this._isBrowserScroll()&&(S+=" "+this.options.gridNativeClass,this.struct.head.rowArr.length>1&&(S+=" "+this.options.gridNativeClass+"MultiHeader")),S+=" "+this.id+"_header__column"+o,this.headCellInfoHash[x]){var R=this.headCellInfoHash[x].getAttribute("class");R&&(S+=" "+R)}if(g.className=S,g.setAttribute("id",this.id+"_"+x),this.options.autoScope&&g.setAttribute("scope","col"),this._checkUseFilter(g)){var D="width:100%;height:100%;",T="";this.options.filterShowAlways&&(D+="table-layout:fixed;",T="overflow:hidden;");var L=document.createElement("table");L.style.cssText=D;var k=document.createElement("tr"),F=document.createElement("td");F.style.cssText="width:100%;"+T;for(var A=g.childNodes.length,E=0;g.childNodes.length>0&&E<A;E++)F.appendChild(g.childNodes[0]);k.appendChild(F);var M=document.createElement("td"),O=WebSquare.language.getMessage("Grid_filter_button");if(M.innerHTML="<input type='button' id='"+this.id+"_"+x+"_filter' class='w2trigger w2grid_customFilter_open' aria-expanded='false' onclick='"+this.id+'.showCustomFilter("'+x+"\");' title='"+O+"'/>",k.appendChild(M),L.appendChild(k),g.appendChild(L),this.options.filterShowAlways){var N=document.getElementById(this.id+"_"+x+"_filter");N&&N.parentNode&&(N.parentNode.style.width=N.offsetWidth+2+"px")}}this._checkSortable(g)&&(g.className+=" w2grid_head_sortable"),this.headerObj[x]=b,g.disabled=!1;var H=g.getAttribute(c);H&&WebSquare.getBody().setToolTip(g,H)}}this.clearHeaderSort()}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.associateHeaderBody=function(){try{for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=0,i=-1,o="",r=a.Z.getDataPrefix("colIndex"),n=a.Z.getDataPrefix("header_id"),l=a.Z.getDataPrefix("col_id"),h=0;h<t.length;h++){var d=t[h];if(d.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||d.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0);else{var p=d.getAttribute(r);parseInt(p)<=i&&e++,i=parseInt(p);var u=e;u+1>this.tempTr.rows.length&&(u=this.tempTr.rows.length-1);for(var c=null;u>=0;){for(var g=this.tempTr.rows[u],f=a.Z.first(g);f;){if(p==f.getAttribute(r)){c=f;break}f=a.Z.next(f)}if(c)break;u--}if(c){var m=d.getAttribute(n),y=c.getAttribute(l);o=y,
this.headerToBodyRelation[m]=y,this.bodyToHeaderRelation[y]=m}else{m=d.getAttribute(n);this.passiveColSpanRelation[m]=o}}}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderConfigValue=function(t,e,i){try{var o=a.Z.getDataPrefix("col_id"),r=t.getAttribute(o),n=t&&(t.getAttribute(i)||t.getAttribute(i.toLowerCase())),l=this.headerConfigOptions[r]&&this.headerConfigOptions[r][i];return n||l||""}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setCheckboxHead=function(t,e){try{var i=a.Z.getDataPrefix("col_id"),o=a.Z.getDataPrefix("onChangeFunction"),n=a.Z.getDataPrefix("onchangeFunction"),l=a.Z.getDataPrefix("localeRef"),h=a.Z.getDataPrefix("checkboxLabel"),p=a.Z.getDataPrefix("colId"),u=t.getAttribute(i),c=t.getAttribute(o)||t.getAttribute(n),g="<INPUT type='checkbox' />",f=this.getHeaderConfigValue(t,e,h);if(this.options.useLocale){var m=t.getAttribute(l);if(m){var y=this.getLocaleValue(m);y&&(f=y)}}if(f){var b=this.uuid+"_header__"+u+"_checkboxLabel_",v=b+"_id",w=" for='"+v+"'";!1===this.options.useHeaderCheckboxLabelFor&&(w=""),g="left"===this.getHeaderConfigValue(t,e,"checkboxLabelPosition")?"<label class='w2checkbox_label'"+w+">"+f+"</label><INPUT type='checkbox' name='"+b+"' id='"+v+"'/>":"<INPUT type='checkbox' name='"+b+"' id='"+v+"'/><label class='w2checkbox_label'"+w+">"+f+"</label>",t.getAttribute(h)||t.setAttribute(h,f)}t.innerHTML=g;var C=t.getElementsByTagName("input")[0];C.setAttribute(p,e),("true"==t.getAttribute("disabled")||a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<9&&"true"==this.headCellInfoHash[u].getAttribute("disabled"))&&C.setAttribute("disabled","disabled");var I=t.getAttribute("title");I&&C.setAttribute("title",I);var _=this;d.f.addListener(C,"onkeydown",(function(t){d.f.fireEvent(_,"onkeydown",t),"32"==(t.charCode?t.charCode:t.keyCode)&&d.f.stopPropagation(t)})),d.f.addListener(C,"ondblclick",(function(t){d.f.stopPropagation(t)})),d.f.addListener(C,"onfocus",(function(t){var e=_.headerToBodyRelation[u];_.getCellInfo(e).options.keepFocusOnCheckHeaderClick||(_.removeFocusedCell(),1==_.options.senseReader&&_.rowIndex>0&&_.addGridScroll(0-_.rowIndex))}));var x=this.uuid;return null!=c&&""!=c?d.f.addListener(C,"onclick",(function(t){if(!WebSquare.idCache[x].options.checkHeaderOnly){_.noevent=!0;var i=a.Z.getGlobalFunction(c,_.scope_id);if("function"==typeof i)try{i.call(this,this.checked,e)}catch(t){s.Y.printStackTrace(t,null,this)}(_.options.preventMultipleClick||_.options.senseReader)&&d.f.fireEvent(_,"onheaderclick",u)}})):d.f.addListener(C,"onclick",(function(t){if(!WebSquare.idCache[x].options.checkHeaderOnly){_.noevent=!0;var e,i,o,r,a,n,l,h=_.headerToBodyRelation[u],p=_.getCellInfo(h),c=p,g=p.options.trueValue,f=p.options.falseValue,m=!(!_.isDrillDown||!_._dataList.options.depthColumn),y=!("checkbox"!==p.options.inputType||!_.options.ref);if(!0===y){var b=_._dataList._getXPath({colID:h,skipValueNode:!0});y=(e=WebSquare.ModelUtil.findInstanceNodes(b,null,_.scope_id)).length>=_.getTotalRow()}if("checkbox"===p.options.inputType||"custom"===p.options.inputType||"radio"===p.options.inputType){if(_.editedCell)try{a=_.editedCell.editRowIndex,n=_.getColumnIndex(_.editedCell.id);var v=_._dataList.getColumnIndex(_.editedCell.id);r=_._grid.getRealRowIndex(a)*_._dataList.getColumnCount()+v,o=_._dataList.dataArr[r]}catch(t){s.Y.printStackTrace(t,null,this)}if(this.checked){for(var w=_.getUnCheckedIndex(h),C=0;C<w.length;C++)if("custom"==p.options.inputType&&0==p.internal&&(c=p.cellManagerHashByRowIndex[w[C]])&&(g=c.options.trueValue,f=c.options.falseValue),c.options.checkAlways||!_.___getEditReadOnly(w[C],h,m)&&!_._getEditDisabled(w[C],h,m)){var I=w[C];m?_._dataList._setCellData(I,h,g,!0,!0,null,null,y):_.dataList.setCellData(I,h,g,!0,!0,null,null,y),i=g;var S=I;m&&(S=_._dataList.getFilteredRowIndex(S)),null!=S&&_._dataList.broadcast({gridView:["notifyCellChanged",[S,h,null,!0]]}),c.options.checkHeaderOnViewchange&&d.f.fireEvent(_,"onviewchange",{oldValue:f,newValue:g,rowIndex:I,
colIndex:_.getColumnIndex(h),colId:_.getColumnID(_.getColumnIndex(h))})}}else{var R=_.getCheckedIndex(h);for(C=0;C<R.length;C++)if("custom"==p.options.inputType&&0==p.internal&&(c=p.cellManagerHashByRowIndex[R[C]])&&(g=c.options.trueValue,f=c.options.falseValue),c.options.checkAlways||!_.___getEditReadOnly(R[C],h,m)&&!_._getEditDisabled(R[C],h,m)){I=R[C];m?_._dataList._setCellData(I,h,f,!0,!0,null,null,y):_.dataList.setCellData(I,h,f,!0,!0,null,null,y),i=f;S=I;m&&(S=_._dataList.getFilteredRowIndex(S)),null!=S&&_._dataList.broadcast({gridView:["notifyCellChanged",[S,h,null,!0]]}),c.options.checkHeaderOnViewchange&&d.f.fireEvent(_,"onviewchange",{oldValue:f,newValue:g,rowIndex:I,colIndex:_.getColumnIndex(h),colId:_.getColumnID(_.getColumnIndex(h))})}}if(_.checkHeader(u),!0===y)for(C=0;C<e.length;C++){var D=e[C];(c.options.checkAlways||!_.___getEditReadOnly(C,h,m)&&!_._getEditDisabled(C,h,m))&&(_._dataList.valueNode?D.setAttribute(_._dataList.valueNode,i):WebSquare.xml.setTextNodeValue(D,i))}_._dataList.broadcast({linkedDataList:["notifyRowChanged"],fusionChart:["refresh"],fwFunnelChart:["refresh"],fwSparkChart:["refresh"],fwPyramidChart:["refresh"],fwGanttChart:["refresh"],generalComp:"both"})}else if(_.options.titleAuto){var T=!0===this.checked?WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose");this.setAttribute("title",T)}if(_.options.senseReader&&_.rowIndex<=0&&(_.senseReaderMode=!0,_._setGridBorderNoRefresh=!0),_.options.senseReader&&_.rowIndex<=0&&(_.senseReaderMode=!1,_._setGridBorderNoRefresh=!1),_.drawFooter(),_.drawHeader(),(_.options.preventMultipleClick||_.options.senseReader)&&d.f.fireEvent(_,"onheaderclick",u),null!=r)try{var L=_._dataList.dataArr[r];l=_.getColumnID(n),o!=L&&d.f.fireEvent(_,"onviewchange",{oldValue:o,newValue:L,rowIndex:a,colIndex:n,colId:l})}catch(t){s.Y.printStackTrace(t,null,this)}}})),C}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.checkHeader=function(t){try{if(this.headerObj){var e=this.headerObj[t],i=this.headerToBodyRelation[t],o=this.headerInfoHash[t];if(e&&o&&o.options&&"checkbox"==o.options.inputType){var r=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=this.getCellInfo(i),l=r?this.getTotalRow():this.getRowCount();if("checkbox"!==n.options.inputType&&"custom"!==n.options.inputType&&"radio"!==n.options.inputType){if(this.options.titleAuto){var h=!0===e.checked?WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose");e.setAttribute("title",h)}return}if(this.hasCustomInputType&&0==n.internal&&"custom"==n.options.inputType){for(var d=l,p=0;p<d;p++){var u=r?p:this.dataList.getRealRowIndex(p),c=n.cellManagerHashByRowIndex[u]?n.cellManagerHashByRowIndex[u]:n;"checkbox"!=c.options.inputType&&"radio"!=c.options.inputType&&l--}if(0===l)return}var g="exclude"===this.options.checkAllType?this.getCheckedIndex(i,!0):this.getCheckedIndex(i),f=g.length;if(0==l)e.checked=!1,e.indeterminate=!1;else if(l==f)e.checked=!0,e.indeterminate=!1;else if(f>0){var m=!1;if(n.options.checkAlways)n.options.usePartialCheck&&"uncheck"===n.options.partialCheckNextClick&&(m=!0);else{for(p=0;p<g.length;p++)if(!this.___getEditReadOnly(g[p],i,r)&&!this._getEditDisabled(g[p],i,r)){(n.options.usePartialCheck||a.Z.isIEAllVersion())&&(m=!0);break}n.options.usePartialCheck&&"check"===n.options.partialCheckNextClick&&m&&(m=!1)}a.Z.isIEAllVersion()?e.checked=!m:e.checked=m,n.options.usePartialCheck&&(e.indeterminate=!0)}else l-f==l&&(e.checked=!1,e.indeterminate=!1);if(this.options.titleAuto)h=e.checked?n.options.usePartialCheck&&e.indeterminate?WebSquare.language.getMessage("Grid_title_partial"):WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose"),e.setAttribute("title",h)}}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setSelectboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n]
;if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:select",i.A&&(i.A.style="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff");else{this.tmpSelectbox||(this.tmpSelectbox=new WebSquare.uiplugin.selectbox("___tmp_selectbox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",r.I._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var p in i=WebSquare.xml.parse('<w2:select xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:select>",!0).documentElement,this.tmpSelectbox.options){var u=t.getAttribute(p);null!=u&&""!=u&&("style"==p&&(u="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(p,u))}a.Z.isIE(8)&&"true"==this.headCellInfoHash[n].getAttribute("disabled")&&i.setAttribute("disabled","true")}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_selectbox_"+t.getAttribute("id"),{pluginType:"uiplugin.selectbox",pluginName:"selectbox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=a.Z.getDataPrefix("onChangeFunction"),f=a.Z.getDataPrefix("onchangeFunction"),m=t.getAttribute(g)||t.getAttribute(f);return c.changeFuncName=m,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=a.Z.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){s.Y.printStackTrace(t,null,this)}})),c.addEvent("onclick",(function(t){o.noevent=!0})),this.addControl(c),c}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setInputHead=function(t,e){try{t.innerHTML="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";var i=a.Z.first(t),o=this,r=a.Z.getDataPrefix("onChangeFunction"),n=a.Z.getDataPrefix("onchangeFunction"),l=a.Z.getDataPrefix("changeFuncName"),h=a.Z.getDataPrefix("colId"),p=a.Z.getDataPrefix("col_id"),u=t.getAttribute(r)||t.getAttribute(n);i.setAttribute(l,u),i.setAttribute(h,e),i.scope_id=this.scope_id,i.headerId=t.getAttribute(p);var c=WebSquare.idCache[this.uuid];return d.f.addListener(i,"onfocus",(function(){o.noevent=!0,o.headerFocus=!0})),d.f.addListener(i,"onblur",(function(t){o.headerFocus=!1;var e=a.Z.getGlobalFunction(this.getAttribute(l),this.scope_id);if("function"==typeof e)try{e.call(this,this.value,this.getAttribute(h),this.headerId)}catch(t){s.Y.printStackTrace(t,null,this)}})),d.f.addListener(i,"onclick",(function(t){o.noevent=!0})),d.f.addListener(i,"onkeyup",(function(t){13==t.keyCode&&this.blur()})),d.f.addListener(i,"onpaste",(function(t){c.options.preventPaste?d.f.preventDefault(t):13==t.keyCode&&this.blur()})),i}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setCheckcomboboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:checkcombobox",i.A={style:"width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"};else{this.tmpCheckcombobox||(this.tmpCheckcombobox=new WebSquare.uiplugin.checkcombobox("___tmp_checkcombobox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",r.I._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var p in i=WebSquare.xml.parse('<w2:checkcombobox xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:checkcombobox>",!0).documentElement,this.tmpCheckcombobox.options){var u=t.getAttribute(p);null!=u&&""!=u&&("style"==p&&(u="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(p,u))}}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_checkcombobox_"+t.getAttribute("id"),{pluginType:"uiplugin.checkcombobox",pluginName:"checkcombobox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),
c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=a.Z.getDataPrefix("onChangeFunction"),f=a.Z.getDataPrefix("onchangeFunction"),m=t.getAttribute(g)||t.getAttribute(f);return c.changeFuncName=m,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=a.Z.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){s.Y.printStackTrace(t,null,this)}})),c.addEvent("onclick",(function(t){o.noevent=!0})),c}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setTextImageHead=function(t,e){try{var i,o=t.getAttribute("id"),r=this.headCellInfoHash[o];"json"===r._elementType&&(i=r.cloneNode(!0)._element.A);var n=i.viewType?i.viewType:"default",l=i.imageSrc?i.imageSrc:"",h=null!=i.value?i.value:"",p=i.imageStyle?'style="'+i.imageStyle+'"':"",u=i.imageAlign?i.imageAlign:"right";if(t.innerHTML="","icon"==n){t.innerHTML=["<div class='headerTextImageAlign'>"].join("");var c=t.querySelector(".headerTextImageAlign");"left"===u?c.innerHTML=["<img src='"+l+"' "+p+"/>",this.dataTagOpen+h+this.dataTagClose].join(""):"right"===u&&(c.innerHTML=[this.dataTagOpen+h+this.dataTagClose,"<img src='"+l+"' "+p+"/>"].join(""));var g=this,f=t.getElementsByTagName("img")[0];function v(t){d.f.stopPropagation(t),g._getHeaderDisabled(o)||d.f.fireEvent(g,"onheadertextimageclick",o,h)}d.f.addListener(f,"onclick",v)}else"default"==n&&(t.innerHTML=this.dataTagOpen+h+this.dataTagClose);var m=a.Z.first(t),y=a.Z.getDataPrefix("colId"),b=a.Z.getDataPrefix("col_id");return m.setAttribute(y,e),m.scope_id=this.scope_id,m.headerId=t.getAttribute(b),m}catch(w){s.Y.printStackTrace(w,null,this)}},C.prototype.getHeaderDIV=function(t){return this.getHeaderLayer(t)},C.prototype.getHeaderLayer=function(t){try{for(var e=WebSquare.util.getDataPrefix("header_id"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),r=0;r<i.length;r++){var a=i[r],n=a.getAttribute(e);if("number"==typeof t)t=o[t+this.defaultColCnt].getAttribute(e);if(null!=n&&null!=t&&t.toLowerCase()==n.toLowerCase())return a}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderInfo=function(t){try{return this.headerInfoHash[t]||{options:{}}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getTotalHeaderCol=function(t){try{for(var e=0,i=this.htmlInfo.head.headerTdHtml,o=0,r=i.length;o<r;o++)e+=i[o].length;return t&&t.defaultColumn&&(e+=this.defaultColCnt),e}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderColumnVisible=function(t){var e=this.getHeaderInfo(t),i=this._getRealColIndex("head",t),o=i+this.defaultColCnt,s=!this.hiddenList[o];if(e&&(0===i||i)){for(var r=0;r<e.options.colSpan;r++)s=!this.hiddenList[o+r]||s;return s}p.v.printLog("[getHeaderColumnVisible] Invalid headerId provided.")},C.prototype.setHeaderValue=function(t,e,i){var o=this.getHeaderLayer(t);if(o)if("function"==typeof e)e(o);else{var r=this.headerObj[t],n=e;i&&(e=this.getFormattedHeaderValue(t,e));var l=a.Z.getDataPrefix("value");if(r)if("select"==r.headInputType||"checkcombobox"==r.headInputType)r.setValue(e);else if("checkbox"==r.headInputType)r.checked!=a.Z.getBoolean(e)&&(r.click(),r.checked=a.Z.getBoolean(e));else if("input"==r.headInputType){if(r.value!=e){r.value=e;var h=a.Z.getGlobalFunction(r.getAttribute("changeFuncName"),this.scope_id);if("function"==typeof h)try{h.call(r,r.value,r.getAttribute("colId"))}catch(t){s.Y.printStackTrace(t,null,this)}}}else"user"==r.headerInputType&&r.setValue(e);else{this.headerDataObj&&t&&(this.headerDataObj[t].value=n);var d=o.getElementsByTagName(this.options.dataTag)[0];d?("NOBR"==d.tagName||"SPAN"==d.tagName&&d.className.indexOf("w2grid_span")>-1)&&(d.innerHTML=e):o.innerHTML=this.dataTagOpen+e+this.dataTagClose}o.setAttribute(l,e)
;for(var p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],u=WebSquare.Elem.api.getElementsByTagName(p,"w2:column"),c=0;c<u.length;c++){var g=u[c];if(t==g.getAttribute("id")){g.setAttribute("value",e);break}}}},C.prototype.setHeaderNodeSet=function(t,e,i,o){if(this.getHeaderLayer(t)){var s=this.headerObj[t];s&&("select"!=s.headInputType&&"checkcombobox"!=s.headInputType||s.setNodeSet(e,i,o))}},C.prototype.setHeaderUserObject=function(t,e){this.headerObj[t]=e,e.headerInputType="user";var i=this.getHeaderLayer(t);i.innerHTML="",i.appendChild(e.getContent())},C.prototype._getHeaderValue=function(t){var e="";if(t&&(e=this.getHeaderLayer(t)),e){var i=this.headerObj[t];if(i){var o="";if("select"==i.headInputType||"checkcombobox"==i.headInputType)o=i.getValue();else if("checkbox"==i.headInputType){o=!i.indeterminate&&i.checked;var s=this.headerToBodyRelation[t];if(this.options.returnTrueFalseValue&&s){var r=this.getCellInfo(s),n=r.options.trueValue,l=r.options.falseValue;o&&n?o=n:l&&(o=l)}}else"input"==i.headInputType?o=i.value:"user"==i.headerInputType&&(o=i.getValue());return o}var h=a.Z.first(e),d=h.getElementsByTagName(this.options.dataTag.toUpperCase())[0];if(d)h=d;else for(d=h;d&&"NOBR"!=d.tagName&&!("SPAN"==d.tagName&&d.className.indexOf("w2grid_span")>-1);){if("TD"==d.tagName){h=a.Z.first(d);break}d=a.Z.first(d)}return h?h.innerHTML:""}},C.prototype.getHeaderValue2=function(t){return this._getHeaderValue(t)},C.prototype.getHeaderValue=function(t){var e="";if(t&&(e=this.getHeaderLayer(t)),e){var i=a.Z.getDataPrefix("inputtype");if(!this.options.titleAuto||"text"!=e.getAttribute(i))return this._getHeaderValue(t);var o=e.getElementsByTagName(this.options.dataTag.toUpperCase())[0];if(o&&("NOBR"==o.tagName||"SPAN"==o.tagName&&o.className.indexOf("w2grid_span")>-1))return null!=o.textContent?o.textContent:o.innerHTML||""}},C.prototype.getFormattedHeaderValue=function(t,e){var i=this.getHeaderLayer(t);if(i){var o=a.Z.getDataPrefix("header_id");return this.headerDataObj[i.getAttribute(o)]&&(e=this.headerDataObj[i.getAttribute(o)].formatter.format(e)),e}},C.prototype.getHeaderValueList=function(t){for(var e=[],i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=a.Z.getDataPrefix("header_id"),s=a.Z.getDataPrefix("inputtype"),r=0;r<i.length;r++)if(null==this.hiddenList[r]||1==t||1!=this.hiddenList[r]){var n=i[r],l=n.getAttribute(o);if(null!=l&&n)if(this.options.captionAuto||this.options.summaryOnlyAuto){if("text"!=n.getAttribute(s))continue;var h=n.getElementsByTagName(this.options.dataTag.toUpperCase())[0];(h&&"NOBR"==h.tagName||"SPAN"==h.tagName&&h.className.indexOf("w2grid_span")>-1)&&(null!=h.innerText&&""!=h.innerText&&"\n"!=h.innerText?e.push(h.innerText):null!=h.textContent&&""!=h.textContent?e.push(h.textContent):null!=h.innerHTML&&""!=h.innerHTML?e.push(h.innerHTML):e.push(""))}else{var d,p=this.headerObj[l];p&&("select"==p.headInputType||"checkcombobox"==p.headInputType?d=p.getValue():"checkbox"==p.headInputType?d=p.checked:"input"==p.headInputType?d=p.value:"user"==p.headerInputType&&(d=p.getValue()),e.push(d));for(var u=a.Z.first(n),c=u;c&&"NOBR"!=c.tagName&&!("SPAN"==c.tagName&&c.className.indexOf("w2grid_span")>-1);){if("TD"==c.tagName){u=a.Z.first(c);break}c=a.Z.first(c)}u?e.push(u.innerHTML):e.push("")}}return e},C.prototype.getHeaderSpan=function(t,e){for(var i=0;i<this.htmlInfo.head.rowArr.length;i++)for(var o=0;o<this.htmlInfo.head.rowArr[i].length;o++)if(this.htmlInfo.head.rowArr[i][o].id===t){if("row"===e)return this.htmlInfo.head.rowArr[i][o].rowSpan;if("col"===e)return this.htmlInfo.head.rowArr[i][o].colSpan}},C.prototype.getHeaderInputType=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].inputType},C.prototype.getSortableArr=function(){
for(var t=[],e=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),i=0;i<e.length;i++){var o=this._checkSortable(e[i]);t.push(o)}return t},C.prototype.getSortableStatus=function(){return this.headerSortStatusArr.slice(0)},C.prototype.setSortable=function(t,e,i){try{i=i||{};var o=this.getElementById(this.id+"_"+t);if(null==o)return void p.v.printLog("["+this.id+"] Unable to find headerId : "+t);if(!0!==e&&!1!==e)return;var r=a.Z.getDataPrefix("sortable");if(this._checkSortable(o)!==e&&(o.setAttribute(r,e),!0!==i.keepSortImage)){for(var n,l=0;l<this.headerSortStatusArr.length;l++){var h=this.headerToBodyRelation[t];if(h===this.headerSortStatusArr[l].colID){n=h;break}}n?!1===e?this.setHeaderSortImage(t,0,0):this.setHeaderSortImage(t,this.headerSortStatusArr[n].sortOrder,0):this.options.showSortableImage&&!0===e&&this.setHeaderSortImage(t,0,0)}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.clearHeaderSort=function(){this.headerSortStatusArr=[];for(var t=a.Z.getDataPrefix("sortable"),e=a.Z.getDataPrefix("header_id"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=this.htmlInfo.head.rowArr,s=0;s<i.length;s++){if("_headerRowNumber"!==(p=i[s].getAttribute(e))&&"_headerRowStatus"!==p&&("false"!==i[s].getAttribute(t)||!0===this.options.showSortableImage)){if(o.length>1&&"top"==this.options.sortedImagePosition)for(var r=this.headerToBodyRelation[p],n=this.getColumnIndex(r),l=o[0],h=0;h<l.length;h++)if(l[h]["@col"]==n){p=l[h].id;break}var d=this.headerObj[p];d&&"user"==d.headerInputType||this.setHeaderSortImage(p,0,0)}}for(s=0;s<i.length;s++){var p="";i[s].getElementsByClassName("w2grid_customFilter_open").length>0?(p=i[s].getAttribute(e),this._lastHeaderElementType="filter"):i[s].getElementsByClassName("w2grid_head_sort_div_main_btn").length>0&&(p=i[s].getAttribute(e),this._lastHeaderElementType="sort"),p&&(this._lastHeaderElementId=p)}},C.prototype.drawHeaderSortImages=function(){for(var t=this.htmlInfo.head.rowArr,e=0;e<this.headerSortStatusArr.length;e++){var i="";if(t.length>1&&"top"==this.options.sortedImagePosition){for(var o=this.headerSortStatusArr[e].colID,s=this.getColumnIndex(o),r=t[0],a=0;a<r.length;a++)if(r[a]["@col"]==s){i=r[a].id;break}}else if(!(i=this.bodyToHeaderRelation[this.headerSortStatusArr[e].colID])){var n=this.headerSortStatusArr[e].colID,l=this.getColumnIndex(n);for(l--;l>=0&&(n=this.getColumnID(l),!(i=this.bodyToHeaderRelation[n]));)l--}i&&this.setHeaderSortImage(i,this.headerSortStatusArr[e].sortOrder,e+1)}},C.prototype.setHeaderSortImage=function(t,e,i){var o=this.getElementById(this.id+"_"+t);if(null!=o){e=parseInt(e,10),i=parseInt(i,10);isNaN(i)||i<=0||this.headerSortStatusArr.length<2?i="":i+="",this._clearHeaderSortImage(o,"table"),this._clearHeaderSortImage(o,"div");var n="",l=this.options.showSortableImage;this.options.showSortableImage&&(l=!!(n=this._checkSortable(o)));var h=this._checkUseFilter(o),d=!1,u=!1;if(0===this.getDataLength()&&this.options.hideSortIconOnNoData&&(u=!0),0===this.getDataLength()&&this.options.hideFilterIconOnNoData&&(d=!0),h){var c=d?"none":"",g=o.getElementsByTagName("input");g&&g[0]&&(g[0].style.display=c)}if(!0!==this.options.showSortableImage){var f;if(0!==e){f=a.Z.first(o);var m=null,y=null,b=null;try{this._useCheckboxLabel(t)&&(y=document.createElement("div"),m=a.Z.next(f),y.appendChild(m))}catch(t){s.Y.printStackTrace(t,null,this)}"nobr"==f.nodeName.toLowerCase()||"span"==f.nodeName.toLowerCase()&&f.className.indexOf("w2grid_span")>-1?(f=o.innerHTML,o.innerHTML=""):f=o.removeChild(f),this.headerObjArr[t]=f;var v=1==e?"w2grid_head_sort_asc":"w2grid_head_sort_desc",w=0,C="w2grid_head_sort_table_main",I="w2grid_head_sort_td",_="<table "+(H=a.Z.getDataPrefix("sort"))+"='sort' class='"+C+"'><tr><td></td><td class='"+I+" "+v+"'>"+i+"</td></tr></table>";"left"===this.options.sortedIconPosition&&(w=1,_="<table "+H+"='sort' class='"+C+"'><tr><td class='"+I+" "+v+"'>"+i+"</td><td></td></tr></table>"),o.innerHTML=_
;var x=o.getElementsByTagName("td");"string"==typeof f?x[w].innerHTML=f:(x[w].appendChild(f),m&&y&&(x[w].appendChild(y.removeChild(m)),y=null))}}else{var S=this.headerObj[t];if(S)S.render&&(S=S.render);else{var R=o.getElementsByTagName(this.options.dataTag)[0];(R&&"NOBR"==R.tagName||"SPAN"==R.tagName&&R.className.indexOf("w2grid_span")>-1)&&(S=R)}m=null;var D=null;try{this._useCheckboxLabel(t)&&("left"===this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?(D="left",y=document.createElement("div"),m=a.Z.prev(S),y.appendChild(m)):(y=document.createElement("div"),m=a.Z.next(S),y.appendChild(m)))}catch(t){s.Y.printStackTrace(t,null,this)}try{h&&this.options.showSortableUseFilter&&(b=o.getElementsByTagName("input")[0])}catch(t){s.Y.printStackTrace(t,null,this)}S.parentNode.removeChild(S);v="";var T="";switch(e){case 0:!1!==l||n?(v="w2grid_head_sort_none",T=WebSquare.language.getMessage("Grid_sort_asc")):(v="w2grid_head_sort_image_none",T="");break;case 1:v="w2grid_head_sort_asc",T=WebSquare.language.getMessage("Grid_sort_desc");break;case-1:v="w2grid_head_sort_desc",T=WebSquare.language.getMessage("Grid_sort_none");break;default:v="w2grid_head_sort_none",T=WebSquare.language.getMessage("Grid_sort_asc")}if(this.options.sortHeaderDiv)if(!0===this.options.accessibility){v+="_btn";var L="_accessibility",k="w2grid_head_sort_div_main_btn";"left"===this.options.sortedIconPosition&&(v+="_left"),k+=L,v+=L;var F,A=u?"style = 'display:none'":"";H=a.Z.getDataPrefix("sort");if(n?(o.innerHTML="<button "+H+"='sort' class='"+k+" "+v+"' "+A+"></button>",F=o.getElementsByTagName("button")[0]):(o.innerHTML="",F=o),F.appendChild(S),m&&y)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?F.appendChild(y.removeChild(m)):F.insertBefore(y.removeChild(m),S),y=null;else if(h&&this.options.showSortableUseFilter){var E=n?F:S;B=E.parentElement;(G=document.createElement("div")).appendChild(E),G.appendChild(b),this.addClass(G,"w2grid_head_sort_div_main_outer_box"),B.appendChild(G),this.addClass(b,"w2grid_customFilter_sortable_open"),a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<8?this.addClass(E,"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(E,"w2grid_head_sort_usefilter_div_main")}}else{v+="_btn";k="w2grid_head_sort_div_main_btn",A=u?"style = 'display:none'":"",H=a.Z.getDataPrefix("sort");o.innerHTML="<div "+H+"='sort' class='w2grid_head_sort_div_main_outer'><button class='"+k+" "+v+"'"+A+" >"+T+"</button></div>";x=o.getElementsByTagName("div");var M=o.getElementsByTagName("button")[0];if(x[0].insertBefore(S,M),m&&y)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?x[0].insertBefore(y.removeChild(m),M):x[0].insertBefore(y.removeChild(m),S),y=null;else if(h&&this.options.showSortableUseFilter){B=x[0].parentElement;(G=document.createElement("div")).appendChild(x[0]),G.appendChild(b),this.addClass(G,"w2grid_head_sort_div_main_outer_box"),B.appendChild(G),this.addClass(b,"w2grid_customFilter_sortable_open"),a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<8?this.addClass(x[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(x[1],"w2grid_head_sort_usefilter_div_main")}}else{var O="w2grid_head_sort_div_main",N="w2grid_head_sort_div_sub";"left"===this.options.sortedIconPosition&&(O="w2grid_head_sort_div_main_left"),!0===this.options.showSortableImage&&(N="left"===this.options.sortedIconPosition?"w2grid_head_sort_div_sub_sortable_image_left":"w2grid_head_sort_div_sub_sortable_image"),u&&(v="");var H=a.Z.getDataPrefix("sort");if(o.innerHTML="<div "+H+"='sort' class = '"+O+" "+v+"'><div class = '"+N+"'>"+i+"</div></div>",(x=o.getElementsByTagName("div"))[0].appendChild(S),m&&y)"left"===D?x[0].insertBefore(y.removeChild(m),S):x[0].appendChild(y.removeChild(m)),y=null;else if(h&&this.options.showSortableUseFilter){var G,B=x[0].parentElement;(G=document.createElement("div")).appendChild(x[0]),G.appendChild(b),
this.addClass(G,"w2grid_head_sort_div_main_outer_box"),B.appendChild(G),this.addClass(b,"w2grid_customFilter_sortable_open"),a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<8?this.addClass(x[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(x[1],"w2grid_head_sort_usefilter_div_main")}}}if(n){var W="none";switch(e){case 0:W="none";break;case 1:W="ascending";break;case-1:W="desending";break;default:W="none"}o.setAttribute("aria-sort",W)}}else p.v.printLog("["+this.id+"] Unable to find headerId : "+t)},C.prototype._clearHeaderSortImage=function(t,e){var i=t.getElementsByTagName(e),o=a.Z.getDataPrefix("sort"),r=a.Z.getDataPrefix("header_id");if(i.length>0&&"sort"==i[0].getAttribute(o)){var n=t.getAttribute(r),l=this.headerObjArr[n];if(l)if("string"==typeof l)t.innerHTML=l;else{var h=null,d=null;try{this._useCheckboxLabel(n)&&(d=document.createElement("div"),h=a.Z.next(l),d.appendChild(h))}catch(t){s.Y.printStackTrace(t,null,this)}l=t.appendChild(l),h&&d&&(t.appendChild(d.removeChild(h)),d=null),t.removeChild(l.previousSibling)}}},C.prototype.getColIdByHeaderId=function(t){return this.headerToBodyRelation[t]},C.prototype.setHeaderHide=function(t){if(t=a.Z.getBoolean(t),this.options.hideHeader!=t){this.options.hideHeader=t;var e=this.getElementById(this.id+"_head_table"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));if(t){e.style.display="none";for(var o=0;o<i.length;o++){var s=i[o].getAttribute("class");null!=s&&(i[o].setAttribute("data-bkclass",s),i[o].removeAttribute("class"))}}else{e.style.display="";for(o=0;o<i.length;o++){var r=i[o].getAttribute("data-bkclass");null!=r&&(i[o].setAttribute("class",r),i[o].removeAttribute("data-bkclass"))}}this.refresh(),this.setScrollYHeight()}},C.prototype.setHeaderDisabled=function(t,e){try{e=a.Z.getBoolean(e);var i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?(o.setDisabled?o.setDisabled(e):o.render?o.render.disabled=e:o.disabled=e,i.disabled=e):i.disabled=e}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype._getHeaderDisabled=function(t){try{var e=!1,i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?o.getDisabled?e=o.getDisabled():o.render?e=o.render.disabled:o.disabled&&(e=o.disabled):i.disabled&&(e=i.disabled)}return e}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderID=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,r=0;r<e.children.length;r++){var a=e.children[r].children;if((o+=a.length)>t){var n=a[i];return n?n.id.replace(this.id+"_",""):null}i-=a.length}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderIDArr=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,r=[],a=0;a<e.children.length;a++){var n=e.children[a].children;if((o+=n.length)>t){var l=n[i];l&&r.push(l.id.replace(this.id+"_",""))}else i-=n.length}return r}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderIndex=function(t){try{if("number"==typeof t)return t;var e=this.head_table;e||(e=this.getElementById(this.id+"_head_table"));for(var i=0,o=0;o<e.children.length;o++){for(var r=e.children[o].children,a=0;a<r.length;a++){if(r[a].id.replace(this.id+"_","")==t)return i+a-this.defaultColCnt}i+=r.length}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderRowIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return e},C.prototype.getHeaderColIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].colIndex},C.prototype.getHeaderColID=function(t,e){try{void 0!==e&&null!=e||(e={});for(var i="",o=this.struct.head.rowArr,r=!0===e.firstRow?1:o.length,a=0;a<r;a++){
for(var n=o[a],l=0;l<n.length;l++)if(n[l].colIndex===t){i=n[l].id;break}if(i)break}return i}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setHeaderStyle=function(t,e,i){try{var o,r=a.Z.getDataPrefix("header_id"),n=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(o=n[t+this.defaultColCnt]).getAttribute(r);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var l=0;l<n.length;l++)(o=n[l]).getAttribute(r)==t&&WebSquare.style.setStyle(o,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.setHeaderClass=function(t,e){try{var i,o=a.Z.getDataPrefix("header_id"),r=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(i=r[t+this.defaultColCnt]).getAttribute(o);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var n=0;n<r.length;n++)(i=r[n]).getAttribute(o)==t&&(this.addClass(i,e),this.headerCellClassObj[t]=e)}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.getHeaderClass=function(t){try{var e=a.Z.getDataPrefix("header_id"),i=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=i[t+this.defaultColCnt].getAttribute(e);"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var o=0;o<i.length;o++)if(i[o].getAttribute(e)==t)return this.headerCellClassObj[t]}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.removeHeaderClass=function(t,e){try{var i,o=a.Z.getDataPrefix("header_id"),r=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(i=r[t+this.defaultColCnt]).getAttribute(o);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var n=0;n<r.length;n++)(i=r[n]).getAttribute(o)==t&&(this.removeClass(i,e),delete this.headerCellClassObj[t])}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.drawHeader=function(t,e){try{if(!this.head_table)return;null==this.headerDataObj&&this.initHeaderDataObj();var i=this.head_table.getElementsByTagName("th");this.headerTempSum=[];var o=a.Z.getDataPrefix("header_id");if(t){t=this.getColumnID(t);for(var r=0;r<i.length;r++){if(d=(h=i[r]).getAttribute(o))if(p=this.headerDataObj[d])if("expression"==p.inputType){var n=p.expression.match(/headercol(sum|avg|max|min)\s*\([^\)]*/g);if(n)for(var l=0;l<n.length;l++)n[l].split("(")[1].wq_replaceAll("'","").wq_replaceAll('"',"").wq_trim()==t&&(p.value=new Function("_this","return "+p.expression)(this),isNaN(p.value)&&"NaN"!=p.NaNFormat&&(p.value=p.NaNFormat),h.innerHTML=this.dataTagOpen+p.formatter.format(p.value)+this.dataTagClose)}else""===p.displayFormat||"number"!=p.dataType||"text"!=p.inputType&&"textarea"!=p.inputType&&"button"!=p.inputType&&"textImage"!=p.inputType||(h.innerHTML=this.dataTagOpen+p.formatter.format(p.value)+this.dataTagClose)}}else for(r=0;r<i.length;r++){var h,d,p;if(d=(h=i[r]).getAttribute(o))if(p=this.headerDataObj[d])if("expression"==p.inputType){try{p.value=new Function("_this","return "+p.expression)(this),isNaN(p.value)&&"NaN"!=p.NaNFormat&&(p.value=p.NaNFormat)}catch(t){s.Y.printStackTrace(t,null,this)}h.innerHTML=this.dataTagOpen+p.formatter.format(p.value)+this.dataTagClose}else""===p.displayFormat||"number"!=p.dataType||"text"!=p.inputType&&"textarea"!=p.inputType&&"button"!=p.inputType&&"textImage"!=p.inputType||(h.innerHTML=this.dataTagOpen+p.formatter.format(p.value)+this.dataTagClose)}!e||!e.sortIcon||this.headerSortStatusArr&&0!==this.headerSortStatusArr.length||this.clearHeaderSort()}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.initHeaderDataObj=function(){try{var t=this.head_table.getElementsByTagName("th");this.headerDataObj={}
;for(var e=a.Z.getDataPrefix("header_id"),i=a.Z.getDataPrefix("expression"),o=a.Z.getDataPrefix("value"),n=a.Z.getDataPrefix("localeRef"),l=a.Z.getDataPrefix("inputType"),h=a.Z.getDataPrefix("dataType"),d=a.Z.getDataPrefix("displayFormat"),p=a.Z.getDataPrefix("displayFormatter"),u=a.Z.getDataPrefix("NaNFormat"),c=0;c<t.length;c++){var g=t[c],f={};f.id=g.getAttribute(e);var m=g.getAttribute(i)||"";if(""!=m&&(m=(m=(m=(m=m.replace(/[sS][uU][mM][\s]*[(]/g,"_this.headercolsum( ")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.headercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.headercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.headercolmin( ")),f.value=g.getAttribute(o)||"",this.options.useLocale){var y=g.getAttribute(n);if(y){var b=this.getLocaleValue(y);b&&(f.value=b)}}f.inputType=g.getAttribute(l),f.dataType=g.getAttribute(h)||"text",f.expression=m,f.displayFormat=g.getAttribute(d)||"",f.displayFormatter=g.getAttribute(p)||"",f.formatter=WebSquare.format.createFormatter(f.dataType,f.displayFormat,f.displayFormatter,null,null,null,this.scope_id,this.id),f.NaNFormat=g.getAttribute(u)||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||"NaN","$blank"==f.NaNFormat&&(f.NaNFormat=""),this.headerDataObj[f.id]=f}}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype.headercolsum=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].sum){var e="";if(this.groupbyStatus.grouped);else{var i=this.getColumnAllDataArray(t);e=a.Z.sum(i)}this.headerTempSum[t].sum=e}return a.Z.setPrecision(this.headerTempSum[t].sum)},C.prototype.headercolavg=function(t){var e=this.getColumnAllDataArray(t);this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={});var i="";if(this.groupbyStatus.grouped)return i;if(void 0===this.headerTempSum[t].sum){if(e.length>0){for(var o=0;o<e.length;o++)""==e[o].replace(/^\s+|\s+$/g,"")&&(e[o]="0");i=a.Z.sum(e)}this.headerTempSum[t].sum=i}return""==this.headerTempSum[t].sum?"":this.headerTempSum[t].sum/e.length},C.prototype.headercolmax=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e<s)&&(e=s)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.headerTempSum[t].max=e}return this.headerTempSum[t].max},C.prototype.headercolmin=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e>s)&&(e=s)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.headerTempSum[t].min=e}return this.headerTempSum[t].min},C.prototype._getMatchedHeaderId=function(t){try{return this.bodyToHeaderRelation[t]}catch(t){s.Y.printStackTrace(t,null,this)}};var I=function(t,e){try{this.options={id:"",value:"",inputType:"text",useFilter:!1,textAlign:""},this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),this.id=this.options.id}catch(t){s.Y.printStackTrace(t,null,this)}};C.prototype._setHeaderInfo=function(t,e){this.headerInfoHash2[t]=e},C.prototype.setCheckboxHeader=function(t){try{"function"==typeof this.cellInfoHash[t].checkHeader&&this.cellInfoHash[t].checkHeader()}catch(t){s.Y.printStackTrace(t,null,this)}},I.prototype.setOptions=function(t){this.options.useFilter=a.Z.getBoolean(r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/header/column/useFilter/@value")),this.options.hideCustomFilter=a.Z.getBoolean(r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/header/column/hideCustomFilter/@value"));var e=[]
;for(var i in this.options)e[i.toLowerCase()]=i;var o=this.mainGrid.headerConfigOptions[t.getAttribute("id")]||{};for(var i in o)this.options[i]=o[i];var s=WebSquare.Parser.parseAttribute(t);for(var n in s){var l=s[n];"class"==n?this.options.className=l:""!=String(l).wq_trim()&&(e[n]&&(n=e[n]),"boolean"==typeof this.options[n]?l=a.Z.getBoolean(l):"number"==typeof this.options[n]&&(l=a.Z.getNumber(l)),this.options[n]=l)}},C.prototype._useCheckboxLabel=function(t){try{var e=a.Z.getDataPrefix("inputType"),i=a.Z.getDataPrefix("checkboxLabel"),o=a.Z.getDataPrefix("checkboxlabel"),r=this.getHeaderLayer(t);return"checkbox"===r.getAttribute(e)&&(r.getAttribute(i)||r.getAttribute(o))}catch(t){s.Y.printStackTrace(t,null,this)}},C.prototype._checkUseFilter=function(t){try{if(!t)return!1;if("string"==typeof t&&!(t=this.getHeaderLayer(t)))return!1;var e=a.Z.getDataPrefix("useFilter"),i=t.getAttribute(e);if(i&&"string"==typeof i){var o=i.toLowerCase();if("true"===o)return!0;if("false"===o)return!1}var n=a.Z.getDataPrefix("header_id"),l=t.getAttribute(n);if(!l||"_headerRowNumber"===l||"_headerRowStatus"===l)return!1;var h=a.Z.getDataPrefix("inputType"),d=t.getAttribute(h),p="/WebSquare/"+this.options.pluginName+"/header/column[@inputType='"+d+"']/useFilter/@value",u=r.I.getConfiguration(p),c=(this.headerConfigOptions[l]||{}).useFilter;return a.Z.getBoolean(u)||a.Z.getBoolean(c)}catch(t){return s.Y.printStackTrace(t,null,this),!1}},C.prototype._checkSortable=function(t){try{if(!t)return!1;if("string"==typeof t&&!(t=this.getHeaderLayer(t)))return!1;var e=a.Z.getDataPrefix("sortable"),i=t.getAttribute(e);if(i&&"string"==typeof i){var o=i.toLowerCase();if("true"===o)return!0;if("false"===o)return!1}if(this.options.sortable)return!0;var r=a.Z.getDataPrefix("header_id"),n=t.getAttribute(r);if(!n||"_headerRowNumber"===n||"_headerRowStatus"===n)return!1;var l=(this.headerConfigOptions[n]||{}).sortable;return a.Z.getBoolean(l)}catch(t){return s.Y.printStackTrace(t,null,this),!1}};var _=function(){};_.prototype.getLastFocusedCell=function(){if(this.focusedCell.length>0)return this.focusedCell[this.focusedCell.length-1];var t={focusedRowIndex:-1,focusedColIndex:null};return this.options.groupbyDisplayRowIndex&&(t.groupbyDisplayRowIndex=-1),t},_.prototype.getFocusedRowIndex=function(){return this._getFocusedRowIndex(this.options.groupbyDisplayRowIndex)},_.prototype._getFocusedRowIndex=function(t){return this.getLastFocusedCell()[!0===t&&this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex"]},_.prototype.getFocusedRealRowIndex=function(){return this.getLastFocusedCell().focusedRealRowIndex},_.prototype.getAllFocusedIndex=function(){for(var t=this.focusedCell,e=[],i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<t.length;o++){var s={};s.col=t[o].focusedColIndex,s.row=t[o][i],e.push(s)}return e},_.prototype.getAllFocusedRowIndex=function(){for(var t=[],e={},i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<this.focusedCell.length;o++){e[this.focusedCell[o][i]]=!0}for(var s in e)t.push(parseInt(s,10));return t},_.prototype.getFocusedColumnIndex=function(){return this.getLastFocusedCell().focusedColIndex},_.prototype.getFocusedColumnID=function(){return this.getColumnID(this.getFocusedColumnIndex())},_.prototype.getFocusedRowStatus=function(){var t=this._getFocusedRowIndex(!0);return-1==t?null:this.dataList.getRowStatus(t)},_.prototype.setFocusedCell2=function(t,e,i,o){try{o=o||{};i=a.Z.getBoolean(i),e=this.getColumnIndex(e);var r=!1;try{r=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){r=!1}var n=this.getLastFocusedCell(),l=i&&n.focusedColIndex==e;if((this.___getEditReadOnly(t,e)||this._getEditDisabled(t,e))&&(l=!1),this.editedCell&&!this.editedCell.handleEndEdit(null,l))return!1;if(r||!0===this._isBrowserScroll()){if(!0===this._isHybridScroll()){
!0===this._drawDataHybrid(t)&&(o.hybridAsync=!0),y=t-(this.rowIndex>0?this.rowIndex:0)}}else{var h=this._getVisibleLastIndex(this.lastIndex+1),d=this.getDataLength(),p=this.rowIndex+this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex);!0===this.hiddenRowObj.init&&this.rowIndex===d-h&&(p=d-this._getVisibleLastIndex(1));var u=this.rowIndex,c=this.hiddenCellObj.length>0;if(c&&t===p&&(p=Math.max(p-1,0)),t<u||t>p){var g=t<u?t-u:t-p;if(t>p&&this.hasSubtotal){for(var f in this.rollbackCommitFlag=!1,this.subtotalTableList){if(p<d-1)this.dataList._getCellData(p,f)!=this.dataList._getCellData(p+1,f)&&g++}this.rollbackCommitFlag=!0}var m=this.rowIndex+g;m=(m=m<0?0:m)>d-h?d-h:m,c&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(m=Math.min(m,this.lastTopRowIndex)),m!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!0,m=Math.max(0,m),isNaN(this.lastTopRowIndex)||null==this.lastTopRowIndex||(m=Math.min(m,this.lastTopRowIndex)),this.drawData(m,0,"keymove",l),!0===this.hiddenRowObj.init||c||(this.lastIndex=this.getLastIndex(this.lastDisplayedRow)))}}var y=t-(this.rowIndex>0?this.rowIndex:0),b=this.data_td_list[e+y*this.oneRowDataLength];return!!b&&("rollback"==this.__setFocusedCell({ctrl:!1},b,{editMode:i,dont_hide:l,dont_fixScroll:!0,tabDirection:o.tabDirection})&&this._setFocusedCell(n.focusedRowIndex,n.focusedColIndex,!0,{tabDirection:o.tabDirection}),!0)}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.setFocusedCell=function(t,e,i,o){try{(o=o||{}).groupbyDisplayRowIndex=this.options.groupbyDisplayRowIndex;var r=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),a=t;if(r&&(a=this.getDisplayRowIndex(t)),!isNaN(a)){if(!0===o.keepFocusedCell)for(var n=this.getColumnIndex(e),l=0;l<this.focusedCell.length;l++)if(this.focusedCell[l].focusedRowIndex===t&&this.focusedCell[l].focusedColIndex===n)return;return this._setFocusedCell(a,e,i,o)}}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype._setFocusedCell=function(t,e,i,o){try{if(o=o||{},"none"==this.options.focusMode)return;if(!0===o.groupbyDisplayRowIndex&&(t=this._getGroupbyGroupedRowIndex(t,!0)),0==arguments.length||1==arguments.length){i=0!=arguments.length&&arguments[0];var r=this.colIndexInfo.body.colInfo.colIndexMatch;if(this.focusedCell.length>0)t=this.focusedCell[this.focusedCell.length-1].focusedRowIndex,e=this.focusedCell[this.focusedCell.length-1].focusedColIndex;else if(this.lastFocusedCell&&null!=this.lastFocusedCell.focusedColIndex&&this.lastFocusedCell.focusedRowIndex>=0)t=this.lastFocusedCell.focusedRowIndex,e=this.lastFocusedCell.focusedColIndex;else{var n=this.getLastFocusedCell();t=n.focusedRowIndex;if(null==(e=n.focusedColIndex)||-1==t)return this.focusedCell=[{focusedRowIndex:0,focusedColIndex:r.length-this.defaultColCnt-1}],this.moveHorizontal(null,"home"),void(i&&this._setFocusedCell(!0))}}var l=this.getDataLength(),h=this.getDataLength()-this._getVisibleLastIndex(1);if(e=this.getColumnIndex(e),t<0||t>h||e<0||e>=this.oneRowDataLength)return;var d=!1;try{d=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){d=!1}if(i=a.Z.getBoolean(i),this.delayedDraw({rowIndex:t}))return this.focusedCell=[{focusedRowIndex:t,focusedColIndex:e}],this._linkedDataList?this._linkedDataList.setRowPosition(t):this._dataList.setRowPosition(t),void this._dataList.setColumnPosition(this.getColumnID(e));var p=this.getElementById(this.id+"_scrollY_div");!0!==this._isBrowserScroll()&&p&&0==p.scrollTop&&this.rowIndex>0&&(p.scrollTop=this.lastScrollYTop);var u=t-(this.rowIndex>0?this.rowIndex:0);if(d||!0===this._isBrowserScroll()){if(!0===this._isHybridScroll()){!0===this._drawDataHybrid(t)&&(o.hybridAsync=!0),u=t-(this.rowIndex>0?this.rowIndex:0)}}else if(u<0)this.scrollEvent=!1,p.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0),
u=0;else if(this.options.showLastRow&&u-this.lastIndex==1&&""===this.options.visibleRowNum);else if(u>this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex)){var c=this._getVisibleLastIndex(this.lastIndex+1);this.hiddenCellObj.length>0&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(c=l-this.lastTopRowIndex);var g=t+c>l?l-c:t;this.hiddenCellObj.length>0&&(g=Math.max(0,g)),g!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!o.isSort||"string"!=typeof this.options.filterFocusMode||"followfocus"!==this.options.filterFocusMode.toLowerCase(),p.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(g),g>this.rowIndex+c-1&&(this.adjustDraw_keepTop=!0),this.drawData(g,0),u=t-this.rowIndex)}var f=this.data_td_list[e+u*this.oneRowDataLength];if(f){for(var m=5;!0!==this._isBrowserScroll()&&this.hiddenCellObj.length>0&&0===f.offsetHeight&&m>0;){this.lastTopRowIndex++;var y=this.getElementById(this.id+"_size_y"),b=(p=this.getElementById(this.id+"_scrollY_div"),y.offsetHeight);b<1e6&&(b=parseInt(y.style.height,10)),y.style.height=p.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",this.drawData(this.lastTopRowIndex,0),u--,f=this.data_td_list[e+u*this.oneRowDataLength],m--}return o.editMode=i,this.__setFocusedCell({ctrl:!1},f,o)}}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.removeFocusedCell=function(){try{this.lastFocusedCell=this.getLastFocusedCell(),this.applyFocusedCellOut(),this.focusedCell=[],this._dataList.setRowPosition(null)}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.applyFocusedCell=function(t,e){if(e||(this.applyFocusedCellOut(),this.focusedCell=[]),null!=t){this.applyFocusedCellIn(t);var i={};i.focusedTd=t,this.focusedCell.push(i)}},_.prototype.__setFocusedCell=function(t,e,i){try{i=i||{};var r=t.ctrlKey||i.ctrled,n=t.shiftKey||i.shifted,l=e.className,h="";if(this.options.focusDefaultColumn){if(l.indexOf("_groupby")>=0||l.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1}else if(l.indexOf("_rowNum")>=0||l.indexOf("_rowStatus")>=0||l.indexOf("_groupby")>=0||l.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1;var p=a.Z.getDataPrefix("tdIndex"),u=a.Z.getDataPrefix("colIndex"),c=parseInt(e.getAttribute(p)),g=parseInt(c/this.realRowDataLength),f=parseInt(e.getAttribute(u)),m=g+this.rowIndex,y=this._getGroupbyDisplayRowIndex(m),b=m;this.isDrillDown&&this._dataList.options.depthColumn&&(b=this.getRealRowIndex(m));var v=c%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),w=this.getColumnID(v),C=!0,I=this.getLastFocusedCell();this.focusedCell.length>0&&I.focusedTd==e&&(C=!1);var _,x={focuseChanged:C};if(o.q.extend(x,i),C&&this.editedCell&&!this.editedCell.handleEndEdit(t,!!i.dont_hide,x))return!1;_=this._linkedDataList?this._linkedDataList.setRowPosition(y):this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex?this._dataList.setRowPosition(y):this._dataList.setRowPosition(b);var S=this._dataList.setColumnPosition(w);if(!1===_||!1===S)return this.options.senseReader&&I&&I.focusedTd&&I.focusedTd.focus(),!1;var R=this._getFocusedRowIndex(),D=this.getFocusedColumnIndex(),T=!(a.Z.getBoolean(this.options.useCtrlKey)&&r||a.Z.getBoolean(this.options.useShiftKey)&&n||i.keepFocusedCell),L=!1;if(T&&a.Z.getBoolean(i.allowContextMenuMultiCell)&&(T=!1,L=!0,this.focusedCell)){for(var k=!1,F=0;F<this.focusedCell.length;F++)if(this.focusedCell[F].focusedTd==e){k=!0;break}k||(T=!0,L=!1)}if(T&&(this.applyFocusedCellOut(),this.focusedCell=[]),i.tabDirection||(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),this.focusedCell.length>0&&a.Z.getBoolean(this.options.useShiftKey)&&n){var A,E=(A=!0===this.options.ctrlShiftKey?this.focusedCell[this.focusedCell.length-1]:this.focusedCell[0]).focusedRowIndex,M=A.focusedColIndex,O=!1
;if((this.options.focusDefaultColumn&&A.focusedColIndex<0&&v<0&&this.hasClass(e,"gridBodyDefault_rowNumber")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowStatus")||this.hasClass(A.focusedTd,"gridBodyDefault_rowNumber")&&this.hasClass(e,"gridBodyDefault_rowStatus")||this.hasClass(e,"gridBodyDefault_rowNumber")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowNumber")||this.hasClass(e,"gridBodyDefault_rowStatus")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowStatus"))&&(O=!0),O)return this.applyFocusedCellOut(),this.focusedCell=[],void this.__setFocusedCell(t,e);h="multiCell",this._applyFocusedMultiCell(E,M,m,v,i.ignoreFocusMode),i.dont_fixScroll||(f>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}else if(!L){var N;if(this.getCellInfo(e).options.blockSelect)return;var H={focusedTd:e,focusedRealRowIndex:b,focusedRowIndex:N=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>m-this.rowIndex||this.options.lastFixedRow>0&&m-this.rowIndex>this.lastIndex-this.options.lastFixedRow?m-this.rowIndex:m,focusedColIndex:v};this.options.groupbyDisplayRowIndex&&(H.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(N)),this.focusedCell.push(H),i.dont_fixScroll||(f>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds();var G=!0!==this._isBrowserScroll()&&!!i.editMode;if(this.applyFocusedCellIn(e,G,{tabDirection:i.tabDirection,ignoreFocusMode:i.ignoreFocusMode,customRowIndex:m}),"linear"===this.options.focusFlow&&!0===i.editMode&&(this.focusedByApi=!1),I=this.getLastFocusedCell(),i.ignoreFocusMode||"cell"==this.options.focusMode){for(F=this.focusedCell.length-2;F>=0;F--)if(this.focusedCell[F].focusedTd==I.focusedTd){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1);break}}else if("both"==this.options.focusMode){for(F=this.focusedCell.length-2;F>=0;F--)if(this.focusedCell[F].focusedTd==I.focusedTd){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1),this.changeFocusedCellPosition(this.rowIndex);break}}else if("row"==this.options.focusMode){var B=a.Z.getDataPrefix("trIndex"),W=I.focusedTd?I.focusedTd.parentNode:null;for(F=this.focusedCell.length-2;F>=0;F--){var V=this.focusedCell[F];if(null!=V.focusedTd){var q=V.focusedTd.parentNode;for(g=parseInt(q.getAttribute(B));g>0;)g--,q=a.Z.prev(q);do{if(q==W){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1),this.changeFocusedCellPosition(this.rowIndex,!0);break}if(!(q=a.Z.next(q)))break}while("0"!=q.getAttribute(B))}}}}var Y=this.getCellInfo(v);if("custom"==Y.options.inputType&&(Y=Y.cellManagerHashByRowIndex[m]),(R=this._getGroupbyDisplayRowIndex(R))==(m=this._getGroupbyDisplayRowIndex(m))&&D==v||d.f.fireEvent(this,"oncellindexchange",m,v,R,D),R!=m&&d.f.fireEvent(this,"onrowindexchange",m,R),D!=v&&d.f.fireEvent(this,"oncolumnindexchange",v,D),!0===this._isHybridScroll()&&!0!==i.hybridAsync){var Z=document.getElementById(this.id+"_main_div"),j=document.getElementById(this.id+"_scrollY_div"),P=Math.round(j.scrollTop),z=this.getFooterHeight(),U=document.getElementById(this.id+"_head_table").offsetHeight,X=Z.offsetHeight,K=e.offsetHeight,J=X-U-z,$=P-this._hybridScrollYPos-e.offsetTop;a.Z.isIEAllVersion()&&($+=U);var Q=K-$-J;if($>0){var tt=P-$;j.scrollTop=tt}else if(Q>0){tt=P+Q;j.scrollTop=tt}}if(i.editMode){var et=this.uuid,it=e.id;if(!0===this._isNativeScroll()){var ot=e.parentNode,st=this.id+"_dataLayer",rt=document.getElementById(st),at=(U=this.head_table.offsetHeight,ot.offsetHeight*this.oneRowLength);tt=ot.offsetTop-rt.offsetHeight+at+2;a.Z.requestAnimationFrame((function(){var t,e=document.getElementById(st);e.scrollTop<tt?e.scrollTop=tt:e.scrollTop>(t=tt+e.offsetHeight-U-at)&&(e.scrollTop=Math.max(t,0)),a.Z.requestAnimationFrame((function(){
var t=WebSquare.idCache[et],e=document.getElementById(it);t.setEditMode(e)}))}))}else!0===this._isHybridScroll()?a.Z.requestAnimationFrame((function(){var t=WebSquare.idCache[et],e=document.getElementById(it);t.setEditMode(e)})):this.setEditMode(e)}return h}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.applyFocusedCellOut=function(){if(this.focusedCell.length>0)for(var t=0;t<this.focusedCell.length;t++){var e=this.focusedCell[t];this._applyFocusedCellOut(e)}},_.prototype._applyFocusedCellOut=function(t){if("row"==this.options.focusMode||"both"==this.options.focusMode){if(null==(o=t.focusedTd)&&this.options.showLastRow){var e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&this.removeFocusRowStyle(o)}if("cell"==this.options.focusMode||"both"==this.options.focusMode){var o;if(null==(o=t.focusedTd)&&this.options.showLastRow){e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&("linear"!=this.options.focusFlow&&o.setAttribute("tabIndex",-1),this.removeClass(o,"focusedTd"),(!this.options.focusDefaultColumn||t.focusedColIndex>=0)&&(this.options.fixedRow>0&&t.focusedRowIndex-this.rowIndex>=0&&this.options.fixedRow>t.focusedRowIndex-this.rowIndex||this.options.lastFixedRow>0&&t.focusedRowIndex-this.rowIndex>this.lastIndex-this.options.lastFixedRow?this.applyCellStyleOptions(t.focusedRowIndex-this.rowIndex,t.focusedColIndex,!0):this.applyCellStyleOptions(t.focusedRowIndex,t.focusedColIndex,!0)),this.options.rowMouseOver&&this.addRowOverStyle(this.overElem))}},_.prototype.removeFocusRowStyle=function(t){try{if(null==t)return;for(var e=a.Z.getDataPrefix("trIndex"),i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("style_bak"),r=t.parentNode,n=parseInt(r.getAttribute(e));n>0;)n--,r=a.Z.prev(r);var l=a.Z.first(r),h=parseInt(l.getAttribute(i));n=parseInt(h/this.realRowDataLength);for(var d=0;d<this.realRowDataLength;d++){var p=d;d>=this.defaultColCnt&&(p=Math.floor((d-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(d-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var u=n*this.realRowDataLength+p,c=this.all_data_td_list[u];if(this.removeClass(c,"focusedTr"),d<this.defaultColCnt){var g=c.className;g.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""!=this.options.rowNumBackgroundColor&&!0!==this.options.rowNumRowMouseOverColor||(c.style.backgroundColor="",c.removeAttribute(o)):g.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(c.style.backgroundColor="",c.removeAttribute(o))}else{var f=parseInt(c.getAttribute(i)),m=n+this.rowIndex,y=f%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(m,y,!0)}}}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.applyFocusedCellIn=function(t,e,i){if("none"!=this.options.focusMode){var o=(i=i||{}).tabDirection,r=i.ignoreFocusMode,n=i.linkNoFocus,l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("tdIndex"),d=this.getCellInfo(t.getAttribute(l)),p=d.options.inputType||"text",u=!1;if("custom"==d.options.inputType&&"undefined"!==i.customRowIndex&&(p=(d=d.cellManagerHashByRowIndex[i.customRowIndex]?d.cellManagerHashByRowIndex[i.customRowIndex]:d).options.inputType||"text"),this.options.useTextMultiLink&&this.options.senseReader&&"user"===p&&d.options.customFormatter&&(u=!0),this.focusedByApi=!0,d.options.embeddedInput&&!1===u){var c=this.getElemRowIndex(t);if(e)if("text"!=p&&"link"!=p||!this._getEditDisabled(c,d.id)&&!this.__getEditReadOnly(t,c))this.getInput(d,t).focus();else t.focus();else if(o)if(this._getEditDisabled(c,d.id)||this.__getEditReadOnly(t,c))t.focus();else this.getInput(d,t).focus();else this.__getEditReadOnly(t,c)&&!0!==this.options.readOnlyTabIgnore&&(t.setAttribute("tabIndex",0),t.focus())}else{var g=!1;try{var f=this.focusedCell[this.focusedCell.length-1].focusedRealRowIndex-this.rowIndex
;(this.rowIndex>0&&this.options.fixedRow>0&&f>=0&&this.options.fixedRow>f||this.options.lastFixedRow>0&&f-this.rowIndex>this.lastIndex-this.options.lastFixedRow)&&(g=!0)}catch(t){s.Y.printStackTrace(t,null,this)}if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum||this.___getEditReadOnly(f,t.getAttribute(l))&&!0===this.options.readOnlyTabIgnore||t.setAttribute("tabIndex",0),"custom"==p&&this.options.senseReader){c=this.getElemRowIndex(t);var m=d.cellManagerHashByRowIndex[c];p=m?m.options.inputType:"text"}if(e&&("text"==p||"secret"==p||"textarea"==p||"textImage"==p||"calendar"==p)||g);else if("button"==p&&this.options.senseReader){var y=t.getElementsByTagName("button");(y=y[0]).focus()}else if("link"==p&&this.options.senseReader){w=(w=t.getElementsByTagName("a"))[0],this.hasClass(document.activeElement,"w2grid_scrollY")?o&&w.focus():w.focus()}else if("checkbox"==p&&this.options.senseReader){t.getElementsByTagName("input")[0].focus()}else if("user"==p&&this.options.senseReader){var b;if(0==(w=t.getElementsByTagName("a")).length&&(w=t.getElementsByTagName("input")),-1!=this.focusedCellLinkIndex)if("right"==o){for(var v=0;v<w.length;v++)document.activeElement==w[v]&&(this.focusedCellLinkIndex=v);b=this.focusedCellLinkIndex+1}else b=this.focusedCellLinkIndex-1;else{if("right"==o)b=0;else if(null==o){if(b=0,document.activeElement)for(v=0;v<w.length;v++)document.activeElement==w[v]&&(b=v)}else b=w.length-1;this.focusedCellLinkLength=w.length}w=w[b],this.focusedCellLinkIndex=b,w?o&&w.focus():this._getEditDisabled(c,d.id)||this.__getEditReadOnly(t,c)?t.blur():t.focus()}else if("select"!=p||1!=this.options.senseReader||"ul"!=d.options.tableRender||this.isVirtualCursor())a.Z.isIE(8)?"none"!=t.parentElement.style.display&&t.focus():n||t.focus();else{var w;(w=(w=t.getElementsByTagName("a"))[0]).focus()}}var C=!1;try{C=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){C=!1}if(!0===this._isHybridScroll())this._setHybridDataLayerTop();else if(!C&&!e&&!0!==this._isNativeScroll("both")){var I=this.getElementById(this.id+"_dataLayer");I.scrollLeft=0,I.scrollTop=0}var _=this.options.focusMode;if(r&&(_="cell"),"row"!=_&&"both"!=_||this.setFocusRowStyle(t),"cell"==_||"both"==_){this.addClass(t,"focusedTd");var x=parseInt(t.getAttribute(h)),S=parseInt(x/this.realRowDataLength),R=S+this.rowIndex;(this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>S||this.options.lastFixedRow>0&&S>this.lastIndex-this.options.lastFixedRow)&&(R=S);var D=x%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.options.focusDefaultColumn&&D<0)return;this.applyCellStyleOptions(R,D,null,r)}}},_.prototype.setFocusRowStyle=function(t){try{if(null==t)return;for(var e=a.Z.getDataPrefix("trIndex"),i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("style_bak"),r=t.parentNode,n=parseInt(r.getAttribute(e));n>0;)n--,r=a.Z.prev(r);var l=a.Z.first(r),h=parseInt(l.getAttribute(i));n=parseInt(h/this.realRowDataLength);for(var d=0;d<this.realRowDataLength;d++){var p=d;d>=this.defaultColCnt&&(p=Math.floor((d-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(d-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var u=n*this.realRowDataLength+p,c=this.all_data_td_list[u];if(this.addClass(c,"focusedTr"),d<this.defaultColCnt){var g=c.className;g.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""!=this.options.rowNumBackgroundColor&&!0!==this.options.rowNumRowMouseOverColor||(c.style.backgroundColor=this.options.selectedRowColor.wq_trim(),c.removeAttribute(o)):g.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(c.style.backgroundColor=this.options.selectedRowColor.wq_trim(),c.removeAttribute(o))}else{var f=parseInt(c.getAttribute(i)),m=n+this.rowIndex,y=f%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(m,y)}}}catch(t){
s.Y.printStackTrace(t,null,this)}},_.prototype.outFocusedCell=function(){this.removeFocusedCell()},_.prototype.getFocusedCellData=function(){var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex(),i=this.getColumnID(e);return t>-1?this.dataList._getCellData(t,i):null},_.prototype.getFocusedRowData=function(){var t=this._getFocusedRowIndex();return t>-1?this.dataList.getRowData(t):null},_.prototype.getFocusedRowXML=function(){var t=this._getFocusedRowIndex(!0);return t>-1?this.dataList.getRowXML(t):null},_.prototype.removeRowFocus=function(t){for(var e=[],i=0;i<this.focusedCell.length;i++)t!=this.focusedCell[i].focusedRowIndex?e.push(this.focusedCell[i]):this._applyFocusedCellOut(this.focusedCell[i]);this.focusedCell=e},_.prototype.setFocusedHeaderObj=function(t){if(this.getHeaderLayer(t)){var e=this.headerObj[t];if(e)switch(e.headInputType){case"checkcombobox":case"select":case"checkbox":case"input":e.focus()}}},_.prototype.focus=function(t){try{if(this.options.senseReader&&this.options.useStartEndDiv){var e=this.getElementById(this.id+"_gridstart_div"),i=this.getElementById(this.id+"_gridend_div");t&&"object"==typeof t&&(t.shiftKey?i.focus():e.focus())}else{var o=this.getLastFocusedCell(),r=-1!=o.focusedRowIndex?o.focusedRowIndex:0,a=null!=o.focusedColIndex?o.focusedColIndex:0;this._setFocusedCell(r,a,!1)}}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.setFocusedMultiCell=function(t,e,i,o,r){try{r=r||{};var a=this.options.useShiftKey;this.options.useShiftKey=!0;var n=Number(t),l=Number(e),h=Number(i),d=Number(o);isNaN(n)||isNaN(l)||this._setFocusedCell(n,l,null,{ignoreFocusMode:r.ignoreFocusMode}),isNaN(h)||isNaN(d)||this._setFocusedCell(h,d,!1,{shifted:!0,ignoreFocusMode:r.ignoreFocusMode}),this.options.useShiftKey=a}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.removeFocusedMultiCell=function(t,e,i,o){try{for(var r="focusedColIndex",a="focusedRowIndex",n=this.focusedCell.length-1;n>=0;n--){var l=this.focusedCell[n];l[a]>=t&&l[a]<=i&&l[r]>=e&&l[r]<=o&&(this._applyFocusedCellOut(l),this.focusedCell.splice(n,1))}}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype._applyFocusedMultiCell=function(t,e,i,o,r){try{!0!==this.options.ctrlShiftKey&&(this.applyFocusedCellOut(),this.focusedCell=[]);var a=this.getLocationRowCol(t,e);t=a.rowIndex,e=a.colIndex;var n=t,l=e;"row"===this.options.focusMode&&!0!==r&&(o=this.getColumnCount()-1);var h=this.getLocationRowCol(i,o);i=h.rowIndex,o=h.colIndex;for(var d=i,p=o,u=t>i,c=e>o,g=this.htmlInfo.body.rowAttrArr.length,f=u?i:t,m=u?t:i,y=c?o:e,b=c?e:o,v=!0;v;){v=!1;var w=m,C=0;for(var I in this.cellMergeInfo)this.cellMergeInfo.hasOwnProperty(I)&&C++;m-f>g&&C<1&&(w=f+g);for(var _=y,x=f;x<=w;x++){var S=this.getOriginalRowCol(x,y);S.colSize>1&&_>(S=this.getLocationRowCol(S.rowIndex,S.colIndex)).colIndex&&(_=S.colIndex,v=!0),y=_}var R=b;for(x=f;x<=w;x++){var D=this.getOriginalRowCol(x,b);D.colSize>1&&R<(D=this.getLocationRowCol(D.rowIndex,D.colIndex)).colIndex+D.colSize-1&&(R=D.colIndex+D.colSize-1,v=!0),b=R}for(var T=f,L=y;L<=b;L++){var k=this.getOriginalRowCol(f,L);k.rowSize>1&&T>(k=this.getLocationRowCol(k.rowIndex,k.colIndex)).rowIndex&&(T=k.rowIndex,v=!0),f=T}var F=m;for(L=y;L<=b;L++){var A=this.getOriginalRowCol(m,L);A.rowSize>1&&F<(A=this.getLocationRowCol(A.rowIndex,A.colIndex)).rowIndex+A.rowSize-1&&(F=A.rowIndex+A.rowSize-1,v=!0),m=F}}i=u?f:m,e=c?b:y,o=c?y:b;for(x=t=u?m:f;u?x>=i:x<=i;u?x--:x++)for(L=e;c?L>=o:L<=o;c?L--:L++){var E=this.getOriginalRowCol(x,L),M=E.colIndex,O=E.rowIndex;if(!E.noLeftTop){var N=this.data_td_list[M+(O-this.rowIndex)*this.oneRowDataLength];if(O<this.rowIndex&&(N=null),!(this.groupbyStatus.grouped&&N&&this.hasClass(N,"w2grid_groupby"))){var H=this.getCellInfo(M),G=this._getRealColIndex("body",H.options.col_id)+this.defaultColCnt;if(!H.options.blockSelect&&!this.hiddenList[G]){var B={focusedTd:N,focusedRowIndex:O,focusedColIndex:M};if(this.options.groupbyDisplayRowIndex&&(B.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(O)),
x==n&&L==l?this.focusedCell.unshift(B):this.focusedCell.push(B),null!=N){var W=!0;(H.options.embeddedInput||L==p&&x==d)&&(W=!1),this.applyFocusedCellIn(N,W,{ignoreFocusMode:r})}(""==H.options.inputType||"text"==H.options.inputType&&!H.options.embeddedInput||"textImage"==H.options.inputType||"calendar"==H.options.inputType)&&(this.getInput(H).options.editType=H.options.editType?H.options.editType:this.options.editType)}}}}}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype._addFocus=function(t){try{var e=a.Z.getDataPrefix("tdIndex"),i=parseInt(t.getAttribute(e)),o=parseInt(i/this.realRowDataLength)+this.rowIndex,r=o;this.isDrillDown&&this._dataList.options.depthColumn&&(r=this.getRealRowIndex(o));var n,l=i%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),h={focusedTd:t,focusedRealRowIndex:r,focusedRowIndex:n=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>o-this.rowIndex||this.options.lastFixedRow>0&&o-this.rowIndex>this.lastIndex-this.options.lastFixedRow?o-this.rowIndex:o,focusedColIndex:l};this.options.groupbyDisplayRowIndex&&(h.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(n)),this.focusedCell.push(h)}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.focusToStart=function(){try{var t=document.getElementById(this.id+"_head_table").getElementsByTagName("button")[0];if(t)return this.removeFocusedCell(),void t.focus();for(var e=0,i=0,o=!1,r=this.getDataLength(),a=this.getColumnCount();e<r;){for(;i<a;){var n=this.getCellInfo(i);if(!this.___getEditReadOnly(e,i)&&!this._getEditDisabled(e,i)&&"radio"!==n.options.inputType){o=!0;break}i++}if(o)break;e++}this._setFocusedCell(e,i,this.options.keyMoveEditMode,{tabDirection:"left"})}catch(t){s.Y.printStackTrace(t,null,this)}},_.prototype.focusToEnd=function(){try{for(var t=this.getDataLength()-1,e=this.getColumnCount()-1,i=!1;t>=0;){for(;e>=0;){var o=this.getCellInfo(e);if(!this.___getEditReadOnly(t,e)&&!this._getEditDisabled(t,e)&&"radio"!==o.options.inputType){i=!0;break}e--}if(i)break;t--}if(t<0){var r=document.getElementById(this.id+"_head_table").getElementsByTagName("button");r.length>0&&r[r.length-1].focus()}else this._setFocusedCell(t,e,this.options.keyMoveEditMode,{tabDirection:"right"})}catch(t){s.Y.printStackTrace(t,null,this)}};var x=function(t){};x.prototype._subtotalHidden=function(t){try{for(var e=0;e<t.length;e++){if(this.isIE6or7)for(var i=t[e].getElementsByTagName("td"),o=0;o<i.length;o++)i[o].style.borderWidth="0px";"none"!==t[e].style.display&&(this.drawedSubtotal&&this.drawedSubtotal.drawedRowLength--,t[e].style.display="none")}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalHidden=function(t){try{if(!this.hasSubtotal)return;if(t){if("number"==typeof t.index)for(var e=this.drawedSubtotal.splice(t.index,1),i=0;i<e.length;i++)this._subtotalHidden(e[i]);if("number"==typeof t.rowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex==t.rowIndex){e=this.drawedSubtotal.splice(i,1);for(var o=0;o<e.length;o++)this._subtotalHidden(e[o])}if("number"==typeof t.startRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex>=t.startRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o]);if("number"==typeof t.endRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex<=t.endRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o])}else{for(var r in this.subtotalTableList){var a=this.subtotalRowHash[r];a&&this._subtotalHidden(a)}this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.refreshSubtotalRow=function(t){try{for(var e=t-this.rowIndex,i=!0===this._isBrowserScroll()?this.getRowCount()-1:this.lastIndex,o=e;o<=i;o++)this.drawSubtotalRow(o+1,o+this.rowIndex);var n=WebSquare.BootLoader.fullViewed||!1,l=a.Z.fullViewed||!1;if(!n&&!l){
var h=this.options.adaptive,d=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==h&&!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)&&a.Z._getBrowserWidth()<=d){for(o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!0);this.removeAdaptiveGridSubtotalHeight(),this.setAdaptiveGridSubtotalHeight();for(o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.drawSubtotalRow=function(t,e,i){try{var o=0;if(!this.hasSubtotal||e<0||e>=this.getDataLength())return o;var r=NaN;if(i&&!isNaN(i.maxCount)&&(r=i.maxCount),r<=0)return o;for(var a in this.subtotalTableList){var n=this.dataList._getCellData(e,a),l=n+"_12";if(e<this.getDataLength()-1)l=this.dataList._getCellData(e+1,a);if(n!=l){var h=this.subtotalRowHash[a],d=this.subtotalTableList[a],p=d.rows.length,u=[];u.rowIndex=e,u.targetID=a;for(var c=0;c<p;c++){var g=h?h[t*p+c]:void 0;if(g){if(this.isIE6or7)for(var f=g.getElementsByTagName("td"),m=0;m<f.length;m++)f[m].style.borderWidth="";o>=r?g.style.display="none":(g.style.display="",o++),g.setAttribute("data-subtotalrowindex",e),u.push(g),this.lastSubtotalRow=g}}if(this.drawedSubtotal.push(u),this.drawedSubtotal.drawedRowLength+=o,this.setSubtotalData(d,a,n,e,u,i),o>=r)break}}return o}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.hasUpperSubtotalRow=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return!1;for(var e in this.subtotalTableList){var i=this.dataList._getCellData(t,e),o=i;if(t<this.getDataLength())o=this.dataList._getCellData(t-1,e);if(i!=o)return!0}return!1}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.getHasSubtotalCount=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return 0;var e=0;for(var i in this.subtotalTableList){var o=this.dataList._getCellData(t,i),r=o;t+1<this.getDataLength()?r=this.dataList._getCellData(t+1,i):t+1==this.getDataLength()&&e++,o!=r&&e++}return e}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.setSubtotalData=function(t,e,i,o,r,n){try{var l,h=this.subtotalDataArr[e+"_"+i];if(null==h&&(h=this.getSubtotalData(t,e,i,o)),this.options.subtotalStyleFormatter)try{"function"==typeof this.options.subtotalStyleFormatter?l=this.options.subtotalStyleFormatter:null!=(l=a.Z.getGlobalFunction(this.options.subtotalStyleFormatter,this.scope_id))&&(this.options.subtotalStyleFormatter=l)}catch(t){l=null}for(var d=a.Z.getDataPrefix("inputType"),p=a.Z.getDataPrefix("NaNFormat"),u=a.Z.getDataPrefix("colMerge"),c=a.Z.getDataPrefix("value"),g=a.Z.getDataPrefix("useLocale"),f=a.Z.getDataPrefix("localeRef"),m=0;m<r.length;m++)for(var y=r[m].getElementsByTagName("td"),b=0;b<y.length;b++){var v=y[b],w=v.getAttribute("id"),C=this.subtotalConfigOptions[w]||{};if(null!=h[w]){var I=h[w];if("expression"==v.getAttribute(d)&&isNaN(I)){var _=v.getAttribute(p)||C.NaNFormat;null!=_&&"NaN"!=_&&(I=_)}if(v.innerHTML=this.dataTagOpen+I+this.dataTagClose,"function"==typeof l){var x=h[w+"_org"];null==x&&(x=I);var S=l(x,I,v.id);if(v&&S){var R=v.getAttribute("data-bkclassname");null==R&&(R=v.className,v.setAttribute("data-bkclassname",R)),v.className=v.getAttribute("data-bkclassname")+" "+S}}}else if("true"!=v.getAttribute(u)||this.groupbyStatus.grouped){var D=v.getAttribute(c),T=v.getAttribute(g),L=v.getAttribute(d);if("true"===T||this.options.useLocale&&!T||"false"!==T&&C.useLocale){var k=v.getAttribute(f)||C.localeRef;if(k&&"expression"!==L){var F=this.getLocaleValue(k);F&&(D=F)}}D=null!=D?D:"",v.innerHTML=this.dataTagOpen+D+this.dataTagClose}else v.style.borderTopWidth="0px",v.style.borderBottomWidth="0px"}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.getSubtotalData=function(t,e,i,o){try{
var r=e,n=this.subtotalObj[e];if(null==n){n={};for(var l=a.Z.getDataPrefix("inputType"),h=a.Z.getDataPrefix("expression"),d=a.Z.getDataPrefix("colindex"),p=a.Z.getDataPrefix("dataType"),u=a.Z.getDataPrefix("displayFormat"),c=a.Z.getDataPrefix("displayFormatter"),g=0;g<t.rows.length;g++)for(var f=t.rows[g].getElementsByTagName("td"),m=0;m<f.length;m++){var y=f[m],b=this.subtotalConfigOptions[y.id]||{};if("expression"==y.getAttribute(l)){(F={}).id=y.getAttribute("id");var v,w=y.getAttribute(h)||"";if(!w&&b.expression&&(w=b.expression),""!=w){var C="";this.options.groupbyStatus||(w.toLowerCase().indexOf("sumifs")>-1?C="sumifs":w.toLowerCase().indexOf("sumif")>-1&&(C="sumif")),v=C?w.substring(w.indexOf("(")+1,w.indexOf(",")):w.substring(w.indexOf("(")+1,w.indexOf(")")),w=w.replace(/[sS][uU][mM][\s]*[(]/g,"this.subtotalcolsum( obfuscator_st, obfuscator_en ,"),this.options.groupbyStatus||(w=(w=w.replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"this.subtotalcolsumif( obfuscator_st, obfuscator_en ,")).replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"this.subtotalcolsumifs( obfuscator_st, obfuscator_en ,")),w=(w=(w=(w=(w=(w=(w=w.replace(/[aA][vV][gG][\s]*[(]/g,"this.subtotalcolavg( obfuscator_st, obfuscator_en ,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.subtotalcolmax( obfuscator_st, obfuscator_en ,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.subtotalcolmin( obfuscator_st, obfuscator_en ,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"this.subtotalcolcnt( obfuscator_st, obfuscator_en ,")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][vV][aA][lL][uU][eE][\s]*[(]/g,"this.dataList._getCellData( obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][lL][aA][bB][eE][lL][\s]*[(]/g,"this.subtotaltargetcollabel( obfuscator_st, obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][fF][oO][oO][tT][eE][rR][vV][aA][lL][uU][eE][\s]*[(]/g,"this.subtotaltargetfootervalue( obfuscator_st, obfuscator_en,")}var I="text",_=parseInt(y.getAttribute(d))-this.defaultColCnt;if(_>=0&&(I=this._dataList.getCellInfo(_).options.dataType),"true"===this.options.useCurrency?F.dataType=y.getAttribute(p):F.dataType=y.getAttribute(p)||I,!F.dataType&&b.dataType&&(F.dataType=b.dataType),F.expression=w,!F.dataType){var x=this.getCellInfo(v),S=x&&x.options&&x.options.dataType;v&&"true"===this.options.useCurrency?(F.dataType=S,"function"==typeof x.options.customModelUnformatter?F.customModelUnformatter=x.options.customModelUnformatter:F.customModelUnformatter=a.Z.getGlobalFunction(x.options.customModelUnformatter,this.scope_id)):F.dataType=I}F.displayFormat=y.getAttribute(u)||b.displayFormat||"",F.displayFormatter=y.getAttribute(c)||b.displayFormatter||"","true"!==this.options.useCurrency||F.displayFormatter||(F.displayFormat=x.options.displayFormat||y.getAttribute(u)||"",F.displayFormatter=x.options.displayFormatter||""),F.formatter=WebSquare.format.createFormatter(F.dataType,F.displayFormat,F.displayFormatter,null,null,null,this.scope_id,this.id),n[F.id]=F}}this.subtotalObj[e]=n}for(var R=o;R>0&&i==this.dataList._getCellData(R-1,e);)R--;var D=R,T=o,L={};for(var k in n){var F=n[k],A=a.Z.scopingFuncBody(F.expression,this.scope_id);this._subtotalDisplayFormat=F.displayFormat||"";var E=Function("obfuscator_st","obfuscator_en","obfuscator_targetID",A).call(this,D,T,r);F.customModelUnformatter&&(E=F.customModelUnformatter.call(this,E));var M=F.formatter.format(E);L[k]=M,this.options.subtotalStyleFormatter&&E!==M&&(L[k+"_org"]=E)}return this._subtotalDisplayFormat="",L}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.getSubtotalRowList=function(t){try{var e=[];t&&"object"===t.returnType&&(e={});var i=this.getDataLength();for(var o in this.subtotalStrList)for(var r=1;r<i;r++){this.dataList._getCellData(r-1,o)!=this.dataList._getCellData(r,o)&&(t&&"object"===t.returnType?e[r]=!0:e.push(r))}return e}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolsumif=function(t,e,i,o,r){try{var a=[],n=[],l=[];if(o){var h=this._getOperator(o)
;if(!h.operator||!h.value)return;return n.push(h.operator),l.push(h.value),a?a.push(r):a.push(i),this._subtotalcolsum(t,e,i,a,n,l)}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolsumifs=function(t,e,i){try{for(var o=[],r=[],a=[],n=(arguments.length-3)/2,l=0;l<n;l++){var h=this._getOperator(arguments[2*l+3]),d=arguments[2*l+4];h.operator&&h.value&&(r.push(h.operator),a.push(h.value)),o.push(d)}return this._subtotalcolsum(t,e,i,o,r,a)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolsum=function(t,e,i){try{try{return this._subtotalcolsum(t,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}}catch(t){WebSquare.exception.printStackTrace(t,null,this)}},x.prototype._subtotalcolsum=function(t,e,i,o,r,n){try{var l={};!this.options.groupbyStatus&&o&&(l={conditionColumn:o,targetOperator:r,conditionValue:n,blank:!1});var h,d=this.getColumnSubtotalRangeDataArray(t,e,i,l),p="";if(d.length>0)if(h=this.getColumnOption(i,"dataType"),p=0,"bigDecimal"===h)for(var u=0;u<d.length;u++)p=WebSquare.bigDecimal(p+"").plus(d[u]);else if("time"===h)for(u=0;u<d.length;u++){var c=WebSquare.text.fillZero(p,4);p=WebSquare.date.dateTimeAdd(c,d[u],"hour","time")}else p=a.Z.sum(d,{displayFormat:this._subtotalDisplayFormat});return a.Z.setPrecision(p)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolavg=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),r="",a=this.getColumnOption(i,"dataType");if(o.length>0)if("bigDecimal"===a){for(var n in r="0",o)r=WebSquare.bigDecimal(r).plus(o[n]);r=r.divide(WebSquare.bigDecimal(o.length))}else r=WebSquare.util.sum(o,{displayFormat:this._subtotalDisplayFormat})/o.length;return r}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolmax=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),r=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===r)for(var l in o)n=null==n?o[l]:n.compare(o[l]);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n<h)&&(n=h)}return n=null==n?"":n,a.Z.setPrecision(n)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolmin=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),r=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===r)for(var l in o)n=null==n?o[l]:n.compare(o[l],!0);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n>h)&&(n=h)}return n=null==n?"":n,a.Z.setPrecision(n)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotalcolcnt=function(t,e,i,o){try{o=o||{};return(this.getColumnSubtotalRangeDataArray(t,e,i,o)||[]).length}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.subtotaltargetcollabel=function(t,e,i,o){var r="";try{r=this.dataList._getCellData(e,i);var a=this.getCellInfo(i),n=a.options.inputType;"select"!==n&&"autoComplete"!==n&&"checkcombobox"!==n||(r=a.getData(r,e))}catch(t){s.Y.printStackTrace(t,null,this)}return r},x.prototype.subtotaltargetfootervalue=function(t,e,i,o){var r;try{this.hasFooter&&this.footerTempSum&&this.footerTempSum[i]&&(r=this.footerTempSum[i].sum)}catch(t){s.Y.printStackTrace(t,null,this)}return r},x.prototype.getColumnSubtotalRangeDataArray=function(t,e,i,o){try{for(var r,a=[],n=this.getColumnID(i),l=this.getColumnOption(n,"dataType"),h=this.dataList.getDeletedIndex(),d=this.dataList.getModifiedIndex(),p=t;p<=e;p++){if(this.options.excludeDeletedRows){for(var u=!1,c=0;c<h.length;c++)if(h[c]===p){u=!0;break}if(u)continue}if(this.options.excludeModifiedRows){for(u=!1,c=0;c<d.length;c++)if(d[c]===p){u=!0;break}if(u)continue}if("object"==typeof o&&o.conditionColumn&&o.conditionColumn.length>0){var g=!0;for(c=0;c<o.conditionColumn.length;c++){var f=this.dataList.getCellData(p,o.conditionColumn[c]),m=o.targetOperator[c],y=o.conditionValue[c],b=this.getColumnOption(o.conditionColumn[c],"dataType");if(0==(g=this._isMatched(y,f,m,b)))break}if(0==g)continue}
"bigDecimal"===l?r=WebSquare.bigDecimal(this.dataList._getCellData(p,i)):(r=this.dataList._getCellData(p,i),r+=""),void 0===r||""==r?(r="0","object"==typeof o&&!1!==o.blank&&a.push(r)):a.push(r)}return a}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._getLastSubtotalCount=function(){try{if(!this.hasSubtotal)return 0;for(var t=0,e=this.getDataLength(),i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength),0),o=0,r=e-1;r>=i;r--){for(var a=0;a<this.struct.subtotalArr.length;a++){var n=this.struct.subtotalArr[a],l=n.attr.targetColumnID,h=this.dataList._getCellData(r,l),d=h+"_12";if(r<e-1)d=this.dataList._getCellData(r+1,l);if(h!=d&&(t+=n.rowArr.length,this.options.initFixedHeightByRowNum>-1)){if(o+t>=this.options.initFixedHeightByRowNum){i=r+1;break}i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength-t),0)}}o++}return t}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.setSubtotalVisible=function(t){try{if(0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({subTotalVisible:t});!0!==t||this.hasSubtotal?!1===t&&this.hasSubtotal&&(this.subtotalHidden(),this.lastTopRowIndex=null,this.hasSubtotal=!1,this.setScrollYHeight()):(this.hasSubtotal=!0,this.lastTopRowIndex=null,this._applyRowVisible({subtotalDraw:!0}),this.setScrollYHeight())}catch(t){s.Y.printStackTrace(t,null,this)}};var S=function(t){};S.prototype.initializeFooter=function(){try{if(!this.hasFooter)return;for(var t=a.Z.getDataPrefix("footer_id"),e=a.Z.getDataPrefix("inputType"),i=a.Z.getDataPrefix("value"),o=a.Z.getDataPrefix("useLocale"),r=a.Z.getDataPrefix("localeRef"),n=this.getDomList("foot_tds","td",this.getElementById(this.id+"_foot_table")),l=0;l<n.length;l++){var h=n[l],d=h.getAttribute("id");if(d&&!h.getAttribute(t)){for(var p=d,u="",c=0;c<this.struct.foot.rowArr.length;c++)for(var g=0;g<this.struct.foot.rowArr[c].length;g++)if(this.struct.foot.rowArr[c][g].id==d&&(this.struct.foot.rowArr[c][g].class||this.struct.foot.rowArr[c][g].className)){u=this.struct.foot.rowArr[c][g].class||this.struct.foot.rowArr[c][g].className;break}if(this.setConfigOptions(h,"footer"),"_headerRowNumber"!==d&&"_headerRowStatus"!==d||(d+="_footer"),h.setAttribute(t,d),h.setAttribute("id",this.id+"_"+d),h.setAttribute("class",h.getAttribute("class")+" "+this.id+"_footer__column"+l+" "+u),"expression"!=h.getAttribute(e)){var f=h.getAttribute(i),m=h.getAttribute(o),y=this.footerConfigOptions[p]||{};if("true"===m||this.options.useLocale&&!m||"false"!==m&&y.useLocale){var b=h.getAttribute(r)||y.localeRef;if(b){var v=this.getLocaleValue(b);v&&(f=v)}}f=null!=f?f:"",h.innerHTML=this.dataTagOpen+f+this.dataTagClose}}}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.drawFooter=function(t){try{if(!this.hasFooter||!this.drawFooterStatus)return;null==this.footerDataObj&&this.initFooterDataObj();var e=a.Z.getDataPrefix("footer_id"),i=a.Z.getDataPrefix("colindex"),o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");this.footerTempSum=[];var r=!1;if(this._sumifColumnRelation||this._sumifsColumnRelation){if(this._sumifColumnRelation&&Object.keys(this._sumifColumnRelation).length>0)for(var n in this._sumifColumnRelation)if(this._sumifColumnRelation[n]===t){r=!0;break}if(this._sumifsColumnRelation&&!1===r&&Object.keys(this._sumifsColumnRelation).length>0)for(var n in this._sumifsColumnRelation)for(var l=0;l<this._sumifsColumnRelation[n].length;l++)if(this._sumifsColumnRelation[n][h]===t){r=!0;break}}if(t&&!r){t=this.getColumnID(t);for(var h=0;h<o.length;h++){var d=(y=o[h]).getAttribute(e),u=parseInt(y.getAttribute(i))-this.defaultColCnt;if(d)if("expression"==(b=this.footerDataObj[d]).inputType){var c=b.expression.match(/footercol(sum|avg|max|min|custom)\s*\([^\)]*/g);if(c){for(var g=0;g<c.length;g++)if(c[g].indexOf(t)>=0){var f=a.Z.scopingFuncBody(b.expression,this.scope_id)
;b.value=Function("_this",f).call(this,this),isNaN(b.value)?"NaN"!=b.NaNFormat&&(b.value=b.NaNFormat):"number"===b.dataType&&0===Number(b.value)&&(b.value=0);var m=b.value;b.customModelUnformatter&&(m=b.customModelUnformatter.call(this,m)),y.innerHTML=this.dataTagOpen+b.formatter.format(m)+this.dataTagClose}}else if(t==this.getCellInfo(u).id){try{f=a.Z.scopingFuncBody(b.expression,this.scope_id);b.value=Function("_this",f).call(this,this),isNaN(b.value)&&"NaN"!=b.NaNFormat&&(b.value=b.NaNFormat)}catch(t){s.Y.printStackTrace(t,null,this)}m=b.value;b.customModelUnformatter&&(m=b.customModelUnformatter.call(this,m)),y.innerHTML=this.dataTagOpen+b.formatter.format(m)+this.dataTagClose}}}}else for(h=0;h<o.length;h++){var y;if(d=(y=o[h]).getAttribute(e)){var b;if("expression"==(b=this.footerDataObj[d]).inputType)try{f=a.Z.scopingFuncBody(b.expression,this.scope_id);b.value=Function("_this",f).call(this,this),isNaN(b.value)?"NaN"!=b.NaNFormat&&(b.value=b.NaNFormat):"number"===b.dataType&&0===Number(b.value)&&(b.value=0)}catch(t){p.v.printLog("[Warning]:"+t.message)}m=b.value;b.customModelUnformatter&&(m=b.customModelUnformatter.call(this,m)),y.innerHTML=this.dataTagOpen+b.formatter.format(m)+this.dataTagClose}}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.initFooterDataObj=function(t){try{var e=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),i=-1,n=!1;t?(i=this.getColumnIndex(t),n=!0):this.footerDataObj={};for(var l=a.Z.getDataPrefix("footer_id"),h=a.Z.getDataPrefix("colindex"),d=a.Z.getDataPrefix("value"),p=a.Z.getDataPrefix("useLocale"),u=a.Z.getDataPrefix("localeRef"),c=a.Z.getDataPrefix("inputType"),g=a.Z.getDataPrefix("dataType"),f=a.Z.getDataPrefix("displayFormat"),m=a.Z.getDataPrefix("displayFormatter"),y=a.Z.getDataPrefix("NaNFormat"),b=a.Z.getDataPrefix("expression"),v=0;v<e.length;v++){var w=e[v],C=w.getAttribute(l);C||(C="f_"+o.q.safeRandom().toString(),w.setAttribute(l,C));var I=parseInt(w.getAttribute(h))-this.defaultColCnt;if(!(i>=0&&i!==I)){var _=this.footerConfigOptions[C]||{},x={};x.id=C;var S=w.getAttribute(b)||"";!S&&_.expression&&(S=_.expression);var R="";""!=S&&(this.options.groupbyStatus||(S.toLowerCase().indexOf("sumifs")>-1?R="sumifs":S.toLowerCase().indexOf("sumif")>-1&&(R="sumif")),S=S.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( "),this.options.groupbyStatus||(S=(S=S.replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"_this.footercolsumif( ")).replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"_this.footercolsumifs( ")),S=(S=(S=(S=(S=S.replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( ")),x.value=w.getAttribute(d),!x.value&&_.value&&(x.value=_.value);var D,T,L=w.getAttribute(p);if("true"===L||this.options.useLocale&&!L||"false"!==L&&_.useLocale){var k=w.getAttribute(u)||_.localeRef;if(k){var F=this.getLocaleValue(k);F&&(x.value=F)}}if(x.inputType=w.getAttribute(c),x.dataType=w.getAttribute(g),!x.dataType&&_.dataType&&(x.dataType=_.dataType),x.col_id=this.getColumnID(I),!x.dataType)try{if(x.dataType=this.getColumnOption(x.col_id,"dataType"),"true"===this.options.useCurrency){var A=this.getCellInfo(x.col_id);A&&(D=A.options.displayFormat,T=A.options.displayFormatter,A.options.customModelUnformatter&&("function"==typeof A.options.customModelUnformatter?x.customModelUnformatter=A.options.customModelUnformatter:x.customModelUnformatter=a.Z.getGlobalFunction(A.options.customModelUnformatter,this.scope_id)))}else if("expression"===x.inputType)x.col_id=R?new Function("_this","return "+S.substring(S.indexOf("(")+1,S.indexOf(",")))(this):new Function("_this","return "+S.substring(S.indexOf("(")+1,S.indexOf(")")))(this),x.dataType=this._dataList.getCellInfo(x.col_id).options.dataType||"text";else{var E="text",M=I
;M>=0&&(E=this._dataList.getCellInfo(M).options.dataType),x.dataType=E}}catch(t){x.dataType="text"}x.expression=S,x.displayFormat=w.getAttribute(f)||_.displayFormat||"",x.displayFormatter=w.getAttribute(m)||_.displayFormatter||"","true"!==this.options.useCurrency||x.displayFormatter||(x.displayFormat=D||w.getAttribute(f)||"",x.displayFormatter=T||""),x.formatter=this._initFooterFormatter(x.col_id,x.dataType,x.displayFormat,x.displayFormatter,this.scope_id,this.id,n),x.NaNFormat=w.getAttribute(y)||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||_.NaNFormat||"NaN","$blank"==x.NaNFormat&&(x.NaNFormat=""),this.footerDataObj[x.id]=x}}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype._initFooterFormatter=function(t,e,i,o,a,n,l){try{if(t){var h=this.getCellInfo(t),d=e||h.options.dataType,p=i;return"euro"==d?(i||(p=this.options.euroMask||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/euroMask/@value')||""),".",","):"rupee"==d?(i||(p=this.options.rupeeMask||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/rupeeMask/@value')||""),",","."):"tenge"==d?(i||(p=this.options.tengeMask||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/tengeMask/@value')||"")," ",","):!l||"number"!==d&&"float"!==d&&"bigDecimal"!==d||(i||(p=this.options.numberMask||r.I.getConfiguration('/WebSquare/input/dataType[@valueType="'+d+'"]/numberMask/@value')||""),",","."),WebSquare.format.createFormatter(e,p,o,null,null,null,a,n)}return WebSquare.format.createFormatter(e,i,o,null,null,null,a,n)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolsumif=function(t,e,i){try{var o=[],r=[],a=[];if(e){var n=this._getOperator(e);if(!n.operator||!n.value)return;return r.push(n.operator),a.push(n.value),o?o.push(i):o.push(t),this._sumifColumnRelation||(this._sumifColumnRelation={}),this._sumifColumnRelation[t]=i,this._footercolsum(t,o,r,a)}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolsumifs=function(t){try{var e=[],i=[],o=[],r=(arguments.length-1)/2;this._sumifsColumnRelation||(this._sumifsColumnRelation={}),this._sumifsColumnRelation[t]||(this._sumifsColumnRelation[t]=[]);for(var a=0;a<r;a++){var n=this._getOperator(arguments[2*a+1]),l=arguments[2*a+2];n.operator&&n.value&&(i.push(n.operator),o.push(n.value)),this._sumifsColumnRelation[t].push(l),e.push(l)}return this._footercolsum(t,e,i,o)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolsum=function(t,e,i,o){try{return this._footercolsum(t)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype._footercolsum=function(t,e,i,o){try{this.footerTempSum||(this.footerTempSum=[]);var r=t;if(!this.options.groupbyStatus&&e&&e.length>0&&o&&o.length>0&&(r=t+"_"+o.join()),this.footerTempSum[r]||(this.footerTempSum[r]={}),void 0===this.footerTempSum[r].sum||""===this.footerTempSum[r].sum){var n="",l=5e3;if(this.groupbyStatus.grouped)n=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"SUM('"+t+"')");else{var h={};this.options.groupbyStatus||(h={conditionColumn:e,operator:i,conditionValue:o,blank:!1});var d=this.getColumnAllDataArray(t,h),p=this.getColumnOption(t,"dataType"),u=!1;if("bigDecimal"!==p&&"euro"!==p&&"tenge"!==p&&"rupee"!=p||(u=!0),d.length>0&&u||"true"===this.options.useCurrency){for(var c=WebSquare.bigDecimal("0"),g=0;g<d.length;g++)""==d[g].replace(/^\s+|\s+$/g,"")&&(d[g]="0");for(var f=0;f<d.length;f++)d[f]=WebSquare.bigDecimal(d[f]),c=c.plus(d[f]);n=c.toString()}else if(d.length>0)if(d.length>l){var m,y=Math.ceil(d.length/l),b=0;n=0;for(g=0;g<y;g++){for(var v=d.slice(b,l*(g+1)),w=0;w<v.length;w++)""==v[w].replace(/^\s+|\s+$/g,"")&&(v[w]="0"),v[w]=v[w]-0+"";m=a.Z.sum(v),b=parseInt(b,10)+parseInt(v.length,10),n=parseFloat(n,10)+parseFloat(m,10)}
}else n=a.Z.sum(d)}this.footerTempSum[r].sum=n}return a.Z.setPrecision(this.footerTempSum[r].sum)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolavg=function(t){try{var e=this.getColumnAllDataArray(t);this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={});var i="",o=5e3;if(this.groupbyStatus.grouped)return i=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"AVG('"+t+"')");if(void 0===this.footerTempSum[t].sum||""===this.footerTempSum[t].sum){var r=this.getColumnOption(t,"dataType");if(e.length>0&&("bigDecimal"==r||"true"===this.options.useCurrency)){for(var n=WebSquare.bigDecimal("0"),l=0;l<e.length;l++)""==e[l].replace(/^\s+|\s+$/g,"")&&(e[l]="0");for(var h in e)e[h]=WebSquare.bigDecimal(e[h]),n=n.plus(e[h]);return n.divide(WebSquare.bigDecimal(e.length)).toString()}if(e.length>0)if(e.length>o){var d,p=Math.ceil(e.length/o),u=0;i=0;for(l=0;l<p;l++){for(var c=e.slice(u,o*(l+1)),g=0;g<c.length;g++)""==c[g].replace(/^\s+|\s+$/g,"")&&(c[g]="0");d=a.Z.sum(c),u=parseInt(u,10)+parseInt(c.length,10),i=parseFloat(i,10)+parseFloat(d,10)}}else i=a.Z.sum(e);this.footerTempSum[t].sum=i}return""===this.footerTempSum[t].sum?"":i=this.cellInfoHash[t]&&"bigDecimal"==this.cellInfoHash[t].options.dataType?WebSquare.bigDecimal(this.footerTempSum[t].sum).divide(WebSquare.bigDecimal(e.length)).toString():this.footerTempSum[t].sum/e.length}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolmax=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].max||""===this.footerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MAX('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&("bigDecimal"==o||"true"===this.options.useCurrency)){for(var r,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),r=null==r?i[l]:r.compare(i[l],!1);e=r.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e<h)&&(e=h)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.footerTempSum[t].max=e}}return this.footerTempSum[t].max}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolmin=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].min||""===this.footerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MIN('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&("bigDecimal"==o||"true"===this.options.useCurrency)){for(var r,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),r=null==r?i[l]:r.compare(i[l],!0);e=r.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e>h)&&(e=h)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.footerTempSum[t].min=e}}return this.footerTempSum[t].min}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolcnt=function(t,e){try{e=e||{};return(this.getColumnAllDataArray(t,e)||[]).length}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getColumnAllDataArray=function(t,e){try{var i=[],o=this.getColumnID(t),r=this.dataList.getDeletedIndex(),n=this.dataList.getModifiedIndex();if(null!==o){for(var l=this.isDrillDown&&a.Z.getBoolean(this.options.drilldownFooterExpressionAllData)?this.getTotalRow():this.getDataLength(),h=0;h<l;h++){if(this.options.excludeDeletedRows){for(var d=!1,u=0;u<r.length;u++)if(r[u]===h){d=!0;break}if(d)continue}if(this.options.excludeModifiedRows){for(d=!1,u=0;u<n.length;u++)if(n[u]===h){d=!0;break}if(d)continue}var c
;if(this.isDrillDown&&a.Z.getBoolean(this.options.drilldownFooterExpressionAllData)){if("object"==typeof e&&e.conditionColumn&&e.conditionColumn.length>0){var g=!0;for(u=0;u<e.conditionColumn.length;u++){var f=this._dataList.getCellData(h,e.conditionColumn[u]),m=e.operator[u],y=e.conditionValue[u],b=this.getColumnOption(e.conditionColumn[u],"dataType");if(0==(g=this._isMatched(y,f,m,b)))break}if(0==g)continue}c=this._dataList.getCellData(h,o)}else{if("object"==typeof e&&e.conditionColumn&&e.conditionColumn.length>0){for(g=!0,u=0;u<e.conditionColumn.length;u++){f=this.dataList.getCellData(h,e.conditionColumn[u]),m=e.operator[u],y=e.conditionValue[u],b=this.getColumnOption(e.conditionColumn[u],"dataType");if(0==(g=this._isMatched(y,f,m,b)))break}if(0==g)continue}c=this.dataList._getCellData(h,o)}void 0===(c+="")||""==c?(c="0","object"==typeof e&&!1!==e.blank&&i.push(c)):i.push(c)}return i}p.v.printLog("[Warning] Invalid colIndex("+t+"). ["+this.id+"] getColumnAllDataArray.")}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getFooterData=function(t,e){try{var i=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),o=a.Z.getDataPrefix("footer_id");if("number"==typeof t){t=i[t+this.defaultColCnt].getAttribute(o);var r=(h=this.footerDataObj[t]).value;if("expression"==h.inputType){var n=a.Z.scopingFuncBody(h.expression,this.scope_id);r=Function("_this",n).call(this,this)}return"displayData"!=e?r:h.formatter.format(r)}for(var l=0;l<i.length;l++)if(i[l].getAttribute(o)==t){var h;r=(h=this.footerDataObj[t]).value;if("expression"==h.inputType){n=a.Z.scopingFuncBody(h.expression,this.scope_id);r=Function("_this",n).call(this,this)}return"displayData"!=e?r:h.formatter.format(r)}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.setFooterValue=function(t,e){this.setFooterData(t,e)},S.prototype.setFooterData=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td"),r=a.Z.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(r);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(r)==t){var l=this.footerDataObj[t];"text"==l.inputType&&(l.value=e,i.innerHTML=this.dataTagOpen+l.formatter.format(l.value)+this.dataTagClose)}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.setFooterDisplayFormat=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),r=a.Z.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(r);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(r)==t){var l=this.footerDataObj[t];l.displayFormat=e,l.formatter=WebSquare.format.createFormatter(l.dataType,l.displayFormat,l.displayFormatter,null,null,null,this.scope_id,this.id),"number"==l.dataType&&(i.innerHTML=this.dataTagOpen+l.formatter.format(l.value)+this.dataTagClose)}var h=this.footerXml;if(h)for(var d=WebSquare.xml.getElementsByTagName(h,"w2:row"),p=0;p<d.length;p++){var u=WebSquare.xml.getElementsByTagName(d[p],"w2:column");for(n=0;n<u.length;n++){var c=u[n];if(c.getAttribute("id")==t){c.setAttribute("displayFormat",e);break}}}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getFooterStyle=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),r=a.Z.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(r);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(r)==t)return WebSquare.style.getStyle(i,e)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.setFooterStyle=function(t,e,i){try{var o,r=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),n=a.Z.getDataPrefix("footer_id");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber_footer";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus_footer";else if("number"==typeof t){t=(o=r[t+this.defaultColCnt]).getAttribute(n)}
for(var l=0;l<r.length;l++)(o=r[l]).getAttribute(n)==t&&WebSquare.style.setStyle(o,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getExcelAllFooterXML=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var e=[];e.push("<array><![CDATA["),e.push('["'),this.footerDataObj||this.initFooterDataObj();for(var i="",o=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0].getChildNodes(),n=0;n<o.length;n++){var l=o[n];if(1==l.nodeType)for(var h=l.getChildNodes(),d=0;d<h.length;d++){var p=h[d];if(1==p.nodeType){var u=p.getAttribute("id"),c=this.footerDataObj[u];if("expression"!=c.inputType)i=c.value,i=c.formatter.format(i);else{var g=a.Z.scopingFuncBody(c.expression,this.scope_id);i=Function("_this",g).call(this,this),i=c.formatter.format(i)}e.push(i),e.push('"'+t+'"')}}}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getExcelAllFooterXMLDisplay=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var e=a.Z.getDataPrefix("footer_id"),i=[];i.push("<array><![CDATA["),i.push('["');var o=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td");if(this.groupbyStatus.grouped){this.footerDataObj||this.initFooterDataObj();var n=0;if(this.options.rowNumVisible){var l=(f=this.footerDataObj[o[n].getAttribute(e)]).value||"";i.push(l),i.push('"'+t+'"'),n++}if(this.options.rowStatusVisible){l=(f=this.footerDataObj[o[n].getAttribute(e)]).value||"";i.push(l),i.push('"'+t+'"')}}this.footerDataObj||this.initFooterDataObj();l="";for(var h=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0].getChildNodes(),d=0;d<h.length;d++){var p=h[d];if(1==p.nodeType)for(var u=p.getChildNodes(),c=0;c<u.length;c++){var g=u[c];if(1==g.nodeType){var f,m=g.getAttribute("id");if("expression"!=(f=this.footerDataObj[m]).inputType)l=f.value,l=f.formatter.format(l);else{var y=a.Z.scopingFuncBody(f.expression,this.scope_id);l=Function("_this",y).call(this,this),l=f.formatter.format(l)}i.push(l),i.push('"'+t+'"')}}}return i[i.length-1]='"]',i.push("]]></array>"),i.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getExcelAllFooterXMLRaw=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";this.footerDataObj||this.initFooterDataObj();for(var e=[],i="",o=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0].getChildNodes(),a=0;a<o.length;a++){var n=o[a];if(1==n.nodeType)for(var l=n.getChildNodes(),h=0;h<l.length;h++){var d=l[h];if(1==d.nodeType){var p=d.getAttribute("id"),u=this.footerDataObj[p];i=u.value,i=u.formatter.format(i),e[e.length]=i}}}return e[0]='<array><![CDATA[["'+e[0],e[e.length-1]+='"]]]></array>',e.join('"'+t+'"')}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.getExpressionValue=function(t){try{return this.hasFooter||(this.footerTempSum=[]),t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( "),this.options.groupbyStatus||(t=(t=t.replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"_this.footercolsumifs( ")).replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"_this.footercolsumif( ")),t=(t=(t=(t=(t=t.replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( "),new Function("_this","return "+t)(this)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.footercolcustom=function(t,e){try{var i=a.Z.getGlobalFunction(t,this.scope_id),o="";return"function"==typeof i&&(o=i(this.getColumnAllDataArray(e),this.getColumnOption(e,"dataType"))),o}catch(e){p.v.printLog("[Warning] "+t+" is not valid function.["+this.id+"]")}},S.prototype.getFooterHeight=function(){try{var t=0;if(this.hasFooter){
var e=document.getElementById(this.id+"_foot_table");e&&(t=e.offsetHeight)}return t}catch(t){return s.Y.printStackTrace(t,null,this),0}};var R=i(4799),D=function(t){};D.prototype.setStartRowNumber=function(t){this.startRowNumber=t;for(var e=0;e<=this.lastIndex;e++)this._drawRowNumData(e,e+this.rowIndex)},D.prototype.setNoResultMessage=function(t){this.options.noResultMessage=t,this.displayNoResultMessage()},D.prototype.setNoResultMessageVisible=function(t){this.options.noResultMessageVisible=t,this.displayNoResultMessage()},D.prototype.checkAll=function(t,e){var i=!1,o=this.getCellInfo(t),s=o.id;if("checkbox"!=o.options.inputType){if("custom"!=o.options.inputType){var r=WebSquare.language.getMessage("Grid_warning1")||"The selected column is not a checkbox.";return void $l(r)}i=!0}var a=o.options.trueValue,n=o.options.falseValue;this.drawFooterStatus=!1;var l,h=!(!this.isDrillDown||!this._dataList.options.depthColumn),d=h?this.getTotalRow():this.getDataLength(),p=!1,u=!1;if(this._linkedDataList){(u=this._linkedDataList.getBroadcast())&&this._linkedDataList.setBroadcast(!1);for(var c=0;c<d;c++){var g=this._linkedDataList.initialRowIndexArr[c],f=h?g:this._dataList.getFilteredRowIndex(g);if(i){if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;a=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==a)l!=a&&this._dataList.setCellData(f,s,a);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{var m=l==a?n:a;this._dataList.setCellData(f,s,m)}}}else{(p=this._dataList.getBroadcast())&&this._dataList.setBroadcast(!1);for(f=0;f<d;f++){if(i){var y;g=this.dataList.getRealRowIndex(f);if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;a=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==a)l!=a&&this._dataList.setCellData(f,s,a);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{m=l==a?n:a;this._dataList.setCellData(f,s,m)}}}u&&this._linkedDataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1}]});var b=!!h;p&&this._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1,skipInitDrilldown:b}]}),this.drawFooterStatus=!0,this.drawFooter(),this.drawHeader()},D.prototype.getColumnType=function(t){return this.getCellInfo(t).options.inputType},D.prototype.getColumnNodeSet=function(t){return this.getCellInfo(t).itemsetObj},D.prototype.getDefaultStyle=function(){return this.options.style},D.prototype.setCellChecked=function(t,e,i){if("boolean"==typeof i){var o=this.getCellInfo(e),s=o.id,r=!1;if(0==o.internal&&"custom"==o.options.inputType){var a=this.dataList.getRealRowIndex(t);o=o.cellManagerHashByRowIndex[a]?o.cellManagerHashByRowIndex[a]:o,r=!0}if("checkbox"==o.options.inputType||"radio"==o.options.inputType){if("radio"==o.options.inputType&&0!=i){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn),l=n?this.getTotalRow():this.getDataLength();if(this._linkedDataList)if(r);else for(var h=0;h<l;h++){a=this._linkedDataList.initialRowIndexArr[h];var d=n?a:this._dataList.getFilteredRowIndex(a);this._dataList.setCellData(d,s,o.options.falseValue)}else if(r);else for(d=0;d<l;d++)this._dataList.setCellData(d,s,o.options.falseValue);this.drawColumnData(e)}i=1==i?o.options.trueValue:o.options.falseValue,this._dataList.setCellData(t,s,i)}else{var p=WebSquare.language.getMessage("Grid_warning3")||"inputType is neither a checkbox nor a radio button.";alert(p)}}else{var u=WebSquare.language.getMessage("Grid_warning2")||"Invalid data format encountered. Expected 'true' or 'false', please re-enter.";alert(u)}},D.prototype.getGridHTML=function(){p.v.printLog("getGridHTML function not yet available.")},D.prototype.redrawColumn=function(t,e){try{var i=void 0===e||e;this.drawColumnData(t,i)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getDrawCount=function(){
return this.getVisibleRowNum()},D.prototype.getVisibleRowNum=function(){return this.rowIndex>=0?this.lastIndex+1:0},D.prototype.getTopRowIndex=function(){return this.rowIndex},D.prototype.setTopRowIndex=function(t,e,i){if(!0!==this._isNativeScroll())if(!0!==this._isHybridScroll()){var o=this.getElementById(this.id+"_scrollY_div");if(t<=0&&(t=0),null!==this.lastTopRowIndex)t>this.lastTopRowIndex&&(t=parseInt(this.lastTopRowIndex+.5,10));else if(o.offsetHeight<o.scrollHeight){if(this.rowIndex<t){var s=this._getVisibleLastIndex(this.lastIndex+1);(t=t+s>this.getDataLength()?this.getDataLength()-s:t)>this.rowIndex+s-1&&(this.adjustDraw_keepTop=!0)}}else t=0;if(this.rowIndex!=t){if(this.delayedDraw({rowIndex:t}))return;this.scrollEvent=!1,this.checkScrollEnd=!e,this.drawData(t),i&&this.setFocusedCell2(t,0,!1),o.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t)}}else this._drawDataHybrid(t);else this.drawData(0)},D.prototype.getBottomRowIndex=function(){return this.rowIndex>=0?this.rowIndex+this.lastIndex:-1},D.prototype.setBottomRowIndex=function(t){this.drawBottomData(t)},D.prototype.getCellPosition=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=this.data_td_list[e+t*this.oneRowDataLength];if(!o){var s=t-this.rowIndex;o=this.data_td_list[e+s*this.oneRowDataLength]}if(o){if("top"==i)return o.offsetTop;if("left"==i)return o.offsetLeft}return null},D.prototype.getCellSize=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=t-this.rowIndex,s=this.data_td_list[e+o*this.oneRowDataLength];return"width"==i?s.clientWidth:"height"==i?s.clientHeight:null},D.prototype.getHeaderPosition=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);if("top"==e){var o=i.offsetTop;return this.options.groupbyZone&&(o+=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),o}return"left"==e?i.offsetLeft:null},D.prototype.getHeaderSize=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);return"width"==e?i.clientWidth:"height"==e?i.clientHeight:null},D.prototype.setSummary=function(t){!0!==a.Z.isHTML5()&&this.getElementById(this.id+"_body_table").setAttribute("summary",t)},D.prototype.setFooterSummary=function(t){this.hasFooter&&this.getElementById(this.id+"_foot_table").setAttribute("summary",t)},D.prototype.setCaption=function(t){var e=this.getElementById(this.id+"_body_table").getElementsByTagName("caption")[0];if(e)e.innerHTML=t;else{(e=document.createElement("caption")).innerHTML=t;var i=this.render.getElementsByTagName("colgroup")[0];i.parentNode.insertBefore(e,i)}var o=e.className;e.className=o&&""!=o?o+" setcaption":"setcaption"},D.prototype.setCaptionAuto=function(t){for(var e=this.getHeaderValueList(),i="",o="",s=0;s<e.length;s++)i.length>0&&(o=","),i=i+o+e[s];t&&(this.options.captionTitle=t),this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+i+WebSquare.language.getMessage("Grid_caption")):this.setCaption(i+WebSquare.language.getMessage("Grid_caption"))},D.prototype.setFooterCaption=function(t){if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table"),i=e.getElementsByTagName("caption")[0];if(i)i.innerHTML=t;else{(i=document.createElement("caption")).innerHTML=t;var o=e.getElementsByTagName("colgroup")[0];o.parentNode.insertBefore(i,o)}}},D.prototype.groupby=function(t){try{this.hideCustomFilterList(),this._clearMergeCellBackground(),this.clearSearchData({clearValue:!0});var e="string"==typeof(t=t||{}).sortIndex?t.sortIndex.split(" "):t.sortIndex,i="string"==typeof t.sortOrder?t.sortOrder.split(" "):t.sortOrder,r=e.length;if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<r)return void p.v.printLog("groupby max column count has been exceeded.["+this.id+"]");for(var n=0;n<r;n++){var l=parseInt(e[n],10);e[n]=isNaN(l)?this.getColumnIndex(e[n]):l}
if(!t.filter&&!this.groupbyStatus.grouped&&this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var h=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()];if(!h.groupbyOptions&&h.customFilterListFilterInfo){t.filter=JSON.parse(h.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}}));var d=e.length-1,u=!1;for(var c in t.filter){var g=!1;for(n=d;n>=0;n--)if(this.tdIdList[e[n]]===c){g=!0;break}g||(e.push(this.bodyIdColIndexMap[c]),i.push(i[i.length-1]),u=!0)}u&&(t.sortIndexArr=e,t.sortOrderArr=i),this.groupbyFilterList||this.createGroupbyFilterList({noDraw:!0}),this.groupbyStatus.filter=t.filter,this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],r=e.length}}this.removeFocusedCell(),this._dataList.clearFilter(!0),this.clearHeaderSort(),this.headerSortStatusArr=[],this.groupbyStatus.groupbyOptions=JSON.stringify(t,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e}));var f={};if(t.filter){var m="",y="";for(var c in t.filter){var b,v=t.filter[c];m=',"'+c+'"'+m,y=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+y,"func"===v.type?(v.noRefresh=!0,v.noRefreshAfter=!0,f[this.bodyToHeaderRelation[v.colIndex]]=!0,this.dataList.setColumnFilter(v)):(v.constructor===/a/.constructor?b=v:t.filterRegExp&&t.filterRegExp[c]&&t.filterRegExp[c].constructor===/a/.constructor?b=t.filterRegExp[c]:"object"==typeof v&&(v=0==v.length?"/^[a-z0-9_-]{3,16}$/":"^"+v.join("$|^")+"$",b=new RegExp(v,"gi")),b&&this.dataList.setColumnFilter({type:"regExp",colIndex:c,key:b,condition:"and",noRefresh:!0,noRefreshAfter:!0}))}if(this.groupbyFilterList){var w='{"column":['+(m=m.slice(1)+"],")+'"filteredRowIndexArr":['+(y=y.slice(1)+"]}");if(this.groupbyFilterList.filterHistory=JSON.parse(w),this.getRowCount()<=0)for(;this.groupbyFilterList.filterHistory.filteredRowIndexArr.length>0&&this.groupbyFilterList.filterHistory.filteredRowIndexArr[0].length<=0;)this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift()}t.noRefreshAfter||this._dataList.broadcast({gridView:["notifyAfterSettedColumnFilter"]})}if(t.sortIndex){var C=o.q.extend({},t);C.noRefresh=!0,C.sortIndex=[];for(n=0;n<e.length;n++)C.sortIndex.push(this.getColumnID(e[n]));if(t.sortFunc)if(C.sortFuncArr=[],"string"==typeof t.sortFunc)(I=a.Z.getGlobalFunction(t.sortFunc,this.scope_id))&&C.sortFuncArr.push(I);else if(t.sortFunc.constructor==Array)for(n=0;n<t.sortFunc.length;n++){var I;(I=a.Z.getGlobalFunction(t.sortFunc[n],this.scope_id))&&C.sortFuncArr.push(I)}this.dataList.multisort(C)}this.groupbyInfo={},this.statusArr=[];var _=this._linkedDataList?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr,x=[],S=[],R=0,D=[],T=[];for(var L in this.groupbyStatus.groupedRowIndexArr=[],this.groupbyStatus.groupbyRowIndexArr=_.slice(),this.groupbyStatus.groupbyDepthDelimiter="||",this.customFilterStatusObj={},f)this.customFilterStatusObj[L]=!0;this.groupbyStatus.grouped=!0,this.groupbyStatus.filter=t.filter||{},this.groupbyStatus.sortIndexArr=e,this.groupbyStatus.sortOrderArr=i,this.groupbyStatus.headerValueObj={},this.groupbyStatus.footerValueObj={},t.keepDisplayOptions||(this.groupbyDisplayOptions={},this.groupbyDisplayOptions.rowNumHeader=t.rowNumHeader||{},this.groupbyDisplayOptions.rowStatusHeader=t.rowStatusHeader||{},this.groupbyDisplayOptions.groupbyHeader=t.groupbyHeader||[],this.groupbyDisplayOptions.rowNumFooter=t.rowNumFooter||{},this.groupbyDisplayOptions.rowStatusFooter=t.rowStatusFooter||{},this.groupbyDisplayOptions.groupbyFooter=t.groupbyFooter||[],
this.groupbyDisplayOptions.closeGroup=t.closeGroup||!1,this.groupbyDisplayOptions.showDisplayData=t.showDisplayData||!1,this.groupbyDisplayOptions.showOnlyLastDepth=t.showOnlyLastDepth||!1,this.groupbyDisplayOptions.hideHeader=t.hideHeader||!1,this.groupbyDisplayOptions.hideFooter=t.hideFooter||!1);for(n=0;n<_.length;n++){D=T,T=[];for(var k=_[n],F=k*this._dataList.cellIdList.length,A=0;A<r;A++){var E=this.tdIdList[e[A]],M=this.cellInfoHash[E];M&&"expression"==M.options.inputType?T[A]=M.getExpressionValue(k):T[A]=this._dataList.dataArr[F+this._dataList.bodyIdColIndexMap[E]]||""}if(n>0){var O=!1,N=[];for(A=0;A<r;A++)if(O||D[A]!==T[A]){var H=D.slice(0,A+1).join(this.groupbyStatus.groupbyDepthDelimiter);O=!0;var G={type:"footer",groupId:H,depth:A,status:"open",index:""};this.groupbyInfo[H]=this.groupbyInfo[H]?this.groupbyInfo[H]:{},this.groupbyInfo[H].footer=G,N.push(G)}for(A=N.length-1;A>=0;A--)N[A].index=x.length,this.groupbyDisplayOptions.hideFooter||(x.push(N[A]),S.push("footer"))}var B=!1;for(A=0;A<r;A++)if(B||0==n||D[A]!==T[A]){H=T.slice(0,A+1).join(this.groupbyStatus.groupbyDepthDelimiter);B=!0;G={type:"header",groupId:H,depth:A,status:"open",index:x.length};this.groupbyInfo[H]={header:G},this.groupbyDisplayOptions.hideHeader||(x.push(G),S.push("header"))}x.push(_[n]),S.push(R++)}if(S.length>0)for(n=r-1;n>=0;n--){G={type:"footer",groupId:H=T.slice(0,n+1).join(this.groupbyStatus.groupbyDepthDelimiter),depth:n,status:"open",index:x.length};this.groupbyInfo[H]=this.groupbyInfo[H]?this.groupbyInfo[H]:{},this.groupbyInfo[H].footer=G,this.groupbyDisplayOptions.hideFooter||(x.push(G),S.push("footer"))}if(this.groupbyStatus.groupedRowIndexArr=x,this.rowNumArr=S,this.options.foldAll)for(var H in this.groupbyInfo){"open"==(V=this.groupbyInfo[H].header).status&&0==V.depth&&this._foldRow(V)}else if(this.groupbyDisplayOptions.closeGroup&&S.length>0)for(var W in this.groupbyInfo){var V;r==(V=this.groupbyInfo[W].header).groupId.split(this.groupbyStatus.groupbyDepthDelimiter).length&&"number"!=typeof V&&this.groupbyStatus.groupedRowIndexArr[V.index]==V&&this._foldRow(V)}this.lastTopRowIndex=null,this.rowIndex=0,this.setScrollYHeight(),t.sortIndex?(this._dataList.broadcast({gridView:["notifyMultisort"]}),this._dataList.broadcast({gridView:["notifySettedFilter",[{isSort:!0,keepTop:t.keepTop}]],generalComp:"both"})):this.notifyDataChanged(),this.options.groupbyZoneMessage&&this.hideGroupbyZoneMessage(),this.options.groupbyZone&&this.syncWithGroupbyZone();var q=e.length;if(this.groupbyStatus.beforeSortIndexLength=q,a.Z.isIE("8")&&this.drawData(0,null,"async"),this.groupbyStatus.grouped&&!this.options.groupbyFilterIcon){var Y=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(n=0;n<Y.length;n++){var Z=Y[n],j=Z.getAttribute("id");if(this._checkUseFilter(Z)){var P=this.getElementById(j+"_filter");P&&(P.style.display="none")}}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.clearGroupby=function(){try{this.clearGrouping=!0,this.groupbyStatus={},this.groupbyZoneStatus.beforeOpenedColIndex=null,this.groupbyZoneStatus.beforeOpenedColTagName=null,this.groupbyZoneStatus.clickedHeaderInfo=null,this.groupbyDisplayOptions=null,this.rowIndex=0,this.dataList.clearFilter(),this.clearHeaderSort(),this.clearGroupbyZone(),a.Z.isIE("8"),this.options.groupbyZoneMessage&&this.showGroupbyZoneMessage(),this.groupbyFilterList&&this.hideGroupbyFilterList();var t=this.getDataLength();if(t<this.rowIndex+this.drawedRowLength)for(var e=t-this.rowIndex;e<this.drawedRowLength;e++)this.clearGroupedRow(e,e+this.rowIndex);this.clearGrouping=!1;var i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(e=0;e<i.length;e++){var o=i[e],r=o.getAttribute("id");if(this._checkUseFilter(o)){var n=document.getElementById(r+"_filter");n&&(n.style.display="")}}
if(this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var l=this.groupbyFilterBox_select.getSelectedIndex();this.groupbyFilterBox_history[l].groupbyOptions&&(this.notifyBeforeSettedColumnFilter(),this.refreshCustomFilterHistory(l),this.notifyAfterSettedColumnFilter())}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.toggleGroup=function(t){if(this.groupbyInfo[t]){var e=this.groupbyInfo[t].header;"number"!=typeof e&&this.dataList.getRealRowIndex(e.index)==e&&("open"==e.status?this._foldRow(e):this._unfoldRow(e),this.lastTopRowIndex=null,this.setScrollYHeight(),"open"==e.status?this.notifyRowInserted(e.index):this.notifyRowChanged(e.index),this.removeFocusedCell(),this.drawFooter())}},D.prototype._foldRow=function(t){if("open"==t.status){if(t.status="closed",this.groupbyDisplayOptions.hideFooter){for(var e,i=t.index+1;i<this.rowNumArr.length&&!("header"==this.rowNumArr[i]&&this.groupbyStatus.groupedRowIndexArr[i].depth<=t.depth);i++)e=i;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,e-t.index)}else{var o=this.groupbyInfo[t.groupId].footer;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,o.index-t.index-1)}var s=[],r=t.closedChildArr.slice(0).sort();for(i=0;i<this.groupbyStatus.groupbyRowIndexArr.length;i++){for(var a=!1,n=0,l=r.length-1,h=0,d=this.groupbyStatus.groupbyRowIndexArr[i];n<=l;){if(d==r[h=Math.floor((n+l)/2)]){a=!0;break}d<r[h]?l=h-1:n=h+1}a||s.push(this.groupbyStatus.groupbyRowIndexArr[i])}this.groupbyStatus.groupbyRowIndexArr=s;var p=this.groupbyStatus.groupedRowIndexArr.length,u=0;this.rowNumArr=[];for(i=0;i<p;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?this.rowNumArr.push(u++):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},D.prototype._unfoldRow=function(t){if("closed"==t.status){t.status="open",t.closedChildArr.unshift(t.index+1,0),[].splice.apply(this.groupbyStatus.groupedRowIndexArr,t.closedChildArr),t.closedChildArr=[];var e=0;this.rowNumArr=[],this.groupbyStatus.groupbyRowIndexArr=[];for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?(this.rowNumArr.push(e++),this.groupbyStatus.groupbyRowIndexArr.push(this.groupbyStatus.groupedRowIndexArr[i])):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},D.prototype.foldAll=function(){for(var t in this.groupbyInfo){var e=this.groupbyInfo[t].header;"open"==e.status&&0==e.depth&&this._foldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},D.prototype.unfoldAll=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++){var e=this.groupbyStatus.groupedRowIndexArr[t];"number"!=typeof e&&"header"==e.type&&"closed"==e.status&&this._unfoldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},D.prototype.drawGroupData=function(t,e,i){var o,s,r,a=t,n=i*this.realRowDataLength,l=this.realRowDataLength;if("header"==e.type)o=this.groupbyDisplayOptions.rowNumHeader,s=this.groupbyDisplayOptions.rowStatusHeader,r=this.groupbyDisplayOptions.groupbyHeader;else{if("footer"!=e.type)return void(t.innerHTML="");o=this.groupbyDisplayOptions.rowNumFooter,s=this.groupbyDisplayOptions.rowStatusFooter,r=this.groupbyDisplayOptions.groupbyFooter}this.options.rowNumVisible&&(this._drawGroupData(a,e,o),o.hidden||(l-=o.colSpan||1),n++,
a=this.all_data_td_list[n]),this.options.rowStatusVisible&&(this._drawGroupData(a,e,s),s.hidden||(l-=s.colSpan||1),n++,a=this.all_data_td_list[n]);for(var h={},d=0;d<l;d++)if(!h["domIndex_"+n]){n++;var p={};if(r instanceof Array?p=r[d]||{}:r instanceof Object&&"object"==typeof r&&(p=r["depth_"+e.depth][d]||{}),Number(p.targetIndex)>-1){var u=i*this.realRowDataLength+p.targetIndex;h["domIndex_"+u]=!0,this._drawGroupData(this.all_data_td_list[u],e,p)}else this._drawGroupData(a,e,p);a=this.all_data_td_list[n]}},D.prototype._drawGroupData=function(t,e,i){try{var o=i.className||"",r="gridBodyDefault w2grid_groupby w2grid_groupby_depth_"+e.depth+" "+o;t.className=r,t.innerHTML="";var n,l=i.colSpan,h=i.value||"",d=i.inputType||"",p=i.depthVisible||!1,u=i.align||"",c=i.expression||"",g=(l=i.colSpan||1,i.hidden?"none":""),f=i.displayFormatType||"text",m=i.displayFormat||"",y=i.displayFormatter||null;if(t.setAttribute("colSpan",l),t.style.align="",t.style.textAlign="",t.style.display=g,t.style.borderTopWidth="1px",t.style.borderBottomWidth="1px",d){var b=a.Z.getDataPrefix("col_id");switch((m||y)&&(n=new WebSquare.format.createFormatter(f,m,y,null,null,null,this.scope_id,this.id)),d){case"toggleButton":var v="<span class='"+("open"==e.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block;"+(u?"float:"+u+";":"")+" margin-left:"+20*e.depth+"px;'></span>";t.innerHTML+=v;break;case"expression":if(c){var w=this.groupbyInfo[e.groupId].header;w.colID=t.getAttribute(b);var C=0;if("open"==w.status){for(var I,_=!0,x=0,S=w.index;S<this.groupbyStatus.groupedRowIndexArr.length;S++){var R=this.groupbyStatus.groupedRowIndexArr[S];if(this.groupbyDisplayOptions.hideFooter&&_){_=!1;for(var D=S+1;D<this.groupbyStatus.groupedRowIndexArr.length;D++){var T=this.groupbyStatus.groupedRowIndexArr[D];if("header"==T.type&&R.depth>=T.depth)break;x=D}}if(this.groupbyDisplayOptions.hideFooter){if(S>=x){I=S;break}}else if("footer"==R.type&&R.depth==w.depth){I=R.index;break}}C=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,w.index,I,c,w)}else C=this.groupExpression(w.closedChildArr,0,w.closedChildArr.length-1,c,w);n&&(C=n.format(C));var L="<span style='display:inline-block;"+(u?"float:"+u+";":"")+"''>"+C+"</span>";t.innerHTML+=L}}}if(p){var k="";"toggleButton"!=d&&(k="margin-left: "+20*e.depth+"px"),t.innerHTML+="<span style='display:inline-block;"+(u?"float:"+u+";":"")+" "+(k||"")+"'>"+e.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - ")+"</span>"}h&&(n&&(h=n.format(h)),t.innerHTML+="<span style='display:inline-block;"+(u?"float:"+u+";":"")+"'>"+h+"</span>")}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.groupExpression=function(t,e,i,o,r){try{var a=o;return a=(a=(a=(a=(a=(a=(a=(a=a.replace(/[sS][uU][mM][\s]*[(]/g,"_this.groupbySum(arr, startIndex, endIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.groupbyAvg(arr, startIndex, endIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.groupbyMax(arr, startIndex, endIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.groupbyMin(arr, startIndex, endIndex,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.groupbyCount(arr, startIndex, endIndex,")).replace(/[dD][eE][pP][tT][hH][\s]*[(]/g,"_this.groupbyDepth(header")).replace(/[tT][oO][gG][gG][lL][eE][\s]*[(]/g,"_this.groupbyToggle(header")).replace(/[dD][eE][pP][tT][hH][sS][tT][rR][\s]*[(]/g,"_this.groupbyDepthStr(header"),a=new Function("_this","arr","startIndex","endIndex","expression","header","return "+a)(this,t,e,i,o,r)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.groupbySum=function(t,e,i,o){for(var s=this.getColumnIndex(o),r=0,a=e;a<=i;a++)"number"==typeof t[a]?r+=parseFloat(this.dataList._getCellData(t[a],this.getColumnID(s),3))||0:"header"==t[a].type&&"closed"==t[a].status&&(r+=this.groupbySum(t[a].closedChildArr,0,t[a].closedChildArr.length-1,o));return r},D.prototype.groupbyAvg=function(t,e,i,o){var s=this._groupbyAvg(t,e,i,o);return s.sum/s.number},D.prototype._groupbyAvg=function(t,e,i,o){
for(var s=this.getColumnIndex(o),r={sum:0,number:0},a=e;a<=i;a++)if("number"==typeof t[a])r.sum+=parseFloat(this.dataList._getCellData(t[a],this.getColumnID(s),3))||0,r.number++;else if("header"==t[a].type&&"closed"==t[a].status){var n=this._groupbyAvg(t[a].closedChildArr,0,t[a].closedChildArr.length-1,o);r.sum+=n.sum,r.number+=n.number}return r},D.prototype.groupbyMax=function(t,e,i,o){for(var s=this.getColumnIndex(o),r=0,a=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?r=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(s),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(r=this.groupbyMax(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(a=n=r),n&&a<r&&(a=r);return a},D.prototype.groupbyMin=function(t,e,i,o){for(var s,r=this.getColumnIndex(o),a=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?a=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(r),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(a=this.groupbyMin(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(s=n=a),n&&s>a&&(s=a);return s},D.prototype.groupbyToggle=function(t){return"<span class='"+("open"==t.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block; margin-left:"+20*t.depth+"px;'></span>"},D.prototype.groupbyDepth=function(t){return t.depth},D.prototype.groupbyDepthStr=function(t){try{for(var e=t.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - "),i=!1,o=e.split(" - "),r=0;r<this.groupbyStatus.sortIndexArr.length;r++){if("true"==(g=this.getCellInfo(this.groupbyStatus.sortIndexArr[r])).options.groupbyDepthStrLabel)try{i=!0;var n=o[r];if(g.dataComp){var l=a.Z.getComponentById(g.dataComp,g.scope_id);if(l){var h,d;g.itemsetObj&&(h=g.itemsetObj.label||"label",d=g.itemsetObj.value||"value"),g.element&&(h=g.element.getValue("w2:label","ref"),d=g.element.getValue("w2:value","ref"));for(var p=l.getAllJSON(),u=0;u<p.length;u++){var c=p[u];if(n==c[d]){o[r]=!0!==this.groupbyDisplayOptions.showDisplayData?c[h]:g.getDisplayData(c[h]);break}}}}else for(u=0;u<g.itemArr.length;u++)if(n==g.itemArr[u].value){o[r]=!0!==this.groupbyDisplayOptions.showDisplayData?g.itemArr[u].label:g.getDisplayData(g.itemArr[u].label);break}}catch(t){break}}if(i&&(e=o.join(" - ")),1==this.groupbyDisplayOptions.showDisplayData&&!i){for(r=0;r<o.length;r++){var g=this.getCellInfo(this.groupbyStatus.sortIndexArr[r]);o[r]=g.getDisplayData(o[r])}e=o.join(" - ")}if(1==this.groupbyDisplayOptions.showOnlyLastDepth){var f=e.split(" - ");e=f[f.length-1]}return e}catch(t){s.Y.printStackTrace(t)}},D.prototype.groupbyCount=function(t,e,i){for(var o=0,s=e;s<=i&&s<t.length;s++)"number"==typeof t[s]?o++:"header"==t[s].type&&"closed"==t[s].status&&(o+=this.groupbyCount(t[s].closedChildArr,0,t[s].closedChildArr.length-1));return o},D.prototype._drawGroupbyZone=function(){try{var t=this.uuid;if(this.options.groupbyZone){this.groupbyZoneStatus.groupbyZoneRender=this.dom[this.id+"_groupbyZone_div"];var e=null!=this.options.groupbyZoneHeight.match("%"),i=parseInt(this.options.groupbyZoneHeight),o=i+"px";this.groupbyZoneStatus.groupbyZoneRender.style.height=o,e&&(this.groupbyZoneStatus.groupbyZoneRender.style.height=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px");var r=this.getElementById(this.id+"_main_div"),n=WebSquare.style.getStyle(this.groupbyZoneStatus.groupbyZoneRender,"border-left-width").replace("px","");if(this.groupbyZoneStatus.groupbyZoneBorder=2*n,this.groupbyZoneStatus.groupbyZoneRender.style.width=r.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder+"px",this.dom[this.id+"_main_div"]&&(this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px"),this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.Y.printStackTrace(t,null,this)}if(this.dom[this.id+"_scrollY_div"].style.top="0px",this.options.groupbyZoneMessage){var l=document.createElement("div")
;l.innerHTML+=this.options.groupbyZoneMessage,l.className+=" w2grid_groupbyZone_message ",this.groupbyZoneStatus.groupbyZoneRender.appendChild(l),l.style.marginTop=-l.offsetHeight/2+"px",l.style.marginLeft=-l.offsetWidth/2+"px",this.groupbyZoneStatus.groupbyZoneMessageRender=l}if(this.options.groupbyZoneSearch){var h=document.getElementById(this.id+"_groupbyZone_search");this.groupbyZone_searchinput=new WebSquare.uiplugin.input(this.id+"_groupbyZone_searchinput",{className:"w2grid_groupbyZone_searchinput"}),requires("uiplugin.trigger"),this.groupbyZone_searchbtn=new WebSquare.uiplugin.trigger(this.id+"_groupbyZone_searchbtn",{className:"w2grid_groupbyZone_searchbtn"}),this.addControl(this.groupbyZone_searchinput),this.addControl(this.groupbyZone_searchbtn),h.innerHTML=this.groupbyZone_searchinput.toHTML()+this.groupbyZone_searchbtn.toHTML(),this.groupbyZone_searchbtn.activate(),this.groupbyZone_searchinput.activate();var p=this.groupbyZone_searchinput.uuid;this.groupbyZone_searchbtn.bind("onclick",(function(){WebSquare.idCache[p].show()}));var u=this.id;this.groupbyZone_searchinput.bind("onkeydown",(function(e){d.f.stopPropagation(e),a.Z.setTimeout((function(){var e=WebSquare.idCache[t];e._groupbyZoneSearch(),e.groupbyZone_searchinput.focus()}),{key:u+"_groupbyZone_search",delay:50})})),this.groupbyZone_searchinput.hide()}}if(this.options.groupbyZone&&this.options.groupbyFilterBox){this.groupbyZoneStatus.groupbyFilterBoxRender=this.dom[this.id+"_groupbyFilterBox_div"];var c=this.getElementById(this.id+"_groupbyFilterBox_select");this.groupbyFilterBox_select=new WebSquare.uiplugin.selectbox(this.id+"_groupbyFilterBox_select",{className:"w2grid_groupbyFilterBox_select",labelWidthAuto:!1,readOnly:!0,direction:"top"===this.options.groupbyFilterBoxLocation?"down":"up",visibleRowNum:this.options.filterBoxvisibleRowNum}),this.addControl(this.groupbyFilterBox_select),c.innerHTML=this.groupbyFilterBox_select.toHTML(),this.groupbyFilterBox_select.activate(),this.groupbyFilterBox_select.bind("onclick",(function(t){this.handleClickEvent()})),this.groupbyFilterBox_select.bind("onchange",(function(){WebSquare.idCache[t].applyFilterHistory()}));var g=this.getElementById(this.id+"_groupbyFilterBox_div");"bottom"===this.options.groupbyFilterBoxLocation?this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+g.offsetHeight+"px":"top"===this.options.groupbyFilterBoxLocation&&(this.dom[this.id+"_main_div"].style.top=i+g.offsetHeight+"px",this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+"px",this.groupbyZoneStatus.groupbyZoneRender.style.top=g.offsetHeight+"px");var f=this.getElementById(this.id+"_groupbyFilterBox_main"),m=this.getElementById(this.id+"_groupbyFilterBox_buttons");f.style.paddingLeft=m.offsetWidth+"px";var y=this.getElementById(this.id+"_groupbyFilterBox_apply"),b=this.getElementById(this.id+"_groupbyFilterBox_delete");y.onclick=function(){var e=WebSquare.idCache[t];this.checked?e.applyFilterHistory():e.groupbyStatus.grouped?e.clearGroupby():e._dataList.clearFilter()},b.onclick=function(){WebSquare.idCache[t].clearFilterHistory()},this.handlerResize_drawInitializer()}}catch(t){s.Y.printStackTrace(t)}},D.prototype.getCellInputType=function(t,e){try{var i=this.getCellInfo(e);if("custom"==i.options.inputType){var o=this.getRealRowIndex(t);return i.cellManagerHashByRowIndex[o].options.inputType}return i.options.inputType}catch(t){s.Y.printStackTrace(t)}},D.prototype.setCellOption=function(t,e,i,o){var s=this.getColumnIndex(e),r=this.getExtraDataObj("cell",t,s);if("viewType"===i)r.key=o,this.rowIndex>=0&&this.drawCellData(t-this.rowIndex,t,s);else{var a=WebSquare.language.getMessage("Grid_warning4",this.id,i)||"["+this.id+"] Changing setting "+i+" is not currently supported.";$l(a)}},D.prototype.getCellOption=function(t,e,i){var o=this.getColumnIndex(e),s=this.getCellInfo(e);if("custom"!=s.options.inputType){var r=this.getExtraDataObj("cell",t,o);return null==r.key?s.options[i]:r.key}
var a=s.cellManagerHashByRowIndex[t];if(a)return a.options[i]},D.prototype.getCustomCellOptions=function(t,e){try{var i=this.getCellInfo(e),o={};if("custom"==i.options.inputType){var r=this.getRealRowIndex(t),a=i.cellManagerHashByRowIndex[r];for(var n in a.initializeInfo)"id"!=n&&"displayRowIndex"!=n&&"realRowIndex"!=n&&(o[n]=a.initializeInfo[n])}return o}catch(t){s.Y.printStackTrace(t)}},D.prototype.ungroupColumn=function(t){try{if(this.groupbyStatus.grouped){var e;"string"==typeof t?e=this.getColumnIndex(t):"number"==typeof t&&(e=t);for(var i=!0,o=this.groupbyStatus.sortIndexArr.length-1;o>=0;o--)if(this.groupbyStatus.sortIndexArr[o]==e){this.groupbyStatus.sortIndexArr.splice(o,1),this.groupbyStatus.sortOrderArr.splice(o,1),delete this.groupbyStatus.filter[this.getColumnID(e)],i=!1;break}if(i)return;if(this.groupbyFilterList&&this.groupbyFilterList.filterHistory.column.length>0)if(this.groupbyFilterList.filterHistory.column[0]===this.getColumnID(e))this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift();else{var r=this.groupbyFilterList.filterHistory.column.length,a=this.groupbyFilterList.filterHistory.filteredRowIndexArr[r-1].slice(0),n=0;for(o=0;o<r;o++)if(this.groupbyFilterList.filterHistory.column[o]===this.getColumnID(e)){this.groupbyFilterList.filterHistory.column.splice(o,1),this.groupbyFilterList.filterHistory.filteredRowIndexArr.splice(o,1),n=1;break}for(o=0;o<r-n;o++)this.groupbyFilterList.filterHistory.filteredRowIndexArr[o]=a}if(this.clearSearchData({clearValue:!0}),0==this.groupbyStatus.sortIndexArr.length)this.clearGroupby();else{var l=this.groupbyDisplayOptions;l.filter=this.groupbyStatus.filter,l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(l)}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.changeGroupDepth=function(t,e){try{if(this.groupbyStatus.grouped){var i,o,r,a;"string"==typeof t?i=this.getColumnIndex(t):"number"==typeof t&&(i=t),"string"==typeof e?o=this.getColumnIndex(e):"number"==typeof e&&(o=e);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)this.groupbyStatus.sortIndexArr[n]==i&&(a=n),this.groupbyStatus.sortIndexArr[n]==o&&(r=n);if("number"!=typeof a||"number"!=typeof r||a==r)return;this.groupbyStatus.sortIndexArr.splice(a,1),this.groupbyStatus.sortIndexArr.splice(r,0,i);var l=this.groupbyStatus.sortOrderArr.splice(a,1);this.groupbyStatus.sortOrderArr.splice(r,0,l);var h=this.groupbyDisplayOptions;h.filter=this.groupbyStatus.filter,h.sortIndex=this.groupbyStatus.sortIndexArr,h.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(h)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.removeGroupbyFilterList=function(){try{this.groupbyFilterList&&this.groupbyFilterList.remove()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getGroupbyDisplayRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyDisplayRowIndex(t,e):t}catch(e){return s.Y.printStackTrace(e,null,this),t}},D.prototype.__getGroupbyDisplayRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;var i=this._dataList.getFilteredRowIndex(this.getRealRowIndex(t));return null==i&&!0!==e&&(i=t),i}catch(e){return s.Y.printStackTrace(e,null,this),t}},D.prototype._getGroupbyGroupedRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyGroupedRowIndex(t,e):t}catch(e){return s.Y.printStackTrace(e,null,this),t}},D.prototype.__getGroupbyGroupedRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;for(var i,o=this._dataList.getRealRowIndex(t),r=0;r<this.groupbyStatus.groupedRowIndexArr.length;r++)if(o===this.groupbyStatus.groupedRowIndexArr[r]){i=r;break}return null==i&&!0!==e&&(i=t),i}catch(e){return s.Y.printStackTrace(e,null,this),t}},D.prototype.isEditing=function(){try{return!!this.editedCell}catch(t){s.Y.printStackTrace(t,null,this)}},
D.prototype.readExcelFile=function(t,e,i,o,s,r,a,n){this.readFile(t,e,i,o,s,"excel",null,r,a,n)},D.prototype.readFile=function(t,e,i,o,s,r,a,n,l,h){o=void 0===o||"string"!=typeof o?this.options.excelUploadPopupURL:this.getURL(o),void 0!==s&&"string"==typeof s||(s="top=280,height=80,left=160,width=400,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no"),o+=1==(t=parseInt(t,10))?"?header=true":"?header=false",o+=1==(e=parseInt(e,10))?"&append=true":"&append=false",o+=1==n?"&fillHidden=true":"&fillHidden=false",o+=1==(i=parseInt(i,10))?"&hidden=true":"&hidden=false",o+=1==(h=h||0)?"&type=true":"&type=false",a&&(o+="&"+a),o+="&action="+this.options.excelUploadURL,o+="&gridID="+this.id;for(var d=[],p=this.defaultColCnt;p<this.hiddenList.length;p++)1==this.hiddenList[p]&&d.push(p-this.defaultColCnt);o+="&columnNum="+this.getTotalCol(),o+="&expressionColumns="+this.getExpressionColumnArr().join(","),o+="&hiddenColumns="+d.join(","),o+="&headerRows="+this.getElementById(this.id+"_head_table").rows.length,o+=l?"&gridStartRow="+l:"&gridStartRow=1",WebSquare.domain&&(o+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain)),window.open(o,"fileupWindow",s)},D.prototype.getExpressionColumnArr=function(t){var e,i=[];e=t&&"1"==t.ignoreSpan?this.getColCnt():this.getTotalCol();for(var o=0;o<e;o++)"expression"==this.getCellInfo(o).options.inputType?i.push("true"):i.push("false");return i},D.prototype.saveExcelFile=function(t,e,i,o,s,r,a,n){var l={};l.fileName=t,l.hidden=e,l.checkButton=i,l.type=o,l.hiddenExpand=s,l.saveList=r,l.useEuroLocale=a,l.httpReadOnly=n,this.saveExcel(l)},D.prototype.saveExcel=function(t){var e=t.processMsg;e&&e.length>0?WebSquare.layer.showProcessMessage(e,{scope:this.scope_id||""}):WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""});for(var i=t.fileName||"default",o=t.hidden||0,s=t.checkButton||0,a=t.type+""||"0",n=t.hiddenExpand||0,l=t.saveList||[],h=t.useEuroLocale||"false",d=t.password||"",p=new R.r.Hashtable,u=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],c=WebSquare.Elem.api.getElementsByTagName(u,"w2:column"),g=0;g<c.length;g++){var f=c[g],m=f.getAttribute("id");f.setAttribute("value",this.getHeaderValue(m))}if(p.put("style",WebSquare.xml.serialize(this.element._element)),"0"==a||""==a)p.put("data",this.getExcelAllXML()),p.put("footer_data",this.getExcelAllFooterXML());else if("2"==a){var y=this.getExcelAllXMLRaw();p.put("data",y),p.put("footer_data",this.getExcelAllFooterXMLRaw())}else{y=this.getExcelAllXMLDisplay(a);p.put("data",y),p.put("footer_data",this.getExcelAllFooterXMLDisplay())}var b=[];for(g=0;g<this.getTotalCol();g++){var v=this.getCellInfo(g).options.inputType;"checkbox"!=v&&"radio"!=v&&"button"!=v||b.push('"'+g+'"')}p.put("hiddenArr",this.getHiddenColumnArr()),p.put("fileName",i),p.put("hidden",o),p.put("checkButton",s),p.put("type",a),p.put("rowNumVisible",this.options.rowNumVisible+"");var w=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var C=this.getLocaleValue(this.options.rowNumLocaleRef);C&&(w=C)}p.put("rowNumHeaderValue",w),p.put("hiddenExpand",n),p.put("checkButtonArr","<array><![CDATA[["+b.join(",")+"]]]></array>"),p.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),p.put("useEuroLocale",h),p.put("password",d),t.scopeId=this.scope_id||"",r.I.excelDownload(this.options.excelDownloadURL,p.toString(),"post",t)},D.prototype.saveExcelFile2=function(t,e,i,o,s,r){var a={};if(a.fileName=t,a.type=o,e+""=="0"){for(var n=[],l=this.defaultColCnt;l<this.hiddenList.length;l++)this.hiddenList[l]&&n.push(l-this.defaultColCnt);a.removeColumns=n.join(",")}var h=[];if(i+""=="0")for(l=0;l<this.getTotalCol();l++){var d=this.getCellInfo(l).options.inputType;"checkbox"!=d&&"radio"!=d&&"button"!=d||h.push(this.getCellInfo(l).options.colIndex-this.defaultColCnt)}
for(l=this.defaultColCnt;l<this.hiddenList.length;l++)e+""=="1"&&s+""=="0"&&1==this.hiddenList[l]&&h.push(l-this.defaultColCnt);a.foldColumns=h.join(","),this.advancedExcelDownload(a)},D.prototype.getHiddenColumnArr=function(){for(var t=[],e=this.defaultColCnt;e<this.hiddenList.length;e++)t.push(this.hiddenList[e]);return'<array><![CDATA[["'+t.join('","')+'"]]]></array>'},D.prototype.fireFileReadEnd=function(t){var e=this;setTimeout((function(){d.f.fireEvent(e,"onfilereadend",t)}),10)},D.prototype.readCSV=function(t){var e={};t=t||{};e.wframe=t.wframe||!1;var i=t.type||"1",s=t.delim||",",n=t.escapeChar||"",l=t.header||"1",h=t.footer||"1",d=t.startRowIndex||"0",p=t.startColumnIndex||"0",u=t.append||"0",c=t.hidden||"0",g=t.advancedHidden||"0",f=t.fillHidden||"0",m=t.skipSpace||"0",y=t.removeColumns||"",b=t.optionParam||"",v=document.location.protocol+"//"+document.location.host+"/",w=t.popupUrl?v+t.popupUrl:o.q.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.js"),C=t.popupUrl||this.options.csvUploadPopupURL;C+="?";var I,_=t.processMsg||"",x="";if(e.name=t.name||"FILE UPLOAD",this.options.dataList){var S=this.modelControl.getDataComp(this.options.dataList);null!=S&&(x=S.id)}var R=t.status||"R",D=t.expression||"1",T=t.ignoreSpan||"0",L=t.maxFileSize||-1,k=t.csvUploadURL||t.action||"",F=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",A=t.columnOrder||"",E=t.useModalDisable||"false",M=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false",O=t.filePath||"",N=t.trim||"0";if(t.useDialog=t.useDialog+""!="false",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,void 0===t.features||"string"!=typeof t.features)I="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else if(1==t.wframe){for(var H=t.features.split(","),G={},B=0;B<H.length;B++)0!=H[B].toLowerCase().indexOf("top")?0!=H[B].toLowerCase().indexOf("left")?0!=H[B].toLowerCase().indexOf("height")?0!=H[B].toLowerCase().indexOf("width")||(G.width=parseInt(H[B].split("=")[1])):G.height=parseInt(H[B].split("=")[1]):G.left=parseInt(H[B].split("=")[1]):G.top=parseInt(H[B].split("=")[1]);I=G}else I=t.features;e.sFeatures=I,l=parseInt(l,10),u=parseInt(u,10),c=parseInt(c,10),i=i||0,e.type=1==i?"true":"false",e.uploadType=i,e.delim=s,e.escapeChar=n,e.header=1==l?"true":"false",e.footer=1==h?"true":"false",e.append=1==u?"true":"false",e.hidden=1==c?"true":"false",1==g?(C+="&advancedHidden=true",e.advancedHidden="true"):(C+="&advancedHidden=false",e.advancedHidden="false"),e.fillHidden=1==f?"true":"false",e.skipSpace=1==m?"true":"false",e.removeColumns=y,e.optionParam=b,C+="&gridID="+this.id,e.gridID=this.id;var W=[];for(B=this.defaultColCnt;B<this.hiddenList.length;B++)1==this.hiddenList[B]&&W.push(B-this.defaultColCnt);var V=this.getExpressionColumnArr(t);e.expressionColumns=V.join(","),e.columnNum=V.length,e.hiddenColumns=W.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=d||"1",e.gridStartCol=p||"1",WebSquare.domain?(C+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain),e.domain=WebSquare.text.URLEncoder(WebSquare.domain)):e.domain="";var q,Y=t.msaName||this._getMsaName()||"";if(""!=Y){var Z="";""!=k&&(Z=k),k=r.I.getServletURL(this,Y,"csvToXML.wq",Z),F=!0}if(""==k&&(k=this.options.csvUploadURL),e.msaName=Y,e.action=k,e.processMsg=WebSquare.text.BASE64URLEncoder(_),e.dataList=x,1==T){var j=[],P={},z=0;for(B=0;B<this.cellIdList.length;B++){for(var U=this.cellInfoHash[this.cellIdList[B]],X=parseInt(U.options.rowSpan)||1,K=parseInt(U.options.colSpan)||1,J=z,$=0;$<this.getRowCount()*this.getColCnt()&&j[J+$];$++)z++;for(var Q=0;Q<K;Q++){var tt=z;j[tt]=U.id,P[tt]=!0;for($=1;$<X;$++){var et=z+$*this.getColCnt();j[et]=U.id,P[et]=!0}z+=1}}q=j.join(",")}else q=this.cellIdList.join(",");e.columnIds=q,e.expression=1==D?"false":"true",e.status=R,e.maxFileSize=L,e.postMsg=F,
e.columnOrder=A,e.useModalDisable=E,e.useXHR=M,e.filePath=O,e.useDialog=t.useDialog,e.trim=1==N?"true":"false";var it=a.Z.getBoolean(e.wframe);if(this._csvUploadInfo=JSON.stringify(e),0==t.useDialog){var ot=new FormData;ot.append("type",e.type),ot.append("uploadType",e.uploadType),ot.append("delim",e.delim),ot.append("escapeChar",e.escapeChar),ot.append("header",e.header),ot.append("footer",e.footer),ot.append("append",e.append),ot.append("hidden",e.hidden),ot.append("fillHidden",e.fillHidden),ot.append("advancedHidden",e.advancedHidden),ot.append("skipSpace",e.skipSpace),ot.append("removeColumns",e.removeColumns),ot.append("action",e.action),ot.append("gridID",e.gridID),ot.append("columnNum",e.columnNum),ot.append("expressionColumns",e.expressionColumns),ot.append("hiddenColumns",e.hiddenColumns),ot.append("headerRows",e.headerRows);var st=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),rt=WebSquare.Elem.api.getElementsByTagName(st[0],"w2:row");ot.append("bodyRows",rt.length),ot.append("headerRows",e.headerRows),ot.append("gridStartRow",e.gridStartRow);var at="";at="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),ot.append("gridStyle",at),ot.append("columnIds",e.columnIds),ot.append("dataList",e.dataList),ot.append("expression",e.expression),ot.append("status",e.status),ot.append("optionParam",e.optionParam),ot.append("columnOrder",e.columnOrder),ot.append("useXHR",e.useXHR),ot.append("filePath",e.filePath),ot.append("useDialog",e.useDialog),_&&_.length>0?WebSquare.layer.showProcessMessage(_,t):WebSquare.layer.showProcessMessage("upload...",t);var nt=this,lt=new XMLHttpRequest;lt.onreadystatechange=function(){if(4==lt.readyState)if(200==lt.status)try{var i=lt.responseText,o=WebSquare.xml.parse(i),s=o.getElementsByTagName("Exception");if(s.length>0){var r,n=o.getElementsByTagName("deniedCodeList")[0],l="";if("102"==(l=void 0===n||null==l||void 0===(l=n.firstChild)||null==l||""==l?"":l.nodeValue))h=Upload_msg2;else{var h=o.getElementsByTagName("message")[0].firstChild;h=WebSquare.language.getMessage("Upload_msg3")}(r=t.onFailureCallback||null)&&r(e.action,h)}else{var d=o.getElementsByTagName("array")[0].firstChild.nodeValue;"string"==typeof e.append&&(e.append=a.Z.getBoolean(e.append));var p="",u={columnInfo:e.columnIds.split(","),data:d};if(""!=e.dataList){p=e.dataList;var c=a.Z.getComponentById(p),g=c.getRowCount();if(1==e.uploadType||2==e.uploadType?c.setArrayFile(u,e.append,e.gridID,e.uploadType):c.setArray(u,e.append),"C"==e.status){var f=c.getRowCount();e.append?c.modifyRangeStatus(g,f,"C"):c.modifyRangeStatus(0,f,"C")}}else{p=e.gridID;g=this.getRowCount();if(1==e.uploadType||2==e.uploadType?this.setDataFile(d,e.append,u.columnInfo,e.gridID,e.uploadType):this.setData(d,e.append),"C"==e.status){f=this.getRowCount();e.append?this.modifyRangeStatus(g,f,"C"):this.modifyRangeStatus(0,f,"C")}}var m=t.onSuccessCallback||null;m&&m(e.action);var y=O.split("\\");nt.fireFileReadEnd(y[y.length-1])}}catch(t){s.printStackTrace(t)}finally{WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}else(r=t.onFailureCallback||null)&&r(e.action),WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})},lt.open("POST",e.action,!0),lt.send(ot)}else if(!0===it){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),a.Z.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):a.Z.isIE(7)||a.Z.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):a.Z.isIE(9)||a.Z.isIE(10)?(e.sizeInfo.height=204,e.sizeInfo.width=446):a.Z.isIEAllVersion(11)?(e.sizeInfo.height=197,e.sizeInfo.width=455):a.Z.isSpartan()?(e.sizeInfo.height=178,
e.sizeInfo.width=446):a.Z.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=198,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=200,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):a.Z.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==typeof e.sFeatures&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var ht={type:"json",name:"csvPopupParam",data:e},dt={id:this.id+"_csvPop",type:"wframePopup",dataObject:ht,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:w,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};this.scope_obj&&WebSquare.idCache[this.scope_obj.uuid]&&(dt.scope_uuid=this.scope_obj.uuid),a.Z.openPopup(dt.popupUrl,dt)}else C=WebSquare.BootLoader.getEngineUri(C),window.open(C,"csvupWindow",e.sFeatures)},D.prototype.saveCSV=function(t){var e=t.maxCellCount||-1;if(-1!=(e=parseInt(e,10))&&e<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var i=WebSquare.language.getMessage("Grid_warning8",e)||"The cell count has exceeded the limit.\n The current limit is : "+e;return void alert(i)}var o=t.maxRowCount||-1;if(-1!=(o=parseInt(o,10))&&o<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){i=WebSquare.language.getMessage("Grid_warning10",o)||"The row count has exceeded the limit.\n The current limit is : "+o;return void alert(i)}WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var s=(t=t||{}).fileName||"csvfile.csv",n=t.type||"1",l=t.delim||";",h=t.displayDelim||"true",d=t.removeColumns||"",p=t.header||"1",u=t.hidden||"0",c=t.checkButton||"1",g=t.removeQuotation||"1",f=t.removeNewLine||"1",m=t.saveList||"",y=this.options.rowNumHeaderValue||"";this.options.useLocale&&this.options.rowNumLocaleRef&&((q=this.getLocaleValue(this.options.rowNumLocaleRef))&&(y=q));var b="";"1"!=t.rowNumVisible&&"true"!=t.rowNumVisible&&1!=t.rowNumVisible||(b=this.options.rowNumVisible||"false");var v=t.textTable||"false",w=t.textTableAlign||"right",C=t.useFooter||"false",I=t.columnMove+""=="true",_=t.columnOrder||"",x=t.optionParam||"",S=t.aposPrefixOnNum||"0",D=t.aposPrefixOnText||"0",T=t.ignoreSpan||"0",L=t.maxDataSize||-1;L=parseInt(L,10);var k=t.csvDownloadURL||t.action||"",F=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=F+""=="true";for(var A=t.openFile||"false",E=t.sameSite||"",M=t.useHeaderCheckBoxLabel+""=="true",O=t.opencsv+""=="true",N=t.msaName||"",H=t.trim||"0",G=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],B=WebSquare.Elem.api.getElementsByTagName(G,"w2:column"),W=0;W<B.length;W++){var V=B[W];if("checkbox"===V.getAttribute("inputType")&&!0===M){var q,Y=V.getAttribute("checkboxLabel")||V.getAttribute("value"),Z=V.getAttribute("localeRef");if(this.options.useLocale&&Z)(q=this.getLocaleValue(Z))&&(Y=q)
;V.setAttribute("value",Y+"")}else{var j=V.getAttribute("id");V.setAttribute("value",this.getHeaderValue(j)+"")}}var P=new R.r.Hashtable,z="",U=(z="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element)).indexOf("<w2:gridView");if(z.indexOf("xmlns:w2")<0&&U>=0){var X=" xmlns:w2='"+WebSquare.core._XML_NAMESPACE.W2+"' ";U+=12,z=z.slice(0,U)+X+z.slice(U)}P.put("style",z),"0"==n?(P.put("data",this.getExcelAllXML()),"true"==C?P.put("footer_data",this.getExcelAllFooterXML()):P.put("footer_data","<array><![CDATA[[]]]></array>")):(P.put("data",this.getExcelAllXMLDisplay(n)),"true"==C?P.put("footer_data",this.getExcelAllFooterXMLDisplay()):P.put("footer_data","<array><![CDATA[[]]]></array>"));var K,J=[];for(W=0;W<this.getTotalCol();W++){var $=this.getCellInfo(W).options.inputType;"checkbox"!=$&&"radio"!=$&&"button"!=$||J.push('"'+W+'"')}I&&(K=""==_?this.getColumnOrder()||"":_.split(","));var Q=[];if(""!=d){var tt=(d+="").split(",");if(I)for(W=0;W<tt.length;W++)for(var et=0;et<K.length;et++)tt[W]==K[et]&&Q.push(et);else Q=tt;Q.sort((function(t,e){return 1*t-1*e})),d=Q.join(",")}var it=d;it='"'+it.wq_replaceAll(",",'","')+'"',P.put("hiddenArr",this.getHiddenColumnArr()),P.put("fileName",s),P.put("hidden",u),P.put("checkButton",c),P.put("type",n),P.put("rowNumVisible",b),P.put("rowNumHeaderValue",y),P.put("removeQuotation",g),P.put("delim",l),P.put("displayDelim",h),P.put("header",p),P.put("textTable",v),P.put("textTableAlign",w),P.put("useFooter",C),P.put("columnMove",I),P.put("columnOrder",K),P.put("optionParam",x),P.put("aposPrefixOnNum",S),P.put("aposPrefixOnText",D),P.put("ignoreSpan",T),P.put("removeNewLine",f),P.put("checkButtonArr","<array><![CDATA[["+J.join(",")+"]]]></array>"),""!=m&&P.put("saveList",'<array><![CDATA[["'+m.join('","')+'"]]]></array>'),P.put("removeColumns","<array><![CDATA[["+it+"]]]></array>"),P.put("openFile",A),""!=E&&P.put("sameSite",E),P.put("opencsv",O),""!=(N=N||this._getMsaName()||"")&&(F="true"),P.put("useXHR",F),P.put("msaName",N),P.put("trim",H);var ot=P.toString();if(-1!=L&&L<a.Z.getByteLengthUtf8(ot)){i=WebSquare.language.getMessage("Grid_warning9",L)||"he data size has exceeded the limit.\n The current limit is : "+e+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(i)}if(""!=N){var st="";""!=k&&(st=k),k=r.I.getServletURL(this,N,"xmlToCSV.wq",st),t.useXHR=!0}""==k&&(k=this.options.csvDownloadURL),t.scopeId=this.scope_id||"",r.I.excelDownload(k,ot,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0))},D.prototype.saveCSVFile=function(t,e,i,o,s,a,n,l,h){WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),n+="";var d=new R.r.Hashtable,p="";p="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),d.put("style",p),"0"==n||""==n?(d.put("data",this.getExcelAllXML()),d.put("footer_data",this.getExcelAllFooterXML())):(d.put("data",this.getExcelAllXMLDisplay(n)),d.put("footer_data",this.getExcelAllFooterXMLDisplay()));for(var u=[],c=0;c<this.getTotalCol();c++){var g=this.getCellInfo(c).options.inputType;"checkbox"!=g&&"radio"!=g&&"button"!=g||u.push('"'+c+'"')}var f=h||"";f='"'+f.wq_replaceAll(",",'","')+'"',d.put("hiddenArr",this.getHiddenColumnArr()),d.put("fileName",t),d.put("hidden",o),d.put("checkButton","1"),d.put("type",n),d.put("rowNumVisible",this.options.rowNumVisible);var m=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){
var y=this.getLocaleValue(this.options.rowNumLocaleRef);y&&(m=y)}d.put("rowNumHeaderValue",m),d.put("removeQuotation",a),d.put("delim",e),d.put("header",i),d.put("checkButtonArr","<array><![CDATA[["+u.join(",")+"]]]></array>"),void 0!==l&&l&&d.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),d.put("removeColumns","<array><![CDATA[["+f+"]]]></array>"),r.I.excelDownload(this.options.csvDownloadURL,d.toString(),"post",{scopeId:this.scope_id||""})},D.prototype.getExcelUploadInfo=function(t){var e={},i=(t=t||{}).type||"0",o=t.removeColumns||"",s=t.startRowIndex||"0",a=t.startColumnIndex||"0",n=t.endColumnIndex||"-1",l=t.ignoreStartRowIndexInSAX+""||"1",h=t.ignoreStartColumnIndexInSAX+""||"1",d=t.sheetNo||"0",p=t.sheetName||"",u=t.activeSheet||!1,c=t.headerExist||"0";0===t.footerExist&&(t.footerExist="0");var g=t.footerExist||"1",f=t.append||"0",m=t.hidden||"0",y=t.fillHidden||"0",b=t.optionParam||"",v=t.skipSpace||"0",w=t.readUntilEmptyRow||"0",C=t.insertColumns||[],I=t.processMsg||"",_="";if(this.options.dataList){var x=this.modelControl.getDataComp(this.options.dataList);null!=x&&(_=x.id)}var S=t.status||"R",R=t.delim||",",D="",T="",L="",k=t.pwd||"",F=t.loadingMode||"",A=t.maxFileSize||"-1",E=t.cellDataConvertor||"",M=t.decimal||"4",O=t.applyDecimal||"0",N=t.useModalDisable||"false",H=t.useMaxByteLength||"false",G=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",B=t.dateFormat||"yyyy-MM-dd",W=t.byteCheckEncoding||"EUC-KR",V=t.columnOrder||"",q=t.columnMove+""=="true",Y=t.chunkNum||0,Z=t.trim||0,j=t.useXHR+""=="true",P=t.filePath||"";t.useDialog=t.useDialog+""!="false";for(var z=t.countSkipRow||"",U=0;U<C.length;U++){var X=C[U],K=X.columnIndex+""||"",J=X.columnValue+""||"";""!=K&&(D=D+T+K+","+J,T="|")}if(void 0===t.features||"string"!=typeof t.features)L="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else{var $=t.features.split(","),Q={};for(U=0;U<$.length;U++)0!=$[U].toLowerCase().indexOf("top")?0!=$[U].toLowerCase().indexOf("left")?0!=$[U].toLowerCase().indexOf("height")?0!=$[U].toLowerCase().indexOf("width")||(Q.width=parseInt($[U].split("=")[1])):Q.height=parseInt($[U].split("=")[1]):Q.left=parseInt($[U].split("=")[1]):Q.top=parseInt($[U].split("=")[1]);1==t.wframe?L=Q:(L=t.features,e.userFeatures=Q)}e.sFeatures=L,c=parseInt(c,10),f=parseInt(f,10),m=parseInt(m,10),g=parseInt(g,10),e.header=1==c?"true":"false",e.footer=1==g?"true":"false",e.append=1==f?"true":"false",e.removeColumns=o,e.fillHidden=1==y?"true":"false",e.hidden=1==m?"true":"false",e.type=1==i?"true":"false",e.uploadType=i,e.skipSpace=1==v?"true":"false",e.readUntilEmptyRow=1==w?"true":"false",e.insertColumns=D,e.optionParam=b;var tt=t.advancedExcelUploadURL||t.action||"";e.action=tt||this.options.advancedExcelUploadURL;var et=t.msaName||this._getMsaName()||"";if(""!=et){var it="";tt&&(it=tt),e.action=r.I.getServletURL(this,et,"excelToGrid2.wq",it),G=!0}e.gridID=this.id;var ot=[];for(U=this.defaultColCnt;U<this.hiddenList.length;U++)1==this.hiddenList[U]&&ot.push(U-this.defaultColCnt);if(e.columnNum=this.getTotalCol(),e.expressionColumns=this.getExpressionColumnArr().join(","),e.hiddenColumns=ot.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=s||"1",e.gridStartCol=a||"1",e.gridEndCol=n,e.ignoreStartRowIndexInSAX="0"==l?"true":"false",e.ignoreStartColumnIndexInSAX="0"==h?"true":"false",e.gridSheetNo=d||"0",e.gridSheetName=p,e.activeSheet=u,e.applyDecimal="0"==O?"false":"true",WebSquare.domain&&(e.domain=WebSquare.text.URLEncoder(WebSquare.domain)),e.processMsg=WebSquare.text.BASE64URLEncoder(I),e.delim=R,e.dataList=_,!0===q){var st=this.htmlInfo.body.rowAttrArr.length,rt=this.getColumnOrder(),at=rt.length,nt=new Array(at);for(U=0;U<st;U++)for(var lt=0;lt<at;lt++)nt[at*U+lt]=this.getColumnID(at*U+rt[lt]);e.columnIds=nt.join(",")}else e.columnIds=this.cellIdList.join(",");return e.trim=1==Z,e.countSkipRow=1==z,
e.status=S,e.pwd=k,e.loadingMode=F,e.maxFileSize=A,e.cellDataConvertor=E,e.decimal=M,e.useModalDisable=N+"",e.useMaxByteLength=H+"",e.postMsg=G+"",e.dateFormat=B,e.byteCheckEncoding=W,e.columnOrder=V,e.wframe=t.wframe||!1,e.name=t.name||"FILE UPLOAD",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,e.chunkNum=parseInt(Y,10),e.useXHR=j,e.filePath=P,e.useDialog=t.useDialog,e.msaName=et,t.convertIndex&&(t.convertIndex=t.convertIndex.wq_replaceAll(" ",""),e.convertIndexArr=t.convertIndex.split(",")),"grid"==this.initializeType&&this.options.ref&&t.instanceBind&&(e.instanceBind=t.instanceBind),e},D.prototype.advancedExcelUpload=function(t){var e=this.getExcelUploadInfo(t),i=t.popupUrl||this.options.advancedExcelUploadPopupURL,s=document.location.protocol+"//"+document.location.host+"/",r=t.popupUrl?s+t.popupUrl:o.q.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.js"),n=t.advancedHidden||"0",l="";i+="?gridID="+e.gridID,WebSquare.domain&&(i+="&domain="+e.domain),1==n?(i+="&advancedHidden=true",e.advancedHidden="true"):(i+="&advancedHidden=false",e.advancedHidden="false"),""!=e.pwd&&(l=WebSquare.text.BASE64Encoder(e.pwd)),e.pwd=l;var h=a.Z.getBoolean(e.wframe);if(this._excelUploadInfo=JSON.stringify(e),0==t.useDialog){var d=new FormData;d.append("header",e.header),d.append("footer",e.footer),d.append("append",e.append),d.append("hidden",e.hidden),d.append("columnNum",e.columnNum),d.append("hiddenColumns",e.hiddenColumns),d.append("removeColumns",e.removeColumns),d.append("headerRows",e.headerRows);var p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),u=WebSquare.Elem.api.getElementsByTagName(p[0],"w2:row");d.append("bodyRows",u.length),d.append("delim",e.delim),d.append("fillHidden",e.fillHidden),d.append("gridStartRow",e.gridStartRow),d.append("gridStartCol",e.gridStartCol),d.append("gridEndCol",e.gridEndCol),d.append("gridEndCol",e.gridEndCol),d.append("gridSheetNo",e.gridSheetNo),d.append("gridSheetName",e.gridSheetName),d.append("activeSheet",e.activeSheet),d.append("expressionColumns",e.expressionColumns);var c="";c="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),d.append("gridStyle",c),d.append("type",e.type),d.append("uploadType",e.uploadType),d.append("skipSpace",e.skipSpace),d.append("insertColumns",e.insertColumns),d.append("dataList",e.dataList),d.append("instanceBind",e.instanceBind),d.append("columnIds",e.columnIds),d.append("status",e.status),d.append("pwd",e.pwd),d.append("loadingMode",e.loadingMode),d.append("optionParam",e.optionParam),d.append("cellDataConvertor",e.cellDataConvertor),d.append("decimal",e.decimal),d.append("applyDecimal",e.applyDecimal),d.append("useMaxByteLength",e.useMaxByteLength),d.append("dateFormat",e.dateFormat),d.append("byteCheckEncoding",e.byteCheckEncoding),d.append("columnOrder",e.columnOrder),d.append("chunkNum",e.chunkNum||0),d.append("trim",e.trim),d.append("useXHR",e.useXHR),d.append("filePath",e.filePath),d.append("useDialog",e.useDialog),d.append("countSkipRow",e.countSkipRow);var g=WebSquare.text.BASE64URLDecoder(e.processMsg);g&&g.length>0?WebSquare.layer.showProcessMessage(g,t):WebSquare.layer.showProcessMessage("upload...",t);var f=this,m=new XMLHttpRequest;m.onreadystatechange=function(){if(4==m.readyState)if(200==m.status){var i=m.responseText;try{var o=WebSquare.xml.parse(i),s=o.getElementsByTagName("Exception");if(s.length>0){var r=o.getElementsByTagName("deniedCodeList")[0],n="";if(void 0===r?n="":void 0!==(n=WebSquare.xml.getTextNodeValue(r))&&null!=n&&""!=n||(n=""),
"102"==n)l=WebSquare.language.getMessage("Upload_msg2");else if("101"==n)l=WebSquare.language.getMessage("Upload_msg9");else if("200"==n)l=WebSquare.language.getMessage("Upload_msg10");else if("201"==n)l=WebSquare.language.getMessage("Upload_msg11");else if("202"==n)l=WebSquare.language.getMessage("Upload_msg8");else if("203"==n)l=WebSquare.language.getMessage("Upload_msg12");else if("204"==n)l=WebSquare.language.getMessage("Upload_msg13");else if("205"==n)l=WebSquare.language.getMessage("Upload_msg14");else if("206"==n)l=WebSquare.language.getMessage("Upload_msg15");else if("207"==n)l=WebSquare.language.getMessage("Upload_msg16");else if("208"==n)l=WebSquare.language.getMessage("Upload_msg17");else{var l=WebSquare.xml.getTextNodeValue(o.getElementsByTagName("message")[0]);void 0!==l&&null!=l&&""!=l||(l=WebSquare.language.getMessage("Upload_msg3"))}(b=t.onFailureCallback||null)&&b(e.action,l)}else{var h=o.getElementsByTagName("array")[0].firstChild.nodeValue;"string"==typeof e.append&&(e.append=a.Z.getBoolean(e.append));var d={columnInfo:e.columnIds.split(","),data:h};if(""!=e.dataList){var p=a.Z.getComponentById(e.dataList);d.data=d.data.replaceAll("\\n","\n");var u=p.getRowCount();if(1==e.uploadType||2==e.uploadType?","!=e.delim?p.setArrayFile(d,e.append,e.gridID,e.uploadType,e.delim):p.setArrayFile(d,e.append,e.gridID,e.uploadType):0==e.uploadType&&(","!=e.delim?p.setArray(d,e.append,null,null,e.delim):p.setArray(d,e.append)),"C"==e.status){var c=p.getRowCount();e.append?p.modifyRangeStatus(u,c,"C"):p.modifyRangeStatus(0,c,"C")}}else{u=this.getRowCount();if(!this.options.ref||1!=e.instanceBind&&"true"!=e.instanceBind?1==e.uploadType||2==e.uploadType?this.setDataFile(h,e.append):0==uploadType&&this.setData(h,e.append):(this.options.instanceBindBySetData=!0,1==e.uploadType||2==e.uploadType?this.setDataFile(h,e.append):0==e.uploadType&&this.setData(h,e.append),this.options.instanceBindBySetData=!1),"C"==e.status){c=this.getRowCount();e.append?this.modifyRangeStatus(u,c,"C"):this.modifyRangeStatus(0,c,"C")}}var g=t.onSuccessCallback||null;g&&g(e.action);var y=t.filePath.split("\\");f.fireFileReadEnd(y[y.length-1])}}catch(t){s.printStackTrace(t)}finally{WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}}else{var b;(b=t.onFailureCallback||null)&&b(e.action),WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}},m.open("POST",e.action,!0),m.send(d)}else if(!0===h){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),a.Z.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):a.Z.isIE(7)||a.Z.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):a.Z.isIE(9)?(e.sizeInfo.height=204,e.sizeInfo.width=446):a.Z.isIE(10)?(e.sizeInfo.height=162,e.sizeInfo.width=455):a.Z.isIEAllVersion(11)?(e.sizeInfo.height=198,e.sizeInfo.width=455):a.Z.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):a.Z.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=164,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):a.Z.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==typeof e.sFeatures&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var y={type:"json",name:"popupParam",data:e
},b={id:this.id+"_excelPop",type:"wframePopup",dataObject:y,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,useModalStack:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:r,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};a.Z.openPopup(b.popupUrl,b)}else i=WebSquare.BootLoader.getEngineUri(i),window.open(i,"fileupWindow",e.sFeatures)},D.prototype.advancedExcelDownload=function(t,e){try{var i=t.maxCellCount||-1;if(-1!=(i=parseInt(i,10)))if(i<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var o=WebSquare.language.getMessage("Grid_warning8",i)||"The cell count has exceeded the limit.\n The current limit is : "+i;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}var r=t.maxRowCount||-1;if(-1!=(r=parseInt(r,10)))if(r<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){o=WebSquare.language.getMessage("Grid_warning10",r)||"The row count has exceeded the limit.\n The current limit is : "+r;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var a=parseInt(t.rowsByN);switch(t.rowsByN=a>100?a:100,t.dataLength=this.getDataLength(),t.multiexcel=!1,t.dataProvider=t.dataProvider||"",t.splitProvider=t.splitProvider||"",t.scope=this.scope_id||"",t.type+""){case"":case"0":t.type=0;break;case"2":t.type=2;break;default:t.type=1}if(!1===t.showProcess)WebSquare.getBody().showModal("w2modal_gridDownload");else if(!0===t.showConfirm)t.massStorage=!0,window.downloadGridId=this.id,WebSquare.getBody().showModal(),this.showSendExcelLayer();else{var n=t.processMsg;n&&n.length>0?WebSquare.layer.showProcessMessage(n,t):WebSquare.layer.showProcessMessage("download...",t)}if(0===t.type||1===t.type||2==t.type){t.cellInfo=[],t.isPlainDataCol=[],t.isSelectCol=[],t.isBasicCol=[],t.isExpCol=[],t.isCustomCol=[],t.isCustomModelCol=[],t.isCustomType=[],t.isEscapeFormatter=[];for(var l=this.oneRowDataLength,h=0;h<l;h++){var d=this.getCellInfo(h),p=d.options.inputType;t.cellInfo[h]=d,t.isCustomType[h]="custom"===p,t.isPlainDataCol[h]="checkbox"===p||"image"===p||"radio"===p,t.isSelectCol[h]="select"===p||"checkcombobox"===p||"autoComplete"===p,t.isExpCol[h]="expression"===p,t.isCustomCol[h]=d.useCustomFormatter,t.isCustomModelCol[h]=d.useCustomModelFormatter,t.isBasicCol[h]=!(t.isPlainDataCol[h]||t.isSelectCol[h]||t.isExpCol[h]||t.isCustomCol[h]||t.isCustomModelCol[h]||t.isCustomType[h]),t.isEscapeFormatter[h]=d.useEscapeFormatter}}if(t.dataHandler=t.dataHandler||"",""!=t.dataHandler){this.sendExcelData(t,e,"")}else this.makeExcelData(0,[],t,e)}catch(t){WebSquare.layer.hideProcessMessage(),s.Y.printStackTrace(t,null,this)}},D.prototype.showSendExcelLayer=function(){if(void 0!==window.gridExceldownloadIframe){window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.style.display="block";var t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.visibility="visible",window.gridExceldownloadIframe.contentWindow.initialize()}else{window.gridExceldownloadIframe=document.createElement("iframe"),window.gridExceldownloadIframe.style.visibility="hidden",
window.gridExceldownloadIframe.setAttribute("id","gridDownLoadLayer"),window.gridExceldownloadIframe.setAttribute("src",this.options.advancedExcelDownloadPopupURL),window.gridExceldownloadIframe.setAttribute("frameBorder","0"),window.gridExceldownloadIframe.className="w2grid_downloadIframe",window.gridExceldownloadIframe.style.width="300px",window.gridExceldownloadIframe.style.overflow="hidden",document.body.appendChild(window.gridExceldownloadIframe);t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.position="absolute",window.gridExceldownloadIframe.style.visibility="visible"}},D.prototype.checkUpload=function(){var t=this;setTimeout((function(){1==t.downloadInit?window.gridExceldownloadIframe.contentWindow.checkUpload("end"):t.checkUpload()}),10)},D.prototype.sendExcelData=function(t,e,i){try{"boolean"==typeof t.useFooter&&(t.useFooter=t.useFooter+"");var o=WebSquare.xml.encode(t.fileName)||"excel",s=t.extension||"";-1==o.indexOf(".")&&""!=s&&(o=o+"."+s);var n=t.sheetName||"sheet",l=t.type||"0",h="false";if(1==t.multiexcel){var d=t.multipleSheet;void 0===t.multipleSheet&&(d=""),h=d+""=="true"||d+""==""?"true":"false"}else h="false";var p=t.removeColumns||"",u=t.removeHeaderRows||"",c=t.foldColumns||"",g=t.startRowIndex||"0",f=t.startColumnIndex||"0",m=t.headerColor||"",y=t.headerFontName||"",b=t.headerFontSize||"",v=t.headerFontColor||"",w=t.headerFontBold||"",C=t.bodyColor||"",I=t.bodyFontName||"",_=t.bodyFontSize||"",x=t.bodyFontColor||"",S=t.bodyFontBold||"",R=t.footerColor||"",D=t.footerFontName||"",T=t.footerFontSize||"",L=t.footerFontColor||"",k=t.footerFontBold||"",F=t.subTotalColor||"",A=t.subTotalFontName||"",E=t.subTotalFontSize||"",M=t.subTotalFontColor||"",O=t.subTotalFontBold||"",N=t.rowNumHeaderColor||"",H=t.rowNumHeaderFontName||"",G=t.rowNumHeaderFontSize||"",B=t.rowNumHeaderFontColor||"",W=t.rowNumBodyColor||"",V=t.rowNumBodyFontName||"",q=t.rowNumBodyFontSize||"",Y=t.rowNumBodyFontColor||"",Z=t.rowNumFooterColor||"",j=t.rowNumFooterFontName||"",P=t.rowNumFooterFontSize||"",z=t.rowNumFooterFontColor||"",U=t.rowNumSubTotalColor||"",X=t.rowNumSubTotalFontName||"",K=t.rowNumSubTotalFontSize||"",J=t.rowNumSubTotalFontColor||"",$=t.groupbyColor||"";t.groupbyColor=$;var Q=t.groupbyFontName||"";t.groupbyFontName=Q;var tt=t.groupbyFontSize||"";t.groupbyFontSize=tt;var et=t.groupbyFontColor||"";t.groupbyFontColor=et;var it=t.dataProvider||"",ot=t.footerDataProvider||"",st=t.splitProvider||"",rt=t.providerRequestXml||"",at=t.userDataXml||"",nt=t.optionParam||"",lt=t.bodyWordwrap||"",ht=t.subtotalWordwrap||"",dt=t.footerWordwrap||"",pt=t.useEuroLocale||"false",ut=t.numberLocale||"",ct=t.useHeader||"true",gt=t.useSubTotal||"false",ft=t.useFooter||"true";t.printSet=t.printSet||{};var mt=t.printSet.fitToPage||"false",yt=t.printSet.landScape||"false",bt=t.printSet.fitWidth||"1",vt=t.printSet.fitHeight||"1",wt=t.printSet.scale||"100",Ct=t.printSet.pageSize||"A4",It=t.separator||",",_t=t.subTotalScale||-1,xt=t.subTotalRoundingMode||"",St=t.footerScale||-1,Rt=t.footerRoundingMode||"",Dt=t.useStyle+""=="true",Tt=t.useClass+""=="true";t.useClass=Tt;var Lt=t.setFontSize+""=="true",kt=t.freezePane||"",Ft=t.autoSizeColumn||"false",At=t.autoSizeAdjustWith||512,Et=t.displayGridlines||"",Mt=t.colMerge||"false",Ot=t.colMergeValue||"false",Nt=t.colMergeTextAlign||"center",Ht=t.useDataFormat||"false",Gt=t.useHeaderDataFormat||"",Bt=t.applyDataFormat||"false",Wt=t.customToDataType||"false",Vt=t.useSubTotalData+""=="true",qt=t.useFooterData+""=="true",Yt=t.calcFooter+""=="true",Zt=t.columnMove+""=="true",jt=t.columnOrder||"";Yt&&(Zt=!1)
;var Pt=t.columnMoveWithSubTotal||"",zt=t.columnMoveWithFooter||"",Ut=t.oddRowBackgroundColor||"",Xt=t.evenRowBackgroundColor||"",Kt=t.indent||"0",Jt=WebSquare.xml.encode(this.options.rowNumHeaderValue)||t.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef)(gi=this.getLocaleValue(this.options.rowNumLocaleRef))&&(Jt=gi);var $t=t.rowNumVisible+""=="true",Qt=this.options.startRowNumber||"1",te=t.bodyNumberDefaultValue||"",ee=t.numberToText||"false",ie=t.rowHeight||"-1",oe=t.headerRowHeight||"-1",se=t.maxDataSize||-1;se=parseInt(se,10);var re=t.pwd||"",ae=t.useImage||"false",ne=t.headerAutoFilter||"false",le=t.filterRowIndex||"-1",he=t.mergeCell+""=="true",de=t.noMerge+""=="true";t.httpReadOnly=t.httpReadOnly+""=="true";var pe=t.advancedExcelDownloadURL||t.action||"",ue=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=ue+""=="true";var ce,ge=t.openFile||"false",fe=t.macroFileName||"",me=t.useMacro||"false",ye=t.showDialog||"false",be=t.dialogFilter||"",ve=t.keepType||"false",we=t.useHeaderCheckBoxLabel+""=="true",Ce=t.lazyInfoArr||"false",Ie=t.decimal||"",_e=t.sameSite||"",xe=t.customProvider||"",Se=t.customProviderIndex||"",Re=t.rowAccessWindowSize||"",De=t.trim||"",Te=t.desc||"",Le=t.footerTop||"",ke=t.msaName||"",Fe=t.chart||{};if(Fe.chartName)var Ae=Fe.chartName||"line",Ee=Fe.chartType||"",Me=Fe.title||"",Oe=Fe.xTitle||"",Ne=Fe.yTitle||"",He=Fe.startRowIndex||0,Ge=Fe.startColIndex||0,Be=Fe.endRowIndex||0,We=Fe.endColIndex||0,Ve=Fe.serAxis||"true",qe=Fe.catAxis||"true",Ye=Fe.catAxisRange||{},Ze=Ye.startColIndex||0,je=Ye.startRowIndex||0,Pe=Ye.endColIndex||0,ze=Ye.endRowIndex||0,Ue=Fe.serAxisRange||{},Xe=Ue.startColIndex||0,Ke=Ue.startRowIndex||0,Je=Ue.endColIndex||0,$e=Ue.endRowIndex||0,Qe=Fe.dataAxisRange||{},ti=Qe.startColIndex||0,ei=Qe.startRowIndex||0,ii=Qe.endColIndex||0,oi=Qe.endRowIndex||0,si=Fe.catGridLines||"true",ri=Fe.serGridLines||"true",ai=Fe.legend||"true",ni=Fe.legendPosition||"bottom";Zt&&(ce=""==jt?this.getColumnOrder()||"":jt.split(","));var li=[];if(""!=p){var hi=(p+="").split(",");if(Zt)for(var di=0;di<hi.length;di++)for(var pi=0;pi<ce.length;pi++)hi[di]==ce[pi]&&li.push(pi);else li=hi;li.sort((function(t,e){return 1*t-1*e})),p=li.join(",")}var ui=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],ci=WebSquare.Elem.api.getElementsByTagName(ui,"w2:column");for(di=0;di<ci.length;di++){if("checkbox"===(Vi=ci[di]).getAttribute("inputType")&&!0===we){var gi,fi=Vi.getAttribute("checkboxLabel")||Vi.getAttribute("value"),mi=Vi.getAttribute("localeRef");if(this.options.useLocale&&mi)(gi=this.getLocaleValue(mi))&&(fi=gi);Vi.setAttribute("value",fi+"")}else{var yi=Vi.getAttribute("id");Vi.setAttribute("value",this.getHeaderValue2(yi)+"")}}var bi=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),vi=t.toTextIgnoreFormat,wi=!1;if(bi.length>0){var Ci=bi[0],Ii=WebSquare.Elem.api.getElementsByTagName(Ci,"w2:row");for(di=0;di<Ii.length;di++)for(ci=WebSquare.Elem.api.getElementsByTagName(Ii[di],"w2:column"),pi=0;pi<ci.length;pi++){yi=(Vi=ci[pi]).getAttribute("id");var _i=this.getCellInfo(yi);_i.options.displayFormat&&Vi.setAttribute("displayFormat",_i.options.displayFormat);var xi=Vi.getAttribute("excelCellType"),Si="";if(wi=!1,vi&&vi.hasOwnProperty("colID"))wi=-1!==vi.colID.split(",").indexOf(yi);wi&&Vi.setAttribute("displayFormat",""),null==xi?(Si=this._dataList.getColumnOption(yi,"dataType"),wi&&(Si="text")):Si=xi,Si?Vi.setAttribute("dataType",Si):Vi.setAttribute("dataType","text");var Ri=Vi.getAttribute("excelFormatter");if(Yi=a.Z.getGlobalFunction(Ri,this.scope_id)){var Di=Yi.call(this,yi);Vi.setAttribute("excelFormat",Di)}}}var Ti,Li=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:subTotal"),ki=a.Z.getDataPrefix("dataType"),Fi=a.Z.getDataPrefix("displayFormat");for(di=0;di<Li.length;di++){Ii=WebSquare.Elem.api.getElementsByTagName(Li[di],"w2:row"),Ti=this.subtotalTableList[Li[di].getAttribute("targetColumnID")]
;for(pi=0;pi<Ii.length;pi++){ci=WebSquare.Elem.api.getElementsByTagName(Ii[pi],"w2:column");for(var Ai=Ti?Ti.rows[pi].getElementsByTagName("td"):"",Ei=0;Ei<ci.length;Ei++){yi=(Vi=ci[Ei]).getAttribute("id");for(var Mi="",Oi=0;Oi<Ai.length;Oi++)Ai[Oi].id===yi&&(Mi=Ai[Oi]);if(wi=!1,vi&&vi.hasOwnProperty("subtotalColID"))wi=-1!==vi.subtotalColID.split(",").indexOf(yi);wi?(Vi.setAttribute("displayFormat",""),Vi.setAttribute("dataType","text")):Mi&&(Mi.getAttribute(Fi)&&Mi.getAttribute(Fi)!=Vi.getAttribute("displayFormat")&&Vi.setAttribute("displayFormat",Mi.getAttribute(Fi)),Mi.getAttribute(ki)&&"number"==Mi.getAttribute(ki)&&Mi.getAttribute(ki)!=Vi.getAttribute("dataType")&&Vi.setAttribute("dataType",Mi.getAttribute(ki)));Ri=Vi.getAttribute("excelFormatter");if(Yi=a.Z.getGlobalFunction(Ri,this.scope_id)){Di=Yi.call(this,yi);Vi.setAttribute("excelFormat",Di)}}}}var Ni=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:footer"),Hi=this.getElementById(this.id+"_foot_table");if(Ni.length>0){var Gi=Ni[0];Ii=WebSquare.Elem.api.getElementsByTagName(Gi,"w2:row");for(di=0;di<Ii.length;di++){ci=WebSquare.Elem.api.getElementsByTagName(Ii[di],"w2:column");var Bi=Hi.rows[di].getElementsByTagName("td"),Wi=a.Z.getDataPrefix("footer_id");for(pi=0;pi<ci.length;pi++){yi=(Vi=ci[pi]).getAttribute("id");var Vi,qi="";for(Oi=0;Oi<Bi.length;Oi++)Bi[Oi].getAttribute(Wi)===yi&&(qi=Bi[Oi]);if(wi=!1,vi&&vi.hasOwnProperty("footerColID"))wi=-1!==vi.footerColID.split(",").indexOf(yi);wi?(Vi.setAttribute("displayFormat",""),Vi.setAttribute("dataType","text")):qi&&(qi.getAttribute(Fi)&&qi.getAttribute(Fi)!=Vi.getAttribute("displayFormat")&&Vi.setAttribute("displayFormat",qi.getAttribute(Fi)),qi.getAttribute(ki)&&"number"==qi.getAttribute(ki)&&qi.getAttribute(ki)!=Vi.getAttribute("dataType")&&Vi.setAttribute("dataType",qi.getAttribute(ki)));var Yi;Ri=Vi.getAttribute("excelFormatter");if(Yi=a.Z.getGlobalFunction(Ri,this.scope_id)){Di=Yi.call(this,yi);Vi.setAttribute("excelFormat",Di)}}}}var Zi=[];Zi.push("<vector result='1'>"),Zi.push("<data vectorkey='0'><hashtable>");var ji=this.element._elementType,Pi="";if(Pi="json"===ji?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),Zi.push("<data hashkey='style'>"+Pi+"</data>"),t.dataHandler=t.dataHandler||"",""!=t.dataHandler){var zi=WebSquare.util.getGlobalFunction(t.dataHandler,this.scope_id);if("function"==typeof zi){var Ui=zi.call(this,this.id);It=t.separator||",";i='<array><![CDATA[["'+Ui.join('"'+It+'"')+'"]]]></array>'}}Zi.push("<data hashkey='data'>"+i+"</data>"),(this.startedDisplayNone||0==this.resizeObj.width||0==this.resizeObj.height)&&this.drawFooter(),Zi.push("<data hashkey='groupby' value='"+this.groupbyStatus.grouped+"'/>"),this.groupbyStatus.grouped?(Zi.push("<data hashkey='groupbyStyle'>"+this.getExcelGroupbyStyle()+"</data>"),Zi.push("<data hashkey='groupbyHeaderValue'>"+this.getExcelGroupbyHeaderValue(It)+"</data>"),Zi.push("<data hashkey='groupbyFooterValue'>"+this.getExcelGroupbyFooterValue(It)+"</data>"),Zi.push("<data hashkey='groupbyStatusValue'>"+this.getExcelGroupbyStatusValue(It)+"</data>"),Zi.push("<data hashkey='groupbyStyleData'>"+this.getExcelGroupbyStyleData(t)+"</data>"),Zi.push("<data hashkey='rowNumVisible' value='"+this.options.rowNumVisible+"'/>"),Zi.push("<data hashkey='rowStatusVisible' value='"+this.options.rowStatusVisible+"'/>"),""!=$&&Zi.push("<data hashkey='groupbyColor' value='"+$+"'/>"),""!=Q&&Zi.push("<data hashkey='groupbyFontName' value='"+Q+"'/>"),""!=tt&&Zi.push("<data hashkey='groupbyFontSize' value='"+tt+"'/>"),""!=et&&Zi.push("<data hashkey='groupbyFontColor' value='"+et+"'/>"),a.Z.isEmptyObject(this.groupbyDisplayOptions.rowNumHeader)&&a.Z.isEmptyObject(this.groupbyDisplayOptions.rowStatusHeader)||Zi.push("<data hashkey='rowNone' value='true'/>")):Zi.push("<data hashkey='rowNumVisible' value='"+$t+"'/>"),
0==l?Zi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXML(It)+"</data>"):1==l?Zi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXMLDisplay(It)+"</data>"):Zi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXMLRaw(It)+"</data>"),Zi.push("<data hashkey='fileName' value='"+o+"'/>"),Zi.push("<data hashkey='sheetName' value='"+n+"'/>"),Zi.push("<data hashkey='multipleSheet' value='"+h+"'/>"),Zi.push("<data hashkey='stRowIndex' value='"+g+"'/>"),Zi.push("<data hashkey='stColIndex' value='"+f+"'/>"),Zi.push("<data hashkey='removeColumns' value='"+p+"'/>"),Zi.push("<data hashkey='removeHeaderRows' value='"+u+"'/>"),Zi.push("<data hashkey='foldColumns' value='"+c+"'/>"),Zi.push("<data hashkey='headerColor' value='"+m+"'/>"),Zi.push("<data hashkey='headerFontName' value='"+y+"'/>"),Zi.push("<data hashkey='headerFontSize' value='"+b+"'/>"),Zi.push("<data hashkey='headerFontColor' value='"+v+"'/>"),Zi.push("<data hashkey='headerFontBold' value='"+w+"'/>"),Zi.push("<data hashkey='bodyColor' value='"+C+"'/>"),Zi.push("<data hashkey='bodyFontName' value='"+I+"'/>"),Zi.push("<data hashkey='bodyFontSize' value='"+_+"'/>"),Zi.push("<data hashkey='bodyFontColor' value='"+x+"'/>"),""!=S&&Zi.push("<data hashkey='bodyFontBold' value='"+S+"'/>"),Zi.push("<data hashkey='footerColor' value='"+R+"'/>"),Zi.push("<data hashkey='footerFontName' value='"+D+"'/>"),Zi.push("<data hashkey='footerFontSize' value='"+T+"'/>"),Zi.push("<data hashkey='footerFontColor' value='"+L+"'/>"),""!=k&&Zi.push("<data hashkey='footerFontBold' value='"+k+"'/>"),Zi.push("<data hashkey='subTotalColor' value='"+F+"'/>"),Zi.push("<data hashkey='subTotalFontName' value='"+A+"'/>"),Zi.push("<data hashkey='subTotalFontSize' value='"+E+"'/>"),Zi.push("<data hashkey='subTotalFontColor' value='"+M+"'/>"),""!=O&&Zi.push("<data hashkey='subTotalFontBold' value='"+O+"'/>"),$t&&(Zi.push("<data hashkey='rowNumHeaderColor' value='"+N+"'/>"),Zi.push("<data hashkey='rowNumHeaderFontName' value='"+H+"'/>"),Zi.push("<data hashkey='rowNumHeaderFontSize' value='"+G+"'/>"),Zi.push("<data hashkey='rowNumHeaderFontColor' value='"+B+"'/>"),Zi.push("<data hashkey='rowNumBodyColor' value='"+W+"'/>"),Zi.push("<data hashkey='rowNumBodyFontName' value='"+V+"'/>"),Zi.push("<data hashkey='rowNumBodyFontSize' value='"+q+"'/>"),Zi.push("<data hashkey='rowNumBodyFontColor' value='"+Y+"'/>"),Zi.push("<data hashkey='rowNumFooterColor' value='"+Z+"'/>"),Zi.push("<data hashkey='rowNumFooterFontName' value='"+j+"'/>"),Zi.push("<data hashkey='rowNumFooterFontSize' value='"+P+"'/>"),Zi.push("<data hashkey='rowNumFooterFontColor' value='"+z+"'/>"),Zi.push("<data hashkey='rowNumSubTotalColor' value='"+U+"'/>"),Zi.push("<data hashkey='rowNumSubTotalFontName' value='"+X+"'/>"),Zi.push("<data hashkey='rowNumSubTotalFontSize' value='"+K+"'/>"),Zi.push("<data hashkey='rowNumSubTotalFontColor' value='"+J+"'/>")),Zi.push("<data hashkey='footerDataProvider' value='"+ot+"'/>"),Zi.push("<data hashkey='dataProvider' value='"+it+"'/>"),Zi.push("<data hashkey='userDataXml' value=''>"+at+"</data>"),Zi.push("<data hashkey='optionParam' value='"+nt+"'/>"),""!=lt&&Zi.push("<data hashkey='bodyWordwrap' value='"+lt+"'/>"),""!=ht&&Zi.push("<data hashkey='subtotalWordwrap' value='"+ht+"'/>"),""!=dt&&Zi.push("<data hashkey='footerWordwrap' value='"+dt+"'/>"),Zi.push("<data hashkey='useEuroLocale' value='"+pt+"'/>"),Zi.push("<data hashkey='numberLocale' value='"+ut+"'/>"),Zi.push("<data hashkey='useHeader' value='"+ct+"'/>"),Zi.push("<data hashkey='useSubTotal' value='"+gt+"'/>"),Zi.push("<data hashkey='useFooter' value='"+ft+"'/>"),Zi.push("<data hashkey='fitToPage' value='"+mt+"'/>"),Zi.push("<data hashkey='landScape' value='"+yt+"'/>"),Zi.push("<data hashkey='fitWidth' value='"+bt+"'/>"),Zi.push("<data hashkey='fitHeight' value='"+vt+"'/>"),Zi.push("<data hashkey='scale' value='"+wt+"'/>"),Zi.push("<data hashkey='pageSize' value='"+Ct+"'/>"),Zi.push("<data hashkey='separator' value='"+It+"'/>"),
Zi.push("<data hashkey='subTotalScale' value='"+_t+"'/>"),Zi.push("<data hashkey='subTotalRoundingMode' value='"+xt+"'/>"),Zi.push("<data hashkey='footerScale' value='"+St+"'/>"),Zi.push("<data hashkey='footerRoundingMode' value='"+Rt+"'/>"),Zi.push("<data hashkey='useStyle' value='"+Dt+"'/>"),1==Lt&&Zi.push("<data hashkey='setFontSize' value='"+Dt+"'/>"),Zi.push("<data hashkey='freezePane' value='"+kt+"'/>"),Zi.push("<data hashkey='autoSizeColumn' value='"+Ft+"'/>"),Zi.push("<data hashkey='autoSizeAdjustWith' value='"+At+"'/>"),Zi.push("<data hashkey='displayGridlines' value='"+Et+"'/>"),Zi.push("<data hashkey='colMerge' value='"+Mt+"'/>"),Zi.push("<data hashkey='colMergeValue' value='"+Ot+"'/>"),Zi.push("<data hashkey='colMergeTextAlign' value='"+Nt+"'/>"),Zi.push("<data hashkey='useDataFormat' value='"+Ht+"'/>"),""!=Gt&&Zi.push("<data hashkey='useHeaderDataFormat' value='"+Gt+"'/>"),Zi.push("<data hashkey='customToDataType' value='"+Wt+"'/>"),Zi.push("<data hashkey='applyDataFormat' value='"+Bt+"'/>"),Zi.push("<data hashkey='useSubTotalData' value='"+Vt+"'/>"),Zi.push("<data hashkey='useFooterData' value='"+qt+"'/>"),Zi.push("<data hashkey='calcFooter' value='"+Yt+"'/>"),Zi.push("<data hashkey='columnMove' value='"+Zt+"'/>"),Zi.push("<data hashkey='columnOrder' value='"+ce+"'/>"),""!=Pt&&Zi.push("<data hashkey='columnMoveWithSubTotal' value='"+Pt+"'/>"),""!=zt&&Zi.push("<data hashkey='columnMoveWithFooter' value='"+zt+"'/>"),Zi.push("<data hashkey='oddRowBgColor' value='"+Ut+"'/>"),Zi.push("<data hashkey='evenRowBgColor' value='"+Xt+"'/>"),Zi.push("<data hashkey='indent' value='"+Kt+"'/>"),Zi.push("<data hashkey='rowNumHeaderValue' value='"+Jt+"'/>"),Zi.push("<data hashkey='startRowNumber' value='"+Qt+"'/>"),Zi.push("<data hashkey='bodyNumberDefaultValue' value='"+te+"'/>"),Zi.push("<data hashkey='numberToText' value='"+ee+"'/>"),Zi.push("<data hashkey='rowHeight' value='"+ie+"'/>"),oe&&"object"==typeof oe&&(oe=JSON.stringify(oe)),Zi.push("<data hashkey='headerRowHeight' value='"+oe+"'/>"),Zi.push("<data hashkey='pwd' value='"+re+"'/>"),Zi.push("<data hashkey='useImage' value='"+ae+"'/>"),Zi.push("<data hashkey='headerAutoFilter' value='"+ne+"'/>"),Zi.push("<data hashkey='filterRowIndex' value='"+le+"'/>"),Zi.push("<data hashkey='mergeCell' value='"+he+"'/>"),Zi.push("<data hashkey='noMerge' value='"+de+"'/>"),Dt&&Zi.push("<data hashkey='styleData'><array><![CDATA[["+this._getExcelStyle(t)+"]]]></array></data>"),Vt&&Zi.push("<data hashkey='subtotalData'><array><![CDATA[["+this._getExcelSubtotalData(It)+"]]]></array></data>");var Xi="",Ki=t.mergeCellHeaderInfo||"";he&&(gt=a.Z.getBoolean(gt),Xi=this.getMergeAll(p,gt)),Zi.push("<data hashkey='mergeCellInfo'><array><![CDATA[["+Xi+"]]]></array></data>"),Zi.push("<data hashkey='mergeCellHeaderInfo'><array><![CDATA[["+Ki+"]]]></array></data>"),Zi.push("<data hashkey='openFile' value='"+ge+"'/>"),Zi.push("<data hashkey='macroFileName' value='"+fe+"'/>"),Zi.push("<data hashkey='useMacro' value='"+me+"'/>"),Zi.push("<data hashkey='showDialog' value='"+ye+"'/>"),Zi.push("<data hashkey='dialogFilter' value='"+be+"'/>"),Zi.push("<data hashkey='keepType' value='"+ve+"'/>"),Zi.push("<data hashkey='lazyInfoArr' value='"+Ce+"'/>"),Zi.push("<data hashkey='decimal' value='"+Ie+"'/>"),""!=_e&&Zi.push("<data hashkey='sameSite' value='"+_e+"'/>"),Zi.push("<data hashkey='customProvider' value='"+xe+"'/>"),Zi.push("<data hashkey='customProviderIndex' value='"+Se+"'/>"),Zi.push("<data hashkey='rowAccessWindowSize' value='"+Re+"'/>"),Zi.push("<data hashkey='trim' value='"+De+"'/>"),""!=(ke=ke||this._getMsaName()||"")&&(ue="true"),Zi.push("<data hashkey='useXHR' value='"+ue+"'/>"),Zi.push("<data hashkey='desc' value='"+Te+"'/>"),""!=Le&&Zi.push("<data hashkey='footerTop' value='"+Le+"'/>"),""!=ke&&Zi.push("<data hashkey='msaName' value='"+ke+"'/>"),Fe.chartName&&(Zi.push("<data hashkey='c_chartName' value='"+Ae+"'/>"),Zi.push("<data hashkey='c_chartType' value='"+Ee+"'/>"),
Zi.push("<data hashkey='c_title' value='"+Me+"'/>"),Zi.push("<data hashkey='c_xTitle' value='"+Oe+"'/>"),Zi.push("<data hashkey='c_yTitle' value='"+Ne+"'/>"),Zi.push("<data hashkey='c_startRowIndex' value='"+He+"'/>"),Zi.push("<data hashkey='c_startColIndex' value='"+Ge+"'/>"),Zi.push("<data hashkey='c_endRowIndex' value='"+Be+"'/>"),Zi.push("<data hashkey='c_endColIndex' value='"+We+"'/>"),Zi.push("<data hashkey='c_serAxis' value='"+Ve+"'/>"),Zi.push("<data hashkey='c_catAxis' value='"+qe+"'/>"),Zi.push("<data hashkey='c_catAxisStartX' value='"+Ze+"'/>"),Zi.push("<data hashkey='c_catAxisStartY' value='"+je+"'/>"),Zi.push("<data hashkey='c_catAxisEndX' value='"+Pe+"'/>"),Zi.push("<data hashkey='c_catAxisEndY' value='"+ze+"'/>"),Zi.push("<data hashkey='c_serAxisStartX' value='"+Xe+"'/>"),Zi.push("<data hashkey='c_serAxisStartY' value='"+Ke+"'/>"),Zi.push("<data hashkey='c_serAxisEndX' value='"+Je+"'/>"),Zi.push("<data hashkey='c_serAxisEndY' value='"+$e+"'/>"),Zi.push("<data hashkey='c_dataAxisStartX' value='"+ti+"'/>"),Zi.push("<data hashkey='c_dataAxisStartY' value='"+ei+"'/>"),Zi.push("<data hashkey='c_dataAxisEndX' value='"+ii+"'/>"),Zi.push("<data hashkey='c_dataAxisEndY' value='"+oi+"'/>"),Zi.push("<data hashkey='c_catGridLines' value='"+si+"'/>"),Zi.push("<data hashkey='c_serGridLines' value='"+ri+"'/>"),Zi.push("<data hashkey='c_legend' value='"+ai+"'/>"),Zi.push("<data hashkey='c_legendPosition' value='"+ni+"'/>")),null!=e&&void 0!==e||(e=[]),Zi.push("<data hashkey='information'><vector result='"+e.length+"'>");for(di=0;di<e.length;di++){var Ji=e[di];for(var $i in Zi.push("<data vectorkey='"+di+"'><hashtable>"),Ji)"text"==$i?Zi.push("<data hashkey='"+$i+"' value='"+WebSquare.xml.encode(Ji[$i])+"'/>"):Zi.push("<data hashkey='"+$i+"' value='"+Ji[$i]+"'/>");Zi.push("</hashtable></data>")}if(Zi.push("</vector></data>"),0!=t.multiexcel)return Zi.push("<data hashkey='splitProvider' value='"+st+"'/>"),Zi.push("<data hashkey='providerRequestXml' value=''>"+rt+"</data>"),Zi.push("</hashtable></data>"),Zi.push("</vector>"),Zi;Zi.push("<data hashkey='splitProvider' value='"+st+"'/>"),Zi.push("<data hashkey='providerRequestXml' value=''>"+rt+"</data>"),Zi.push("</hashtable></data>"),Zi.push("</vector>");var Qi=Zi.join("");if(-1!=se&&se<a.Z.getByteLengthUtf8(Qi)){var to=WebSquare.language.getMessage("Grid_warning9",se)||"The data size has exceeded the limit.\n The current limit is : "+se+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(to)}if(""!=ke){var eo="";""!=pe&&(eo=pe),pe=r.I.getServletURL(this,ke,"xmlToExcel2.wq",eo),t.useXHR=!0,t.userExcel=!0}""==pe&&(pe=this.options.advancedExcelDownloadURL),t.scopeId=this.scope_id||"",r.I.excelDownload(pe,Qi,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0)),this.xmlData=null,!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm&&this.hideDownloadLayer()}catch(t){throw t}},D.prototype.saveFile=function(t){var e=t.type||"xml",i=t.fileName||"gridView",o=t.extension||"xml",s=t.sameSite||"",a=[];a.push("<vector result='1'>"),a.push("<data vectorkey='0'><hashtable>"),a.push("<data hashkey='type' value='"+e+"'/>"),a.push("<data hashkey='fileName' value='"+i+"'/>"),a.push("<data hashkey='extension' value='"+o+"'/>"),a.push("<data hashkey='sameSite' value='"+s+"'/>"),a.push("</hashtable></data>"),a.push("</vector>");var n=a.join("");n+="\x3c!----VALUESTR----!>",n+=WebSquare.xml.serialize(this.getAllXML());var l=t.action||WebSquare.baseServletURI+"gridToFile.wq";r.I.excelDownload(l,n,"post",t)},D.prototype.getExcelExpression=function(t){var e,i=""
;return void 0!==t.type&&void 0!==t.id&&void 0!==t.attr&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",r.I._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",r.I._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0]),void 0!==e&&(i=this._getAttribute(e,t))),i},D.prototype.setExcelExpression=function(t){var e;void 0!==t.type&&void 0!==t.id&&void 0!==t.excelExpression&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",r.I._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",r.I._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0]),void 0!==e&&this._setAttribute(e,t))},D.prototype._getAttribute=function(t,e){for(var i="",o=0;o<t.childNodes.length;o++){var s=t.childNodes[o];if(1==s.nodeType)for(var r=0;r<s.childNodes.length;r++){var a=s.childNodes[r];if(1==a.nodeType){if(("body"==e.type?a.getAttribute("col_id"):a.getAttribute("id"))==e.id){i=a.getAttribute(e.attr);break}}}}return i},D.prototype._setAttribute=function(t,e){for(var i=0;i<t.childNodes.length;i++){var o=t.childNodes[i];if(1==o.nodeType)for(var s=0;s<o.childNodes.length;s++){var r=o.childNodes[s];if(1==r.nodeType){if(("body"==e.type?r.getAttribute("col_id"):r.getAttribute("id"))==e.id){r.setAttribute("excelExpression",e.excelExpression);break}}}}},D.prototype.cancleDownload=function(){clearTimeout(this.excelTime),this.hideDownloadLayer()},D.prototype.hideDownloadLayer=function(){window.gridExceldownloadIframe.style.display="none",this.excelOptions=null,this.excelInfoArr=null,this.excelFinalStr=null,window.downloadGridId=null,WebSquare.getBody().hideModal(!0)},D.prototype.saveBigExcelFile=function(t,e,i){i&&(t.rowsByN=i),t.massStorage=!0,this.advancedExcelDownload(t,e)},D.prototype._getExcelStyle=function(t){try{var e={},i={},o={},r={},n={},l=this.getColumnCount();if(1==t.useClass)for(var h=0;h<l;h++){var d=(v=this.getCellInfo(h)).options.className;if(d){var p=document.querySelector("."+d);if(p){var u=WebSquare.style.getComputedStyle(p,"text-align"),c=WebSquare.style.getComputedStyle(p,"background-color"),g=WebSquare.style.getComputedStyle(p,"color"),f=WebSquare.style.getComputedStyle(p,"font-weight"),m=WebSquare.style.getComputedStyle(p,"font-family"),y=WebSquare.style.getComputedStyle(p,"font-size"),b=a.Z.getStyleFromCssStr(d,["backgroundColor"]);b&&b.backgroundColor||p.style.backgroundColor||(c=c.replace("rgba(0, 0, 0, 0)","")),void 0===e[h]&&(e[h]={}),""!=u&&(e[h]["text-align"]=u),""!=c&&(e[h]["background-color"]=c),""!=g&&(e[h].color=g),""!=f&&(e[h]["font-weight"]=f),""!=m&&(e[h]["font-family"]=m),""!=y&&(e[h]["font-size"]=y),"underline"!=(G=WebSquare.style.getComputedStyle(p,"text-decoration"))&&"line-through"!=G||(e[h]["text-decoration"]=G)}}}for(var h in this.columnStyleValueObj){var v,w={};for(var C in this.columnStyleValueObj[h])"style"!=C&&(w[C]=this.columnStyleValueObj[h][C]);if(v=this.getCellInfo(parseInt(h,10)))"underline"!=(G=this.getColumnStyleValue(parseInt(h,10),"text-decoration"))&&"line-through"!=G||(w["text-decoration"]=G);if(v&&v.options.textAlign){var I="";""==(I=this.getColumnStyleValue(parseInt(h,10),"text-align"))&&""==(I=v.options.textAlign)&&(I="center"),w["text-align"]=I}if(void 0===e[h])e[h]=w;else for(var C in w)e[h][C]=w[C]}for(h=0;h<this.rowStyleArr.length;h++)if(this.rowStyleArr[h]){w={};for(var C in this.rowStyleValueObj[this.rowStyleArr[h]])"style"!=C&&(w[C]=this.rowStyleValueObj[this.rowStyleArr[h]][C]);var _=this.getDisplayRowIndex(h);isNaN(_)||(i[_]=w)}for(var x in this.cellStyleArr)if(this.cellStyleArr[x]&&!isNaN(x)){w={};var S=parseInt(x/this.oneRowDataLength,10),R=(_=this.getDisplayRowIndex(S),x%this.oneRowDataLength)
;for(var C in this.cellStyleValueObj[this.cellStyleArr[x]])"style"!=C&&this.cellStyleValueObj[this.cellStyleArr[x]][C]&&(w[C]=this.cellStyleValueObj[this.cellStyleArr[x]][C]);o[_+","+R]=w}if(1==t.useClass)for(h=0;h<this.cellClassArr.length;h++)if(this.cellClassArr[h]){w={},S=parseInt(h/this.oneRowDataLength,10),_=this.getDisplayRowIndex(S),R=h%this.oneRowDataLength;var D=WebSquare.util.getStyleFromCssStr(this.cellClassArr[h],["backgroundColor","color","textAlign","fontSize","fontWeight","fontFamily","text-decoration","borderLeft","borderRight"]);o[_+","+R]&&(w=o[_+","+R]),D&&(D.backgroundColor&&(w["background-color"]=D.backgroundColor),D.color&&(w.color=D.color),D.textAlign&&(w["text-align"]=D.textAlign),D.fontSize&&(w["font-size"]=D.fontSize),D.fontWeight&&(w["font-weight"]=D.fontWeight),D.fontFamily&&(w["font-family"]=D.fontFamily),"underline"!=D["text-decoration"]&&"line-through"!=D["text-decoration"]||(w["text-decoration"]=D["text-decoration"]),D.borderLeft&&(w["border-left"]=D.borderLeft),D.borderRight&&(w["border-right"]=D.borderRight)),0!==Object.keys(w).length&&(o[_+","+R]=w)}if(this.options.disabledBackgroundColor||this.options.disabledFontColor){w={};this.options.disabledBackgroundColor&&(w["background-color"]=this.options.disabledBackgroundColor),this.options.disabledFontColor&&(w.color=this.options.disabledFontColor);l=this.getColumnCount();var T=this.getRowCount(),L=!(!this.isDrillDown||!this._dataList.options.depthColumn);for(h=0;h<l;h++)for(C=0;C<T;C++)this._getEditDisabled(h,C,L)&&(o[h+","+C]?(this.options.disabledBackgroundColor&&(o[h+","+C]["background-color"]=this.options.disabledBackgroundColor),this.options.disabledFontColor&&(o[h+","+C].color=this.options.disabledFontColor)):o[h+","+C]=w)}var k=a.Z.getDataPrefix("header_id"),F="",A=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(h=this.defaultColCnt;h<A.length;h++){var E="",M=A[h].id.replace(this.id+"_",""),O=this.headerCellStyleValueObj[M];F=O&&O["background-color"]?O["background-color"]:t.headerColor?t.headerColor:WebSquare.style.getStyle(A[h],"background-color"),E+="color:"+WebSquare.style.getStyle(A[h],"color")+";",E+="background-color:"+F+";",E+="font-weight:"+WebSquare.style.getStyle(A[h],"font-weight")+";",E+="font-family:"+WebSquare.style.getStyle(A[h],"font-family")+";",E+="text-align:"+WebSquare.style.getStyle(A[h],"text-align")+";","underline"!=(G=WebSquare.style.getStyle(A[h],"text-decoration"))&&"line-through"!=G||(E+="text-decoration:underline;"),r[A[h].getAttribute(k)]=E}if(this.hasFooter){var N=a.Z.getDataPrefix("footer_id"),H=this.getDomList("foot_tds","th",this.getElementById(this.id+"_foot_table"));for(h=this.defaultColCnt;h<H.length;h++){var G;E="";E+="color:"+WebSquare.style.getStyle(H[h],"color")+";",E+="background-color:"+WebSquare.style.getStyle(H[h],"background-color")+";",E+="font-weight:"+WebSquare.style.getStyle(H[h],"font-weight")+";",E+="font-family:"+WebSquare.style.getStyle(H[h],"font-family")+";",E+="text-align:"+WebSquare.style.getStyle(H[h],"text-align")+";","underline"!=(G=WebSquare.style.getStyle(H[h],"text-decoration"))&&"line-through"!=G||(E+="text-decoration:underline;"),n[H[h].getAttribute(N)]=E}}return JSON.stringify({row:i,col:e,cell:o,header:r,footer:n})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getExcelSubtotalData=function(t){t||(t=",");var e=[];e.push('"');for(var i=a.Z.getDataPrefix("colMerge"),o=a.Z.getDataPrefix("value"),s=this.getDataLength(),r=0;r<s;r++){var n=r;for(var l in this.subtotalTableList){var h=this.dataList._getCellData(n,l),d=h+"_12";if(n<s-1)d=this.dataList._getCellData(n+1,l);if(h!=d){var p=this.subtotalTableList[l],u=this.subtotalDataArr[l+"_"+h];null==u&&(u=this.getSubtotalData(p,l,h,n));for(var c="",g=p.getElementsByTagName("td"),f=0;f<g.length;f++){var m=g[f],y=m.getAttribute("id");if(!y.startsWith("_headerRowNumber")&&!y.startsWith("_headerRowStatus")){if(null!=u[y])c=u[y];else if("true"==m.getAttribute(i))c="";else{
c=null!=(c=m.getAttribute(o))?c:""}e.push(c),e.push('"'+t+'"')}}}}}return e[e.length-1]='"',e.join("")},D.prototype.getExcelGroupbyStyle=function(){try{if(this.groupbyStatus.grouped){var t={rowNumHeader:{type:"H",index:2},rowNumFooter:{type:"F",index:2},rowStatusHeader:{type:"H",index:3},rowStatusFooter:{type:"F",index:3},groupbyHeader:{type:"H",index:-1},groupbyFooter:{type:"F",index:-1}},e=4,i=4,o=!1,r=!1,a=[],n=[],l=[],h={};a.push("<w2:groupby>"),n.push("<w2:groupbyHeader>"),l.push("<w2:groupbyFooter>"),n.push("<w2:row>"),l.push("<w2:row>");var d=this.defaultColCnt+this.getColCnt(),p=0,u=0;this.options.rowNumVisible&&(this.groupbyDisplayOptions.rowNumHeader&&(this.groupbyDisplayOptions.rowNumHeader.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowNumHeader.colSpan,10)||1)<=d&&(h.rowNumHeader=this.groupbyDisplayOptions.rowNumHeader)),this.groupbyDisplayOptions.rowNumFooter&&(this.groupbyDisplayOptions.rowNumFooter.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowNumFooter.colSpan,10)||1)<=d&&(h.rowNumFooter=this.groupbyDisplayOptions.rowNumFooter))),this.options.rowStatusVisible&&(this.groupbyDisplayOptions.rowStatusHeader&&(this.groupbyDisplayOptions.rowStatusHeader.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowStatusHeader.colSpan,10)||1)<=d&&(h.rowStatusHeader=this.groupbyDisplayOptions.rowStatusHeader)),this.groupbyDisplayOptions.rowStatusFooter&&(this.groupbyDisplayOptions.rowStatusFooter.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowStatusFooter.colSpan,10)||1)<=d&&(h.rowStatusFooter=this.groupbyDisplayOptions.rowStatusFooter))),h.groupbyHeader=[],h.groupbyFooter=[];for(var c=this.groupbyDisplayOptions.groupbyHeader,g=0;g<c.length;g++)c[g].hidden||(u+=parseInt(c[g].colSpan,10)||1,h.groupbyHeader[g]=c[g]);var f=this.groupbyDisplayOptions.groupbyFooter;for(g=0;g<f.length;g++)f[g].hidden||(p+=parseInt(f[g].colSpan,10)||1,h.groupbyFooter[g]=f[g]);if(e<d){var m=d-u;for(g=0;g<m;g++)h.groupbyHeader.push({temp:!0})}if(i<d)for(m=d-p,g=0;g<m;g++)h.groupbyFooter.push({temp:!0});for(var y in this.groupbyStatus.excelDisplayOptions=h,h){var b,v=[];switch(y){case"rowNumHeader":case"rowNumFooter":case"rowStatusHeader":case"rowStatusFooter":v.push("<w2:column");var w=h[y],C=!1;for(var I in w)if("align"==I||"hidden"==I||"colSpan"==I){if("hidden"==I){C=!0;break}v.push(" "+I+'="'+w[I]+'"'),"rowNumHeader"!=y&&"rowNumFooter"!=y||"colspan"==I.toLowerCase()&&w[I]>=this.defaultColCnt+this.getColCnt()&&("rowNumHeader"==y?o=!0:r=!0)}if(C)break;if("rowStatusHeader"==y&&o)break;if("rowStatusFooter"==y&&r)break;y.match("rowNum")?v.push(' type="rowNum"'):y.match("rowStatus")&&v.push(' type="rowStatus"'),v.push("/>"),b=t[y];break;case"groupbyHeader":case"groupbyFooter":C=!1;var _=h[y];if(_.length>0){var x,S=0,R=0,D=0,T=0,L=this.htmlInfo?this.htmlInfo.body.rowArr:this.struct.body.rowArr;for(g=0;g<L.length;g++){for(var k=L[g],F=0;F<k.length;F++){var A=k[F];S+=parseInt(A.colSpan,10)||1}R<S&&(R=S),S=0}x=new Array(R);for(g=0;g<_.length;g++){var E=[];for(var I in E.push("<w2:column"),_[g])if("align"==I||"hidden"==I||"colSpan"==I||"rowSpan"==I||"displayFormat"==I){if("hidden"==I){E.pop();break}E.push(" "+I+'="'+_[g][I]+'"')}E.push("/>"),v.push(E.join(""));var M=parseInt(_[g].colSpan,10)||1,O=parseInt(_[g].rowSpan,10)||1;if(0===T){if(void 0===x[D])if(M>1)for(var N=0;N<M;N++)x[D+N]=O;else x[D]=O}else{x[D]>1?x[D]-=1:x[D]=O;for(var H=D+1;1!==x[H]&&H<R;)x[H]-=1,D+=1,H+=1}R<=(D+=M)&&g!=_.length-1&&(v.push("</w2:row><w2:row>"),D=0,T+=1)}}b=t[y]}b&&("H"==b.type?-1==b.index?(n[e]=v.join(""),e++):n[b.index]=v.join(""):"F"==b.type&&(-1==b.index?(l[i]=v.join(""),i++):l[b.index]=v.join(""))),b=null}return n.push("</w2:row>"),l.push("</w2:row>"),n.push("</w2:groupbyHeader>"),l.push("</w2:groupbyFooter>"),a.push(n.join("")),a.push(l.join("")),a.push("</w2:groupby>"),a.join("")}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getExcelGroupbyHeaderValue=function(t){this.groupbyStatus.headerValueObj={},this.getAllGroupbyHeaderValueObj();var e=[]
;e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("header"==o.type){for(var s=this.groupbyStatus.headerValueObj[o.groupId],r=0;r<s.length;r++)null!=s[r]&&(e.push('"'+s[r]+'"'),r<s.length-1&&e.push(t));s.length>0&&e.push(t)}}return e.pop(),e.push("]"),e.push("]]></array>"),e.join("")},D.prototype.getExcelGroupbyFooterValue=function(t){this.groupbyStatus.footerValueObj={},this.getAllGroupbyFooterValueObj();var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("footer"==o.type){for(var s=this.groupbyStatus.footerValueObj[o.groupId],r=0;r<s.length;r++)null!=s[r]&&(e.push('"'+s[r]+'"'),r<s.length-1&&e.push(t));s.length>0&&e.push(t)}}return e.pop(),e.push("]"),e.push("]]></array>"),e.join("")},D.prototype.getExcelGroupbyStatusValue=function(t){var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("number"==typeof o)e.push('"0B"');else{switch(o.type){case"header":var s='"'+o.depth+'H"';break;case"footer":s='"'+o.depth+'F"'}e.push(s)}i<this.groupbyStatus.groupedRowIndexArr.length-1&&e.push(t)}return e.push("]"),e.push("]]></array>"),e.join("")},D.prototype.getExcelGroupbyStyleData=function(t){var e=this.getElementById(this.id+"_body_tbody").childNodes,i=[];i.push("<array><![CDATA["),i.push("[");for(var o=0;o<this.groupbyStatus.groupedRowIndexArr.length;o++){var s=this.groupbyStatus.groupedRowIndexArr[o];if("number"!=typeof s){var r=e[s.index];if(!i[s.depth+2]){var a,n='"';for(var l in 0!=o&&(n=',"'),this.groupbyStatus.excelDisplayOptions){var h=!1;switch(l){case"rowNumHeader":h=!0,a=0;break;case"rowStatusHeader":h=!0,a=this.defaultColCnt-1;break;case"groupbyHeader":h=!0,a=this.defaultColCnt}if(h)break}var d=r.getElementsByTagName("TD")[a];""==t.groupbyColor&&(n+="background-color:"+WebSquare.style.getStyle(d,"background-color")+";"),""==t.groupbyFontSize&&(n+="font-size:"+WebSquare.style.getStyle(d,"font-size")+";"),""==t.groupbyFontColor&&(n+="color:"+WebSquare.style.getStyle(d,"color")+";"),n+="font-weight:"+WebSquare.style.getStyle(d,"font-weight")+";",""==t.groupbyFontName&&(n+="font-family:"+WebSquare.style.getStyle(d,"font-family")+";"),n+='"',i[s.depth+2]=n}}}return i.push("]"),i.push("]]></array>"),i.join("")},D.prototype.getAllGroupbyHeaderValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumHeader),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusHeader),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyHeader.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyHeader[o]),i++}},D.prototype.getAllGroupbyFooterValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumFooter),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusFooter),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyFooter.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyFooter[o]),i++}},D.prototype.getGroupbyData=function(t){try{if(this.options.groupbyZone&&this.groupbyStatus&&this.groupbyStatus.grouped)return!1===t?this.groupbyStatus.groupbyOptions:JSON.parse(this.groupbyStatus.groupbyOptions)}catch(t){s.Y.printStackTrace(t,null,this)}},
D.prototype.setGroupbyData=function(t,e,i){try{var o,r,a=(i=i||{}).value||"",n=i.inputType||"",l=i.depthVisible||!1,h=i.expression||"",d=i.hidden?"none":"",p=i.displayFormatType||"text",u=i.displayFormat||"",c=i.displayFormatter||null;if(n)switch((u||c)&&(o=new WebSquare.format.createFormatter(p,u,c,null,null,null,this.scope_id,this.id)),n){case"toggleButton":r="open"==t.status?"-":"+";break;case"expression":if(h){var g=this.groupbyInfo[t.groupId].header;g.colIndex=e;var f=0;if("open"==g.status){for(var m,y=g.index;y<this.groupbyStatus.groupedRowIndexArr.length;y++){if("footer"==(b=this.groupbyStatus.groupedRowIndexArr[y]).type&&b.depth==g.depth){m=b.index;break}}if(!m){for(y=g.index+1;y<this.groupbyStatus.groupedRowIndexArr.length;y++){var b;if("header"==(b=this.groupbyStatus.groupedRowIndexArr[y]).type&&b.depth==g.depth){m=b.index;break}}m||(m=this.groupbyStatus.groupedRowIndexArr.length-1)}f=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,g.index,m,h,g)}else f=this.groupExpression(g.closedChildArr,0,g.closedChildArr.length-1,h,g);if(o&&(f=o.format(f)),"string"==typeof(r=f)&&(r.match("w2grid_minus")||r.match("w2grid_plus"))){var v=r.lastIndexOf("</span>");v>-1&&(v+=7,r=r.slice(v),"open"==t.status?r="-||"+r:"closed"==t.status&&(r="+||"+r))}}}if(l&&(r=t.groupId),a&&(o&&(a=o.format(a)),r=a),!r){r="";y=0;for(var w in i)y++;0==y&&(d="none")}"none"!=d&&("header"==t.type?(this.groupbyStatus.headerValueObj[t.groupId]||(this.groupbyStatus.headerValueObj[t.groupId]=[]),this.groupbyStatus.headerValueObj[t.groupId][e]=r):"footer"==t.type&&(this.groupbyStatus.footerValueObj[t.groupId]||(this.groupbyStatus.footerValueObj[t.groupId]=[]),this.groupbyStatus.footerValueObj[t.groupId][e]=r))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getTotalRow=function(){return this.dataList.getTotalRow()},D.prototype.getTotalCol=function(){return this.oneRowDataLength},D.prototype.editEndBeforeGetData=function(){this.editedCell&&this.rollbackCommitFlag&&1==this.options.rollbackCommit&&(1==this.options.moveKeyEditModeAll&&1==this.checkScrollEnd||(this.rollbackCommitFlag=!1,this.editedCell.handleEndEdit(),this.rollbackCommitFlag=!0))},D.prototype.getExtraDataObj=function(t,e,i){var o=this.extraData;return"grid"==t?o.grid:"row"==t?(o.row[e]||(o.row[e]={}),o.row[e]):"col"==t?(o.col[e]||(o.col[e]={}),o.col[e]):"cell"==t?(o.cell[e]||(o.cell[e]=[]),o.cell[e][i]||(o.cell[e][i]={}),o.cell[e][i]):null},D.prototype.finalize=function(){try{for(var t in null!=this.tempDiv&&null!=this.tempDiv.parentNode&&(this.tempDiv.innerHTML=""),null!=this.tempTr&&null!=this.tempTr.parentNode&&(this.tempTr.innerHTML=""),n.q.removeCheckResize(this.uuid),a.Z.clearInterval(this.id+"_dragSelectAutoScroll"),r.I.clearTimer(this.id+"initializeEvent"),r.I.clearTimer(this.id+"_autofit"),a.Z.clearTimeout(this.id+"_displayFixedColumnLine"),this.dom)this._removeDom(t);for(var e in this._dataList&&this._dataList.childCompHash&&delete this._dataList.childCompHash[this.id],null!=this._manager&&this._manager.destroy(),null!=this.customFilter&&this.customFilter.remove(),this.cellInfoHash){var i=this.cellInfoHash[e];i&&i.comp&&"function"==typeof i.comp.remove&&i.comp.remove()}this.orgSubtotalHeightArr=[]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setFixedColumn=function(t){try{t=parseInt(t,10),t=isNaN(t)?0:t;var e=0;if(!(t<this.getColumnCount()))return;if(t>0){this.getFixedColumnLastIndex();for(var i=0;i<=t+this.defaultColCnt;i++)this.hiddenList[i]||(e+=this.colWidthList[i])}if(e>this.getElementById(this.id+"_dataLayer").offsetWidth)return;if(this.options.fixedColumn>0){var o=this.getColumnCount();for(i=0;i<this.lastIndex+1;i++){var r=this.data_td_list[i*o+this.options.fixedColumn];r&&this.removeClass(r,"w2grid_fixedColumn");var a=parseInt(this.options.fixedColumn);if(t<a)for(var n=t;n<a;n++){var l=this.data_td_list[i*o+n];l&&this.removeClass(l,"w2grid_fixedColumn_td")}}}this.options.fixedColumn=t,this.options.fixedColumnScrollReset&&this.setScrollLeft(0),
this.arrangeOverflowXScroll(),this.displayFixedColumnLine()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setFixedRightColumn=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRightColumn>0)for(var e=this.getColumnCount(),i=this.getFixedRightColumnLastIndex()-this.defaultColCnt,o=0;o<this.lastIndex+1;o++){var r=this.data_td_list[o*e+i];if(r&&this.removeClass(r,"w2grid_fixedRightColumn"),i<e-t)for(var a=e-t-1;a>=i;a--){var n=this.data_td_list[o*e+a];n&&this.removeClass(n,"w2grid_fixedRightColumn_td")}}this.options.fixedRightColumn=t,this.arrangeOverflowXScroll(),this._handleScrollX()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.options.fixedRow-1)];e&&this.removeClass(e,"w2grid_fixedRow")}this.options.fixedRow=t,this.applyRowStyleOptions(t-1)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setLastFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.lastFixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.lastIndex-this.options.lastFixedRow)];e&&this.removeClass(e,"w2grid_lastFixedRow")}this.options.lastFixedRow=t,this.drawData(this.rowIndex,this.lastIndex-t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getOverflowX=function(){return this.options.overflowX},D.prototype.getOverflowY=function(){return this.options.overflowY},D.prototype.getColumnVisible=function(t){try{var e=t,i=(t=this.getColumnIndex(t),r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/getColumnVisible/@useRealColIndex"));if(a.Z.getBoolean(i)){if("number"!=typeof e){for(var o=this.getCellInfo(e),n=this._getRealColIndex("body",e),l=n+this.defaultColCnt,h=!this.hiddenList[l],d=0;d<o.options.colSpan;d++)h=!this.hiddenList[l+d]||h;return 0===n||n?h:void p.v.printLog("[getColumnVisible] Invalid column index provided.")}t=e%this.columnOrder.length;for(var u=0;u<this.columnOrder.length;u++)if(this.columnOrder[u]==t){t=u;break}if(e>this.columnOrder.length||u===this.columnOrder.length)return void p.v.printLog("[getColumnVisible] Invalid column index provided.")}return!this.hiddenList[this.defaultColCnt+t]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getColumnWidth=function(t,e){try{var i=e?this.defaultColCnt:0;if(t=this.getColumnIndex(t)+i,this.colWidthList[t])return this.colWidthList[t]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnWidth=function(t,e,i){try{if(!this.render)return void p.v.printLog("[setColumnWidth] "+this.options.pluginName+" is not initialized yet");if(0===this.render.offsetHeight&&0===this.render.offsetWidth){var o=!1;if("string"==typeof t&&(o=!0,t=this.getDisplayColumnIndex(t)),this.delayedDrawObj.newColumnOrder)for(var r=0;r<this.delayedDrawObj.newColumnOrder.length;r++)if(this.delayedDrawObj.newColumnOrder[r]==t){t=o?this.delayedDrawObj.newColumnOrder[r]:r;break}}else t=this.getDisplayColumnIndex(t);var a=this.colWidthList[t],n=!0===i?0:this.defaultColCnt;if(this.colWidthList[t]){this.__bResizeObj&&(this.__bResizeObj.isColumnResizing=!0),this.options.autoFit&&!this.hiddenList[t+n]?(this.autoFitColWidthList=null,this._setAutoFit({exceptCol:n+t,exceptWidth:e})):this._setColumnWidth(n+t,e),this.__bResizeObj&&(this.__bResizeObj.isColumnResizing=!1);var l=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],h=WebSquare.Elem.api.getElementsByTagName(l,"w2:column");for(r=0;r<h.length;r++){var u=h[r],c=u.getAttribute("id");if(this.getHeaderIndex(c)+n==t+n){u.setAttribute("width",e+"");break}}}i&&(t-=this.defaultColCnt),d.f.fireEvent(this,"oncolumnwidthchange",{columnIndex:t,columnID:this.getColumnID(t),oldWidth:a,newWidth:e})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.isColumnResizable=function(t){try{if(t<this.defaultColCnt)return!0===this.options.rowNumStatusResize;if(void 0===t||""===t)return!1;if(isNaN(t)&&(t=this.getColumnIndex(t)+this.defaultColCnt),
isNaN(t)||t>=this.getColumnCount()+this.defaultColCnt)return!0;for(var e,i=!0,o=0;o<this.htmlInfo.head.rowArr.length;o++)for(var r=this.htmlInfo.head.rowArr[o],n=0;n<r.length;n++)if(r[n].colIndex==this.columnOrder[t]&&"string"==typeof r[n].fixColumnWidth&&"true"===r[n].fixColumnWidth.toLowerCase()){i=!1;break}if(!this.cellInfoHash||a.Z.isEmptyObject(this.cellInfoHash))(e=this.cellInfoHash2[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&!0===a.Z.getBoolean(e.getAttribute("fixColumnWidth"))&&(i=!1);else(e=this.cellInfoHash[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&e.options.fixColumnWidth&&(i=!1);return i}catch(t){return s.Y.printStackTrace(t,null,this),!0}},D.prototype.setColumnDisableEdit=function(t,e){try{var i=this.getCellInfo(t);"autoComplete"==i.options.inputType&&i.setColumnDisableEdit(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnNodeSet=function(t,e,i,o){try{var r=this.getCellInfo(t);("select"==r.options.inputType||"autoComplete"==r.options.inputType||"checkcombobox"==r.options.inputType)&&r.setColumnNodeSet(e,i,o),r.hasRef&&(r.refHash=[]),r.itemsetObj&&r.mainGrid.refresh()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnGridItemset=function(t,e){try{var i=this.getCellInfo(t);("select"==i.options.inputType||"autoComplete"==i.options.inputType||"checkcombobox"==i.options.inputType)&&i.setColumnGridItemset(e),i.hasRef&&(i.refHash=[]),i.itemsetObj&&i.mainGrid.refresh()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);if(i.options.displayFormat=e,i._changeDisplayFormat=!0,i.options.embeddedInput)for(var o=WebSquare.format.createFormatter(i.options.dataType,i.options.displayFormat,i.options.displayFormatter,i.options.ioFormat,null,null,i.mainGrid.scope_id,i.mainGrid.id),r=0;r<i.mainGrid.getDataLength();r++){var a=i.mainGrid.dataList._getCellData(r,t);t=i.mainGrid.getColumnIndex(t);var n=i.mainGrid.data_td_list[t+r*i.mainGrid.oneRowDataLength],l=i.mainGrid.getInput(i,n,a);l&&(l.formatter=o)}return i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnIoFormat=function(t,e,i){try{"object"==typeof arguments[0]?this._setColumnIoFormat(arguments[0]):this._setColumnIoFormat({colIndex:t,ioFormat:e,dateMask:i})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setColumnIoFormat=function(t){try{var e=t.colIndex,i=t.ioFormat,o=t.dateMask,r=t.useMonthYearFormat,a=t.calendarDisplayFormat,n=this.getCellInfo(e);if(!n||"custom"===n.options.inputType||"date"!==n.options.dataType)return;var l=!1,h=n.options.ioFormat;if("string"==typeof i&&(l=i!==h,n.options.ioFormat=i),"string"==typeof o&&(n.options.displayFormat=o),"calendar"===n.options.inputType&&(n.options.useMonthYearFormat=r,"string"==typeof a&&(n.options.calendarDisplayFormat=a)),n.initFormatter(),!0===l){for(var d=n.options.embeddedInput?this.getRowCount():1,p=0;p<d;p++){var u=this.dataList._getCellData(p,e),c=this.data_td_list[e+p*this.oneRowDataLength],g=n.mainGrid.getInput(n,c,u);if(g&&"function"==typeof g.setIoFormat){t={ioFormat:i,displayFormat:o,useMonthYearFormat:r,calendarDisplayFormat:a};g.setIoFormat(t)}}if(n.options.useMonthYearFormat)this.drawColumnData(e);else for(var f=WebSquare.format.createFormatter(n.options.dataType,i,"",h,null,null,this.scope_id,this.id),m=0;m<this.getRowCount();m++){var y=this.dataList._getCellData(m,n.colID),b=f.format(y);this.dataList.__setCellData(m,n.colID,b)}}else this.drawColumnData(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnEditFormat=function(t,e){try{t=this.getColumnIndex(t);var i=this.getCellInfo(t),o=i.id,r=i.options.inputType;if("text"!=r&&"input"!=r)return $l("Invalid cell input type."),!1
;var a=this.getInput(i);if(a&&a.options&&"input"===a.options.pluginName){i.options.editFormat=e,a.setEditFormat(e);for(var n=this.getTotalRow(),l=0;l<n;l++){var h=this.dataList.getCellData(l,o),d=WebSquare.text.dynamicMask(h,a._editFormat,a._editTokens);this.dataList.setCellData(l,o,d.orgValue)}this.drawColumnData(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnChooseOption=function(t,e,i){try{var o=this.getCellInfo(t);"select"==o.options.inputType&&o.setColumnChooseOption(e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnVisibleColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setVisibleColumn&&o[o.options.inputType].setVisibleColumn(e,i))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnEnableColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setEnableColumn&&o[o.options.inputType].setEnableColumn(e,i))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDisplayMode=function(t,e){try{if("label"==e||"value"==e||"value delim label"==e||"label delim value"==e){var i=this.getCellInfo(t);if(!0==={select:!0,checkcombobox:!0,autoComplete:!0}[i.options.inputType]){var o=i.options.displayMode;i.options.displayMode=e,i._initDisplayMode(),o!=i.options.displayMode&&(i[i.options.inputType]&&i[i.options.inputType].setDisplayMode(e),i.resetMatchInfo=!0,this.drawColumnData(t))}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDelimiter=function(t,e){try{var i=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[i.options.inputType]&&i.options.delimiter!=e&&(i.options.delimiter=e||"\t","0"!=i.options.displayMode&&"3"!=i.options.displayMode&&(i[i.options.inputType]&&i[i.options.inputType].setDelimiter(e),i.resetMatchInfo=!0,this.drawColumnData(t)))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.showChooseOption=function(t,e){try{var i=this.getCellInfo(t);"select"==i.options.inputType&&i.showChooseOption(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setRowNumColumnWidth=function(t){this.options.rowNumVisible&&!isNaN(Number(t))&&this._setColumnWidth(0,t)},D.prototype.setRowStatusColumnWidth=function(t){var e=0;this.options.rowNumVisible&&(e=1),this.options.rowStatusVisible&&(this.options.autoFit&&!this.hiddenList[e]?(this.autoFitColWidthList=null,this._setColumnWidth(e,t),this._setAutoFit()):this._setColumnWidth(e,t))},D.prototype.setGridHeight=function(t){try{parseInt(t)+""==t&&(t+="px"),this._setGridHeightBefore(),this.setStyle("height",t),this.handleScrollY({},{changedHeight:!0}),this.handleResize(),this._setGridHeightAfter()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setGridHeightBefore=function(t){try{this._onSetHeight=!0,this.lastTopRowIndex=null,-1!==this.options.initFixedHeightByRowNum&&(this.options.initFixedHeightByRowNum=-1,!0!==this._isNativeScroll()&&(this.options.visibleRowNum=""))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setGridHeightAfter=function(t){try{this._onSetHeight=!1}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setGridWidth=function(t){parseInt(t)+""==t&&(t+="px"),this.setStyle("width",t),this.handlerResize_drawInitializer()},D.prototype.setGridSize=function(t,e){var i=parseInt(t),o=parseInt(e);i>=0&&o>=0?(this.setGridWidth(t),this.setGridHeight(e)):p.v.printLog("[Warning] Number of Entered in the width and height must be a valid integer greater than 0.["+this.id+"]")},D.prototype.setGridReadOnly=function(t){try{t=a.Z.getBoolean(t),this.options.readOnly=t,this.notifyDataChanged()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getGridReadOnly=function(){try{
return this.options.readOnly}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.initGrid=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.removeAllFinish=!0,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1;var t=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:t,row:{},init:!1},this.clearCellVisible({skipDraw:!0}),this.initHeightCompleted=!1,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj();var e=this.dataList.removeAll();return this.removeAllFinish=!1,this.dataList.clearFilter(),this.initColumns(),e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setInitValue=function(){try{this.initGrid()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);return i.element&&i.element.setAttribute("displayFormat",e),i.options.displayFormat=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setFormat=function(t,e){try{var i=this.getCellInfo(t);if(e.ioFormat){var o=i.mainGridId+i.id,r=this.dom[o];r&&r.setFormat({ioFormat:e.ioFormat,displayFormat:e.ioFormat});for(var a=WebSquare.format.createFormatter("date",e.ioFormat,"",i.options.ioFormat,null,null,this.scope_id,this.id),n=0;n<this.getDataLength();n++){var l=this.getColumnID(t),h=this.dataList._getCellData(n,l),d=a.format(h);this.dataList.__setCellData(n,l,d)}}return i.options.ioFormat=e.ioFormat||i.options.ioFormat,i.options.displayFormat=e.displayFormat||i.options.displayFormat,i.options.displayFormatter=e.displayFormatter||i.options.displayFormatter,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCustomFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.customFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setAllowChar=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o)return $l("Invalid cell input type."),!1;var r=this.getInput(i);return i.options.allowChar=e,void(r&&r.options&&("input"===r.options.pluginName||"textarea"===r.options.pluginName)&&r.setAllowChar(e))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.changeCurrency=function(t,e,i,o,r,a,n){try{return 1===arguments.length&&"object"==typeof arguments[0]?this._changeCurrency(arguments[0]):this._changeCurrency({colID:t,type:e,format:i,delimiter:o,decimalDelimiter:r,customModelFormatter:a,customModelUnformatter:n})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._changeCurrency=function(t){try{var e=t.colID||"",i=t.type||"",o=t.format,n=t.delimiter||"",l=t.decimalDelimiter||"",h=t.subtotalColID||"",d=t.footerColID||"",p=t.customModelFormatter,u=t.customModelUnformatter,c=WebSquare.util.getDataPrefix("dataType"),g=WebSquare.util.getDataPrefix("displayFormat"),f=this.getColumnIndex(e),m=this.getCellInfo(f);if(!i||"float"!==i&&"number"!==i&&"euro"!==i&&"rupee"!==i&&"tenge"!==i)return;"number"===i&&"true"===this.options.floatNumber&&(i="float");var y=i;switch(i){case"number":case"float":case"bigDecimal":y="number",o||(this.options.numberMask||(this.options.numberMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/numberMask/@value')||""),o=this.options.numberMask),m.options.delimiter=n||",",m.options.decimalDelimiter=l||".";break;case"euro":o||(this.options.euroMask||(this.options.euroMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/euroMask/@value')||""),o=this.options.euroMask),m.options.delimiter=n||".",m.options.decimalDelimiter=l||",";break
;case"rupee":o||(this.options.rupeeMask||(this.options.rupeeMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/rupeeMask/@value')||""),o=this.options.rupeeMask),m.options.delimiter=n||",",m.options.decimalDelimiter=l||".";break;case"tenge":o||(this.options.tengeMask||(this.options.tengeMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/tengeMask/@value')||""),o=this.options.tengeMask),m.options.delimiter=n||" ",m.options.decimalDelimiter=l||","}if(!o)return;if(m.options.dataType=i,m.options.displayFormat=o,void 0!==p?m.options.customModelFormatter=p:m.options.customModelFormatter||(m.options.customModelFormatter=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/customModelFormatter/@value')||""),void 0!==u?m.options.customModelUnformatter=u:m.options.customModelUnformatter||(m.options.customModelUnformatter=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/customModelUnformatter/@value')||""),m.initFormatter(),this.drawColumnData(f),this.hasSubtotal){this.subtotalObj={};var b=h.split(",");if(b.length>0)for(var v=0;v<b.length;v++){var w=b[v];for(var C in this.subtotalTableList)for(var I=this.subtotalTableList[C],_=!1,x=0;x<I.rows.length;x++){for(var S=I.rows[x].getElementsByTagName("td"),R=0;R<S.length;R++){var D=S[R];if(D.getAttribute("id")===w&&(D.setAttribute(c,i),D.setAttribute(g,o),_=!0),_)break}if(_)break}}this.refreshSubtotalRow(0)}if(this.hasFooter){var T=d.split(",");if(T.length>0)for(v=0;v<T.length;v++){var L=T[v],k=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),F=a.Z.getDataPrefix("footer_id");for(x=0;x<k.length;x++){var A=k[x];if(A.getAttribute(F)===L){A.setAttribute(c,i),A.setAttribute(g,o);break}}}this.initFooterDataObj(),this.drawFooter(f)}var E=m.mainGridId+m.id;delete this.dom[E]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDataType=function(t,e,i){try{if(!e||"number"!=e&&"text"!=e&&"float"!=e&&"date"!=e)return;var o=this.getCellInfo(t);if(o.options.dataType==e)return;o.options.dataType;o.options.dataType=e;var r=this.getColumnID(t);this.setColumnOption(r,"dataType",e);var a=o.mainGrid.getElementById(o.mainGridId+r);if(o.options.displayFormat="",a){switch(a.validator.clearCommand(),e){case"number":a.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9"));break;case"float":a.validator.addCommand(new WebSquare.validator.floatCommand(a.options.delimiter,a.options.decimalDelimiter,a.options.applyFormat))}var n=a.options.maxlength&&parseInt(a.options.maxlength)>-1?a.options.maxlength:null;n||(n=a.options.maxLength&&parseInt(a.options.maxLength)>-1?a.options.maxLength:null),n&&("float"==e?(o.setFloatMaxLength(n),a.render&&"input"==a.render.tagName.toLowerCase()&&a.render.removeAttribute("maxLength")):o.setMaxLength(n))}o.initFormatter(),o._changeDisplayFormat=!0,i&&i.displayFormat&&this.setColumnDisplayFormat(t,i.displayFormat),o.mainGrid.refreshColumn(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDefaultDate=function(t,e){try{var i=this.getCellInfo(t);if("calendar"!==i.options.inputType)return $l("Invalid cell input type."),!1;var o=this.getInput(i);i.options.defaultDate=e,o&&o.setDefaultDate(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.disableBeforeDate=function(t,e){this.setDisableBeforeDate(t,e)},D.prototype.setDisableBeforeDate=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableBeforeDate(e)}else(i=this.getInput(o))&&i.setDisableBeforeDate(e);o.options.disableBeforeDate=e}catch(t){
s.Y.printStackTrace(t,null,this)}},D.prototype.disableAfterDate=function(t,e){this.setDisableAfterDate(t,e)},D.prototype.setDisableAfterDate=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableAfterDate(e)}else(i=this.getInput(o))&&i.setDisableAfterDate(e);o.options.disableAfterDate=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDisableBeforeMonth=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableBeforeMonth(e)}else(i=this.getInput(o))&&i.setDisableBeforeMonth(e);o.options.disableBeforeMonth=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDisableAfterMonth=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableAfterMonth(e)}else(i=this.getInput(o))&&i.setDisableAfterMonth(e);o.options.disableAfterMonth=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setMaxLength=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"textarea"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o&&"autoComplete"!=o)return;"text"==o&&"float"==i.options.dataType?i.setFloatMaxLength(e):i.setMaxLength(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getMaxLength=function(t){try{var e=this.getCellInfo(t),i=e.options.inputType;if("text"!=i&&"textarea"!=i&&"input"!=i&&"textImage"!=i&&"secret"!=i)return;return e.options.maxLength}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.spanAll=function(t){try{"number"==typeof t?this.showDepth=t+"":(t=a.Z.getBoolean(t),this.showDepth=1==t?"9999":"1"),this.initDrilldown(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.drawData(0,0),this.setScrollYHeight({noDraw:!0}),this.drawFooter(),this.displayNoResultMessage(),this.displayFixedColumnLine()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCellDisplayData=function(t,e){try{var i=(this._linkedDataList||this._dataList).getRealRowIndex(t);return this._getDisplayData(i,e)}catch(t){s.Y.printStackTrace(t)}},D.prototype._getCellDisplayData=function(t,e,i){try{i=i||{},"string"==typeof e&&(e=e.trim());var o=this.getRealRowIndex(t);return this._getDisplayData(o,e,i)}catch(t){s.Y.printStackTrace(t)}},D.prototype._getDisplayData=function(t,e,i){try{i=i||{},this.editEndBeforeGetData();e=this.getColumnID(e);var o=this.getColumnIndex(e),r=this.cellInfoHash[e];0==r.internal&&"custom"==r.options.inputType&&r.cellManagerHashByRowIndex[t]&&(r=r.cellManagerHashByRowIndex[t]);var n=this.dataList._getData(t,e),l=this.getDisplayRowIndex(t),h=this._getGroupbyDisplayRowIndex(l);if(r.options.customModelUnformatter){var d=a.Z.getGlobalFunction(r.options.customModelUnformatter,this.scope_id);"function"==typeof d&&(n=d.call(this,n,h,o))}if(r.options.maskFormat&&r.options.displayFormat&&(n=this.getInput(r[o]).maskFormatModelUnFormat(n)),r.useEscapeFormatter){var p=a.Z.getGlobalFunction(r.options.escapeFormatter,this.scope_id);"function"==typeof p&&(n=p.call(this,n,h,o))}if(r.useCustomFormatter&&1!=this.options.keepBeforeDisplayData){var u="true"===r.getEscape()?r.getDisplayData(WebSquare.xml._encode(n+""),t):r.getDisplayData(n,t),c=a.Z.getGlobalFunction(r.options.customFormatter,this.scope_id);"function"==typeof c&&(n=this.options.customFormatterRealRowIndex?c.call(this,n,u,t,o):c.call(this,n,u,h,o))
}else 0==r.internal&&"custom"==r.options.inputType&&(r=r.cellManagerHashByRowIndex[t]?r.cellManagerHashByRowIndex[t]:r),n=r.getDisplayData(n,t,i);if(!0===i.removeTag){var g=document.createElement("div");g.innerHTML=n,n=g.innerText}return null==n&&(n=""),n}catch(t){s.Y.printStackTrace(t)}},D.prototype.initPasteDrilldown=function(){try{var t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""};"string"==typeof t.depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.pasteDrilldownInitialize(this,t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.initDrilldown=function(t){try{"string"==typeof(t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""}).depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.initialize(this,t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getRealRowIndex=function(t){return this.dataList.getRealRowIndex(t)},D.prototype.toggle=function(t){try{if("number"!=typeof t)return!1;var e=t;if(this.options.drilldownRealRowIndexAll&&"number"!=typeof(e=this.getDisplayRowIndex(t)))return!1;this._toggle(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._toggle=function(t){try{t=parseInt(t),this.drilldown.toggle(t);var e={};this.options.drilldownToggleScrollFix&&(e.keepScrollTop=!0),this.lastTopRowIndex=null,!0===this._isHybridScroll()?this.hasSubtotal&&(e.keepHybridHash=!0):this.setScrollYHeight(e),this.notifyRowChanged(t,e),this.options.autoFit&&this.autoFitFunc()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.drillTo=function(t){try{var e=this.drilldown.drillTo(t),i=this.options.drilldownToggleScrollFix?{keepScrollTop:!0}:null;this.setScrollYHeight(i),this.notifyRowChanged(e,i),this.options.autoFit&&this.autoFitFunc()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getParentRowIndex=function(t){return t=parseInt(t),this.drilldown.getParentRowIndex(t)},D.prototype.getChildrenRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildrenRowArr(t)},D.prototype.getAncestorRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getAncestorRowArr(t)},D.prototype.getDescendantRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildRowArr(t,!0)},D.prototype.getOpenStatus=function(t){var e=t=parseInt(t);return(!this.options.drilldownRealRowIndexAll||"number"==typeof(e=this.getDisplayRowIndex(t)))&&this.drilldown.isOpen(e)},D.prototype.getDataLength=function(){var t;if(this.successBinding)if(this.groupbyStatus.grouped){for(var e in this.customFilterStatusObj)if(this.customFilterStatusObj[e])return this._dataList.getDataLength();t=this.groupbyStatus.groupedRowIndexArr.length}else t=this._dataList.getDataLength();else t=0;return t},D.prototype.focusedRowMoveUp=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUp(t)},D.prototype.focusedRowMoveDown=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDown(t)},D.prototype.focusedRowMoveUpFiltered=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUpFiltered(t)},D.prototype.focusedRowMoveDownFiltered=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDownFiltered(t)},D.prototype.initStyleArr=function(t){t<=0&&(this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[]);var e=this.getTotalRow(),i=e*this.oneRowDataLength;t<=0?(this.rowStyleArr=new Array(e),this.rowReadOnlyArr=new Array(e),this.rowDisabledArr=new Array(e),this.rowStyleFixedArr=new Array(e),this.rowStyleDataArr=new Array(e),this.cellStyleArr=new Array(i),this.cellClassArr=new Array(i),this.cellReadOnlyArr=new Array(i),this.cellDisabledArr=new Array(i),
this._cellSelectedIndex=new Array(i)):(this.rowStyleArr[e-1]=void 0,this.rowStyleFixedArr[e-1]=void 0,this.rowStyleDataArr[e-1]=void 0,this.rowReadOnlyArr[e-1]=void 0,this.rowDisabledArr[e-1]=void 0,this.cellStyleArr[i-1]=void 0,this.cellClassArr[i-1]=void 0,this.cellReadOnlyArr[i-1]=void 0,this.cellDisabledArr[i-1]=void 0,this._cellSelectedIndex[i-1]=void 0)},D.prototype.modifyCheckedStatus=function(t,e){try{var i=this.getCheckedIndex(t);if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else p.v.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.modifyUncheckStatus=function(t,e){try{if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var i=this.getUnCheckedIndex(t),o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else p.v.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getVisibleColData=function(t){var e=[];t=this.getColumnIndex(t);for(var i=this.getColumnID(t),o=this.getDataLength(),s=0;s<o;s++)e.push(this.dataList._getCellData(s,i));return e},D.prototype.getCheckedIndex=function(t,e){try{var i,o=[],r=[],a=0,n=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==n.options.inputType||"radio"==n.options.inputType||"custom"==n.options.inputType){i=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var l=n,h=0;h<i.length;h++){if(0==n.internal&&"custom"==n.options.inputType){var d=this.dataList.getRealRowIndex(h);if("checkbox"!=(l=n.cellManagerHashByRowIndex[d]?n.cellManagerHashByRowIndex[d]:n).options.inputType&&"radio"!=l.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==typeof this.dataList.getRealRowIndex(h))continue;if(e){r.push(h);var p=!(!this.isDrillDown||!this._dataList.options.depthColumn);this.___getEditReadOnly(h,t,p)||this._getEditDisabled(h,t,p)?a++:i[h]==l.options.trueValue&&o.push(h)}else i[h]==l.options.trueValue&&o.push(h)}}return e&&a!==r.length&&a+o.length==r.length?r:o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getUnCheckedIndex=function(t){return this.getUncheckedIndex(t)},D.prototype.getUncheckedIndex=function(t){try{var e=[],i=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==i.options.inputType||"radio"==i.options.inputType||"custom"==i.options.inputType){var o=[];o=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var r=i,a=0;a<o.length;a++){if(0==i.internal&&"custom"==i.options.inputType){var n=this.dataList.getRealRowIndex(a);if("checkbox"!=(r=i.cellManagerHashByRowIndex[n]?i.cellManagerHashByRowIndex[n]:i).options.inputType&&"radio"!=r.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==typeof this.dataList.getRealRowIndex(a))continue;o[a]!=r.options.trueValue&&e.push(a)}}return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getAllDisplayData=function(){try{var t=this._linkedDataList||this._dataList;if(t.getTotalRow()==t.getDataLength())return this.getAllVisibleData("displayData");this._endEdit();for(var e=this.getTotalRow(),i=this.getColumnCount(),o=[],r=0;r<e;r++)for(var a=0;a<i;a++)o.push(this._getDisplayData(r,a));return o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getAllDisplayJSON=function(t){try{t||(t={emptyValue:"$$_blank_"});var e=this._linkedDataList||this._dataList;if(e.getTotalRow()==e.getDataLength())return this.getAllVisibleJSON(t);this._endEdit();for(var i=this.getTotalRow(),o=this.getColumnCount(),r=[],a=0;a<i;a++){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._getDisplayData(a,l,t);r.push(n)}return r}catch(t){
s.Y.printStackTrace(t,null,this)}},D.prototype.getAllVisibleJSON=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),r=[],a=0;a<i;a++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[a]){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._grid._getCellDisplayData(a,l,t);r.push(n)}return r}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getAllDisplayXML=function(){try{var t=this._linkedDataList||this._dataList;return t.getTotalRow()==t.getDataLength()?this.getAllVisibleXML("displayData"):(this._endEdit(),this.getAllArrXML("displayData",this.id))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getAllVisibleXML=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=[],r=0;r<i;r++)e&&"number"!=typeof this.groupbyStatus.groupedRowIndexArr[r]||o.push(r);return this.getArrXML(o,t,e)}catch(t){s.Y.printStackTrace(t)}},D.prototype.getAllVisibleData=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),r=[],a=0;a<i;a++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[a])for(var n=0;n<o;n++)"displayData"===t?r.push(this._getCellDisplayData(a,n)):r.push(this.dataList.getCellData(a,n));return r}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.changeToRealRowIndexArr=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCheckedXML=function(t){try{this._endEdit();var e=this.getCheckedIndex(t);return this.getArrXML(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getUncheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getUncheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getUncheckedXML=function(t){try{this._endEdit();var e=this.getUncheckedIndex(t);return this.getArrXML(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCellChecked=function(t,e){try{var i=this.cellInfoHash[this.getColumnID(e)],o=i.id;if(0==i.internal&&"custom"==i.options.inputType){var r=this.dataList.getRealRowIndex(t);i=i.cellManagerHashByRowIndex[r]?i.cellManagerHashByRowIndex[r]:i}if("checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)return!1;var a=this.dataList._getCellData(t,o);return a=a==i.options.trueValue}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.hasChild=function(t){return this.drilldown.hasChild(t)},D.prototype.comparator=function(t,e){return parseInt(e)==parseInt(t)?0:parseInt(e)>parseInt(t)?1:-1},D.prototype.getExcelAllXML=function(t){try{var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=0;i<this.getDataLength();i++)for(var o=0;o<this.getTotalCol();o++)e.push(this.dataList._getCellData(i,this.getColumnID(o))),e.push('","');return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getExcelAllXMLDisplay=function(t){try{null==t&&(t=1);var e=new Array;e.push("<array><![CDATA["),e.push('["')
;for(var i=this.getDataLength(),o=this.getColumnCount(),r=0;r<i;r++)for(var a=0;a<o;a++){var n,l=this.getCellInfo(a);if("custom"==l.options.inputType){var h=this.dataList.getRealRowIndex(r);l.cellManagerHashByRowIndex[h]||(this.drawData(r),l=l.cellManagerHashByRowIndex[h]||l)}(n=l.useCustomFormatter||"custom"==l.options.inputType?this._getDisplayData(this.dataList.getRealRowIndex(r),a):1==t?l.getDisplayData(this.dataList._getCellData(r,this.getColumnID(a)),r):this.dataList._getCellData(r,this.getColumnID(a))+"").indexOf("javascript:")>-1&&(n=n.wq_replaceAll("javascript:","")),e.push(n),e.push('","')}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getExcelAllXMLRaw=function(t){try{var e=this.dataArr.length,i=this.dataArr[0],o=this.dataArr[e-1];this.dataArr[0]='<array><![CDATA[["'+i,this.dataArr[e-1]=o+'"]]]></array>';var r=this.dataArr.join('","');return this.dataArr[0]=i,this.dataArr[e-1]=o,r}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.makeExcelData=function(t,e,i,o){try{var n=e.length,l=t+i.rowsByN;l=l<i.dataLength?l:i.dataLength;var h,d=this.oneRowDataLength,p=i.separator||",";if(i.convertIndex&&(h=i.convertIndex.split(",")),""==i.dataProvider&&""==i.splitProvider)if(0===i.type)for(var u=t;u<l;u++){if("number"==typeof(b=this.dataList.getRealRowIndex(u)))for(var c=0;c<d;c++){var g=!1;if(h)for(var f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelDisplayData(b,c,e,i,u)).length:(e=this._getExcelRealData(b,c,e,i)).length}}else if(1===i.type||2==i.type)for(u=t;u<l;u++){if("number"==typeof(b=this.dataList.getRealRowIndex(u)))for(c=0;c<d;c++){g=!1;if(h)for(f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelRealData(b,c,e,i)).length:(e=this._getExcelDisplayData(b,c,e,i,u)).length}}else l=i.dataLength,n=(e=this.dataList.getAllData()).length;var m=this;if(l<i.dataLength&&""==i.dataProvider&&""==i.splitProvider)if(!1!==i.massStorage)this.excelTime=setTimeout((function(){try{!0===i.showConfirm&&window.gridExceldownloadIframe.contentWindow.checkUpload(e.length/m.dataArr.length)}catch(t){s.Y.printStackTrace(t,null,this)}if(0!=i.multiexcel)return m.makeExcelData(l,e,i,o);m.makeExcelData(l,e,i,o)}),10);else{if(0!=i.multiexcel)return this.makeExcelData(l,e,i,o);this.makeExcelData(l,e,i,o)}else{var y;if(""==i.dataProvider&&""==i.splitProvider)if(e.length>=2){if(i.groupby&&this.groupbyStatus.grouped&&this.defaultColCnt>0){var b=1,v=this.oneRowDataLength,w=[];for(u=0;u<e.length;u++){if((u%v==0||0==u)&&(b=parseInt(u/v,10),this.options.rowNumVisible&&w.push(b+1),this.options.rowStatusVisible)){var C=this.getRowStatus(b);w.push(C)}w.push(e[u])}n=(e=w).length}if(n>0){var I=e[0],_=e[n-1];e[0]='<array><![CDATA[["'+I,e[n-1]=_+'"]]]></array>',y=e.join('"'+p+'"'),e[0]=I,e[n-1]=_}else y="<array><![CDATA[["+e+"]]]></array>"}else{y="<array><![CDATA[["+(1===e.length?'"'+e[0]+'"':"")+"]]]></array>"}else y="<array><![CDATA[[ ]]]></array>";if(!0===i.showConfirm)this.excelOptions=i,this.excelInfoArr=o,this.excelFinalStr=y,this.checkUpload();else{if(0!=i.multiexcel)return this.sendExcelData(i,o,y);this.sendExcelData(i,o,y)}}}catch(t){var x=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/excel/download/errorHandler/@value"),S=a.Z.getGlobalFunction(x,this.scope_id);"function"==typeof S&&S.call(this,this.id),s.Y.printStackTrace(t,null,this)}},D.prototype._getExcelRealData=function(t,e,i,o){try{var r=o.cellInfo,a=o.isExpCol,n=i;if(a[e])n.push(r[e].getExpressionValue(t));else{var l=this.dataList._getData(t,e);n.push(null!=l?l:"")}return n}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getExcelDisplayData=function(t,e,i,o,r){try{var a,n=o.cellInfo,l=o.isSelectCol,h=o.isBasicCol,d=o.isExpCol,p=o.isCustomCol,u=o.isCustomModelCol,c=o.isCustomType,g=o.isEscapeFormatter,f=i;if(d[e]&&(a=n[e].getExpressionValue(t)),p[e]||u[e]||g[e]?a=this._getDisplayData(t,e):(a=this.dataList._getData(t,e),
n[e].options.useMonthYearFormat&&"calendar"===n[e].options.inputType&&(a=WebSquare.date.getIOFormatDate(a,n[e].options.ioFormat,n[e].options.calendarValueType)),a=null!=a?a:""),h[e]||d[e])n[e].options.maskFormat&&n[e].options.displayFormat&&(a=this.getInput(n[e]).maskFormatModelUnFormat(a)),a=n[e].formatter?n[e].formatter.format(a):a;else if(!l[e]||p[e]||u[e]){if(c[e]){x=null;var m,y=n[e].cellManagerHashByRowIndex[r];y?m=(n=y).options.inputType:(n=n[e],m="text");var b=n.useCustomFormatter,v=n.useCustomModelFormatter,w=n.useEscapeFormatter,C="select"===m||"checkcombobox"===m||"autoComplete"===m,I="expression"===m,_=!("checkbox"===m||"image"===m||"radio"===m||C||I||b||v||w);if(b||v||w?a=this._getDisplayData(t,e):(a=this.dataList._getData(t,e),n.options.useMonthYearFormat&&"calendar"===n.options.inputType&&(a=WebSquare.date.getIOFormatDate(a,n.options.ioFormat,n.options.calendarValueType)),a=null!=a?a:""),_||I)n.options.maskFormat&&n.options.displayFormat&&(a=this.getInput(n).maskFormatModelUnFormat(a)),a=n.formatter?n.formatter.format(a):a;else if(C&&!b&&!v){x=null;null==(x=2==o.type?this.dataList._getData(t,e):n.getData(a,t))&&(x=""),a=x}}}else{var x=null;if(2==o.type)x=this.dataList._getData(t,e);else{var S=n[e].dataComp,R=t;if(S){var D=this.modelControl.getDataComp(S);D&&"linkedDataList"===D.initializeType&&(R=r)}x=n[e].getData(a,R)}null==x&&(x=""),a=x}return"string"==typeof a&&a.indexOf("javascript:")>-1&&(a=a.wq_replaceAll("javascript:","")),f.push(a),f}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getStyleRowIndex=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);return null==e?e=null:"number"!=typeof e&&(e=e.type+"_"+e.groupId),e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getRowStyleClassName=function(t,e){try{var i=e?t:this._getStyleRowIndex(t);return null==i?null:this.rowStyleArr[i]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setRowStyleClassName=function(t,e,i){try{var o=i?t:this._getStyleRowIndex(t);if(null==o)return;this.rowStyleArr[o]=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCellStyleClassName=function(t,e,i){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var o=i?t:this._getStyleRowIndex(t);return null==o?void 0:"number"==typeof o?this.cellStyleArr[o*this.oneRowDataLength+e]:this.cellStyleArr[o+"_"+e]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellStyleClassName=function(t,e,i,o){try{e=this.getColumnIndex(e);var r=o?t:this._getStyleRowIndex(t);if(null==r)return;"number"==typeof r?this.cellStyleArr[r*this.oneRowDataLength+e]=i:this.cellStyleArr[r+"_"+e]=i}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getCellClass=function(t,e){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var i=this._getStyleRowIndex(t);return null==i?void 0:"number"==typeof i?this.cellClassArr[i*this.oneRowDataLength+e]:this.cellClassArr[i+"_"+e]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellDefaultStyleClassName=function(t,e,i){try{e=this.getColumnIndex(e);var o=this.getCellStyleClassName(t,e,i);return null==o&&(this.cellStyleIndex++,o=this.id+"_cellstyle_"+this.cellStyleIndex+"_",this.setCellStyleClassName(t,e,o,i)),null==this.cellStyleValueObj[o]&&(this.cellStyleValueObj[o]={}),o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellClass=function(t,e,i,o){try{var r,a;e=this.getColumnIndex(e);var n,l=!(!this.isDrillDown||!this._dataList.options.depthColumn);if(o?(r=t,a=this.getDisplayRowIndex(t)-this.rowIndex):(r=this._getStyleRowIndex(t),a=l?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex),a>=0&&(n=this.data_td_list[a*this.oneRowDataLength+e]),null==r)return;if("number"==typeof r){var h=this.tdCellClassArr[a*this.oneRowDataLength+e];h&&this.removeClass(n,h),this.cellClassArr[r*this.oneRowDataLength+e]=i}else this.cellClassArr[r+"_"+e]=i;n&&(this.tdCellClassArr[a*this.oneRowDataLength+e]=i,this.addClass(n,i))}catch(t){s.Y.printStackTrace(t,null,this)}},
D.prototype.removeCellClass=function(t,e,i){try{e=this.getColumnIndex(e);var o,r=this._getStyleRowIndex(t);if(o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex,null==r)return;"number"==typeof r?this.cellClassArr[r*this.oneRowDataLength+e]=void 0:this.cellClassArr[r+"_"+e]=void 0;var a=this.data_td_list[o*this.oneRowDataLength+e];a&&(i||(i=this.tdCellClassArr[o*this.oneRowDataLength+e]),this.tdCellClassArr[o*this.oneRowDataLength+e]=void 0,this.removeClass(a,i))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._removeAllTDCellClass=function(){try{for(var t=this.tdCellClassArr.length,e=0;e<t;e++){var i=this.tdCellClassArr[e],o=this.data_td_list[e];o&&i&&this.removeClass(o,i)}this.tdCellClassArr=[]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setColumnClass=function(t,e){try{var i=this.getColumnIndex(t);if(this.columnClassObj[i]){var o=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim();this.columnClassObj[i]=o+" "+e}else this.columnClassObj[i]=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._setColumnClass(t,i[o]);for(o=this.getColumnIndex(t);o<this.data_td_list.length;o+=this.oneRowDataLength){var r=this.data_td_list[o];r&&this.addClass(r,e)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._removeColumnClass=function(t,e){try{var i=this.getColumnIndex(t);this.columnClassObj[i]=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim(),this.columnClassObj[i]||delete this.columnClassObj[i];for(var o=i;o<this.data_td_list.length;o+=this.oneRowDataLength){var r=this.data_td_list[o];r&&this.removeClass(r,e)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.removeColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._removeColumnClass(t,i[o])}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getColumnClass=function(t){try{var e=this.getColumnIndex(t);return this.columnClassObj[e]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._refreshColumnClass=function(){try{for(var t in this.columnClassObj)this.setColumnClass(this.columnClassObj[t])}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getRowStyleFixedClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleFixedArr[e]}catch(t){$l("getRowStyleFixedClassName :"+t.message),s.Y.printStackTrace(t,null,this)}},D.prototype.setRowStyleFixedClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleFixedArr[i]=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getRowStyleDataClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleDataArr[e]}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setRowStyleDataClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleDataArr[i]=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.refreshColumnItemset=function(t){try{var e=this.getCellInfo(t);if(e.resetMatchInfo=!0,e.options.embeddedInput){t=this.getColumnIndex(e.options.col_id);for(var i=0;i<this.drawedRowLength;i++){var o=this.data_td_list[t+i*this.oneRowDataLength];if(o){var r=this.dom[o.getAttribute("id")+"_select"];r&&r.refreshItemset()}}}else"select"==e.options.inputType?(e.hasRef&&(e.refHash=[]),e.select&&e.select.refreshItemset(),e.itemsetObj&&e.mainGrid.refresh()):"checkcombobox"==e.options.inputType&&(e.refreshItemArr(),e.checkcombobox)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.refreshRadioGroup=function(t){try{for(var e={},i=[],o=0;o<this.oneRowDataLength;o++){"radio"==(l=this.getCellInfo(o)).options.inputType&&l.options.groupName==t&&(l.options.groupRef&&(l.options.groupValue=WebSquare.ModelUtil.getInstanceValue(l.options.groupRef,null,this.scope_id)),e[l.options.groupValue]=l,i.push(l))}if(0==i.length)return
;var r=this.getDataLength();for(o=0;o<r;o++){var a=e[this.dataList._getCellData(o,t)];if(a)this.dataList.__setCellData(o,a.id,a.options.trueValue);else{for(var n=0;n<i.length;n++){var l=i[n];this.dataList.__setCellData(o,l.id,l.options.defaultValue)}var h=this.getCellInfo(t);h&&this.dataList.__setCellData(o,t,h.options.defaultValue)}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.resetRadioGroup=function(t,e){return this._resetRadioGroup.call(this,t,e,!0)},D.prototype._resetRadioGroup=function(t,e,i){try{for(var o=[],r=0;r<this.oneRowDataLength;r++){"radio"==(h=this.getCellInfo(r)).options.inputType&&h.options.groupName==e&&o.push(h)}if(0==o.length)return;if("number"==typeof t)var a=t,n=t+1;else a=0,n=this.getDataLength();for(r=a;r<n;r++){for(var l=0;l<o.length;l++){var h=o[l];this.dataList.__setCellData(r,h.id,h.options.defaultValue)}if(i){var d=this.getCellInfo(e);d&&this.dataList.__setCellData(r,e,d.options.defaultValue)}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.xmlData2ArrData=function(t,e,i){try{if(null==t)return;if(9==t.nodeType)r=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);else if(o=i&&i.baseNode?i.baseNode:this.options.baseNode,i&&i.isRepeatNode)r=(t=WebSquare.xml.parse(WebSquare.xml.serialize(t))).selectNodes("/"+i.repeatNode);else if(o.startsWith(t.tagName))var o=o.replace(t.tagName,"."),r=t.selectNodes(o+"/"+this.options.repeatNode);else t=WebSquare.xml.parse(WebSquare.xml.serialize(t)),r=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);for(var n=[],l=this.options.valueNode,h=null==l||""==l,d=a.Z.getTextNodeValue,p=r.length,u=this.tdIdList.length,c=[],g=[],f=[],m=0;m<u;m++){c[m]=this.getCellInfo(this.tdIdList[m]);var y=c[m].options;null!=y.importFormatter&&""!=y.importFormatter&&(g[m]=!0),null!=y.importExp&&""!=y.importExp&&(f[m]=!0)}for(m=0;m<p;m++){for(var b=m,v=r[m],w=n.length,C=0;C<u;C++){var I=r[m].selectSingleNode(this.tdIdList[C]);n[w+C]=null!=I?h?d(I):I.getAttribute(l):c[C].options.defaultValue}for(C=0;C<u;C++)if(g[C])try{var _=a.Z.getGlobalFunction(c[C].options.importFormatter,this.scope_id);"function"==typeof _&&(n[w+C]=_.call(this,v,b))}catch(t){n[w+C]=c[C].options.defaultValue,s.Y.printStackTrace(t,null,this)}for(C=0;C<u;C++)if(f[C])try{var x=new Function("_this","obfuscator_rowXml","return "+c[C].options.importExp)(this,v);n[w+C]=x}catch(t){n[w+C]=c[C].options.defaultValue,s.Y.printStackTrace(t,null,this)}for(C=0;C<u;C++){if("radio"==c[C].options.inputType&&c[C].options.groupName&&this.cellInfoHash[c[C].options.groupName]){var S=c[C].options.trueValue,R=c[C].options.falseValue;switch(c[C].options.valueType){case"binary":S="1",R="0";break;case"boolean":S="true",R="false"}this.columnValue(v,c[C].options.groupName)==c[C].options.groupValue?n[w+C]=S:n[w+C]=R}this.options.xmlEncode&&null!=n[w+C]&&(n[w+C]=WebSquare.xml.decode(n[w+C]))}}return n}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.jsonData2ArrData=function(t){try{if(null==t)return;for(var e=[],i=t.length,o=this.cellIdList.length,r=[],n=0;n<o;n++)r[n]=this.getCellInfo(this.cellIdList[n]);for(n=0;n<i;n++)for(var l=n,h=t[n],d=e.length,p=0;p<o;p++)if(r[p].options.importFormatter)try{var u=a.Z.getGlobalFunction(r[p].options.importFormatter,this.scope_id);"function"==typeof u&&(e[d+p]=u.call(this,h,l))}catch(t){e[d+p]=r[p].options.defaultValue,s.Y.printStackTrace(t,null,this)}else if(r[p].options.importExp)try{var c=new Function("_this","obfuscator_rowXml","return "+r[p].options.importExp)(this,h);e[d+p]=c}catch(t){e[d+p]=r[p].options.defaultValue,s.Y.printStackTrace(t,null,this)}else{var g=t[n][this.cellIdList[p]];e[d+p]=null!=g?g:r[p].options.defaultValue}return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.xpathValue=function(t,e){try{var i=WebSquare.xml.findNode(t,e);if(null==i)return"";if(1!=i.nodeType)return i.nodeValue
;for(var o=i.firstChild;null!=o;o=o.nextSibling)if(3==o.nodeType)return o.nodeValue}catch(t){$l("xpath exeption"),s.Y.printStackTrace(t,null,this)}return""},D.prototype.getAllArrXML=function(t){try{var e=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var i=0;i<this.tagNmArr.length;i++)if(null!=this.tagNmArr[i]&&""!=this.tagNmArr[i].wq_trim())if(e)r.push(o.createElement(this.tagNmArr[i])),r[i-1].appendChild(r[i]);else{var o=WebSquare.xml.parse("<"+this.tagNmArr[i]+"/>"),r=[];r.push(o.documentElement),e=!0}var n=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),l=null;for(i=0;i<this.getTotalRow();i++){var h=i;l=[];for(var d=null,p=0;p<n.length;p++)if(""!=n[p]){var u=o.createElement(n[p]);l.push(u),0==p?r[r.length-1].appendChild(u):l[p-1].appendChild(l[p])}(d=l[n.length-1]).setAttribute("status",this.dataList._getRowStatusValue(h)),d.setAttribute("statusValue",this.dataList._getRowStatus(h)),d.setAttribute("id",h);for(var c=this.getColumnCount(),g=new Array(c),f=0;f<c;f++){var m="";m="displayData"!=t?this._dataList._getData(h,f):this._getDisplayData(h,f),this.options.xmlEncode&&(m=WebSquare.xml.encode(m));var y=this.getColumnID(f),b=this.getCellInfo(f);if(""!=b.options.exportFormatter)try{var v=a.Z.getGlobalFunction(b.options.exportFormatter,this.scope_id);"function"==typeof v&&v(d,m,h,y)}catch(t){s.Y.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(g[f]=o.createElement(this.getColumnID(f)),""==this._dataList.options.valueAttribute){var w=o.createTextNode(m);g[f].appendChild(w)}else g[f].setAttribute(this._dataList.options.valueAttribute,m);d.appendChild(g[f])}}}return o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getArrXML=function(t,e,i){try{if(t instanceof Array){var o=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var r=0;r<this.tagNmArr.length;r++)if(null!=this.tagNmArr[r]&&""!=this.tagNmArr[r].wq_trim())if(o)l.push(n.createElement(this.tagNmArr[r])),l[r-1].appendChild(l[r]);else{var n=WebSquare.xml.parse("<"+this.tagNmArr[r]+"/>"),l=[];l.push(n.documentElement),o=!0}var h=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),d=null;for(r=0;r<t.length;r++){var p=t[r];d=[];for(var u=null,c=0;c<h.length;c++)if(""!=h[c]){var g=n.createElement(h[c]);d.push(g),0==c?l[l.length-1].appendChild(g):d[c-1].appendChild(d[c])}(u=d[h.length-1]).setAttribute("status",this.dataList.getRowStatusValue(p)),u.setAttribute("statusValue",this.dataList.getRowStatus(p)),!0===i?u.setAttribute("id",this._getGroupbyDisplayRowIndex(p)):u.setAttribute("id",p);for(var f=this.getColumnCount(),m=new Array(f),y=0;y<f;y++){var b="";"displayData"!=e?null==(b=this.dataList._getCellData(p,y))&&(b=""):null==(b=this._getCellDisplayData(p,y))&&(b=""),this.options.xmlEncode&&(b=WebSquare.xml.encode(b));var v=this.getColumnID(y),w=this.getCellInfo(y);if(""!=w.options.exportFormatter)try{var C=a.Z.getGlobalFunction(w.options.exportFormatter,this.scope_id);"function"==typeof C&&C(u,b,p,v)}catch(t){s.Y.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(m[y]=n.createElement(this.getColumnID(y)),""==this._dataList.options.valueAttribute){var I=n.createTextNode(b);m[y].appendChild(I)}else m[y].setAttribute(this._dataList.options.valueAttribute,b);u.appendChild(m[y])}}}return n}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getDisplayRowIndex=function(t){try{return(this._linkedDataList||this._dataList).getFilteredRowIndex(t)}catch(t){s.Y.printStackTrace(t)}},D.prototype.getOption=function(t){try{return this.options[t]}catch(t){s.Y.printStackTrace(t)}},D.prototype.getDataList=function(){try{var t=this._linkedDataList||this._dataList;return t?t.id:null}catch(t){s.Y.printStackTrace(t)}},D.prototype.getRowNumVisible=function(){try{return this.options.rowNumVisible}catch(t){s.Y.printStackTrace(t)}},D.prototype.makeCustomFilter=function(t){try{
null!=this.customFilter&&this.customFilter.remove(),this.customFilter=new WebSquare.uiplugin.floatingLayer(this.id+"_customFilter",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter",useModal:!0,useModalStack:!0,frameModal:this.options.customFilterFrameModal+"",headerLeftClass:"w2grid_customFilter_HL",headerRightClass:"w2grid_customFilter_HR",headerCenterClass:"w2grid_customFilter_HC",bodyLeftClass:"w2grid_customFilter_BL",bodyRightClass:"w2grid_customFilter_BR",bodyCenterClass:"w2grid_customFilter_BC",bodyLeftBottomClass:"w2grid_customFilter_FL",bodyRightBottomClass:"w2grid_customFilter_FR",bodyBottomClass:"w2grid_customFilter_FC",closeButtonClass:"w2grid_customFilter_btnClose",_scope_obj_uuid:this.options._scope_obj_uuid,title:WebSquare.language.getMessage("Grid_filter_title")||"Custom Filter",titleClass:"w2grid_customFilter_title"});var e=new WebSquare.uiplugin.textbox(this.id+"_text1_"+this.headerID,{style:"position:absolute; margin:10px;",className:"w2grid_customFilter_text",label:WebSquare.language.getMessage("Grid_filter_search_label")||"Search criteria"});this.customFilter.addControl(e),this.selectboxItemSet=["=","<>",">",">=","<","<=",WebSquare.language.getMessage("Grid_filter_condition7")||"= (Metacharacter)",WebSquare.language.getMessage("Grid_filter_condition1")||"Starting character",WebSquare.language.getMessage("Grid_filter_condition2")||"Starting character to be excluded",WebSquare.language.getMessage("Grid_filter_condition3")||"Ending characters",WebSquare.language.getMessage("Grid_filter_condition4")||"Ending character to be excluded",WebSquare.language.getMessage("Grid_filter_condition5")||"Include",WebSquare.language.getMessage("Grid_filter_condition6")||"Exclude"],this._selectboxIgnoreOperatorItemSet=[">",">=","<","<="],this.customFilterItemCnt=0,this.groupList=[];var i=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute; width:100%; height:22px; margin-bottom:5px; background-color:transparent;"});this.customFilter.addControl(i),this.groupList.push(i);var o=this,r=new WebSquare.uiplugin.selectbox(i.id+"_selectbox_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",wheelRows:1,xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var t=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(t.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? matches any single character."),e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* matches matches zero or more characters."),o.setChildrenPosition(),o.customFilterMetacharPos|=1):(o.customFilterMetacharPos&=-2,o.customFilterMetacharPos<=0&&(t.setLabel(""),e.setLabel(""),o.setChildrenPosition()))}}}]});i.addControl(r);var n=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",l=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",p=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",u=new WebSquare.uiplugin.autoComplete(i.id+"_autocomplete_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,wheelRows:1,submenuSize:n,displayMode:l,searchTarget:p,delimiter:h});if(u.__setSelectedIndex1=u.setSelectedIndex1,u.setSelectedIndex1=function(t,e){u.__setSelectedIndex1(t,e);var i=u.getValue(),s=this.parentControl.id;if(s)var r=a.Z.getComponentById(s+"_selectbox_"+o.headerID);if(r){if(isNaN(i)){for(var n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);for(var l=r.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&r.setSelectedIndex(0)
}else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}},i.addControl(u),"label"==l||"value delim label"==l||"label delim value"==l)for(var c=this.changeItemValue("label",this.targetColID,this.colDataList,!1),g=0;g<this.colDataList.length;g++){var f=void 0!==c[g]?c[g]:this.colDataList[g];u.addItem(f,this.colDataList[g])}else if(this.colDataList)for(g=0;g<this.colDataList.length;g++)u.addItem(this.colDataList[g],this.colDataList[g]);for(var m=this.headCellInfoHash[this.headerID].getAttribute("customFilterItemCnt")||2,y=0;y<m-1;y++)this.addCustomFilterItem(y);var b=new WebSquare.uiplugin.textbox(this.id+"_text2_"+this.headerID,{style:"position:absolute; margin-left:10px; margin-top:5px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(b);var v=new WebSquare.uiplugin.textbox(this.id+"_text3_"+this.headerID,{style:"position:absolute; margin:5px; margin-bottom:10px; margin-left:10px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(v);var w=new WebSquare.uiplugin.group(this.id+"_buttonGroup_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_buttonGroup"});if(this.customFilter.addControl(w),this.options.showCustomFilterReset){var C=new WebSquare.uiplugin.textbox(this.id+"_btnReset_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",label:WebSquare.language.getMessage("Grid_filter_reset")||"Reset",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.groupbyStatus&&o.groupbyStatus.grouped&&o.options.groupbyFilterBox;for(var e=0;e<o.groupList.length;e++)for(var i=o.groupList[e].getChildren(),s=0;s<i.length;s++){var r=i[s];if(-1!=r.id.indexOf("_selectbox")){var a=o.itemValueObj[o.targetColID]["select"+e];r.setSelectedIndex(a||0)}else if(-1!=r.id.indexOf("_autocomplete")){var n=o.itemValueObj[o.targetColID]["auto"+e];r.setValue(n||"")}else if(-1!=r.id.indexOf("_radio")){var l=o.itemValueObj[o.targetColID]["radio"+e];r.setSelectedIndex(l||0)}}}}}]});w.addControl(C),C.addEvent("onmousedown",(function(){C.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),C.addEvent("onmouseup",(function(){C.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),C.addEvent("onmouseout",(function(){C.toggleClass("w2grid_customFilter_button_selected")}))}var I=new WebSquare.uiplugin.textbox(this.id+"_btnConform_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_confirm")||"OK",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.setCustomFilterExpression()}}},{name:"onkeydown",action:"script",param:{handler:function(t){13==(t.charCode?t.charCode:t.keyCode)&&(o.setCustomFilterExpression(),o.hideCustomFilterList())}}}]});w.addControl(I),I.addEvent("onmousedown",(function(){I.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),I.addEvent("onmouseup",(function(){I.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),I.addEvent("onmouseout",(function(){I.toggleClass("w2grid_customFilter_button_selected")}));var _=new WebSquare.uiplugin.textbox(this.id+"_btnCancel",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_cancel")||"Cancel",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide()}}},{name:"onkeydown",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode;9==e?(_.tabOrderMoveStart=!1,t.shiftKey||(_.tabOrderMoveStart=!0,d.f.preventDefault(t))):13==e&&(o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),
o.customFilter.hide(),o.hideCustomFilterList())}}},{name:"onkeyup",action:"script",param:{handler:function(t){9==(t.charCode?t.charCode:t.keyCode)&&(t.shiftKey||_.tabOrderMoveStart&&(_.tabOrderMoveStart=!1,o.customFilter.render.getElementsByClassName("w2floatingLayer_close_button")[0].focus()))}}}]});w.addControl(_),_.addEvent("onmousedown",(function(){_.toggleClass("w2grid_customFilter_button_selected")})),_.addEvent("onmouseup",(function(){_.toggleClass("w2grid_customFilter_button_selected")})),_.addEvent("onmouseout",(function(){_.toggleClass("w2grid_customFilter_button_selected")})),this.customFilter.writeTo(WebSquare.getBody()),this.customFilter.activate(),this.customFilter.dom.closeButton.addEventListener("keydown",(function(t){9==(t.charCode?t.charCode:t.keyCode)&&t.shiftKey&&_.focus()})),this.setChildrenPosition(),this.setDefaultValue(t),_.render.style.left=w.render.offsetWidth-_.render.offsetWidth-10+"px",I.render.style.left=parseInt(_.render.style.left,10)-I.render.offsetWidth-5+"px",this.options.showCustomFilterReset&&(C.render.style.left=parseInt(I.render.style.left,10)-_.render.offsetWidth-17+"px"),this.customFilter.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setDefaultValue=function(t){for(var e=0;e<this.groupList.length;e++)for(var i=this.groupList[e].getChildren(),o=0;o<i.length;o++){var s,r=i[o];if(-1!=r.id.indexOf("_selectbox")){s=r;for(var a=0;a<this.selectboxItemSet.length;a++)">"===this.selectboxItemSet[a]||">="===this.selectboxItemSet[a]||"<"===this.selectboxItemSet[a]||"<="===this.selectboxItemSet[a]?r.addItemArr(this.selectboxItemSet[a],this.selectboxItemSet[a],!1):r.addItemArr(this.selectboxItemSet[a],this.selectboxItemSet[a]);var n=this.itemValueObj[this.targetColID]["select"+e];r.setSelectedIndex(n||0)}else if(-1!=r.id.indexOf("_autocomplete")){var l=this.itemValueObj[this.targetColID]["auto"+e];r.setValue(l||"");var h=r.getValue();if(s){if(isNaN(h))for(a=0;a<s.itemArr.length;a++)void 0!==s.itemArr[a]._hidden&&(s.itemArr[a]._hidden=!0);else for(a=0;a<s.itemArr.length;a++)!0===s.itemArr[a]._hidden&&(s.itemArr[a]._hidden=!1);s.setSelectOptions(s.itemArr)}s=null}else if(-1!=r.id.indexOf("_radio")){r.addItem("OR","OR","0"),r.addItem("AND","AND","0");var d=this.itemValueObj[this.targetColID]["radio"+e];r.setSelectedIndex(d||0)}}},D.prototype.getUniqueValueOfArray=function(t,e){try{if(this._isNumberType(e))if("bigDecimal"!==e||isNaN(WebSquare.bigDecimal("").big))t.sort((function(t,e){return parseFloat(t)-parseFloat(e)}));else{var i,o;t.sort((function(t,e){if(""===t&&""===e)return 0;i=WebSquare.bigDecimal(t),o=WebSquare.bigDecimal(e);var s=i.minus(o);return"0"===s.toString()?0:"0"!==s.compare("0")?1:-1}))}else t.sort();for(var r=[],a=0;a<t.length;a++)(0===r.length||r[r.length-1]!==t[a]&&r[r.length-1]+""!=t[a]+"")&&r.push(t[a]);return r}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setAutoCompleteItem=function(t,e){var i=[];if(this.options.useFilterSearch&&this.customFilterList&&this.customFilterList.filterHistory.column.length>0){var o=this.getCustomFilterListJSON({colID:t,headerID:e}),s=this.headerInfoHash[e],r=0;s&&s.options.hideCustomFilter&&(r=1);for(var n=2-r;n<o.length;n++)i.push(o[n].id2)}else i=this.dataList.getColData(t);for(var l in this.itemValueObj[this.targetColID])-1!=l.indexOf("auto")&&""!=this.itemValueObj[this.targetColID][l]&&i.push(this.itemValueObj[this.targetColID][l]);this.colDataList=this.getUniqueValueOfArray(i),this.colDataList.sort((function(t,e){var i=t-e;a.Z.isIE("6 7")&&(i=(t+"").localeCompare(e+""));return i}))},D.prototype.showFilterOptions=function(t){this.options.useFilterList?(this.options.searchFilter,this.customFilterList&&this.customFilterScrollView?this.toggleCustomFilterList(t):this.createCustomFilterList(t)):this.showCustomFilter(t)},D.prototype.showCustomFilter=function(t){if(this.noevent=!0,this.options.useFilterList)if(this.groupbyStatus.grouped)if(this.options.groupbyFilterIcon){var e=this.headerToBodyRelation[t];if(e){
for(var i=!1,o=this.getColumnIndex(e),s=0;s<this.groupbyStatus.sortIndexArr.length;s++)if(this.groupbyStatus.sortIndexArr[s]==o){i=!0;break}var r={};r.render=this.getElementById(this.id+"_"+t),r.parentRender=this.render.getElementsByTagName("div")[0],r.headerID=t,r.headerIndex=this.getHeaderIndex(r.headerID),r.isGroupbyColumn=i,this.groupbyFilterList?this.toggleGroupbyFilterList(r):this.createGroupbyFilterList(r)}}else this._showCustomFilter(t);else this.showFilterOptions(t);else this._showCustomFilter(t)},D.prototype.showCustomFilter2=function(t){this.noevent=!0,this._showCustomFilter(t)},D.prototype._showCustomFilter=function(t){var e,i;(this.headerID=t,this.targetColID=this.getColIdByHeaderId(t),null==this.customFilter&&(this.itemValueObj={},this.customFilterStatusObj={}),this.itemValueObj[this.targetColID]||(this.itemValueObj[this.targetColID]={}),this.setAutoCompleteItem(this.targetColID,t),this.makeCustomFilter(this.targetColID,t),"BODY"==this.render.parentNode.tagName)?(e=this.render.offsetTop,i=this.render.offsetLeft):(e=WebSquare.style.getAbsoluteTop(this.render),i=WebSquare.style.getAbsoluteLeft(this.render),a.Z.isIEAllVersion("5 6 7")||(e-=WebSquare.style.getAbsoluteTop(document.body)));var o=this.getHeaderPosition(t,"top"),s=this.getHeaderPosition(t,"left"),r=this.getHeaderSize(t,"width"),n=this.getHeaderSize(t,"height"),l=0,h=0;"number"==typeof window.innerWidth?(l=window.innerWidth,h=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(l=document.body.clientWidth,h=document.body.clientHeight);var d,p,u=parseInt(a.Z.getStyleProperty(this.customFilter.render,"width"),10),c=parseInt(a.Z.getStyleProperty(this.customFilter.render,"height"),10),g=0,f=0;a.Z.isIE("6 7 8")?(d=document.documentElement.scrollTop,p=document.documentElement.scrollLeft):(d=window.pageYOffset,p=window.pageXOffset),g=i+s+r+u<=l+p?i+s+r:i+s-u,f=e+o+n+c<=h+d?e+o+n:e+this.render.offsetHeight-c,g<p&&(g=(l-u)/2+p,(f=e+this.render.offsetHeight)+c>h+d&&(f=e-c)),f<d&&(f=(h-c)/2+d),this.customFilter.render.style.left=g+"px",this.customFilter.render.style.top=f+"px",this.customFilter.show();var m=a.Z.getComponentById(this.id+"_item_0_selectbox_"+this.headerID);m&&m.focus()},D.prototype.addCustomFilterItem=function(t){this.customFilterItemCnt++;var e=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute;",className:"w2grid_customFilter_item"});this.customFilter.addControl(e),this.groupList.push(e);var i=new WebSquare.uiplugin.radio(e.id+"_radio",{style:"position:absolute; left:50px; height:20px;",className:"w2grid_customFilter_radio",selectedIndex:0,cols:2,rows:1});e.addControl(i);var o=this,s=new WebSquare.uiplugin.selectbox(e.id+"_selectbox",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],i=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? matches any single character."),i.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* matches matches zero or more characters."),o.setChildrenPosition(),o.customFilterMetacharPos|=1<<t+1):(o.customFilterMetacharPos&=~(1<<t+1),o.customFilterMetacharPos<=0&&(e.setLabel(""),i.setLabel(""),o.setChildrenPosition()))}}}]});e.addControl(s)
;var r=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",n=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",l=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",d=new WebSquare.uiplugin.autoComplete(e.id+"_autocomplete",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,submenuSize:r,displayMode:n,searchTarget:l,delimiter:h});if(d.__setSelectedIndex1=d.setSelectedIndex1,d.setSelectedIndex1=function(t,e){d.__setSelectedIndex1(t,e);var i=d.getValue(),s=this.parentControl.id;if(s)var r=a.Z.getComponentById(s+"_selectbox");if(r){if(isNaN(i)){for(var n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);for(var l=r.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&r.setSelectedIndex(0)}else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}},e.addControl(d),"label"==n||"value delim label"==n||"label delim value"==n)for(var p=this.changeItemValue("label",this.targetColID,this.colDataList,!1),u=0;u<this.colDataList.length;u++)d.addItem(p[u],this.colDataList[u]);else if(this.colDataList)for(u=0;u<this.colDataList.length;u++)d.addItem(this.colDataList[u],this.colDataList[u])},D.prototype.setChildrenPosition=function(){for(var t=this.customFilter.getChildren(),e=1;e<=t.length;e++){var i=WebSquare.style.getStyle(t[e-1].render,"top");if(i="auto"===i?"0":i,e===t.length)break;var o=WebSquare.style.getStyle(t[e-1].render,"margin-bottom");o="auto"===o?"0":o,t[e].render.style.top=t[e-1].render.offsetHeight+5+parseInt(i||"0",10)+parseInt(o||"0",10)+"px"}var s=this.customFilter.dom.closeButton.parentNode.offsetHeight,r=t[e-1].render.offsetHeight+10+parseInt(i||"0",10);this.customFilter.setSize(this.customFilter.render.offsetWidth,s+r+6)},D.prototype.replacechar=function(t){return"^"==t||"$"==t||"."==t||"["==t||"]"==t||"{"==t||"}"==t||"+"==t||"("==t||")"==t||"|"==t||"*"==t||"?"==t||"\\"==t?"\\"+t:void 0},D.prototype.setCustomFilterExpression=function(){try{this.dataList.removeColumnFilter(this.targetColID,{noRefreshAfter:!0});for(var t=!0,e=[],i=0;i<this.groupList.length;i++){for(var o={},r=this.groupList[i].getChildren(),a=0;a<r.length;a++){var n=r[a];if(-1!=n.id.indexOf("_selectbox"))o.select=n.getSelectedIndex(),this.itemValueObj[this.targetColID]["select"+i]=n.getSelectedIndex(),t=t&&0==n.getSelectedIndex(),o.dataType=this.getDataType(this.targetColID);else if(-1!=n.id.indexOf("_autocomplete")){var l=this;o.auto=n.getValue()!=n.options.chooseOptionLabel?(n.getValue()+"").replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return l.replacechar(t)})):"",this.itemValueObj[this.targetColID]["auto"+i]=n.getValue(),t=t&&n.getValue()==n.options.chooseOptionLabel}else-1!=n.id.indexOf("_radio")&&(o.radio=n.getSelectedIndex(),this.itemValueObj[this.targetColID]["radio"+i]=n.getSelectedIndex())}o.select&&e.push(o)}var h=this.getCellInfo(this.targetColID);"select"!==h.options.inputType&&"checkcombobox"!==h.options.inputType&&"autoComplete"!==h.options.inputType||(e.itemArr=h.getItemArray(),e.isSelectCol=!0),this.customFilterStatusObj[this.headerID]=!0;var p={type:"func",colIndex:this.targetColID,key:this.customFilterOperator,condition:"and",columnfilterchangeFire:!1,param:e},u=!1;if(this.customFilterList&&this.customFilterList.customFilterListFilterInfo){var c=this.customFilterList.customFilterListFilterInfo[this.targetColID];this.customFilterList.customFilterListFilterInfo[this.targetColID]=JSON.stringify(p,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})),c!==this.customFilterList.customFilterListFilterInfo[this.targetColID]&&(u=!0,d.f.fireEvent(this._dataList,"onbeforecolumnfilterchange"))}
this.dataList.setColumnFilter(p),u&&d.f.fireEvent(this._dataList,"onaftercolumnfilterchange");var g=this.getElementById(this.id+"_"+this.headerID+"_filter");t||0==e.length?WebSquare.style.removeClass(g,"w2grid_customFilter_filter"):WebSquare.style.addClass(g,"w2grid_customFilter_filter"),this.customFilter.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.customFilterOperator=function(t,e,i){try{for(var o=!0,r=0;r<e.length;r++){var a,n=!0,l=e[r].dataType,h=e[r].select,d=e[r].auto,p=e[r].auto.replace(".*","~~").replace(".","~"),u=p;if(!0===e.isSelectCol&&e.itemArr&&e.itemArr.length){for(var c=!1,g=0;g<e.itemArr.length;g++)if(e.itemArr[g].value===d){c=!0;break}if(!1===c)for(var f=0;f<e.itemArr.length;f++)if(e.itemArr[f].value===t){t=e.itemArr[f].label;break}}var m=t;if(h>=3&&h<=6)if("bigDecimal"===l){p=d.replace("\\.",".");var y=WebSquare.bigDecimal(p);"NaN"===y.big?!1:(u=y,m=WebSquare.bigDecimal(t))}else"number"!==l&&"float"!==l||(u=(p=d.replace("\\.",".")).toString().indexOf(".")>-1?parseFloat(p):parseInt(p,10));switch(e[r].select){case 1:(a=new RegExp(d,"g")).lastIndex=0,n=t==a.exec(t);break;case 2:(a=new RegExp(d,"g")).lastIndex=0,n=t!=a.exec(t);break;case 3:n="bigDecimal"===l?m.minus(u)>0:m>u;break;case 4:n="bigDecimal"===l?m.minus(u)>=0:m>=u;break;case 5:n="bigDecimal"===l?m.minus(u)<0:m<u;break;case 6:n="bigDecimal"===l?m.minus(u)<=0:m<=u;break;case 7:d=(d=d.replace(/\\\*/g,".*")).replace(/\\\?/g,".");var b=(a=new RegExp(d,"g")).exec(t);n=t==b||d==b;break;case 8:n=""==d?t==d:!!(a=new RegExp("^("+d+")","g")).test(t);break;case 9:n=!!(a=new RegExp("^[^("+d+")]","g")).test(t);break;case 10:n=""==d?t==d:!!(a=new RegExp("("+d+")$","g")).test(t);break;case 11:n=!!(a=new RegExp("[^("+d+")]$","g")).test(t);break;case 12:n=""==d?t==d:!!(a=new RegExp(d,"g")).test(t);break;case 13:n=""==d?t!=d:!!(a=new RegExp("^(?!.*"+d+").*","g")).test(t);break;default:n=t==d}if(1===e.length){o=n;break}0!==r?o=0==e[r].radio?o&&n:o||n:o=n}return o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.syncWithSortStatus=function(){try{this.headerSortStatusArr=[];for(var t=this._linkedDataList||this._dataList,e=0;e<t.sortStatusArr.length;e++){var i=t.sortStatusArr[e];"number"==typeof this.getColumnIndex(i.colID)&&(this.headerSortStatusArr.push(i),this.headerSortStatusArr[i.colID]=i)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getFixedColumnLastIndex=function(t){try{if(!this.options.rowNumStatusFixed&&0===this.options.fixedColumn||!1===t)var e=this.options.fixedColumn;else e=this.options.fixedColumn+this.defaultColCnt;if(e<1)return 0;if(!this.options.fixedColumnWithHidden)for(var i=0,o=0;o<this.hiddenList.length;o++)if(this.hiddenList[o]||i++,i==e)return o+1;return e}catch(t){return s.Y.printStackTrace(t,null,this),this.options.fixedColumn+this.defaultColCnt}},D.prototype.getFixedRightColumnLastIndex=function(){try{var t=this.colWidthList.length-this.options.fixedRightColumn,e=0;if(this.colWidthList.length!=t)for(var i=this.hiddenList.length-1;i>=0;i--)if(this.hiddenList[i])t--;else if(e++,this.options.fixedRightColumn==e)break;return t}catch(t){return s.Y.printStackTrace(t,null,this),this.colWidthList.length-this.options.fixedRightColumn}},D.prototype.columnValue=function(t,e){try{return e=this.getColumnID(e),null!=t.nodeType&&void 0!==t.selectSingleNode?null==this.options.valueNode||""==this.options.valueNode?a.Z.getTextNodeValue(t.selectSingleNode(e)):t.selectSingleNode(e).getAttribute(this.options.valueNode):t[e]}catch(t){s.Y.printStackTrace(t,null,this)}return""},D.prototype.rowIndexValue=function(t){return t},D.prototype.getColumnOption=function(t,e){try{var i="";if(this.successBinding){var o=this.cellInfoHash[t];if("dataType"==e)if(o){var r=o.options.dataType;i=r||this._dataList.getColumnOption(t,e)}else(i=this._dataList.getColumnOption(t,e))||(i="text");else i=o.options[e]||"";return i}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnOption=function(t,e,i){try{
this.successBinding&&this._dataList.setColumnOption(t,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getColumnDataListInfo=function(t){try{var e=this.getCellInfo(t);return"select"==e.options.inputType||"autoComplete"==e.options.inputType||"checkcombobox"==e.options.inputType?e.getColumnDataListInfo():null}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setInitStyle=function(t){if(WebSquare.initStyle[this.id]){for(var e,i=/([\w-]*)\s*:\s*([^;]*)/g,o={};e=i.exec(WebSquare.initStyle[this.id].style);)o[e[1]]=e[2].wq_trim();var s=o[t]?t:"";if(s){var r=s.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()})),a=o[s]?o[s]:o[s.toUpperCase()];document.getElementById(this.id).style[r]=a}else document.getElementById(this.id).style.cssText=WebSquare.initStyle[this.id].style,this.rowStyleArr=[],this.colStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this._cellSelectedIndex=[],this._removeAllTDCellClass(),this.applyStyleOptions(this.getTotalRow());document.getElementById(this.id).className=WebSquare.initStyle[this.id].className}},D.prototype.refresh=function(t){try{this._dataList.broadcast({gridView:["notifyRefresh",[t]]})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.checkAdaptiveGridType=function(){try{if(this.options.groupbyZone){var t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] Adaptive mode not supported for this grid.";return!1}if(!this.render)return!1;var e=this.htmlInfo.head.rowAttrArr.length,i=this.htmlInfo.body.rowAttrArr.length,o=0;if(this.hasSubtotal)for(var r=this.htmlInfo.subtotalArr,n=0;n<r.length;n++)o+=r[n].rowAttrArr.length;if(1==e&&1==i&&(this.adaptiveGridType=1),1==e&&2==i?this.adaptiveGridType=2:2==e&&1==i?this.adaptiveGridType=3:2==e&&2==i?this.adaptiveGridType=4:3==e&&1==i&&(this.adaptiveGridType=5),e>3||i>2||o>3){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] Adaptive mode not supported for this grid.";return $l(t),!1}if(e+(i>o?i:o)>4){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] Adaptive mode not supported for this grid.";return $l(t),!1}return!(a.Z.isIE(6)||a.Z.isIE(7)||a.Z.isIE(8)||a.Z.isIE(9))}catch(t){s.Y.printStackTrace(t)}},D.prototype.setAdaptiveGridBodyHeight=function(){try{for(var t=function(t){var e=this.getColumnIndex(t),i=parseInt(this.getAdaptiveColumnStyleValue(e,"height"),10);isNaN(i)||(this.orgBodyHeightObj[t]=this.getColumnStyleValue(e,"height"),this.setColumnStyle(t,"height",i+"px"))},e=this.htmlInfo.head.rowArr,i=0;i<e.length;i++)for(var o=e[i],r=0;r<o.length;r++){var a=o[r],n=parseInt(a.colSpan,10),l=a.id,h=this.headerToBodyRelation[l],d=this.getColumnIndex(h);if(!isNaN(n)&&n>1)for(var p=0;p<n;p++)t.call(this,this.getColumnID(d+p));else t.call(this,h)}}catch(t){s.Y.printStackTrace(t)}},D.prototype.removeAdaptiveGridBodyHeight=function(){try{for(var t in this.orgBodyHeightObj)this.setColumnStyle(t,"height",this.orgBodyHeightObj[t])}catch(t){s.Y.printStackTrace(t)}},D.prototype.setAdaptiveGridHeaderHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"),10),i=parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"),10);0===e&&null!=this.oldOptions.headerPaddingTop&&(e=parseInt(this.oldOptions.headerPaddingTop,10)),0===i&&null!=this.oldOptions.headerPaddingBottom&&(i=parseInt(this.oldOptions.headerPaddingBottom,10));for(var o=e+i,r=this.htmlInfo.head.rowArr,a=0;a<r.length;a++)for(var n=r[a],l=0;l<n.length;l++){var h=n[l],d=parseInt(h.colSpan,10),p=h.id,u=this.headerToBodyRelation[p],c=this.getColumnIndex(u),g=parseInt(this.getCellInfo(c).options.colSpan,10),f=0,m=0,y=this.headerInfoHash[p];if(y&&y.options&&"string"==typeof y.options.style)for(var b=y.options.style.split(";"),v=0;v<b.length;v++){if("height"==(I=b[v].split(":"))[0]){m=parseInt(I[1],10);break}
}else m=parseInt(this.getHeaderCellStyleValue(p,"height"),10);if(null!=c)if(d>0){var w=d;for(v=c;v<c+d;v++)this.hiddenList[v]?w--:(f+=parseInt(this.getColumnStyleValue(v,"height"),10),f+=o);m!=(f-=o-(w-1))&&(null==this.orgHeaderHeightObj[p]&&(this.orgHeaderHeightObj[p]=m+"px"),w>0&&this.setHeaderStyle(p,"height",f+"px"))}else if(f=parseInt(this.getColumnStyleValue(c,"height"),10),g>1){f-=(o+1)*(g-1);var C=Math.round(f/g);for(v=l;v<l+g;v++){if(p=(h=n[v]).id,this.headerInfoHash[p])for(b=this.headerInfoHash[p].options.style.split(";"),v=0;v<b.length;v++){var I;if("height"==(I=b[v].split(":"))[0]){m=parseInt(I[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(p,"height"),10);v==l+g-1?(this.orgHeaderHeightObj[p]=m+"px",this.setHeaderStyle(p,"height",f+"px")):(this.orgHeaderHeightObj[p]=m+"px",this.setHeaderStyle(p,"height",C+"px"),f-=C)}}else m!=f&&(null==this.orgHeaderHeightObj[p]&&(this.orgHeaderHeightObj[p]=m+"px"),this.hiddenList[c]||this.setHeaderStyle(p,"height",f+"px"))}if(this.hasFooter){var _=this.htmlInfo.foot.rowArr;for(a=0;a<_.length;a++){var x=_[a];for(l=0;l<x.length;l++){var S=x[l],R=parseInt(S.colSpan),D=S.id,T=(c=l,f=0,parseInt(this.getFooterStyle(D,"height")));if(R>0){for(v=c;v<c+R;v++)f+=parseInt(this.getColumnStyleValue(v,"height")),f+=o;f-=o-(R-1)}else f=parseInt(this.getColumnStyleValue(c,"height"));T!=f&&(this.orgFooterHeightObj[D]=T+"px",this.setFooterStyle(D,"height",f+"px"))}}}}catch(t){s.Y.printStackTrace(t)}},D.prototype.removeAdaptiveGridHeaderHeight=function(){try{for(var t in this.orgHeaderHeightObj)this.setHeaderStyle(t,"height",this.orgHeaderHeightObj[t]);for(var t in this.orgFooterHeightObj)this.setFooterStyle(t,"height",this.orgFooterHeightObj[t])}catch(t){s.Y.printStackTrace(t)}},D.prototype.setAdaptiveGridSubtotalHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"))+parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"));if(0==this.orgSubtotalHeightArr.length)for(var i=0;i<this.drawedSubtotal.length;i++)for(var o=0;o<this.drawedSubtotal[i].length;o++)for(var r=this.drawedSubtotal[i][o].childNodes,a=this.defaultColCnt;a<r.length;a++){var n=parseInt(r[a].getAttribute("colSpan")),l=0,h=r[a].style.height;if(null!=n&&n>0){for(var d=a;d<a+n;d++)l+=parseInt(this.getColumnStyleValue(d-this.defaultColCnt,"height")),l+=e;l-=e-(n-1)}else l=h;h!=l&&(this.orgSubtotalHeightArr.push({height:h,elem:r[a]}),r[a].style.height=l+"px")}}catch(t){s.Y.printStackTrace(t)}},D.prototype.removeAdaptiveGridSubtotalHeight=function(){try{for(var t=0;t<this.orgSubtotalHeightArr.length;t++){var e=this.orgSubtotalHeightArr[t];e.elem.style.height=e.height}this.orgSubtotalHeightArr=[]}catch(t){s.Y.printStackTrace(t)}},D.prototype.setDrillDownDragDrop=function(t){try{this.drillDownDragDrop=a.Z.getBoolean(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getDataListInfo=function(){try{if(this.successBinding){var t={};return t.id=this.options.dataList,t}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getInputType=function(t){try{return this.getCellInfo(t).options.inputType}catch(t){s.Y.printStackTrace(t)}},D.prototype.getDataType=function(t){try{return this.getCellInfo(t).options.dataType||this._dataList.getCellInfo(t).options.dataType}catch(t){s.Y.printStackTrace(t)}},D.prototype.getFakeExpressionArr=function(){try{for(var t=[],e=[],i=0;i<this.dataList.getRowCount();i++)(t=this._dataList.getRowData(i)).push(""),e=e.concat(t);return e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setUseFilterList=function(t){try{this.options.useFilterList=a.Z.getBoolean(t),this.options.sortable&&this.options.showSortableImage&&(this.options.showSortableUseFilter=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setUseFilter=function(t,e){try{var i=t,o=this.headerInfoHash[i];if(null==o&&(i=this.bodyToHeaderRelation[i],null==(o=this.headerInfoHash[i])))return!1;var r=o.options.useFilter,n=a.Z.getBoolean(e);if(r===n)return!1;o.options.useFilter=n
;var l,h=this.getHeaderLayer(i);if(this._clearHeaderSortImage(h,"table"),this._clearHeaderSortImage(h,"div"),!0===r)null!=(l=document.getElementById(this.id+"_"+i+"_filter"))&&(l.style.display="none");else if(null!=(l=document.getElementById(this.id+"_"+i+"_filter")))l.style.display="";else{var d=this.headerObj[i],p=h.innerHTML,u=h.getElementsByTagName("td");d&&(p=""),h.innerHTML="<table style='width:100%;height:100%;'><tr><td style='width:100%;'>"+p+"</td><td><input type='button' id='"+this.id+"_"+i+"_filter' class='w2trigger w2grid_customFilter_open' aria-expanded='false' onclick='"+this.id+'.showCustomFilter("'+i+"\");'/></td></tr></table>",d&&(d.render?u[0].appendChild(d.render):u[0].appendChild(d))}var c=a.Z.getDataPrefix("useFilter");return n?h.setAttribute(c,n):h.removeAttribute(c),this.drawHeaderSortImages(),!0}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getFixedRow=function(){var t=parseInt(this.options.fixedRow,10);return t=isNaN(t)?0:t},D.prototype.getLastFixedRow=function(){var t=parseInt(this.options.lastFixedRow,10);return t=isNaN(t)?0:t},D.prototype.isVirtualCursor=function(){try{if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum)if(this.getLastFocusedCell().focusedRowIndex>this.lastIndex&&0==this.getElementById(this.id+"_scrollY_div").scrollTop)return!0;return!1}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeCell=function(t){try{if(null==t||null==t.rowIndex||null==t.colIndex)return void p.v.printLog("gridView mergeCell error : invalid argument ["+this.id+"]");null==t.rowSpan&&(t.rowSpan=1),null==t.colSpan&&(t.colSpan=1);var e=parseInt(t.rowIndex,10),i=parseInt(t.colIndex,10),o=parseInt(t.rowSpan,10),r=parseInt(t.colSpan,10),n=this.getRealRowIndex(e);o>1||r>1?(this.cellMergeInfo[e+"_"+i]={rowSpan:o,colSpan:r},this.cellMergeRealInfo[e+"_"+i]=n):null!=this.cellMergeInfo[e+"_"+i]&&(delete this.cellMergeInfo[e+"_"+i],delete this.cellMergeRealInfo[e+"_"+i]);for(var l=!(!this.isDrillDown||!this._dataList.options.depthColumn),h=l?e:n,d=this.dataList._getCellData(h,i,"3"),u=0;u<o;u++)for(var c=0;c<r;c++)if(0!==u||0!==c){var g={filteredRowIndex:e+u,colID:i+c,data:d,useRealRowIndex:l};this.dataList._setCellData(g),this.cellMergeInfo[e+u+"_"+(i+c)]&&delete this.cellMergeInfo[e+u+"_"+(i+c)]}this.dynamicMergeHTML(),this.options.oddEvenColorDisplay&&!0===this._isBrowserScroll()&&a.Z.setTimeout(this.redrawTable,{key:this.id+"_mergeCell",delay:100,caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeFocusedCell=function(){try{if(this.focusedCell.length>1){var t=this.focusedCell.length-1;this.mergeCell({rowIndex:this.focusedCell[0].focusedRowIndex,colIndex:this.focusedCell[0].focusedColIndex,rowSpan:this.focusedCell[t].focusedRowIndex-this.focusedCell[0].focusedRowIndex+1,colSpan:this.focusedCell[t].focusedColIndex-this.focusedCell[0].focusedColIndex+1})}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeSplitFocusedCell=function(){try{for(var t=0;t<this.focusedCell.length;t++)this.mergeCell({rowIndex:this.focusedCell[t].focusedRowIndex,colIndex:this.focusedCell[t].focusedColIndex,rowSpan:1,colSpan:1})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeClear=function(t){try{void 0!==t&&null!=t||(t={}),this.cellMergeInfo={},this.cellMergeRealInfo={},this.options.mergeCells="never",this.options.mergeCellsFixedCols="never",this.options.mergeCellsFixedRows="never",!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeNotifyRowChanged=function(t,e){try{var i="removeRow"===t?-1:1,o={};for(var r in this.cellMergeInfo){var a=r.split("_"),n=parseInt(a[0],10),l=parseInt(a[1],10),h=this.cellMergeInfo[r];if(n<=e&&e<n+h.rowSpan)if(-1===i){if(h.rowSpan--,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}else if(n<e){var d=h.rowSpan-(e-n);if((d>1||1==d&&h.colSpan>1)&&(o[e+1+"_"+l]={rowSpan:d,colSpan:h.colSpan}),h.rowSpan-=d,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}(n>e||n==e&&-1!==i)&&(n+=i),o[n+"_"+l]=h}
this.cellMergeInfo=o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeNotifyFilter=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols){var t={};for(var e in this.cellMergeRealInfo._hidden){var i=e.split("_"),o=parseInt(i[0],10),r=parseInt(i[1],10),a=this.getDisplayRowIndex(o);isNaN(a)||(t[a+"_"+r]=this.cellMergeRealInfo._hidden[e],delete this.cellMergeRealInfo._hidden[e],this.cellMergeRealInfo[a+"_"+r]=o)}for(var n in this.cellMergeInfo){var l=n.split("_"),h=(r=parseInt(l[1],10),this.cellMergeInfo[n]);o=this.cellMergeRealInfo[n],a=this.getDisplayRowIndex(o);isNaN(a)?(this.cellMergeRealInfo._hidden||(this.cellMergeRealInfo._hidden={}),this.cellMergeRealInfo._hidden[o+"_"+r]=h,delete this.cellMergeRealInfo[n]):(t[a+"_"+r]=h,delete this.cellMergeRealInfo[n],this.cellMergeRealInfo[a+"_"+r]=o)}this.cellMergeInfo=t}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByFree=function(t,e,i,o){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:i-t+1,colSpan:o-e+1})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.unmergeByFree=function(t,e){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:1,colSpan:1})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeCells=function(t,e){try{this._mergeCells(t,e,{type:"mergeCells"})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByCol=function(t){try{this._mergeCells("bycol",t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByRow=function(t){try{this._mergeCells("byrow",t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByColRec=function(t){try{this._mergeCells("bycolrec",t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByRowRec=function(t){try{this._mergeCells("byrowrec",t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByRestricCol=function(t){try{this._mergeCells("byrestriccol",t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeByRestricRow=function(t){try{this._mergeCells("byrestricrow",t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeCells=function(t,e,i){try{var o=this.options.rollbackCommit;this.options.rollbackCommit=!1;var r=t.toLowerCase();switch(void 0!==i&&null!=i||(i={type:"mergeCells"}),this.options[i.type]=r,r){case"never":this.cellMergeInfo={},this.cellMergeRealInfo={},e&&!0===e.noDraw||this.dynamicMergeHTML();break;case"bycol":this._mergeByCol(e);break;case"byrow":this._mergeByRow(e);break;case"bycolrec":this._mergeByColRec(e);break;case"byrowrec":this._mergeByRowRec(e);break;case"byrestriccol":this._mergeByRestricCol(e);break;case"byrestricrow":this._mergeByRestricRow(e)}this.options.rollbackCommit=o}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeRefresh=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols)return;var t={noDraw:!0};this.cellMergeInfo={},this.cellMergeRealInfo={},"never"!==this.options.mergeCells&&this.mergeCells(this.options.mergeCells,t),this.options.mergeCellsFixedColsFirst?("never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t),"never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t)):("never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t),"never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeByCol=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,r=this.options.fixedColumn,a=i-this.options.fixedRightColumn,n=e,l={},h=this.getSubtotalRowList({returnType:"object"});!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var d={}
;!0===t.keepMerge&&(d=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,r=0,a=i);var p=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(r=i-this.options.fixedRightColumn,a=i):0==this.options.fixedRightColumn?(r=0,a=this.options.fixedColumn):(r=0,a=i,p=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var u=!(!this.isDrillDown||!this._dataList.options.depthColumn),c=r;c<a;c++){if(t.mergeCol){if(!1===t.mergeCol[c])continue}else if(!1===this.mergeColObj[c])continue;if(!(p&&c>=this.options.fixedColumn&&c<a-this.options.fixedRightColumn)&&!(this.htmlInfo.body.rowAttrArr.length>1&&1==this.colIndexInfo.body.colInfo.rowSpanArr[c]))for(var g=this.tdIdList[c],f=o;f<n;f++){var m=u?this.getRealRowIndex(f):f,y=this.dataList._getCellData(f,g),b=1;if(!0===t.keepMerge&&(b=0),!0===t.upperColumn&&(l[f]=!0),t.mergeRow){if(!1===t.mergeRow[m])continue}else if(!1===this.mergeRowObj[m])continue;for(;b<n-f&&!this._isExcludeValue(y);){var v=u?this.getRealRowIndex(f+b):f+b;if(t.mergeRow){if(!1===t.mergeRow[v])break}else if(!1===this.mergeRowObj[v])break;if(f+b>n)break;if(y!=(0===b?y:this.dataList._getCellData(f+b,g)))break;if(!0===t.keepMerge&&!0===d[v+"_"+c])break;if(!0===t.upperColumn&&!0===l[f+b])break;if(!0===h[f+b])break;b++}b>1&&(this.cellMergeInfo[m+"_"+c]={rowSpan:b,colSpan:1},f=f+b-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeByRow=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,r=this.options.fixedColumn,a=i-this.options.fixedRightColumn,n=e,l={};!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var h={};!0===t.keepMerge&&(h=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,r=0,a=i);var d=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(r=i-this.options.fixedRightColumn,a=i):0==this.options.fixedRightColumn?(r=0,a=this.options.fixedColumn):(r=0,a=i,d=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var p=!(!this.isDrillDown||!this._dataList.options.depthColumn),u=o;u<n;u++){var c=p?this.getRealRowIndex(u):u;if(t.mergeRow){if(!1===t.mergeRow[c])continue}else if(!1===this.mergeRowObj[c])continue;for(var g=r;g<a;g++)if(!(d&&g>=this.options.fixedColumn&&g<a-this.options.fixedRightColumn)){var f=this.dataList._getCellData(u,this.tdIdList[g]),m=1;if(!0===t.keepMerge&&(m=0),!0===t.upperRow&&(l[g]=!0),t.mergeCol){if(!1===t.mergeCol[g])continue}else if(!1===this.mergeColObj[g])continue;for(;m<a-g&&!this._isExcludeValue(f);){if(t.mergeCol){if(!1===t.mergeCol[g+m])break}else if(!1===this.mergeColObj[g+m])break;if(d){if(g+m>=this.options.fixedColumn&&g+m<a-this.options.fixedRightColumn)break}else if(g+m>a)break;if(f!=(0===m?f:this.dataList._getCellData(u,this.tdIdList[g+m])))break;if(!0===t.keepMerge&&!0===h[c+"_"+(g+m)])break;if(!0===t.upperRow&&!0===l[g+m])break;m++}m>1&&(this.cellMergeInfo[c+"_"+g]={rowSpan:1,colSpan:m},g=g+m-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeByColRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t),i=o.q.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByCol(e),this._mergeByRow(i),this._mergeAdjacentCell("col"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeByRowRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t),i=o.q.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByRow(e),this._mergeByCol(i),this._mergeAdjacentCell("row"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeAdjacentCell=function(t){try{var e="row"===t?[0,1]:"col"===t?[1,0]:null;if(null==e)return;var i={},o={},r=this.getSubtotalRowList({returnType:"object"});for(var a in this.cellMergeInfo){
var n=a.split("_"),l=parseInt(n[e[0]],10),h=parseInt(n[e[1]],10),d=0===e[0]?this.cellMergeInfo[a].colSpan:this.cellMergeInfo[a].rowSpan,p=0===e[0]?this.cellMergeInfo[a].rowSpan:this.cellMergeInfo[a].colSpan;null!=i[h+"_"+d]?(null==o[h+"_"+d]&&(o[h+"_"+d]=[i[h+"_"+d]]),o[h+"_"+d].push({row:l,rowSpan:p})):i[h+"_"+d]={row:l,rowSpan:p}}for(var a in o){var u=parseInt(a.split("_")[0]),c=0===e[0]?"rowSpan":"colSpan";o[a].sort((function(t,e){return t.row>e.row}));for(var g=o[a].length-1;g>=1;g--){var f=!0===r[o[a][g].row];if(o[a][g-1].row+o[a][g-1].rowSpan>=o[a][g].row&&!f)if((0===e[0]?this.dataList._getCellData(o[a][g-1].row,u):this.dataList.getCellData(u,o[a][g-1].row))===(0===e[0]?this.dataList._getCellData(o[a][g].row,u):this.dataList.getCellData(u,o[a][g].row))){o[a][g-1].rowSpan=o[a][g].row+o[a][g].rowSpan-o[a][g-1].row;var m=0===e[0]?o[a][g].row+"_"+u:u+"_"+o[a][g].row;delete this.cellMergeInfo[m];var y=0===e[0]?o[a][g-1].row+"_"+u:u+"_"+o[a][g-1].row;this.cellMergeInfo[y][c]=o[a][g-1].rowSpan}}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeByRestricCol=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t);e.upperColumn=!0,this._mergeByCol(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._mergeByRestricRow=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t);e.upperRow=!0,this._mergeByRow(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeCellsFixedRows=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedRows){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedRows=!0,e.fixedCols=!1,this._mergeCells(t,e,{type:"mergeCellsFixedRows"})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeCellsFixedCols=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedCols){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedCols=!0,e.fixedRows=!1,this._mergeCells(t,e,{type:"mergeCellsFixedCols"})}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeCol=function(t,e){try{t=this.getColumnIndex(t);isNaN(t)||(this.mergeColObj[t]=e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.mergeRow=function(t,e){try{this.mergeRowObj[t]=e}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getMerged=function(t,e){try{if(this.cellMergeInfo[t+"_"+e])return!0;for(var i in this.cellMergeInfo){var o=i.split("_"),r=this.cellMergeInfo[i],a=parseInt(o[0],10),n=parseInt(o[1],10);if(a<=t&&n<=e&&a+r.rowSpan-1>=t&&n+r.colSpan-1>=e)return!0}}catch(t){s.Y.printStackTrace(t,null,this)}return!1},D.prototype.getMergedInfo=function(t,e){try{var i={merged:!1};if(this.cellMergeInfo[t+"_"+e])i.merged=!0,i.startRowIndex=t,i.startColIndex=e;else for(var o in this.cellMergeInfo){var r=o.split("_"),a=this.cellMergeInfo[o],n=parseInt(r[0],10),l=parseInt(r[1],10);n<=t&&l<=e&&n+a.rowSpan-1>=t&&l+a.colSpan-1>=e&&(i.merged=!0,i.startRowIndex=n,i.startColIndex=l,i.endRowIndex=n+a.rowSpan-1,i.endColIndex=l+a.colSpan-1)}}catch(t){s.Y.printStackTrace(t,null,this)}return i},D.prototype.getMergeAll=function(t,e){try{for(var i,o=[],r=[],a=t.split(","),n=0;n<a.length;n++)o[n]=parseInt(a[n],10);for(var l in!0===e&&this.hasSubtotal&&(i=this.getSubtotalRowList().sort((function(t,e){return t-e}))),this.cellMergeInfo){var h=l.split("_"),d=this.cellMergeInfo[l],p=parseInt(h[0],10),u=parseInt(h[1],10),c=d.rowSpan,g=d.colSpan,f=u+g-1,m=0,y=0,b=0,v=0;if(!0===e&&this.hasSubtotal){for(var w=0;w<i.length&&p>=i[w];w++)v++;var C=1;for(var I in this.subtotalTableList)C=this.subtotalTableList[I].rows.length;p+=v*C}if(""!=t){o=o.sort();for(n=0;n<o.length;n++)u>(m=o[n])?b++:u<=m&&m<=f&&(u==m&&1==g?g=-1:y++);g-=y,u-=b}-1!=g&&(g>1||c>1)&&r.push({x:u,y:p,r:c,c:g})}return JSON.stringify(r)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getMergedCells=function(){try{var t={};for(var e in this.cellMergeInfo){
var i=e.split("_"),o=this.cellMergeInfo[e],r=parseInt(i[0],10),a=parseInt(i[1],10),n=o.rowSpan||1,l=o.colSpan||1;if(l>1||n>1)for(var h=0;h<n;h++)for(var d=0;d<l;d++)t[r+h+"_"+(a+d)]=!0}return t}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._isExcludeValue=function(t){try{if(this.options.mergeExcludeValue)for(var e=this.options.mergeExcludeValue.split(","),i=0;i<e.length;i++){if(t.constructor==Number&&(t+=""),e[i]==t)return!0;if("$blank"==e[i]&&""===t)return!0}return!1}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.refreshGrid=function(t){try{var e=null,i=t.op;this.hiddenRowObj.length>0&&"setInstanceValue"!=i&&(e=JSON.stringify(this.hiddenRowObj),this.clearRowVisible());var o,r,a=t.xpath;if("setInstanceValue"==i){o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.options.repeatNode,null,this.scope_id);var n,l=(c=a.split("/"))[c.length-1],h=this.getColumnIndex(l);if(h>=0){n=this.getCellInfo(l),c.pop();var d=WebSquare.ModelUtil.findInstanceNode(c.join("/"),null,this.scope_id);r=this.getInstanceIndex(o,d);var p=this._dataList.getFilteredRowIndex(r);"radio"==n.options.inputType&&t.value+""==n.options.trueValue&&n.resetOthers(p,!0),p>=0?this._dataList.setCellData(p,h,t.value):this._dataList._setData(r,h,t.value)}}else if("setInstanceNode"==i){if(!(m=this.options.ref==t.replacexpath&&"replace"==t.type?this.xmlData2ArrData(t.replaceNode,!0):this.xmlData2ArrData(t.node,!0)).length)return;this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type?this.insertRow(null,{insertData:m}):"insertBeforeSibling"==t.type?(r=this.getInstanceIndex(o,t.node),this.insertRow(r,{insertData:m})):"replace"==t.type&&this._dataList.setData(m),this.insertRowByInstance=!1}else if("setInstanceChildNodes"==i){if(this.options.ref==t.replacexpath&&"replace"==t.type)m=this.xmlData2ArrData(t.replaceNode,!0);else t.baseNode&&t.baseNode!=this.options.baseNode&&(f=t.baseNode),m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if(!m.length&&"append"==t.type)return;var u=this.getTotalCol();if(this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type)for(;m.length>0;)y=m.splice(0,u),this.insertRow(null,{insertData:y});else"replace"==t.type&&this._dataList.setData(m);this.insertRowByInstance=!1}else if("setInstanceLastNodeChildNodes"==i||"copyLastNodeChildrenNodes"==i){if(!(m=this.xmlData2ArrData(t.node,!0,{repeatNode:t.repeatNode,isRepeatNode:!0})).length)return;this.insertRowByInstance=!0,"replace"!=t.type&&"replaceAll"!=t.type&&"append"!=t.type||this.setRowData(parseInt(t.changeIndex)-1,m,!0),this.insertRowByInstance=!1}else if("removeInstanceNode"==i)this.removeRowByInstance=!0,r=t.deleteIndex,this.removeRow(r),this.removeRowByInstance=!1;else if("removeInstanceNodeAll"==i)this.removeRowByInstance=!0,this.dataList.removeAll(),this.removeRowByInstance=!1;else if("copyChildrenNodes"==i){var c,g,f;t.copiedXPath&&(g=(c=t.copiedXPath.split("/"))[c.length-1]),t.baseNode&&g!=this.options.baseNode&&(f=g);var m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if("replaceAll"==t.type)this.setData(m);else if("append"==t.type){var y;u=this.getTotalCol();for(this.insertRowByInstance=!0;m.length>0;)y=m.splice(0,u),this.insertRow(null,{insertData:y});this.insertRowByInstance=!1}}e&&"setInstanceValue"!=i&&(this.hiddenRowObj=JSON.parse(e),this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),this.setScrollYHeight(),this._mergeRefresh(),this.applyStyleOptions(this.lastIndex))}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getInstanceIndex=function(t,e){try{if(!Array.prototype.indexOf||a.Z.isIEAllVersion()&&parseInt(r.I.browserVersion(),10)>8){for(var i=t.length;i--;)if(t[i]===e)return i;return}return t.indexOf(e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getArrayIndexOf=function(t,e){try{if(Array.prototype.indexOf)return t.indexOf(e)
;for(var i=0;i<t.length;i++)if(t[i]==e)return i;return}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setRef=function(t){try{if(t&&t.ref){this.options.ref=t.ref,t.baseNode&&(this.options.baseNode=t.baseNode),t.repeatNode&&(this.options.repeatNode=t.repeatNode);var e=null==t.aliasDataCollection?this.scope_id:t.aliasDataCollection,i=WebSquare.ModelUtil.findInstanceNode(this.options.ref,null,e);this.setXML(i,null,{ref:this.options.ref,aliasDataCollection:e})}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setRef=function(t,e){try{this.filteredRepeatNode=!1,this.repeatNodeChildTagName=[],this.repeatNodeTagName=this.options.repeatNode.split("/"),this.filteredRepeatNodeTagName=[];this.options.ref;for(var i=0;i<this.repeatNodeTagName.length;i++){var o=this.repeatNodeTagName[i];i==this.repeatNodeTagName.length-1&&o.indexOf("[")>=0&&(o.indexOf("[@")>=0||(this.repeatNodeTagNameFilter=!0,o=o.split("[")[0])),1==this.repeatNodeTagNameFilter?this.filteredRepeatNodeTagName.push(o):this.filteredRepeatNodeTagName.push(this.repeatNodeTagName[i]),i!=this.repeatNodeTagName.length-1&&"/"+this.repeatNodeTagName[i]}for(var r=0;r<WebSquare.WebSquaredoc.instanceRefElement.length;r++){var a=WebSquare.WebSquaredoc.instanceRefElement[r].id;try{a==this.id&&WebSquare.WebSquaredoc.instanceRefElement.splice(r,1)}catch(t){s.Y.printStackTrace(t,null,this)}}var n=this.options.aliasDataCollection?this.options.aliasDataCollection:this.scope_id;for(var l in WebSquare.WebSquaredoc.instanceRefElement.push(new WebSquare.ModelUtil.createInstanceRefElement(this.options.ref,this.id,this.options.baseNode,this.repeatNodeTagName,this.cellIdList,n)),this.cellInfoHash)this.repeatNodeChildTagName.push(l)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setImageSrc=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if(!e||"textImage"!=o)return;i.options.imageSrc=e,this.refreshColumn(t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setSyncScroll=function(t,e){try{this.options.syncScroll=t,null!=e&&(this.options.syncScrollId=e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.resetExpressionFunc=function(){try{if(this.useExpression)for(var t=this.getTotalCol(),e=0;e<t;e++){var i=this.getCellInfo(e);if(i&&i.options&&"expression"==i.options.inputType)for(var o=this.drawedRowLength,r=0;r<o;r++)i.options.expressionFunc&&i.options.expressionFunc[r]&&i.options.expressionFunc[r].changeCount&&(i.options.expressionFunc[r]={})}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellDataType=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e),a=r.id;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[n]?r.cellManagerHashByRowIndex[n]:r,!0;var l=r.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;var h=this.getInput(r);h.setValue(this._dataList.getCellData(o,a));var d=h.getValue();h.setDataType(i),r.options.dataType="float";var p=h.formatter.unformat(d),u=h.validator.validateString(p);h.setValueNM(u),d!==u&&this._dataList.setCellData(o,a,u)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellAllowChar=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e),a=r.id;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[n]?r.cellManagerHashByRowIndex[n]:r,!0;var l=r.options.inputType;if("text"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;var h=this.getInput(r);if(h&&h.options&&("input"===h.options.pluginName||"textarea"===h.options.pluginName)){h.setValue(this._dataList.getCellData(o,a)),h.setAllowChar(i);var d=h.getValue();this._dataList.setCellData(o,a,d)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellDisplayFormat=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e)
;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r,!0;var n=r.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("Invalid cell input type."),!1;if(r.options.displayFormat=i,r.initFormatter(),r.options.embeddedInput){var l=this.data_td_list[e+(o-this.rowIndex)*this.oneRowDataLength];if(l){var h=this.getInput(r,l);h&&"function"==typeof h.setDisplayFormat&&h.setDisplayFormat(i)}}this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellDisplayFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e);if(0!=r.internal||"custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r,!0;var n=r.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("Invalid cell input type."),!1;r.options.displayFormatter=i,r.initFormatter(),this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellMaxLength=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e),a=r.id;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[n]?r.cellManagerHashByRowIndex[n]:r,!0;var l=r.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;var h=this.getInput(r);h.setValue(this._dataList.getCellData(o,a)),"float"===r.options.dataType?r.setFloatMaxLength(i.toString()):r.setMaxLength(i);var d=h.getValue();this._dataList.setCellData(o,a,d)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellCustomFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e);if(0!=r.internal||"custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r,!0;var n=r.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("Invalid cell input type."),!1;r.options.customFormatter=i,r.initFormatter(),this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setCellDisableEdit=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e);if("custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);if("autoComplete"!=(r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r).options.inputType)return $l("Invalid cell input type."),!1;r.options.disableEdit=i,r.autoComplete&&(r.autoComplete.options.disableEdit=i),this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._removeDom=function(t){try{var e=this.dom[t];if(e){var i=WebSquare.idCache[e.uuid];i&&"function"==typeof i.remove&&i.remove(),delete this.dom[t]}}catch(t){s.Y.printStackTrace(t)}},D.prototype.setCellInputType=function(t,e,i){try{if(i&&i.inputType)if(e=this.getColumnID(e)){if(this._linkedDataList){var o=this._linkedDataList.filteredRowIndexArr[t];"number"!=typeof(t=this._dataList.getFilteredRowIndex(o))&&(t=o)}var r={};for(var a in i)r[a]=i[a];this._setCellInputType(t,e,null,r)}}catch(t){s.Y.printStackTrace(t)}},D.prototype._setCellInputType=function(t,e,i,o){try{null==i&&(i=""),null==this.editedCell||this.getCellOption(t,e,"embeddedInput")||this.editedCell.handleCancelEdit();var r=this._dataList.getTotalRow();this.groupbyStatus&&this.groupbyStatus.grouped&&(r=this._dataList.filteredRowIndexArr.length);this._dataList.getTotalCol();var a,n=!0;a=this.options&&"grid"===this.options.pluginName&&this.isDrillDown&&this.options.drilldownRealRowIndex||o&&!0===o.useRealRowIndex?t:this.dataList.getRealRowIndex(t);var l=this.getDisplayRowIndex(a);(isNaN(l)||l<0)&&(n=!1);var h=t,d=(e=this.getColumnID(e),this.getColumnIndex(e));this._dataList.getColumnIndex(e);if(t>=0&&t<r){
var p=this.cellInfoHash[this.tdIdList[d]];if("custom"==p.options.inputType&&!p.options.embeddedInput){var u;u=!0===o.useRealRowIndex?l-(this.rowIndex>0?this.rowIndex:0):t-(this.rowIndex>0?this.rowIndex:0);var c,g=this.data_td_list[d+u*this.oneRowDataLength];if(g&&n)!1===(c=p.getCellManager({element:p.element,rowIndex:h,realRowIndex:a,options:o,td:g,dynamicInputType:!0}))?g.innerHTML=this.dataTagOpen+o.value+this.dataTagClose:(p.clearStyle(c,g),null==o.value||!0===c.existGridViewItemsetNode?i=this.dataList._getCellData(h,e):(i=o.value,this.dataList.setCellData(h,e,i,null,!0,!0)),this.isColMerge&&p.options.colMerge&&!this.groupbyStatus.grouped?this.setColMergeCellData(u,h,d):c.setInnerHTML(g,i,h,d));else(c=p.getCellManager({element:p.element,rowIndex:h,realRowIndex:a,options:o,dynamicInputType:!0}))&&(null!=c.customValue?(i=c.customValue,this.dataList.setCellData(h,e,i,null,!0,!0)):null==o.value||!0===c.existGridViewItemsetNode?i=this.dataList._getCellData(h,e):(i=o.value,this.dataList.setCellData(h,e,i,null,!0,!0)))}}}catch(t){s.Y.printStackTrace(t)}},D.prototype.setDataDragDrop=function(t){try{if("boolean"==typeof t&&(this.options.dataDragDrop=t,t))if(1==this.isMobile){if(this.isHammerEnabled()){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}}else!1===this._bindDrag&&(this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getDataDragDrop=function(){try{return this.options.dataDragDrop}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.dragFinish=function(){try{this.options.dataDragDrop||this.options.dataDragDropSelf||!this.options.dataDragSelect||this.isMobile||WebSquare.dragdrop.gDragManager&&WebSquare.dragdrop.gDragManager.options&&(WebSquare.dragdrop.gDragManager.options.id===this.id+"_dragSelect"||WebSquare.dragdrop.gDragManager.options.id===this.id+"_drag")&&WebSquare.dragdrop.gDragManager.finish()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._fireOnviewchange=function(t,e,i,r){try{r=r||{};var a,n=this.getCellInfo(t),l=n.editRowIndex,h=this._dataList.getColumnIndex(n.id),p=this.getColumnIndex(n.id),u=this.getRealRowIndex(l),c=this._dataList.dataArr[u*this._dataList.getColumnCount()+h],g=n.comp&&n.comp.selectedIndex,f=this.lastEvent;r.beforeFunc&&r.beforeFunc.apply(r.beforeFunc,r.beforeFuncArgs);var m=!1;if(e)if("handleEndEdit"!=e&&"_handleEndEdit_focus"!=e&&"handleScrollY"!=e||i[2]&&i[2].otherClick)a=n[e].apply(n,i);else{m=!0;var y=i.slice(0);y[2]={from_fireOnviewchange:!0},o.q.extend(y[2],i[2]),a=n[e].apply(n,y)}if(r&&r.checkFunc&&!1===r.checkFunc(a))return!1;var b=this._dataList.dataArr[u*this._dataList.getColumnCount()+h];if(0===c&&(c="0"),0===b&&(b="0"),c!=b){var v={oldValue:c,newValue:b,rowIndex:l,colIndex:p,colId:this.getColumnID(p)};isNaN(g)||(v.oldSelectedIndex=g,v.newSelectedIndex=n.comp&&n.comp.selectedIndex),d.f.fireEvent(this,"onviewchange",v)}var w=this._getGroupbyDisplayRowIndex(l);return this.options.viewChangeAfterEdit&&1==m&&d.f.fireEvent(this,"onafteredit",w,p,b,f),!0}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._refreshInstance=function(t,e){try{if(!this.options.ref)return;e||WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],scopeId:this.scope_id,gridNoRefresh:!0}),t||(t=this._dataList.dataArr);var i,o=t.length/this.oneRowDataLength,r=[],a=this.repeatNodeTagName[0],n=WebSquare.xml.parse("<"+a+"></"+a+">").documentElement,l=this._dataList.getBroadcast();this._dataList.setBroadcast(!1)
;for(var h=0;h<o;h++)if(this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){if(0==h){var d,p=n,u=a;this.repeatNodeTagName.length>1&&(u=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(var c=1;c<this.repeatNodeTagName.length;c++)p=WebSquare.xml.createNode(p,this.repeatNodeTagName[c],!1);i=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(n,u):n;for(c=0;c<this.repeatNodeChildTagName.length;c++){if(d=WebSquare.xml.createNode(i,this.repeatNodeChildTagName[c],!1),r.push(d),f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){var g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}}else for(c=0;c<this.repeatNodeChildTagName.length;c++){var f;if(d=r[c],f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}WebSquare.ModelUtil.setInstanceNode(n,this.options.ref,null,"append",!1,this.scope_id)}this._dataList.setBroadcast(l)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.isHammerEnabled=function(){try{return(this.isMobile||a.Z.isTouchDevice())&&this.options.hammerEnabled}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.endEdit=function(){try{this._endEdit()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getColumnIdListMultiRow=function(){try{for(var t=[],e=this.colIndexes.bodyColInfo.colIndexMatch,i={},o=this.defaultColCnt;o<e.length;o++)for(var r=e[o],a=0;a<r.length;a++){null==t[a]&&(t[a]=[]);var n=this.getColumnID(r[a]-this.defaultColCnt);null==i[n]&&(t[a].push(n),i[n]=!0)}return t}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getLocationRowCol=function(t,e){try{var i,o,r=this.struct.body.rowAttrArr.length,a=this.getColumnOrder(),n=[];for(var l in a)n[a[l]]=parseInt(l,10);var h,d=this.cellMergeInfo;for(var p in d){var u=p.split("_"),c=parseInt(u[0]),g=parseInt(u[1]),f=d[p].rowSpan,m=d[p].colSpan;if(t>=c&&t<c+f&&e>=g&&e<g+m){i=f,o=m;break}}for(var y=0,b=e;b>=0;)h=b,b-=this.struct.body.rowArr[y].length,y++;if(y--,this.options.focusDefaultColumn&&y<0)o=1,i=1,v=t,h=e;else{o=o||parseInt(this.struct.body.rowArr[y][h].colSpan||1),i=i||parseInt(this.struct.body.rowArr[y][h].rowSpan||1),h=this.struct.body.rowArr[y][h]["@col"];var v=t*r+y;h=n[h]}return{rowIndex:v,colIndex:h,rowSize:i,colSize:o}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.getOriginalRowCol=function(t,e){try{for(var i=this.htmlInfo.body.rowAttrArr.length,o=(this.getColumnOrder(),!1),r=!0,a=t%i,n=1,l=1,h=[],d=0;d<i;d++){for(var p=[],u=0;u<this.htmlInfo.body.rowArr[d].length;u++)p.push({colSpan:parseInt(this.htmlInfo.body.rowArr[d][u].colSpan||1),rowSpan:parseInt(this.htmlInfo.body.rowArr[d][u].rowSpan||1),oriColIndex:parseInt(this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[d][u].col_id]),positionCalColIndex:parseInt(this.htmlInfo.body.rowArr[d][u]["@col"])});h.push(p)}for(d=0;d<i;d++){var c=0;for(u=0;u<h[d].length;u++){if(h[d][u].rowSpan>1)for(var g=1;g<h[d][u].rowSpan;g++)if(d+g<i){var f={oriRowAttrNum:d,rowIndex:d+g,oriColIndex:h[d][u].oriColIndex,colIndex:c,rowSpan:1,colSpan:h[d][u].colSpan,oriRowSpan:h[d][u].rowSpan,positionCalColIndex:h[d][u].positionCalColIndex};h[d+g].splice(h[d][u].positionCalColIndex||c,0,f)}c+=h[d][u].colSpan}}for(d=0;d<i;d++)h[d].sort((function(t,e){return t.positionCalColIndex-e.positionCalColIndex}));var m,y=h[a],b=0;for(u=0;u<y.length;u++){var v=parseInt(y[u].colSpan);if((b+=v)>e){e!==b-v&&(e=b-v,o=!0,r=!1),l=v,m=u;break}}n=y[m].rowSpan,void 0!==y[m].oriRowAttrNum&&(a+=y[m].oriRowAttrNum-y[m].rowIndex,n=y[m].oriRowSpan,o=!0),m=y[m].oriColIndex;var w=Math.floor(t/i),C=this.cellMergeInfo;for(var I in C){var _=I.split("_"),x=(p=parseInt(_[0]),parseInt(_[1])),S=C[I].rowSpan,R=C[I].colSpan
;if(w>=p&&w<p+S&&m>=x&&m<x+R){if(w==p&&m==x){n=S,l=R;break}m!=x&&(r=!1),w=p,m=x,n=S,l=R,o=!0;break}}return{rowIndex:w,colIndex:m,rowSize:n,colSize:l,noLeftTop:o,leftCell:r}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setImeMode=function(t,e){try{var i=this.getCellInfo(t);"text"!=i.options.inputType&&"textImage"!=i.options.inputType&&"textArea"!=i.options.inputType&&"drilldown"!=i.options.inputType||(i.options.imeMode=e)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._isGridViewItemTable=function(){try{return!(!this.parentControl||!this.parentControl.options||"gridItemTable"!==this.parentControl.options.pluginName&&"gridViewItemTable"!==this.parentControl.options.pluginName)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.searchData=function(t){try{void 0!==t&&null!=t||(t={}),this.clearSearchData({noRefresh:!0});var e=t.column;e=e?e.split(","):this.tdIdList.slice(0);for(var i=this.getRowCount(),o=[],r=[],a=0;a<i;a++){for(var n=!1,l=this.__getGroupbyGroupedRowIndex(a),h=this.getRealRowIndex(l),d=0;d<e.length;d++){var p=this.getColumnIndex(e[d]);this.getCellDisplayData(a,p).indexOf(t.data)>=0&&(n=!0,r.unshift([h,p]))}n&&o.push(h)}if(this.groupbyStatus.grouped){var u={};for(a=0;a<o.length;a++)u[o[a]+""]=!0;this.groupbyStatus.groupbyRowIndexArr=o.slice(0);var c=this.groupbyStatus.groupedRowIndexArr;this._beforeSearch={groupbyRowIndexArr:o.slice(0),groupedRowIndexArr:c.slice(0)};var g=[];for(a=0;a<c.length;a++)if("object"==typeof c[a]){if(0===c[a].depth&&g.length>0&&"object"==typeof g[g.length-1])for(;g.length>0&&"object"==typeof g[g.length-1];)g.pop();g.push(c[a])}else!0===u[c[a]+""]&&g.push(c[a]);for(;g.length>0&&"object"==typeof g[g.length-1];)g.pop();this.groupbyStatus.groupedRowIndexArr=g}var f={type:"direct",key:o,filterId:this.id+"_searchData"};this.dataList.setFilter(f);for(a=0;a<r.length;a++){var m=this.getDisplayRowIndex(r[a][0]),y=this.__getGroupbyGroupedRowIndex(m);this.setFocusedCell(y,r[a][1],!1,{ctrled:!0})}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.clearSearchData=function(t){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;void 0!==t&&null!=t||(t={});var e={filterId:this.id+"_searchData",noRefresh:t.noRefresh};this.groupbyStatus.grouped&&this._beforeSearch&&(this.groupbyStatus.groupbyRowIndexArr=this._beforeSearch.groupbyRowIndexArr.slice(0),this.groupbyStatus.groupedRowIndexArr=this._beforeSearch.groupedRowIndexArr.slice(0)),this._beforeSearch=null,this.dataList.removeFilter(e),this.removeFocusedCell(),!0===t.clearValue&&this.groupbyZone_searchinput.setValue("")}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._groupbyZoneSearch=function(){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;var t=this.groupbyZone_searchinput.getValue();if(""===t)this.clearSearchData();else{var e={};e.data=t,this.searchData(e)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setBlockSelect=function(t,e){try{if(!0!==e&&!1!==e)return;var i=this.getCellInfo(t);if(i&&i.options.blockSelect!==e){var o=this.getColumnIndex(t);i.options.blockSelect=e;for(var r=0;r<this.focusedCell.length;r++)if(this.focusedCell[r].focusedColIndex===o){var a=this.focusedCell[r];this._applyFocusedCellOut(a)}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setVisibleRowNum=function(t){try{if(t=parseInt(t,10),isNaN(t)||t<=0)return!1;this.options.initFixedHeightByRowNum>-1&&(this.options.initFixedHeightByRowNum=t);for(var e=this.options.visibleRowNum,i=this.getColumnOrder(),o=this.getColCnt(),r=[],a=0;a<o;a++)r.push(a);var n=!1,l=!0;("all"==e||""==e||parseInt(e,10))&&(n=!0);for(a=0;a<i.length;a++)if(i[a]!==r[a]){l=!1;break}this.options.visibleRowNum=t,this._dynamicVisibleRowNum=t,!l&&n&&this.setColumnOrder(r);var h=this._getVisibleRowNumHeight(!0);this.setTrRowTable(),this.getScrollTop()>0?(this.setSize(null,h),this.handleResize({startPoint:"0"}),this.scrollEvent=!1,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0):this.setSize(null,h),
!l&&n&&this.setColumnOrder(i)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.enableAllDate=function(t){try{var e=this.getCellInfo(t);if("calendar"!=e.options.inputType)return $l("Invalid cell input type."),!1;var i=this.getInput(e);e.options.disableBeforeDate="",e.options.disableAfterDate="",i&&i.enableAllDate()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setEditModeEvent=function(t,e){try{if(t&&(this.options.editModeEvent=t,e))for(var i=0;i<this.getColumnCount();i++){var o=this.getCellInfo(i);o.options.editModeEvent&&(o.options.editModeEvent=t,this.refreshColumn(o.colID))}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setColumnEditModeEvent=function(t,e){try{if(e){var i=this.getCellInfo(t);if(bRefreshColumn)for(var o=0;o<this.getColumnCount();o++){(i=this.getCellInfo(o)).options.editModeEvent&&(i.options.editModeEvent=e,this.refreshColumn(i.colID))}}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setFocusMode=function(t){try{if(this.options.focusMode===t||"cell"!==t&&"row"!==t&&"both"!==t)return;this.removeFocusedCell(),this.options.focusMode=t}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setRedrawTextAreaColumn=function(t){try{for(var e=!1,i=0;i<this.getColumnCount();i++){var o=this.getCellInfo(i);"textarea"==o.options.inputType&&"all"==o.options.displayType&&(e=!0,t||this.redrawColumn(i))}if(t&&e&&"all"===this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&this.getRowCount()>0){var r=document.getElementById(this.id+"_body_table").offsetHeight;this.render.offsetHeight!=r&&this.setSize(null,r)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getSelectedIndex=function(t,e){try{var i=-1,o=this.getCellInfo(e);if("custom"==o.options.inputType){var r=this.dataList.getRealRowIndex(t);o=o.cellManagerHashByRowIndex[r]?o.cellManagerHashByRowIndex[r]:o}if(o&&"select"==o.options.inputType){var a=this.getColumnIndex(e);null!=(r=this._getStyleRowIndex(t))&&"number"==typeof r&&void 0===(i=this._cellSelectedIndex[r*this.oneRowDataLength+a])&&(this._cellSelectedIndex[r*this.oneRowDataLength+a]=-1,i=-1)}return i}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setSelectedIndex=function(t,e,i){try{e=this.getColumnIndex(e);var o=this._getStyleRowIndex(t);if(null==o)return;"number"==typeof o&&(this._cellSelectedIndex[o*this.oneRowDataLength+e]=i)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._setFirsCellFocus=function(t){try{for(var e=0,i=this.getRowCount()-1,o=this.getLeftMostFocusableColIndex(e);e<i&&null==o;)e+=1,o=this.getRightMostFocusableColIndex(e);var r=this.getCellInfo(o);if("button"===r.options.inputType||"radio"===r.options.inputType||"checkbox"===r.options.inputType||"user"===r.options.inputType){var a=0,n=this.getCheckedIndex(r.colID)[0];n>0&&(a=n),this._setFocusedCell(a,o,!1,{tabDirection:"right"}),WebSquare.event.stopEvent(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._isNumberType=function(t){try{return!(!t||"float"!=t&&"number"!=t&&"bigDecimal"!=t&&"euro"!=t&&"tenge"!=t&&"rupee"!=t)}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._getOperator=function(t){try{var e,i;return 0==t.indexOf(">=")?(i=t.replace(">=",""),e=">="):0==t.indexOf(">")?(i=t.replace(">",""),e=">"):0==t.indexOf("<=")?(i=t.replace("<=",""),e="<="):0==t.indexOf("<")?(i=t.replace("<",""),e="<"):0==t.indexOf("==")?(i=t.replace("==",""),e="=="):0==t.indexOf("!=")?(i=t.replace("!=",""),e="!="):t&&(e="==",i=t),{operator:e,value:i}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._isMatched=function(t,e,i,o){try{var r=!0,a=t,n=e;return this._isNumberType(o)&&(a=parseFloat(a),n=parseFloat(n),isNaN(Number(n))&&(n=0)),">"==i?n>a||(r=!1):">="==i?n>=a||(r=!1):"<"==i?n<a||(r=!1):"<="==i?n<=a||(r=!1):"!="==i?n==a&&(r=!1):"=="==i&&n!=a&&(r=!1),r}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype._ShiftKeyMultiCheck=function(t,e,i){try{var o=this.getCellInfo(i),r=o.id,a=this.getColumnIndex(r);if(t.beforeChecked){
for(var n=parseInt(t.beforeChecked.rowIndex),l=parseInt(e.rowIndex),h=Math.min(n,l),d=Math.max(n,l),p=0;p<t.getDataLength()&&!(p>d);p++)h<=p&&p<=d&&t._dataList.setCellData(p,r,o.options.trueValue);o.options.blockSelect||(t.applyFocusedCellOut(),t.focusedCell=[],t._applyFocusedMultiCell(n,a,l,a)),!0!==e.checked&&(i.getElementsByTagName("input")[0].checked=!0)}}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setConfigOptions=function(t,e){try{var i,o;if("header"===e)i=this.headerConfigOptions,o="h";else if("footer"===e)i=this.footerConfigOptions,o="f";else{if("subtotal"!==e)return;i=this.subtotalConfigOptions,o="s"}if(!t||!t.id)return;var n=a.Z.getDataPrefix("inputType"),l=this.options.pluginName,h=t.getAttribute(n),d=r.I.getConfig(l+"/"+e+"[@inputType='"+h+"']"),p=r.I.getConfigurationJSON("/WebSquare/"+l+"/"+o+"column",{type:"array"})||[],u=!1;p instanceof Array||(p=[p],u=!0);for(var c=0;c<p.length;c++){var g=p[c],f=g["@inputType"];if(g&&(u||!f||f===h))for(var m in g)if("@inputType"!==m){var y=g[m];if(y&&null==d.item){var b=y["@value"];if("number"==typeof b||"string"==typeof b||"boolean"==typeof b){if("string"==typeof b){var v=b.toLocaleLowerCase().wq_trim();"true"===v||"false"===v?b=a.Z.getBoolean(b):"$blank"===v&&(b="")}d[m]=b}}}}i[t.id]=d}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.show=function(t){try{WebSquare.xfControl.prototype.show.call(this,t),0===this._dataList.getDataLength()&&(this.displayNoResultMessage(),this.setScrollYHeight())}catch(t){s.Y.printStackTrace(t)}};var T=function(){};T.prototype.getColumnReadOnly=function(t){var e=this.getCellInfo(t);return""!=e.options.readOnly?a.Z.getBoolean(e.options.readOnly):""},T.prototype.setColumnReadOnly=function(t,e){try{var i=this.getCellInfo(t);""!=e&&(e=a.Z.getBoolean(e));var o=i.options.readOnly;if(i.options.readOnly=e,o!==e){if(null!=this.editedCell){var r=a.Z.getDataPrefix("tdindex"),n=parseInt(this.editedCell.editTd.getAttribute(r))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=n==t}else this.rollbackCommitFlag=!1;this.drawColumnData(t),this.applyStyleOptions(this.lastIndex)}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getRowReadOnly=function(t,e){try{var i=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===e?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),o=this.rowReadOnlyArr[i];return 1!=o&&0!=o?"":o}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setRowReadOnly=function(t,e,i){try{var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),r=o||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));""!=e&&(e=a.Z.getBoolean(e));var n=o||!0===i?this.getDisplayRowIndex(r):this._getGroupbyGroupedRowIndex(t),l=this.rowReadOnlyArr[r];this.rowReadOnlyArr[r]=e,l!==e&&(null!=this.editedCell&&this.editedCell.editRowIndex==r?this.rollbackCommitFlag=!0:this.rollbackCommitFlag=!1,n>=0&&(this.drawRowData(n-this.rowIndex,n,!0),this.applyRowStyleOptions(n)))}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getCellReadOnly=function(t,e,i){try{e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),r=this.cellReadOnlyArr[o*this.oneRowDataLength+e];return 1!=r&&0!=r?"":r}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setCellReadOnly=function(t,e,i){try{if(""!=i&&(i=a.Z.getBoolean(i)),(e=this.getColumnIndex(e))>=this.getColumnCount())return;var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),r=o?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),n=o?this.getDisplayRowIndex(r):this._getGroupbyGroupedRowIndex(t),l=this.cellReadOnlyArr[r*this.oneRowDataLength+e];if(this.cellReadOnlyArr[r*this.oneRowDataLength+e]=i,l!==i){var h=this.rollbackCommitFlag;if(null!=this.editedCell&&this.editedCell.editRowIndex==r){
var d=a.Z.getDataPrefix("tdindex"),p=parseInt(this.editedCell.editTd.getAttribute(d))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=p==e}else this.rollbackCommitFlag=!1;n>=0&&(this.notifyCellChanged(n,e),this.rollbackCommitFlag=h,this.applyCellStyleOptions(n,e))}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getColumnDisabled=function(t){var e=this.getCellInfo(t);return a.Z.getBoolean(e.options.disabled)},T.prototype.setColumnDisabled=function(t,e){try{e=a.Z.getBoolean(e);var i=this.getCellInfo(t),o=i.options.disabled;i.options.disabled=e,o!==e&&(this.drawColumnData(t),this.applyColumnStyleOptions(t))}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getRowDisabled=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));return a.Z.getBoolean(this.rowDisabledArr[e])}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setRowDisabled=function(t,e){try{e=a.Z.getBoolean(e);var i=!(!this.isDrillDown||!this._dataList.options.depthColumn),o=i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),r=i?this.getDisplayRowIndex(o):this._getGroupbyGroupedRowIndex(t),n=this.rowDisabledArr[o];this.rowDisabledArr[o]=e,n!==e&&r>=0&&(this.drawRowData(r-this.rowIndex,r,!0),this.applyRowStyleOptions(r))}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getCellDisabled=function(t,e,i){try{e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));i&&(o=t);var r=this.cellDisabledArr[o*this.oneRowDataLength+e];return 1!=r&&0!=r?"":r}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setCellDisabled=function(t,e,i,o){try{i=a.Z.getBoolean(i);e=this.getColumnIndex(e);var r=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=r?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),l=r?this.getDisplayRowIndex(n):this._getGroupbyGroupedRowIndex(t);o&&(n=t,l=this.getDisplayRowIndex(t));var h=this.cellDisabledArr[n*this.oneRowDataLength+e];this.cellDisabledArr[n*this.oneRowDataLength+e]=i,h!==i&&l>=0&&(this.notifyCellChanged(l,e),this.applyCellStyleOptions(l,e))}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setTDStyle=function(t,e,i,o,s){""!=this.options.readOnlyBackgroundColor&&this.___getEditReadOnly(e,i)&&(s="background-color:"+this.options.readOnlyBackgroundColor+";"+s),this._getEditDisabled(e,i)?(t.disabled=!0,""!=this.options.disabledBackgroundColor&&(s+=";background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(s+=";color:"+this.options.disabledFontColor)):t.disabled=!1,t.style.cssText=o+";"+s},T.prototype.setStyleAll=function(t){try{var e=t.type,i=e.charAt(0).toUpperCase()+e.slice(1),o=t.target||"";"all"!==o&&"default"!==e&&"init"!==e||(o=""),"cell"!==e&&"disabledCell"!==e||(o="");var r=o?o.charAt(0).toUpperCase()+o.slice(1):"",a=t.styleName,n=t.styleValue,l=t.noRefresh,h=t.rowIndex,d=t.useRealRowIndex;d||(h=this._getGroupbyGroupedRowIndex(h));var u,c=t.colIndex;if("column"===e||"cell"===e||"default"===e||"init"===e){if(c=this.getColumnIndex(c),!this.getColumnID(c)&&!this.successBinding)return;if(!this.getColumnID(c)&&!this._dataList.getColumnID(c))return void p.v.printLog("[Warning] Invalid colIndex("+c+").["+this.id+"] set"+i+"Style"+r)}var g="ValueObj";"column"===e||"adaptiveColumn"===e||"default"===e||"init"===e?(u=c,i="Column"):"disabledCell"===e?(u=h+"_"+c,i="Cell",g="Obj"):null==(u=null==c?this["get"+i+"Style"+r+"ClassName"](h,d):this["get"+i+"Style"+r+"ClassName"](h,c,d))&&(this[e+"Style"+r+"Index"]++,u=this.id+"_"+e+"style"+o+"_"+this[e+"Style"+r+"Index"]+"_",null==c?this["set"+i+"Style"+r+"ClassName"](h,u,d):this["set"+i+"Style"+r+"ClassName"](h,c,u)),null==(t=this[e+"Style"+r+g][u])&&(t={}),t[a]=n;var f=[];for(var a in t){var m=t[a];"style"!=a&&""!=m&&f.push(a+":"+m)}if(t.style=f.join(";"),
this[e+"Style"+r+g][u]=t,!0!==l)if(null==h)this["apply"+i+"StyleOptions"](c);else!(!this.isDrillDown||!this._dataList.options.depthColumn)&&!d&&(h=this.getDisplayRowIndex(h)),!d||"cell"!=e&&"row"!=e?this["apply"+i+"StyleOptions"](h,c):"cell"==e?this["apply"+i+"StyleOptions"](h,c,void 0,void 0,d):this["apply"+i+"StyleOptions"](h,d)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setRowBackgroundColor=function(t,e,i){this.setRowStyle(t,"background-color",e,i)},T.prototype.setRowColor=function(t,e,i){this.setRowStyle(t,"color",e,i)},T.prototype.setRowStyle=function(t,e,i,o){this.setStyleAll({type:"row",rowIndex:t,styleName:e,styleValue:i,useRealRowIndex:o})},T.prototype.getRowBackgroundColor=function(t){return this.getRowStyleValue(t,"background-color")},T.prototype.getRowColor=function(t){return this.getRowStyleValue(t,"color")},T.prototype.getRowStyleValue=function(t,e){t=this._getGroupbyGroupedRowIndex(t);var i=this.getRowStyleClassName(t);return null==i?"":this.rowStyleValueObj[i][e]||""},T.prototype._getRowStyleStr=function(t){return this.rowStyleValueObj[t].style},T.prototype.setColumnBackgroundColor=function(t,e){this.setColumnStyle(t,"background-color",e)},T.prototype.setColumnColor=function(t,e){this.setColumnStyle(t,"color",e)},T.prototype.setColumnStyle=function(t,e,i){this.setStyleAll({type:"column",colIndex:t,styleName:e,styleValue:i})},T.prototype.setDefaultStyle=function(t,e,i){this.setStyleAll({type:"default",colIndex:t,styleName:e,styleValue:i})},T.prototype._setInitStyle=function(t,e,i){this.setStyleAll({type:"init",colIndex:t,styleName:e,styleValue:i})},T.prototype.setAdaptiveColumnStyle=function(t,e,i){this.setStyleAll({type:"adaptiveColumn",colIndex:t,styleName:e,styleValue:i,noRefresh:!0})},T.prototype.getColumnBackgroundColor=function(t){return this.getColumnStyleValue(t,"background-color")},T.prototype.getColumnColor=function(t){return this.getColumnStyleValue(t,"color")},T.prototype.getColumnStyleValue=function(t,e){var i=this.columnStyleValueObj[t];return null==i?this.getDefaultStyleValue(t,e):i[e]||this.getDefaultStyleValue(t,e)},T.prototype._getColumnStyleStr=function(t){return this.columnStyleValueObj[t].style},T.prototype.getDefaultStyleValue=function(t,e){var i=this.defaultStyleValueObj[t];return null==i?"":i[e]||""},T.prototype._getInitStyleValue=function(t,e){var i=this.initStyleValueObj[t];return null==i?"":i[e]||""},T.prototype._getDefaultStyleStr=function(t){return this.defaultStyleValueObj[t].style},T.prototype.getAdaptiveColumnStyleValue=function(t,e){var i=this.adaptiveColumnStyleValueObj[t];return null==i?"":i[e]||""},T.prototype.setCellBackgroundColor=function(t,e,i,o){this.setCellStyle(t,e,"background-color",i,void 0,o)},T.prototype.setCellColor=function(t,e,i,o){this.setCellStyle(t,e,"color",i,void 0,o)},T.prototype.setCellStyle=function(t,e,i,o,s,r){var a=this.getColumnID(e);if(this.mergeCellBkStatus&&this.mergeCellBkStatus[a]){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);this.mergeCellBkStatus[a][n]=null,delete this.mergeCellBkStatus[a][n]}this.setStyleAll({type:"cell",rowIndex:t,colIndex:e,styleName:i,styleValue:o,noRefresh:s,useRealRowIndex:r})},T.prototype._refreshCellStyle=function(t){var e=[],i=this.cellStyleValueObj[t];for(var o in i){var s=i[o];"style"!=o&&""!=s&&e.push(o+":"+s)}i.style=e.join(";"),this.cellStyleValueObj[t]=i},T.prototype.setDisabledCellStyle=function(t,e,i,o){e=this.getColumnIndex(e);this._getEditDisabled(t,e)&&this.setStyleAll({type:"disabledCell",rowIndex:t,colIndex:e,styleName:i,styleValue:o})},T.prototype.getCellBackgroundColor=function(t,e){return this.getCellStyleValue(t,e,"background-color")},T.prototype.getCellColor=function(t,e){return this.getCellStyleValue(t,e,"color")},T.prototype.getCellStyleValue=function(t,e,i,o){try{t=this._getGroupbyGroupedRowIndex(t);var r=this.getCellStyleClassName(t,e);return null==r?(!0!==o&&p.v.printLog("[Warning] Is not exist cell!["+this.id+"]"),
""):this.cellStyleValueObj[r][i]||""}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype._getCellStyleStr=function(t){return this.cellStyleValueObj[t].style},T.prototype.setHeaderCellStyle=function(t,e,i){try{var o=this.getHeaderLayer(t);WebSquare.style.setStyle(o,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setHeaderBackgroundColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"background-color",e),this.headerCellStyleValueObj[t]={"background-color":e}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setHeaderColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"color",e)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getHeaderCellStyleValue=function(t,e){try{var i=this.getHeaderLayer(t);return WebSquare.style.getStyle(i,e)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.getHeaderBackgroundColor=function(t){return this.getHeaderCellStyleValue(t,"background-color")},T.prototype.getHeaderColor=function(t){return this.getHeaderCellStyleValue(t,"color")},T.prototype._setMergeCellBackground=function(t,e,i){var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t),s=this.getColumnID(e),r=this.getColumnIndex(e);if(this.options.groupbyZone&&(this.mergeCellBkStatus||(this.mergeCellBkStatus={}),this.mergeCellBkStatus[s]||(this.mergeCellBkStatus[s]={}),null==this.mergeCellBkStatus[s][o])){var a=this.getCellStyleValue(t,s,"background-color",!0)||this.getColumnStyleValue(r,"background-color");this.mergeCellBkStatus[s][o]=a}var n=this.setCellDefaultStyleClassName(o,r,!0);this.cellStyleValueObj[n]["background-color"]=i,this._refreshCellStyle(n)},T.prototype._clearMergeCellBackground=function(){if(this.mergeCellBkStatus){for(var t in this.mergeCellBkStatus)for(var e in this.mergeCellBkStatus[t]){var i=parseInt(e,10),o=this.mergeCellBkStatus[t][e],s=this.setCellDefaultStyleClassName(i,t,!0);this.cellStyleValueObj[s]["background-color"]=o,this._refreshCellStyle(s),o||delete this.cellStyleValueObj[s]["background-color"]}delete this.mergeCellBkStatus}};var L=function(t){this.statusArr=[],this.mainGrid=null,this.options=null,this.mode=null};L.prototype.initialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(p.v.printLog("Warning: Filters not applicable in drilldown mode. All previously applied filters have been removed.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,r=!0,a=parseInt(this.options.showDepth,10),n=0;n<s;n++){var l=t._linkedDataList.initialRowIndexArr[n];this.statusArr[l]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(l,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(l,this.mainGrid.getColumnID(i))))<=a&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0,r=!1)}if(!0===r)for(l=0;l<s;l++)this.mainGrid._linkedDataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0}else{t._dataList.filteredRowIndexArr=[],this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),r=!0,a=parseInt(this.options.showDepth,10),l=0;l<s;l++){this.statusArr[l]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(l,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(l,this.mainGrid.getColumnID(i))))<=a&&(this.mainGrid._dataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0,r=!1)}if(!0===r)for(l=0;l<s;l++)this.mainGrid._dataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0}},L.prototype.getDepth=function(t){
return"dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(t,this.mainGrid._dataList.getColumnID(this.options.depthColumn))):parseInt(this.mainGrid.dataList._getData(t,this.mainGrid.getColumnID(this.options.depthColumn)))},L.prototype.isOpen=function(t){var e=this.getDepth(this.mainGrid.getRealRowIndex(t)),i=0;i="linkedDataList"===this.mode?this.mainGrid._linkedDataList.filteredRowIndexArr[t+1]:this.mainGrid._dataList.filteredRowIndexArr[t+1];var o=this.getDepth(i);return!isNaN(e)&&!isNaN(o)&&e<o},L.prototype.hasChild=function(t){if("linkedDataList"===this.mode){var e=this.mainGrid._linkedDataList.filteredRowIndexArr[t],i=this.mainGrid._linkedDataList.getLinkedRowIndex(t),o=this.mainGrid._linkedDataList.initialRowIndexArr[i+1],s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));var r=parseInt(this.mainGrid.dataList._getData(e,s)),a=parseInt(this.mainGrid.dataList._getData(o,s));return r<(a=isNaN(a)?0:a)}o=(e=this.mainGrid.getRealRowIndex(t))+1,s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));r=parseInt(this.mainGrid.dataList._getData(e,s)),a=parseInt(this.mainGrid.dataList._getData(o,s));return r<(a=isNaN(a)?0:a)},L.prototype.getOriginalRowIndex=function(t){return this.openRowIndexArr[t]},L.prototype.getDisplayRowIndex=function(t){if("linkedDataList"===this.mode){if(this.mainGrid._linkedDataList.filteredRowIndexArr)for(var e=0;e<this.mainGrid._linkedDataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid._linkedDataList.filteredRowIndexArr[e])return e}else if(this.mainGrid._dataList.filteredRowIndexArr)for(e=0;e<this.mainGrid._dataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid.getRealRowIndex(e))return e;return t},L.prototype.getChildRowArr=function(t,e){var i=t,o=this.getDepth(t),s=this.mainGrid.getTotalRow(),r=[],a=this.options.depthColumn,n=this.mainGrid.getColumnID(a);if("dataList"==this.options.dataColumn&&(n=this.mainGrid._dataList.getColumnID(a)),"linkedDataList"===this.mode)for(var l=i+1;l<s;l++){var h=this.mainGrid._linkedDataList.initialRowIndexArr[l];if(this.mainGrid.dataList._getData(h,n)==o+1&&r.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&r.push(h),this.mainGrid.dataList._getData(h,n)<=o)break}else for(h=i+1;h<s&&(this.mainGrid.dataList._getData(h,n)==o+1&&r.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&r.push(h),!(this.mainGrid.dataList._getData(h,n)<=o));h++);return r},L.prototype.pasteDrilldownInitialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(p.v.printLog("Warning: Filters not applicable in drilldown mode. All previously applied filters have been removed.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,r=0;r<s;r++){var a=t._linkedDataList.initialRowIndexArr[r];this.statusArr[a]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(a,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(a,this.mainGrid.getColumnID(i))))<=parseInt(this.options.showDepth,10)&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(a),this.statusArr[a]=!0)}}else{this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),a=0;a<s;a++)this.statusArr[a]=!0}},L.prototype.getChildrenRowArr=function(t){var e=[];if(this.mainGrid){var i=this.mainGrid.getTotalRow(),o=this.options.depthColumn,s=this.mainGrid.getColumnID(o)
;if("dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(o)),"linkedDataList"===this.mode){var r=this.mainGrid._linkedDataList.initialRowIndexArr[t+1],a=parseInt(this.mainGrid.dataList._getData(this.mainGrid._linkedDataList.initialRowIndexArr[t],s),10);if(r<i&&this.mainGrid.dataList._getData(r,s)>a){e.push(r);var n=parseInt(this.mainGrid.dataList._getData(r,s),10),l=!0}if(l)for(var h=t+2;h<i;h++){r=this.mainGrid._linkedDataList.initialRowIndexArr[h];if(this.mainGrid.dataList._getData(r,s)<a+1)break;this.mainGrid.dataList._getData(r,s)<n+1&&(e.push(r),n=parseInt(this.mainGrid.dataList._getData(r,s),10))}}else{r=t+1,a=parseInt(this.mainGrid.dataList._getData(t,s),10);if(r<i&&this.mainGrid.dataList._getData(r,s)>a){e.push(r);n=parseInt(this.mainGrid.dataList._getData(r,s),10),l=!0}if(l)for(r=t+2;r<i&&!(this.mainGrid.dataList._getData(r,s)<a+1);r++)this.mainGrid.dataList._getData(r,s)<n+1&&(e.push(r),n=parseInt(this.mainGrid.dataList._getData(r,s),10))}}return e},L.prototype.getParentRowIndex=function(t){if(this.mainGrid){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=parseInt(this.mainGrid.dataList._getData(t,i));if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var r=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(r,i)<o)return r}else for(r=t-1;r>=0;r--)if(this.mainGrid.dataList._getData(r,i)<o)return r}return-1},L.prototype.makeOpenRowIndexArr=function(){if("linkedDataList"===this.mode){this.mainGrid._linkedDataList.filteredRowIndexArr=[];for(var t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._linkedDataList.filteredRowIndexArr.push(t)}else{this.mainGrid._dataList.filteredRowIndexArr=[];for(t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._dataList.filteredRowIndexArr.push(t)}},L.prototype.toggle=function(t){var e=this.isOpen(t),i=[];t="linkedDataList"===this.mode?this.mainGrid._linkedDataList.getLinkedRealRowIndex(t):this.mainGrid.getRealRowIndex(t),i=e?this.getChildRowArr(t,!0):this.getChildrenRowArr(t);for(var o=0;o<i.length;o++)this.statusArr[i[o]]=!e;this.makeOpenRowIndexArr(),d.f.fireEvent(this.mainGrid,"ontoggleclick",e,t)},L.prototype.getAncestorRowArr=function(t){if("number"!=typeof t)return!1;for(var e=[],i=t;i>=0;)e.push(i),i=this.getParentRowIndex(i);return e.shift(),e},L.prototype.drillTo=function(t){if("number"!=typeof t)return!1;var e=this.getAncestorRowArr(t);e.unshift(t);for(var i=0;i<e.length;i++){var o=e[i];if(this.statusArr[o]=!0,0!=i)for(var s=this.getChildrenRowArr(o),r=0;r<s.length;r++)this.statusArr[s[r]]=!0}return this.makeOpenRowIndexArr(),this.getDisplayRowIndex(e[e.length-1])},L.prototype.isLastChild=function(t){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=this.mainGrid.dataList._getData(t,i);if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var r=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(r,i)<o)return r}else for(r=t+1;r<this.mainGrid.getTotalRow();r++){if(this.mainGrid.dataList._getData(r,i)==o)return!1;if(this.mainGrid.dataList._getData(r,i)<o)return!0}return!0},L.prototype.getRecursiveRowIndex=function(t){try{for(var e=[],i=this.getChildrenRowArr(t),o=0;o<i.length;o++){var r=i[o];e.push(r),e=e.concat(this.getRecursiveRowIndex(r))}return e}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.getRecursiveRowCount=function(t){try{for(var e=0,i=this.getChildrenRowArr(t),o=0;o<i.length;o++)e+=this.getRecursiveRowCount(i[o]),e++;return e}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.appendChild=function(t,e){try{if(e){var i=t+this.getRecursiveRowCount(t);return this.mainGrid._toggle(this.getDisplayRowIndex(t)),
this.mainGrid.dataList.setRowData(i+1,e)}$l("data is null. check data.["+this.id+"]")}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.moveNode=function(t,e){try{var i;if(t<e){if(!this.bodyDrop)i=e-(this.getRecursiveRowCount(t)+1)}else(t>e||t==e)&&(i=e);var o=this.detachNode(t),r=this.appendNode(i,o);return"number"!=typeof i&&(i=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1)),this.bodyDrop=!1,{detachedData:o,insertedData:r,insertedRowIndex:i}}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.appendNode=function(t,e){try{var i,o,r,a=this.mainGrid._dataList.getColumnCount(),n=e.length/a,l=this.mainGrid._dataList.getColumnID(this.options.depthColumn);if(this.options.depthColumn=parseInt(this.options.depthColumn,10),this.bodyDrop){this.bodyDrop=!1;var h=this,d=function(t){var e=h.getParentRowIndex(t);return e=e>-1?d(e):t},p=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1),u=this.getDisplayRowIndex(d(p));i=parseInt(this.mainGrid.dataList.getCellData(u,l),10),o=parseInt(e[a*(n-1)+parseInt(this.options.depthColumn)],10),t=p+this.getRecursiveRowCount(p)+1,r=i-o}else{u=this.getDisplayRowIndex(t-1);r=(i=parseInt(this.mainGrid.dataList.getCellData(u,l),10))-(o=parseInt(e[a*(n-1)+parseInt(this.options.depthColumn)],10))+1}for(var c=[],g=0;g<n;g++)for(var f=0;f<a;f++){var m=e[a*g+f];f==this.options.depthColumn&&(m-=0,m+=r),c.push(m)}this.mainGrid.dataList._insertData(t,c,-1);var y=this.getDisplayRowIndex(t);return this.isOpen(y)&&this.mainGrid._toggle(y),c}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.detachNode=function(t){try{for(var e=[],i=this.mainGrid.dataList.removeRow(t,{skipNotify:!0}),o=0;o<i.length;o++)e=e.concat(i[o]);return e}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.insertNextSibling=function(t,e){try{this.options.depthColumn=parseInt(this.options.depthColumn,10);var i=this.mainGrid.dataList.getColumnCount(),o=e.length/this.mainGrid.dataList.getColumnCount(),r=this.mainGrid.getDisplayRowIndex(t),a=parseInt(this.mainGrid.dataList.getCellData(r,this.options.depthColumn),10)-parseInt(e[i*(o-1)+parseInt(this.options.depthColumn)],10),n=[];t+=this.getRecursiveRowCount(t)+1;for(var l=0;l<o;l++)for(var h=0;h<i;h++){var d=e[i*l+h];h==this.options.depthColumn&&(d-=0,d+=a),n.push(d)}if(this.mainGrid.dataList._insertData(t,n,-1),this.mainGrid.options.closeDrillDownSibling)for(l=0;l<o;l++){var p=this.getDisplayRowIndex(t+l);this.isOpen(p)&&this.mainGrid._toggle(p)}return n}catch(t){s.Y.printStackTrace(t,null,this)}};var k=i(1230),F=function(t){this._linkedDataList._grid=t};F.prototype.getLinkedRowIndex=function(t){return this._linkedDataList.getLinkedRowIndex(t)},F.prototype.getRealRowIndex=function(t){return this._linkedDataList.filteredRowIndexArr[t]},F.prototype.getFilteredRowIndex=function(t){return this._linkedDataList.getFilteredRowIndex(t)},F.prototype.getTotalRow=function(){try{return this._linkedDataList.initialRowIndexArr.length}catch(t){s.Y.printStackTrace(t)}},F.prototype.getTotalCol=function(){try{return this._linkedDataList._dataList.getTotalCol()}catch(t){s.Y.printStackTrace(t)}},F.prototype.getRowCount=function(){try{return this._linkedDataList.getDataLength()}catch(t){s.Y.printStackTrace(t)}},F.prototype.getCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getCellData(i,e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getOriginalCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getOriginalCellData(i,e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getDataLength=function(){return this._linkedDataList.filteredRowIndexArr.length},F.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.Y.printStackTrace(t,null,this)}},F.prototype.getRowPosition=function(){try{
return this._linkedDataList._dataList.getRowPosition()}catch(t){s.Y.printStackTrace(t,null,this)}},F.prototype.getColData=function(t){try{for(var e=[],i=0;i<this._linkedDataList.initialRowIndexArr.length;i++)e.push(this._linkedDataList.getCellData(i,t));return e}catch(t){s.Y.printStackTrace(t)}},F.prototype.getRowData=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getRowData(e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getDataRow=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getDataRow(e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getMatchedData=function(t,e,i,o,r){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var a=[],n=this._linkedDataList.getMatchedIndex(t,e,i,o,r),l=0;l<n.length;l++)a.push(this._linkedDataList.getRowData(n[l]));return a}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUnmatchedData=function(t,e,i,o,r){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var a=[],n=this._linkedDataList.getUnmatchedIndex(t,e,i,o,r),l=0;l<n.length;l++)a.push(this._linkedDataList.getRowData(n[l]));return a}catch(t){s.Y.printStackTrace(t)}},F.prototype.getMatchedColumnData=function(t,e,i,o,r,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getMatchedIndex(t,e,o,r,a),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUnmatchedColumnData=function(t,e,i,o,r,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getUnmatchedIndex(t,e,o,r,a),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){s.Y.printStackTrace(t)}},F.prototype.getFilteredColData=function(t){for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++)e.push(this._linkedDataList.getCellData(this._linkedDataList.filteredRowIndexArr[i],t));return e},F.prototype.getMatchedIndex=function(t,e,i,o,r){try{i=void 0===i||null==i||i,0!=(i=a.Z.getBoolean(i))&&(i=!0);var n=this._linkedDataList._dataList.getColumnIndex(t),l=this._linkedDataList.getFilteredColData(n),h=[];"number"!=typeof o&&(o=0),"number"!=typeof r&&(r=l.length),r>l.length&&(r=l.length);for(var d=o;d<r;d++){var p=l[d],u=this._linkedDataList.getRealRowIndex(d);1==i?p===e&&h.push(u):p.indexOf(e)>-1&&h.push(u)}return h}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUnmatchedIndex=function(t,e,i,o,r){try{0!=i&&(i=!0);var a=this._linkedDataList._dataList.getColumnIndex(t),n=this._linkedDataList.getFilteredColData(a),l=[];"number"!=typeof o&&(o=0),"number"!=typeof r&&(r=n.length),r>n.length&&(r=n.length);for(var h=o;h<r;h++){var d=n[h],p=this._linkedDataList.getRealRowIndex(h);1==i?d!==e&&l.push(p):d.indexOf(e)<=-1&&l.push(p)}return l}catch(t){s.Y.printStackTrace(t)}},F.prototype.getRangeData=function(t,e){try{var i=[];if(t>e){var o=e;e=t,t=o}t<0&&(t=0),e>this._linkedDataList.getDataLength()&&(e=this._linkedDataList.getDataLength());for(var r=t;r<e;r++){var a=this._linkedDataList.getRealRowIndex(r);i=i.concat(this._linkedDataList.getRowData(a))}return i}catch(t){s.Y.printStackTrace(t)}},F.prototype.getAllData=function(){try{return this._linkedDataList._dataList.getAllFilteredData()}catch(t){s.Y.printStackTrace(t)}},F.prototype.getAllFilteredData=function(){this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=0;e<this._linkedDataList.getDataLength();e++)t=t.concat(this._linkedDataList.getRowData(e));return t},F.prototype.getColumnDistinctDataArray=function(t){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var e=[],i=[];"string"==typeof t&&(t=this._linkedDataList._dataList.bodyIdColIndexMap[t]);for(var o=this._linkedDataList._dataList.getCellInfo(t),r=this._linkedDataList.getColData(t),a=0;a<r.length;a++){i[r[a]]=1}for(var n in i)e.push(n);return"text"==o.options.dataType?e.sort():e.sort(this._linkedDataList.comparator),e}catch(t){
s.Y.printStackTrace(t)}},F.prototype.getRangeXML=function(t,e){try{return this._linkedDataList.getRangeXML(t,e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getMatchedXML=function(t,e,i,o,r){try{return this._linkedDataList.getMatchedXML(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUnmatchedXML=function(t,e,i,o,r){try{return this._linkedDataList.getUnmatchedXML(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getRowXML=function(t){try{return this._linkedDataList.getRowXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getAllXML=function(t){try{return this._linkedDataList.getAllXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getAllFilteredXML=function(t){return this._linkedDataList.getAllFilteredXML(t)},F.prototype.getRowJSON=function(t,e){try{return this._linkedDataList.getRowJSON(t,e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getAllJSON=function(t){try{return this._linkedDataList.getAllJSON(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getRangeJSON=function(t,e,i){try{return this._linkedDataList.getRangeJSON(t,e,i)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getMatchedJSON=function(t,e,i,o,r){try{return this._linkedDataList.getMatchedJSON(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUnmatchedJSON=function(t,e,i,o,r){try{return this._linkedDataList.getUnmatchedJSON(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getFusionChartData=function(t,e,i,o){return this._linkedDataList.getFusionChartData(t,e,i,o)},F.prototype.getRowStatusValue=function(t){try{return this._linkedDataList.getRowStatusValue(t)}catch(t){s.Y.printStackTrace(t,null,this)}},F.prototype.getRowStatus=function(t){try{return this._linkedDataList.getRowStatus(t)}catch(t){s.Y.printStackTrace(t,null,this)}},F.prototype.getRowIndexByStatus=function(t){try{for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++){var o=this._linkedDataList.getRealRowIndex(i);t.indexOf(this._linkedDataList._dataList.getRowStatus(o))>-1&&e.push(o)}return e}catch(t){s.Y.printStackTrace(t)}},F.prototype.getInsertedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("C")}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUpdatedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("U")}catch(t){s.Y.printStackTrace(t)}},F.prototype.getDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("DV")}catch(t){s.Y.printStackTrace(t)}},F.prototype.getOnlyDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("D")}catch(t){s.Y.printStackTrace(t)}},F.prototype.getVoidIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("V")}catch(t){s.Y.printStackTrace(t)}},F.prototype.getModifiedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("CUD")}catch(t){s.Y.printStackTrace(t)}},F.prototype.getInsertedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getInsertedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getInsertedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getInsertedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getDeletedIndex()
;return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getVoidData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getVoidXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getVoidIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getVoidJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getOnlyDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getOnlyDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getOnlyDeletedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getOnlyDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUpdatedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUpdatedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getUpdatedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getUpdatedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getModifiedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.getModifiedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getModifiedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.getModifiedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},F.prototype.setColumnFilter=function(t,e,i,o){return"object"!=typeof t||a.Z.isString(t)||(t.internal=!0),this._linkedDataList.setColumnFilter(t,e,i,o)},F.prototype.removeColumnFilter=function(t){return this._linkedDataList.removeColumnFilter(t,{internal:!0})},F.prototype.clearSortFilter=function(){return this._linkedDataList.clearSortFilter()},F.prototype.removeColumnFilterAll=function(){return this._linkedDataList.removeColumnFilterAll()},F.prototype.setFilter=function(t){return t&&(t.internal=!0),this._linkedDataList.setFilter(t)},F.prototype.removeFilter=function(t,e){return t&&(t.internal=!0),this._linkedDataList.removeFilter(t,e)},
F.prototype.clearFilter=function(){return this._linkedDataList.clearFilter()},F.prototype.sort=function(t,e){return this._linkedDataList.sort(t,e)},F.prototype.clearSort=function(){return this._linkedDataList.clearSort()},F.prototype.multisort=function(t){return this._linkedDataList.multisort(t)},F.prototype.getRowArray=function(t){try{return this._linkedDataList.getRowArray(t)}catch(t){s.Y.printStackTrace(t)}},F.prototype.removeRow=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._grid._dataList.removeRow(i,e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.removeRows=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(this._linkedDataList.getRealRowIndex(t[i]));return this._grid._dataList.removeRows(e)}catch(t){s.Y.printStackTrace(t)}},F.prototype.setRowData=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowData(o,e,i)}catch(t){s.Y.printStackTrace(t)}},F.prototype.setRowXML=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowXML(o,e,i)}catch(t){s.Y.printStackTrace(t)}},F.prototype.insertData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.insertData(i,e)}catch(t){s.Y.printStackTrace(t)}};var A=i(5386),E=function(t,e,i){var o;this.options=this._getDefaultOptionsMinimum(),t&&(o=t.getAttribute("escape")),!o&&e.element&&(o=e.element.getAttribute("escape"));var s=a.Z.getEscape(o,e.options.pluginName);this.options.escape=s?a.Z.getBoolean(s):this.options.escape,this.internal=!1,(i||"TD"==t.getTagName().toUpperCase())&&(this.internal=!0),this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),null!=this.mainGrid.scope_obj&&(this.options._scope_obj_uuid=this.mainGrid.scope_obj.uuid,this.scope_id=this.mainGrid.scope_obj.id),""!=this.options.value&&""==this.options.defaultValue&&(this.options.defaultValue=this.options.value),""==this.options.value&&""!=this.options.defaultValue&&(this.options.value=this.options.defaultValue),this.colID=this.options.col_id,this.id=this.options.col_id,this.options.id=this.options.col_id,this.setController(),this.initFormatter(t),this.initializeCellInfo(t,i),this.expressionStr=null,this.style="",this.heightGap=0;var n=r.I.browserVersion();if(r.I.browserCheck.ie&&"8"!=n&&(this.heightGap=2),""!=this.options.importExp&&(this.options.importExp=this.options.importExp.replace(/[cC][oO][lL][\s]*[(]/g,"_this.columnValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[xX][pP][aA][tT][hH][\s]*[(]/g,"_this.xpathValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.rowIndexValue(obfuscator_i")),(0==this.options.colSpan||isNaN(this.options.colSpan))&&(this.options.colSpan=1),(0==this.options.rowSpan||isNaN(this.options.rowSpan))&&(this.options.rowSpan=1),t){var l=!this.options.groupName||!this.options.groupValue,h=this.options.inputType;if(l&&("button"!=h&&"image"!=h)&&this.mainGrid.successBinding){var d=e._dataList.getCellInfo(this.id);!(!d||!d.element&&d.id!==this.id)||(this.options.readOnly=!0)}}"radio"==this.options.inputType&&this.options.groupName&&(this.mainGrid.radioGroupRepChk[this.options.groupName]=!0),"$blank"==this.options.NaNFormat&&(this.options.NaNFormat=""),this.changedCellHeight=0,this.dynamicAttrInfo={},"custom"==this.options.inputType&&(this.mainGrid.hasCustomInputType=!0),"expression"===this.options.inputType&&"true"!==this.options.expressionSort&&(this.mainGrid.expressionHeaderInfo[this.mainGrid.bodyToHeaderRelation[this.id]]=!0),"string"==typeof this.options.useItemLocale&&(this.options.useItemLocale=WebSquare.util.getBoolean(this.options.useItemLocale))};for(var M in E.prototype.defaultOptions={id:"",col_id:"",colIndex:"",colSpan:0,rowSpan:0,defaultValue:"",value:"",inputType:"text",useFilter:!1,blockSelect:!1,dataType:"",valueType:"binary",viewType:"",trueValue:null,falseValue:null,editType:"",applyFormat:"display",
displayFormat:"",displayFormatter:"",chooseOptionLabel:"",chooseOptionValue:"",chooseOption:!1,allOption:!1,title:"",voidNull:!1,adjustMaxLength:!1,useMaxLength:!1,depthColumn:"",showDepth:0,importExp:"",importFormatter:"",expression:"",colMerge:!1,colMergeEdit:!1,upperColumn:"",readOnly:"",imageWidth:"",imageHeight:"",imageClickFunction:"",imageSrc:"",imageSrcDisabled:"",imageSrcReadOnly:"",useImageClick:!1,alt:"",calendarValueType:"yearMonthDate",disabled:"",textAlign:"",exportFormatter:"",imeMode:"",selectSetter:"",ignoreStatus:!1,dateValidCheck:"",embeddedInput:"",groupName:"",escape:"false"!==r.I.getConfiguration("/WebSquare/escape/@value"),setRecursive:!1,showReadOnly:!1,customFormatter:"",escapeFormatter:"",depthType:"nbsp",moveFocusByChoice:"",directItemChoice:"",directOpen:!1,focusOutOnCheckHeaderClick:!0,keepFocusOnCheckHeaderClick:!1,usePartialCheck:!0,partialCheckNextClick:"",footerDiv:!1,displayRowIndex:!1,NaNFormat:"NaN",disabledClass:"",hiddenClass:"",displayMode:"0",delimiter:"\t",skipKeyMoveEditMode:!1,skipKeyMove:!1,checkboxLabel:"",checkboxLabelPosition:"right",checkboxLabelColumn:"",checkboxLabelFormatter:"",radioLabel:"",radioLabelPosition:"right",radioLabelColumn:"",radioLabelFormatter:"",checkAlways:!1,fixColumnWidth:!1,sortLabel:!1,useIOFormatLength:!1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",tooltipTime:1,minWidth:20,eventPriority:"onviewchange",customModelFormatter:"",customModelUnformatter:"",useMonthYearFormat:!1,editModeEventIcon:"",keepCellClass:!1,inputReadOnly:!1,keyMoveListSync:!1,tableRender:"",copyOption:"",invalidMessageFunc:"",dateValidSetCustom:!1,checkcomboboxUseDrag:!1,checkcomboboxUseEdit:!1,checkcomboboxRangeSeparator:"",checkcomboboxValidateOnInput:!1,checkcomboboxVisibleRowNum:0,checkcomboboxVisibleColNum:1,checkcomboboxVisibleColMax:1,placeholder:"",selectedData:!0,selectedDataDisplay:!0,refInitSync:!1,eventPropagation:!1,autoDecimalPoint:!1,useLocale:!1,noDisabledOnReadOnly:!1},E.prototype._getDefaultOptionsMinimum=function(){return{id:E.prototype.defaultOptions.id,col_id:E.prototype.defaultOptions.col_id,colIndex:E.prototype.defaultOptions.colIndex,value:E.prototype.defaultOptions.value,defaultValue:E.prototype.defaultOptions.defaultValue,inputType:E.prototype.defaultOptions.inputType,valueType:E.prototype.defaultOptions.valueType,viewType:E.prototype.defaultOptions.viewType,applyFormat:E.prototype.defaultOptions.applyFormat,displayFormat:E.prototype.defaultOptions.displayFormat,chooseOptionLabel:E.prototype.defaultOptions.chooseOptionLabel,chooseOptionValue:E.prototype.defaultOptions.chooseOptionValue,chooseOption:E.prototype.defaultOptions.chooseOption,title:E.prototype.defaultOptions.title,selectedData:E.prototype.defaultOptions.selectedData,selectedDataDisplay:E.prototype.defaultOptions.selectedDataDisplay,depthColumn:E.prototype.defaultOptions.depthColumn,showDepth:E.prototype.defaultOptions.showDepth,importExp:E.prototype.defaultOptions.importExp,expression:E.prototype.defaultOptions.expression,upperColumn:E.prototype.defaultOptions.upperColumn,readOnly:E.prototype.defaultOptions.readOnly,imageWidth:E.prototype.defaultOptions.imageWidth,imageHeight:E.prototype.defaultOptions.imageHeight,alt:E.prototype.defaultOptions.alt,calendarValueType:E.prototype.defaultOptions.calendarValueType,disabled:E.prototype.defaultOptions.disabled,textAlign:E.prototype.defaultOptions.textAlign,exportFormatter:E.prototype.defaultOptions.exportFormatter,imeMode:E.prototype.defaultOptions.imeMode,selectSetter:E.prototype.defaultOptions.selectSetter,dateValidCheck:E.prototype.defaultOptions.dateValidCheck,escape:E.prototype.defaultOptions.escape,depthType:E.prototype.defaultOptions.depthType,NaNFormat:E.prototype.defaultOptions.NaNFormat,disabledClass:E.prototype.defaultOptions.disabledClass,hiddenClass:E.prototype.defaultOptions.hiddenClass,displayMode:E.prototype.defaultOptions.displayMode,delimiter:E.prototype.defaultOptions.delimiter,
skipKeyMove:E.prototype.defaultOptions.skipKeyMove,minWidth:E.prototype.defaultOptions.minWidth,keepCellClass:E.prototype.defaultOptions.keepCellClass,usePartialCheck:E.prototype.defaultOptions.usePartialCheck}},E.prototype._defaultOptionsKeyLowerCase={},E.prototype.defaultOptions)E.prototype._defaultOptionsKeyLowerCase[M.toLowerCase()]=M;E.prototype.setOptions=function(t,e){try{var i=this.mainGrid.options.pluginName,n=t.getAttribute("calendarValueType")||this.options.calendarValueType,l=t.getAttribute("inputType")||"text";this.configOptions=o.q.extend({},r.I.getConfig(i+"/column[@inputType='"+l+"']"));var h=t.getAttribute("dataType")||"text";this.configOptions2=o.q.extend({},r.I.getConfig(i+"/column[@dataType='"+h+"']")),"calendar"==l&&"grid"==i?this.configOptions.displayFormat=r.I.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@value')||r.I.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat/@value'):"calendar"==l&&"gridView"==i&&(this.configOptions.displayFormat=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@value')||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat/@value')||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@defaultValue')),"textarea"===l&&(this.configOptions.keepCellClass=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/keepCellClass/@value')),this.options=o.q.extendKeepingType(o.q.extendKeepingType(this.options,this.configOptions2),this.configOptions);var d=WebSquare.Parser.parseAttribute(t);for(var p in d){var u=d[p];"class"==p?this.options.className=u:""!=String(u).wq_trim()&&(this._defaultOptionsKeyLowerCase[p]&&(p=this._defaultOptionsKeyLowerCase[p]),"boolean"==typeof this.defaultOptions[p]?u=a.Z.getBoolean(u):"number"==typeof this.defaultOptions[p]&&(u=a.Z.getNumber(u)),this.options[p]=u)}if(!(h=this.options.dataType)&&this.mainGrid.successBinding&&(h=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"==h&&!this.options.displayFormat){if(this.options.displayFormatFunc){var c=a.Z.getGlobalFunction(this.options.displayFormatFunc,this.scope_id);"function"==typeof c&&(this.options.displayFormat=c.call(this,this.options.calendarValueType))}this.options.displayFormat||(this.options.displayFormat=r.I.getConfiguration("/WebSquare/"+i+"/dataType/date/@displayFormat"))}if("date"==h&&this.options.calendarDisplayFormatFunc&&!this.options.calendarDisplayFormat){var g=a.Z.getGlobalFunction(this.options.calendarDisplayFormatFunc,this.scope_id);"function"==typeof g&&(this.options.calendarDisplayFormat=g.call(this,this.options.calendarValueType))}if("time"!=h||this.options.displayFormat||(this.options.displayFormat="HH:mm"),this.mainGrid.options.senseReader&&"false"!==this.options.embeddedInput)switch(this.options.inputType||"text"){case"secret":case"text":"none"==this.mainGrid.options.focusMode&&"false"!=this.options.readOnly&&(this.options.readOnly=!0);case"select":case"checkbox":case"radio":case"calendar":this.options.embeddedInput=!0}else this.options.embeddedInput=a.Z.getBoolean(this.options.embeddedInput);if("textarea"==this.options.inputType&&(this.options.showReadOnly=!0),this.element=t,"expression"==this.options.inputType){var f=this.options.expression;""!=f&&(f=f.replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(")).match("rowStatus")&&this.mainGrid.rowStatusColIDArr.push(this.options.col_id)}this.options.editModeEventIcon||(this.options.editModeEventIcon=this.mainGrid.options.editModeEventIcon);!0!=={onclick:!0,ondblclick:!0}[this.options.editModeEventIcon]&&(this.options.editModeEventIcon="onclick"),this.options.copyOption||(this.options.copyOption=this.mainGrid.options.copyOption),
this.options.chooseOptionLabel||("autoComplete"===this.options.inputType?this.options.chooseOptionLabel=WebSquare.language.getMessage("AutoComplete_choose")||"-choose-":"checkcombobox"===this.options.inputType?this.options.chooseOptionLabel=WebSquare.language.getMessage("CheckCombobox_choose")||"-choose-":this.options.chooseOptionLabel=WebSquare.language.getMessage("SelectBox_choose")||"-choose-")}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setController=function(){switch(this.mainGrid.options.useTextMultiLink&&"text"===this.options.inputType&&this.options.customFormatter&&(this.options.inputType="user"),this.options.inputType){case"text":default:o.q.extend(this,WebSquare.uiplugin.cellInfo.text.prototype);break;case"link":o.q.extend(this,WebSquare.uiplugin.cellInfo.link.prototype);break;case"checkbox":o.q.extend(this,WebSquare.uiplugin.cellInfo.checkbox.prototype);break;case"button":o.q.extend(this,WebSquare.uiplugin.cellInfo.button.prototype);break;case"image":o.q.extend(this,WebSquare.uiplugin.cellInfo.image.prototype);break;case"radio":o.q.extend(this,WebSquare.uiplugin.cellInfo.radio.prototype);break;case"select":o.q.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.select.prototype);break;case"calendar":o.q.extend(this,WebSquare.uiplugin.cellInfo.calendar.prototype);break;case"textarea":o.q.extend(this,WebSquare.uiplugin.cellInfo.textarea.prototype);break;case"expression":o.q.extend(this,WebSquare.uiplugin.cellInfo.expression.prototype);break;case"drilldown":o.q.extend(this,WebSquare.uiplugin.cellInfo.text.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.drilldown.prototype);break;case"textImage":o.q.extend(this,WebSquare.uiplugin.cellInfo.textImage.prototype);break;case"checkcombobox":o.q.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.checkcombobox.prototype);break;case"autoComplete":o.q.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.autoComplete.prototype);break;case"spinner":o.q.extend(this,WebSquare.uiplugin.cellInfo.spinner.prototype);break;case"custom":o.q.extend(this,WebSquare.uiplugin.cellInfo.custom.prototype);break;case"user":o.q.extend(this,WebSquare.uiplugin.cellInfo.user.prototype)}},E.prototype.setInnerHTML=function(t,e,i,o,s){this.mainGrid._getWrapperCell(t,i).innerHTML=this.mainGrid.dataTagOpen+this.getDisplayData(e)+this.mainGrid.dataTagClose},E.prototype.setEditMode=function(t,e){this.mainGrid.editedCell=null,this.mainGrid.editMode=!1},E.prototype.initFormatter=function(t){try{var e=this.options.dataType;if(!e&&this.mainGrid.successBinding&&(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),!e&&this.options.expression){var i=this.options.expression;(i=(i=(i=(i=(i=(i=(i=(i=i.replace(/[sS][uU][mM][\s]*[(]/g,"NUMBER(")).replace(/[aA][vV][gG][\s]*[(]/g,"NUMBER(")).replace(/[mM][aA][xX][\s]*[(]/g,"NUMBER(")).replace(/[mM][iI][nN][\s]*[(]/g,"NUMBER(")).replace(/rowStatus[\s]*[(]/gi,"NUMBER(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"STRING(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"STRING(")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"STRING(")).indexOf("NUMBER(")>-1?e="number":i.indexOf("STRING(")>-1&&(e="text")}var o=e,a=this.mainGrid._isNumberType(e);a&&"\t"===this.options.delimiter&&(this.options.delimiter="");var n,l,h=this.options.displayFormat;if("text"==this.options.inputType&&!h)if(a)"euro"==e?(h||(h=this.mainGrid.options.euroMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/euroMask/@value')||""),n=".",l=","):"rupee"==e?(h||(h=this.mainGrid.options.rupeeMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/rupeeMask/@value')||""),n=",",
l="."):"tenge"==e?(h||(h=this.mainGrid.options.tengeMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/tengeMask/@value')||""),n=" ",l=","):"number"!=e&&"float"!=e&&"bigDecimal"!=e||(h||(h=this.mainGrid.options.numberMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/numberMask/@value')||""),n=",",l="."),this.options.displayFormat=h,this.options.delimiter||(this.options.delimiter=n),this.options.decimalDelimiter||(this.options.decimalDelimiter=l),this.options.customModelFormatter||(this.options.customModelFormatter=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelFormatter/@value')||""),this.options.customModelUnformatter||(this.options.customModelUnformatter=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelUnformatter/@value')||"");"date"!=o||"calendar"!=this.options.inputType||this.options.ioFormat||(this.options.ioFormat=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/ioFormat[@valueType="'+this.options.calendarValueType+'"]/@defaultValue'),this.options.ioFormat||("yearMonthDate"==this.options.calendarValueType?this.options.ioFormat="yyyyMMdd":"yearMonth"==this.options.calendarValueType?this.options.ioFormat="yyyyMM":"yearMonthDateTime"==this.options.calendarValueType?this.options.ioFormat="yyyyMMddHHmm":"yearMonthDateTimeSec"==this.options.calendarValueType&&(this.options.ioFormat="yyyyMMddHHmmSS"))),"default"==this.options.maskFormat&&this.options.displayFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("numberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("textMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):"reverse"==this.options.maskFormat&&this.options.displayFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("reverseNumberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("reverseTextMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):this.formatter="float"===o||"bigDecimal"===o?WebSquare.format.createFormatter(o,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.mainGrid.scope_id,this.mainGrid.id):WebSquare.format.createFormatter(o,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,null,null,this.mainGrid.scope_id,this.mainGrid.id),this.emptyFormatter=WebSquare.format.createFormatter(o,"",null,null,null,null,this.mainGrid.scope_id,this.mainGrid.id)}catch(t){s.Y.printStackTrace(t)}},E.prototype.getDisplayData=function(t){return this.formatter&&(t=this.formatter.format(t)),"secret"==this.options.inputType&&(t=t.replace(/./gi,"")),t},E.prototype.getLocaleValue=function(t){try{var e
;if(t&&(!0===this.options.useItemLocale||void 0===this.options.useItemLocale&&!0===this.mainGrid.useItemLocale))t===this.options.chooseOptionLabel?this.options.chooseOptionLabelLocaleRef&&(e=this.mainGrid.getLocaleValue(this.options.chooseOptionLabelLocaleRef)):e=this.mainGrid.getLocaleValue(t),e&&(t=e);return t}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.initializeCellInfo=function(){},E.prototype.handleEndEdit=function(t,e,i){try{if(t=t||{},i=i||{},this.options.embeddedInput)return!0;if(this.mainGrid.rollbackCommitFlag=!1,this.mainGrid.editedCell&&0==this.mainGrid.editMode&&(this.mainGrid.editMode=!0),this.mainGrid.editMode){var o=this.mainGrid.editedCell;if(o._getEditedValue){var a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.editRowIndex,l=this.mainGrid._getGroupbyDisplayRowIndex(n),h=o._getEditedValue();if(!0===this._editendCalled)return;if(this._editendCalled=!0,p=d.f.fireEvent(this.mainGrid,"oneditend",l,a,h,t),this._editendCalled=!1,p+""=="false")return this.mainGrid.getInput(this).focus(),d.f.stopEvent(t),!1}if(!o.validate())return d.f.stopEvent(t),!1;if(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,!i.otherClick){c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),this._handleEndEdit(t,e,i));var p=this._afterEndEdit(o,c,i);return o=null,p}var u=null,c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),u=this._handleEndEdit(t,e,i)),r.I.setTimer((function(t,e){null!=this.editTd&&this._handleEndEdit_focus(e),this._afterEndEdit(t,c,i),t=null,e=null}),{key:this.id+"_handleClickEventDocument",caller:this,args:[o,u]}),u=null,o=null}}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype._afterEndEdit=function(t,e,i){i=i||{};var o,s=this.mainGrid.dataList._getCellData(this.editRowIndex,t.options.id),r=this.editRowIndex,n=t.options.id,l=r,h=this.mainGrid.getColumnIndex(n);if(this.editTd){var p=a.Z.getDataPrefix("colMerged");o=this.editTd.getAttribute(p)}if("0"==o&&!t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped){var u=function(t,i,o,s){for(var r=t;t+1<this.mainGrid.getDataLength();){t+=1;var a=this.mainGrid.upperGroupingTest(t,i),n=this.mainGrid.dataList._getCellData(t,i);if(!a){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}for(t=r;t-1>=0;){a=this.mainGrid.upperGroupingTest(t,i);t-=1;n=this.mainGrid.dataList._getCellData(t,i);if(!a){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var h,l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}i=this.mainGrid.getColumnIndex(i);this.mainGrid.applyColumnStyleOptions(i)};u.call(this,r,n,h,s);var c=this.mainGrid.upperToLowerColumnRelation[n];if(c)for(var g=0;g<c.length;g++){var f=c[g],m=this.mainGrid.dataList._getCellData(r,f),y=this.mainGrid.getColumnIndex(f),b=this.mainGrid.getCellInfo(f);u.call(b,r,f,y,m)}}t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped&&this.mainGrid.setColMergeCellData(l-this.mainGrid.rowIndex,l,h);var v=this.mainGrid.dataList._getCellData(l,h),w=l+"_"+h;if(null!=this.mainGrid.cellMergeInfo[w]){var C=this.mainGrid.cellMergeInfo[w].rowSpan,I=this.mainGrid.cellMergeInfo[w].colSpan;for(g=0;g<C;g++)for(var _=0;_<I;_++)0===g&&0===_||this.mainGrid.dataList.__setCellData(l+g,h+_,v)}Math.abs(this.changedCellHeight)>3&&this.mainGrid.notifyRowChanged(l);var x=this.mainGrid._getGroupbyDisplayRowIndex(l)
;if(!this.mainGrid.options.viewChangeAfterEdit||!i.from_fireOnviewchange&&!i.from_handleClickEvent)var S=d.f.fireEvent(this.mainGrid,"onafteredit",x,h,v,this.mainGrid.lastEvent);return this.mainGrid.lastEvent=null,S=0!=S,this.mainGrid.rollbackCommitFlag=!0,S},E.prototype.handleScrollY=function(t,e,i){return this.validate()?this.handleEndEdit(t,void 0,i):this.handleCancelEdit(t)},E.prototype.validate=function(){return!0},E.prototype._handleEndEdit=function(t,e,i){var o=this._handleEndEdit_common(t);if((i=i||{}).otherClick)return o;this._handleEndEdit_focus(o,e,i.focuseChanged)},E.prototype._handleEndEdit_common=function(t,e){return null},E.prototype._handleEndEdit_focus=function(t){return null},E.prototype.handleCancelEdit=function(t){this.options.embeddedInput||(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,this._handleCancelEdit(t))},E.prototype._handleCancelEdit=function(t){},E.prototype.removeCellData=function(t,e){},E.prototype.doDefaultAction=function(t){},E.prototype.setMergedCol=function(t,e,i,o){var s=t,r=new Array;for(r[t]=!0;t<this.mainGrid.getDataLength();){if(t+=1,!(a=this.mainGrid.upperGroupingTest(t,e)))break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),r[t]=!0}for(t=s;t>0;){var a=this.mainGrid.upperGroupingTest(t,e);if(t-=1,!a)break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),r[t]=!0}e=this.mainGrid.getColumnIndex(e);return this.mainGrid.applyColumnStyleOptions(e),r},E.prototype.getEscape=function(){return""!=this.options.escape?this.options.escape:this.mainGrid.options.escape},E.prototype.getColumnIndex=function(t){return t||(t=this.colID),this.mainGrid.getColumnIndex(t)},E.prototype.setMaxLength=function(t){try{if(this.options.maxlength=this.options.maxLength=t,"autoComplete"==this.options.inputType)this.autoComplete&&this.autoComplete.setMaxLength(t);else if("text"!==this.options.inputType&&"secret"!==this.options.inputType||1!=this.options.embeddedInput){this.mainGrid.getInput(this).setMaxLength(t)}else for(var e=this.mainGrid.tdIdList.length,i=this.mainGrid.getColumnIndex(this.options.id),o=this.mainGrid.getRowCount(),r=0;r<o;r++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[r*e+i]).setMaxLength(t)}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setFloatMaxLength=function(t){try{this.options.maxlength=this.options.maxLength="-1",this.mainGrid.getInput(this).setFloatMaxLength(t)}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.refreshCell=function(){},E.prototype._checkFastScroll=function(t,e,i,o){try{var r="string"!=typeof t||!1===this.mainGrid._regDetectDOM.test(t);return e&&null!=e.textContent&&this.mainGrid.hasClass(e,i)&&r&&!0===o}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl=function(){},E.itemsetControl.prototype.initializeCellInfo=function(t){try{if(this.internal&&this.initializeInfo?this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.initializeInfo.rowIndex+"_"+this.colID+"_"+this.id:this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.colID,"select"===this.options.inputType&&""!=this.options.selectSetter)this.selectSetted=!1,this.resetMatchInfo=!0;else{var e="";if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var i=(e=a.Z.isIE("6 7")&&this.internal&&t._element.outerHTML?WebSquare.xml.nodeWellFormed(t._element.outerHTML):WebSquare.xml.serialize(t._element)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"",r=this.options.inputType;e=(e=e.wq_replaceAll("<w2:column","<w2:"+r+i)).wq_replaceAll("</w2:column","</w2:"+r);var n=WebSquare.xml.parse(e,!0);this.xml=new WebSquare.Elem(n.documentElement)}o.q.extend(this,A.t.prototype),this.hasRef=!1,
"checkcombobox"!==this.options.inputType&&("select"===this.options.inputType?this.options.selectedIndex&&(this.selectedIndex=parseInt(this.options.selectedIndex,10)):this.selectedIndex=void 0===this.options.selectedIndex?-1:parseInt(this.options.selectedIndex,10)),this.options.selectedDataDisplay||(this.options.selectedData=!1),this.internal?this.itemsetObj=this.initializeInfo.itemSet?this.initializeInfo.itemSet:{nodeset:"",label:"",value:""}:this.itemsetObj=WebSquare.WebSquareparser.parseItemset(this.xml),this.resetMatchInfo=!0;var l=this.itemsetObj.nodeset.wq_replaceAll(" ","");if(this.internal&&"gridViewItemset"==this.options.itemTableType?this.existGridViewItemsetNode=!0:(this.existGridViewItemsetNode=WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:gridViewItemset")[0],this.existGridViewItemsetNode&&this.options.embeddedInput&&(p.v.printLog("not support embeddedInput in gridViewItemset ["+this.mainGrid.id+"."+this.id+"]"),this.options.embeddedInput=!1)),""!=this.itemsetObj.nodeset&&l.indexOf("ref(")>=0){this.hasRef=!0;var h=this.itemsetObj.nodeset;this.refStr='"'+this.refReplace(h)+'"';for(var d=h.match(/ref\('([^']*)'\)/g),u=0;u<d.length;u++){var c=d[u].slice(5,-2),g=this.mainGrid.getCellInfo(c);g.refArr||(g.refArr=[]),g.refArr.push(this.colID)}if(this.refHash=[],this.refItemArr=[],"select"===this.options.inputType&&this.options.embeddedInput)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset","")}else if(""!=this.itemsetObj.nodeset&&l.indexOf("data:")>=0){var f=this.itemsetObj.nodeset.replace("data:","").split(".");this.dataComp=f[0]}else this.matchInfo=this.setMatchInfo()}this.refArr||(this.refArr=[]),this._initializeCellInfo()}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype.getItemText=function(t){try{var e="";if(t>-1&&t<this.itemArr.length){switch(e=this.itemArr[t].orgLabel||this.itemArr[t].label,this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}switch(this.options.displayMode){case"0":break;case"1":e=this.itemArr[t].value+this.options.delimiter+e;break;case"2":e=e+this.options.delimiter+this.itemArr[t].value;break;case"3":e=this.itemArr[t].value}}return e}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype._initDisplayMode=function(t){try{switch(this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype.setColumnNodeSet=function(t,e,i,o){try{if(this.internal)this.itemsetObj.nodeset=t,this.itemsetObj.label=e,this.itemsetObj.value=i;else{if("json"===this.xml._elementType){var a=[];a.push({N:"w2:label",T:1,A:{ref:e}}),a.push({N:"w2:value",T:1,A:{ref:i}});var n=WebSquare.Elem.api.getElementsByTagName(this.xml,"itemset",r.I._XML_NAMESPACE.W2)[0];n?(n._element.A.nodeset=t,n._element.E=a):this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:itemset",A:{nodeset:t},E:a}]}]}else{var l=WebSquare.xml.findNode(this.xml,"*['choices'=local-name()]['"+r.I._XML_NAMESPACE.W2+"'=namespace-uri()]");for(null==l&&(l=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,l));l&&l.firstChild;)l.removeChild(l.firstChild);var h="<w2:itemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+t+"'><w2:label ref='"+e+"'></w2:label><w2:value ref='"+i+"'></w2:value></w2:itemset>",d=WebSquare.xml.parse(h,!0).documentElement;WebSquare.xml.appendChild(l,d)}this.itemArr=[],this.initializeCellInfo(this.xml)}var p=this.options.inputType;if(1==this.options.embeddedInput){var u=this.mainGrid.tdIdList.length,c=this.mainGrid.getColumnIndex(this.options.id)
;if(isNaN(o))for(var g=this.mainGrid.getRowCount(),f=this.mainGrid.rowIndex;f<g;f++){(m=this.mainGrid.data_td_list[(f-this.mainGrid.rowIndex)*u+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}else{var m,y=o-this.mainGrid.rowIndex;if(y>=0)(m=this.mainGrid.data_td_list[y*u+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}}else this[p]&&this[p].setNodeSet(t,e,i);t.indexOf("data:")>=0&&(this.dataComp=t.slice(5))}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype.setColumnGridItemset=function(t){try{if("select"!==this.options.inputType&&"autoComplete"!==this.options.inputType)return;var e=t.nodeset,i=t.label,o=t.value;if(this.internal)this.itemsetObj.nodeset=e,this.itemsetObj.label=i,this.itemsetObj.value=o;else{if("json"===this.xml._elementType){var a=[],n={};for(var l in t)"object"!=typeof t[l]&&"function"!=typeof t[l]&&null!=t[l]&&(n[l]=t[l]);for(var h=0;h<t.item.length;h++)a.push({N:"w2:item",T:1,A:t.item[h]});var d=WebSquare.Elem.api.getElementsByTagName(this.xml,"gridViewItemset",r.I._XML_NAMESPACE.W2)[0];if(d){for(var l in n)d._element.A[l]=n[l];d._element.E=a}else this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:gridViewItemset",A:n,E:a}]}]}else{var p=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",r.I._XML_NAMESPACE.W2);for(null==p&&(p=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,p));p&&p.firstChild;)p.removeChild(p.firstChild);if(r.I.isXML(t))WebSquare.xml.appendChild(p,t);else{var u="<w2:gridViewItemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+e+"'></w2:gridViewItemset>",c=WebSquare.xml.parse(u,!0),g=c.documentElement;for(var f in t)if("item"===f)for(h=0;h<t.item.length;h++){var m=WebSquare.xml.createElement(c,"w2:item"),y=t.item[h];for(var b in y)m.setAttribute(b,y[b]);WebSquare.xml.appendChild(g,m)}else"nodeset"!==f&&g.setAttribute(f,t[f]);WebSquare.xml.appendChild(p,g)}}this.initializeCellInfo(this.xml)}if("select"===this.options.inputType&&1==this.options.embeddedInput){var v=this.mainGrid.tdIdList.length,w=this.mainGrid.getColumnIndex(this.options.id),C=this.mainGrid.getRowCount();for(h=0;h<C;h++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[h*v+w]).setGridItemset(t)}this[this.options.inputType]&&this[this.options.inputType].setGridItemset(t),e.indexOf("data:")>=0&&(this.dataComp=e.slice(5))}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype.getColumnDataListInfo=function(){try{if(this[this.options.inputType])return this[this.options.inputType].getDataListInfo();var t=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",r.I._XML_NAMESPACE.W2)[0];if(t){var e=WebSquare.WebSquareparser.parseItemset(t),i={};return e&&""!==e.nodeset?(e.nodeset.match("data:")?(i.nodeset=e.nodeset.slice(0),i.id=i.nodeset.wq_replaceAll("data:",""),i.value=e.value,i.label=e.label):(i.nodeset=e.nodeset.slice(0),i.value=e.value,i.label=e.label),i):null}return null}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype.getDisplayData=function(t,e,i){var o=this.getData(t,e,i);return null==o&&(o=""),i&&i.emptyValue&&o===i.emptyValue?o="":o!=t&&""==o&&(o=t),o},E.itemsetControl.prototype.setMatchInfo=function(t){this.modelControl=new WebSquare.modelControl(this.colID,this.options.model,this.options.ref,this.options.bind,this.options._scope_obj_uuid),this.existGridViewItemsetNode?this.initializeGridViewItemArr(this.xml):this.initializeItemArr(this.xml),0==this.itemArr.length?this.resetMatchInfo=!0:this.resetMatchInfo=!1;for(var e=0;e<this.itemArr.length;e++)this.itemArr[e].label=this.getItemText(e);var i={};if(1==this.options.allOption){var o=WebSquare.language.getMessage("Grid_all")||"-all-";this.itemArr=[{label:o,value:WebSquare.allValue}].concat(this.itemArr)}if(1==this.options.chooseOption&&"checkcombobox"!==this.options.inputType){var s=this.options.chooseOptionLabel;"$blank"==s&&(s=""),this.itemArr=[{label:s,value:this.options.chooseOptionValue}].concat(this.itemArr)}
this.hasRef&&(this.refItemArr[this.itemsetObj.nodeset]=this.itemArr);var r=this.options.inputType.toUpperCase();for(e=0;e<this.itemArr.length;e++){var a=this.itemArr[e];i[r+"_"+a.value]=a.label}return i},E.itemsetControl.prototype.getMatchInfo=function(t){var e=[];return"select"===this.options.inputType&&""!=this.options.selectSetter?e=this.matchInfo:this.hasRef?e=this.getRefMatchInfo(t):this.hasRef||(this.resetMatchInfo&&(this.matchInfo=this.setMatchInfo(t)),e=this.matchInfo),e},E.itemsetControl.prototype.getRefMatchInfo=function(t){this.targetRowIndex=t;var e=new Function("_this","return "+this.refStr)(this);if(null==this.refHash[e]||this.resetMatchInfo){this.itemsetObj.nodeset=e,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",e);var i=this.setMatchInfo(t);return this.refHash[e]=i,i}return this.refHash[e]},E.itemsetControl.prototype.getRefItemArr=function(t){this.getRefMatchInfo(t);var e=new Function("_this","return "+this.refStr)(this);return this.refItemArr[e]},E.itemsetControl.prototype.getRefValue=function(t){return'"'+this.mainGrid.dataList._getCellData(this.targetRowIndex,t)+'"'},E.itemsetControl.prototype.refReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"\"+_this.getRefValue('$1')+\"");return e!=t?this.refReplace(e):e}catch(t){s.Y.printStackTrace(t,null,this)}},E.itemsetControl.prototype.refXmlReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"'+_this.getRefValue('$1')+'");return e!=t?this.refXmlReplace(e):e}catch(t){s.Y.printStackTrace(t,null,this)}},E.text=function(){},E.text.prototype.getDisplayData=function(t){(this.formatter&&(t=this.formatter.format(t)),"text"==this.options.inputType&&this.options.editFormat&&""!=t)&&(t=WebSquare.text.dynamicMask(t,this._editFormat,this._editTokens).value);return"secret"==this.options.inputType&&(t=t.replace(/./gi,"")),t},E.text.prototype.setInnerHTML=function(t,e,i,o,n){var l=this.mainGrid._getGroupbyDisplayRowIndex(i),h=this.mainGrid._getWrapperCell(t,i);if(!this.options.embeddedInput||this.mainGrid._getEditDisabled(i,o)||this.mainGrid.___getEditReadOnly(i,o)||this.mainGrid.groupbyStatus.grouped){if(this.mainGrid.options.titleFormatter)try{var d;if("function"!=typeof this.mainGrid.options.titleFormatter){var p=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof p&&(this.mainGrid.options.titleFormatter=p,d=p.call(this,i,o,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",d)}catch(t){s.Y.printStackTrace(t,null,this)}else if(this.options.title)t.setAttribute("title",this.options.title);else if(this.mainGrid.options.titleAuto){var u=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";""!==e?t.setAttribute("title",u+" "+e):t.setAttribute("title",u+WebSquare.language.getMessage("Grid_text"))}var c=WebSquare.util.getDataPrefix("editModeEvent");"onclick"===this.options.editModeEvent||"ondblclick"===this.options.editModeEvent||"onsecondclick"===this.options.editModeEvent?t.setAttribute(c,this.options.editModeEvent):t.setAttribute(c,"");var g=null;if(this.options.escapeFormatter)try{"function"==typeof this.options.escapeFormatter?g=this.options.escapeFormatter:"function"==typeof(g=a.Z.getGlobalFunction(this.options.escapeFormatter,this.scope_id))&&(this.options.escapeFormatter=g)}catch(t){g=null}Z=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?Z=this.options.customFormatter:"function"==typeof(Z=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=Z)}catch(t){Z=null}var f=null;if(this.options.customModelUnformatter)try{"function"==typeof this.options.customModelUnformatter?f=this.options.customModelUnformatter:"function"==typeof(f=a.Z.getGlobalFunction(this.options.customModelUnformatter,this.scope_id))&&(this.options.customModelUnformatter=f)}catch(t){f=null}var m=e
;f&&this.options.customModelUnformatter?(this.useCustomModelFormatter=!0,m=f.call(this.mainGrid,e,l,o)):this.useCustomModelFormatter=!1,this.options.maskFormat&&this.options.displayFormat&&(m=this.mainGrid.getInput(this,t,e).maskFormatModelUnFormat(m)),"function"==typeof g?(this.useEscapeFormatter=!0,m=g.call(this.mainGrid,e,l,o)):this.useEscapeFormatter=!1;var y=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(y=a.Z.getBoolean(y))&&(m=this.useCustomModelFormatter?WebSquare.xml._encode(m+""):WebSquare.xml._encode(e+""));j=m;if(this.options.editFormat&&this.options.editFormat.length>0){var b={"#":{pattern:/\d/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},"!":{escape:!0}},v=this.options.editFormat.split("||").sort((function(t,e){return t.replace(/[^a-z^A-Z^0-9]/g,"").length-e.replace(/[^a-z^A-Z^0-9]/g,"").length}));j=WebSquare.text.dynamicMask(j,v,b).value,this._editFormat=v,this._editTokens=b}P=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat||this._changeDisplayFormat;if(this.formatter&&P&&(j=this.formatter.format(m)),"secret"==this.options.inputType&&(j=j.replace(/./gi,"")),"function"==typeof Z?(this.useCustomFormatter=!0,z=Z.call(this.mainGrid,e,j,l,o)):(this.useCustomFormatter=!1,z=j),this.mainGrid.options.plainText&&!1===this.useCustomFormatter&&!this.options.displayFormatter&&h.firstChild&&h.firstChild.firstChild)h.firstChild.firstChild.data=z;else{var w=this.mainGrid.___getEditReadOnly(i,o),C=this.mainGrid._getEditDisabled(i,o),I="",_=[];_.push("w2grid_input"),this.mainGrid.options.checkEditableInputClass&&(w||C)&&(_=[]),"secret"==this.options.inputType&&r.I.browserCheck.ieAllVersion&&_.push("w2grid_secret"),w&&_.push("w2grid_input_readonly"),C&&_.push("w2grid_input_disabled");var x=h.firstChild,S=this._checkFastScroll(z,x,"w2grid_input",n&&!0===n.scroll);if(x&&(!C&&x.className.indexOf("w2grid_input_disabled")>-1||C&&-1===x.className.indexOf("w2grid_input_disabled")||!w&&x.className.indexOf("w2grid_input_readonly")>-1||w&&-1===x.className.indexOf("w2grid_input_readonly"))&&(S=!1),S&&y){var R="string"==typeof z?WebSquare.xml.__decode2(z):z;x.textContent=R}else{"span"==this.mainGrid.options.dataTag&&_.push("w2grid_span"),I=" class='",I+=_.join(" "),I+="'";var D=!1,T=h.firstChild;y&&T&&("NOBR"===T.tagName||"SPAN"===T.tagName&&T.className.indexOf("w2grid_span")>-1)&&" class='"+T.getAttribute("class")+"'"===I&&1===T.attributes.length&&(D=!0),D?h.firstChild.innerHTML=z:h.innerHTML="<"+this.mainGrid.options.dataTag+" "+I+">"+z+this.mainGrid.dataTagClose}this.mainGrid.hasClass(t,"w2grid_input_table")||(t.className="w2grid_input_table "+t.className)}}else{var L=this.mainGrid.getInput(this,t,e);null==this.mainGrid._getWrapperTD(L.render.parentNode)&&(h.innerHTML="",h.appendChild(L.render)),L.blur();var k=a.Z.getDataPrefix("rowindex");L.render.setAttribute(k,i);var F=!1;if(this.mainGrid.options.autoResizeEmbeddedInput){var A=!1;this.mainGrid.__bResizeObj?(A=this.mainGrid.__bResizeObj.width!==this.mainGrid.resizeObj.width||this.mainGrid.__bResizeObj.height!==this.mainGrid.resizeObj.height,this.mainGrid.__bResizeObj.width=this.mainGrid.resizeObj.width,this.mainGrid.__bResizeObj.height=this.mainGrid.resizeObj.height):this.mainGrid.__bResizeObj={width:this.mainGrid.resizeObj.width,height:this.mainGrid.resizeObj.height},F=!0!==L._autoResizeEmbeddedInput&&!1===A||this.mainGrid.__bResizeObj.isColumnResizing}if(!0===F){var E=0,M=0,O=!1,N=(this.mainGrid.oneRowLength,this.mainGrid._bodyIdMultiRowIndexMap[this.colID]);if("none"==t.parentNode.style.display){for(var H=N,G=t.parentNode;H>0;)"none"==G.previousElementSibling.style.display&&(G.previousElementSibling.style.display=""),G=G.previousElementSibling,H--;t.parentNode.style.display="",O=!0}null==this.mainGrid._getWrapperTD(L.render.parentNode)&&(h.innerHTML="",h.appendChild(L.render)),this.mainGrid.embeddedStyleObj||(this.mainGrid.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),
bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(L.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(L.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(L.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(L.render,"padding-right"),10)});var B=parseInt(WebSquare.style.getStyle(L.render,"border-top-width"),10),W=parseInt(WebSquare.style.getStyle(L.render,"border-bottom-width"),10),V=parseInt(WebSquare.style.getStyle(L.render,"border-left-width"),10),q=parseInt(WebSquare.style.getStyle(L.render,"border-right-width"),10);E=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),E-=this.mainGrid.embeddedStyleObj.top+this.mainGrid.embeddedStyleObj.bottom,E-=B+W;var Y=o;if(this.mainGrid.embeddedWidthObj[Y]&&!this.mainGrid.embeddedWidthObj[Y].isChanged||(this.mainGrid.embeddedWidthObj[Y]={isChanged:!1,width:t.clientWidth}),M=this.mainGrid.embeddedWidthObj[o].width,M-=this.mainGrid.embeddedStyleObj.left+this.mainGrid.embeddedStyleObj.right,M-=V+q,M-=this.mainGrid.embeddedStyleObj.inputLeft+this.mainGrid.embeddedStyleObj.inputRight,O){for(H=N,G=t.parentNode;H>0;)G.previousElementSibling.style.display="none",G=G.previousElementSibling,H--;t.parentNode.style.display="none"}else(a.Z.isIE("6 7")||a.Z.isSpartan())&&(E-=2);a.Z.isOpera()&&(E+=2),L.setSize(M-2,E-(this.mainGrid.embeddedStyleObj.inputTop+this.mainGrid.embeddedStyleObj.inputBottom)),L.setStyle("lineHeight",E+"px"),L._autoResizeEmbeddedInput=!0}else null==this.mainGrid._getWrapperTD(L.render.parentNode)&&(h.innerHTML="",h.appendChild(L.render));"all"==this.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||(e=this.getDisplayData(e));var Z=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?Z=this.options.customFormatter:"function"==typeof(Z=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=Z)}catch(t){Z=null}var j=e,P=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&P&&(j=this.formatter.format(j)),L.setValue(e),"function"==typeof Z){this.useCustomFormatter=!0;var z=Z.call(this.mainGrid,e,j,l,o);L.render.value=z}this.options.textAlign?L.setStyle("text-align",this.options.textAlign):L.setStyle("text-align",""),t.removeAttribute("tabIndex"),t.removeAttribute("title")}},E.text.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);this.comp=i,this.options.maskFormat&&this.options.displayFormat||(i.formatter="all"==this.options.applyFormat||!0===this._changeDisplayFormat||"date"==this.options.dataType?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat);var o=this.mainGrid.dataList._getCellData(e,this.colID);if("all"===this.options.applyFormat&&this.options.displayFormat&&"text"!=this.options.dataType&&"date"!=this.options.dataType&&"time"!=this.options.dataType){var r=this.options.decimalDelimeter||".",n=(o+"").split(r);n[1]&&0==parseInt(n[1])&&(o=n[0])}i.setValue(o),document.activeElement!=i.render&&i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType?i.select():"focus"==i.options.editType&&(a.Z.isIEAllVersion()||a.Z.isFF()||a.Z.isSpartan())&&WebSquare.text.setCaretPos(i.render,i.render.value.length)}catch(t){s.Y.printStackTrace(t,null,this)}},E.text.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(a.Z.isFF()?t={top:-1,left:0,width:0,height:0
}:a.Z.isOpera()?t={top:0,left:0,width:0,height:1}:a.Z.isIEAllVersion("9 10 11")?t={top:-1,left:-1,width:0,height:0}:a.Z.isSpartan()&&(t={top:0,left:-1,width:0,height:0}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,r=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}this.mainGrid.hasClass("w2grid_adaptive_crosstab")&&(s-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,l.render.style.lineHeight=n+"px");l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=r+"px",l.render.style.height=n+"px",a.Z.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(l.render.id,3)},E.text.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},E.text.prototype._handleEndEdit_common=function(t){try{if(!this.options.embeddedInput){var e=this.mainGrid.getInput(this);return this.setEditData(e),e}}catch(t){s.Y.printStackTrace(t,null,this)}},E.text.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t&&t.hide()},E.text.prototype._getEditedValue=function(t){return"bigDecimal"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")?WebSquare.bigDecimal(this.mainGrid.getInput(this).getValue()).toString():this.mainGrid.getInput(this).getValue()},E.text.prototype._handleCancelEdit=function(t){try{var e,i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide(),e=window.getSelection?window.getSelection():document.selection;var o=document.createRange();o.selectNodeContents(this.editTd),e.removeAllRanges(),e.addRange(o),e.collapseToStart()}catch(t){s.Y.printStackTrace(t,null,this)}},E.text.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.text.prototype.setEditData=function(t){try{var e=t.getValue();if("number"==(o=this.mainGrid.getColumnOption(this.id,"dataType"))||"float"==o){var i=e.wq_trim();"."!==i&&"-"!==i&&"+"!==i||(e="")}e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var o=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==o&&""!=e&&(e=Number(e));var r={};r[this.mainGrid.id]=!0;var n=a.Z.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof n){this.useCustomModelFormatter=!0;var l=this.getDisplayData(e);e=n.call(this.mainGrid,e,l,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;if(e=this.maskFormatModelFormat(e),"float"===o&&e[e.length-1]===t.options.decimalDelimiter){var h=e.split(t.options.decimalDelimiter);e=h[0]}this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,r)}catch(t){s.Y.printStackTrace(t,null,this)}},E.text.prototype.maskFormatModelFormat=function(t){try{if(!t)return t;var e=""
;if(this.options.maskFormat&&this.options.displayFormat)if(this.options.maskFormatModelExcludeChar)for(var i=this.options.maskFormatModelExcludeChar.split(""),o=0;o<t.length;o++){for(var r=!1,a=0;a<i.length;a++)if(t[o]==i[a]){r=!0;break}r||(e+=t[o])}else e=t;else e=t;return e}catch(t){s.Y.printStackTrace(t,null,this)}},E.link=function(){},E.link.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l=" tabIndex='-1' ";"none"==this.mainGrid.options.focusMode?l=" tabIndex='0' ":1==this.mainGrid.options.keyMoveEditMode&&(l="");var h=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(h=a.Z.getBoolean(h))&&(e=WebSquare.xml._encode(e+""));var d,p,u=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),c=this.getDisplayData(e);if("function"==typeof u?(this.useCustomFormatter=!0,d=u.call(this.mainGrid,e,c,i,o)):(this.useCustomFormatter=!1,d=c),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var g=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof g&&(this.mainGrid.options.titleFormatter=g,p=g.call(this,i,o,e))}else p=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.Y.printStackTrace(t,null,this)}var f="";(p?f=" title='"+p+"'":this.options.title&&(f=" title='"+this.options.title+"'"),f)||this.mainGrid.options.titleAuto&&(f=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"")+"'");var m=this.options.voidNull?"javascript:void(null);":"",y="";1==this.mainGrid.options.accessibility&&(y="id='"+this.mainGrid.id+"_link_"+i+"_"+o+"'"),n.innerHTML=d||f?this.mainGrid.dataTagOpen+"<a "+y+" href='"+m+"' onclick='event.returnValue=false; return false;'"+l+" "+f+">"+d+"</a>"+this.mainGrid.dataTagClose:this.mainGrid.dataTagOpen+this.mainGrid.dataTagClose},E.link.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=d.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=a.Z.getDataPrefix("col_id"),r=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),r=n.focusedColIndex}this.mainGrid._getEditDisabled(i,r)||this.mainGrid.___getEditReadOnly(i,r)||d.f.fireEvent(this.mainGrid,"oncellclick",o,r,this.options.id)},E.checkbox=function(){},E.checkbox.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":"$blank"==this.options.trueValue&&(this.options.trueValue=""),"$blank"==this.options.falseValue&&(this.options.falseValue=""),this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.embeddedInput&&(this.mainGrid.options.preventMultipleClick=!1),this.options.checkboxLabelColumn)for(var e=this.options.checkboxLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}void 0!==this.options.focusOutOnCheckHeaderClick&&(this.options.keepFocusOnCheckHeaderClick=!this.options.focusOutOnCheckHeaderClick)},E.checkbox.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},E.checkbox.prototype.setInnerHTML=function(t,e,i){var o,r=this.mainGrid._getWrapperCell(t,i),n=e+""==this.options.trueValue,l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("rowindex");if(o=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute(l)):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute(l)),this.options.embeddedInput){var u=this.mainGrid.getInput(this,t,n);u.setAttribute(h,i),u.checked=n,u.disabled=o}else{var c,g;if(this.mainGrid.options.titleFormatter)try{
if("function"!=typeof this.mainGrid.options.titleFormatter){var f=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.mainGrid.options.titleFormatter=f,g=this.mainGrid.getColumnIndex(this.options.id),c=f.call(this,i,g,e))}else c=this.mainGrid.options.titleFormatter.call(this,i,g,e)}catch(t){s.Y.printStackTrace(t,null,this)}var m=c||this.options.title||"";if(m)m=" title='"+m+"'";else if(this.mainGrid.options.titleAuto){var y=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";m=n?" title='"+y+WebSquare.language.getMessage("Grid_title")+"'":" title='"+y+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}var b="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",v=n?" checked":"",w=o?" disabled='true'":"",C=this.options.visibleFunc,I="";if(this.options.checkboxLabel||this.options.checkboxLabelColumn||this.options.checkboxLabelFormatter){var _=this.mainGridId+"_checkbox_"+this.id,x=_+"_"+i,S=this.options.checkboxLabel||"";if(this.options.checkboxLabelColumn){for(var R=this.options.checkboxLabelColumn.split(","),D="",T=this.options.checkboxLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",L=0;L<R.length;L++){var k=this.mainGrid.bodyToHeaderRelation[R[L]];if(L===R.length-1)this.mainGrid.options.showCheckboxLabelUserFormat?D+=" "+this.mainGrid.getHeaderValue(k)+" "+this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0}):D+=this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0});else if(this.mainGrid.options.showCheckboxLabelUserFormat){var F=WebSquare.language.getMessage("Grid_row")||"row";D+=(0===L?i+1+F+T:"")+" "+this.mainGrid.getHeaderValue(k)+" "+this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0})+T}else D+=this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0})+T}S=S?D+T+S:D}if(this.options.checkboxLabelFormatter)try{var A=a.Z.getGlobalFunction(this.options.checkboxLabelFormatter,this.scope_id);"function"==typeof A&&(S=A.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),S))}catch(t){p.v.printLog(this.mainGrid.id+"_"+this.id+" checkboxLabelFormatter error : "+t.message)}S&&this.mainGrid.options.titleAuto&&!this.options.title&&(m=m.substring(0,m.length-1)+" "+S+"'"),I="<INPUT type='checkbox' "+m+b+v+w+" id='"+x+"' name='"+_+"'/>";var E="<label class='w2checkbox_label ' for='"+x+"'>"+S+"</label>";"left"===this.options.checkboxLabelPosition?I=E+I:I+=E}else I="<INPUT type='checkbox' "+m+b+v+w+" />";if(C){var M,O=a.Z.getGlobalFunction(C,this.scope_id);"function"==typeof O&&(M=O(i)),r.innerHTML=M?I:""}else r.innerHTML=I;if(this.options.noDisabledOnReadOnly)(N=r.getElementsByTagName("input")[0])&&(d.f.addListener(N,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&d.f.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(N,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(N,this.mainGrid.options.readOnlyClass+"_nodisabled"));if(this.mainGrid.options.preventMultipleClick){var N=r.getElementsByTagName("input")[0],H=r.getElementsByTagName("label")[0];this.labelClicked=!1,N&&d.f.addListener(N,"onclick",function(t,e,i){return function(o){t.options.eventPropagation||d.f.stopPropagation(o);var s=!1,r=t.colID;t.mainGrid.getColumnIndex(r);if(!0===t.mainGrid.options.useShiftKeyCheck&&o.shiftKey){var a={td:e[1],rowIndex:e[0],checked:this.checked};t.mainGrid._ShiftKeyMultiCheck(t.mainGrid,a,e[1]),s=!0}e[2]=o.detail,e[3]=s,i.apply(t,e,o)}}(this,[i,t],(function(t,e,i,o){i=this.labelClicked?0:1,this.labelClicked=!1;var s,r,a,n,l,h,p,u=null!=this.mainGrid.editedCell;u&&(s=this.mainGrid.editedCell.editRowIndex,r=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),p=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.mainGrid._grid.getRealRowIndex(s),
l=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+r],h=p.comp&&p.comp.selectedIndex);var c,f,m,y=e.getElementsByTagName("input")[0];if(y&&(c=y.checked,f=this.options.falseValue,c&&(f=this.options.trueValue),""!=(m=this.mainGrid.dataList._getCellData(t,this.colID))||c||(f=m)),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):!0!==o&&this.mainGrid._addFocus(e)),this.handleClick(e,t,!0),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):!0!==o&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),!0===this.mainGrid.options.useShiftKeyCheck&&(this.mainGrid.beforeChecked={td:e,rowIndex:t,checked:y.checked}),t=this.mainGrid._getGroupbyDisplayRowIndex(t),y&&m!=f){var b=this.mainGrid.getColumnIndex(this.options.id),v={oldValue:m,newValue:f,rowIndex:t,colIndex:b,colId:this.mainGrid.getColumnID(b)};d.f.fireEvent(this.mainGrid,"onviewchange",v)}if(this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,g)&&d.f.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:c}),u){var w=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+r];if(l!=w){var C={oldValue:l,newValue:w,rowIndex:s,colIndex:a,colId:this.mainGrid.getColumnID(a)};isNaN(h)||(C.oldSelectedIndex=h,C.newSelectedIndex=p&&p.comp&&p.comp.selectedIndex),d.f.fireEvent(this.mainGrid,"onviewchange",C)}}}))),H&&d.f.addListener(H,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}},E.checkbox.prototype.getDisplayData=function(t){return t},E.checkbox.prototype.handleClick=function(t,e,i){var o=a.Z.getDataPrefix("col_id");if(this.mainGrid.__getEditReadOnly(t,e)||this.mainGrid._getEditDisabled(e,t.getAttribute(o))||!this.options.embeddedInput&&this.mainGrid.options.preventMultipleClick&&!i&&!this.mainGrid.options.checkOnCellClick)return!0;null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var s=t.getElementsByTagName("input")[0];if(s){var r=this.options.id,n=s.checked,l=this.options.falseValue;n&&(l=this.options.trueValue);var h=this.mainGrid.dataList._getCellData(e,this.colID);""!=h||n||(l=h);var p=null;(p={})[this.mainGrid.id]=!0,this.mainGrid._isGridViewItemTable()||this.mainGrid.dataList.__setCellData(e,this.colID,l,null,null,null,p);var u=a.Z.getDataPrefix("colMerged");if("0"==t.getAttribute(u)&&this.setMergedCol(e,r,h,l),h!=l&&!i){var c=this.mainGrid.getColumnIndex(this.options.id),g={oldValue:h,newValue:l,rowIndex:e,colIndex:c,colId:this.mainGrid.getColumnID(c)};d.f.fireEvent(this.mainGrid,"onviewchange",g)}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}return!0},E.checkbox.prototype.checkHeader=function(){try{return this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}catch(t){s.Y.printStackTrace(t,null,this)}},E.checkbox.prototype.doDefaultAction=function(t){if(!this.options.embeddedInput){var e=d.f.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(e.focus();e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID}else i=this.mainGrid.getLastFocusedCell().focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID;var r=!1;if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var a,n,l=e.getElementsByTagName("input")[0];if(l&&(l.checked?(a=this.options.falseValue,l.checked=!1):(a=this.options.trueValue,l.checked=!0),n=this.mainGrid.dataList._getCellData(i,s)),this.handleClick(e,i,!0),a!=n){
var h=this.mainGrid.getColumnIndex(s);d.f.fireEvent(this.mainGrid,"onviewchange",{oldValue:n,newValue:a,rowIndex:o,colIndex:h,colId:this.mainGrid.getColumnID(h)})}r=!0}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID]),this.mainGrid.options.preventMultipleClick&&r&&d.f.fireEvent(this.mainGrid,"oncellclick",i,this.mainGrid.getColumnIndex(s),this.options.id,{checked:l.checked})}},E.checkbox.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.button=function(){},E.button.prototype.setInnerHTML=function(t,e,i){try{var o=a.Z.getDataPrefix("col_id"),r=(this.mainGrid._getEditDisabled(i,t.getAttribute(o)),this.mainGrid._getWrapperCell(t,i)),n=" tabIndex='-1'";"none"==this.mainGrid.options.focusMode?n=" tabIndex='0'":1==this.mainGrid.options.keyMoveEditMode&&(n="");var l,h=this.mainGrid.getColumnIndex(t.getAttribute(o));if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var p=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof p&&(this.mainGrid.options.titleFormatter=p,l=p.call(this,i,h,e))}else l=this.mainGrid.options.titleFormatter.call(this,i,h,e)}catch(t){s.Y.printStackTrace(t,null,this)}var u=l||this.options.title||"";if(u)u=" title='"+u+"'";else if(this.mainGrid.options.titleAuto)u=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"")+"'";var c=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(c=a.Z.getBoolean(c))&&(e=WebSquare.xml._encode(e+""));var g="";if(1==this.mainGrid.options.accessibility&&(g="id='"+this.mainGrid.id+"_button_"+i+"_"+h+"'"),r.innerHTML="<button type='button' "+g+" style='width:100%;height:100%' "+n+u+">"+this.getDisplayData(e)+"</button>",1==this.internal){var f=r.childNodes[0];if(0==f.clientHeight){var m=t.clientHeight-2;WebSquare.style.setSize(f,"height",m)}}this._listener=(y=this,b=[i,h,t],v=function(t,e,i,o){null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit(),this.mainGrid._getEditDisabled(e,i)||this.mainGrid.___getEditReadOnly(e,i)||this.options.blockSelect||this.mainGrid.__setFocusedCell(t,o,{editMode:"none"==this.options.focusMode}),this.mainGrid._getEditDisabled(e,i)||d.f.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(e),i,this.options.id)},function(t){v.apply(y,[t||window.event].concat(b))}),d.f.addListener(r.getElementsByTagName("button")[0],"onclick",this._listener)}catch(t){s.Y.printStackTrace(t,null,this)}var y,b,v},E.button.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=d.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=a.Z.getDataPrefix("col_id"),r=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),r=n.focusedColIndex}this.mainGrid._getEditDisabled(i,r)||this.mainGrid.___getEditReadOnly(i,r)||d.f.fireEvent(this.mainGrid,"oncellclick",o,r,this.options.id)},E.image=function(){},E.image.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l="";""!=this.options.imageWidth&&(l+=";width:"+parseInt(this.options.imageWidth)+"px"),""!=this.options.imageHeight&&(l+=";height:"+parseInt(this.options.imageHeight)+"px"),t.removeAttribute("alt");var h="";""!=this.options.alt&&(h="alt='"+this.options.alt+"' ");var p=a.Z.getDataPrefix("col_id"),u=this.mainGrid._getEditDisabled(i,t.getAttribute(p)),c="";u&&(c=" disabled='true' "),
null==e||""==e?e=this.options.imageSrc?this.options.imageSrc.startsWith("javascript:void")?this.options.imageSrc:this.mainGrid.getImageURL(this.options.imageSrc):"":"string"!=typeof e||e.startsWith("javascript:void")||(e=this.mainGrid.getImageURL(e));var g="";try{this.options.onerror&&(g=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.Y.printStackTrace(t,null,this)}var f,m=this.options.imageTabIndex?" tabIndex='"+this.options.imageTabIndex+"'":"";if(this.mainGrid.options.senseReader&&this.mainGrid.options.focusImage?n.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(u?" w2grid_image_disabled":"")+"' style='"+l+"' "+h+c+g+m+"tabIndex='0' />":n.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(u?" w2grid_image_disabled":"")+"' style='"+l+"' "+h+c+g+m+" />",this.options.imageClickFunction&&(f=this.mainGrid._getEditDisabled(i,o)),this.options.imageClickFunction&&(this.options.useImageClick||0==f)){var y=n.firstChild,b=function(t,e,i){return function(o){d.f.stopPropagation(o),t._setFocusedCell(e,i),t.fireImageClick(e,i)}}(this.mainGrid,i,this.colID);d.f.addListener(y,"onclick",b)}if(this.mainGrid.options.titleFormatter)try{var v;o=this.mainGrid.getColumnIndex(t.getAttribute(p));if("function"!=typeof this.mainGrid.options.titleFormatter){var w=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof w&&(this.mainGrid.options.titleFormatter=w,v=w.call(this,i,o,e))}else v=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",v)}catch(t){s.Y.printStackTrace(t,null,this)}},E.image.prototype.getDisplayData=function(t){return t},E.radio=function(){},E.radio.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.groupRef&&(this.options.groupValue=WebSquare.ModelUtil.getInstanceValue(this.options.groupRef,null,this.scope_id)),this.options.radioLabelColumn)for(var e=this.options.radioLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}},E.radio.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},E.radio.prototype.setInnerHTML=function(t,e,i){try{var o=this.mainGrid._getWrapperCell(t,i),r=this.getColumnIndex(this.colID);if(this.mainGrid.getMerged(i,r)&&!this.mainGrid.cellMergeInfo[i+"_"+r])return;var n=a.Z.getDataPrefix("col_id"),l=a.Z.getDataPrefix("rowindex"),h=this.mainGridId+"_radio_"+(this.options.groupName?this.options.groupName+"_"+i:this.colID);this.options.cellGroupName&&(h=this.mainGridId+"_radio_"+this.options.cellGroupName);var u,c=e+""==this.options.trueValue;if(u=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute(n)):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute(n)),this.options.embeddedInput){var g=this.mainGrid.getInput(this,t,c);g.setAttribute(l,i),g.checked=!1,g.name=h,g.checked=c,g.disabled=u}else{var f;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var m=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof m&&(this.mainGrid.options.titleFormatter=m,r=this.mainGrid.getColumnIndex(this.options.id),f=m.call(this,i,r,e))}else f=this.mainGrid.options.titleFormatter.call(this,i,r,e)}catch(t){s.Y.printStackTrace(t,null,this)}var y=f||this.options.title||"";if(y)y=" title='"+y+"'";else if(this.mainGrid.options.titleAuto){var b=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";y=c?" title='"+b+WebSquare.language.getMessage("Grid_title")+"'":" title='"+b+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}
var v="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",w=c?" checked":"",C=u?" disabled='true'":"",I="";if(this.options.radioLabel||this.options.radioLabelColumn||this.options.radioLabelFormatter){var _=this.mainGridId+"_radio_"+this.id+"_"+i,x=this.options.radioLabel||"";if(this.options.radioLabelColumn){for(var S=this.options.radioLabelColumn.split(","),R="",D=this.options.radioLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",T=0;T<S.length;T++){var L=this.mainGrid.bodyToHeaderRelation[S[T]];if(T===S.length-1)this.mainGrid.options.showRadioLabelUserFormat?R+=" "+this.mainGrid.getHeaderValue(L)+" "+this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0}):R+=this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0});else if(this.mainGrid.options.showRadioLabelUserFormat){var k=WebSquare.language.getMessage("Grid_row")||"row";R+=(0===T?i+1+k+D:"")+" "+this.mainGrid.getHeaderValue(L)+" "+this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0})+D}else R+=this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0})+D}x=x?R+D+x:R}if(this.options.radioLabelFormatter)try{var F=a.Z.getGlobalFunction(this.options.radioLabelFormatter,this.scope_id);"function"==typeof F&&(x=F.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),x))}catch(t){p.v.printLog(this.mainGrid.id+"_"+this.id+" radioLabelFormatter error : "+t.message)}x&&this.mainGrid.options.titleAuto&&!this.options.title&&(y=y.substring(0,y.length-1)+" "+x+"'"),I="<INPUT type='radio' "+y+v+w+C+" id='"+_+"' name='"+h+"'/>";var A="<label class='w2radio_label ' for='"+_+"'>"+x+"</label>";"left"===this.options.radioLabelPosition?I=A+I:I+=A}else I="<INPUT type='radio' name='"+h+"'"+y+v+w+C+" />";o.innerHTML=I;var E=o.getElementsByTagName("input")[0];if(this.options.noDisabledOnReadOnly&&E&&(d.f.addListener(E,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&d.f.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(E,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(E,this.mainGrid.options.readOnlyClass+"_nodisabled")),this.mainGrid.options.preventDuplicateFocusedCell&&this.mainGrid.options.preventMultipleClick){var M=o.getElementsByTagName("label")[0];this.labelClicked=!1,E&&d.f.addListener(E,"onclick",(O=this,N=[i,t],H=function(t,e,i){i=this.labelClicked?0:1,this.labelClicked=!1;var o,s,a,n,l,h,p,u=null!=this.mainGrid.editedCell;if(u&&(o=this.mainGrid.editedCell.editRowIndex,s=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),p=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.mainGrid._grid.getRealRowIndex(o),l=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+s],h=p.comp&&p.comp.selectedIndex),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):this.mainGrid._addFocus(e)),this.handleClick(e,t),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,r)&&d.f.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:c}),u){var g=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+s];if(l!=g){var f={oldValue:l,newValue:g,rowIndex:o,colIndex:a,colId:this.mainGrid.getColumnID(a)};isNaN(h)||(f.oldSelectedIndex=h,f.newSelectedIndex=p&&p.comp&&p.comp.selectedIndex),
d.f.fireEvent(this.mainGrid,"onviewchange",f)}}},function(t){O.options.eventPropagation||d.f.stopPropagation(t),N[2]=t.detail,H.apply(O,N,t)})),M&&d.f.addListener(M,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}}catch(t){s.Y.printStackTrace(t,null,this)}var O,N,H},E.radio.prototype.getDisplayData=function(t){return t},E.radio.prototype.handleClick=function(t,e){try{var i=t.getElementsByTagName("input")[0];if(!i)return!0;if(this.options.noDisabledOnReadOnly&&this.mainGrid._getEditReadOnly(e,this.colID))return!0;this.mainGrid.options.preventDuplicateFocusedCell&&null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var o=this.mainGrid.dataList._getCellData(e,this.colID),r=o;if(o==this.options.trueValue)return!0;i.checked&&(r=this.options.trueValue,this.resetOthers(e),this.options.groupName&&this.mainGrid.radioGroupRepChk[this.options.groupName]&&this.mainGrid.dataList.__setCellData(e,this.options.groupName,this.options.groupValue)),this.mainGrid.dataList.__setCellData(e,this.colID,r);var n=a.Z.getDataPrefix("colMerged");"0"!=t.getAttribute(n)||this.mainGrid.groupbyStatus.grouped||this.setMergedCol(e,this.colID,o,r);var l=e,h=this.getColumnIndex(this.colID),p=l+"_"+h;if(null!=this.mainGrid.cellMergeInfo[p])for(var u=this.mainGrid.cellMergeInfo[p].rowSpan,c=this.mainGrid.cellMergeInfo[p].colSpan,g=0;g<u;g++)for(var f=0;f<c;f++)0===g&&0===f||this.mainGrid.dataList.__setCellData(l+g,h+f,r);if(o!=r){var m=this.mainGrid.getColumnIndex(this.options.id),y={oldValue:o,newValue:r,colIndex:m,rowIndex:e,colId:this.mainGrid.getColumnID(m)};d.f.fireEvent(this.mainGrid,"onviewchange",y)}return!0}catch(t){s.Y.printStackTrace(t,null,this)}},E.radio.prototype.resetOthers=function(t){if(this.options.groupName)for(var e=this.mainGrid.getColumnCount(),i=0;i<e;i++){"custom"==(s=this.mainGrid.getCellInfo(i)).options.inputType&&(s=s.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(t)]),s!=this&&"radio"==s.options.inputType&&s.options.groupName==this.options.groupName&&this.mainGrid.dataList.__setCellData(t,i,s.options.falseValue)}else if(this.options.cellGroupName)for(var o=0;o<this.mainGrid.getDataLength();o++){var s;"custom"==(s=this.mainGrid.getCellInfo(this.getColumnIndex(this.colID))).options.inputType&&(s=s.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(o)]);"radio"==s.options.inputType&&s.options.cellGroupName==this.options.cellGroupName&&this.mainGrid.dataList._getCellData(o,this.colID)+""==s.options.trueValue&&this.mainGrid.dataList.__setCellData(o,this.colID,s.options.falseValue)}else if(this.mainGrid.isDrillDown&&this.mainGrid._dataList.options.depthColumn)for(o=0;o<this.mainGrid.getTotalRow();o++)this.mainGrid._dataList.getCellData(o,this.colID)+""==this.options.trueValue&&this.mainGrid._dataList.setCellData(o,this.colID,this.options.falseValue);else for(o=0;o<this.mainGrid.getDataLength();o++)this.mainGrid.dataList._getCellData(o,this.colID)+""==this.options.trueValue&&this.mainGrid.dataList.__setCellData(o,this.colID,this.options.falseValue)},E.radio.prototype.doDefaultAction=function(t){var e=d.f.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(;e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=a.Z.getDataPrefix("col_id"),s=this.mainGrid.getColumnIndex(e.getAttribute(o))}else{var r=this.mainGrid.getLastFocusedCell();i=r.focusedRowIndex,s=r.focusedColIndex;this.options.embeddedInput&&"INPUT"==e.tagName.toUpperCase()&&(e=r.focusedTd)}if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var n=this.mainGrid.dataList._getCellData(i,this.colID);("INPUT"==e.tagName.toUpperCase()?e:e.getElementsByTagName("input")[0]).checked=n==this.options.trueValue?this.options.falseValue:this.options.trueValue,this.handleClick(e,i)}},E.radio.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return
;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.select=function(){},E.select.prototype._initializeCellInfo=function(){try{this.col_index=this.mainGrid.getColumnIndex(this.colID),"auto"===this.options.renderType&&a.Z.isMobile()&&!0!==this.options.embeddedInput&&(this.options.embeddedInput=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},E.select.prototype._createComponent=function(t){try{if(this.comp)return;var e=this;if(this.xml.setAttribute("class",this.mainGridId+"_select_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("chooseOptionValue",this.options.chooseOptionValue),this.xml.setAttribute("allOption",this.options.allOption+""),this.xml.setAttribute("tableRender",this.options.tableRender),this.xml.setAttribute("submenuSize",this.options.submenuSize?this.options.submenuSize:"auto"),this.xml.setAttribute("direction","auto"),this.xml.setAttribute("style",this.style),this.setFirst=!0,this.hasRef&&!this.useLinkedDataList)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.setFirst=!1,this.configOptions.chooseOption=this.options.chooseOption,this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel,this.configOptions.labelWidthAuto=!1,this.configOptions.displayMode=this.options.displayMode,this.configOptions.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay,this.configOptions.itemTooltipFormatter=this.options.itemTooltipFormatter,this.options.itemTooltipFormatter&&(this.configOptions._rowIndex=t,this.configOptions._colIndex=this.mainGrid.getColumnIndex(this.colID)),this.configOptions.tooltipTime=this.options.tooltipTime,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.configOptions.tableRender=this.options.tableRender,this.internal&&(this.options.visibleRowNum&&(this.configOptions.visibleRowNum=this.options.visibleRowNum),this.options.textAlign&&(this.configOptions.textAlign=this.options.textAlign),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions));var i=this.internal?this.mainGridId+"_selectbox_"+t+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;this.internal&&this.options.emptyItem&&(this.configOptions.emptyItem=this.options.emptyItem),this.select=new WebSquare.uiplugin.selectbox(i,this.configOptions,this.xml),this.mainGrid.dom[this.select.id]=this.select,this.comp=this.select,this.select.setSelectedIndex1=function(t,i){void 0!==i&&null!=i||(i={});var o=this.selectedIndex,s=this.getValue(),r=e.mainGrid.getColumnIndex(e.mainGrid.editedCell.id);if(this.setSelectedIndex(t),e.mainGrid._setSelectedIndex(e.editRowIndex,r,t),"oneditend"===e.options.eventPriority){if(!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit()),o!=this.selectedIndex){var a=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:r,colId:e.mainGrid.getColumnID(r)};d.f.fireEvent(e.mainGrid,"onviewchange",n)}}else{if(o!=this.selectedIndex){a=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:r,colId:e.mainGrid.getColumnID(r)};d.f.fireEvent(e.mainGrid,"onviewchange",n)}!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit())}},this.existGridViewItemsetNode&&(this.select._setSubLayer=this.select.setSubLayer,
this.select.setSubLayer=function(t){this._setSubLayer(t),this.itemTable.addKeyDownEventListener((function(t){if(27===t.keyCode)e.handleCancelEdit(t)}))}),this.select.__openSubLayer=this.select.openSubLayer,this.select.openSubLayer=function(){this.__openSubLayer()},this.select.__closeSubLayer=this.select.closeSubLayer,this.select.closeSubLayer=function(t){this.__closeSubLayer(t),e.mainGrid._setFocusedCell()},this.select._handleClickEvent=this.select.handleClickEvent,this.select.handleClickEvent=function(t){this._handleClickEvent(t),d.f.stopEvent(t),e.handleEndEdit()},this.select._refreshItemset=this.select.refreshItemset,this.select.refreshItemset=function(t){e.resetMatchInfo=!0,!0!==this.refreshStopItemTable&&this._refreshItemset(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.select.prototype.createSelectbox=function(t,e){var i=this.mainGrid._getWrapperCell(t,e);this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this._createComponent(e),i.innerHTML=this.select.toHTML();try{!this.select.modelControl.isBinded()&&-1===this.select.selectedIndex&&this.select.getItemCount()>0&&!this.select.options.chooseOption&&this.select.options.allOption}catch(t){s.Y.printStackTrace(t,null,this)}if(this.select.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),""!=this.options.selectSetter)for(var o=0;o<this.itemArr.length;o++)this.select.addItem(this.itemArr[o].value,this.itemArr[o].label);this._setSize(t),this.select.render.style.border="1px solid "+this.mainGrid.options.selectedCellColor},E.select.prototype._setSize=function(t){try{var e={top:0,left:0,bottom:0,right:0};if(a.Z.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(e.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),e.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),e.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),e.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else{var i=WebSquare.style.getComputedStyle(t);i&&(i.padding||i.paddingTop||i.paddingBottom||i.paddingLeft||i.paddingRight)&&(e.left=parseInt(i.paddingLeft,10),e.right=parseInt(i.paddingRight,10),e.top=parseInt(i.paddingTop,10),e.bottom=parseInt(i.paddingBottom,10))}this.select.setSize(t.clientWidth-(2+e.left+e.right),t.clientHeight-(2+e.top+e.bottom))}catch(t){s.Y.printStackTrace(t,null,this)}},E.select.prototype.createItemTable=function(t,e){var i=this;this.existGridViewItemsetNode&&this.select._openOtherLayer(),this.select.setSubLayer();var o=this.select.itemTable;o.addClickEventListener((function(t,e){i.select.setSelectedIndex1(e);var o=i.mainGrid.getLastFocusedCell();if(i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell(),i.options.moveEditModeByChoice){var s=!0,r=i.options.moveEditModeByChoice;switch(r){case"down":i.mainGrid.moveVertical({},r,s);break;case"right":i.mainGrid.moveHorizontal({byApi:!0},r,s)}}})),this.existGridViewItemsetNode?o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t);var e=i.mainGrid.getLastFocusedCell();i.editRowIndex==e.focusedRowIndex&&i.col_index==e.focusedColIndex&&("down"==i.mainGrid.options.tabKeyMove?i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode):"none"==i.mainGrid.options.tabKeyMove||i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode));break;case 27:i.handleCancelEdit(t)}})):o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:if("ul"==this.options.tableRender){var e=this.getSelectedIndex();e=parseInt(e),this.endReached&&(this.endReached=!1,i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid._setFocusedCell())}else{this.fireClick(t);var o=i.mainGrid.getLastFocusedCell()
;i.editRowIndex==o.focusedRowIndex&&i.col_index==o.focusedColIndex&&("down"==i.mainGrid.options.tabKeyMove?i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode):"none"==i.mainGrid.options.tabKeyMove||i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode))}break;case 13:o=i.mainGrid.getLastFocusedCell();i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||(i.mainGrid.options.fastEditMode?"none"==i.mainGrid.options.enterKeyMove||("right"==i.mainGrid.options.enterKeyMove?i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode):i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode)):i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell());break;case 27:i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell()}})),a.Z.isOpera()&&o.event.addListener(o.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||d.f.preventDefault(t)})),this.mainGrid._moveKeyEdit(o.uuid,"keyDownFunc",{itemTable:!0}),WebSquare.WebSquaredoc.itemsetElement.length>0&&WebSquare.WebSquaredoc.itemsetElement[WebSquare.WebSquaredoc.itemsetElement.length-1].id==this.mainGridId+"_selectbox_"+this.colID&&WebSquare.WebSquaredoc.itemsetElement.pop()},E.select.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("rowindex"),p=this.mainGrid._getGroupbyDisplayRowIndex(i);if(this.options.embeddedInput&&!this.mainGrid.groupbyStatus.grouped){var u=this.mainGrid.getInput(this,t,e);if(u.render.setAttribute(h,i),""==this.options.selectSetter||this.dataComp||(this.initSelectSetter(),u.itemArr=this.itemArr,u.setSelectOptions()),this.hasRef&&!this.dataComp){var c=this.mainGrid.getElemRowIndex(t);u.itemArr=this.getRefItemArr(c),u.setSelectOptions()}if(this.dataComp){var g=this.mainGrid.modelControl.getDataComp(this.dataComp);if("linkedDataList"===g.initializeType&&null!=g.conditionInfo&&g.conditionInfo.filterInfo.useRef){var f=g.conditionInfo.targetInfo,m={};for(var y in f){var b=this.mainGrid.modelControl.getDataComp(y);if(b&&null!=b.initializeType&&"dataMap"!==b.initializeType){var v=b.getRowPosition();v!=i&&(m[y]=v,"linkedDataList"===b.initializeType?b._dataList.rowPosition=b.filteredRowIndexArr[i]:b.rowPosition=i)}}for(var w in u.stopRefreshItemTable(!0),g.syncWithParent(),u.stopRefreshItemTable(!1),m){var C=this.mainGrid.modelControl.getDataComp(w);"linkedDataList"===C.initializeType?C._dataList.rowPosition=C.filteredRowIndexArr[m[w]]:C.rowPosition=m[w]}for(var I=g.getAllJSON(),_=[],x=0;x<I.length;x++)_.push({label:I[x][this.itemsetObj.label],value:I[x][this.itemsetObj.value]});if(u.setNodeSet("",this.itemsetObj.label,this.itemsetObj.value),u.itemArr=_,1==u.options.allOption&&(u.itemArr=[{label:u.defaultAllOptionLabel,value:WebSquare.allValue}].concat(u.itemArr)),1==u.options.chooseOption){var S=u._getChooseOptionLabel();S=WebSquare.xml.decode(S).replace("&nbsp;"," "),u.itemArr=[{label:S,value:u.options.chooseOptionValue}].concat(u.itemArr)}u.setSelectOptions()}}u.setValue(e);var R=u.getValue();if(!u.setValueNM(e)&&!this.dataComp||""===e&&R!==e){var D={};D[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(u.render.getAttribute(h),o,R,null,null,null,D)}var T=!1;this.mainGrid._getEditDisabled(i,o)?(u.setDisabled(!0),T=!0):u.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?(u.setReadOnly(!0),T=!0):u.setReadOnly(!1),u.dom.select.disabled=!!T,t.removeAttribute("tabIndex")}else{this.initSelectSetter();c=i;null==e&&(e="");var L=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;L=a.Z.getBoolean(L);var k,F=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof F){this.useCustomFormatter=!0;S=this.getDisplayData(e,c);L&&(S=WebSquare.xml._encode(S+"")),k=F.call(this.mainGrid,e,S,p,o)}else this.useCustomFormatter=!1,
k=this.getData(e,c),L&&(k=WebSquare.xml._encode(k+""));var A,E=this.internal?this.mainGridId+"_selectbox_"+i+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var M=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof M&&(this.mainGrid.options.titleFormatter=M,A=M.call(this,i,o,e))}else A=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.Y.printStackTrace(t,null,this)}var O=A||this.options.title||"";if(O)t.setAttribute("title",O);else if(this.mainGrid.options.titleAuto){var N=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";O=""!==e?" title='"+N+" "+e+"'":" title='"+N+WebSquare.language.getMessage("Grid_select")+"'"}if(a.Z.isSafari()&&-1!=navigator.userAgent.indexOf("Windows"))if(this.mainGrid.options.plainText&&n.firstChild&&n.firstChild.firstChild)n.firstChild.firstChild.data=k;else{n.innerHTML="";var H=document.createElement(this.mainGrid.options.dataTag);"span"==this.mainGrid.options.dataTag&&(H.className="w2grid_span"),H.style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:100%;","ul"==this.options.tableRender?H.innerHTML="<a href='#"+E+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+O+">"+k+"</a>":H.textContent=k,n.appendChild(H)}else if(this.mainGrid.options.plainText&&n.firstChild&&n.firstChild.firstChild)n.firstChild.firstChild.data=k;else if("icon"==this.options.viewType){n.innerHTML="";H=document.createElement(this.mainGrid.options.dataTag);"span"==this.mainGrid.options.dataTag&&(H.className="w2grid_span"),H.style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:auto;","ul"==this.options.tableRender?H.innerHTML="<a href='#"+E+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+O+">"+k+"</a>":H.innerHTML=k,n.appendChild(H)}else{var G="";if("span"==this.mainGrid.options.dataTag&&(G=" w2grid_span"),"ul"==this.options.tableRender)n.innerHTML="<"+this.mainGrid.options.dataTag+"style='overflow : hidden; text-overflow:ellipsis; display:block; width:auto;'><a href='#"+E+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main"+G+"'"+O+">"+k+"</a>"+this.mainGrid.dataTagClose;else{var B=n.firstChild,W="w2grid_select"+G;if(this._checkFastScroll(k,B,W,r&&!0===r.scroll)){var V="string"==typeof k?WebSquare.xml.__decode(k):k;B.textContent=V}else n.innerHTML="<"+this.mainGrid.options.dataTag+" class='"+W+"'>"+k+this.mainGrid.dataTagClose}}var q=this.mainGrid.dataList.getRealRowIndex(i),Y=this.mainGrid.getCellOption(q,o,"viewType"),Z=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),j=a.Z.getDataPrefix("editModeEvent");if("icon"==Y||""==Y&&"own"==Z?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute(j,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent||"ondblclick"==this.options.editModeEvent||"onsecondclick"==this.options.editModeEvent?t.setAttribute(j,this.options.editModeEvent):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute(j,"")),"ul"==this.options.tableRender){var P=this;this.mainGrid.event.addListener(t,"onfocus",this.mainGrid.event.bindAsEventListener(this.mainGrid,(function(t){var e=d.f.getTarget(t);P.mainGrid.lastEvent=t;var o=P.mainGrid.getLastFocusedCell();if((0!=o.focusedColIndex||0!=o.focusedRowIndex)&&(!a.Z.isIEAllVersion()||!o.focusedRowIndex||o.focusedRowIndex==i)&&(o.focusedTd==e||P.mainGrid.focusedByApi||P.mainGrid._setFocusedCell(i,e.getAttribute(l)),P.mainGrid.focusedByApi=!1,e.childNodes[0]&&e.childNodes[0].childNodes[0])){var s=e.childNodes[0].childNodes[0];"A"==s.tagName&&s.focus()}})))}}},E.select.prototype.setColumnChooseOption=function(t,e){this.options.chooseOption=!0,this.options.chooseOptionValue=t,
this.options.chooseOptionLabel=e,this.select&&this.select.changeChooseOption(t,e)},E.select.prototype.showChooseOption=function(t){if(this.options.chooseOption=t,this.matchInfo=this.setMatchInfo(),this.select&&t)this.select.showChooseOption(t);else if(this.select&&!t){this.select.showChooseOption(t),this.select.itemArr.length>1&&0!=this.select.selectedIndex?this.select.selectedIndex-=1:this.select.selectedIndex=0,this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).innerHTML=this.mainGrid.dataTagOpen+this.getData(this.select.getValue(),this.select.selectedIndex)+this.mainGrid.dataTagClose}},E.select.prototype.getData=function(t,e,i){try{var o,a="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice(5))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var p in h){var u=this.mainGrid.modelControl.getDataComp(p);if(u&&null!=u.initializeType&&"dataMap"!==u.initializeType){var c=u.getRowPosition();c!=e&&(d[p]=c,"linkedDataList"===u.initializeType?u._dataList.rowPosition=u.filteredRowIndexArr[e]:u.rowPosition=e)}}for(var g in this.select&&this.select.stopRefreshItemTable(!0),o.syncWithParent(),this.select&&this.select.stopRefreshItemTable(!1),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var v=m.getTotalRow();y=[];for(var w=0;w<v;w++)y.push(w)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}var C=!1;if("linkedDataList"===o.initializeType&&this.select){var I=this.select.getItemCount(),_=this.select.itemArr;0===I?C=!0:1!=I||_[0].label!==this.select._getChooseOptionLabel()&&_[0].label!==this.select.defaultAllOptionLabel?2==I&&_[0].label===this.select._getChooseOptionLabel()&&_[1].label===this.select.defaultAllOptionLabel&&(C=!0):C=!0}if((!this.select||C)&&null!=m)try{var x,S;a="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)x=this.itemsetObj.label,S=this.itemsetObj.value;else{var R=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),D=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);R.length>0&&D.length>0&&(x=WebSquare.Elem.api.getAttribute(R[0],"ref"),S=WebSquare.Elem.api.getAttribute(D[0],"ref"))}var T=null!=x?m.bodyIdColIndexMap[x]:m.bodyIdColIndexMap[this.itemsetObj.label],L=null!=S?m.bodyIdColIndexMap[S]:m.bodyIdColIndexMap[this.itemsetObj.value];for(w=0;w<y.length;w++){var k=y[w]*m.cellIdList.length;if(t==m.dataArr[k+L])return a=m.dataArr[k+T],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t),i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}var F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],A=this.selectedIndex||this.mainGrid._getSelectedIndex(e,F);if(A>=0&&A<b.length&&!this.options.chooseOption){a=m.dataArr[b[A]*m.cellIdList.length+T],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t);k=0
;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var E=this.mainGrid._dataList.cellIdList.length,M=(F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],m.dataArr[y[A]*m.cellIdList.length+L]);this.mainGrid._dataList.dataArr[k*E+F]=M}else if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)a=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)a="";else{k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];E=this.mainGrid._dataList.cellIdList.length,F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[k*E+F]="",a=""}else a=this.options.selectedDataDisplay?t:"";return i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}catch(e){return s.Y.printStackTrace(e,null,this),a=this.getLocaleValue(t)}var O=!1;for(w=0;w<this.select.itemArr.length;w++)if((t||-1!=N)&&this.select.itemArr[w].value==t){O=!0,a=this.select.itemArr[w].label;break}var N=this.mainGrid._getSelectedIndex(e,this.mainGrid._dataList.bodyIdColIndexMap[this.colID]);if(!O&&o.options&&o.options.validateAllItemsetData)for(w=0;w<this.select.allItemArr.length;w++)if(this.select.allItemArr[w].value==t){O=!0,a=this.select.allItemArr[w].label;break}if(!O)if(""!=t||-1==N||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?a=this.options.chooseOptionLabel:this.options.selectedData||(a=this.options.selectedDataDisplay?t:"");else this.select.itemArr.length>0?(a=this.select.itemArr[N].label,this.mainGrid.dataList.__setCellData(e,this.colID,a)):a=t}else{var H=this.getMatchInfo(e);N=this.mainGrid._getSelectedIndex(e,this.mainGrid.bodyIdColIndexMap[this.colID]);""!=t||-1==N||this.options.chooseOption?a=H["SELECT_"+t]:(this.mainGrid.dataList.__setCellData(e,t),a=H["SELECT_"+this.itemArr[N].label])}if(i&&i.emptyValue&&(""===a||"$blank"==a))a=i.emptyValue;else if(void 0===a||"$blank"==a)return"";return a=this.getLocaleValue(a)}catch(t){s.Y.printStackTrace(t,null,this)}},E.select.prototype.initSelectSetter=function(){if(0==this.selectSetted&&""!=this.options.selectSetter&&!this.dataComp){this.selectSetted=!0;var t=[];try{this.options.selectSetter=this.options.selectSetter.wq_trim(),this.options.selectSetter.indexOf("(")<0&&(this.options.selectSetter+="()"),t=new Function("return "+this.options.selectSetter)()}catch(t){s.Y.printStackTrace(t)}this.itemArr=t,this.matchInfo=[];for(var e=0;e<t.length;e++){var i=t[e];null==i.value&&(i.value=""),this.matchInfo["SELECT_"+i.value]=i.label}}},E.select.prototype.setEditMode=function(t,e){if(!this.options.embeddedInput){var i=this.mainGrid._getWrapperCell(t,e);if(this.dataComp){var o=this.mainGrid.modelControl.getDataComp(this.dataComp);o&&"linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef&&o.syncWithParent()}if(!0!==this._init?(this.createSelectbox(t,e),this._init=!0):(i.innerHTML="",this.mainGrid.cellMergeInfo&&this._setSize(t),i.appendChild(this.select.render),this.options.itemTooltipFormatter&&(this.select.options._rowIndex=e)),this.mainGrid.directItemChoiceKeyObj.select){this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID));var s=this.select.findItemStartedWithKeyChar(this.mainGrid.directItemChoiceKeyObj.select);if(this.mainGrid.dataList.__setCellData(e,this.colID,this.select.getValue()),this.mainGrid.directItemChoiceKeyObj.select=null,this.options.moveFocusByChoice&&s&&this.moveFocus(this.editRowIndex,this.colID),s)return
;this.mainGrid.editedCell=this.mainGrid.getCellInfo(t),i.innerHTML="",i.appendChild(this.select.render)}if(this.select.itemTable||this.mainGrid.directItemChoiceKeyObj.select||(this.existGridViewItemsetNode&&(this.editTd=t),this.createItemTable(t,e)),this.hasRef&&!this.dataComp){var r=this.mainGrid.getElemRowIndex(t);this.select.itemArr=this.getRefItemArr(r),this.select.itemTable.show(),this.select.setSelectOptions()}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),0==this.select.getItemCount()&&(this.select.selectedIndex=-1,this.select.dom.label.innerHTML=""),this.existGridViewItemsetNode&&this.select.gridViewOptions.width)this.select.openSubLayer();else{var n=t.clientWidth-2,l={top:0,left:0,bottom:0,right:0};if(a.Z.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(l.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),l.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),l.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),l.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(u=WebSquare.style.getComputedStyle(t))&&(u.padding||u.paddingTop||u.paddingBottom||u.paddingLeft||u.paddingRight)&&(l.left=parseInt(u.paddingLeft,10),l.right=parseInt(u.paddingRight,10),l.top=parseInt(u.paddingTop,10),l.bottom=parseInt(u.paddingBottom,10));this.select.setSize(t.clientWidth-(2+l.left+l.right),t.clientHeight-(2+l.top+l.bottom)),this.select.itemTable.setStyle("width",t.clientWidth-4+"px"),this.select.openSubLayer();var h=this.mainGrid.render.offsetWidth,d=this.select.itemTable.render.offsetWidth,p=this.select.itemTable.render.firstChild.offsetWidth;if(d-2>n&&(n=d-2),this.select.itemTable.render.clientHeight>=this.select.itemTable.render.scrollHeight||this.select.getItemCount()<=this.select.options.visibleRowNum)this.select.itemTable.render.firstChild.style.width=n+"px",h>d&&p<d&&this.select.itemTable.render.firstChild.firstChild&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=n&&this.select.itemTable.setStyle("width",n+"px");else{this.select.itemTable.render.firstChild.style.width=n-17+"px";var u;l={top:0,left:0,bottom:0,right:0};if(a.Z.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(l.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),l.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),l.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),l.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(u=WebSquare.style.getComputedStyle(t))&&(u.padding||u.paddingTop||u.paddingBottom||u.paddingLeft||u.paddingRight)&&(l.left=parseInt(u.paddingLeft,10),l.right=parseInt(u.paddingRight,10),l.top=parseInt(u.paddingTop,10),l.bottom=parseInt(u.paddingBottom,10));this.select.setSize(t.clientWidth-(2+l.left+l.right),t.clientHeight-(2+l.top+l.bottom)),h>d&&p+17<=d-2&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=n&&this.select.itemTable.setStyle("width",n+"px")}}t.style.textOverflow="ellipsis"}},E.select.prototype._handleEndEdit_common=function(t){try{this.select.closeSubLayer();var e=this.select.getValue();try{if(this.mainGrid._getWrapperTD(this.select.render.parentNode))this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.select.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.select.prototype._handleEndEdit_focus=function(){this.options.moveFocusByChoice&&this.moveFocus(this.editRowIndex,this.colID)},E.select.prototype._getEditedValue=function(t){return this.select.getValue()},E.select.prototype._handleCancelEdit=function(t){
this.select.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.select.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID))},E.select.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.select.prototype.moveFocus=function(t,e){if(this.options.moveFocusByChoice)switch(this.options.moveFocusByChoice){case"down":this.mainGrid._setFocusedCell(t+1,e,!1);break;case"right":var i=this.mainGrid.getColumnIndex(e)+1;this.mainGrid._setFocusedCell(t,i,!1)}},E.select.prototype.refreshCell=function(){try{if(!this.options.selectedData)return;if(!this.dataComp)return;var t=this.mainGrid.modelControl.getDataComp(this.dataComp);if(!t)return;var e,i=null,o=null;if("linkedDataList"===t.initializeType?(i=t._dataList,o=t.initialRowIndexArr):"dataList"===t.initializeType&&(o=(i=t).filteredRowIndexArr),null==i)return;if(this.internal)this.itemsetObj.label,e=this.itemsetObj.value;else{var a=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),n=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);a.length>0&&n.length>0&&(WebSquare.Elem.api.getAttribute(a[0],"ref"),e=WebSquare.Elem.api.getAttribute(n[0],"ref"))}var l,h=null!=e?i.bodyIdColIndexMap[e]:i.bodyIdColIndexMap[this.itemsetObj.value];l=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var d=this.mainGrid._dataList.cellIdList.length,p=this.mainGrid._dataList.bodyIdColIndexMap[this.id],u=0;u<l.length;u++){var c=l[u];if("object"!=typeof c){var g=this.mainGrid._dataList.dataArr[c*d+p];if(!(this.options.allOption&&g==WebSquare.allValue||this.options.chooseOption&&g==this.options.chooseOptionValue||!(""!==g||this.selectedIndex>=0))){var f=!1;if("linkedDataList"===t.initializeType&&null!=t.conditionInfo&&t.conditionInfo.filterInfo.useRef){var m=t.conditionInfo.targetInfo,y={};for(var b in m){var v=this.mainGrid.modelControl.getDataComp(b);if(null!=v.initializeType&&"dataMap"!=v.initializeType){var w=v.getRowPosition();w!=u&&(y[b]=w,"linkedDataList"===v.initializeType?v._dataList.rowPosition=v.filteredRowIndexArr[u]:v.rowPosition=u)}}var C=t.getBroadcast();for(var I in t.setBroadcast(!1),t.syncWithParent(),t.setBroadcast(C),y){var _=this.mainGrid.modelControl.getDataComp(I);"linkedDataList"===_.initializeType?_._dataList.rowPosition=_.filteredRowIndexArr[y[I]]:_.rowPosition=y[I]}o=t.initialRowIndexArr}for(var x=0;x<o.length;x++)if(g==i.dataArr[o[x]*i.cellIdList.length+h]){f=!0;break}if(!f){var S="";this.selectedIndex>=0&&this.selectedIndex<o.length&&!this.options.chooseOption&&(S=i.dataArr[o[this.selectedIndex]*i.cellIdList.length+h]),this.mainGrid._dataList.dataArr[c*d+p]=S}}}}}catch(t){s.Y.printStackTrace(t,null,this)}},E.checkcombobox=function(){},E.checkcombobox.prototype._initializeCellInfo=function(){try{this.separator=this.options.separator||" "}catch(t){s.Y.printStackTrace(t,null,this)}},E.checkcombobox.prototype.setInnerHTML=function(t,e,i,o,r){try{var n=this.mainGrid._getWrapperCell(t,i);null==e&&(e="");var l=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;l=WebSquare.util.getBoolean(l);var h=this.getData(e,i);l&&(h=WebSquare.xml._encode(h+"")),n.innerHTML=this.mainGrid.dataTagOpen+h+this.mainGrid.dataTagClose;var d,p=this.mainGrid.dataList.getRealRowIndex(i),u=this.mainGrid.getCellOption(p,o,"viewType"),c=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),g=a.Z.getDataPrefix("editModeEvent");if("icon"==u||""==u&&"own"==c?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),
t.setAttribute(g,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute(g,"onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute(g,"")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var f=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.mainGrid.options.titleFormatter=f,d=f.call(this,i,o,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",d)}catch(t){s.Y.printStackTrace(t,null,this)}}catch(t){WebSquare.exception.printStackTrace(t,null,this)}},E.checkcombobox.prototype.getData=function(t,e,i){try{var o="";t=t.split(this.separator);var a,n,l=[],h=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var d=this.itemsetObj.nodeset;d.indexOf("data:")>=0&&(h=d.slice(5))}if(h&&(n=this.mainGrid.modelControl.getDataComp(h)),h&&n){if("linkedDataList"===n.initializeType&&null!=n.conditionInfo&&n.conditionInfo.filterInfo.useRef){var p=n.conditionInfo.targetInfo,u={};for(var c in p){var g=this.mainGrid.modelControl.getDataComp(c);if(null!=g.initializeType&&"dataMap"!=g.initializeType){var f=g.getRowPosition();f!=e&&(u[c]=f,"linkedDataList"===g.initializeType?g._dataList.rowPosition=g.filteredRowIndexArr[e]:g.rowPosition=e)}}for(var m in this.checkcombobox&&this.checkcombobox.stopRefreshItemTable(!0),n.syncWithParent(),this.checkcombobox&&this.checkcombobox.stopRefreshItemTable(!1),u){var y=this.mainGrid.modelControl.getDataComp(m);"linkedDataList"===y.initializeType?y._dataList.rowPosition=y.filteredRowIndexArr[u[m]]:y.rowPosition=u[m]}}var b=null,v=null;if("linkedDataList"===n.initializeType?(b=n._dataList,v=n.initialRowIndexArr):"dataList"===n.initializeType&&(v=(b=n).filteredRowIndexArr),!this.checkcombobox&&null!=b)try{var w,C;o="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)w=this.itemsetObj.label,C=this.itemsetObj.value;else{var I=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),_=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);0!=I.length&&0!=_.length&&(w=WebSquare.Elem.api.getAttribute(I[0],"ref"),C=WebSquare.Elem.api.getAttribute(_[0],"ref"))}for(var x=b.bodyIdColIndexMap[w],S=b.bodyIdColIndexMap[C],R=0;R<v.length;R++)for(var D=v[R]*b.cellIdList.length,T=0;T<t.length;T++)t[T]==b.dataArr[D+S]&&(o=b.dataArr[D+x],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?o=t[T]+this.options.delimiter+o:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?o=o+this.options.delimiter+t[T]:"value"!==this.options.displayMode&&3!=this.options.displayMode||(o=t[T]),i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),o=this.getLocaleValue(o),l.push(o));if(l.length>0)return l.join(this.separator);if(this.options.allOption&&t==WebSquare.allValue)o=WebSquare.language.getMessage("Grid_all")||"-all-";else if(this.options.chooseOption&&t==this.options.chooseOptionValue)o=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)o="";else{D=0;D=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var L=this.mainGrid._dataList.cellIdList.length,k=this.mainGrid._dataList.bodyIdColIndexMap[this.id];this.mainGrid._dataList.dataArr[D*L+k]="",o="",this.options.chooseOption&&!this.options.chooseOptionValue&&(o=this.options.chooseOptionLabel)}else o=t;return i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),o=this.getLocaleValue(o)}catch(e){return s.Y.printStackTrace(e,null,this),o=this.getLocaleValue(t)}var F=!1;a={};for(R=0;R<this.checkcombobox.itemArr.length;R++)for(T=0;T<t.length;T++)this.checkcombobox.itemArr[R].value==t[T]&&(l.push(this.checkcombobox.itemArr[R].label),
a[R+"_"]=!0,F=!0);F||(""==l&&1==this.options.chooseOption?(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,o=WebSquare.xml.decode(o).replace("&nbsp;"," ")):this.options.selectedData||(o=t),o=this.getLocaleValue(o),l.push(o),a=null),o=l.join(this.separator)}else{var A=this.getMatchInfo(e);for(F=!1,R=0;R<t.length;R++)void 0!==(o=A["CHECKCOMBOBOX_"+t[R]])&&(o=this.getLocaleValue(o),l.push(o),F=!0);if(F){if(this.options.checkcomboboxRangeSeparator&&this.checkcombobox){a={};for(R=0;R<this.checkcombobox.itemArr.length;R++)for(T=0;T<t.length;T++)this.checkcombobox.itemArr[R].value==t[T]&&(a[R+"_"]=!0)}}else""==l&&1==this.options.chooseOption?(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,o=WebSquare.xml.decode(o).replace("&nbsp;"," ")):this.options.selectedData||(o=t),o=this.getLocaleValue(o),l.push(o);o=l.join(this.separator)}if(i&&i.emptyValue&&(""===o||"$blank"==o))o=i.emptyValue;else if(void 0===o||"$blank"==o)return"";return this.options.checkcomboboxRangeSeparator&&this.checkcombobox&&a?this.checkcombobox._getRangeText(this.checkcombobox.itemArr,this.checkcombobox.itemArr.length,this.separator,a):o}catch(t){s.Y.printStackTrace(t,null,this)}},E.checkcombobox.prototype._createComponent=function(t){try{if(this.comp)return;this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_checkcombobox_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("allOption",this.options.allOption+""),"column"===this.options.submenuSize?this.xml.setAttribute("submenuSize","column"):this.xml.setAttribute("submenuSize","auto"),this.xml.setAttribute("style",this.style),this.xml.setAttribute("disabled",this.mainGrid.getDisabled("cell",this.mainGrid._getGroupbyDisplayRowIndex(t),this.colID)),this.xml.setAttribute("useDrag",this.options.checkcomboboxUseDrag),this.xml.setAttribute("useEdit",this.options.checkcomboboxUseEdit),this.xml.setAttribute("rangeSeparator",this.options.checkcomboboxRangeSeparator),this.xml.setAttribute("validateOnInput",this.options.checkcomboboxValidateOnInput),this.options.checkcomboboxVisibleRowNum>1&&this.xml.setAttribute("visibleRowNum",this.options.checkcomboboxVisibleRowNum),this.options.checkcomboboxVisibleColNum>1&&this.xml.setAttribute("visibleColNum",this.options.checkcomboboxVisibleColNum),this.options.checkcomboboxVisibleColMax>1&&this.xml.setAttribute("visibleColMax",this.options.checkcomboboxVisibleColMax),this.configOptions.separator=this.separator,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.internal&&(this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions)),this.configOptions.accessibility=this.mainGrid.options.accessibility,this.checkcombobox=new WebSquare.uiplugin.checkcombobox(this.mainGridId+"_checkcombobox_"+this.id,this.configOptions,this.xml),this.comp=this.checkcombobox;var e=this;this.checkcombobox.__closeSubLayer=this.checkcombobox.closeSubLayer,this.checkcombobox.closeSubLayer=function(){this.__closeSubLayer(),e.handleEndEdit()},this.checkcombobox.toggle=function(){if(this.isOpen){var i=this.getValue(),o=this.getInfoArray();this.__closeSubLayer();var s=this.getValue(),r=e.mainGrid.getColumnIndex(e.options.id);if(i!=s){var a={oldInfo:o,newInfo:this.getInfoArray(),oldValue:i,newValue:s,rowIndex:t,colIndex:r,colId:e.mainGrid.getColumnID(r)};d.f.fireEvent(e.mainGrid,"onviewchange",a)}e.handleEndEdit()}else this.openSubLayer()},this.checkcombobox._parent_uuid=this.mainGrid.uuid}catch(t){
s.Y.printStackTrace(t,null,this.mainGrid)}},E.checkcombobox.prototype.setEditMode=function(t,e){try{var i=this.mainGrid._getWrapperCell(t,e);if(this.dataComp){var o=this.mainGrid.modelControl.getDataComp(this.dataComp);o&&"linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef&&o.syncWithParent()}if(!0!==this._init){if(this._createComponent(e),i.innerHTML=this.checkcombobox.toHTML(),this.checkcombobox.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setSubLayer(),!this.existGridViewItemsetNode){var r=this.checkcombobox.itemTable,a=this;r.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:a.checkcombobox.closeSubLayer(),a.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",a.mainGrid.options.keyMoveEditMode);break;case 13:a.mainGrid.options.fastEditMode?"none"==a.mainGrid.options.enterKeyMove||("right"==a.mainGrid.options.enterKeyMove?a.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",a.mainGrid.options.keyMoveEditMode):a.mainGrid.moveVertical(t,t.shiftKey?"up":"down",a.mainGrid.options.keyMoveEditMode)):a.checkcombobox.closeSubLayer();break;case 27:a.mainGrid.editedCell.handleCancelEdit(t)}})),this.mainGrid._moveKeyEdit(r.uuid,"keyDownFunc",{itemTable:!0})}this._init=!0}else i.innerHTML="",this.mainGrid.cellMergeInfo&&this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),i.appendChild(this.checkcombobox.render);if(this.hasRef&&!this.dataComp){var n=this.mainGrid.getElemRowIndex(t);this.checkcombobox.itemArr=this.getRefItemArr(n),this.checkcombobox.setSelectOptions()}this.existGridViewItemsetNode?(this.checkcombobox.openSubLayer(),this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID))):(this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.checkcombobox.openSubLayer()),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t);var l=this.checkcombobox.itemTable.render.firstChild.clientWidth;l<t.clientWidth-2&&(l=t.clientWidth-2),l<this.checkcombobox.itemTable.render.offsetWidth-2&&(l=this.checkcombobox.itemTable.render.offsetWidth-2),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setItemTable(),t.style.textOverflow="ellipsis"}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.checkcombobox.prototype._handleEndEdit_common=function(t){try{this.checkcombobox.__closeSubLayer&&this.checkcombobox.__closeSubLayer();var e=this.checkcombobox.getValue();try{this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.checkcombobox.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.checkcombobox.prototype._handleEndEdit_focus=function(){this.mainGrid._setFocusedCell()},E.checkcombobox.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.checkcombobox.prototype._handleCancelEdit=function(t){this.checkcombobox.__closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},E.checkcombobox.prototype._getEditedValue=function(t){return this.checkcombobox.getValue()},E.checkcombobox.prototype.refreshItemArr=function(t){var e=WebSquare.WebSquareparser.parseChoices(this.xml,"");if(e.length>0?this.itemArr=e:this.itemArr=this.modelControl.getItemsetData(),1==this.options.allOption){var i=WebSquare.language.getMessage("Grid_all")||"-all-";this.itemArr=[{label:i,value:WebSquare.allValue}].concat(this.itemArr)}
},E.autoComplete=function(){},E.autoComplete.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i);null==e&&(e="");var h=this.mainGrid._getGroupbyDisplayRowIndex(i),p=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;p=a.Z.getBoolean(p);var u=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof u){this.useCustomFormatter=!0;var c=this.getDisplayData(e,i);p&&(c=WebSquare.xml._encode(c+"")),n=u.call(this.mainGrid,e,c,h,o)}else{this.useCustomFormatter=!1,n=this.getData(e,i),p&&(n=WebSquare.xml._encode(n+""));var g=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;n&&this.formatter&&g&&(n=this.formatter.format(n))}var f=this.mainGrid.dataList.getRealRowIndex(i),m=this.mainGrid.getCellOption(f,o,"viewType"),y=a.Z.getDataPrefix("col_id"),b=a.Z.getDataPrefix("rowIndex"),v=a.Z.getDataPrefix("colIndex");if(this.options.embeddedInput){var w=this.mainGrid.getInput(this,t,e),C=0,I=0,_=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",_=!0),this.mainGrid.embeddedAutoCompleteStyleObj||(this.mainGrid.embeddedAutoCompleteStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),C=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),C-=this.mainGrid.embeddedAutoCompleteStyleObj.top+this.mainGrid.embeddedAutoCompleteStyleObj.bottom,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),I=this.mainGrid.embeddedWidthObj[o].width,I-=this.mainGrid.embeddedAutoCompleteStyleObj.left+this.mainGrid.embeddedAutoCompleteStyleObj.right,_?t.parentNode.style.display="none":WebSquare.util.isIE("6 7")&&(C-=2),w._setSize(I-2,C),w.render.setAttribute(b,i),w.setValue(e),""!==n&&(w.dom.label.innerHTML=n),this.mainGrid._getEditDisabled(i,o)?w.setDisabled(!0):w.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?w.setReadOnly(!0):w.setReadOnly(!1),t.removeAttribute("tabIndex")}else if("icon"==m&&"true"==this.options.viewTypeIconImage){l.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+y+"='"+this.colID+"' "+b+"='"+i+"' "+v+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose,"</td>","<td "+y+"='"+this.colID+"' "+b+"='"+i+"'  "+v+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_div_img' />","</td>","</table>"].join("");var x=this,S=t,R=l.getElementsByTagName("div")[0];d.f.addListener(R,"onclick",(function(t){x.mainGrid._getEditDisabled(i,o)||x.mainGrid.___getEditReadOnly(i,o)||(x.autoCompleteImageClicked=!0,x.options.directOpen&&(x.mainGrid.__setFocusedCell(t,S),x.mainGrid.setEditMode(S)))}))}else{l.innerHTML=this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose;var D,T=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),L=a.Z.getDataPrefix("editModeEvent");if("icon"==m||""==m&&"own"==T?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute(L,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute(L,"onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute(L,"")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var k=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof k&&(this.mainGrid.options.titleFormatter=k,D=k.call(this,i,o,e))
}else D=this.mainGrid.options.titleFormatter.call(this,i,o,n);t.setAttribute("title",D)}catch(t){s.Y.printStackTrace(t,null,this)}}}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.autoComplete.prototype.getInput=function(t,e,i,o){try{var r=o.titleStr,a=o.input_id,n=o.dataRowIndex,l=o.dataCol_id,h=t.mainGrid,p=r||t.options.title||"";if(h.options.titleAuto&&!p){var u=h.getHeaderValue(h.bodyToHeaderRelation[t.id])||"";p=""!==i&&null!=i?u+" "+(h.changeItemValue("label",t.id,[i])[0]||i):u+WebSquare.language.getMessage("Grid_autoComplete")}var c=new WebSquare.uiplugin.autoComplete(a,{className:"w2grid_embedded_select",style:"$blank",pluginName:"autoComplete",renderType:"native",title:p,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.mainGrid.options.accessibility,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(n),10),i=h._getWrapperTD(this.render.parentNode).getAttribute(l),o=h.getColumnIndex(i);WebSquare.event.fireEvent(h,"oncellclick",e,o,i)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:case 13:return void d.f.stopPropagation(t)}}}}]},t.xml);this.mainGrid._getWrapperCell(e,e.getAttribute(n)).innerHTML=c.toHTML();var g=WebSquare.uiplugin.autoComplete.prototype.setSelectedIndex1;if(c.setSelectedIndex1=function(t,e,i){var o=h._getWrapperTD(this.render.parentNode).getAttribute(l),s=parseInt(this.render.getAttribute(n),10),r=h._getGroupbyDisplayRowIndex(s),a=h.getColumnIndex(o),p=this.selectedIndex,u=this.getValue();if(g.call(this,t,e,i),h.dataList.__setCellData(s,o,this.getValue()),h._dataList.setRowPosition(s),p!=this.selectedIndex){var c={oldValue:u,newValue:this.getValue(),oldSelectedIndex:p,newSelectedIndex:this.selectedIndex,rowIndex:s,colIndex:a,colId:h.getColumnID(a)};d.f.fireEvent(h,"onviewchange",c)}d.f.fireEvent(h,"onafteredit",r,a,this.getValue())},c.activate(),!0!==this.mainGrid.options.accessibility){var f=c.uuid;c.event.addListener2(c.dom.input,"onfocus",(function(t){h.lastEvent=t;var e=WebSquare.idCache[f];h.getLastFocusedCell().focusedTd==h._getWrapperTD(e.render.parentNode)||h.focusedByApi||h._setFocusedCell(e.render.getAttribute(n),h._getWrapperTD(e.render.parentNode).getAttribute(l)),h.focusedByApi=!1}))}return c}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.autoComplete.prototype._initializeCellInfo=function(t){try{"useData"==this.options.noResult&&(this.useDataInfo={})}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.autoComplete.prototype.getData=function(t,e,i){try{var o,a="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice(5))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var p in h){var u=this.mainGrid.modelControl.getDataComp(p);if(null!=u.initializeType&&"dataMap"!=u.initializeType){var c=u.getRowPosition();c!=e&&(d[p]=c,"linkedDataList"===u.initializeType?u._dataList.rowPosition=u.filteredRowIndexArr[e]:u.rowPosition=e)}}for(var g in o.syncWithParent(),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var v=m.getTotalRow();y=[];for(var w=0;w<v;w++)y.push(w)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}if(!this.autoComplete&&null!=m)try{var C,I;a="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)C=this.itemsetObj.label,
I=this.itemsetObj.value;else{var _=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),x=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);_.length>0&&x.length>0&&(C=WebSquare.Elem.api.getAttribute(_[0],"ref"),I=WebSquare.Elem.api.getAttribute(x[0],"ref"))}var S=null!=C?m.bodyIdColIndexMap[C]:m.bodyIdColIndexMap[this.itemsetObj.label],R=null!=I?m.bodyIdColIndexMap[I]:m.bodyIdColIndexMap[this.itemsetObj.value];for(w=0;w<y.length;w++){var D=y[w]*m.cellIdList.length;if(t==m.dataArr[D+R])return a=m.dataArr[D+S],"value delim label"===this.options.displayMode||1==this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||2==this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&3!=this.options.displayMode||(a=t),i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}if(this.selectedIndex>=0&&this.selectedIndex<b.length&&!this.options.chooseOption)a=m.dataArr[b[this.selectedIndex]*m.cellIdList.length+S],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t);else if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)a=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)a="";else{D=0;D=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var T=this.mainGrid._dataList.cellIdList.length,L=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[D*T+L]="",a=""}else a=t;return i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}catch(e){return s.Y.printStackTrace(e,null,this),a=this.getLocaleValue(t)}var k=!1;for(w=0;w<this.autoComplete.itemArr.length;w++)if(this.autoComplete.itemArr[w].value==t){k=!0,a=this.autoComplete.itemArr[w].label;break}if(!k&&o.options&&o.options.validateAllItemsetData)for(w=0;w<this.autoComplete.allItemArr.length;w++)if(this.autoComplete.allItemArr[w].value==t){k=!0,a=this.autoComplete.allItemArr[w].label;break}if(!k)if(""!=t||-1==this.selectedIndex||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?a=this.options.chooseOptionLabel:this.options.selectedData||(a=t);else a=this.autoComplete.itemArr[this.selectedIndex].label,this.mainGrid.dataList.__setCellData(e,this.colID,a)}else{var F=this.getMatchInfo(e);"useData"==this.options.noResult&&(this.useDataInfo["AUTOCOMPLETE_"+t]||(this.useDataInfo["AUTOCOMPLETE_"+t]=t),F["AUTOCOMPLETE_"+t]||(this.matchInfo["AUTOCOMPLETE_"+t]=t,this.itemArr=[{label:t,value:""}].concat(this.itemArr))),a=F["AUTOCOMPLETE_"+t]}if(i&&i.emptyValue&&(""===a||"$blank"==a))a=i.emptyValue;else if(void 0===a||"$blank"==a)return"";return a=this.getLocaleValue(a)}catch(t){s.Y.printStackTrace(t,null,this)}return t},E.autoComplete.prototype._createComponent=function(t){try{if(this.comp)return;if(this.options.disableEdit?this.style="position:relative;left:0px;top:0px;":this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_autoComplete_"+this.colID),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.interactionMode&&(this.configOptions.interactionMode=this.options.interactionMode),this.options.submission&&(this.configOptions.submission=this.options.submission),this.options.sortOption&&(this.configOptions.sortOption=this.options.sortOption),
this.options.displayMode&&(this.configOptions.displayMode=this.options.displayMode),this.options.search&&(this.configOptions.search=this.options.search),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.submenuSize&&(this.configOptions.submenuSize=this.options.submenuSize),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.allOption&&(this.configOptions.allOption=this.options.allOption),this.options.chooseOptionLabel&&(this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel),this.options.noResult&&(this.configOptions.noResult=this.options.noResult),this.options.disableEdit&&(this.configOptions.disableEdit=this.options.disableEdit),this.options.findItemFirstKey&&(this.configOptions.findItemFirstKey=this.options.findItemFirstKey),this.options.findItemKor&&(this.configOptions.findItemKor=this.options.findItemKor),this.options.maxlength&&(this.configOptions.maxlength=this.options.maxlength),a.Z.isIEAllVersion()&&this.xml.removeAttribute("readOnly"),this.internal&&(this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions),this.options.caseSensitive&&(this.configOptions.caseSensitive=this.options.caseSensitive)),this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.hasRef)this.targetRowIndex=t,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.autoComplete=new WebSquare.uiplugin.autoComplete(this.mainGridId+"_autoComplete_"+t+"_"+this.colID+"_"+this.id,this.configOptions,this.xml),this.autoComplete.options.disabled=!1,this.comp=this.autoComplete,this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setItemSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value);var e=this;this.autoComplete._handleClickEvent=this.autoComplete.handleClickEvent,this.autoComplete.handleClickEvent=function(t){this._handleClickEvent(t),d.f.stopEvent(t)},this.existGridViewItemsetNode?(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete._parentGridUUID=this.mainGrid.uuid,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),"down"==e.mainGrid.options.tabKeyMove?e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode):"none"==e.mainGrid.options.tabKeyMove||e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit()}))}):(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),
"down"==e.mainGrid.options.tabKeyMove?e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode):"none"==e.mainGrid.options.tabKeyMove||e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 13:e.mainGrid.options.fastEditMode&&("none"==e.mainGrid.options.enterKeyMove||("right"==e.mainGrid.options.enterKeyMove?e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode):e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode)));break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit(),e.options.directOpen&&e.mainGrid._setFocusedCell()})),i.addMouseUpEventListener((function(t){e.mainGrid._setFocusedCell()})),e.mainGrid._moveKeyEdit(i.uuid,"keyDownFunc",{itemTable:!0})}),this.autoComplete.showEditMode=function(t){try{t?(this.dom.label.style.display="none",this.dom.label.style.visibility="hidden",this.dom.input.style.display="block",this.dom.input.style.visibility="visible"):(this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible")}catch(t){s.Y.printStackTrace(t,null,this)}},this.autoComplete._inputKeyDown=this.autoComplete.inputKeyDown,this.autoComplete.inputKeyDown=function(t,i){27==t.keyCode||(e.autoComplete._inputKeyDown(t,i),13===t.keyCode&&e.options.directOpen&&(e.mainGrid._setFocusedCell(),d.f.stopPropagation(t)))},this.mainGrid._moveKeyEdit(this.autoComplete.uuid,"_inputKeyDown",{skipVertical:!0}),this.autoComplete.setSelectedIndex1=function(t){var i=this.selectedIndex,o=this.getValue();if(this.setSelectedIndex(t),i!=this.selectedIndex){var s=e.mainGrid.getColumnIndex(e.options.id),r=e.editRowIndex,a={oldValue:o,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex,rowIndex:r,colIndex:s,colId:e.mainGrid.getColumnID(s)};d.f.fireEvent(e.mainGrid,"onviewchange",a)}this.closeSubLayer(),e.editTd&&e.handleEndEdit(),e.existGridViewItemsetNode&&e.options.directOpen&&e.mainGrid._setFocusedCell()},this.autoComplete._refreshItemset=this.autoComplete.refreshItemset,this.autoComplete.refreshItemset=function(t){"gridViewItemset"!==this.options.itemTableType&&(e.matchInfo=e.setMatchInfo()),this._refreshItemset(t)},this.autoComplete.options.handleOtherClick=!1}catch(t){s.Y.printStackTrace(t,null,this)}},E.autoComplete.prototype.setEditMode=function(t,e){try{var i=this.mainGrid._getWrapperCell(t,e);if(!0!==this._init?(this._createComponent(e),i.innerHTML=this.autoComplete.toHTML(),this.autoComplete.activate(),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this._init=!0,this.options.placeholder&&this.autoComplete.dom.input.setAttribute("placeholder",this.options.placeholder)):(i.innerHTML="",this.mainGrid.cellMergeInfo&&this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),i.appendChild(this.autoComplete.render)),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this.hasRef){var o=this.mainGrid.getElemRowIndex(t);this.autoComplete.itemArr=this.getRefItemArr(o)}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.autoComplete.itemArr.length>0||this.autoComplete.allItemArr.length>0){var r=this.mainGrid.dataList._getCellData(e,this.colID);if(this.autoComplete.setValue(r),!0===this.autoComplete.options.disableEdit||!0===this.autoCompleteImageClicked){if(this.autoCompleteImageClicked&&this.options.directOpen)if(this.autoComplete.viewArr=[],
this.existGridViewItemsetNode);else for(var a=0;a<this.autoComplete.itemArr.length;a++)this.autoComplete.viewArr.push({label:this.autoComplete.itemArr[a].label,value:this.autoComplete.itemArr[a].value,orgLabel:this.autoComplete.itemArr[a].orgLabel,index:a,_hidden:this.autoComplete.itemArr[a]._hidden});this.autoComplete.openSubLayer(),this.autoCompleteImageClicked=!1}else this.autoComplete.setInputFocus()}else this.autoComplete.options.disableEdit||this.autoComplete.setInputFocus(),this.autoComplete.dom.input.value="";0==this.autoComplete.getItemCount()&&(this.autoComplete.selectedIndex=-1,this.autoComplete.dom.label.innerHTML="")}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.autoComplete.prototype.setColumnDisableEdit=function(t){try{this.options.disableEdit=!0,this.autoComplete&&this.autoComplete.disableEdit(t)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.autoComplete.prototype._handleEndEdit_common=function(t){try{this.autoComplete.endEdit({noEvent:!0}),this.autoComplete.closeSubLayer();var e=this.autoComplete.getValue();try{this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.autoComplete.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i),this.options.directOpen&&(this.autoComplete.editmode=!1)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.autoComplete.prototype._handleEndEdit_focus=function(t,e,i){!1===i&&this.mainGrid._setFocusedCell()},E.autoComplete.prototype._handleCancelEdit=function(t){this.autoComplete.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.mainGrid.getRealRowIndex(this.editRowIndex),this.colID);this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.autoComplete.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},E.autoComplete.prototype._getEditedValue=function(t){return this.autoComplete.getValue()},E.autoComplete.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.calendar=function(){},E.calendar.prototype.initializeCellInfo=function(t){try{this.options.useIOFormatLength&&this.refreshDataArr()}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i);if(this.options.embeddedInput){var h=this.mainGrid.getInput(this,t,e);h.render&&null==this.mainGrid._getWrapperTD(h.render.parentNode)&&(l.innerHTML="",l.appendChild(h.render));var p=0,u=0,c=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",c=!0),this.mainGrid.embeddedCalendarStyleObj||(this.mainGrid.embeddedCalendarStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),p=t.getBoundingClientRect().height-parseFloat(WebSquare.style.getStyle(t,"border-top-width"))-parseFloat(WebSquare.style.getStyle(t,"border-bottom-width")),p-=this.mainGrid.embeddedCalendarStyleObj.top+this.mainGrid.embeddedCalendarStyleObj.bottom,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),u=this.mainGrid.embeddedWidthObj[o].width,u-=this.mainGrid.embeddedCalendarStyleObj.left+this.mainGrid.embeddedCalendarStyleObj.right,c?t.parentNode.style.display="none":a.Z.isIE("6 7")&&(p-=2);var g=a.Z.getDataPrefix("rowindex");h.setSize(u-2,p),h.render.setAttribute(g,i),h._setValue(e,{skipValidate:!0}),this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,o)?h.setDisabled(!0):h.setDisabled(!1),t.removeAttribute("tabIndex")}else{var f=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape
;(f=a.Z.getBoolean(f))&&(e=WebSquare.xml._encode(e+"")),this.options.useMonthYearFormat&&(e=WebSquare.date.getIOFormatDate(e,this.options.ioFormat,this.options.calendarValueType));var m=this.getDisplayData(e),y=this.mainGrid._dataList.filteredRowIndexArr[i],b=this.mainGrid.getCellOption(y,o,"viewType"),v=a.Z.getDataPrefix("rowIndex"),w=a.Z.getDataPrefix("colIndex"),C=a.Z.getDataPrefix("col_id");if("icon"==b&&"true"==this.options.viewTypeIconImage){l.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+C+"='"+this.colID+"' "+v+"='"+i+"' "+w+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+m+this.mainGrid.dataTagClose,"</td>","<td "+C+"='"+this.colID+"' "+v+"='"+i+"'  "+w+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_calendar_div_img' />","</td>","</table>"].join("");var I=this,_=l.getElementsByTagName("div")[0];d.f.addListener(_,"onclick",(function(t){I.mainGrid._getEditDisabled(i,o)||I.mainGrid.___getEditReadOnly(i,o)||(I.calendarImageClicked=!0)}))}else{var x=a.Z.getDataPrefix("editModeEvent");l.innerHTML=this.mainGrid.dataTagOpen+m+this.mainGrid.dataTagClose,"icon"==b||""==b&&"own"==this.options.dataType?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_calendar"),t.setAttribute(x,this.options.editModeEventIcon)):this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar")}}if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var S=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof S&&(this.mainGrid.options.titleFormatter=S,n=S.call(this,i,o,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.Y.printStackTrace(t,null,this)}var R=n||this.options.title||"";R&&t.setAttribute("title",R)}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;var i=this.mainGrid._getWrapperCell(t,e);if("true"==this.options.viewTypeIconImage){var o=i.getElementsByTagName("div")[0];this.mainGrid.removeClass(o,this.mainGrid.options.bodyTdClass+"_calendar_div_img")}else this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar");this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var r=this.mainGrid.getInput(this);this.comp=r;for(var a=i.firstChild;null!=a;a=a.nextSibling)if("NOBR"==a.nodeName.toUpperCase()||"SPAN"==a.nodeName.toUpperCase()&&a.className.indexOf("w2grid_span")>-1){WebSquare.style.setStyle(a,"visibility","hidden");break}if(1==r.options.renderDiv||"true"==r.options.renderDiv){var n=document.getElementById(this.mainGridId+this.id),l=t.offsetWidth-6,h=t.offsetHeight,d=document.getElementById(this.mainGridId+this.id+"_div_input"),p=l-18-5,u=h-3,c=document.getElementById(this.mainGridId+this.id+"_input"),g=p-(parseInt(WebSquare.style.getStyle(c,"border-right-width"),10)+parseInt(WebSquare.style.getStyle(c,"border-left-width"),10)+parseInt(WebSquare.style.getStyle(c,"padding-right"),10)+parseInt(WebSquare.style.getStyle(c,"padding-left"),10)),f=u-2,m=document.getElementById(this.mainGridId+this.id+"_img"),y=u/2-m.offsetHeight/2;if(1==this.options.useAnchor||"true"==this.options.useAnchor){var b=document.getElementById(this.mainGridId+this.id+"_a");WebSquare.style.setStyle(b,"top",y+"px")}else WebSquare.style.setStyle(m,"top",y+"px");WebSquare.style.setStyle(n,"width",Math.max(l,0)+"px"),WebSquare.style.setStyle(d,"width",Math.max(p,0)+"px"),WebSquare.style.setStyle(c,"width",Math.max(g,0)+"px"),WebSquare.style.setStyle(n,"height",Math.max(h-3,0)+"px"),WebSquare.style.setStyle(d,"height",Math.max(u,0)+"px"),WebSquare.style.setStyle(c,"height",Math.max(f,0)+"px")}
var v=this.mainGrid.dataList._getCellData(e,this.colID);this.options.useMonthYearFormat&&(v=WebSquare.date.getIOFormatDate(v,this.options.ioFormat,this.options.calendarValueType)),r._setValue(v,{noFormat:!0,skipValidate:!0}),"icon"==this.options.viewType&&"true"==this.options.viewTypeIconImage&&1==this.calendarImageClicked?(this.calendarImageClicked=!1,r.toggle()):(r.focus(),"select"==r.options.editType&&r.select()),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0)}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};if(a.Z.isIE(8)?t={top:1,left:0,width:0,height:0}:a.Z.isFF()?t={top:0,left:-1,width:0,height:0}:a.Z.isChrome()||a.Z.isSafari()?t={top:1,left:0,width:0,height:0}:a.Z.isOpera()&&(t={top:1,left:0,width:0,height:1}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+t.top,r=i.offsetLeft+1+t.left,n=i.clientWidth-5+t.width,l=i.clientHeight-3+t.height,h=l-1;if(this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))r-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var p=this.mainGrid.getInput(this);p.show(),p.render.style.top=o+"px",p.render.style.left=r+"px",p.render.style.width=n+"px",p.render.style.height=l+"px",p.render.firstChild.style.height=l+"px",p.dom.input.style.height=h+"px",p.dom.input.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,a.Z.isIE()&&(p.dom.input.style.lineHeight=l+"px"),!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(p.render.id,3)}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},E.calendar.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);e.hideCalendar();var i=e.getValue();i=e.validator.validateString(i),this.options.useIOFormatLength||(i=e.sub_validator.validateString(i)),this.options.useMonthYearFormat&&(i=WebSquare.date.getIOUnFormatDate(i,e.options.ioFormat,e.options.calendarValueType)),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};return o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype._handleEndEdit_focus=function(t,e){!0!==e&&t.hide()},E.calendar.prototype.validate=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue(),o=WebSquare.historyManager.get(e.options.pluginName,e.id);if(this.options.disableDateValidSet&&e.disableValidate(i))null!=o.value&&e._setValue(o.value,{skipValidate:!0}),this.mainGrid.getInput(this).blur();else{if(e.validate())return!0;if(""==i)return!0;if(this.options.dateValidSet&&(e._skipDateValidSet=!0),this.options.dateValidSet&&this.options.dateValidSetCustom)this.mainGrid.getInput(this).blur();else if(this.options.dateValidSet&&null!=o.value&&e._setValue(o.value,{skipValidate:!0}),this.mainGrid.getInput(this).blur(),"false"!==this.options.displaymessage){var r=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"Invalid date format.";e.options.invalidMessageFunc||alert(r)}}return this.mainGrid.getInput(this).focus(),!1}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},E.calendar.prototype._handleCancelEdit=function(t){try{
var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){s.Y.printStackTrace(t,null,this)}},E.calendar.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.calendar.prototype.refreshDataArr=function(){try{var t;t=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var e=this.mainGrid._dataList.cellIdList.length,i=this.mainGrid._dataList.bodyIdColIndexMap[this.id],o=this.mainGrid.getInput(this),r=0;r<t.length;r++){var a=t[r],n=this.mainGrid._dataList.dataArr[a*e+i],l=o.sub_validator.validateString(n);this.mainGrid._dataList.dataArr[a*e+i]=l}}catch(t){s.Y.printStackTrace(t,null,this)}},E.expression=function(){},E.expression.prototype.initializeCellInfo=function(){var t=this.options.expression;if(this.mainGrid.useExpression=!0,this.expIdArr=[],""!=t){var e=t.match(/(sum|avg|max|min|display|rowindex|rowstatus|datalist)[\s]*[(][\S\s]*?[)]/gi);if(null!=e){t="";for(var i=0;i<e.length;i++)t+=e[i],i<e.length-1&&(t+="+")}t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"_this.getCalcExpressionTarget(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/rowStatus[\s]*[(]/gi,"_this.getExpressionTarget(")}try{new Function("_this",t)(this)}catch(t){s.Y.printStackTrace(t,null,this)}},E.expression.prototype.getExpressionTarget=function(){for(var t=0;t<arguments.length;t++)null==this.expIdArr[arguments[t]]&&(this.expIdArr[arguments[t]]=arguments[t],this.mainGrid.setExpressionAssociation(arguments[t],this.colID));return 1},E.expression.prototype.getCalcExpressionTarget=function(t){var e=t.wq_replaceAll("(",",").wq_replaceAll(")",",").wq_replaceAll("+",",").wq_replaceAll("-",",").wq_replaceAll("*",",").wq_replaceAll("/",",").wq_replaceAll("%",",").wq_replaceAll(" ","");e=e.split(",");for(var i=0;i<e.length;i++)""!==e[i]&&null==this.expIdArr[e[i]]&&(this.expIdArr[e[i]]=e[i],this.mainGrid.setExpressionAssociation(e[i],this.colID));return 1},E.expression.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i),h=this.mainGrid.dataList.getRealRowIndex(i),d=this.mainGrid._getGroupbyDisplayRowIndex(i),p=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),u=this.getDisplayData(null,h);"function"==typeof p?(this.useCustomFormatter=!0,n=p.call(this.mainGrid,e,u,d,o)):(this.useCustomFormatter=!1,n=u);var c=l.innerHTML.replace(/\r(\n)?/,"\n"),g=this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose;c!==g&&(l.innerHTML=g.replace("NaN",this.options.NaNFormat),this.mainGrid.drawFooter(this.colID))}catch(t){s.Y.printStackTrace(t,null,this)}},E.expression.prototype.getDisplayData=function(t,e,i){return t=this.getExpressionValue(e),this.formatter&&!0!==i?this.formatter.format(t):t},E.expression.prototype.getExpressionValue=function(t){if(this.rowIndex=t,!this.options.expressionFunc){var e=this.options.expression
;""!=e&&(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[sS][uU][mM][\s]*[(]/g,"this.colsum(rowIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"this.colavg(rowIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.colmax(rowIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.colmin(rowIndex,")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"this.colcalc(rowIndex,")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"this.display(rowIndex,")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"this.datalist(rowIndex,")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"this.getRowIndex(rowIndex")).replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(rowIndex"),e=a.Z.scopingFuncBody(e,this.scope_id)),this.options.expressionFunc=Function("rowIndex",e),this.options.expressionFunc.changeCount=0}var i=this.mainGrid.changeCount,o="";return this.options.expressionFunc[t]&&i==this.options.expressionFunc[t].changeCount?o=this.options.expressionFunc[t].oldValue:(this.options.expressionFunc[t]||(this.options.expressionFunc[t]={}),this.options.expressionFunc[t].changeCount=i,o=this.options.expressionFunc.call(this,t),this.options.expressionFunc[t].oldValue=o),o},E.expression.prototype.colsum=function(){for(var t=arguments[0],e=0,i=1;i<arguments.length;i++){var o=this.mainGrid.getColumnIndex(arguments[i]),s=this.options.dataType;"gridView"==this.mainGrid.options.pluginName&&(s=this.mainGrid._dataList.getCellInfo(this.options.col_id).options.dataType),"bigDecimal"===s?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,o)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,o))||0}return e},E.expression.prototype.colavg=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);"bigDecimal"===i?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,s))||0}return"bigDecimal"===i?e=WebSquare.bigDecimal(e).divide(WebSquare.bigDecimal(arguments.length-1)).toString():e/=arguments.length-1,e},E.expression.prototype.colmax=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0;else{var r=parseFloat(this.mainGrid.dataList._getData(t,s))||0;r>e&&(e=r)}}return e},E.expression.prototype.colmin=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e="0"===WebSquare.bigDecimal(e).toString()?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)):WebSquare.bigDecimal(e),e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)),!0)||0;else{var r=parseFloat(this.mainGrid.dataList._getData(t,s))||0;(1==o||r<e)&&(e=r)}}return e},E.expression.prototype.colcalc=function(t,e){function i(t,e){t[t.length]=e}function o(t){var e=t[t.length-1];return delete t[t.length-1],t.length--,e}function r(t){return!a(t)&&"("!=t&&")"!=t}function a(t){return"+"==t||"-"==t||"*"==t||"/"==t||"^"==t||"%"==t}function n(t){return t[t.length-1]}function l(t){return 0==t.length}function h(t){return"^"==t?5:"*"==t||"/"==t||"%"==t?4:"+"==t||"-"==t?3:"("==t?2:")"==t?1:void 0}function d(t,e,i){var o;try{return"+"==i&&(o=t.plus(e)),"-"==i&&(o=t.minus(e)),"*"==i&&(o=t.times(e)),"/"==i&&(o=t.divide(e)),"^"==i&&(o=t.pow(e)),"%"==i&&(o=t.mod(e)),o}catch(t){s.Y.printStackTrace(t)}}var p=function(t,e,s){e=new Array;var d=new Array,p=0;t=function(t){for(var e=t.split(""),i="",o=new Array,s=0,n=0;n<e.length;n++)r(e[n])&&null==e[n].match(/\s/)&&(i+=e[n]),(a(e[n])||")"==e[n]||"("==e[n])&&(""!=i&&(o[s]=i,s++),i="",o[s]=e[n],s++),n==e.length-1&&""!=i&&(o[s]=i);return o}(t)
;for(var u=0;u<t.length;u++){if(r(t[u])&&(e[p]=t[u],p++),a(t[u])){if("^"!=t[u])for(;!l(d)&&h(t[u])<=h(n(d));)e[p]=n(d),o(d),p++;else for(;!l(d)&&h(t[u])<h(n(d));)e[p]=n(d),o(d),p++;i(d,t[u])}if("("==t[u]&&i(d,t[u]),")"==t[u]){for(;"("!=n(d);)e[p]=o(d),p++;o(d)}}for(;!l(d);)"("==n(d)?o(d):e[e.length]=o(d);var c="";for(u=0;u<e.length;u++)c+=e[u];return 0==s?c:e}(e);for(var u in p){var c=this.mainGrid.getColumnIndex(p[u]);p[u]=null!=c?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,c)):p[u]}return function(t){for(var e,s,a=new Array,l=0;l<t.length;l++)if(r(t[l]))i(a,t[l]);else{(e=new Function("return "+n(a))()).constructor!=WebSquare.bigDecimalObj&&(e=WebSquare.bigDecimal(e)),o(a),(s=new Function("return "+n(a))()).constructor!=WebSquare.bigDecimalObj&&(s=WebSquare.bigDecimal(s));var h=d(s,e,t[l]);o(a),i(a,h)}return n(a)}(p)},E.expression.prototype.display=function(){var t=arguments[0],e=this.mainGrid.getColumnIndex(arguments[1]);return this.mainGrid.dataList._getData(t,e)},E.expression.prototype.datalist=function(t,e){return e=this.mainGrid._dataList.getColumnIndex(e),this.mainGrid._dataList._getCellData(t,e,!0)},E.expression.prototype.getRowIndex=function(){var t=arguments[0];return this.mainGrid.getDisplayRowIndex(t)},E.expression.prototype.rowStatus=function(){var t=arguments[0];switch(this.mainGrid.dataList.getRowStatusValue(t)){case 0:return"R";case 1:return"U";case 2:return"C";case 3:return"D";case 4:return"V"}},E.textarea=function(){},E.textarea.prototype.initializeCellInfo=function(t){try{if(t){var e=t.getAttribute("showReadOnly");if(e)this.options.showReadOnly=a.Z.getBoolean(e);else{var i=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/showReadOnly/@value')||"true";this.options.showReadOnly=a.Z.getBoolean(i)}}}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i);if(this.options.embeddedInput){var h=this.mainGrid.getInput(this,t);h.show(),l.innerHTML="",l.appendChild(h.render);var d=a.Z.getDataPrefix("rowindex");h.render.setAttribute(d,i),h.render.style.top="0",h.render.style.left="0",h.render.style.width="100%",h.render.style.height="100%",h.render.style.imeMode=this.options.imeMode,this.options.placeholder&&(h.render.placeholder=this.options.placeholder),h.setValue(this.mainGrid.dataList._getCellData(i,this.id)),this.mainGrid._getEditDisabled(i,o)?h.setDisabled(!0):h.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?h.setReadOnly(!0):h.setReadOnly(!1)}else{var p;!0!==this.mainGrid._isBrowserScroll()?(p=t.clientWidth-8)<0&&(p=this.mainGrid.getColumnWidth(o,!0)-8):p=this.mainGrid.getColumnWidth(o,!0);var u=p>=0?" width:"+p+"px; ":" ",c=this.getDisplayData(e),g=this.mainGrid._getGroupbyDisplayRowIndex(i),f=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),m=c,y=this.options.textAlign?"text-align:"+this.options.textAlign+";":"",b="pre-wrap";a.Z.isIEAllVersion("6 7")&&(b="normal");var v="all"===this.options.displayType?"word-break:break-all;white-space:"+b+";":"";"function"==typeof f?(this.useCustomFormatter=!0,m=f.call(this.mainGrid,e,c,g,o)):this.useCustomFormatter=!1,l.innerHTML="<div class='w2grid_textarea' style='"+y+u+v+"' >"+(this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(m+"")):this.getDisplayData(m))+"</div>"}if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var w=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof w&&(this.mainGrid.options.titleFormatter=w,n=w.call(this,i,o,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",n)}catch(t){s.Y.printStackTrace(t,null,this)}if("all"===this.options.displayType&&"all"===this.mainGrid.options.visibleRowNum&&!0!==this.mainGrid._isBrowserScroll()&&this.mainGrid.getRowCount()>0){
var C=this.mainGrid.getElementById(this.mainGrid.id+"_body_table"),I=this.mainGrid.getElementById(this.mainGrid.id+"_foot_table"),_=C.offsetHeight;I&&(_+=I.offsetHeight),this.mainGrid.render.offsetHeight!=_&&this.mainGrid.setSize(null,_)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this._setEditMode(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype._setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.options.disabled||i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),this.options.disabled||"select"!=this.options.editType&&"select"!=this.mainGrid.options.editType||i.select()}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};a.Z.isIE(8)?t={top:-1,left:-1,width:0,height:0}:a.Z.isFF()?t={top:-2,left:0,width:0,height:0}:a.Z.isOpera()?t={top:0,left:0,width:0,height:1}:a.Z.isChrome()&&(t={top:0,left:0,width:0,height:0});var e=this.editTd;if(!0===this.mainGrid._isNativeScroll("both")){var i=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=i.scrollTop,t.left-=i.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var o=e.offsetTop+1+t.top,r=e.offsetLeft+1+t.left,n=e.clientWidth>150?e.clientWidth-5+t.width:150,l=e.clientHeight>60?e.clientHeight-2+t.height:60;if(this.mainGrid.options.groupbyZone){var h=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(h=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=h}if(this.mainGrid.gridWidth<r+n){var d=(e.clientWidth>150?0:5+t.width)-2;r-=r+n-(e.offsetLeft+e.clientWidth)+d}var p=this.mainGrid.scrollX_right;if(!0!==this.mainGrid._isBrowserScroll()&&this.mainGrid.render.offsetHeight-p.offsetHeight<o+l){var u=e.clientHeight>60?0:2-t.top;(o-=o+l-(e.offsetTop+e.clientHeight)+u)<0&&(o=1+t.top),l>this.mainGrid.render.offsetHeight&&(l=this.mainGrid.render.offsetHeight-6+t.height)}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))r-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var c=this.mainGrid.getInput(this);this.comp=c,c.show(),c.render.style.top=o+"px",c.render.style.left=r+"px",c.render.style.width=n+"px",c.render.style.height=l+"px",c.render.style.imeMode=this.options.imeMode,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(c.render.id,3)}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},E.textarea.prototype.showReadonly=function(t,e){this.mainGrid._endEdit();var i=this.mainGrid.getInput(this),o=a.Z.getDataPrefix("col_id"),s=t.getAttribute(o);(this.options.disabled||this.mainGrid._getEditDisabled(e,s))&&i.setDisabled(!0),(this.options.readOnly||this.mainGrid.___getEditReadOnly(e,s))&&i.setReadOnly(!0),this._setEditMode(t,e),this.mainGrid.editedCell=this},E.textarea.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();"number"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")&&""!=i&&(i=Number(i));var o=this.editTd.offsetHeight;this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var r=this.editTd.offsetHeight;this.changedCellHeight=r-o;var a={};return a[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,a),e}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype._handleEndEdit_focus=function(t){
t.hide(),t.setDisabled(!1),t.setReadOnly(!1)},E.textarea.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},E.textarea.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getInput(this);i.hide(),i.setDisabled(!1),i.setReadOnly(!1)}catch(t){s.Y.printStackTrace(t,null,this)}},E.textarea.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.drilldown=function(){},E.drilldown.prototype.setInnerHTML=function(t,e,i){var o=i,s=100,r=this.options.depthColumn;if("linkedDataList"===this.mode){if(null!=this.mainGrid._linkedDataList.filteredRowIndexArr&&this.mainGrid._linkedDataList.filteredRowIndexArr.length>0){o=this.mainGrid._linkedDataList.filteredRowIndexArr[i];var n=this.mainGrid._linkedDataList.filteredRowIndexArr.length-1;s=o<this.mainGrid._linkedDataList.filteredRowIndexArr[n]?parseInt(this.mainGrid.dataList._getCellData(i+1,r),10):null}}else null!=this.mainGrid._dataList.filteredRowIndexArr&&this.mainGrid._dataList.filteredRowIndexArr.length>0&&(s=(o=this.mainGrid.dataList.getRealRowIndex(i))<this.mainGrid.dataList.getRealRowIndex(this.mainGrid.getDataLength()-1)?parseInt(this.mainGrid.dataList._getCellData(i+1,r),10):null);for(var l=parseInt(this.mainGrid.dataList._getCellData(i,r),10),h="",d=o,p=1;p<l;p++)"div"==this.options.depthType?h+="<div class='w2grid_depthBlank'></div>":"line"==this.options.depthType?(h="<div class='w2grid_depth"+(1===p?this.mainGrid.drilldown.isLastChild(d)?"_line_L":"_line_T":this.mainGrid.drilldown.isLastChild(d)?"Blank":"_line_I")+"'></div>"+h,d=this.mainGrid.drilldown.getParentRowIndex(d)):"none"==this.options.depthType?h+="":h+="&nbsp;&nbsp;";var u=0,c="w2grid_plus";null!=s&&l<s?(u=1,c="w2grid_minus"):this.mainGrid.hasChild(i)||(u=2,c="w2grid_leaf"),1==l&&(c+=" w2grid_root");var g="",f=a.Z.getDataPrefix("openStatus");g=a.Z.isMobile()?"<span class='"+c+"' style='display:inline-block;' "+f+"='"+u+"' ontouchstart='this.clicked=true'></span>":"<span class='"+c+"' style='display:inline-block;' "+f+"='"+u+"' onclick='this.clicked=true'></span>";var m="<div class='w2grid_depthBlank";"1"==l&&(m+=" w2grid_depthBlank_root"),2===u&&(m+=" w2grid_depthBlank_leaf"),m+="'>";var y=this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(e+"")):this.getDisplayData(e),b="";"span"==this.mainGrid.options.dataTag&&(b=" w2grid_span"),"div"==this.options.depthType?(g=m+g+"</div>",t.innerHTML="<"+this.mainGrid.options.dataTag+" class='w2grid_drilldown_nobr"+b+"'>"+h+g+y+this.mainGrid.dataTagClose):"line"==this.options.depthType?(g=m+g+"</div>",t.innerHTML=h+g+"<"+this.mainGrid.options.dataTag+" class='w2grid_drilldown_nobr"+b+"'>"+y+this.mainGrid.dataTagClose):(this.options.depthType,t.innerHTML=this.mainGrid.dataTagOpen+h+g+y+this.mainGrid.dataTagClose)},E.drilldown.prototype.handleClick=function(t,e){for(var i,o=t.getElementsByTagName("span"),s=0;s<o.length;s++)if(-1==o[s].className.indexOf("w2grid_span")){i=o[s];break}if(1==i.clicked){i.clicked=!1;var r=a.Z.getDataPrefix("openStatus");return"2"!=i.getAttribute(r)&&this.mainGrid._toggle(e,!0),!0}return!1},E.drilldown.prototype.setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.setPosition();var i=this.mainGrid.getInput(this);i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat,i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),document.activeElement!=i.render&&i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType&&i.select()}catch(t){s.Y.printStackTrace(t,null,this)}},E.drilldown.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(a.Z.isFF()?t={top:-1,left:-1,width:0,height:0}:a.Z.isOpera()?t={top:0,left:0,width:0,
height:1}:a.Z.isIE(9)&&(t={top:-1,left:-1,width:0,height:0}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,r=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=r+"px",l.render.style.height=n+"px",a.Z.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(l.render.id,3)},E.drilldown.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},E.drilldown.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);return this.setEditData(e),e}catch(t){s.Y.printStackTrace(t,null,this)}},E.drilldown.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t.hide()},E.drilldown.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},E.drilldown.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){s.Y.printStackTrace(t,null,this)}},E.drilldown.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.drilldown.prototype.setEditData=function(t){try{var e=t.getValue();e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==i&&""!=e&&(e=Number(e));var o={};o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,o)}catch(t){s.Y.printStackTrace(t,null,this)}},E.textImage=function(){},E.textImage.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l=this.mainGrid.getElemRowIndex(t),h=this.mainGrid.dataList.getRealRowIndex(l),p=this.mainGrid._getGroupbyDisplayRowIndex(i),u=this.mainGrid.getColumnIndex(this.colID),c=this.mainGrid.getCellOption(h,u,"viewType"),g=this.options.imageSrc?this.mainGrid.getImageURL(this.options.imageSrc):"",f=this.options.imageAlign?this.options.imageAlign:"right",m=this.mainGrid.getColumnID(o),y=!1,b=!1;this.mainGrid._getEditDisabled(i,m)?(y=!0,this.options.imageSrcDisabled&&(g=this.mainGrid.getImageURL(this.options.imageSrcDisabled))):this.mainGrid.___getEditReadOnly(i,m)&&(b=!0,this.options.imageSrcReadOnly&&(g=this.mainGrid.getImageURL(this.options.imageSrcReadOnly)));var v=e,w=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),C=a.Z.getGlobalFunction(this.options.customModelUnformatter,this.scope_id);"function"==typeof C&&(v=C.call(this.mainGrid,e,p,o));var I=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(I=a.Z.getBoolean(I))&&(v=WebSquare.xml._encode(v+""));var _,x,S=this.getDisplayData(v);if("function"==typeof w?(this.useCustomFormatter=!0,_=w.call(this.mainGrid,e,S,p,o)):(this.useCustomFormatter=!1,_=S),this.mainGrid.options.titleFormatter)try{
if("function"!=typeof this.mainGrid.options.titleFormatter){var R=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof R&&(this.mainGrid.options.titleFormatter=R,x=R.call(this,i,o,e))}else x=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",x)}catch(t){s.Y.printStackTrace(t,null,this)}if("icon"==c||""==c&&"own"==this.options.dataType||r&&!0===r.visibleIcon){var D="";try{this.options.onerror&&(D=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.Y.printStackTrace(t,null,this)}var T="w2grid_textImage_image";y?T+=" w2grid_textImage_disabled":b&&(T+=" w2grid_textImage_readonly");var L=a.Z.getDataPrefix("tdIndex"),k=a.Z.getDataPrefix("col_id"),F=a.Z.getDataPrefix("rowIndex"),A=a.Z.getDataPrefix("colIndex"),E=t.getAttribute(L);t.removeAttribute("alt");var M="";""!=this.options.alt&&(M=" alt='"+this.options.alt+"' "),n.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<tr class='bodyTextImageAlign'>","</tr>","</table>"].join("");var O=n.querySelector(".bodyTextImageAlign");"left"===f?O.innerHTML=["<td "+k+"='"+this.colID+"' "+F+"='"+i+"'  "+A+"='"+o+"' class='"+T+"' style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'>","<img src='"+g+"' "+D+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'"+M+" />","</td>","<td "+k+"='"+this.colID+"' "+F+"='"+i+"' "+A+"='"+o+"' tdIndex='"+E+"' class='w2grid_textImage' style='overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+_+this.mainGrid.dataTagClose,"</td>"].join(""):"right"===f&&(O.innerHTML=["<td "+k+"='"+this.colID+"' "+F+"='"+i+"' "+A+"='"+o+"' tdIndex='"+E+"' class='w2grid_textImage' style='overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+_+this.mainGrid.dataTagClose,"</td>","<td "+k+"='"+this.colID+"' "+F+"='"+i+"'  "+A+"='"+o+"' class='"+T+"' style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'>","<img src='"+g+"' "+D+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'"+M+" />","</td>"].join(""));var N=this,H=n.getElementsByTagName("img")[0];d.f.addListener(H,"onclick",(function(t){d.f.stopPropagation(t);var s=N.mainGrid._getEditDisabled(i,o);if(N.options.useImageClick||0==s){if(N.mainGrid.editedCell){var r=N.mainGrid._getGroupbyDisplayRowIndex(N.mainGrid.editedCell.editRowIndex),n=N.mainGrid.editedCell.colID,l=N.mainGrid._dataList.getCellData(r,n);N.mainGrid.editedCell.handleEndEdit();var u=N.mainGrid._dataList.getCellData(r,n),c=N.mainGrid.getColumnIndex(n);u!=l&&d.f.fireEvent(N.mainGrid,"onviewchange",{oldValue:l,newValue:u,rowIndex:r,colIndex:c,colId:N.mainGrid.getColumnID(c)})}var g=N.getDisplayData(e),f=a.Z.getGlobalFunction(N.options.imageClickFunction,N.scope_id);d.f.fireEvent(N.mainGrid,"ontextimageclick",i,o),N.mainGrid._setFocusedCell(i,o),"function"==typeof f&&(N.options.displayRowIndex?f.call(N.mainGrid,p,N.colID,g):f.call(N.mainGrid,h,N.colID,g))}}))}else n.innerHTML=this.mainGrid.dataTagOpen+_+this.mainGrid.dataTagClose},E.textImage.prototype.setEditMode=function(t,e){try{try{this.options.onerror&&' onerror="('+this.options.onerror+').call(this,event);" '}catch(t){s.Y.printStackTrace(t,null,this)}if(this.editRowIndex=e,this.editTd=t,"icon"!=this.options.viewType&&(""!=this.options.viewType||"own"!=this.options.dataType)){this.setInnerHTML(this.editTd,null,this.editRowIndex,this.getColumnIndex(this.colID),{visibleIcon:!0})}this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),
this.setPosition();var i=this.mainGrid.getInput(this);this.comp=i,i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat,i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType?i.select():"focus"==i.options.editType&&(a.Z.isIE()||a.Z.isFF())&&WebSquare.text.setCaretPos(i.render,i.render.value.length)}catch(t){s.Y.printStackTrace(t,null,this)}},E.textImage.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0,tdWidth:0};if(a.Z.isFF()?t={top:-1,left:-1,width:0,height:0,tdWidth:0}:a.Z.isOpera()&&(t={top:0,left:0,width:0,height:1,tdWidth:0}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.getElementsByTagName("td"),r=this.options.imageAlign?this.options.imageAlign:"right",n="right"===r?o[1].firstChild:o[0].firstChild,l=i.clientWidth-n.offsetWidth-1+t.tdWidth,h=i.offsetTop+1+t.top,d=i.offsetLeft+1+t.left+("right"===r?0:n.offsetWidth),p=i.clientWidth-n.offsetWidth-6+t.width,u=i.clientHeight-2+t.height;if(this.mainGrid.options.groupbyZone){var c=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(c=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),h+=c}("right"===r?o[0]:o[1]).style.width=l+"px";var g=this.mainGrid.getInput(this);if(""!=this.options.imeMode)g.render.style.imeMode=this.options.imeMode;else{var f=this.mainGrid.getColumnOption(this.options.col_id,"dataType");g.render.style.imeMode="number"==f?"disabled":""}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))h-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,g.render.style.lineHeight=u+"px";g.show(),g.render.style.top=h+"px",g.render.style.left=d+"px",g.render.style.width=p+"px",g.render.style.height=u+"px",g.render.style.lineHeight=u+"px",g.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(g.render.id,3)}catch(t){s.Y.printStackTrace(t,null,this)}},E.textImage.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},E.textImage.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();i=e.validator.validateString(i),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};o[this.mainGrid.id]=!0;var r=a.Z.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof r){this.useCustomModelFormatter=!0;var n=this.getDisplayData(i);i=r.call(this.mainGrid,i,n,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;return this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){s.Y.printStackTrace(t,null,this)}},E.textImage.prototype._handleEndEdit_focus=function(t){t.setDisabled(!1),t.setReadOnly(!1),t.hide()},E.textImage.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},E.textImage.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.getInput(this),i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),e.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},E.textImage.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.textImage.prototype.showReadonly=function(t,e){this.setEditMode(t,e);var i=this.mainGrid.getInput(this);i.setDisabled(!0),i.setReadOnly(!0),
this.mainGrid.editedCell=this},E.prototype.setDataListCellRefresh=function(t){try{if(t){this.initFormatter(t);var e=this.options.dataType;e||(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"!=e||this.options.displayFormat||(this.options.displayFormat=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/dataType/date/@displayFormat")),"time"!=e||this.options.displayFormat||(this.options.displayFormat="HH:mm");var i=!this.options.groupName||!this.options.groupValue,o=this.options.inputType;if(i&&("button"!=o&&"image"!=o)){var a=this.mainGrid._dataList.getCellInfo(this.colID),n=!(!a||!a.element&&a.id!==this.id);this.options.readOnly=!n||t.getAttribute("readOnly")}}}catch(t){s.Y.printStackTrace(t,null,this)}},E.spinner=function(){},E.spinner.prototype.initializeCellInfo=function(t){try{if(!this.xml)if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var e="",i=(e=a.Z.isIE("6 7")&&this.internal?WebSquare.xml.nodeWellFormed(t.outerHTML):WebSquare.xml.serialize(t)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"";e=(e=e.wq_replaceAll("<w2:column","<w2:spinner"+i)).wq_replaceAll("</w2:column","</w2:spinner");var o=WebSquare.xml.parse(e,!0);this.xml=o.documentElement}}catch(t){s.Y.printStackTrace(t,null,this)}},E.spinner.prototype.setInnerHTML=function(t,e,i,o,s){null==e&&(e="");var r=this.mainGrid._getWrapperCell(t,i);this.spinner&&this.spinner.render&&r.firstChild==this.spinner.render&&r.removeChild(this.spinner.render),r.innerHTML=this.mainGrid.dataTagOpen+this.getDisplayData(e,i)+this.mainGrid.dataTagClose;var n=this.mainGrid.dataList.getRealRowIndex(i),l=this.mainGrid.getCellOption(n,o,"viewType"),h=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),d=a.Z.getDataPrefix("editModeEvent");("icon"==l||""==l&&"own"==h)&&(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_spinner"),t.setAttribute(d,this.options.editModeEventIcon))},E.spinner.prototype.setEditMode=function(t,e){try{var i=this.mainGrid._getWrapperCell(t,e);if(""==this.style){var o=a.Z.getDataPrefix("tdindex");this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_spinner_"+this.id),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.dataType&&(this.configOptions.dataType=this.options.dataType),this.options.buttonSize&&(this.configOptions.buttonSize=this.options.buttonSize),this.options.dateIncrementType&&(this.configOptions.dateIncrementType=this.options.dateIncrementType),this.options.displayFormat&&(this.configOptions.displayFormat=this.options.displayFormat),this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.increment&&(this.configOptions.increment=this.options.increment),this.options.min&&(this.configOptions.min=this.options.min),this.options.max&&(this.configOptions.max=this.options.max),this.options.editType&&(this.configOptions.editType=this.options.editType);var r=t.getAttribute(o);this.mainGrid._getEditDisabled(e,r)?this.configOptions.disabled=!0:this.configOptions.disabled=!1,this.configOptions.xmlEvents=[{name:"ondblclick",action:"script",param:{handler:function(t){d.f.stopPropagation(t)}}}],this.spinner=new WebSquare.uiplugin.spinner(this.mainGridId+"_spinner_"+this.id,this.configOptions,this.xml),this.spinner.isGridCellComponent=!0;var n=this;this.spinner._handleClickEvent=this.spinner.handleClickEvent,this.spinner.handleClickEvent=function(t){var e=n.mainGrid.getElemRowIndex(this.render.parentElement),i=n.mainGrid._getGroupbyDisplayRowIndex(e),s=this.render.parentElement.getAttribute(o);if(this.options.customFormatter){try{var r=null,l={};if("function"==typeof(r=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id)))for(var h in l=r(i,s))this.options.hasOwnProperty(h)&&(this.options[h]=l[h])}catch(t){r=null}this._handleClickEvent(t)}else this._handleClickEvent(t)
;d.f.stopEvent(t)},this.spinner._inputKeyDown=this.spinner.inputKeyDown,this.spinner.inputKeyDown=function(t,e){27==t.keyCode||n.spinner._inputKeyDown(t,e)},i.innerHTML=this.spinner.toHTML(),this.spinner.activate(),this.spinner.setSize(t.clientWidth-2,t.clientHeight-2)}else i.innerHTML="",i.appendChild(this.spinner.render),this.spinner.show();this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),this.editColIndex=this.mainGrid.getColumnIndex(this.id),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.spinner.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),"select"!=this.options.editType&&"focus"!=this.options.editType||this.spinner.focus()}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},E.spinner.prototype._handleEndEdit_common=function(t){try{var e=this.spinner.getValue();if("number"==this.spinner.options.dataType){Number(e);this.options.customFormatter?(this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)):!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)}else this.spinner.options.dataType;this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.colID),this.spinner.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},E.spinner.prototype._handleCancelEdit=function(t){},E.spinner.prototype._handleEndEdit_focus=function(){try{return null}catch(t){s.Y.printStackTrace(t,null,this)}},E.spinner.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},E.custom=function(){},E.custom.prototype.initializeCellInfo=function(t,e){try{this.parseTypeGetter(),this.isValidTypeGetter?(this.cellManagerHashByID={},this.cellManagerHashByRowIndex={},this.cellManagerIDByRowIndex={}):(this.cellManagerHashByRowIndex=[],this.cellManagerIDByRowIndex=[],this.cellManagerInfoByRowIndex=[])}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.initializeCellManager=function(t,e){try{var i=e.inputType?e.inputType:e.tagName;if(t.id=e.id,t.colID=this.id,t._position={colIndex:this.mainGrid.getColumnIndex(this.colID),colID:this.id,realRowIndex:e.realRowIndex,displayRowIndex:e.displayRowIndex},t.parentColumnInfo=this,t.options.inputType=i,t.initializeInputType=this.getTagName(i),t.initializeInfo=e,"gridViewItemset"===e.itemTableType&&!e.itemSet)for(var o in t.initializeInfo.itemSet={nodeset:e.nodeset,label:e.label,value:e.value},t.options.itemSet=t.initializeInfo.itemSet,t.options.item=e.item,t.options.gridViewOptions={},t.options.itemTableType="gridViewItemset",e)t.options.gridViewOptions[o]=e[o];for(var o in e.options)t.options[o]=e.options[o];t.initFormatter()}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.getMapping=function(t,e){try{switch(t){case"text":default:return o.q.extend(e,WebSquare.uiplugin.cellInfo.text.prototype),!0;case"link":return o.q.extend(e,WebSquare.uiplugin.cellInfo.link.prototype),!0;case"checkbox":return o.q.extend(e,WebSquare.uiplugin.cellInfo.checkbox.prototype),!0;case"button":return o.q.extend(e,WebSquare.uiplugin.cellInfo.button.prototype),!0;case"image":return o.q.extend(e,WebSquare.uiplugin.cellInfo.image.prototype),!0;case"radio":return o.q.extend(e,WebSquare.uiplugin.cellInfo.radio.prototype),!0;case"select":return o.q.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(e,WebSquare.uiplugin.cellInfo.select.prototype),!0;case"calendar":return o.q.extend(e,WebSquare.uiplugin.cellInfo.calendar.prototype),!0;case"textarea":return o.q.extend(e,WebSquare.uiplugin.cellInfo.textarea.prototype),!0
;case"expression":return o.q.extend(e,WebSquare.uiplugin.cellInfo.expression.prototype),!0;case"textImage":return o.q.extend(e,WebSquare.uiplugin.cellInfo.textImage.prototype),!0;case"checkcombobox":return o.q.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(e,WebSquare.uiplugin.cellInfo.checkcombobox.prototype),!0;case"autoComplete":return o.q.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(e,WebSquare.uiplugin.cellInfo.autoComplete.prototype),!0;case"spinner":return o.q.extend(e,WebSquare.uiplugin.cellInfo.spinner.prototype),!0}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.getTagName=function(t){try{switch(t){case"text":return"input";case"link":return"anchor";case"button":return"trigger";case"select":return"selectbox";default:return t}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.parseTypeGetter=function(){try{this.options.typeGetter?(this.typeGetter=a.Z.getGlobalFunction(this.options.typeGetter,this.scope_id),this.isValidTypeGetter=!0):(this.isValidTypeGetter=!1,0==this.options.setCellInputTypeCustom&&$l("An error occurred while creating a custom type grid. property typeGetter is undefined.  gridView ["+this.mainGrid.id+"] column:["+this.id+"]"))}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.updateCellManagerHash=function(t,e,i,o,r){try{this.isValidTypeGetter?(this.cellManagerHashByID[t]=i,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t):(this.cellManagerInfoByRowIndex[e]=r,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t),o&&i.itemsetObj&&o.nodeset!==i.itemsetObj.nodeset&&i.setColumnNodeSet(o.nodeset,o.label,o.value)}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.createCellManager=function(t,e){try{var i=e.id,r=e.realRowIndex,a=o.q.extend({},this);if(a.internal=!0,a.options=o.q.extend({},this.options),a.options["data-col_id"]&&(a.options.col_id=a.options["data-col_id"]),a.initializeCellInfo=function(){},this.mainGrid.options.senseReader&&"false"!==a.options.embeddedInput&&("secret"!=e.inputType&&"text"!=e.inputType&&"select"!=e.inputType&&"checkbox"!=e.inputType&&"radio"!=e.inputType&&"calendar"!=e.inputType||(a.options.embeddedInput=!0,e.options&&(e.options.embeddedInput=!0))),e&&"radio"==e.inputType&&e.options&&e.options.groupName&&e.options.groupValue&&(this.mainGrid.radioGroupRepChk[e.options.groupName]=!0,this.options.readOnly&&!e.options.readOnly&&e.td&&(this.options.readOnly=!1,this.options.readOnlyClass&&this.mainGrid.removeClass(e.td,this.options.readOnlyClass),this.mainGrid.options.readOnlyClass&&this.mainGrid.removeClass(e.td,this.mainGrid.options.readOnlyClass))),this.getMapping(e.inputType,a)){if(this.initializeCellManager(a,e),a.initializeCellInfo(t,e.options),a.isLocked=!0,this.updateCellManagerHash(i,r,a,null,e),!0===a.options.embeddedInput){var n=e.itemSet;n&&"function"==typeof a.setColumnNodeSet&&a.setColumnNodeSet(n.nodeset,n.label,n.value,e.displayRowIndex)}return this.cellManagerHashByRowIndex[r]}var l=this.options.id,h=this.mainGrid.getColumnIndex(l);return $l("An error occurred while creating a custom type grid. gridView ["+this.mainGrid.id+"] column:["+this.id+"] inputType:["+e.inputType+"] realRowIndex:["+r+"] colIndex["+h+"]"),!1}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.getCellManager=function(t){try{var e=t.managerID,i=t.element,o=t.rowIndex,r=t.realRowIndex,a=this.options.id,n=this.mainGrid.getColumnIndex(a),l=this.mainGrid.dataList.getCellData(o,n),h={colID:a,colIndex:n,rowIndex:o,displayRowIndex:t.rowIndex,realRowIndex:t.realRowIndex,value:l};try{var d,p;if(1!=this.mainGrid.options.setCellInputTypeCustom||this.isValidTypeGetter){if(this.cellManagerHashByID&&this.cellManagerHashByID[e])return this.cellManagerHashByID[e];if(this.isValidTypeGetter){var u=!1;(p=this.typeGetter(h))&&p.options&&null!=p.options.readOnly&&this.mainGrid.setCellReadOnly(r,this.id,p.options.readOnly),
p&&p.options&&null!=p.options.disabled&&this.mainGrid.setCellDisabled(r,this.id,p.options.disabled);m=this.cellManagerIDByRowIndex[r];if((f=this.cellManagerHashByRowIndex[r])&&f.options.embeddedInput&&t.td){var c=this.mainGrid._getWrapperCell(t.td,r);c.firstChild?c.firstChild&&c.firstChild.id!==this.mainGrid.id+"_"+m&&(u=!0):u=!0}if(!p||m!==p.id||u)if(m)g=!0===f.options.embeddedInput?this.mainGridId+"_"+m:this.mainGridId+m,this.mainGrid._removeDom(g),delete this.cellManagerHashByID[m],delete this.cellManagerHashByRowIndex[r],delete this.cellManagerIDByRowIndex[r]}else this.parseTypeGetter(),this.isValidTypeGetter&&(p=this.typeGetter(h))}else if(1==t.dynamicInputType){if((p=t.options).id="dynamic_"+p.inputType+"_"+o+"_"+n,p.td=t.td,p.dynamicInputType=!0,this.cellManagerHashByRowIndex[r]){var g,f=this.cellManagerHashByRowIndex[r],m=this.cellManagerIDByRowIndex[r];g=!0===f.options.embeddedInput?this.mainGrid.id+"_"+m:this.mainGridId+m,this.mainGrid._removeDom(g),delete this.cellManagerIDByRowIndex[r],delete this.cellManagerHashByRowIndex[r]}}else if(this.cellManagerHashByRowIndex[r]&&!t.dynamicInputType)return this.cellManagerHashByRowIndex[r];return p?(p.isUDC||((d=1==this.mainGrid.options.setCellInputTypeCustom?this.cellManagerHashByRowIndex[r]:this.cellManagerHashByID[p.id])?(this.updateCellManagerHash(p.id,r,d,p.itemSet),d.isLocked):(p.realRowIndex=r,p.rowIndex=o,p.displayRowIndex=o,d=this.createCellManager(i,p))),1!=this.mainGrid.options.setCellInputTypeCustom&&(d.customValue=p.value)):d=this.createCellManager(i,{id:this.colID+"_"+r+"__default",inputType:"text",td:t.td,realRowIndex:r}),d}catch(t){return $l("An error occurred while creating a custom type grid. gridView ["+this.mainGrid.id+"] column:["+this.id+"] realRowIndex:["+r+"] colIndex["+n+"]"),!1}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.setInnerHTML=function(t,e,i,o,r){try{var a=this.mainGrid.getRealRowIndex(i),n=this.mainGrid._getWrapperCell(t,a);if(this.mainGrid.options.setCellInputTypeCustom&&!this.isValidTypeGetter&&this.mainGrid.options.senseReader){this.cellManagerInfoByRowIndex[a];if(this.cellManagerIDByRowIndex&&!this.cellManagerIDByRowIndex[a]&&this.cellManagerInfoByRowIndex[a])return void this.mainGrid._setCellInputType(i,o,null,this.cellManagerInfoByRowIndex[a]);var l=this.cellManagerHashByRowIndex[a];if(l&&l.options.embeddedInput){var h=this.cellManagerIDByRowIndex[a],d=this.mainGrid.id+"_"+h;if(!n.firstChild||n.firstChild&&n.firstChild.id!=d)return this.mainGrid._removeDom(d),this.cellManagerHashByRowIndex[a]=null,this.cellManagerIDByRowIndex[a]=null,void this.mainGrid._setCellInputType(i,o,null,this.cellManagerInfoByRowIndex[a])}}var p=this.getCellManager({element:this.element,rowIndex:i,realRowIndex:a,td:t});if(!1===p)n.innerHTML=this.mainGrid.dataTagOpen+e+this.mainGrid.dataTagClose;else{this.clearStyle(p,t);var u="class";!0===this.isValidTypeGetter&&p.options[u]&&this.mainGrid.addClass(t,p.options[u]),p.setInnerHTML(t,e,i,o),null!=p.customValue&&(e=p.customValue,this.mainGrid.dataList.__setCellData(i,this.colID,e)),this.useCustomFormatter=p.useCustomFormatter,this.useCustomModelFormatter=p.useCustomModelFormatter,this.useEscapeFormatter=p.useEscapeFormatter}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.setEditMode=function(t,e){try{if(!this.internal){var i=this.mainGrid.getRealRowIndex(e),o=this.cellManagerHashByRowIndex[i];o&&o.setEditMode(t,e)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.setPosition=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];e&&e.setPosition()}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype._handleEndEdit_common=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];if(i)return i._handleEndEdit_common(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},
E.custom.prototype._handleEndEdit_focus=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];i&&i._handleEndEdit_focus(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype._handleCancelEdit=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i._handleCancelEdit()}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.doDefaultAction=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i.doDefaultAction()}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.clearStyle=function(t,e){try{var i=a.Z.getDataPrefix("editModeEvent");"calendar"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_calendar")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_calendar"),e.setAttribute(i,"")),"select"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_select")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_select"),e.setAttribute(i,"")),"autoComplete"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete"),e.setAttribute(i,"")),"checkcombobox"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox"),e.setAttribute(i,""))}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.validate=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];return!e||("calendar"!==e.options.inputType||e.validate())}}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype._getEditedValue=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];if(e&&e._getEditedValue)return e._getEditedValue()}return""}catch(t){s.Y.printStackTrace(t,null,this)}},E.custom.prototype.refreshCellManagerHash=function(){try{for(var t=this.mainGrid.getRowCount(),e=0;e<t;e++)this.getCellManager({element:this.element,rowIndex:e,realRowIndex:this.mainGrid.getRealRowIndex(e)})}catch(t){s.Y.printStackTrace(t,null,this)}},E.user=function(){},E.user.prototype.setInnerHTML=function(t,e,i,o,s){var r,n=this.mainGrid._getWrapperCell(t,i),l=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),h=this.mainGrid._getGroupbyDisplayRowIndex(i),d=this.getDisplayData(e);"function"==typeof l?(this.useCustomFormatter=!0,r=l.call(this.mainGrid,e,d,h,o)):(this.useCustomFormatter=!1,r=d),n.innerHTML=this.mainGrid.dataTagOpen+r+this.mainGrid.dataTagClose},E.user.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=d.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=a.Z.getDataPrefix("col_id"),r=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),r=n.focusedColIndex}this.mainGrid._getEditDisabled(i,r)||this.mainGrid.___getEditReadOnly(i,r)||d.f.fireEvent(this.mainGrid,"oncellclick",o,r,this.options.id)};var O=function(t,e,i){n.q.call(this,t,e,i)};o.q.extend(O.prototype,n.q.prototype),O.prototype.defaultOptions={useConfig:!0,pluginType:"uiplugin.gridView",pluginName:"gridView",serializable:!0,
userEvents:["oncellclick","oncelldblclick","onrightbuttonclick","ontextimageclick","ondateselect","oneditdblclick","oncellindexchange","onrowindexchange","oncolumnindexchange","onfilereadend","onscrollend","onscrollstart","onbeforeedit","oneditend","oneditkeydown","onafteredit","onscrolly","onscrollx","onsort","onbeforesort","onheaderclick","onheaderrightbuttonclick","onheaderdblclick","onheadermouseover","onheadermouseout","onheadertextimageclick","onfooterclick","onsubtotalclick","onsubtotaldblclick","onbodymouseover","onbodymouseout","ongroupby","ontoggleclick","onclick","onblankclick","onkeydown","onkeyup","onviewchange","onbeforepaste","onafterpaste","oncolumnwidthchange","onbeforecolumnmove","onaftercolumnmove","onaftercolumnresize","ondatadragstart","ondatadragover","ondatadrop","oncontextopen","oncontextclick","oneditkeyup"],rowNumVisible:!1,rowNumRowSpan:!0,rowNumHeaderValue:"",rowNumLocaleRef:"",rowNumBackgroundColor:"",rowNumRowMouseOverColor:!1,rowNumStatusResize:!1,cellStatusVisible:!1,cellStatusIconPosition:"right",rowStatusVisible:!1,rowStatusRowSpan:!0,rowStatusColSpan:!1,rowStatusHeaderValue:"",rowStatusLocaleRef:"",overflowX:"auto",overflowY:"auto",fixedColumn:0,fixedColumnWithHidden:!0,fixedColumnNoBGColor:!1,fixedColumnScrollHidden:!1,fixedColumnNoMove:!1,fixedColumnScrollReset:!0,fixedColumnLineDiv:!1,fixedColumnLineDivStart:"tbody",rowNumStatusFixed:!0,fixedRightColumn:0,fixedRow:0,lastFixedRow:0,lastFixedRowStartIndex:0,resize:!0,rowResize:!1,baseNode:"vector",repeatNode:"data/INFO",valueNode:"",focusMode:"cell",selectedCellColor:"#FCA73C",selectedRowColor:"#FCA73C",oddEvenColorDisplay:!1,oddRowBackgroundColor:"#EFF7FF",evenRowBackgroundColor:"#FFFFFF",rowMouseOver:!1,rowMouseOverColor:"#ffff80",selectedCellOverColor:"",selectedRowOverColor:"",editModeEvent:"ondblclick",editModeEventIcon:"onclick",keyMoveEditMode:!1,enterKeyMove:"down",skipMultiRowMove:!1,sortable:!1,sortHeaderDiv:!1,sortOrderReverse:!1,noSortInit:!1,showSortableImage:!1,preventMultisort:!1,useCtrlOnMultisort:!0,useCtrlKey:!0,sortedImagePosition:"",sortedIconPosition:"",sortEvent:"ondblclick",headerTooltipDisplay:!1,rowStatusTooltipDisplay:!1,tabKeyMove:"right",tooltipDisplay:!1,tooltipDisplayTime:0,tooltipClass:"",tooltipStyle:"",tooltipHide:"click",tooltipShowAlways:!1,tooltipShowAlwaysColumns:"",tooltipHeaderShowAlways:!1,tooltipFormatter:"",tooltipFormatterHeader:"",tooltipPositionX:"20",tooltipPositionY:"3+cellHeight",tooltipDisplayColumn:"",tooltipHeader:!1,showImageTooltip:!1,captionTitle:"",captionAuto:!1,noResultMessageVisibleAlways:!1,noResultMessageVisible:!1,noResultMessageExclude:"",noResultMessage:"",noResultMessageClass:"",noResultMessageStyle:"",noResultMessageStylePriority:!1,useNoResultMessageURL:!1,noResultMessageURL:"",noResultMessageCenter:!1,hiddenClass:"",readOnly:"",readOnlyPriority:"",readOnlyBackgroundColor:"",readOnlyBackgroundImg:"",readOnlyBackgroundImgCSS:"",readOnlyTabIgnore:!1,ignoreNonEditableCell:!1,ignoreNonEditableCellTabEnter:!1,disabledPriority:"",disabledBackgroundColor:"",disabledFontColor:"",summary:"",footerCaption:"",footerCaptionAuto:!1,footerSummary:"",footerSummaryAuto:!1,drawLimitTime:70,drawLimitRow:4,loadCount:0,autoFit:"",autoFitMinWidth:"",autoFitFixYScroll:!1,fastScroll:"",lazyDrawHiddenColumn:!1,defaultCellHeight:-1,defaultHeaderCellHeight:-1,hideHeader:!1,dataDragDrop:!1,dataDragDropOther:!1,dataDragDropSelf:!1,dataDragDropStatus:!1,dataDragSelect:!1,dataDragSelectAutoScroll:!1,dataDragSelectAutoScrollDPI:5,dataDragSelectAutoScrollPeriod:70,dataDragSelectAutoScrollDelay:50,dataDragSelectAutoScrollLevel:1300,dragDisplayColumn:"",dragStartFunction:"",dragEndFunction:"",headFiller:!1,focusMove:"true",focusFlow:"default",scrollMsg:"",visibleRowNum:"",visibleRowNumFix:!1,fixHeight:!1,fastEditMode:!1,iScrollMoveEffectTime:500,iScrollSlideTime:800,iScrollSlidePeriod:100,rollbackCommit:!0,numberCasting:!1,backgroundColorMode:"lazy",senseReader:!1,senseReaderLinkFocus:!1,useStartEndDiv:!0,
showLastRow:!1,autoScope:!1,autoResizeEmbeddedInput:!1,servletPopup:!1,excelUploadPopupURL:"",advancedExcelUploadPopupURL:"",advancedExcelMultiUploadPopupURL:"",advancedExcelDownloadPopupURL:"",excelUploadURL:"",excelDownloadURL:"",csvDownloadURL:"",csvUploadPopupURL:"",csvUploadURL:"",advancedExcelUploadURL:"",advancedExcelDownloadURL:"",excelFileNameEncode:!1,drilldownRealRowIndex:!0,drilldownRealRowIndexAll:!1,drilldownToggleScrollFix:!1,escape:!0,fixPrint:!1,xmlEncode:!1,wheelRows:3,wheelStop:!1,scrollByColumn:!1,scrollByColumnAdaptive:!1,rowNumWidth:"",rowStatusWidth:"",keepDefaultColumnWidth:!1,columnMove:!1,columnMoveWithFooter:!1,columnOrder:"",copyAmount:"",copyOption:"",copyType:"default",pasteOption:"",rowCopy:!1,noUseCSVParser:!1,customPasteFormatter:"",checkReadOnlyOnPaste:!1,checkDisabledOnPaste:!1,checkReadOnlyOnCut:!0,checkDisabledOnCut:!0,checkBlankRowOnPaste:!1,checkEditableInputClass:!1,checkEditOnPaste:!1,checkOnCellClick:!1,setDefaultValueOnPaste:!1,preventAddRowOnPaste:!1,preventCopy:!1,preventPaste:!1,groupbyZone:!1,groupbyZoneSearch:!1,groupbyListVisibleRowNum:10,groupbyZoneMessage:"",groupbyZoneHeight:"50",groupbyMaxCount:-1,groupbyDisplayRowIndex:!1,groupbyFilterIcon:!1,plainText:!1,hideDeletedRow:!1,excludeDeletedRows:!1,excludeModifiedRows:!1,initFixedHeightByRowNum:-1,moveKeyEditMode:!1,moveKeyEditModeAll:!1,keepBeforeDisplayData:!1,touchScrollDelta:5,dataList:"",useFilterSearch:!1,useSearchFilter:!1,useFilterList:!1,useFilterListSync:!1,useFilterListFormat:!1,useResizeFilterList:!1,filterListRowHeight:20,filterListVisibleRowNum:0,filterListWidth:0,caseSensitive:!1,displayValueOnUseFilterList:!1,customFilterListVisibleRowNum:10,showAllFilterList:!1,useFilterEmptyMsg:"",filterDisplayMode:"label",filterSearchTarget:"label",filterShowAlways:!1,duplicateColumnId:!1,filterFocusMode:"",focusOnSetData:!1,focusDefaultColumn:!1,focusAutoRemove:!1,scrollFix:!1,scrollRowHeight:!1,applyAllColumnStyle:!1,disabledScrollHidden:!1,hammerEnabled:!1,hammerPressTime:351,dynamic:!1,ignoreCellClick:!1,ignoreToggleOnDisabled:!1,adaptive:"",autoFitFilterList:!1,summaryAuto:!1,summaryOnlyAuto:!1,arrowMove:!1,filterBoxvisibleRowNum:4,groupbyFilterBox:!1,groupbyFilterBoxLocation:"bottom",groupbyFilterBoxLabelSize:3,customFilterBox:!1,customFilterFrameModal:!1,fixAdaptive:!1,groupbyFilterBoxFormatter:"",showSortableUseFilter:!1,customFormatterRealRowIndex:!1,oddEvenColorMerged:!1,showCustomFilterReset:!1,setCellInputTypeCustom:!1,useHeaderCheckboxLabelFor:!0,returnTrueFalseValue:!1,keepEditMode:!1,initStyle:!1,mergeCol:"",mergeRow:"",mergeCells:"never",noImageTooltip:!1,mergeCellsFixedCols:"never",mergeCellsFixedRows:"never",mergeExcludeValue:"",rowNumStatusUniqueId:!1,checkHeaderOnly:!1,checkAllType:"include",useDefaultStyle:!1,foldAll:!1,contextMenu:!1,useHeaderContextMenu:!1,contextMenuRowHeight:20,contextMenuAltClick:!1,titleAuto:!1,syncScroll:!1,disabledClass:"w2grid_default_disabled",readOnlyClass:"w2grid_default_readonly",selectByLabel:!1,syncWithScrollTrack:!1,aliasDataCollection:"",editInputClass:"",directEdit:!1,numberMask:"",euroMask:"",rupeeMask:"",tengeMask:"",useMaxLength:!1,noSelect:!1,scrollFocus:!1,postMsg:!1,useXHR:!1,preventDuplicateFocusedCell:!1,alwaysTriggerScrollStart:!1,CellClickFixScrollX:!1,drawType:"virtual",mergeRefreshAlways:!0,subtotalStyleFormatter:"",mergeCellsFixedColsFirst:!1,useImageClick:!1,hideSortIconOnNoData:!1,hideFilterIconOnNoData:!1,showCheckboxLabelUserFormat:!1,showRadioLabelUserFormat:!1,useMoreButton:!1,moreButtonTitle:"",useTextMultiLink:!1,dataTag:"nobr",ctrlShiftKey:!1,scrollXNative:!1,scrollXNativeMobile:"",accessibility:!1,contentCellClick:!1,useDataDragDropGuideLine:!1,viewChangeAfterEdit:!1,hybridRowNum:50,useMobileTooltip:!1,useShiftKeyCheck:!1,focusMoveByUpDownKey:!1,rowMouseOverClass:"",wrapperCell:!1,wrapperCellElem:"div"},O.prototype.initialize=function(t){if(this.initializeType="gridView",
isNaN(parseInt(this.options.visibleRowNum,10))||(this.options.initFixedHeightByRowNum=-1),this.options.initFixedHeightByRowNum>0&&""===this.options.visibleRowNum&&(this.options.visibleRowNum=this.options.initFixedHeightByRowNum),this.firstEmbeddedInputResize=!0,"none"===this.options.autoFit&&(this.options.autoFit=""),this._isNativeScroll()&&(this.options.visibleRowNum="all"),"native"===this.options.copyType&&(this.options.noSelect=!1),t){for(var e=!1,i=!1,s=t.getChildNodes(),r=0;r<s.length;r++)"w2:header"!=s[r].getTagName()?"w2:gBody"!=s[r].getTagName()||(e=!0):i=!0;if(!e||!i)return this.uncompleted=!0,void(this.options.dynamic||$l(" gridView error : cannot find <w2:header> or <w2:gBody>.["+this.id+"]"))}if(this.options.dataList=this.options.dataList.wq_replaceAll("data:",""),this._dataList=null,this.options.dataList&&(this._dataList=this.modelControl.getDataComp(this.options.dataList,{type:"aliasDataCollection"})),this._dataList)switch(this._grid=this,this._dataList.addChild(this),this._dataList=WebSquare.DataCollection.api.getObj(this._dataList),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.q.extend(this,WebSquare.uiplugin.linkedMappingController.prototype),o.q.extend(this.dataList,WebSquare.uiplugin.linkedMappingController.prototype),this.dataList._linkedDataList=this._linkedDataList):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}else $l(" gridView error : invalid dataList("+this.options.dataList+").["+this.id+"]"),this.successBinding=!1,this._dataList={};this.skipPreActivate=!0;var n=this.options.dataList;null!=this.scope_obj&&(n=this.scope_obj.id+"_"+this.options.dataList),WebSquare.DataCollection.api.addRelation(this.id,n,!1),this.skipPreActivate=!1,this.myhelper=new WebSquare.korHelper,(a.Z.isIEAllVersion()||a.Z.isSpartan())&&(this.options.useResizeFilterList=!1),(this.options.useSearchFilter||this.options.useResizeFilterList)&&(this.options.useFilterSearch=!1),this.options.useNoResultMessageURL&&(this.options.noResultMessageStyle="",this.options.noResultMessageClass="",this.options.noResultMessageExclude="",this.options.noResultMessageVisibleAlways=!1,this.options.noResultMessage="",this.options.noResultMessageStylePriority=!1,this.options.noResultMessageVisible=!0,this.options.noResultMessageURL||(this.options.noResultMessageURL=o.q._resourceURI+"message/noResultMessage/gridView_noResultMessage.xml")),!0===this.options.hideDeletedRow&&(this.options.excludeDeletedRows=!0),this.options.noResultMessageCenter&&!this.options.noResultMessageStylePriority&&(this.options.noResultMessageStyle="",this.options.noResultMessageClass=""),this._initialize()},O.prototype._initialize=function(t){if(this.focusedCellInfo={},this.extraData={grid:{},row:[],col:[],cell:[]},this.drilldown=new WebSquare.uiplugin.drilldown,"false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove||(this.options.enterKeyMove="none"),this.options.groupbyFilterBox&&(this.groupbyFilterBox_select=null,this.groupbyFilterBox_history=[]),!0===this.options.accessibility){this.options.senseReader=!0,this.options.focusMove="false",this.options.keyMoveEditMode=!0,this.options.autoResizeEmbeddedInput=!0,this.options.scrollFocus=!0,this.options.titleAuto=!0,this.options.sortHeaderDiv=!0,this.options.drawType="native";var e=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;e>0&&(this.options.initFixedHeightByRowNum=e,this.options.visibleRowNumFix=!0),this.options.visibleRowNum="all"}this.date=new Date,this.isDrillDown=!1,this.depthColumn="",this.showDepth="",this.removed=!1,this.useExpression=!1,this.colWidthList=[],this.gridWidth=0,this.resizeStarted=!1,this.headerHeight=0,this.footerHeight=0,this.hgap=[],
this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autofitDone=!1,this.resizeStatus="init",this.scrollWidthSize=18,this.scrollLayerWidthSize=18,this.hiddenList=[],this.headerFocus=!1,this.headerObjArr=[],this.tmpSelectbox=null,this.noevent=!1,this.rowIndex=-1,this.lastIndex=-1,this.oelIndex=-1,this.initializeDrawController(),this.drawedRowLength=0,this.maxRowLength=0,this.drawSizeChanged=!1,this.drawSizeAdded=!1,this.isExistTextarea=!1,this.bodyHeight=0,this.scrollEvent=!0,this.isColMerge=!1,this.isColMergeAnd=!1,this.upperToLowerColumnRelation={},this.hasSubtotal=!1,this.startRowNumber=0,this.dataRowList=[],this.subtotalRowHash={},this.subtotalDataArr={},this.subtotalObj={},this.drawSetTimeoutKey=[],this.overElem=null,this.outElem=null,this.hasFooter=!1,this.footerDataObj=null,this.drawFooterStatus=!0,this.bScrollTop=-1,this.bScrollY=0,this.drawedTime=0,this.defaultColCnt=0,this.options.rowNumVisible&&this.defaultColCnt++,this.options.rowStatusVisible&&this.defaultColCnt++,this.loadCheck=[],this.beforeDataLength=-1,this.beforeMaxRowLength=-1,this.checkScrollStart=!0,this.editEnd=!1,this.lastOverSrc=null,this.headerInfoHash={},this.headerInfoHash2={},this.cellInfoHash={},this.cellInfoHash2={},this.expressionAssArr=[],this.labelColumnAssArr=[],this.rowStyleValueObj={},this.columnStyleValueObj={},this.cellStyleValueObj={},this.defaultStyleValueObj={},this.initStyleValueObj={},this.adaptiveColumnStyleValueObj={},this.rowStyleFixedValueObj={},this.rowStyleDataValueObj={},this.columnStyleFixedValueObj={},this.columnStyleDataValueObj={},this.disabledCellStyleObj={},this.headerCellStyleValueObj={},this.headerCellClassObj={},this.rowStyleIndex=0,this.cellStyleIndex=0,this.rowStyleFixedIndex=0,this.rowStyleDataIndex=0,this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.tdCellClassArr=[],this._cellSelectedIndex=[],this.columnClassObj={},this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.focusedCell=[],this.focusedRow=[],this.headerToBodyRelation={},this.bodyToHeaderRelation={},this.passiveColSpanRelation={},this.colMoveBolockedHeaderObj={},this.backupHeaderHTML={},this.expressionHeaderInfo={},this.columnOrder=[],this.isIE6=a.Z.isIE("6"),"BackCompat"==document.compatMode&&(this.isIE6=!0),this.isIE7=a.Z.isIE("7"),this.isIE6or7=this.isIE6||this.isIE7,this.isMobile=a.Z.isMobile(),this.isWebKit=/webkit/.test(navigator.userAgent.toLowerCase()),this.tmpCnt=0,this.initFlag=!1,this.options.rowNumBackgroundColor=this.options.rowNumBackgroundColor.wq_trim(),this.options.selectedCellColor=this.options.selectedCellColor.wq_trim(),this.options.selectedRowColor=this.options.selectedRowColor.wq_trim(),this.options.oddRowBackgroundColor=this.options.oddRowBackgroundColor.wq_trim(),this.options.evenRowBackgroundColor=this.options.evenRowBackgroundColor.wq_trim(),this.options.rowMouseOverColor=this.options.rowMouseOverColor.wq_trim(),this.options.readOnlyBackgroundColor=this.options.readOnlyBackgroundColor.wq_trim(),this.options.disabledBackgroundColor=this.options.disabledBackgroundColor.wq_trim(),this.options.disabledFontColor=this.options.disabledFontColor.wq_trim(),a.Z.getBoolean(this.options.focusOnSetData)&&(this.options.focusOnSetData=!0),this.options.senseReader&&(this.options.focusFlow="linear","all"===this.options.visibleRowNum&&(this.options.showLastRow=!0),this.element&&"false"!=this.element.getAttribute("autoScope")&&(this.options.autoScope=!0),this.senseReaderMode=!0),this.embeddedWidthObj={},this.options.sortable&&this.options.sortHeaderDiv&&(this.options.showSortableImage=!0,this.options.sortEvent="onclick"),this.radioGroupRepChk={},this.options.excelUploadPopupURL=this.options.excelUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/fileUpload.jsp"),{baseURI:!0
}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/fileUpload.html"),{baseURI:!0})),this.options.advancedExcelUploadPopupURL=this.options.advancedExcelUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedfileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.html"),{baseURI:!0})),this.options.advancedExcelMultiUploadPopupURL=this.options.advancedExcelMultiUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedMultiUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedMultiUpload.html"),{baseURI:!0})),this.options.advancedExcelDownloadPopupURL=this.options.advancedExcelDownloadPopupURL||this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/download/advancedfileDownload.html"),{baseURI:!0}),this.options.excelUploadURL=this.options.excelUploadURL||WebSquare.baseServletURI+"excelToGrid.wq",this.options.excelDownloadURL=this.options.excelDownloadURL||WebSquare.baseServletURI+"xmlToExcel.wq",this.options.csvDownloadURL=this.options.csvDownloadURL||WebSquare.baseServletURI+"xmlToCSV.wq",this.options.csvUploadURL=this.options.csvUploadURL||WebSquare.baseServletURI+"csvToXML.wq",this.options.csvUploadPopupURL=this.options.csvUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/csvfileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.html"),{baseURI:!0})),this.options.advancedExcelUploadURL=this.options.advancedExcelUploadURL||WebSquare.baseServletURI+"excelToGrid2.wq",this.options.advancedExcelDownloadURL=this.options.advancedExcelDownloadURL||WebSquare.baseServletURI+"xmlToExcel2.wq",this.groupbyStatus={},this.groupbyZoneStatus={},this.groupbyDisplayOptions={},this.directItemChoiceKeyObj={},this.rowStatusColIDArr=[],this.cellIdList=[],this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.beforeEditedCellInfo=null,this.hiddenAdaptiveList=[],this.adaptiveEmbeddedInputIdList=[],this.hideThresholdObj={},this.orgBodyHeightObj={},this.orgHeaderHeightObj={},this.orgFooterHeightObj={},this.orgSubtotalHeightArr=[],this.oldOptions={},this.adaptiveGridType=0,this.tooltipPositionParse=!1,this.oneRowScrollHeight=20,this._manager=null,this.beforeEditedCellInfo=null,this.options.noResultMessage=this.options.noResultMessage||WebSquare.language.getMessage("Grid_noResultMessage")||"No search result.",this.options.scrollMsg=this.options.scrollMsg||WebSquare.language.getMessage("Grid_scrollMsg")||"Updating...",this.cellMergeInfo={},this.cellMergeRealInfo={},this.tdMergeInfo={},this.mergeColObj={},this.mergeRowObj={},this.hiddenRowObj={length:0,extraRow:0,row:{},init:!1},this.hiddenCellObj={length:0,init:!1},!0===this.options.moveKeyEditModeAll&&(this.options.moveKeyEditMode=!0),this.filterEmptyStr=this.options.useFilterEmptyMsg||WebSquare.language.getMessage("GRID_useFilterEmptyMsg"),this.useFilterEmptyValueInfo={"":!0};var i=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];i.push("");for(var o=0;o<i.length;o++)i[o]=i[o].trim(),this.useFilterEmptyValueInfo[i[o]]=!0;this._regDetectDOM=new RegExp("<[^<]+>","i"),this._regRemoveDOM=new RegExp("<[/]{0,1}[^></]+[/]{0,1}>","g"),this._bindDrag=!1,this._subtotalDisplayFormat="",this._dynamicVisibleRowNum=-1,"span"==this.options.dataTag?(this.dataTagOpen="<span class='w2grid_span'>",this.dataTagClose="</span>"):(this.dataTagOpen="<"+this.options.dataTag+">",this.dataTagClose="</"+this.options.dataTag+">"),WebSquare.util.isMobile()&&this.options.scrollXNativeMobile&&(this.options.scrollXNative=a.Z.getBoolean(this.options.scrollXNativeMobile)),this._setOverflowYScrollFlag=!1,this._setOverflowYHiddenFlag=!1,this._editendCalled=!1,this._hybridScrollYPos=0,this._hybridRowIndex=0,this._hybridScrollHeight=20,
this._hybridScrollDupHeight=0,this._hybridScrollLastTop=NaN,this._hybridScrollHash={},this._hybridWheelCntX=0,this._hybridWheelCntY=0,this._hybridMobileStartX=0,this._hybridMobileStartY=0,this._hybridRefreshCnt=0,this._hybridRefreshMax=2,!0===this._isHybridScroll()&&(this.options.initFixedHeightByRowNum=-1),this.headerConfigOptions={},this.footerConfigOptions={},this.subtotalConfigOptions={},this._headerOverElemId=""},O.prototype.setPreAction=function(){try{var t=this.render.offsetWidth,e=this.render.offsetHeight;this.resizeObj={width:t,height:e,scrollLeft:0,scrollTop:0,clientWidth:this.render.clientWidth};var i=this.getElementById(this.id+"_head_table").getElementsByTagName("tr"),o=i[i.length-1],r=this.getElementById(this.id+"_body_table");this.gridLastTrBottomFix=r.offsetHeight-o.offsetTop-o.offsetHeight,this.setTableLayout(),this._handleScrollX(),this.setCellInfo(),this.setDataListCellInfo(),1==this.isDrillDown&&this.initDrilldown(),!0!==this.options.preventCopy&&!0!==this.options.noSelect||this.addClass("w2noselect")}catch(t){s.Y.printStackTrace(t,null,this)}},O.prototype.setAction=function(){try{if(this.initializeEvent(),this.options.columnOrder&&this.setColumnOrder(this.options.columnOrder),this.options.mergeCol){for(var t=this.getColumnCount(),e=0;e<t;e++)this.mergeColObj[e]=!1;var i=this.options.mergeCol.split(",");for(e=0;e<i.length;e++){var o=i[e];isNaN(o)||(o=Number(o)),this.mergeCol(i[e],!0)}}this._noResultMessageDivTop=WebSquare.util.getStyleProperty(this.getElementById(this.id+"_noresult"),"top");for(e=0;e<this.oneRowDataLength;e++){var r=this.getColumnID(e),n=this.getCellInfo(e);if(""!=this.options.hiddenClass||""!=n.options.hiddenClass){var l=this.options.hiddenClass;""!=n.options.hiddenClass&&(l=n.options.hiddenClass);var h=this._getRealColIndex("body",r)+this.defaultColCnt,d=null!=this.bodyToHeaderRelation[r]?this.getHeaderLayer(this.bodyToHeaderRelation[r]):null;this.hiddenList[h]?null==d||this.hasClass(d,l)||this.addClass(d,l):null!=d&&this.hasClass(d,l)&&this.removeClass(d,l)}}!this.startedDisplayNone&&this.getRowCount&&this.getRowCount()>0?this.notifyDataChanged({refreshScroll:!0}):!0===this._isHybridScroll()&&this.setScrollYHeightHybrid(),!this.startedDisplayNone&&this.options.focusOnSetData&&this._setFocusedCell(0,0),this.successBinding&&this._dataList&&this._dataList.options.initRowPosition&&this._dataList.broadcast({linkedDataList:["notifyRowPositionChanged"]});var p=WebSquare.BootLoader.fullViewed||!1,u=a.Z.fullViewed||!1;if(p||u||!this.startedDisplayNone&&this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),1==this.options.summaryAuto&&!0!==a.Z.isHTML5()){var c=this.getHeaderValueList(),g="",f="";for(e=0;e<c.length;e++)g.length>0&&(f=","),g=g+f+c[e];this.setSummary(g)}if(this.changeCount=0,a.Z.getBoolean(this.options.captionAuto)){for(c=this.getHeaderValueList(),g="",f="",e=0;e<c.length;e++)g.length>0&&(f=","),g=g+f+c[e];var m=this.options.accessibility?". "+WebSquare.language.getMessage("Grid_caption_shortcut"):"";this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+g+WebSquare.language.getMessage("Grid_caption")+m):this.setCaption(g+WebSquare.language.getMessage("Grid_caption")+m)}if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var y=document.getElementById(this.id).style.cssText,b=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:y,className:b}}if(this.startedDisplayNone||this._setVisibleRowNumFix(),this.options.noResultMessageVisibleAlways&&this.displayNoResultMessage(),this.options.groupbyZone){if(this.delayedDraw({}))return;this._drawGroupbyZone()}}catch(t){s.Y.printStackTrace(t,null,this)}},
O.prototype.setDataList=function(){try{if(!this.successBinding&&(this._dataList=this.modelControl.getDataComp(this.options.dataList),this._dataList)){switch(this._grid=this,this._dataList.addChild(this),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.q.extend(this,WebSquare.uiplugin.linkedMappingController.prototype)):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}for(var t=0;t<this.oneRowDataLength;t++)this.getCellInfo(t).setDataListCellRefresh(this.getCellInfo(t).element);this.render&&this.notifyDataChanged({refreshScroll:!0})}}catch(t){s.Y.printStackTrace(t,null,this)}},O.prototype.resetDataList=function(){try{this.successBinding=!1,this.setDataList()}catch(t){s.Y.printStackTrace(t,null,this)}},O.prototype.serialize=function(){return this.focusedCell},O.prototype.restore=function(t){try{for(var e=0,i=t.length;e<i;e++)this._setFocusedCell(t[e].focusedRowIndex,t[e].focusedColIndex,null,{useShiftKey:!0})}catch(t){return s.Y.printStackTrace(t),!1}return!0},O.prototype.onComplete=function(){this.uncompleted||(this._setRedrawTextAreaColumn(),this.displayFixedColumnLine(),n.q.prototype.onComplete.call(this))},o.q.extend(O.prototype,l.prototype),o.q.extend(O.prototype,c.prototype),o.q.extend(O.prototype,g.prototype),o.q.extend(O.prototype,f.prototype),o.q.extend(O.prototype,m.prototype),o.q.extend(O.prototype,b.prototype),o.q.extend(O.prototype,v.prototype),o.q.extend(O.prototype,w.prototype),o.q.extend(O.prototype,C.prototype),o.q.extend(O.prototype,_.prototype),o.q.extend(O.prototype,x.prototype),o.q.extend(O.prototype,S.prototype),o.q.extend(O.prototype,D.prototype),o.q.extend(O.prototype,T.prototype)},1230:(t,e,i)=>{i.d(e,{b:()=>n});i(582);var o=i(2710),s=i(9107),r=i(1263),a=i(2327),n=function(t){this._grid=t};n.prototype.getRealRowIndex=function(t){try{var e;if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var i in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[i])return this._grid._dataList.getRealRowIndex(t);e=this._grid.groupbyStatus.groupedRowIndexArr[t]}else e=this._grid._dataList.getRealRowIndex(t);return e}catch(t){o.Y.printStackTrace(t)}},n.prototype.getTotalRow=function(){try{return this._grid._dataList.getTotalRow()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getTotalCol=function(){try{return this._grid.oneRowDataLength}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowCount=function(){try{return this._grid._dataList.getDataLength()}catch(t){o.Y.printStackTrace(t)}},n.prototype._getData=function(t,e){try{e=this._grid.getColumnID(e);var i=this._grid.cellInfoHash[e]||{options:{}};if((1!=this._grid.options.moveKeyEditModeAll||"checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)&&this._grid.editEndBeforeGetData(),i&&"expression"==i.options.inputType)return i.getExpressionValue(t);var s=this._grid._dataList._getData(t,e);return null==s&&(s=""),s}catch(t){o.Y.printStackTrace(t)}},n.prototype.getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);return"2"==(i=null==i||void 0===i?"0":i+"")?this._getCellData(t,e,i):this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?this._getCellData(t,e,"0"===i?3:i):this._getCellData(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype._getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);if("2"==(i=null==i||void 0===i?"0":i+""))return this._grid._getCellDisplayData(t,e);var s=this._grid.getRealRowIndex(t);return"3"!=i&&null!=s&&(t=s),this._getData(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getOriginalCellData=function(t,e){try{e=this._grid.getColumnID(e);return this._grid._dataList.getOriginalCellData(t,e)}catch(t){
o.Y.printStackTrace(t)}},n.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var s=e[i];t+=parseInt(s.colSpan,10)||1}return t}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.getColData=function(t,e){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColData(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowData=function(t,e){try{for(var i=[],s=0;s<this._grid.getColumnCount();s++)"displayData"!=e?i.push(this.getCellData(t,s)):i.push(this._grid._getCellDisplayData(t,s));return i}catch(t){o.Y.printStackTrace(t)}},n.prototype._getRowData=function(t,e){try{for(var i=[],s=0;s<this._grid.getColumnCount();s++)"displayData"!=e?i.push(this._getData(t,s)):i.push(this._grid._getDisplayData(t,s));return i}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDataRow=function(t){try{return this._grid._dataList.getDataRow(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getMatchedData=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedData(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUnmatchedData=function(t,e,i,s,r){try{return this._grid._dataList.getUnmatchedData(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getMatchedColumnData=function(t,e,i,s,r,a){try{return this._grid._dataList.getMatchedColumnData(t,e,i,s,r,a)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUnmatchedColumnData=function(t,e,i,s,r,a){try{return this._grid._dataList.getUnmatchedColumnData(t,e,i,s,r,a)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getMatchedIndex=function(t,e,i,s,r){try{return this._grid._dataList.getMatchedIndex(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUnmatchedIndex=function(t,e,i,s,r){try{return this._grid._dataList.getUnmatchedIndex(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRangeData=function(t,e,i){try{var s=[];if(t>e){var r=e;e=t,t=r}t<0&&(t=0),e>this._grid.getDataLength()&&(e=this._grid.getDataLength());for(var a=t;a<e;a++)s=s.concat(this.getRowData(a,i));return s}catch(t){o.Y.printStackTrace(t)}},n.prototype.getAllData=function(){try{return this._grid._dataList.getAllData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getColumnDistinctDataArray=function(t){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColumnDistinctDataArray(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRangeXML=function(t,e){try{return this._grid._dataList.getRangeXML(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getMatchedXML=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedXML(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUnmatchedXML=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedXML(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowXML=function(t){try{return this._grid._dataList.getRowXML(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getAllXML=function(){try{return this._grid._dataList.getAllXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowJSON=function(t){try{return this._grid._dataList.getRowJSON(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getAllJSON=function(){try{return this._grid._dataList.getAllJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRangeJSON=function(t,e){try{return this._grid._dataList.getRangeJSON(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getMatchedJSON=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedJSON(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUnmatchedJSON=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedJSON(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowArray=function(t){try{return this._grid._dataList.getRowArray(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getAllArray=function(){try{return this._grid._dataList.getAllArray()
}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRangeArray=function(t,e){try{return this._grid._dataList.getRangeArray(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getMatchedArray=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedArray(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUnmatchedArray=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedArray(t,e,i,s,r)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setCellData=function(t,e,i,s,r,a,n,l){try{e=this._grid.getColumnID(e);if(this._grid._linkedDataList){var h=this._grid._linkedDataList.filteredRowIndexArr[t];"number"!=typeof t&&(t=h)}this._setCellData(t,e,i,null,s,r,a,n,l)}catch(t){o.Y.printStackTrace(t)}},n.prototype._setCellData=function(t,e,i,r,a,n,l,h,d){try{var p=!1;if("object"==typeof t&&null!=t){e=t.colID,i=t.data,r=t.noDraw,a=t.direction,n=t.skipBroadCast,l=t.noEvent,h=t.excludeId,d=t.skipInstance,p=t.useRealRowIndex;var u=t.filteredRowIndex;t=null,t=u}null==i&&(i=""),null==this._grid.editedCell||this._grid.getCellOption(t,e,"embeddedInput")||this._grid.editedCell.handleCancelEdit();var c,g=this._grid._dataList.getTotalRow(),f=this._grid._dataList.getTotalCol();c=!0===p||this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?t:this._grid.getRealRowIndex(t);var m=t,y="",b=(e=this._grid.getColumnID(e),this._grid.getColumnIndex(e)),v=this._grid._dataList.getColumnIndex(e),w=this._grid._linkedDataList||this._grid.groupbyStatus.grouped?c:t;if(this._grid.isDrillDown&&this._grid._dataList.options.depthColumn?y=this.getCellData(c,e,"3"):w>=0&&w<g&&v>=0&&v<f&&(y=this.getCellData(t,e)),w>=0&&w<g&&v>=0&&v<f){var C=this._grid.cellInfoHash[this._grid.tdIdList[b]]||{options:{}},I=C.options.inputType||"text";if(("text"==I||"textImage"==I||"drilldown"==I)&&"all"==C.options.applyFormat&&!C.options.embeddedInput){var _=this._grid.getInput(C);y=C.formatter.format(y),y=_.validator.validateString(y)}var x=this._grid.getColumnOption(C.options.col_id,"dataType");if("bigDecimal"==x&&"string"==typeof i?i=WebSquare.bigDecimal(i).toString():"bigDecimal"==x&&($l("If dataType is bigDecimal, data must be entered to String.["+this.id+"]"),i=WebSquare.bigDecimal(i).toString()),i.toString().replace(/\r(\n)?/,"\n")!==y.toString().replace(/\r(\n)?/,"\n")){var S=t;if((this._grid._linkedDataList||this._grid.isDrillDown&&this._grid._dataList.options.depthColumn)&&(S=c),this._grid.groupbyStatus.grouped?this._grid._dataList._setCellData({filteredRowIndex:c,colID:e,value:i,direction:a,skipBroadCast:n,noEvent:l,excludeId:h,realRowIndex:!0,notifyRowIndex:t,skipInstance:d}):this._grid._dataList._setCellData(S,e,i,a,n,l,h,d),null==this._grid._dataList.getColumnID(e)&&this._grid.notifyCellChanged(m,b),s.f.fireEvent(this._grid,"onchange",t,b,i,y),"radio"==C.options.inputType&&C.options.groupName&&C.options.trueValue==i&&(C.resetOthers(t),this._grid.radioGroupRepChk[C.options.groupName]&&this.setCellData(t,C.options.groupName,C.options.groupValue)),this._grid.radioGroupRepChk[C.options.id]){for(var R=this._grid.getColumnCount(),D=0;D<R;D++){var T=this._grid.cellInfoHash[this._grid.tdIdList[D]]||{options:{}};if("radio"==T.options.inputType&&T.options.groupName==C.options.id&&T.options.groupValue==i){this.setCellData(t,D,T.options.trueValue,a,n,l,h,d);break}}D==R&&this._grid._resetRadioGroup(t,C.id,!1)}if(this._grid.isDrillDown)if(this._grid.drilldown.options.depthColumn==b)this._grid.notifyDataChanged({keepTop:!0}),0==this._grid.getDataLength()&&this._grid.removeFocusedCell(),this._grid.setScrollYHeight();else if("checkbox"==C.options.inputType&&C.options.setRecursive)for(var L=this._grid.drilldown.getChildRowArr(t,!0),k=0;k<L.length;k++)this._getData(L[k],b)!=i&&this._setCellData(L[k],b,i,r,a,n,l,h,d)}else null==this._grid.editedCell||r||this._grid.notifyCellChanged(m,b)}}catch(t){o.Y.printStackTrace(t)}},
n.prototype.__setCellData=function(t,e,i,s,r,a,n){try{var l;e=this._grid.getColumnID(e);this._grid._linkedDataList?(l=this._grid._linkedDataList.filteredRowIndexArr[t],"number"!=typeof t&&(t=l)):l=this._grid.dataList.getRealRowIndex(t),this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList&&(t=l),this._setCellData(t,e,i,null,s,r,a,n)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList.setOriginalCellData(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype._setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList._setOriginalCellData(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setColumnDefaultValue=function(t,e){try{t=this._grid.getColumnID(t);this._grid._dataList.setColumnDefaultValue(t,e)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.setRowData=function(t,e,i){try{this._grid._dataList.setRowData(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setDataFile=function(t,e){try{t=this._grid._dataList.toArray(t);for(var i,s=[],r=0;r<this._grid.oneRowDataLength;r++){"expression"==(n=this._grid.getCellInfo(r)).options.inputType&&s.push(r)}i=t.length/this._grid.oneRowDataLength;for(r=0;r<s.length;r++)for(var a=0;a<i;a++){t[p=a*this._grid.oneRowDataLength+parseInt(s[r],10)]=""}for(r=0;r<this._grid.oneRowDataLength;r++){var n,l=(n=this._grid.getCellInfo(r)).options.dataType;if("select"==n.options.inputType){var h=[];for(a=0;a<n.itemArr.length;a++){h[(d=n.itemArr[a]).label]=d.value}for(a=0;a<i;a++){t[p=a*this._grid.oneRowDataLength+r]=h[t[p]]}}else if("checkcombobox"==n.options.inputType){for(h=[],a=0;a<n.itemArr.length;a++){var d;h[(d=n.itemArr[a]).label]=d.value}for(a=0;a<i;a++){for(var p=a*this._grid.oneRowDataLength+r,u=[],c=t[p].split(n.separator),g=0;g<c.length;g++)u.push(h[c[g]]);t[p]=u.join(n.separator)}}if(""!=n.options.displayFormat)for(a=0;a<i;a++){var f,m=t[p=a*this._grid.oneRowDataLength+r],y=n.options.displayFormat;f="number"==l||"bigDecimal"==l?WebSquare.text.unformatCurrency(y,m):"date"==l?WebSquare.text.unformatDate(y,m):"time"==l?WebSquare.text.unformatTime(y,m):WebSquare.text.unformatText(y,m),t[p]=f}}this._grid._dataList.setData(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setData=function(t,e,i){try{this._grid._dataList.setData(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.insertData=function(t,e){try{this._grid._dataList.insertData(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype._insertData=function(t,e,i){try{this._grid._dataList._insertData(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDataLength=function(){try{var t;if(this._grid.successBinding)if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var e in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[e])return this._grid._dataList.getDataLength();t=this._grid.groupbyStatus.groupedRowIndexArr.length}else t=this._grid._dataList.getDataLength();else t=0;return t}catch(t){o.Y.printStackTrace(t)}},n.prototype.setRowXML=function(t,e,i){try{this._grid._dataList.setRowXML(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setXML=function(t,e,i){try{if("grid"==this._grid.initializeType&&i&&i.ref&&(this._grid.options.ref=i.ref,this._grid._dataList.options.ref=i.ref,i.baseNode&&(this._grid.options.baseNode=i.baseNode,this._grid._dataList.options.baseNode=i.baseNode),i.repeatNode&&(this._grid.options.repeatNode=i.repeatNode,this._grid._dataList.options.repeatNode=i.repeatNode),i.aliasDataCollection&&(this._grid.options.aliasDataCollection=i.aliasDataCollection,this._grid._dataList.options.aliasDataCollection=i.aliasDataCollection),this._grid._setRef(),this._grid._dataList.repeatNodeTagName=this.repeatNodeTagName),null==t)return void a.v.printLog("[WebSquare.uiplugin.mappingController.setXML] XML is null["+this.id+"]");var s=this._grid.xmlData2ArrData(t)
;if(void 0===s)return void a.v.printLog("[WebSquare.uiplugin.mappingController.setXML] DataArray which converted from XML is undefined.["+this.id+"]");this.setData(s,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.insertXML=function(t,e){try{this._grid._dataList.insertXML(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setJSON=function(t,e){try{if(null==t)return void a.v.printLog("[WebSquare.uiplugin.mappingController.setJSON] JSON is null["+this.id+"]");var i=this._grid.jsonData2ArrData(t);if(void 0===i)return void a.v.printLog("[WebSquare.uiplugin.mappingController.setJSON] DataArray which converted from JSON is undefined.["+this.id+"]");this.setData(i,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setRowJSON=function(t,e,i){try{this._grid._dataList.setRowJSON(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.insertJSON=function(t,e){try{this._grid._dataList.insertJSON(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.rowMoveUp=function(t){try{this._grid._dataList.rowMoveUp(t)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.rowMoveDown=function(t){try{this._grid._dataList.rowMoveDown(t)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.rowMoveUpFiltered=function(t){try{this._grid._dataList.rowMoveUpFiltered(t)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.rowMoveDownFiltered=function(t){try{this._grid._dataList.rowMoveDownFiltered(t)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.insertRow=function(t,e){try{e=e||{};return this._grid.options.insertIntoSortedRow&&(e.insertIntoSortedRow=this.options.insertIntoSortedRow),"grid"==this.initializeType&&this.options.ref&&1==this.repeatNodeTagNameFilter&&(t=null),this._grid._dataList.insertRow(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.removeRow=function(t,e){try{return this._grid._dataList.removeRow(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.removeRows=function(t){try{return this._grid._dataList.removeRows(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.removeAll=function(){try{return this._grid._dataList.removeAll()}catch(t){o.Y.printStackTrace(t)}},n.prototype.removeRange=function(t,e){try{return this._grid._dataList.removeRange(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.reform=function(){try{this._grid._dataList.reform()}catch(t){o.Y.printStackTrace(t)}},n.prototype.undoRow=function(t){try{this._grid._dataList.undoRow(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype._undoRow=function(t){try{this._grid._dataList._undoRow(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.undoAll=function(){try{this._grid._dataList.undoAll()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowStatusValue=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatusValue(e)}catch(t){o.Y.printStackTrace(t)}},n.prototype._getRowStatusValue=function(t){try{return this._grid._dataList._getRowStatusValue(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowStatus=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatus(e)}catch(t){o.Y.printStackTrace(t)}},n.prototype._getRowStatus=function(t){try{return this._grid._dataList._getRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRowIndexByStatus=function(t){try{return this._grid._dataList.getRowIndexByStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.getInsertedIndex=function(){try{return this.getRowIndexByStatus("C")}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUpdatedIndex=function(){try{return this.getRowIndexByStatus("U")}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDeletedIndex=function(){try{return this.getRowIndexByStatus("DV")}catch(t){o.Y.printStackTrace(t)}},n.prototype.getOnlyDeletedIndex=function(){try{return this.getRowIndexByStatus("D")}catch(t){o.Y.printStackTrace(t)}},n.prototype.getVoidIndex=function(){try{return this.getRowIndexByStatus("V")}catch(t){o.Y.printStackTrace(t)}},n.prototype.getModifiedIndex=function(){try{return this.getRowIndexByStatus("CUD")
}catch(t){o.Y.printStackTrace(t)}},n.prototype.getInsertedData=function(){try{return this._grid._dataList.getInsertedData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getInsertedXML=function(){try{return this._grid._dataList.getInsertedXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getInsertedJSON=function(){try{return this._grid._dataList.getInsertedJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getInsertedArray=function(){try{return this._grid._dataList.getInsertedArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDeletedData=function(){try{return this._grid._dataList.getDeletedData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDeletedXML=function(){try{return this._grid._dataList.getDeletedXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDeletedJSON=function(){try{return this._grid._dataList.getDeletedJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getDeletedArray=function(){try{return this._grid._dataList.getDeletedArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRemovedXML=function(){try{return this._grid._dataList.getRemovedXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRemovedJSON=function(){try{return this._grid._dataList.getRemovedJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getRemovedArray=function(){try{return this._grid._dataList.getRemovedArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getVoidData=function(){try{return this._grid._dataList.getVoidData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getVoidXML=function(){try{return this._grid._dataList.getVoidXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getVoidJSON=function(){try{return this._grid._dataList.getVoidJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getVoidArray=function(){try{return this._grid._dataList.getVoidArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getOnlyDeletedData=function(){try{return this._grid._dataList.getOnlyDeletedData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getOnlyDeletedXML=function(){try{return this._grid._dataList.getOnlyDeletedXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getOnlyDeletedJSON=function(){try{return this._grid._dataList.getOnlyDeletedJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getOnlyDeletedArray=function(){try{return this._grid._dataList.getOnlyDeletedArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUpdatedData=function(){try{return this._grid._dataList.getUpdatedData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUpdatedXML=function(){try{return this._grid._dataList.getUpdatedXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUpdatedJSON=function(){try{return this._grid._dataList.getUpdatedJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getUpdatedArray=function(){try{return this._grid._dataList.getUpdatedArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getModifiedData=function(){try{return this._grid._dataList.getModifiedData()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getModifiedXML=function(){try{return this._grid._dataList.getModifiedXML()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getModifiedJSON=function(){try{return this._grid._dataList.getModifiedJSON()}catch(t){o.Y.printStackTrace(t)}},n.prototype.getModifiedArray=function(){try{return this._grid._dataList.getModifiedArray()}catch(t){o.Y.printStackTrace(t)}},n.prototype._setRowStatus=function(t,e){try{return this._grid._dataList._setRowStatus(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype._initRowStatus=function(t){try{this._grid._dataList._initRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.initRowStatus=function(t){try{this._grid._dataList.initRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype._createRowStatus=function(t){try{this._grid._dataList._createRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype._updateRowStatus=function(t){try{this._grid._dataList._updateRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.removeRowStatus=function(t){try{
return this._grid._dataList.removeRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.deleteRow=function(t){try{this._grid._dataList.deleteRow(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype._deleteRowStatus=function(t){try{this._grid._dataList._deleteRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.undeleteRow=function(t){try{this._grid._dataList.undeleteRow(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype._undeleteRowStatus=function(t){try{this._grid._dataList._undeleteRowStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.modifyAllStatus=function(t){try{this._grid._dataList.modifyAllStatus(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.modifyRangeStatus=function(t,e,i){try{var r=[],a=this.getDataLength()+1;if(0<=t&&e<a)for(var n=t;n<e;n++){var l=this.getRealRowIndex(n),h=this._setRowStatus(l,i);i!=h&&r.push({rowIndex:n,newRowStatus:i,oldRowStatus:h})}s.f.fireEvent(this,"onrowstatuschange",r),this.broadcast({gridView:["notifyModifyRangeStatus",[t,e,i]]})}catch(t){o.Y.printStackTrace(t)}},n.prototype.modifyMatchedStatus=function(t,e,i){try{this._grid._dataList.modifyMatchedStatus(t,e,i)}catch(t){o.Y.printStackTrace(t)}},n.prototype.modifyRowStatus=function(t,e){try{this._grid._dataList.modifyRowStatus(t,e)}catch(t){o.Y.printStackTrace(t)}},n.prototype.setColumnFilter=function(t,e,i,s){try{"object"!=typeof t||r.Z.isString(t)||(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.setColumnFilter(t,e,i,s):this._grid._dataList.setColumnFilter(t,e,i,s)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.removeColumnFilter=function(t){try{t=this._grid.getColumnID(t);this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilter(t,{internal:!0}):this._grid._dataList.removeColumnFilter(t,{internal:!0})}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.clearSortFilter=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSortFilter():this._grid._dataList.clearSortFilter()}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.removeColumnFilterAll=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilterAll():this._grid._dataList.removeColumnFilterAll()}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.setFilter=function(t){try{if(this._grid._linkedDataList)t.internal=!0,this._grid._linkedDataList.setFilter(t);else{if(t){var e=this._grid.getColumnID(t.sortIndex),i=this._grid.cellInfoHash[e]||{options:{}};if(t.isExpressionArr=[],t.cellInfoArr=[],t.gridId=this._grid.id,i&&"expression"==i.options.inputType&&"gridView"==this._grid.initializeType&&isNaN(this._grid._dataList.getColumnIndex(t.sortIndex))&&(t.fakeExpressionArr=this._grid.getFakeExpressionArr()),e){var s=e.split(" "),r=[];t.isCustomCol=[],t.sortLabel=[];for(var a=0;a<s.length;a++){i=this._grid.cellInfoHash[s[a]];var n=!1;if("custom"!=i.options.inputType||i.internal?"expression"==i.options.inputType?(t.isExpression=!0,t.isExpressionArr.push(!0)):t.isExpressionArr.push(!1):(n=!0,t.isExpressionArr.push(!1)),t.cellInfoArr.push(s[a]),n)if(t.isCustomCol.push(!0),t.customSortItemsetIdObj=[],i.options.sortLabel){for(var l=this.getTotalRow(),h={},d={},p=0;p<l;p++){var u=i.cellManagerHashByRowIndex[p]?i.cellManagerHashByRowIndex[p]:i;if("select"==u.options.inputType||"autoComplete"==u.options.inputType){var c=u.dataComp;if(c&&!h[c])"linkedDataList"==(g=this._grid.modelControl.getDataComp(c)).initializeType?h[c]=g._dataList.getAllJSON():h[c]=g.getAllJSON();d[p]=c,t.customSortItemsetIdObj[p]={label:u.itemsetObj.label,value:u.itemsetObj.value}}else d[p]=""}t.customCellDataListInfo=d,t.customDataListInfoHash=h,t.sortLabel.push(!0)}else r[a]=[],t.sortLabel.push(!1);else if(t.isCustomCol.push(!1),!i.options.sortLabel||"select"!=i.options.inputType&&"autoComplete"!=i.options.inputType)r[a]=[],t.sortLabel.push(!1);else{var g
;if(i.dataComp)"linkedDataList"==(g=this._grid.modelControl.getDataComp(i.dataComp)).initializeType?r[a]=g._dataList.getAllJSON():r[a]=g.getAllJSON();else r[a]=i.getItemArray();t.sortItemsetIdObj={label:i.itemsetObj.label,value:i.itemsetObj.value},t.sortLabel.push(!0)}}r.length>0&&(t.sortItemArr=r)}}t.internal=!0,this._grid._dataList.setFilter(t),"outfocus"==t.focuseMode&&this._grid.setScrollTop(0)}}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.removeFilter=function(t,e){try{t&&(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.removeFilter(t,e):this._grid._dataList.removeFilter(t,e)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.clearFilter=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.clearFilter(t):this._grid._dataList.clearFilter(t)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.sort=function(t,e){try{this._grid._linkedDataList?this._grid._linkedDataList.sort(t,e):this._grid._dataList.sort(t,e)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.clearSort=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSort():(this._grid._dataList.clearSort(),"outfocus"==this._grid.options.filterFocusMode&&this._grid.setScrollTop(0))}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.multisort=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.multisort(t):this._grid._dataList.multisort(t)}catch(t){o.Y.printStackTrace(t,null,this)}},n.prototype.setMatchIgnoreCase=function(t){try{return this._grid._dataList.setMatchIgnoreCase(t)}catch(t){o.Y.printStackTrace(t)}},n.prototype.mappingCommonAPI=function(){try{this._grid._getData=this._getData,this._grid._getRowData=this._getRowData,this._grid._setCellData=this._setCellData,this._grid._setOriginalCellData=this._setOriginalCellData,this._grid._insertData=this._insertData,this._grid._undoRow=this._undoRow,this._grid._getRowStatusValue=this._getRowStatusValue,this._grid._getRowStatus=this._getRowStatus,this._grid._setRowStatus=this._setRowStatus,this._grid._createRowStatus=this._createRowStatus,this._grid._updateRowStatus=this._updateRowStatus,this._grid._deleteRowStatus=this._deleteRowStatus,this._grid._undeleteRowStatus=this._undeleteRowStatus,this._grid.getRowJSON=this.getRowJSON,this._grid.getRowCount=this.getRowCount,this._grid.getCellData=this.getCellData,this._grid._getCellData=this._getCellData,this._grid.getOriginalCellData=this.getOriginalCellData,this._grid.getColData=this.getColData,this._grid.getRowData=this.getRowData,this._grid.getDataRow=this.getDataRow,this._grid.getMatchedData=this.getMatchedData,this._grid.getUnmatchedData=this.getUnmatchedData,this._grid.getMatchedColumnData=this.getMatchedColumnData,this._grid.getUnmatchedColumnData=this.getUnmatchedColumnData,this._grid.getMatchedIndex=this.getMatchedIndex,this._grid.getUnmatchedIndex=this.getUnmatchedIndex,this._grid.getRangeData=this.getRangeData,this._grid.getAllData=this.getAllData,this._grid.getColumnDistinctDataArray=this.getColumnDistinctDataArray,this._grid.getRangeXML=this.getRangeXML,this._grid.getMatchedXML=this.getMatchedXML,this._grid.getUnmatchedXML=this.getUnmatchedXML,this._grid.getRowXML=this.getRowXML,this._grid.getAllXML=this.getAllXML,this._grid.getRowJSON=this.getRowJSON,this._grid.getAllJSON=this.getAllJSON,this._grid.getRangeJSON=this.getRangeJSON,this._grid.getMatchedJSON=this.getMatchedJSON,this._grid.getUnmatchedJSON=this.getUnmatchedJSON,this._grid.getRowStatusValue=this.getRowStatusValue,this._grid.getRowStatus=this.getRowStatus,this._grid.getRowIndexByStatus=this.getRowIndexByStatus,this._grid.getInsertedIndex=this.getInsertedIndex,this._grid.getUpdatedIndex=this.getUpdatedIndex,this._grid.getDeletedIndex=this.getDeletedIndex,this._grid.getModifiedIndex=this.getModifiedIndex,this._grid.getInsertedData=this.getInsertedData,this._grid.getInsertedXML=this.getInsertedXML,this._grid.getInsertedJSON=this.getInsertedJSON,this._grid.getDeletedData=this.getDeletedData,
this._grid.getDeletedXML=this.getDeletedXML,this._grid.getDeletedJSON=this.getDeletedJSON,this._grid.getVoidData=this.getVoidData,this._grid.getVoidXML=this.getVoidXML,this._grid.getVoidJSON=this.getVoidJSON,this._grid.getOnlyDeletedData=this.getOnlyDeletedData,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedJSON=this.getOnlyDeletedJSON,this._grid.getUpdatedData=this.getUpdatedData,this._grid.getUpdatedXML=this.getUpdatedXML,this._grid.getUpdatedJSON=this.getUpdatedJSON,this._grid.getModifiedData=this.getModifiedData,this._grid.getModifiedXML=this.getModifiedXML,this._grid.getModifiedJSON=this.getModifiedJSON,this._grid.setMatchIgnoreCase=this.setMatchIgnoreCase}catch(t){o.Y.printStackTrace(t,null,this)}}}}]);