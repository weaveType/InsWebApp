"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[7867],{7867:function(t,e,i){i.r(e),i.d(e,{cellInfo:function(){return G},drilldown:function(){return M},gridView:function(){return B},headerInfo:function(){return D},linkedMappingController:function(){return N},mappingController:function(){return O.b}});var o=i(5461),s=i(8971),r=i(5375),a=i(1204),n=i(2406),l=i(2284),h=function(){};h.prototype._notifySettedGridDataAll=function(t,e){try{this.dataList.clearFilter(!0),t||(this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.extraData={grid:{},row:[],col:[],cell:[]},e=0,this._removeAllTDCellClass(),this._removeAllTRClass(),this._cellSelectedIndex=[],this.hiddenRowObj.init&&this.clearRowVisible({noDraw:!0})),this.hasFooter&&(this.footerTempSum=[]),this.beforeDataLength=-1,1==this.isDrillDown&&(this.setCellInfo(),1==this.isPaste?this.initPasteDrilldown():this.initDrilldown()),this.initStyleArr(e),this.lastTopRowIndex=null,this.loadFlag=!0,this.settedData=!0}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySettedGridData=function(t,e,i,o,r,a){try{if(this.options.scrollFix&&this.settedData){for(var n=this.getTopRowIndex(),l=0;l<=this.lastIndex;l++){var h=n+l;this.drawRowData(h-this.rowIndex,h)}return}this.dataList.clearFilter(!0),this._oldFilterArrStr||this.notifyClearFilter(!0),this.settedData=!1;i=i;var d=[];if(!(e=e||!1)&&this.hiddenRowObj.init)for(var u in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[u]&&d.push(u);this._notifySettedGridDataAll(e,i),0==this.loadFlag&&e?this.loadFlag=!1:this.loadFlag=!0,this.lastTopRowIndex=null;var p={gridData:!0!==a};if(e&&(p.append=!0,p.keepTop=!0),this.notifyDataChanged(p),!e)for(l=0;l<d.length;l++)this.setRowVisible(d[l]);this.loadFlag=!0,0==this.getTotalRow()&&this.removeFocusedCell(),this.options.focusOnSetData&&this._setFocusedCell(0,0),!0!==this._isBrowserScroll()&&this.setScrollYHeight(),this.settedData=!0,this.options.fixedRightColumn>0&&this._handleScrollX(),(!e&&this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0),(!0===r||this.options.instanceBindBySetData)&&this.options.ref&&this._refreshInstance(t,e),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeSettedCellData=function(){try{if(null!=this.editedCell)return this.options.keepEditMode&&"onclick"==this.options.editModeEvent&&(this._reEditCell={_editTd:this.editedCell.editTd,_rowIndex:this.editedCell.editRowIndex}),void this.editedCell.handleEndEdit()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySettedCellData=function(t,e,i,o){try{this.hasFooter&&(this.footerTempSum=[]);var r=this.getColumnIndex(e);t=this._getGroupbyGroupedRowIndex(t);this.notifyCellChanged(t,r,o),null==r&&null!=this._dataList.getColumnIndex(e)&&this._refreshExpression(t,e),this.isDrillDown&&(null==r&&this._dataList.options.depthColumn&&(r=this._dataList.getColumnIndex(e)),this.drilldown.options.depthColumn==r&&(this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight()));var n=a.Z.getDataPrefix("colMerged"),l=this.getCellInfo(e),h=t,d=this.getTotalRow();if(l&&l.options.colMerge&&l.options.colMergeEdit&&!this.groupbyStatus.grouped){var u=this.data_td_list[(h-this.rowIndex)*this.oneRowDataLength+r];if(u){var p,c=u.getAttribute(n);if("1"==c&&i!=this.dataList.getCellData(h-1,r))if(u.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex,h,r),h<d-1)(p=this.data_td_list[(h-this.rowIndex+1)*this.oneRowDataLength+r])&&(i==this.dataList.getCellData(h+1,r)?p.setAttribute(n,"1"):p.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex+1,h+1,r))
;if("0"==c)if(h>=1&&i==this.dataList.getCellData(h-1,r)&&(u.setAttribute(n,"1"),this.drawCellData(h-this.rowIndex,h,r)),h<d-1)(p=this.data_td_list[(h-this.rowIndex+1)*this.oneRowDataLength+r])&&(i==this.dataList.getCellData(h+1,r)?p.setAttribute(n,"1"):p.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex+1,h+1,r))}}this._reEditCell&&this._reEditCell._editTd&&(this.editMode=!0,this.setCellEditMode(this._reEditCell._editTd,this._reEditCell._rowIndex),this._reEditCell={}),this.moveDirection=null,!0===this._isHybridScroll()&&this._setHybridVisibleHeight()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeInsertedRow=function(t){try{!this.isDrillDown&&t>this.getDataLength()&&(t=this.getDataLength());var e=!1,i=[];if(this.isDrillDown){for(var o=this.drilldown.getParentRowIndex(t);o>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(o))||(e=!0,i.push(o)),o=this.drilldown.getParentRowIndex(o);if(e)for(var r=i.length-1;r>=0;r--)if(!this.drilldown.isOpen(i[r])){var a=this.drilldown.getDisplayRowIndex(i[r]);this._toggle(a)}}}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyAfterInsertedRow=function(t,e){try{var i=function(t,e,i){var o=i,s=[],r=t.length;for(var a in t)if(!isNaN(a)){var n=Number(a);n>=e&&s.push(n)}s.sort((function(t,e){return e-t}));for(var l=0;l<s.length;l++){var h=s[l];t[h+o]=t[h],delete t[h]}t.length=r+o};this.settedData=!1;var o=this.dataList.getRealRowIndex(t),r=this.getTotalCol();this.resetExpressionFunc();var a=o*r;i(this.cellStyleArr,a,r),i(this.cellClassArr,a,r),i(this.cellReadOnlyArr,a,r),i(this.cellDisabledArr,a,r),i(this._cellSelectedIndex,a,r),this.rowClassArr.splice(t,0,null),this.extraData.row.splice(t,0,null),this.extraData.cell.splice(t,0,null);for(var n=this.getColumnCount(),l=0;l<n;l++){var h=this.getCellInfo(l);if("custom"==h.options.inputType){var d=this.getDataLength();h.isValidTypeGetter||(h.cellManagerHashByRowIndex.splice(o,0,null),h.cellManagerIDByRowIndex.splice(o,0,null),h.cellManagerInfoByRowIndex.splice(o,0,null));for(var u=d;u>o;u--){var p=h.cellManagerHashByRowIndex[u];if(p){var c,g=h.cellManagerIDByRowIndex[u];c=p.options.embeddedInput?this.id+"_"+g:h.mainGridId+g,this._removeDom(c),h.isValidTypeGetter||(h.cellManagerHashByRowIndex[u]=null,h.cellManagerIDByRowIndex[u]=null)}}}}if(this.isDrillDown&&this.drilldown.statusArr.splice(o,0,!0),this.hasFooter&&(this.footerTempSum=[]),this._mergeNotifyRowChanged("insertRow",t),!0!==e&&(this.notifyRowInserted(t),this.notifyStatusChanged({rowIndex:[t]})),this.options.ref&&1!=this.insertRowByInstance&&!0!==e&&this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){var f;f=1==this.repeatNodeTagNameFilter&&1==this.repeatNodeTagName.length?this.filteredRepeatNodeTagName[0]:this.repeatNodeTagName[0];var m,y=WebSquare.xml.parse("<"+f+"></"+f+">").documentElement,b=y,v=f;this.repeatNodeTagName.length>1&&(v=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(l=1;l<this.repeatNodeTagName.length;l++)b=WebSquare.xml.createNode(b,this.repeatNodeTagName[l],!1);m=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(y,v):y;for(l=0;l<this.repeatNodeChildTagName.length;l++)WebSquare.xml.createNode(m,this.repeatNodeChildTagName[l],!1);t>=this.maxRowLength?WebSquare.ModelUtil.setInstanceNode(y,this.options.ref,null,"append",!1,this.scope_id):WebSquare.ModelUtil.setInstanceNode(y,this.options.ref+"/"+f+"["+(t+1)+"]",null,"insertBeforeSibling",!1,this.scope_id)}return this.settedData=!0,this.loadFlag=null==this.loadFlag||this.loadFlag,this._refreshColumnClass(),this._autoFitRefreshNative(),t}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeRemovedRow=function(t){try{if(this.options.ref&&1!=this.removeRowByInstance){var e=this.getRealRowIndex(t)+1;WebSquare.ModelUtil.removeInstanceNode(this.options.ref+"/"+this.repeatNodeTagName[0]+"["+e+"]",!1,this.scope_id)}if(this.isDrillDown&&this._dataList.options.depthColumn){
for(var i=!1,o=[],r=this.drilldown.getParentRowIndex(t);r>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(r))||(i=!0,o.push(r)),r=this.drilldown.getParentRowIndex(r);if(i)for(var a=o.length-1;a>=0;a--)if(!this.drilldown.isOpen(o[a])){var n=this.drilldown.getDisplayRowIndex(o[a]);this._toggle(n)}t=this.drilldown.getDisplayRowIndex(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeKeepFilter=function(){try{var t=this._dataList.getFilterList();if(t.length<=0||isNaN(t.length))return;this._oldFilterArrStr=JSON.stringify(t,(function(t,e){return"function"==typeof e||e&&"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e})),this.customFilterStatusObj&&(this._oldStatusObj=JSON.stringify(this.customFilterStatusObj)),this.customFilterList&&this.customFilterList.customFilterListFilterInfo?this._oldFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e})):this.groupbyStatus.grouped&&this.groupbyStatus.filter&&(this._oldFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e})))}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyAfterKeepFilter=function(){try{if(!this._oldFilterArrStr)return;this._refreshCustomFilterHistory(this._oldFilterArrStr,this._oldFilterInfo,this._oldStatusObj),this._oldFilterArrStr=null,this._oldFilterInfo=null,this._oldStatusObj=null,this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyAfterRemovedRow=function(t,e,i,o){try{var r=function(t,e,i){if(!(e>t.length)){var o=Math.min(i,t.length-e),s=[];for(var r in t)if(!isNaN(r)){var a=Number(r);a>=e&&a<e+o?delete t[r]:a>=e+o&&s.push(a)}s.sort((function(t,e){return t-e}));for(var n=0;n<s.length;n++){var l=s[n];t[l-o]=t[l],delete t[l]}t.length-=o}};this.removed=!0,this.isDrillDown&&this.drilldown.statusArr.splice(i,1);var n=this.getTotalCol(),l=n*i;r(this.cellStyleArr,l,n),r(this.cellClassArr,l,n),r(this.cellReadOnlyArr,l,n),r(this.cellDisabledArr,l,n),r(this._cellSelectedIndex,l,n),this.rowClassArr.splice(i,1);for(var h=this.getColumnCount(),d=0;d<h;d++){var u=this.getCellInfo(d);if("custom"==u.options.inputType){var p=this.getDataLength(),c=u.cellManagerHashByRowIndex[i];if(c){var g,f=u.cellManagerIDByRowIndex[i];if(g=c.options.embeddedInput?this.id+"_"+f:u.mainGridId+f,this._removeDom(g),u.isValidTypeGetter&&(delete u.cellManagerHashByID[f],delete u.cellManagerHashByRowIndex[i],delete u.cellManagerIDByRowIndex[i],i<p)){for(var m=i;m<p;m++)u.cellManagerHashByRowIndex[m]=u.cellManagerHashByRowIndex[m+1],u.cellManagerIDByRowIndex[m]=u.cellManagerIDByRowIndex[m+1];delete u.cellManagerHashByRowIndex[p],delete u.cellManagerIDByRowIndex[p]}}u.isValidTypeGetter||(u.cellManagerInfoByRowIndex.splice(i,1),u.cellManagerHashByRowIndex.splice(i,1),u.cellManagerIDByRowIndex.splice(i,1))}}if(this.itemValueObj)for(var y in this.itemValueObj){var b=o.split(",")[this._dataList.bodyIdColIndexMap[y]];for(var v in this.itemValueObj[y])-1!=v.indexOf("auto")&&this.itemValueObj[y][v]===b&&(this.itemValueObj[y][v]="")}if(!0!==e){var w=this.checkScrollEnd,C=this.scrollEvent;if(this.checkScrollEnd=!1,this.scrollEvent=!1,this._getFocusedRowIndex()==this.getDataLength()){var I=this._getFocusedRowIndex(),_=this.getFocusedColumnIndex();this.removeRowFocus(this.getDataLength()),this._setFocusedCell(I-1,_)}this.resetExpressionFunc(),this.hasFooter&&(this.footerTempSum=[]),this._mergeNotifyRowChanged("removeRow",t),this.notifyRowChanged(t),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.notifyStatusChanged({rowindex:[t]}),a.Z.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e,this._autoFitRefreshNative()}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[w,C]})}}catch(t){s.Y.printStackTrace(t,null,this)}},
h.prototype.notifyRemovedRows=function(t,e){try{if(!0!==e){var i=this.checkScrollEnd,o=this.scrollEvent;this.checkScrollEnd=!1,this.scrollEvent=!1,this.resetExpressionFunc();for(var r=t.split(","),n=0;n<r.length;n++)this._mergeNotifyRowChanged("removeRow",r[n]);this.notifyRowChanged(),a.Z.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[i,o]}),this._autoFitRefreshNative()}}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRemovedAll=function(t){try{this.removed=!0;var e=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this.clearCellVisible({skipDraw:!0}),this.loadFlag=!0,this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.cellReadOnlyArr=[],this.cellDisabledArr=[],this.extraData={grid:{},row:[],col:[],cell:[]},this._removeAllTDCellClass(),this._removeAllTRClass(),this._cellSelectedIndex=[],this.resetExpressionFunc();for(var i=this.getTotalCol(),o=0;o<i;o++){var r=this.getCellInfo(o);if(r&&r.options&&"expression"==r.options.inputType)for(var a=this.drawedRowLength,n=0;n<a;n++)r.options.expressionFunc&&r.options.expressionFunc[n]&&(r.options.expressionFunc[n]={});else if("custom"==r.options.inputType){for(var l=0;l<r.cellManagerIDByRowIndex.length;l++){var h,d=r.cellManagerHashByRowIndex[l],u=r.cellManagerIDByRowIndex[l];h=d.options.embeddedInput?this.id+"_"+u:r.mainGridId+u,this._removeDom(h)}r.isValidTypeGetter?(r.cellManagerHashByID={},r.cellManagerHashByRowIndex={},r.cellManagerIDByRowIndex={}):(r.cellManagerInfoByRowIndex=[],r.cellManagerHashByRowIndex=[],r.cellManagerIDByRowIndex=[])}}this.removeFocusedCell();for(o=0;o<this.dataRowList.length;o++){var p=this.dataRowList[o];p.style.display="none",this.__addClass(p,"w2grid_hidedRow"),this.__hasClass(p,"w2grid_lastRow")&&this.__removeClass(p,"w2grid_lastRow")}this.lastDisplayedRow=-1,this.subtotalHidden(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.maxRowLength=0,this.displayNoResultMessage(),this.drawFooter();var c={sortIcon:this.options.hideSortIconOnNoData};this.drawHeader(void 0,c),this._setCheckboxHead(),0==this.getDataLength()&&(this.removeFocusedCell(),"all"===this.options.visibleRowNum&&this.setSize(null,this.defaultDataLayerHeight)),this.setScrollYHeight(),this.displayFixedColumnLine(),this.options.ref&&1!=this.removeRowByInstance&&WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],gridNoRefresh:!0,scopeId:this.scope_id}),this.options.groupbyFilterBox&&!1!==t&&this.clearFilterHistory(),1==this.isDrillDown&&this.initDrilldown(),this.itemValueObj={},this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRemovedRange=function(t){try{this.removed=!0,this.notifyRowChanged(t)}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyCreatedRowStatus=function(t){try{var e=function(t,e,i){var o=i,s=[],r=t.length;for(var a in t)if(!isNaN(a)){var n=Number(a);n>=e&&s.push(n)}s.sort((function(t,e){return e-t}));for(var l=0;l<s.length;l++){var h=s[l];t[h+o]=t[h],delete t[h]}t.length=r+o};e(this.rowStyleArr,t,1),e(this.rowReadOnlyArr,t,1),e(this.rowDisabledArr,t,1),e(this.rowStyleFixedArr,t,1),e(this.rowStyleDataArr,t,1)}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyRemovedRowStatus=function(t){try{var e=function(t,e,i){if(!(e>t.length)){var o=Math.min(i,t.length-e),s=[];for(var r in t)if(!isNaN(r)){var a=Number(r);a>=e&&a<e+o?delete t[r]:a>=e+o&&s.push(a)}s.sort((function(t,e){return t-e}));for(var n=0;n<s.length;n++){var l=s[n];t[l-o]=t[l],delete t[l]}t.length-=o}};e(this.rowStyleArr,t,1),e(this.rowReadOnlyArr,t,1),e(this.rowDisabledArr,t,1),e(this.rowStyleFixedArr,t,1),e(this.rowStyleDataArr,t,1)}catch(t){s.Y.printStackTrace(t)
}},h.prototype.notifyDeleteRow=function(t){try{if(this.getFocusedRowIndex()===t&&this.removeFocusedCell(),!0!==this.options.hideDeletedRow||this.groupbyStatus.grouped||this.isDrillDown){this._drawRowStatus(t-this.rowIndex,t);for(var e=0;e<this.oneRowDataLength;e++)this._drawCellStatus(t-this.rowIndex,t,e)}else this.setRowVisible(t,!1);this.displayNoResultMessage(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var i=0;i<this.getColCnt();i++){var o=this.getColumnID(i),r=this.expressionAssArr[o];if(null!=r)for(e=0;e<r.length;e++){var a=this.getColumnIndex(r[e]);this.drawCellData(t-this.rowIndex,t,a)}}}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyUndeleteRow=function(t){try{if(!0!==this.options.hideDeletedRow||this.groupbyStatus.grouped||this.isDrillDown){this._drawRowStatus(t-this.rowIndex,t);for(var e=0;e<this.oneRowDataLength;e++)this._drawCellStatus(t-this.rowIndex,t,e)}else this.setRowVisible(t,!0);this.displayNoResultMessage(),this.displayFixedColumnLine(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var i=0;i<this.getColCnt();i++){var o=this.getColumnID(i),r=this.expressionAssArr[o];if(null!=r)for(e=0;e<r.length;e++){var a=this.getColumnIndex(r[e]);this.drawCellData(t-this.rowIndex,t,a)}}}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyReformed=function(){try{if(this.options.rowStatusVisible)for(var t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)this._drawRowStatus(e,this.rowIndex+e);if(this.options.cellStatusVisible)for(t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)for(var i=0;i<this.oneRowDataLength;i++)this._drawCellStatus(e,this.rowIndex+e,i)}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyModifyAllStatus=function(t){try{for(var e=0;e<this.getDataLength();e++)this._drawRowStatus(e-this.rowIndex,e);this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:"all"})}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyModifyRangeStatus=function(t,e,i){try{var o=this.getDataLength();if(0<=t&&e<=o)for(var r=t;r<=e;r++)this._drawRowStatus(r-this.rowIndex,r);this.displayNoResultMessage(),this.notifyStatusChanged({startIndex:t,endIndex:e})}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyModifyRowStatus=function(t,e){try{t>-1&&t<this.getDataLength()&&(this._drawRowStatus(t-this.rowIndex,t),this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:[t]}))}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifyModifyMatchedStatus=function(t,e,i){try{for(var o=[],r=this.getDataLength(),a=0;a<r;a++){var n=this.getColumnID(t),l=this.dataList.getRealRowIndex(a);if(this.dataList._getCellData(l,n)+""==e+"")i!=this.dataList._setRowStatus(l,i)&&o.push(a),this._drawRowStatus(a-this.rowIndex,a),this.displayNoResultMessage()}this.notifyStatusChanged({rowIndex:o})}catch(t){s.Y.printStackTrace(t)}},h.prototype.notifySetColumnDefaultValue=function(t,e){try{this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySettedData=function(t){try{this.groupbyStatus.grouped&&this.clearGroupby(),this.loadCheck=[],t||this.options.focusOnSetData||this.removeFocusedCell()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySetRowXML=function(t,e){e?this.notifyRowChanged(t):this.notifyRowInserted(t)},h.prototype.notifyRowMoveUp=function(t){try{var e=this.extraData.row[t-1];this.extraData.row[t-1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t-1],this.extraData.cell[t-1]=this.extraData.cell[t],this.extraData.cell[t]=e;var i=t-1,o=t;this._swapStyle(o,i),this._getFocusedRowIndex()==t&&this._setFocusedCell(t-1,this.getFocusedColumnIndex()),this.notifyRowChanged(t-1)}catch(t){
s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRowMoveDown=function(t){try{var e=this.extraData.row[t+1];this.extraData.row[t+1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t+1],this.extraData.cell[t+1]=this.extraData.cell[t],this.extraData.cell[t]=e;var i=t+1,o=t;this._swapStyle(o,i),this._getFocusedRowIndex()==t&&this._setFocusedCell(t+1,this.getFocusedColumnIndex()),this.notifyRowChanged(t)}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype._swapStyle=function(t,e){try{for(var i=this.getColCnt(),o=0;o<this.getColCnt();o++){this._swapArr(this.cellStyleArr,t*i+o,e*i+o),this._swapArr(this.cellReadOnlyArr,t*i+o,e*i+o),this._swapArr(this.cellDisabledArr,t*i+o,e*i+o),this._swapArr(this._cellSelectedIndex,t*i+o,e*i+o);var r=this.getCellClass(t,o),a=this.getCellClass(e,o);(r||a)&&(this.setCellClass(t,o,a),this.setCellClass(e,o,r))}this._swapArr(this.rowStyleArr,t,e),this._swapArr(this.rowReadOnlyArr,t,e),this._swapArr(this.rowDisabledArr,t,e),this._swapArr(this.rowStyleFixedArr,t,e),this._swapArr(this.rowStyleDataArr,t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRowModified=function(t){try{this.changeCount++,this.drawRowData(t-this.rowIndex,t),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyStatusChanged=function(t){try{var e,i,o=!1;"object"==(0,l.A)(t.rowIndex)?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getDataLength()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var r=e;r<i;r++){var a;if(a=o?t.rowIndex[r]:r,null!=this.rowStatusColIDArr)for(var n=0;n<this.rowStatusColIDArr.length;n++){var h=this.getColumnIndex(this.rowStatusColIDArr[n]);this.drawCellData(a-this.rowIndex,a,h)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySaveFocusedCell=function(){try{this.focusedCellInfo.beforeFocusedCell=!(0==this.focusedCell.length),this.focusedCellInfo.beforeFocusedCell&&(this.focusedCellInfo.beforeFocusedCellRealRowIndex=this.dataList.getRealRowIndex(this.focusedCell[0].focusedRowIndex),this.focusedCellInfo.beforeFocusedCellRealColumnIndex=this.focusedCell[0].focusedColIndex)}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySetFocusedCell=function(t){try{var e=this.options.filterFocusMode,i=this.focusedCellInfo.beforeFocusedCellRealRowIndex;if("outfocus"!==e&&"infocus"!==e){if(this.focusedCellInfo.beforeFocusedCell)for(var o=0;o<this.getDataLength();o++)if(this.dataList.getRealRowIndex(o)==i){this._setFocusedCell(o,this.focusedCellInfo.beforeFocusedCellRealColumnIndex,!1,{isSort:t,dont_fixScroll:"fixScrollX"===e});break}}else"outfocus"==e&&this.outFocusedCell();this.focusedCellInfo={}}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySettedFilter=function(t){try{var e=t&&t.isSort,i=t&&t.fiteredColID;if(this.notifySetFocusedCell({isSort:e}),e&&this.syncWithSortStatus(),this.groupbyStatus.grouped)for(var o in this.customFilterStatusObj)if(this.customFilterStatusObj[o]){this.rowNumArr=[];for(var r=0;r<this.getDataLength();r++)this.rowNumArr.push(r);break}1==this.isDrillDown&&this._linkedDataList&&(this.setCellInfo(),this.initDrilldown());var a=!t||!1!==t.keepTop,n=[];if(this.hiddenRowObj.init){for(var l in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[l]&&n.push(l);this.clearRowVisible({noDraw:!0})}if(this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:a}),0==this.getDataLength()&&this.removeFocusedCell(),!0!==(a&&!0===this._isHybridScroll())&&this.setScrollYHeight(),e&&!this.groupbyStatus.grouped&&this.drawHeaderSortImages(),i&&!e&&this.options.useFilterList){var h=this.bodyToHeaderRelation[i];if(h){
var d=this.getElementById(this.id+"_"+h+"_filter");d&&WebSquare.style.addClass(d,"w2grid_customFilter_filter")}}for(r=0;r<n.length;r++)this.setRowVisible(n[r]);this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifySettedFilterByUser=function(t){try{if(this.options.useFilterListSync){var e=t.colID,i=JSON.parse(t.oldFilteredRowIndexArr),o=JSON.parse(t.newFilteredRowIndexArr);if(this.groupbyStatus.grouped);else if(this.options.useFilterList){this.customFilterList||this.createCustomFilterList(null,!0),this.customFilterList.filterHistory.column[0]!==e&&(this.customFilterList.filterHistory.column.unshift(e),this.customFilterList.filterHistory.filteredRowIndexArr.unshift(i));var r=this.dataList.getColData(e,o),a=this.getUniqueValueOfArray(r),n=this.changeItemValue("label",e,a);this.customFilterList.customFilterListFilterInfo||(this.customFilterList.customFilterListFilterInfo={}),this.customFilterList.customFilterListFilterInfo[e]=[];for(var l=0;l<n.length;l++){var h=n[l],d=this;"string"==typeof h&&(h=h.replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return d.replacechar(t)}))),this.customFilterList.customFilterListFilterInfo[e].push(h)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeClearSort=function(){try{this.notifySaveFocusedCell(),this.clearHeaderSort()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyClearSortFilter=function(){try{var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex();this.syncWithSortStatus(),this.rowNumArr=null,this.applyFocusedCellOut(),this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),"infocus"==this.options.filterFocusMode&&this._setFocusedCell(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeSettedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyAfterSettedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeRemovedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyAfterRemovedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRemovedFilter=function(t){try{!0===t&&this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null,!0!==this._isHybridScroll()&&this.setScrollYHeight(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyClearFilter=function(t){try{this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),t||(this.adjustDraw_keepTop=!0,this.notifyDataChanged({keepTop:!0}),this.adjustDraw_keepTop=null),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null;var e={};for(var i in!0===t&&!0===this._isHybridScroll()&&(e.skipResize=!0),this.setScrollYHeight(e),this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.itemValueObj={},this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterList.customFilterListFilterInfo={}),this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),
this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyMultisort=function(){try{this.syncWithSortStatus(),this.drawHeaderSortImages()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBeforeInitDataList=function(){try{this.removeAllFinish=!0}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyAfterInitDataList=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj(),1==this.isDrillDown&&this.initDrilldown(),this.removeAllFinish=!1,this.initColumns(),this._autoFitRefreshNative()}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRefresh=function(t){try{!this.startedDisplayNone&&this.rowIndex>=0&&(t&&this.setDataTable(),this._mergeRefresh(),this.drawData(this.rowIndex,0),t&&this.setScrollYHeight(),this.displayNoResultMessage(),this.displayFixedColumnLine())}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyRowPositionChanged=function(t){try{if(this.groupbyStatus.grouped)return;if("number"!=typeof t)return;if("style"!==this.options.syncRowPositionOption&&"focus"!==this.options.syncRowPositionOption)return;if(("cell"===this.options.focusMode||"row"===this.options.focusMode||"both"===this.options.focusMode)&&t<this.getRowCount()){var e,i=this.getLastFocusedCell();if("cell"===this.options.focusMode){if(!i)return;e=i.focusedColIndex}else e=i.focusedColIndex||0;this.applyFocusedCellOut(),this.focusedCell=[],this.isDrillDown&&this._dataList.options.depthColumn&&this.completed&&this.drillTo(t),!0!==this.hiddenRowObj.row[t]&&this.setFocusedCell(t,e,!1,{dataListRowPositionChanged:!0})}}catch(t){s.Y.printStackTrace(t,null,this)}},h.prototype.notifyBroadcast=function(t){try{t=t||{},this.isDrillDown&&!0!==t.skipInitDrilldown&&this.initDrilldown(),this.notifyDataChanged(t)}catch(t){s.Y.printStackTrace(t,null,this)}};var d,u=i(4980),p=i(2338),c=i(2256),g=i(3406),f=function(){};f.prototype.toHTML=function(){try{var t=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/mainZIndex/@value")||"10",e=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/xScrollZIndex/@value")||"20",i=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/yScrollZIndex/@value")||"15";if(this.uncompleted)return;var o=[],a="scroll"===this.options.overflowY,n=(this._isHybridScroll(),"overflow:hidden"),l=!0===this.options.scrollXNative?"display:none;":"",h=!0===this._isNativeScroll()?"visibility:hidden;":"",d=this.options.title?" title='"+this.options.title.wq_replaceAll("'","&#39;")+"'":"",u=this.options.moreButtonTitle?this.options.moreButtonTitle.wq_replaceAll("'","&#39;"):WebSquare.language.getMessage("Grid_more_Button")||"more",p=u?" title='"+u+"'":"",c="none"==this.options.focusMode||"linear"==this.options.focusFlow?"":" tabIndex='0'",g=this.options.scrollFocus?" tabIndex='0'":"",f=""==this.options.style?"style='"+n+";'":"style='"+this.options.style+";"+n+";'",m=this.options.readOnly?" w2grid_readonly_outer":"",y=function(t){return this._useRole()?" role='"+t+"' ":""};if(o.push("<div id='"+this.id+"' class='w2grid "+this.options.className+m+"' "+f+d+c+">"),this.options.senseReader&&this.options.useStartEndDiv){var b=WebSquare.language.getMessage("Grid_dom_start")||"Grid start";o.push("<div id='"+this.id+"_gridstart_div' class='w2grid_start_div' tabindex='0'>"+b+"</div>")}if(this.options.groupbyZone&&this.options.groupbyFilterBox&&"top"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='top:0px;left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),
o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete" />'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+y.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),this.options.groupbyZone){var v="<div id='"+this.id+"_groupbyZone_div' class='w2grid_groupbyZone' style='width:0px; height:0px;'>",w="";this.options.groupbyZoneSearch&&(w="<div id='"+this.id+"_groupbyZone_search' class='w2grid_groupbyZone_search'></div>"),o.push(v+w+"</div>")}if(o.push("<div id='"+this.id+"_main_div' class='w2grid_main' style='z-index:"+t+";"+n+";position:absolute;left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px; top:0px; bottom:"+this.scrollLayerWidthSize+"px;float:left;'>"),o.push(this.mainDataGridLayout()),this.options.useMoreButton&&o.push("<button id='"+this.id+"_grid_more_button' class='w2_grid_more_button'"+p+"></button>"),o.push("</div>"),this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px; bottom:0px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main' >"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete"/>'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+y.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),o.push("<div id='"+this.id+"_scrollX_div' class='w2grid_scrollX' style='z-index:"+e+";overflow-x:hidden;overflow-y:hidden;position:absolute; height:0px; left:0px; right:"+(a?this.scrollWidthSize:"0")+"px; bottom:0px;"+l+"'>"),o.push(this.getScrollX()),o.push("</div>"),o.push("<div id='"+this.id+"_scrollY_div' class='w2grid_scrollY' style='z-index:"+i+";position:absolute; overflow-x:hidden;overflow-y:scroll;width:"+(a||!0===this._isNativeScroll()?this.scrollLayerWidthSize:"0")+"px; height: 100%;right:0px;"+h+"'"+g+">"),o.push(this.getScrollY()),o.push("</div>"),o.push("<div id='"+this.id+"_iScrollX' class='w2grid_iScrollX' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_iScrollY' class='w2grid_iScrollY' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_resize_line' class='w2grid_resize_line' style='display:none;position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px;'></div>"),this.options.useNoResultMessageURL?o.push("<div id='"+this.id+"_noresult' style='display:none;' class='w2grid_noresult'></div>"):o.push("<div id='"+this.id+"_noresult' style='display:none;position:absolute;"+this.options.noResultMessageStyle+"' class='"+this.options.noResultMessageClass+"'>"+this.options.noResultMessage+"</div>"),this.options.senseReader&&this.options.useStartEndDiv||1==this.options.moveKeyEditModeAll){var C=WebSquare.language.getMessage("Grid_dom_end")||"Grid end";o.push("<div id='"+this.id+"_gridend_div' class='w2grid_end_div' tabindex='0'>"+C+"</div>")}return o.push("</div>"),o.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getScrollY=function(){try{return"<div id='"+this.id+"_size_y' style='height:0px; position:absolute; top:0px; left:0px; width:18px;'></div>"}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getScrollX=function(){try{
for(var t=this.getFixedColumnLastIndex(),e=0,i=0;i<t;i++)this.hiddenList[i]||(e+=this.colWidthList[i]);var o=this.getFixedRightColumnLastIndex(),r=0;for(i=this.colWidthList.length-1;i>=o;i--)this.hiddenList[i]||(r+=this.colWidthList[i]);var a=this.options.scrollFocus?" tabIndex='0'":" tabIndex='-1'",n=[],l=this.options.fixedColumnScrollHidden?"hidden":"scroll";return n.push("<table id='"+this.id+"_scrollX_table' style='height:18px;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:100%'>"),n.push("<tr>"),n.push("<td id='"+this.id+"_scrollX_left' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+e+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:"+l+";overflow-y:hidden'></div>"),n.push("</td>"),n.push("<td style='border:0px solid orange;padding:0px 0px 0px 0px;height:18px;'>"),n.push("<div id='"+this.id+"_scrollX_right' style='height:18px;border:0px solid blue; overflow-x:scroll;overflow-y:hidden;padding:0px 0px 0px 0px;'"+a+">"),n.push("<div id='"+this.id+"_scroll_size' style='height:1px;width:"+parseInt(this.gridWidth-e-r)+"px'></div>"),n.push("</div>"),n.push("</td>"),n.push("<td id='"+this.id+"_scrollX_fixedRight' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+r+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:scroll;overflow-y:hidden'></div>"),n.push("</td>"),n.push("</tr>"),n.push("</table>"),n.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.mainDataGridLayout=function(){try{this.setTableStruct();var t=[];return t.push(this.getBodyTable()),t.push(this.getFooterTable()),this.setInitialCSS(),t.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setColArr=function(){try{this.colGroupArr=[],this.setColWidth(),this.gridWidth=0;var t,e,i=-1;if(this.options.rowStatusVisible){var o=40;this.options.rowStatusWidth.length>0&&(this.options.rowStatusWidth.indexOf("*")>-1?(o=this.options.rowStatusWidth,i++):this.options.rowStatusWidth-0>-1&&(o=this.options.rowStatusWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(this.options.rowNumVisible){o=40;this.options.rowNumWidth.length>0&&(this.options.rowNumWidth.indexOf("*")>-1?(o=this.options.rowNumWidth,i++):this.options.rowNumWidth-0>-1&&(o=this.options.rowNumWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(i>-1){this.autofitColumn=!0;for(var r=0;r<2;r++)this.colWidthList[r]&&"string"==typeof this.colWidthList[r]&&this.colWidthList[r].indexOf("*")>-1&&(this.autofitColumnIndexArr.push(r),this.autofitColumnWidthArr[r]=this.colWidthList[r])}if(this.isIE6or7){t=[],e=this.colIndexes.bodyColInfo.colSpanArr;var a=this.colIndexes.bodyColInfo.colIndexArr.length;for(r=0;r<a;r++)if(e[r])for(var n=0;n<e[r];n++)t[n]=!0}this.colGroupArr.push("<colgroup>");for(r=0;r<this.colWidthList.length;r++){null==this.colWidthList[r]&&(this.colWidthList[r]=70);var l=isNaN(this.colWidthList[r])?0:this.colWidthList[r];this.hiddenList[r]?l=0:(this.gridWidth+=l,this.isIE6or7&&(r<this.defaultColCnt||!t[r])&&(l--,r==this.defaultColCnt&&l--)),this.colGroupArr.push("<col id='colGroupID_"+r+"' style='width:"+l+"px;white-space:nowrap' />")}this.colGroupArr.push("</colgroup>")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setCss=function(){try{if(this.options.headerTableClass=this.struct.head.attr.class||"gridHeaderTableDefault",this.options.headerTrClass=this.struct.head.attr.rowClass||"gridHeaderTRDefault",this.options.headerTdClass=this.struct.head.attr.columnClass||"gridHeaderTDDefault",this.options.bodyTableClass=this.struct.body.attr.class||"gridBodyTableDefault",this.options.bodyTrClass=this.struct.body.attr.rowClass||"gridBodyTRDefault",this.options.bodyTdClass=this.struct.body.attr.columnClass||"gridBodyDefault",
a.Z.isIEAllVersion()&&!0===this._isNativeScroll()?this.options.gridNativeClass="gridNativeIE":this.options.gridNativeClass="gridNative",this.options.gridHybridClass="gridHybrid",this.hasFooter&&(this.options.footerTableClass=this.struct.foot.attr.class||"gridFooterTableDefault",this.options.footerTrClass=this.struct.foot.attr.rowClass||"gridFooterTRDefault",this.options.footerTdClass=this.struct.foot.attr.columnClass||"gridFooterTDDefault"),this.hasSubtotal){this.options.subtotalTrClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.rowClass||"gridSubtotalTRDefault",this.options.subtotalTdClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.columnClass||"gridSubtotalDefault";for(var t=0;t<this.struct.subtotalArr.length;t++)if(this.struct.subtotalArr[t].attr.subtotalClass){this.subtotalClassList=[];break}if(this.subtotalClassList)for(t=0;t<this.struct.subtotalArr.length;t++){var e=this.struct.subtotalArr[t].attr.subtotalClass||"gridSubtotalDefault";this.subtotalClassList.push(e)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setInitialCSS=function(){try{this.options.oddEvenColorDisplay&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" .evenTd","background-color:"+this.options.evenRowBackgroundColor),WebSquare.cssStyleSheet.addRule("#"+this.id+" .oddTd","background-color:"+this.options.oddRowBackgroundColor)),this.rowStyleIndex=0,this.cellStyleIndex=0,this.readOnlyTdStyle="",this.readOnlyTdImg="",this.disabledTdStyle="",this.rowOverStyle="",""!=this.options.readOnlyBackgroundColor&&(this.readOnlyTdStyle="background-color:"+this.options.readOnlyBackgroundColor),""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(this.options.readOnlyBackgroundImgCSS?this.readOnlyTdImg=this.options.readOnlyBackgroundImgCSS:this.readOnlyTdImg="background:url("+this.options.readOnlyBackgroundImg+") no-repeat center center; background-size: cover"),""!=this.options.disabledBackgroundColor&&(this.disabledTdStyle="background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(this.disabledTdStyle=""!=this.disabledTdStyle?this.disabledTdStyle+";":"",this.disabledTdStyle+="color:"+this.options.disabledFontColor),""!=this.options.rowNumBackgroundColor&&WebSquare.cssStyleSheet.addRule("#"+this.id+" ."+this.options.bodyTdClass+"_rowNumber","background-color:"+this.options.rowNumBackgroundColor),this.options.rowMouseOver&&(this.rowOverStyle="background-color:"+this.options.rowMouseOverColor),-1!=this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultHeaderCellHeight+"px"),-1!=this.options.defaultCellHeight&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" td."+this.options.bodyTdClass,"height:"+this.options.defaultCellHeight+"px"),-1==this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultCellHeight+"px"))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getGridClassName=function(t,e){try{return null==t||""==t?e:t}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.grid2TableXml=function(t){try{var e=WebSquare.Elem.api.getElementsByTagName(this.element,t,r.I._XML_NAMESPACE.W2);return e.length>0?this.oneGrid2TableXml(e[0]):null}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.xml2JSON=function(t){try{var e={attr:{},rowArr:[],rowAttrArr:[]};e.attr=WebSquare.Parser.parseAttribute(t);for(var i=WebSquare.Elem.api.getElementsByTagName(t,"row",r.I._XML_NAMESPACE.W2),o=0;o<i.length;o++){e.rowAttrArr[o]=WebSquare.Parser.parseAttribute(i[o]);for(var a=WebSquare.Elem.api.getElementsByTagName(i[o],"column",r.I._XML_NAMESPACE.W2),n=[],l=0;l<a.length;l++){var h=WebSquare.Parser.parseAttribute(a[l]);h["@xml"]=a[l],n.push(h)}e.rowArr.push(n)}return e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.oneGrid2TableXml=function(t){try{
var e=WebSquare.xml.serialize(t),i=e.indexOf("w2:header")>=0?"th":"td";return e=(e=(e=(e=(e=e.wq_replaceAll("w2:header",this.options.fixPrint?"tbody":"thead")).wq_replaceAll("w2:gBody","tbody")).wq_replaceAll("w2:footer","tbody")).wq_replaceAll("w2:row","tr")).wq_replaceAll("w2:column",i),WebSquare.xml.parse(e)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setColWidth=function(){try{var t=this.getColCnt();this.colWidthList=[],this.autoFitColWidthList=null,this.hiddenList=[],this.hiddenAdaptiveList=[];for(var e=0;e<t;e++)this.colWidthList[e]=null,this.hiddenList[e]=!1,this.hiddenAdaptiveList[e]=!1;this.initializeTableInfo()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getColCnt=function(){try{for(var t=0,e=this.htmlInfo?this.htmlInfo.head.rowArr[0]:this.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.initializeTableInfo=function(){try{var t=this,e=function(e){if(null==e)return null;for(var i=[],o=[],s=[],r=[],a=[],n=e.rowArr,l=[],h=0;h<n.length;h++){for(var d=[],u=0;u<t.colWidthList.length;u++)d.push(!1);l.push(d)}var p=0;t.options.rowNumVisible&&(i.push(0),s.push(0),r.push(n.length),a.push([p++])),t.options.rowStatusVisible&&(i.push(!0===t.options.rowNumVisible?1:0),s.push(0),r.push(n.length),a.push([p++]));for(h=0;h<n.length;h++){var c=n[h],g=0;for(u=0;u<c.length;u++){for(var f=c[u],m=parseInt(f.colSpan||1),y=parseInt(f.rowSpan||1);void 0!==l[h][g]&&l[h][g];)g++;f.colIndex=g+t.defaultColCnt,i.push(g+t.defaultColCnt),s.push(h),r.push(y);var b=f.width||"";if(m>1){if("string"==typeof b&&b.indexOf("*")>-1){t.autofitColumn=!0;for(var v=0;v<m;v++){var w=g+v;t.colWidthList[w]=b,t.autofitColumnWidthArr[w+t.defaultColCnt]=b,t.autofitColumnIndexArr.push(w+t.defaultColCnt)}}o[i.length-1]=m}if(1==m&&null==t.colWidthList[g])if("string"==typeof b&&b.indexOf("*")>-1){t.autofitColumn=!0;w=g;t.colWidthList[w]=b,t.autofitColumnIndexArr.push(w+t.defaultColCnt),t.autofitColumnWidthArr[w+t.defaultColCnt]=b}else t.colWidthList[g]=parseInt(b||0);for(var C=0;C<m;C++){a[g+t.defaultColCnt+C]||(a[g+t.defaultColCnt+C]=[]),a[g+t.defaultColCnt+C].push(p),l[h][g+C]=!0,"true"==f.hidden&&(t.hiddenList[g+C]=!0);for(var I=1;I<y;I++)l[h+I][g+C]=!0}p++,delete f.hidden}}return{colIndexArr:i,colSpanArr:o,trIndexArr:s,rowSpanArr:r,colIndexMatch:a}};if(this.colIndexes={headerColInfo:e(this.struct.head),bodyColInfo:e(this.struct.body),footerColInfo:e(this.struct.foot)},this.hasSubtotal){this.colIndexes.subtotalColInfo=[];for(var i=0;i<this.struct.subtotalArr.length;i++){var o=e(this.struct.subtotalArr[i]);this.colIndexes.subtotalColInfo.push(o),this.colIndexes.subtotalColInfo[this.struct.subtotalArr[i].attr.targetColumnID]=o}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getFooterTable=function(){try{if(!this.hasFooter)return"";this.hasFooter=!0;var t="";this.options.footerSummary?t=this.options.footerSummary?" summary='"+this.options.footerSummary.wq_replaceAll("'","&#39;")+"'":"":this.options.captionTitle&&this.options.footerSummaryAuto&&(t=" summary='"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"'"),"html5"==WebSquare.docType&&(t="");var e="";if(e="<table id='"+this.id+"_foot_table' class='"+this.options.footerTableClass+"' style='position:absolute; bottom:0px; table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px;'"+t+">",this.options.footerCaption?e+="<caption>"+this.options.footerCaption+"</caption>":this.options.captionTitle&&this.options.footerCaptionAuto&&(e+="<caption>"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"</caption>"),e+=this.getColGroup(this.id+"_col_footer"),a.Z.isSafari()||a.Z.isChrome()&&a.Z._getChromeVersion()<94)this._checkHeaderColSpan(this.htmlInfo.foot.rowArr)||(e+="<thead><tr></tr></thead>");else if(a.Z.isIE()){for(var i="",o=0;o<this.getColCnt();o++)i+="<td></td>"
;e+="<thead style='visibility:collapse;'><tr>"+i+"</tr></thead>"}e+=this.getTableHtml(this.htmlInfo.foot,"tbody","td",this.options.footerTdClass),e+="</table>";var r=a.Z.getDataPrefix("or_wd="),n=a.Z.getDataPrefix("dis="),l=a.Z.getDataPrefix("width=");return e=(e=e.wq_replaceAll(l,r)).wq_replaceAll("disabled=",n)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getBodyTable=function(){try{var t="width:"+this.gridWidth+"px;'";this.isIE6or7&&(t="'");var e="";this.options.summary&&"html5"!=WebSquare.docType&&(e=" summary = '"+(this.element.getAttribute("summary")||"").wq_replaceAll("'","&#39;")+"' ");var i="",o=!0===this._isNativeScroll()?"auto":"hidden",r=!0===this.options.scrollXNative?"auto":"hidden",n="";!0===this._isNativeScroll()?n=" "+this.options.gridNativeClass:!0===this._isHybridScroll()&&(n=" "+this.options.gridNativeClass+" "+this.options.gridHybridClass);var l=!0===this._isBrowserScroll()?"":" border-collapse:collapse";if(this.options.fixedColumnLineDiv?(i="<div id='"+this.id+"_fixedColumnDiv' style='display:none;' class='w2grid_fixedcolumn_line_div' tabindex='-1'></div>",i+="<div id='"+this.id+"_fixedRightColumnDiv' style='display:none;' class='w2grid_fixedrightcolumn_line_div' tabindex='-1'></div>",i+="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:"+r+";overflow-y:"+o+";'>"):i="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:"+r+";overflow-y:"+o+";'>",!0===this.options.accessibility&&(i+="<span id='"+this.id+"_sort_info' class='w2grid_head_sort_info' role='alert'></span>"),i+=this.getGridHeaderFillerTable(this.headerXml,this.options.headerTdClass,this.options.headerTrClass,this.id+"_head_table",this.options.headerTableClass),i+="<table id='"+this.id+"_body_table' class='"+this.options.headerTableClass+n+"' style='position:absolute;left:0px;top:0px;table-layout:fixed;"+l+"; border-spacing:0px;"+t+e+">",this.captionXml){var h=WebSquare.xml.parse("<caption/>"),d=null,u=WebSquare.Parser.parseAttribute(this.captionXml);for(var p in u){if("id"==p){var c=u[p];c&&h.documentElement.setAttribute("id",this.id+"_"+c)}else h.documentElement.setAttribute(p,u[p]);"value"==p&&(d=u[p])}if(d)h.documentElement.appendChild(h.createTextNode(d)),h.documentElement.removeAttribute("value");else for(var g=this.captionXml.getChildNodes(),f=0;f<g.length;f++)if(3===g[f].getNodeType()){var m=h.createTextNode(g[f].getNodeValue());h.documentElement.appendChild(m)}i+=WebSquare.xml.noNameSpaceSerialize(h)}if(this.isWebKit){if(!this.captionXml){var y="transparent",b="0";try{for(f=0;f<document.styleSheets.length;f++){var v=document.styleSheets[f];try{v.cssRules}catch(t){continue}for(var w=0;v.cssRules&&w<v.cssRules.length;w++){var C=v.cssRules[w];if(C.selectorText=="."+this.options.headerTableClass){y=C.style["border-top-color"],b=parseInt(C.style["border-top-width"])/2,f=document.styleSheets.length;break}}}}catch(t){s.Y.printStackTrace(t,null,this)}i+="<caption style='height:"+b+"px;background-color:"+y+";'></caption>"}a.Z.isSafari()||a.Z.isChrome()&&a.Z._getChromeVersion()<94?(i+=this.getColGroup(this.id+"_col_body"),this._checkHeaderColSpan(this.htmlInfo.head.rowArr)||(i+="<thead><tr></tr></thead>")):i+=this.getColGroup(this.id+"_col_body")}else i+=this.getColGroup(this.id+"_col_body");i+=this.getTableHtml(this.htmlInfo.head,"thead","th",this.options.headerTdClass),n="",!0===this._isBrowserScroll()&&(n=" class='"+this.options.gridNativeClass+"'"),i+="<tbody id='"+this.id+"_body_tbody'"+n+"></tbody>",i+="</table>",i+="</div>";var I=a.Z.getDataPrefix("or_wd="),_=a.Z.getDataPrefix("width=");return i=i.wq_replaceAll(_,I)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._checkHeaderColSpan=function(t){try{var e=!0;if(1==t.length)for(var i=t[0],o=0;o<i.length;o++){if((parseInt(i[o].colspan)||parseInt(i[o].colSpan)||1)>1)return!1}else e=!1;return e}catch(t){
s.Y.printStackTrace(t,null,this)}},f.prototype.getTableInfo=function(t,e,i){try{var r=o.q.extend({},t.attr),a=[],n=t.rowAttrArr||[{}],l=t.rowArr;r.id=this.id+"_"+e+"_tbody",r.style="";for(var h=0;h<l.length;h++){a.push([]);for(var d=0;d<l[h].length;d++){var u=o.q.extend({},l[h][d]);if(u.class=e+" "+e+"_data",this.isIE6or7){var p=parseInt(u.colSpan||"1"),c=parseInt(u.colIndex);if(p>1){for(var g=1;g<p;g++)0!=this.hgap[i+"_"+c]&&(this.hgap[i+"_"+(c+g)]=!0);this.hgap[i+"_"+c]=!0}else this.hgap[i+"_"+c]=!1}var f=u.textAlign,m=u.style?u.style+";":"";m=m+"text-align:"+(f||"center"),u.style=m,a[h].push(u)}}return{attr:r,rowArr:a,rowAttrArr:n}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getBodyHtmlInfo=function(){try{var t=this.options.bodyTdClass,e=this.options.bodyTrClass,i=this.getTableInfo(this.struct.body,t,e),o=i.attr,a=i.rowArr,n=i.rowAttrArr;this.oneRowLength=a.length,this.oneRowDataLength=0,this.tdIdList=[],this.bodyIdColIndexMap={},this._bodyIdMultiRowIndexMap={},this.colMoveIndexMap={};for(var l=0,h={},d=0;d<a.length;d++){n[d].trIndex=d,this.oneRowDataLength+=a[d].length;for(var u=0;u<a[d].length;u++){var p=a[d][u],g=p.style.split(";");if(g.length>0)for(var f=0;f<g.length;f++)if(g[f].indexOf(":")>-1){try{var m=g[f].split(":")[0].wq_trim(),y=g[f].split(":")[1].wq_trim();this.options.useDefaultStyle?this.setDefaultStyle(l,m,y):"text-align"!==m||p.textAlign?this.setColumnStyle(l,m,y):this._setInitStyle(l,m,y)}catch(t){s.Y.printStackTrace(t,null,this)}if(!this.options.applyAllColumnStyle)break}var b=this.options.adaptiveStyle||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/adaptiveStyle/@value");if("none"==this.options.adaptiveStyle&&(b=""),b=p.adaptiveStyle||b,"none"==p.adaptiveStyle&&(b=""),b){var v=b.split(";");if(v.length>0)for(var w=0;w<v.length;w++)if(v[w].indexOf(":")>-1)try{var C=v[w].split(":")[0].wq_trim(),I=v[w].split(":")[1].wq_trim();this.setAdaptiveColumnStyle(l,C,I)}catch(t){s.Y.printStackTrace(t,null,this)}}"textarea"==p.inputType&&"all"==p.displayType&&(p.style+=";word-break:break-all;white-space:normal;");var _=p.id;if(null==p.col_id?(p.col_id=_,p.id=this.id+"_"+_,p["@xml"]=p["@xml"].cloneNode(!0),p["@xml"].setAttribute("col_id",_),p["@xml"].setAttribute("id",this.id+"_"+_)):_=p.col_id,this._setCellInfo(_,p["@xml"]),this.bodyIdColIndexMap[_]=l,this._bodyIdMultiRowIndexMap[_]=d,0==d&&(this.colMoveIndexMap[_]=l),h[_]){var x=WebSquare.language.getMessage("E_comp_duplicated_Msg",_)||"id["+_+"] was used repeatedly. Check the source code.";$l(x)}else h[_]=_;this.tdIdList.push(_),""===_&&c.v.printLog("warning : The "+this.id+" column name for column index "+l+" is missing."),l++}}return{attr:o,rowArr:a,rowAttrArr:n}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getHeaderHtmlInfo=function(){try{var t=this.options.headerTdClass,e=this.options.headerTrClass,i=this.getTableInfo(this.struct.head,t,e),o=i.attr,r=i.rowArr,a=i.rowAttrArr,n=[];this.thIdList=[],this.colMoveHeaderIndexMap={},o.id=this.id+"_head_table",o.class=this.options.headerTableClass;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.head.attr.style);l&&2==l.length&&(this.headerHeight=parseInt(l[1])),o.style=this.options.hideHeader?"display:none":"",this.headCellInfoHash={};for(var h=0;h<r.length;h++){n.push([]);for(var d=0;d<r[h].length;d++){var u=r[h][d],p=null,c=u.inputType,g=u.dataType,f=u.value;if(void 0!==f&&null!=f||void 0!==(f=u.defaultValue)&&null!=f||(f=""),"checkbox"==c)p="<input type='checkbox' style='border:0px solid blue;background-color:transprent;' />";else if("select"==c){var m="";if(this.options.chooseOption){if(m=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(b=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(m=b)}else if(this.options.allOption){m=WebSquare.language.getMessage("Grid_all")||"-all-"}else if("json"!==u["@xml"]._elementType){
var y=(WebSquare.xml.serialize(u["@xml"]).match(/label\s*>[^<]+<\//)||"").toString();""!==y&&(m=y.slice(y.toString().indexOf(">")+1,-2))}p="<div style='width:100%;height:20px;top:0px;left:0px;position:relative;background-color:#ffffff' class='w2selectbox "+this.options.headerTdClass+" "+this.options.headerTdClass+"_data'><span style='display:none'></span><table class='w2selectbox_table_main'><tr class='w2selectbox_row w2selectbox_row_main'><td class='w2selectbox_col_label'><div class='w2selectbox_label'>"+m+"</div></td><td class='w2selectbox_col_button'></td></tr></table></div>"}else if("text"==c&&"own"==g)p="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";else{var b;if(this.options.useLocale&&u.localeRef)(b=this.getLocaleValue(u.localeRef))&&(f=b);f=null!=f?f:"";var v="";"span"==this.options.dataTag&&(v="class='w2grid_span'"),p="<"+this.options.dataTag+" "+v+" style='padding-top:0px; padding-left:4px;padding-right:4px' >"+f+this.dataTagClose}n[h].push(p),this.thIdList.push(u.id),this.headCellInfoHash[u.id]=u["@xml"],this._setHeaderInfo(u.id,u["@xml"]),null==u.col_id&&(u.col_id=u.id)}}return{attr:o,rowArr:r,rowAttrArr:a,headerTdHtml:n}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getFooterHtmlInfo=function(){try{for(var t=this.options.footerTdClass,e=this.options.footerTrClass,i=this.getTableInfo(this.struct.foot,t,e),o=i.attr,r=i.rowArr,a=i.rowAttrArr,n=0;n<r.length;n++)a[n]["data-trindex"]=n;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.foot.attr.style);return l&&2==l.length&&(this.footerHeight=parseInt(l[1])),{attr:o,rowArr:r,rowAttrArr:a}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getSubtotalHtmlInfo=function(t){try{var e=this.options.subtotalTdClass;this.subtotalClassList&&(e=t.attr.subtotalClass||"gridSubtotalDefault");for(var i=this.options.subtotalTrClass,o=this.getTableInfo(t,e,i),r=o.attr,a=o.rowArr,n=o.rowAttrArr,l=0;l<a.length;l++){n[l].trIndex=l,n[l].targetColumnID=r.targetColumnID;for(var h=0;h<a[l].length;h++)a[l][h].class=a[l][h].class+" "+this.id+"_subtotal__column"+h,delete a[l][h].hidden}return{attr:r,rowArr:a,rowAttrArr:n}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getTableHtml=function(t,e,i,r){try{var n=t.attr,l=t.rowArr,h=t.rowAttrArr,d=[],u="";if(!0===this._isBrowserScroll()){var p={};o.q.extend(p,n);var c=this.options.gridNativeClass;!0===this._isHybridScroll()&&"string"==typeof e&&"thead"===e.toLowerCase()&&(c=this.options.gridHybridClass),p.class?p.class+=" "+c:p.class=c,u=this.getAttributesString(p)}else u=this.getAttributesString(n);d.push("<"+e+u+">");var g="",f="";l.length>=2&&(g=!1===this.options.rowNumRowSpan?" rowSpan='1'":" rowSpan='"+l.length+"'",f=!1===this.options.rowStatusRowSpan?" rowSpan='1'":" rowSpan='"+l.length+"'");var m="";!0===this._isBrowserScroll()&&t===this.htmlInfo.head&&(m=" "+this.options.gridNativeClass);for(var y=a.Z.getDataPrefix("colIndex"),b=a.Z.getDataPrefix("value"),v=0;v<l.length;v++){t==this.htmlInfo.head?d.push("<tr"+this.getAttributesString(h[v])+" class='gridHeaderStyle_"+v+m+"'>"):t==this.htmlInfo.foot?d.push("<tr"+this.getAttributesString(h[v])+" class='gridFooterStyle_"+v+"'>"):d.push("<tr"+this.getAttributesString(h[v])+">");var w="",C="";t==this.htmlInfo.head&&(C=r+"_background ",w=this.options.rowNumHeaderValue),0==this.options.rowNumRowSpan&&this.options.rowNumVisible?v===l.length-1?d.push("<"+i+g+" class='"+r+" "+r+"_rowNumber "+C+"' "+b+"='"+w+"' "+y+"='0' id='_headerRowNumber'></"+i+">"):d.push("<"+i+g+" class='"+r+" "+r+"_rowNumber "+C+"' "+b+"='' "+y+"='0' id='_headerRowNumber'></"+i+">"):0===v&&this.options.rowNumVisible&&d.push("<"+i+g+" class='"+r+" "+r+"_rowNumber "+C+"' "+b+"='"+w+"' "+y+"='0' id='_headerRowNumber'></"+i+">");var I="";if(!1===this.options.rowStatusRowSpan){if(v===l.length-1)t==this.htmlInfo.head&&(I=this.options.rowStatusHeaderValue),
this.options.rowStatusVisible&&d.push("<"+i+f+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='"+I+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">");else if(this.options.rowStatusVisible)if(this.options.rowStatusColSpan&&0==v){var _=1;l[v][0].colSpan?_+=Number(l[v][0].colSpan):_++;var x=" colSpan='"+_+"'",S=l[v][0].value;d.push("<"+i+f+x+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='"+S+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else d.push("<"+i+f+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else 0==v&&(t==this.htmlInfo.head&&(I=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&d.push("<"+i+f+" class='"+r+" "+r+"_rowStatus "+C+"' "+b+"='"+I+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">"));for(var R=0;R<l[v].length;R++){if(r!==this.options.subtotalTdClass&&r!==this.options.footerTdClass||null==l[v][R].columnClass)if(this.subtotalClassList&&l[v][R].columnClass){for(var D=0;D<this.subtotalClassList.length;D++)if(this.subtotalClassList[D]&&r===this.subtotalClassList[D]){T=l[v][R].class;l[v][R].class=l[v][R].columnClass+" "+l[v][R].class,d.push("<"+i+this.getAttributesString(l[v][R])+">"),l[v][R].class=T;break}}else l[v][R].class=l[v][R].class+" "+C,d.push("<"+i+this.getAttributesString(l[v][R])+">");else{var T=l[v][R].class;l[v][R].class=l[v][R].columnClass+" "+l[v][R].class,d.push("<"+i+this.getAttributesString(l[v][R])+">"),l[v][R].class=T}t.headerTdHtml&&t.headerTdHtml[v][R]&&d.push(t.headerTdHtml[v][R]),d.push("</"+i+">")}d.push("</tr>")}return d.push("</"+e+">"),d.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getGridHeaderFillerTable=function(t,e,i,o,r){try{if(!this.options.headFiller)return"";var a=[],n="";return this.options.hideHeader&&(n="display:none"),a.push("<table class='"+this.options.headerTableClass+"' style='z-index:-1;position:absolute;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px; '>"),a.push("<tbody id='"+this.id+"_"+e+"_tbody_tmp' style='"+n+"' class='"+r+"'>"),a.push("<tr class='"+i+"'>"),a.push("<td style='' id='"+this.id+"_header_bg_td' class='"+e+" "+e+"_rowNumber'>&nbsp;</td>"),a.push("</tr>"),a.push("</tbody>"),a.push("</table>"),a.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getColGroup=function(t){try{return this.colGroupArr.join("").wq_replaceAll("colGroupID",t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.initializeLayoutEvents=function(){try{if(!0!==this.options.scrollXNative&&this.event.addListener2(this.getElementById(this.id+"_scrollX_right"),"onscroll",this.handleScrollX,this),!0!==this._isBrowserScroll()&&(this.event.addListener2(this.render,"onmousewheel",this.handleWheel,this),this.event.addListener2(document.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollY,this)),!0===this._isHybridScroll())if(this.event.addListener2(document.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollYHybrid,this),a.Z.isMobile())this.event.addListener2(document.getElementById(this.id+"_main_div"),"ontouchstart",this.handleTouchStartHybrid,this),this.event.addListener2(document.getElementById(this.id+"_main_div"),"ontouchmove",this.handleTouchMoveHybrid,this);else{var t="onwheel"in window?"onwheel":"onmousewheel";this.event.addListener2(document.getElementById(this.id+"_main_div"),t,this.handleWheelHybrid,this)}this.options.groupbyZone&&(this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onclick",this.handleGroupbyZoneClick,this),this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onmousedown",this.handleChangeGroupDepth,this)),this.options.resize&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousemove",this.event.bindAsEventListener(this,this.handleColumnResize)),
this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endColumnResize)),this.options.rowResize&&(this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousemove",this.event.bindAsEventListener(this,this.handleRowResize)),this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousedown",this.event.bindAsEventListener(this,this.doRowResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endRowResize))),a.Z.isIE()&&r.I.browserVersion()<=8&&this.event.addListener(this.render,"onmousemove",this.event.bindAsEventListener(this,(function(t){(this.resizeStarted||this.options.rowResize&&this.rowResizeStarted||null!=this.columnMoveTarget)&&p.f.preventDefault(t)})))),this.options.resize&&a.Z.isTouchDevice()&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchmove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchstart",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"ontouchend",this.event.bindAsEventListener(this,this.endColumnResize)))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleScrollX=function(t){try{var e=p.f.getTarget(t);e&&(this._scrollXPrev||(this._scrollXPrev={}),this._scrollXPrev.scrollLeft===e.scrollLeft&&this._scrollXPrev.scrollTop===e.scrollTop&&this._scrollXPrev.scrollWidth===e.scrollWidth&&this._scrollXPrev.scrollHeight===e.scrollHeight&&(this.scrollXPreventEndEdit=!0),this._scrollXPrev.scrollLeft=e.scrollLeft,this._scrollXPrev.scrollTop=e.scrollTop,this._scrollXPrev.scrollWidth=e.scrollWidth,this._scrollXPrev.scrollHeight=e.scrollHeight),r.I.clearTimer(this.id+"_completiveDrawData",!0),r.I.clearTimer(this.id+"_applyStyleOptions",!0),null==this.editedCell||this.scrollXPreventEndEdit||this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t]),this._handleScrollX(),this.scrollXPreventEndEdit&&this.editedCell&&this.editedCell.setPosition&&this.editedCell.setPosition(),this.scrollXPreventEndEdit=!1,p.f.fireEvent(this,"onscrollx",t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._handleScrollX=function(){try{this.body_table||(this.head_table=this.getElementById(this.id+"_head_table"),this.body_table=this.getElementById(this.id+"_body_table"),this.hasFooter&&(this.foot_table=this.getElementById(this.id+"_foot_table")),this.scrollX_right=this.getElementById(this.id+"_scrollX_right")),void 0!==this.colGroup&&null!=this.colGroup||(this.colGroup={},this.colGroup.bodyColList=this.body_table.getElementsByTagName("col"),this.hasFooter?this.colGroup.footerColList=this.foot_table.getElementsByTagName("col"):this.colGroup.footerColList=null);var t=0;if(this.options.scrollByColumn){var e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;e>1?t=1+Math.round(e):e<1&&(t=1+Math.round(1/e))}var i=this.getFixedColumnLastIndex(),o=this.scrollX_right.scrollLeft,r=this.gridWidth-o-t-this.fixedWidth-1-this.fixedWidthRight,n=r;r=r>0?r:0;var l=this.options.fixedRightColumn>0;if(!l){if(this.head_table.style.width=r+"px",this.isWebKit){for(var h=[],d=this.defaultColCnt;d<this.hiddenList.length;d++)1==this.hiddenList[d]&&h.push(d-this.defaultColCnt);(A=r-this.colGroup.bodyColList.length-h.length-1)<0&&(A=0),this.body_table.style.width=A+"px",this.hasFooter&&(this.foot_table.style.width=A+"px")}else this.body_table.style.width=r+"px",this.hasFooter&&(this.foot_table.style.width=r+"px");this.hasFooter&&(this.foot_table.style.width=r+"px")}var u=[],p=[],c=0,g=-1,f=0;if(l||this.options.scrollByColumn||a.Z.isIE(8)){var m=this._getScrollYWidth()-1
;if(c=(f=this.resizeObj&&this.resizeObj.clientWidth?this.resizeObj.clientWidth:this.render.clientWidth)-1-this.fixedWidth-this.fixedWidthRight,a.Z.isChrome()&&(c+=1),-1!=m&&(c-=m),l){this.options.scrollByColumn=!1;var y=f-1-m;y<this.gridWidth&&(this.head_table.style.width=f-1-m+"px",this.body_table.style.width=f-1-m+"px",this.hasFooter&&(this.foot_table.style.width=f-1-m+"px"))}}var b=this.getFixedRightColumnLastIndex(),v=l,w=-1;for(d=this.colWidthList.length-1;d>=b;d--)this.hiddenList[d]||(this.colGroup.bodyColList[d].style.width=this.colWidthList[d]+"px");for(d=b-1;d>=0;d--){var C=0,I=parseInt(this.colWidthList[d],10)||0;if(this.hiddenList[d]&&(I=0),l&&v)if(r>c+I)r-=I,I=0;else{var _=I;y<this.gridWidth&&(I-=r-c),r-=_,v=!1,w=d}else r>I?r-=I:(r>0&&n<=c&&(g=d,this.options.scrollByColumn&&(C=r)),I=r,r=0),d<i&&!this.hiddenList[d]&&(I=parseInt(this.colWidthList[d],10)||0);var x=0,S=0;if(this.isIE6or7&&0!=I&&(1==this.hgap[this.options.headerTrClass+"_"+d]?0:1,x=1==this.hgap[this.options.bodyTrClass+"_"+d]?0:1,this.hasFooter&&(S=1==this.hgap[this.options.footerTrClass+"_"+d]?0:1)),a.Z.isIE(8)&&0==this.defaultColCnt&&0==d&&0==I&&(I=1,g>=0&&(u[g]=u[g]-1,this.colGroup.bodyColList[g].style.width=u[g]+"px",this.hasFooter&&(p[g]=p[g]-1,this.colGroup.footerColList[g].style.width=p[g]+"px"))),this.options.scrollByColumn){var R=this.colWidthList[d];1==I&&a.Z.isIE(8)&&0==this.defaultColCnt&&0==d&&(R=1),0==I&&(R=0),C>0&&(R=C),w===d&&(R=0),(0==R||1==R||R==this.colWidthList[d]||C>0||w===d)&&(this.colGroup.bodyColList[d].style.width=R-x+"px",u[d]=R-x,this.hasFooter&&(this.colGroup.footerColList[d].style.width=R-S+"px",p[d]=R-S))}else this.hiddenList[d]&&(I=0),this.colGroup.bodyColList[d].style.width=I-x+"px",u[d]=I-x,this.hasFooter&&(this.colGroup.footerColList[d].style.width=I-S+"px",p[d]=I-S)}m=this._getScrollYWidth("offsetWidth");if(this.isWebKit&&-1==this.options.className.indexOf("w2gridViewItemTable")&&0===m&&"allColumn"===this.options.autoFit&&!this.options.autoFitMinWidth){var D=WebSquare.style.getSize(this.render,"outerwidth")-WebSquare.style.getSize(this.render,"width"),T=this.render.getBoundingClientRect().width-D,L=!0;this.head_table.getBoundingClientRect().width<=0&&(L=!1);for(d=b-1;d>=0;d--){var k=T-(L?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width),F=1;if(!(k>=0))break;if(!this.hiddenList[d]){if(k<2)break;var A=parseInt(this.colGroup.bodyColList[d].style.width);this.colGroup.bodyColList[d].style.width=A+F+"px",u[d]=A+F,(k=T-(L?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width))<1&&(F=-1,this.colGroup.bodyColList[d].style.width=A+F+"px",u[d]=A+F),this.hasFooter&&(this.colGroup.footerColList[d].style.width=A+F+"px",p[d]=A+F)}}}this.setColIndexInfo(u,p),this._setGridBorder(),(this.groupbyZoneStatus.groupbyZoneRender||this.options.useFilterList)&&(this.resizeGroupbyZone(),this.resizeGridList()),this.options.fixedColumnLineDiv&&a.Z.setTimeout(this.displayFixedColumnLine,{key:this.id+"_displayFixedColumnLine",caller:this,delay:10})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.redrawTable=function(){try{if(this.isWebKit)if(!0===this._isBrowserScroll()){var t=this.colGroup.bodyColList[0],e=t.offsetWidth,i=t.id;t.style.width=e+1+"px",a.Z.setTimeout((function(){document.getElementById(i).style.width=e+"px"}),{key:this.id+"_redrawTable",delay:20})}else{null==this._redrawTable_transform&&(this._redrawTable_transform=this.body_table.style.webkitTransform),this.body_table.style.webkitTransform="rotateZ(0deg)";var o=this.uuid;a.Z.setTimeout((function(){var t=WebSquare.idCache[o];t.body_table.style.webkitTransform=t._redrawTable_transform,delete t._redrawTable_transform}),{key:this.id+"_redrawTable",delay:20})}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setColIndexInfo=function(t,e){try{if(void 0===this.colGroup||null==this.colGroup){this.colGroup={},
this.colGroup.bodyColList=this.getElementById(this.id+"_body_table").getElementsByTagName("col");var i=this.getElementById(this.id+"_foot_table");this.colGroup.footerColList=i?i.getElementsByTagName("col"):null}this.colIndexInfo={};var o=this.getVisibleColRange(this.colGroup.bodyColList,t),r=this.getVisibleTds(this.colIndexes.bodyColInfo,o);if(this.colIndexInfo.body={colInfo:this.colIndexes.bodyColInfo,visibleTds:r.visibleTds,invisibleTds:r.invisibleTds,visibilityArr:r.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.isIE6or7){var a=this.getVisibleTds(this.colIndexes.headerColInfo,o);if(this.colIndexInfo.header={colInfo:this.colIndexes.headerColInfo,visibleTds:a.visibleTds,invisibleTds:a.invisibleTds,visibilityArr:a.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.hasFooter){var n=this.getVisibleColRange(this.colGroup.footerColList,e),l=this.getVisibleTds(this.colIndexes.footerColInfo,n);this.colIndexInfo.footer={colInfo:this.colIndexes.footerColInfo,visibleTds:l.visibleTds,invisibleTds:l.invisibleTds,visibilityArr:l.visibilityArr,firstCoveredColIndex:n.firstCoveredColIndex}}if(this.hasSubtotal)for(var h in this.colIndexInfo.subtotal={},this.subtotalRowHash){var d=this.getVisibleTds(this.colIndexes.subtotalColInfo[h],o);this.colIndexInfo.subtotal[h]={colInfo:this.colIndexes.subtotalColInfo[h],visibleTds:d.visibleTds,invisibleTds:d.invisibleTds,visibilityArr:d.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex}}}this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.hideInvisibleTds=(d=!0,function(){try{if(d){if(d=!1,this.groupbyStatus.grouped){this.options.lazyDrawHiddenColumn=!1;var t=WebSquare.language.getMessage("Grid_warning6",this.id)||this.id+" The groupby is enabled and the lazyDrawHiddenColumn is disabled.";return void $l(t)}for(var e=this.defaultColCnt;e<this.colIndexes.bodyColInfo.rowSpanArr.length;e++)if(this.colIndexes.bodyColInfo.rowSpanArr[e]>=2){this.options.lazyDrawHiddenColumn=!1;var i=WebSquare.language.getMessage("Grid_warning7",this.id)||this.id+" : rowSpan is enabled the lazyDrawHiddenColumn is disabled.";return void $l(i)}}var o=this.colIndexInfo.body.visibilityArr,r=[];for(e=0;e<this.drawedRowLength;e++)if("none"!=this.dataRowList[e].style.display)for(var a=0,n=0,l=this.defaultColCnt;l<o.length;l++){this.colIndexes.bodyColInfo.trIndexArr[l]>a&&(n=0,a++);var h=this._getColumnMoveIndex(l-this.defaultColCnt),u=this.data_td_list[h+e*this.oneRowDataLength],p=this.colIndexes.bodyColInfo.colSpanArr[l]||1;o[l]?(this.initVisibilityArr[l]||(this.drawCellData(e,e+this.rowIndex,h),this.applyCellStyleOptions(e+this.rowIndex,h),r[l]=!0),u.style.display="",p+n>1?(u.setAttribute("colSpan",p+n),u.setAttribute("data-lazydrawtd","true")):(u.removeAttribute("colSpan"),u.removeAttribute("data-lazydrawtd")),n=0):(u.style.display="none",n+=p)}for(e=0;e<r.length;e++)r[e]&&(this.initVisibilityArr[e]=!0)}catch(t){s.Y.printStackTrace(t,null,this)}}),f.prototype.getVisibleColRange=function(t,e){try{for(var i=this.render.clientWidth,o=[],r=0,a=-1,n=-1,l=e?e.length:t.length,h=0;h<l;h++){var d=e?e[h]:parseInt(t[h].style.width);if((r+=d)>i){a>=0?(d<3?o.push([a,h]):o.push([a,h+1]),n=h+1,a=-1):(o.push([h,h+1]),n=h+1);break}d<3?-1!=a&&(o.push([a,h]),a=-1):-1==a&&(a=h)}return-1!=a&&a<h&&o.push([a,h]),o.firstCoveredColIndex=-1!==n?n:l,-1==n&&(n=l),o}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getVisibleTds=function(t,e){try{for(var i=[],o=[],r=[],a=0;a<t.colIndexArr.length;a++){for(var n=t.colIndexArr[a],l=t.colSpanArr[a]||1,h=0;h<e.length;h++)if(e[h][0]<=n&&n<e[h][1]||e[h][0]<=n+l-1&&n+l-1<e[h][1]||n<=e[h][0]&&e[h][0]<n+l||n<=e[h][1]-1&&e[h][1]-1<n+l){i[i.length]=a,r[r.length]=!0;break}h==e.length&&(o[o.length]=a,r[r.length]=!1)}return{visibleTds:i,invisibleTds:o,visibilityArr:r}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setGridBorder=function(){try{var t=a.Z.getDataPrefix("colIndex");if(a.Z.isIE(8)){
if(0==this.defaultColCnt){var e=this.colGroup.bodyColList[0].style.width,i="1px"==e||"0px"==e?"0px":"";if(!this.leftMostTds){this.leftMostTds=[];for(var o=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),r=this.hasFooter?this.getElementById(this.id+"_foot_table").getElementsByTagName("td"):[],n=0;n<o.length;n++)0==o[n].getAttribute(t)&&this.leftMostTds.push(o[n]);for(n=0;n<r.length;n++)0==r[n].getAttribute(t)&&this.leftMostTds.push(r[n])}for(n=0;n<this.leftMostTds.length;n++)this.leftMostTds[n].style.borderLeftWidth=i,this.leftMostTds[n].style.borderRightWidth=i;if(this.all_data_td_list.length>0){if(!this.leftMostIndexArr){this.leftMostIndexArr=[];for(n=0;n<this.oneRowDataLength;n++)0==this.all_data_td_list[n].getAttribute(t)&&this.leftMostIndexArr.push(n)}for(n=0;n<this.leftMostIndexArr.length;n++)for(var l=0;l<this.drawedRowLength;l++){(h=this.all_data_td_list[this.leftMostIndexArr[n]+l*this.oneRowDataLength]).style.borderLeftWidth=i,h.style.borderRightWidth=i}}if(this.hasSubtotal&&this.drawedSubtotal)for(n=0;n<this.drawedSubtotal.length;n++)for(l=0;l<this.drawedSubtotal[n].length;l++){var h;0==(h=this.drawedSubtotal[n][l].cells[0]).cellIndex&&(h.style.borderLeftWidth=i,h.style.borderRightWidth=i)}}if(!this._setGridBorderNoRefresh){var d=(p=this.getElementById(this.id+"_dataLayer")).style.display,u=document.activeElement;p.style.display="none",p.offsetHeight,p.style.display=d,document.activeElement!=u&&this.hasClass(u,this.options.bodyTdClass)&&u.focus()}}if(this.isIE6or7&&(this.colIndexInfo||this.setColIndexInfo(),this.colGroup&&(this._setBorderFolding(this.all_data_td_list,this.colIndexInfo.body,this.drawedRowLength),this.headerTds||(this.headerTds=this.getElementById(this.id+"_head_table").getElementsByTagName("th")),this._setBorderFolding(this.headerTds,this.colIndexInfo.header)),this.hasFooter&&(this.footerTds||(this.footerTds=this.getElementById(this.id+"_foot_table").getElementsByTagName("td")),this._setBorderFolding(this.footerTds,this.colIndexInfo.footer)),this.hasSubtotal&&this._setSubtotalBorder(),!this._setGridBorderNoRefresh)){var p,c=(p=this.getElementById(this.id+"_dataLayer")).style.filter;u=document.activeElement;p.style.filter="alpha(opacity=99)",p.style.filter=c,document.activeElement!=u&&this.hasClass(u,this.options.bodyTdClass)&&u.focus()}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setBorderFolding=function(t,e,i){try{if(this.groupbyStatus.grouped)return;if(!t||0==i)return;i=i||1;for(var o=e.firstCoveredColIndex,r=this.oneRowDataLength+this.defaultColCnt,a=0,n=e.visibilityArr.length;a<n;a++){var l=e.colInfo.colIndexArr[a],h=e.visibilityArr[a],d="0px"===t[a].style.borderWidth;if(i>1&&(d=d||"0px"===t[a+r].style.borderWidth),l<o&&!h&&!d)for(var u=0;u<i;u++)t[a+u*r].style.borderWidth="0px";else if((l>=o||h)&&d)for(u=0;u<i;u++)t[a+u*r].style.borderWidth="",t[a+u*r].style.borderStyle=""}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setSubtotalBorder=function(){try{if(!this.drawedSubtotal)return;for(var t={},e=0;e<this.drawedSubtotal.length;e++){var i=this.drawedSubtotal[e];if(!t[i.targetID]){t[i.targetID]=!0;for(var o=this.colIndexInfo.subtotal[i.targetID],r=o.firstCoveredColIndex,a=0,n=0;n<i.length;n++)for(var l=i[n],h=0;h<l.cells.length;h++,a++){var d=o.colInfo.colIndexArr[a],u=o.visibilityArr[a],p="0px"===l.cells[h].style.borderWidth;if(d<r&&!u&&!p)for(var c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="0px");else if((d>=r||u)&&p)for(c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="")}}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleWheel=function(t){try{
if(this.options.groupbyZone||this.options.useFilterList)for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone_scrollView")||e.match("w2grid_customFilter_scrollView"))return void p.f.stopPropagation(t);var i=p.f.getMouseWheelDelta(t),o=t.wheelDeltaY,r=t.wheelDeltaX,n=Math.floor(this.options.wheelRows*Math.abs(i));if(n=Math.max(n,this.options.wheelRows),"wheelDeltaX"in t&&Math.abs(r)>Math.abs(o))return this.getElementById(this.id+"_scrollX_right").scrollLeft-=r,void p.f.stopEvent(t);var l=this.getElementById(this.id+"_scrollY_div");if(this.scrollEvent=!0,i>0){if(0==l.scrollTop)return void(this.options.wheelStop&&p.f.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)-n)}else if(i<0){var h=this.getElementById(this.id+"_scrollY_div"),d=this._getEpsilon(),u=h.scrollHeight-h.clientHeight,c=Math.min(Math.round(h.scrollTop)+d,u);if(this.rowIndex<0||0==h.clientHeight||c==u)return void(this.options.wheelStop&&p.f.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)+n)}a.Z.isMobile()&&this.moveYScroll(0),this.hideTooltip(),p.f.stopEvent(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleWheelHybrid=function(t){try{if(!0!==this._useHybridScroll())return;p.f.preventDefault(t);var e=0;if("wheel"===t.type)e=t.deltaY;else e=-100*p.f.getMouseWheelDelta(t);this._setHybridWheelDeltaY(e)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleTouchStartHybrid=function(t){try{this._hybridMobileStartX=t.touches[0].clientX,this._hybridMobileStartY=t.touches[0].clientY}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleTouchMoveHybrid=function(t){try{if(!0!==this._useHybridScroll())return;var e=this._hybridMobileStartX-t.touches[0].clientX,i=this._hybridMobileStartY-t.touches[0].clientY;Math.abs(e)>Math.abs(i)?this._setHybridWheelDeltaX(e):this._setHybridWheelDeltaY(i),p.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleColumnResize=function(t){try{if(2==t.button)return;var e,i,o,r,n,l,h=a.Z.getDataPrefix("colIndex"),d=a.Z.getDataPrefix("header_id");if("drag"!==this.resizeStatus){for(var u=this.event.getTargetIterator(t,this.render),c=null;u.next();){var g=u.getElement();if("TH"!=g.tagName&&"TD"!=g.tagName||(c=g),"NOBR"==g.tagName||"SPAN"==g.tagName&&g.className.indexOf("w2grid_span")>-1){c=null;break}}if(null!=c){e=p.f.getMouseX(t),i=WebSquare.style.getAbsoluteLeft(c),o=parseInt(c.getAttribute("colSpan")||1,10),r=parseInt(c.getAttribute(h),0),n=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;var f=WebSquare.style.getComputedStyle(document.body,"zoom");1==n&&f&&(n=parseFloat(f)),e/=n,l=i;var m=r,y=c.getAttribute(d);"_headerRowNumber"!=y&&"_headerRowStatus"!=y&&(m=this._getRealColIndex("head",y)+this.defaultColCnt),m=this._getMouseColumnIndex({colIndex:r,offsetX:e,offsetLeft:l,colSpan:o}),"col-resize"===this.resizeStatus&&!1===this.isColumnResizable(m)&&(this.resizeStatus="init")}}switch(this.resizeStatus){case"init":this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="";break;case"col-resize":this.getElementById(this.id+"_head_table").style.cursor="col-resize",this.getElementById(this.id+"_head_table").cursor="col-resize";break;case"drag":return this.resizeStatus="drag",this.handleResizeLine(t),void(a.Z.isMobile()&&p.f.stopEvent(t))}if(null!=this.columnMoveTarget)return;if(null==c)return void(this.resizeStatus="init");if(e-l<(v=.3*this.colWidthList[r]>10?10:parseInt(.3*this.colWidthList[r],10))&&0!=r){if("init"===this.resizeStatus||"col-resize"===this.resizeStatus)return void(this.isColumnResizable(r)&&(this.resizeStatus="col-resize"))}else this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus;if(y&&"_headerRowNumber"!=y&&"_headerRowStatus"!=y)for(var b=0;b<o;b++){if(1==this.options.columnMove){c.getAttribute(d);r=this._getRealColIndex("head",y)+this.defaultColCnt}
var v,w=parseInt(this.colGroup.bodyColList[r+b].style.width,10);if((l+=w)-(v=.3*w>10?10:parseInt(.3*w,10))<e&&e<l+v)return void("init"!==this.resizeStatus&&"col-resize"!==this.resizeStatus||this.isColumnResizable(r)&&(this.resizeStatus="col-resize"));this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.doColumnResize=function(t){try{if(2==t.button)return;if(a.Z.isMobile()&&this.handleColumnResize(t),!this.options.columnMove&&!this.options.groupbyZone&&"init"==this.resizeStatus||"drag"==this.resizeStatus)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_colIndex=null,this.resize_colId=null;e.next();)e.match(this.options.headerTdClass)&&(i=e.getElement());if(null==i)return;this.startResizeX=p.f.getScreenX(t);var o=a.Z.getDataPrefix("header_id"),r=a.Z.getDataPrefix("colindex"),n=a.Z.getDataPrefix("value"),l=i.getAttribute(o);if("col-resize"==this.resizeStatus){p.f.preventDefault(t),this.resizeStarted=!0,this.resizeStatus="drag";var h=p.f.getMouseX(t),d=WebSquare.style.getAbsoluteLeft(i),u=parseInt(i.getAttribute("colSpan")||1,10),c=this._getRealColIndex("head",l)+this.defaultColCnt;"_headerRowNumber"!=l&&"_headerRowStatus"!=l||(c=parseInt(i.getAttribute(r),10));var g=d;this.resizeColIndex=this._getMouseColumnIndex({colIndex:c,offsetX:h,offsetLeft:g,colSpan:u})}else if(this.options.columnMove&&(0===this.getHeaderRowIndex(l)||this.options.allColumnMove)){this.resizeStatus="drag";var f=null,m=this.htmlInfo.head.rowArr[0],y=!0;if(0!=parseInt(this.options.stopColumnMoveRow,10))for(var b=0;b<m.length;b++)if(m[b].id==l){y=!1;break}if(this.options.allColumnMove)for(b=1;b<this.htmlInfo.head.rowArr.length;b++)if(parseInt(this.options.stopColumnMoveRow,10)!=b)for(var v=0;v<this.htmlInfo.head.rowArr[b].length;v++)if(this.htmlInfo.head.rowArr[b][v].id==l){y=!1,f=l,l=this.htmlInfo.head.rowArr[0][v].id;break}if(y)return;this.resizeStauts="init","_headerRowNumber"!=l&&"_headerRowStatus"!=l&&(null!=f&&(this.realColumnMoveTarget=this.getHeaderIndex(f)),this.columnMoveTarget=this.getHeaderIndex(l),this.columnMoveTargetId=l,this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),a.Z.emptySelection())}else if(this.options.groupbyZone&&(this.resizeStatus="drag","_headerRowNumber"!=l&&"_headerRowStatus"!=l)){if(this.groupbyZoneStatus.clickedHeaderInfo={},this.groupbyZoneStatus.clickedHeaderInfo.index=this._getRealHeaderColIndex(l),this.groupbyZoneStatus.clickedHeaderInfo.value=i.getAttribute(n),this.groupbyZoneStatus.clickedHeaderInfo.headerID=l,null==this.groupbyStatus.sortIndexArr||null==this.groupbyStatus.sortOrderArr||this.options.groupbyFilterIcon)this.showGroupbyHeaderGhost(t,l);else{this.resizeStatus="init";var w=!1,C={};C.render=i,C.parentRender=this.render.getElementsByTagName("div")[0],C.headerID=i.getAttribute(o),C.headerIndex=this.getHeaderIndex(C.headerID);for(b=0;b<this.groupbyStatus.sortIndexArr.length;b++)if(C.headerIndex==this.groupbyStatus.sortIndexArr[b]){w=!0;break}w?this.groupbyFilterList?this.toggleGroupbyFilterList(C):this.createGroupbyFilterList(C):(this.hideGroupbyFilterList(),this.showGroupbyHeaderGhost(t,l))}this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),a.Z.emptySelection()}this.handleResizeLine(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.endColumnResize=function(t){try{if(2==t.button)return;if("drag"!==this.resizeStatus&&(this.resizeStatus="init"),this.options.columnMove&&null!=this.columnMoveTarget){var e=this.event.getTargetIterator(t,this.render),i=null;if(this.event.isMe(t,this.render))for(;e.next();)e.match(this.options.headerTdClass)&&(e.match(this.options.headerTdClass+"_rowNumber")||e.match(this.options.headerTdClass+"_rowStatus")||(i=e.getElement()),e.stop());var o=this.resize_colId;if(null!=i){var r=a.Z.getDataPrefix("header_id");o=i.getAttribute(r)||this.resize_colId}
this.moveColumnByHeaderId(this.columnMoveTargetId,o),this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),a.Z.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo){for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone")){e.getElement(),null==this.groupbyStatus.sortIndexArr&&(this.groupbyStatus.sortIndexArr=[]),null==this.groupbyStatus.sortOrderArr&&(this.groupbyStatus.sortOrderArr=[]);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)if(this.groupbyZoneStatus.clickedHeaderInfo.index==this.groupbyStatus.sortIndexArr[n])return this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<=this.groupbyStatus.sortIndexArr.length)return c.v.printLog("groupby max column count has been exceeded.["+this.id+"]"),this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);this.groupbyStatus.sortIndexArr.push(this.groupbyZoneStatus.clickedHeaderInfo.index),this.groupbyStatus.sortOrderArr.push(1);var l={};if(l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,null!=this.groupbyStatus.filter&&(l.filter=this.groupbyStatus.filter),!1===p.f.fireEvent(this,"ongroupby",l)){var h=this.getColCnt()+this.defaultColCnt,d=WebSquare.language.getMessage("Grid_cases")||"cases";l.rowNumHeader={colSpan:h,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+d+" ] ' ",align:"left"},l.footerVisible=!1,l.rowNumFooter={colSpan:h},this.groupby(l)}this.groupbyFilterList&&this.hideGroupbyFilterList();break}this.groupbyZoneStatus.clickedHeaderInfo=null,this.resizeStatus="init",this.handleResizeLine(t),a.Z.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if("drag"===this.resizeStatus){this.endResizeX=p.f.getScreenX(t);for(var u=this.resizeColIndex;1==this.hiddenList[u]&&!(--u<0););var g=this.colWidthList[u];if(u>=0&&this.isColumnResizable(u)){g=this.colWidthList[u];var f=this.getElementById(this.id+"_dataLayer").offsetWidth,m=g+this.endResizeX-this.startResizeX,y=0;if(this.options.fixedColumn>0){var b=this.getFixedColumnLastIndex();if(b>=u){for(n=0;n<b;n++)this.hiddenList[n]||(y+=n==u?m:this.colWidthList[n]);var v=30;null==this.colWidthList[b]&&(v=1),y>f-v&&(m=m-(y-f)-v-1)}}var w=this.cellInfoHash[this.getColumnID(this.columnOrder[u-this.defaultColCnt])];(m=w&&m<w.options.minWidth?w.options.minWidth:m)&&g&&this.resizeObj.width&&(this.resizeObj.width=this.resizeObj.width+m-g),0!=Math.abs(g-m)&&(this.setColumnWidth(u,m,!0),p.f.fireEvent(this,"onaftercolumnresize",u-this.defaultColCnt,g,m))}this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),a.Z.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");if(this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.options.columnMove&&null!=this.columnMoveTarget){for(var i=this.event.getTargetIterator(t,this.render),o=null;i.next();)i.match(this.options.headerTdClass)&&(o=i.getElement());if(null!=o){this.columnBlock||this.createBlockedHeaderInfo();var r=this.columnMoveTargetId,n=this.getHeaderColIndex(r);n=this.columnBlock.hash[n-this.defaultColCnt],
r=this.getHeaderColID(n+this.defaultColCnt);var l=a.Z.getDataPrefix("header_id"),h=o.getAttribute(l),d=this.getHeaderColIndex(h);d=this.columnBlock.hash[d-this.defaultColCnt],h=this.getHeaderColID(d+this.defaultColCnt);var u=this.getHeaderIndex(r),c=this.getHeaderIndex(h);if(u<c)for(var g=this.columnBlock.info[d],f=g.length-1;f>=0;f--){var m=this.getHeaderColID(g[f]+this.defaultColCnt,{firstRow:!0});if(m){h=m,c=this.getHeaderIndex(h);break}}var y=this._getRealColIndex("head",h),b=this.htmlInfo.head.rowArr[0],v=!0;for(f=0;f<b.length;f++)if(b[f].id==h){v=!1;break}if(this.options.allColumnMove)for(f=1;f<this.htmlInfo.head.rowArr.length;f++)for(var w=0;w<this.htmlInfo.head.rowArr[f].length;w++)if(this.htmlInfo.head.rowArr[f][w].id==h){v=!1,h=this.htmlInfo.head.rowArr[0][w].id,c=this.getHeaderIndex(h),y=this.colMoveHeaderIndexMap[h];break}if(v)return;if("_headerRowNumber"==h||"_headerRowStatus"==h||u==c)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else{if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>u+this.defaultColCnt||this.getFixedColumnLastIndex()>c+this.defaultColCnt))return e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",void(!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor=""));this.resize_colIndex=c,this.resize_colId=h;var C=null;for(f=0;f<this.htmlInfo.body.rowArr.length;f++){for(w=0;w<this.htmlInfo.body.rowArr[f].length;w++)if(this.htmlInfo.body.rowArr[f][w]["@col"]==y){C=this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[f][w].col_id];break}if(null!==C)break}var I=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),_=WebSquare.style.getAbsoluteTop(this.render),x=WebSquare.style.getAbsoluteLeft(this.render),S=I[c+this.defaultColCnt],R=S.offsetLeft,D=S.offsetWidth,T=R+(u<c?D:0);null!=this.realColumnMoveTarget?this.resize_ghost.innerHTML=I[this.realColumnMoveTarget+this.defaultColCnt].innerHTML:this.resize_ghost.innerHTML=I[this.columnMoveTarget+this.defaultColCnt].innerHTML,this.resize_ghost.style.display="block",this.resize_ghost.style.top=_+I[this.columnMoveTarget].offsetHeight+5+"px",this.resize_ghost.style.left=x+T+5+"px",!this.resize_ghost.firstChild||!this.resize_ghost.firstChild.tagName||"NOBR"===this.resize_ghost.firstChild.tagName.toUpperCase()||"SPAN"==this.resize_ghost.firstChild.tagName.toUpperCase()&&this.resize_ghost.firstChild.className.indexOf("w2grid_span")>-1?this.resize_ghost.style.width="auto":this.resize_ghost.style.width=D+"px",this.resize_arrow.style.display="block",this.resize_arrow.style.top=_-this.resize_arrow.offsetHeight+"px",this.resize_arrow.style.left=x+T-parseInt(this.resize_arrow.offsetWidth/2,10)+1+"px",e.style.display="block",e.style.zIndex=9999,e.style.border="1px solid #3a3f44",e.style.top=0,e.style.left=T+"px",e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px"),a.Z.emptySelection()}}}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else if("drag"==this.resizeStatus&&this.resizeStarted&&this.isColumnResizable(this.resizeColIndex)){e.style.cssText="position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px; cursor:col-resize;",e.style.display="block",e.style.zIndex=100,e.style.top=0,e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px")
;var L=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1,k=WebSquare.style.getComputedStyle(document.body,"zoom");1==L&&k&&(L=parseFloat(k)),e.style.left=(p.f.getMouseX(t)-WebSquare.style.getAbsoluteLeft(this.render)*L)/L+"px",this.resize_ghost.style.display="none"}else e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return void(this.rowResizeTarget&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""));if(this.handleRowResizeLine(t),null!=this.rowMoveTarget)return;for(var e=this.event.getTargetIterator(t,this.render),i=null;e.next();){var o=e.getElement();if("TD"==o.tagName&&(i=o),"TH"==o.tagName){i=null;break}}if(null==i)return;i.style.cursor="",i.cursor="";var r=p.f.getMouseY(t),n=WebSquare.style.getAbsoluteTop(i),l=a.Z.getDataPrefix("tdIndex"),h=parseInt(i.getAttribute(l),0),d=parseInt(h/this.realRowDataLength)+this.rowIndex;if(r-n<10&&0!=d)return i.style.cursor="row-resize",i.cursor="row-resize",this.rowResizeTarget&&this.rowResizeTarget!=i&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""),void(this.rowResizeTarget=i)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.doRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_rowIndex=null;e.next();)e.match(this.options.bodyTdClass)&&(i=e.getElement());if(null==i)return;if(this.startResizeY=p.f.getScreenY(t),"row-resize"==i.cursor){p.f.preventDefault(t),this.rowResizeStarted=!0,this.rowResizeTarget=i;var o=a.Z.getDataPrefix("tdIndex"),r=parseInt(i.getAttribute(o),0),n=parseInt(r/this.realRowDataLength)+this.rowIndex;this.resizeRowIndex=n-1}this.handleRowResizeLine(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.endRowResize=function(t){try{if(this.rowResizeStarted){this.endResizeY=p.f.getScreenY(t);var e=this.resizeRowIndex||0;if(e>=0){var i=this.rowResizeTarget.offsetHeight+this.endResizeY-this.startResizeY;i=i<20?20:i,this.rowStyleArr[e]="rowResizeStyle_"+e,this.rowStyleValueObj[this.rowStyleArr[e]]||(this.rowStyleValueObj[this.rowStyleArr[e]]={}),this.rowStyleValueObj[this.rowStyleArr[e]].style="height:"+i+"px;",this.applyRowStyleOptions(e),this.drawData(this.rowIndex,e+1,"async")}if(this.rowResizeStarted=!1,this.rowResized=!0,this.rowMoveTarget=null,this.handleRowResizeLine(t),window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)try{document.selection.empty()}catch(t){s.Y.printStackTrace(t,null,this)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleRowResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.rowResizeStarted?(e.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",e.style.display="block",e.style.zIndex=100,e.style.top=p.f.getMouseY(t)-WebSquare.style.getAbsoluteTop(this.render)+"px",e.style.width=this.render.offsetWidth+"px",e.style.left=0,this.resize_ghost.style.display="none"):(e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none")}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setColumnWidth=function(t,e){try{if(this.autoFitColWidthList=null,
this.hiddenList[t])this.colWidthList[t]=e;else{var i=isNaN(this.colWidthList[t])?0:this.colWidthList[t];if(this.colWidthList[t]=e,this.gridWidth+=e-i,this.options.senseReader){var o=document.activeElement;if(o&&o.className.match("w2grid_embedded_input")){var r=this.getLastFocusedCell();r&&r.focusedTd&&o.blur()}}this.arrangeOverflowXScroll(),this.setOverflowX(),this.handleScrollX();var a=t-this.defaultColCnt;if(a>=0){var n=this.getCellInfo(a);if("textarea"==n.options.inputType)this.drawColumnData(a);else if(("text"==n.options.inputType||"secret"==n.options.inputType||"calendar"==n.options.inputType)&&n.options.embeddedInput&&!this.groupbyStatus.grouped)for(var l=this.struct.body.rowArr,h=0,d=0;d<l.length;d++){for(var u=0,p=0,c=0;c<l[d].length;c++){var g=l[d][c].id;if((u+=(n=this.getCellInfo(g)).options.colSpan-0)-1==a){p=this.getColumnIndex(g),h+=l[d].length;break}if(u-1>a){p=h+a;break}}this.embeddedWidthObj[p]&&(this.embeddedWidthObj[p].isChanged=!0),this.drawColumnData(p)}}this.handlerResize_drawInitializer()}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setColumnVisible=function(t,e){try{e=a.Z.getBoolean(e);var i=this.getCellInfo(t),o=(t=this.getColumnIndex(t),this.getColumnVisible(t)),n=a.Z.getDataPrefix("colindex");if(null==t)return;var l=this._getRealColIndex("body",i.options.col_id)+this.defaultColCnt,h=this._getRealColIndex("head",this.bodyToHeaderRelation[i.options.col_id])+this.defaultColCnt;if(this.hiddenList[l]!=e)return;for(var d=0;d<this.getColumnCount();d++){var u=this.getCellInfo(d);"textarea"==u.options.inputType&&"all"==u.options.displayType&&(this.setScrollTop(0),this.setScrollLeft(0))}if(this.options.fixedColumn>0&&e&&this.options.fixedColumn>t){var p=0,c=this.getFixedColumnLastIndex();for(d=0;d<c;d++)this.hiddenList[d]&&d-this.defaultColCnt!=t||(p+=this.colWidthList[d]);if(p>this.getElementById(this.id+"_dataLayer").offsetWidth-30)return void WebSquare.logger.printLog(this.id+" setColumnVisible error : not enough space to show the column.  ")}for(d=0;d<i.options.colSpan;d++)this.hiddenList[l+d]=!e;this.gridWidth=0;for(d=0;d<this.colWidthList.length;d++)this.hiddenList[d]||(this.gridWidth+=this.colWidthList[d]);if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),o!==e){var g,f=this.head_table.querySelector("th["+n+'="'+h+'"]');if(f&&(g=this.options.accessibility?f:f.querySelector("div.w2grid_head_sort_div_main_outer")),g){var m=this.options.accessibility?f.querySelector("button.w2grid_head_sort_div_main_btn_accessibility"):g.querySelector("button.w2grid_head_sort_div_main_btn");m&&(1==e?m.removeAttribute("tabindex"):m.setAttribute("tabindex","-1"));var y=g.querySelector('input[type="checkbox"]');y&&(1==e?y.removeAttribute("tabindex"):y.setAttribute("tabindex","-1"))}var b=this.colIndexInfo.body.colInfo.colIndexArr;for(d=0;d<b.length;d++)if(b[d]==l)for(var v=0;v<=this.lastIndex;v++){var w,C,I=v+this.rowIndex,_=d-this.defaultColCnt,x=(this._getTrIndex(I),this._getTdElem(I,_));"number"==typeof _?(_,w=this.cellIdList[_]):(this.bodyIdColIndexMap[_],w=_),"custom"==(i=this.cellInfoHash[w]||{options:{}}).options.inputType&&(C=i.cellManagerHashByRowIndex[this.dataList.getRealRowIndex(this.rowIndex)]),("button"==i.options.inputType&&x.firstChild&&"BUTTON"==x.firstChild.tagName||C&&"button"==C.options.inputType)&&1==this.options.keyMoveEditMode&&(1==e?x.firstChild.removeAttribute("tabindex"):x.firstChild.setAttribute("tabindex","-1"))}}if(""!=this.options.hiddenClass||""!=i.options.hiddenClass){this.drawData(this.rowIndex,0);var S=this.getColumnID(t),R=this.options.hiddenClass;""!=i.options.hiddenClass&&(R=i.options.hiddenClass);var D=null!=this.bodyToHeaderRelation[S]?this.getHeaderLayer(this.bodyToHeaderRelation[S]):null;e?null!=D&&this.hasClass(D,R)&&this.removeClass(D,R):null==D||this.hasClass(D,R)||this.addClass(D,R)}
if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[l]){for(b=this.colIndexInfo.body.colInfo.colIndexArr,d=0;d<b.length;d++)if(b[d]==l)for(v=0;v<=this.lastIndex;v++)this.drawCellData(v,v+this.rowIndex,d-this.defaultColCnt),this.applyCellStyleOptions(v+this.rowIndex,d-this.defaultColCnt);this.initVisibilityArr[l]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(l,e),r.I.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit(),e&&this._setRedrawTextAreaColumn()}catch(t){s.Y.printStackTrace(t,null,this)}}),{key:this.id+"_setColumnVisible",caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setRowVisible=function(t,e,i){try{if((t=parseInt(t,10))<0||t>=this.getTotalRow()||isNaN(t))return void c.v.printLog(this.id+" setRowVisible error : invalid rowIndex "+t);var o=a.Z.getBoolean(e);if(this.hiddenRowObj.row[t]===!o||null==this.hiddenRowObj.row[t]&&!0===o)return;this.hiddenRowObj.row[t]=!o,this.hiddenRowObj.init=!0;var r=this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)});if(!1===o?(this.hiddenRowObj.length++,"all"===this.options.visibleRowNum||r||this.hiddenRowObj.extraRow<this.hiddenRowObj.length&&this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.length-1)):(delete this.hiddenRowObj.row[t],this.hiddenRowObj.length--),r)return;a.Z.setTimeout((function(){this.lastTopRowIndex=null,this.initHeightCompleted=!1;var t=this.getDataLength();if(t-this.hiddenRowObj.length<=this.lastIndex+1&&0!==this.rowIndex)return this.bScrollY=0,this.setScrollTop(0),void this.drawData(0);var e=t-this._getVisibleLastIndex(this.lastIndex+1);if(e<this.rowIndex){var i=this.getLastFocusedCell();return this.removeFocusedCell(),this.rowIndex=e,e<this.bScrollTop&&(this.bScrollTop=e),this.setScrollYHeight({restRowCnt:this._getScrollRowIndex(e),skipScrollEnd:!0}),this.drawData(e),void(i.focusedRowIndex>-1&&null!=i.focusedColIndex&&!0===this.getRowVisible(i.focusedRowIndex)&&this.setFocusedCell(i.focusedRowIndex,i.focusedColIndex))}this._applyRowVisible({applyStyle:!0,refreshColumn:!0}),this.setScrollYHeight(),this.dynamicMergeHTML(),this._setRedrawTextAreaColumn(!0)}),{key:this.id+"_setRowVisible",caller:this,delay:100})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setRowNumVisible=function(t){this.options.rowNumVisible&&0===Object.keys(this.groupbyStatus).length&&this._setRowNumStatusVisible("rowNum",t)},f.prototype.setRowStatusVisible=function(t){this.options.rowStatusVisible&&0===Object.keys(this.groupbyStatus).length&&this._setRowNumStatusVisible("rowStatus",t)},f.prototype._setRowNumStatusVisible=function(t,e){try{var i,o;if(null==t||"rowNum"!==t&&"rowStatus"!==t)return;this.options.rowNumVisible&&this.options.rowStatusVisible?(i="rowNum"===t?0:1,o="rowNum"===t?0:1):(this.options.rowNumVisible&&!this.options.rowStatusVisible||!this.options.rowNumVisible&&this.options.rowStatusVisible)&&(i=0,o=0);e=a.Z.getBoolean(e);var n=this.getCellInfo(i);if(this.hiddenList[o]!=e)return;for(var l=0;l<this.getColumnCount();l++){var h=this.getCellInfo(l);"textarea"==h.options.inputType&&"all"==h.options.displayType&&(this.setScrollTop(0),this.setScrollLeft(0))}if(this.options.fixedColumn>0&&e&&this.options.fixedColumn>i){var d=0,u=this.getFixedColumnLastIndex();for(l=0;l<u;l++)this.hiddenList[l]&&l-this.defaultColCnt!=i||(d+=this.colWidthList[l]);if(d>this.getElementById(this.id+"_dataLayer").offsetWidth-30)return void WebSquare.logger.printLog(this.id+" setColumnVisible error : not enough space to show the column.  ")}for(l=0;l<n.options.colSpan;l++)this.hiddenList[o+l]=!e;this.gridWidth=0;for(l=0;l<this.colWidthList.length;l++)this.hiddenList[l]||(this.gridWidth+=this.colWidthList[l])
;if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),""!=this.options.hiddenClass||""!=n.options.hiddenClass){this.drawData(this.rowIndex,0);var p=this.getColumnID(i),c=this.options.hiddenClass;""!=n.options.hiddenClass&&(c=n.options.hiddenClass);var g=null!=this.bodyToHeaderRelation[p]?this.getHeaderLayer(this.bodyToHeaderRelation[p]):null;e?null!=g&&this.hasClass(g,c)&&this.removeClass(g,c):null==g||this.hasClass(g,c)||this.addClass(g,c)}if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[o]){var f=this.colIndexInfo.body.colInfo.colIndexArr;for(l=0;l<f.length;l++)if(f[l]==o)for(var m=0;m<=this.lastIndex;m++)this.drawCellData(m,m+this.rowIndex,l-this.defaultColCnt),this.applyCellStyleOptions(m+this.rowIndex,l-this.defaultColCnt);this.initVisibilityArr[o]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(o,e),r.I.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit(),e&&this._setRedrawTextAreaColumn()}catch(t){s.Y.printStackTrace(t,null,this)}}),{key:this.id+"_setRowNumStatusVisible",caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.clearRowVisible=function(t){try{var e=this.hiddenRowObj.extraRow;if(this.hiddenRowObj.init&&(this.lastTopRowIndex=null),this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),t&&!0===t.noDraw)return;0!==this.rowIndex?(this.bScrollY=0,this.setScrollTop(0),this.drawData(0),this.setScrollYHeight()):(this.setScrollYHeight(),this.dynamicMergeHTML(),this.applyStyleOptions(this.lastIndex))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&!0!==this.hiddenRowObj.row[t]}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&(!(this.hiddenRowObj.length>0)||this.getRowVisible(this.dataList.getRealRowIndex(t)))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHiddenRowCount=function(t){try{var e=this.hiddenRowObj.length;if(this.isDrillDown&&isNaN(t)&&(t=0),this.hiddenRowObj.length>0&&(t||this.isDrillDown)){e=0;for(var i=this.getDataLength(),o=t;o<i;o++)this._getRowVisible(o)||e++}return e}catch(t){return s.Y.printStackTrace(t,null,this),0}},f.prototype._getVisibleRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;var e=this.getDataLength();if(t>=e)return e;for(var i=t,o=0;i>=0&&o<e;)this._getRowVisible(o)&&i--,i>=0&&o++;return o}catch(e){return s.Y.printStackTrace(e,null,this),t}},f.prototype._getVisibleTrRowIndex=function(t,e){try{if(this._getHiddenRowCount()<=0)return t;for(var i=this.getDataLength(),o=0,r=this.drawedRowLength+this.hiddenRowObj.extraRow-1,a=t,n=e;a>=0&&n<i&&r>o;n++)this._getRowVisible(n)&&a--,a>=0&&o++;return o}catch(e){return s.Y.printStackTrace(e,null,this),t}},f.prototype._getScrollRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;if(t<=0)return 0;for(var e=0,i=this._getScrollMaxRowIndex(),o=t-1;o>=0&&i>e;o--)this._getRowVisible(o)&&e++;return e}catch(e){return s.Y.printStackTrace(e,null,this),t}},f.prototype._getScrollMaxRowIndex=function(){try{var t=parseInt(document.getElementById(this.id+"_size_y").style.height,10)-document.getElementById(this.id+"_scrollY_div").offsetHeight;return Math.floor((t+this._getEpsilon())/this.oneRowScrollHeight)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getEpsilon=function(){try{
var t=Math.min(2,Math.round(this.oneRowScrollHeight/10)),e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;return e<1&&(t=Math.min(Math.round(t/e),Math.round(this.oneRowScrollHeight/2.4))),t}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getVisibleLastIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;for(var e=t,i=this.getDataLength(),o=0,r=i-1;r>=0&&e>0;r--)this._getRowVisible(r)&&e--,o++;return o}catch(e){return s.Y.printStackTrace(e,null,this),t}},f.prototype._getTrIndex=function(t){try{var e=t;return this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>t||this.options.lastFixedRow>0&&t>this.lastIndex-this.options.lastFixedRow||(e-=this.rowIndex)),e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getTdElem=function(t,e){try{for(var i=0,o=this.rowIndex;o<t&&this.hiddenRowObj.length>0;o++)this._getRowVisible(o)||i++;var r=this._getTrIndex(t);if(r<0||r-i>=this.drawedRowLength)return;return this.data_td_list[r*this.oneRowDataLength+e]}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._addHiddenRow=function(t){try{var e=[];0==this.drawedRowLength&&this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(-1)));for(var i=[],o=0;o<this.oneRowLength;o++){var r=this.tempTr.rows[o].cloneNode(!0);i[o]=r,e.push(r)}this.addBodyRow(t,i),this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(t)));var a=this.getElementById(this.id+"_body_table"),n=this.getElementById(this.id+"_body_tbody");0==this.drawedRowLength?a.style.borderWidth="0px":a.style.borderWidth="";for(o=0;o<e.length;o++)n.appendChild(e[o]);this._setRowDisplay(t,"none"),this.hiddenRowObj.extraRow++}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._applyRowVisible=function(t){try{if(void 0!==t&&null!=t||(t={}),this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)}))return;var e=0,i=!0,o=this._getLastSubtotalCount();t.subtotalDraw&&-1==this.options.initFixedHeightByRowNum&&(o=0);var r=this.getDataLength()+o,a=this.lastIndex;a=""===this.options.visibleRowNum?Math.min(this.drawedRowLength,r-this.rowIndex)-1:"all"===this.options.visibleRowNum?t.subtotalDraw?Math.min(this.drawedRowLength,this.getDataLength())-1:this.drawedRowLength:Math.min(parseInt(this.options.visibleRowNum,10),r)-1;var n=r-this._getVisibleLastIndex(a+1),l=this.rowIndex;this.subtotalHidden();for(var h=!1,d={skipSubtotal:!0,refreshColumn:t.refreshColumn},u=0,p=a,c=0;c<=a;c++){var g=c+this.rowIndex;if(!0===t.drawRow&&(this.options.fixedRow>0&&this.options.fixedRow>c?(g=c,this.fastDrawRowData(c,g,d)):this.options.lastFixedRow>0&&c>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(c,g,d)),this._getRowVisible(c+this.rowIndex)?(this._setRowDisplay(c,""),i=!1,h=!0):(this._setRowDisplay(c,"none"),e++,i&&l<n&&l++),this.hasSubtotal&&h)this.options.initFixedHeightByRowNum>-1&&(y={maxCount:a-c+e}),(b=this.drawSubtotalRow(c+1,g,y))>0&&(h=!1,this.options.initFixedHeightByRowNum>-1&&(c>=(a-=b)&&(e-=c-a),u+=b));p=c}var f=this.hiddenRowObj.extraRow+u,m=0;for(c=0;c<f&&a>=0;c++){var y,b,v=c+p+1;g=v+this.rowIndex;if(this._getRowVisible(g)&&e>0&&g<r?(this._setRowDisplay(v,""),this.fastDrawRowData(v,g,d),e--,i=!1,h=!0):(this._setRowDisplay(v,"none"),i&&l<n&&l++,e<=0&&(h=l>=n),!0===t.drawRow&&this.fastDrawRowData(v,g,d)),this.hasSubtotal&&v+this.rowIndex<r&&h)this.options.initFixedHeightByRowNum>-1&&(y={maxCount:e}),(b=this.drawSubtotalRow(v+1,g,y))>0&&(h=!1,this.options.initFixedHeightByRowNum>-1&&(m+=b,e-=b))}l!==this.rowIndex&&!0!==t.noDraw?this.drawData(l):""===this.options.visibleRowNum?(!0===t.applyStyle&&this.applyStyleOptions(a),this.cutGridBottom()):this.lastIndex=a-m}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setCellVisible=function(t,e,i){try{if(!0!==i&&!1!==i)return;e=this.getColumnIndex(e);var o,r=!0===this.hiddenCellObj[t+"_"+e],n=!1;if(!0===i&&r?(this.hiddenCellObj[t+"_"+e]=!1,o=!0,this.hiddenCellObj.length--):!1!==i||r||(this.hiddenCellObj[t+"_"+e]=!0,o=!0,this.hiddenCellObj.length++,
this.hiddenCellObj.init||(n=!0),this.hiddenCellObj.init=!0),!0===o){var l=this._getTdElem(t,e);null!=l&&(l.style.display=!0===i?"":"none")}n&&(""!==this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&"all"!==this.options.visibleRowNum&&(this.options.visibleRowNum=""),this.setDataTable()),!0!==this._isBrowserScroll()&&"all"!==this.options.visibleRowNum&&a.Z.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:100})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setCellVisibleRefresh=function(){try{if(!0===this._isBrowserScroll()||"all"===this.options.visibleRowNum)return;this.lastTopRowIndex=null;var t=this.rowIndex,e=Math.max(this.getDataLength()-this.drawedRowLength,0);this.rowIndex=e,this.subtotalHidden();var i=this.completiveDrawData(0,{extraRowByCellHidden:!0});if(this.lastTopRowIndex=e+i,0===e&&0===i){0!==(o=this.getElementById(this.id+"_size_y")).offsetHeight&&(o.style.height="0px",this.handlerResize_drawInitializer())}else{var o=this.getElementById(this.id+"_size_y"),r=this.getElementById(this.id+"_scrollY_div"),a=o.offsetHeight;if(a<1e6&&(a=parseInt(o.style.height,10)),o.style.height=r.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",t=Math.min(t,this.lastTopRowIndex),this.hasSubtotal&&this.struct.subtotalArr&&this.struct.subtotalArr.length>0)this.lastTopRowIndex+=this.struct.subtotalArr.length,this.drawData(t);else{var n=this.oneRowScrollHeight*t;t!==this.rowIndex?this.drawData(t):r.scrollTop!==n&&(this.bScrollY=n,r.scrollTop=n),this.handlerResize_drawInitializer()}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getCellVisible=function(t,e){try{e=this.getColumnIndex(e);return!0!==this.hiddenCellObj[t+"_"+e]}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.clearCellVisible=function(t){try{for(var e in void 0!==t&&null!=t||(t={}),this.hiddenCellObj)if(!0===this.hiddenCellObj[e]){var i=e.split("_"),o=Number(i[0]),r=Number(i[1]),a=this._getTdElem(o,r);null!=a&&(a.style.display="")}this.hiddenCellObj={length:0,init:!1},!0!==t.skipDraw&&this.cutGridBottom(this.lastIndex)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._moveCellVisible=function(t,e,i){try{if(!(this.hiddenCellObj.length>0))return;void 0!==i&&null!=i||(i={});var r=[];t.sort((function(t,e){return t-e}));for(var a={},n=0;n<t.length;n++)a[t[n]]=!0;var l=this.getRowCount();for(n=0;n<l;n++)!0===i.remove&&!0===a[n]||r.push(n);!0===i.insert&&(r=r.slice(0,e).concat(t).concat(r.slice(e)));var h={};for(n=0;n<r.length;n++)r[n]!==n&&(h[r[n]]=n);var d=o.q.extend({},this.hiddenCellObj),u=this.getColumnCount();for(var p in h){var c=Number(p),g=h[c];if(c!==g)for(var f=0;f<u;f++)this.setCellVisible(g,f,!d[c+"_"+f])}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._refreshRowVisible=function(t){try{this._applyRowVisible(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setScrollLeft=function(t){t=parseInt(t,10);try{this.getElementById(this.id+"_scrollX_right").scrollLeft=t}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setScrollTop=function(t){t=parseInt(t,10);try{this.scrollEvent=!0,this.getElementById(this.id+"_scrollY_div").scrollTop=t}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getScrollLeft=function(){try{return this.getElementById(this.id+"_scrollX_right").scrollLeft}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getScrollTop=function(){try{return this.getElementById(this.id+"_scrollY_div").scrollTop}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setGridStyle=function(t){try{if(!t)return;if("string"==typeof t){t=t.match(/"\s*N\s*"\s*:\s*"\s*w2:gridView\s*"/)?JSON.parse(t):WebSquare.xml.parse(t)}t instanceof WebSquare.Elem&&(t=t._element),!0===WebSquare.convertPageXML&&r.I.isXML(t)&&(t=WebSquare.xmljs.xml2json(t).E[0]),!0===r.I.isXML(t)&&9==t.nodeType&&(t=t.documentElement);var e=this.getParent()
;e&&e.parentControl&&("wframe"==e.parentControl.options.pluginName||"pageFrame"==e.parentControl.options.pluginName)&&(e=e.parentControl);var i,o=this.scope_obj,a=this.parentFrame;this.options.groupbyFilterBox&&this.options.customFilterBox&&this.groupbyFilterBox_history.length>0&&(i=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo),this.remove(),this.__removed_object__=!0;var n=WebSquare.controlFactory.create(null,null,t,o,a);n.options&&isNaN(n.options.fixedRightColumn)&&(n.options.fixedRightColumn=0),n.writeTo(e),n.activate(),n.onComplete(),n.options.groupbyFilterBox&&n.options.customFilterBox&&(n.refreshGroupbyFilterBox(),n.applyFilterHistory(),i?(n.customFilterList.customFilterListFilterInfo=JSON.parse(i,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.A)(i)&&i.constructor===RegExp?i:"object"===(0,l.A)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})),n.groupbyFilterBox_history[n.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo=i):n.customFilterList&&(n.customFilterList.customFilterListFilterInfo={}));var h=n.options._sortStatus;if(h){for(var d=JSON.parse(h),u=[],p=[],c=[],g=0;g<d.length;g++){var f=d[g];u.push(f.colID),p.push(f.sortOrder),c.push(f.dataType)}n.dataList.setFilter({type:"sort",sortIndex:u.join(" "),sortOrder:p.join(" "),dataType:c.join(" "),focuseMode:n.options.filterFocusMode,ignoreEmptyStringOnSort:n.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:n.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:n.options.setEmptyStringSortableOnSort}),n.drawHeaderSortImages()}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getGridStyle=function(){try{return"json"===this.element._elementType?WebSquare.jsonUtil.serialize(this.element._element):WebSquare.xml.serialize(this.element._element)}catch(t){s.Y.printStackTrace(t)}},f.prototype.getCurrentGridStyle=function(){try{var t=this.element.cloneNode(!0);t.setAttribute("columnOrder",this.getColumnOrder()),t.setAttribute("fixedColumn",this.options.fixedColumn),t.setAttribute("fixedRow",this.options.fixedRow),t.setAttribute("fixedRightColumn",this.options.fixedRightColumn);for(var e=t.getChildNodes(),i=0;i<e.length;i++){if("w2:header"==e[i].getTagName())for(var o=e[i].getChildNodes(),r={},n=0,l=this.htmlInfo.head.rowAttrArr.length,h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){for(var d=o[h].getChildNodes(),u=[],p=0;p<d.length;p++)"w2:column"==d[p].getTagName()&&u.push(d[p]);for(var c=0,g=0,f={},m=0;m<u.length;m++){for(;null!=r[i]&&null!=r[i][m+c+g];)g+=r[i][m+c+g];f[m+c-0+g]=m;var y=parseInt(u[m].getAttribute("colSpan"),10)||1;if((x=parseInt(u[m].getAttribute("rowSpan"),10)||1)>1)for(var b=n;b<n+x-1;b++)null==r[b+1]&&(r[b+1]={}),null==r[b+1][m-0+c+g]?r[b+1][m-0+c+g]=y:r[b+1][m-0+c+g]+=y;y>1&&(c+=y-1)}if(n===l-1){var v=0,w=0;for(m=0;m<u.length;m++){for(;null!=r[n]&&null!=r[n][this.columnOrder[m+w+v]];)w+=r[n][this.columnOrder[m+w+v]];null==(_=f[[this.columnOrder[m-0+v+w]]])&&(_=0);var C=u[_];(y=parseInt(C.getAttribute("colSpan"),10))>1&&(v+=y-1),C.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v+w]),this.hiddenList[m+this.defaultColCnt+v+w]?C.setAttribute("hidden","true"):C.setAttribute("hidden","false")}}else if(0===n){var I=0;for(p=0;p<u.length;p++){var _,x=parseInt(u[p].getAttribute("rowSpan"),10)||1;null==(_=f[[this.columnOrder[p-0+I]]])&&(_=0);C=u[_];(y=parseInt(C.getAttribute("colSpan"),10))>1&&(I+=y-1),x===l&&(C.setAttribute("width",this.colWidthList[p+this.defaultColCnt+I]),this.hiddenList[p+this.defaultColCnt+I]?C.setAttribute("hidden","true"):C.setAttribute("hidden","false"))}}n++}if("w2:gBody"==e[i].getTagName())for(o=e[i].getChildNodes(),h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){var S=o[h].getChildNodes(),R=[];for(p=0;p<S.length;p++)"w2:column"==S[p].getTagName()&&R.push(S[p]);for(c=0,f={},m=0;m<R.length;m++){f[m+c]=m,
(y=parseInt(R[m].getAttribute("colSpan"),10))>1&&(c+=y-1)}for(v=0,m=0;m<R.length;m++){C=R[f[[this.columnOrder[m+v]]]];(y=parseInt(C.getAttribute("colSpan"),10))>1&&(v+=y-1),C.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v]),a.Z.isChrome()?C.setAttribute("hidden",this.hiddenList[m+this.defaultColCnt+v]):this.hiddenList[m+this.defaultColCnt+v]?C.setAttribute("hidden","true"):C.setAttribute("hidden","false");var D=C.getAttribute("col_id");D&&(C.setAttribute("id",D),C.removeAttribute("col_id"))}}}var T=this.getSortableStatus();return T&&T.length>0&&t.setAttribute("_sortStatus",JSON.stringify(T)),t.serialize()}catch(t){s.Y.printStackTrace(t)}},f.prototype.setTableStruct=function(){try{if(this.headerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"header",r.I._XML_NAMESPACE.W2)[0],this.bodyXml=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",r.I._XML_NAMESPACE.W2)[0],this.struct={head:this.xml2JSON(this.headerXml),body:this.xml2JSON(this.bodyXml)},this.updateStruct(this.struct.head.rowArr),this.updateStruct(this.struct.body.rowArr),this.changeRowID(this.struct.head.rowAttrArr),this.changeRowID(this.struct.body.rowAttrArr),this.footerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0],this.footerXml&&(this.hasFooter=!0,this.struct.foot=this.xml2JSON(this.footerXml),this.updateStruct(this.struct.foot.rowArr)),this.subtotalXmlArr=WebSquare.Elem.api.getElementsByTagName(this.element,"subTotal",r.I._XML_NAMESPACE.W2),this.subtotalXmlArr.length>0){this.options.showLastRow=!1,this.hasSubtotal=!0,this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0,this.struct.subtotalArr=[];for(var t=0;t<this.subtotalXmlArr.length;t++){var e=this.xml2JSON(this.subtotalXmlArr[t]);this.struct.subtotalArr.push(e),this.struct.subtotalArr[e.attr.id]=e,this.updateStruct(e.rowArr)}}if(this.setCss(),this.setColArr(),this.htmlInfo={head:this.getHeaderHtmlInfo(),body:this.getBodyHtmlInfo()},this.footerXml&&(this.htmlInfo.foot=this.getFooterHtmlInfo()),this.subtotalXmlArr.length>0){this.htmlInfo.subtotalArr=[],this.subtotalStrList={};for(t=0;t<this.struct.subtotalArr.length;t++){e=this.getSubtotalHtmlInfo(this.struct.subtotalArr[t]);this.htmlInfo.subtotalArr.push(e),this.htmlInfo.subtotalArr[e.attr.id]=e,this.subtotalStrList[e.attr.targetColumnID]=e}}this.captionXml=WebSquare.Elem.api.getElementsByTagName(this.element,"caption",r.I._XML_NAMESPACE.W2)[0];var i=this.getColCnt();this.columnOrder=[];for(t=0;t<i;t++)this.columnOrder.push(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.updateStruct=function(t){try{for(var e=0,i=[],o=this.getColCnt(),r=0;r<t.length;r++){for(var a=[],n=0;n<o;n++)a.push(null);i.push(a)}for(r=0;r<t.length;r++)for(n=0;n<t[r].length;n++){var l;for(l=0;l<i[r].length&&null!==i[r][l];l++);var h=t[r][n];h["@col"]=l;for(var d=h.colSpan||h.colspan||1,u=h.rowSpan||h.rowspan||1,p=0;p<u;p++)for(var c=0;c<d;c++)i[r+p][l+c]=e;e++}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.changeRowID=function(t){try{for(var e=0;e<t.length;e++){var i=t[e];null!=i.id&&(i["data-tr-id"]=i.id,delete i.id)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getRealColIndex=function(t,e){try{for(var i=0;i<this.htmlInfo[t].rowArr.length;i++)for(var o=0;o<this.htmlInfo[t].rowArr[i].length;o++)if(this.htmlInfo[t].rowArr[i][o].col_id==e)return this.htmlInfo[t].rowArr[i][o]["@col"];return null}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getRealHeaderColIndex=function(t){try{return this.getColumnIndex(this.headerToBodyRelation[t])}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getDataColIndex=function(t){try{return this._dataList.getColumnIndex(this.getColumnID(t))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._moveColumn=function(t,e,i,o,r,a){try{e=e||"td";for(var n=[],l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&n.push(t[i].childNodes[l]);var h=n[o];h.parentNode.removeChild(h);var d=[]
;for(l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&d.push(t[i].childNodes[l]);if(a<d.length){var u=d[a];u.parentNode.insertBefore(h,u)}else t[r].appendChild(h)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.moveBodyColumn=function(t,e,i,o){try{var r=this.htmlInfo.body.rowArr[t].splice(e,1);this.htmlInfo.body.rowArr[i].splice(o,0,r[0]),this.updateStruct(this.htmlInfo.body.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=this.getElementById(this.id+"_body_tbody"),n=0;this.hasSubtotal&&this.drawedSubtotal&&this.drawedSubtotal.length>0&&(n=this.drawedSubtotal[0].length);for(var l=0;l<this.drawedRowLength;l++){for(var h=[],d=0;d<this.oneRowLength;d++)h.push(a.rows[l*(this.oneRowLength+n)+d+n]);this._moveColumn(h,"td",t,e,i,o);for(d=0;d<n;d++)if(0===t&&0===i){var u=d>0?this.defaultColCnt:0;this._moveColumn([a.rows[l*(this.oneRowLength+n)+d]],"td",0,e-u,0,o-u)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.moveHeadColumn=function(t,e,i,o){try{var r=this.htmlInfo.head.rowArr[t].splice(e,1);this.htmlInfo.head.rowArr[i].splice(o,0,r[0]),this.updateStruct(this.htmlInfo.head.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=this.getElementById(this.id+"_head_table");this._moveColumn(a.rows,"th",t,e,i,o)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._moveFooterColumn=function(t,e,i,o){try{var r=this.htmlInfo.foot.rowArr[t].splice(e,1);this.htmlInfo.foot.rowArr[i].splice(o,0,r[0]),this.updateStruct(this.htmlInfo.foot.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumn(a.rows,"td",t,e,i,o)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.moveFooterColumn=function(t,e){try{var i,o,r=parseInt(t,10),a=[];"string"==typeof t&&isNaN(r)?(o="id",i=t):(o="@col",i=this.colIndexes.footerColInfo.colIndexArr[r+this.defaultColCnt]-this.defaultColCnt);for(var n=0;n<this.htmlInfo.foot.rowArr.length;n++)for(var l=0;l<this.htmlInfo.foot.rowArr[n].length;l++)this.htmlInfo.foot.rowArr[n][l][o]==i&&a.push({row:n,col:l});var h,d,u=parseInt(e,10);"string"==typeof e&&isNaN(u)?(d="id",h=e):(d="@col",h=this.colIndexes.footerColInfo.colIndexArr[u+this.defaultColCnt]-this.defaultColCnt);for(n=0;n<a.length;n++){var p=null;for(l=0;l<this.htmlInfo.foot.rowArr[a[n].row].length;l++)if(this.htmlInfo.foot.rowArr[a[n].row][l][d]==h){p=l;break}null!==p?this._moveFooterColumn(a[n].row,a[n].col,a[n].row,p):this._moveFooterColumn(a[n].row,a[n].col,a[n].row,u)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.moveColumnByHeaderId=function(t,e){try{if(!t||!e||t===e)return!1;var i=this.getHeaderColIndex(t),o=this.getHeaderColIndex(e);if(isNaN(i)||isNaN(o))return!1;var r=this.columnBlock.hash[i-this.defaultColCnt],a=this.columnBlock.hash[o-this.defaultColCnt];if(r===a)return!1;var n=this.getFixedColumnLastIndex();if(this.options.fixedColumnNoMove&&(n>r||n>a))return!1;for(var l=-1,h=-1,d=0;d<this.columnOrder.length;d++){var u=this.columnOrder[d];if(u===r&&(l=d),u===a&&(h=d),l>-1&&h>-1)break}var c=this.headerToBodyRelation[t],g=this.headerToBodyRelation[e];if(!1===p.f.fireEvent(this,"onbeforecolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}))return!1;this.columnBlock||this.createBlockedHeaderInfo();var f=this.getColumnOrder(),m=-1,y=-1;for(d=0;d<f.length;d++){var b=f[d];if(b===r?m=d:b===a&&(y=d),-1!==m&&-1!==y)break}var v=this.columnBlock.info[r],w=this.columnBlock.info[a],C=f.slice(0);C.splice(m,v.length);var I=y+(m<y?w.length-v.length:0),_=C.slice(0,I).concat(v).concat(C.slice(I)),x=this.setColumnOrder(_);return p.f.fireEvent(this,"onaftercolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}),x}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.moveColumn=function(t,e){try{if(t==e)return
;if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>t+this.defaultColCnt||this.getFixedColumnLastIndex()>e+this.defaultColCnt))return;var i=this.getHeaderID(t),o=this._getRealColIndex("head",i)+this.defaultColCnt,r=this.headerToBodyRelation[i];if(!r||this.colMoveBolockedHeaderObj[i])return;var a=this.colMoveIndexMap[r],n=this._getRealColIndex("body",r)+this.defaultColCnt,l=this.getHeaderID(e),h=this.headerToBodyRelation[l];if(!h||this.colMoveBolockedHeaderObj[l])return;var d=this._getRealColIndex("head",l)+this.defaultColCnt,u=this.colMoveIndexMap[h],c=this.colIndexes.bodyColInfo.colIndexArr[u+this.defaultColCnt];if(!1===p.f.fireEvent(this,"onbeforecolumnmove",{startColumnID:r,startColumnIndex:a,endColumnID:h,endColumnIndex:u}))return!1;for(var g=[],f=n-this.defaultColCnt,m=0;m<this.htmlInfo.body.rowArr.length;m++)for(var y=0;y<this.htmlInfo.body.rowArr[m].length;y++)this.htmlInfo.body.rowArr[m][y]["@col"]==f&&g.push({row:m,col:y});var b=c-this.defaultColCnt;for(m=0;m<g.length;m++){var v=null;for(y=0;y<this.htmlInfo.body.rowArr[g[m].row].length;y++)if(this.htmlInfo.body.rowArr[g[m].row][y]["@col"]==b){v=y;break}null!==v?this.moveBodyColumn(g[m].row,g[m].col,g[m].row,v):this.moveBodyColumn(g[m].row,g[m].col,g[m].row,u)}g=[];var w=o-this.defaultColCnt;for(m=0;m<this.htmlInfo.head.rowArr.length;m++)for(y=0;y<this.htmlInfo.head.rowArr[m].length;y++)this.htmlInfo.head.rowArr[m][y]["@col"]==w&&g.push({row:m,col:y});var C=d-this.defaultColCnt;for(m=0;m<g.length;m++){for(v=null,y=0;y<this.htmlInfo.head.rowArr[g[m].row].length;y++)if(this.htmlInfo.head.rowArr[g[m].row][y]["@col"]==C){v=y;break}null!==v?this.moveHeadColumn(g[m].row,g[m].col,g[m].row,v):this.moveHeadColumn(g[m].row,g[m].col,g[m].row,e)}this.hasFooter&&this.options.columnMoveWithFooter&&this.moveFooterColumn(t,e);var I=function(t,e,i){var o=t.splice(e,1);t.splice(i,0,o[0])};if(null!=this.initVisibilityArr)for(m=0;m<this.htmlInfo.body.rowArr.length;m++)I(this.initVisibilityArr,n+m*this.getColCnt(),c+m*this.getColCnt());for(var _ in I(this.columnOrder,n-this.defaultColCnt,c-this.defaultColCnt),I(this.colIndexInfo.body.colInfo.colIndexMatch,n,c),I(this.colWidthList,n,c),I(this.hiddenList,o,d),this.colMoveIndexMap)this.colMoveIndexMap[_]==a?this.colMoveIndexMap[_]=u:a<u?a<this.colMoveIndexMap[_]&&this.colMoveIndexMap[_]<=u&&(this.colMoveIndexMap[_]-=1):a>u&&a>this.colMoveIndexMap[_]&&this.colMoveIndexMap[_]>=u&&(this.colMoveIndexMap[_]+=1);for(var _ in this.colMoveHeaderIndexMap)this.colMoveHeaderIndexMap[_]==a?this.colMoveHeaderIndexMap[_]=u:a<u?a<this.colMoveHeaderIndexMap[_]&&this.colMoveHeaderIndexMap[_]<=u&&(this.colMoveHeaderIndexMap[_]-=1):a>u&&a>this.colMoveHeaderIndexMap[_]&&this.colMoveHeaderIndexMap[_]>=u&&(this.colMoveHeaderIndexMap[_]+=1);this.arrangeOverflowXScroll(),this._handleScrollX(),p.f.fireEvent(this,"onaftercolumnmove",{startColumnID:r,startColumnIndex:a,endColumnID:h,endColumnIndex:u})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.resetMoveColumn=function(){try{for(var t=this.getColCnt(),e=[],i=0;i<t;i++)e.push(i);this.setColumnOrder(e)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setColumnOrder=function(t){try{if(!a.Z.isEmptyObject(this.cellMergeInfo))return void c.v.printLog("warning : setColumnOrder refused due to mergeCells. ["+this.id+"]");t=t.slice();if(!this.render||0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0},this.setRedrawStatus("stop"),void this.delayedDraw({newColumnOrder:t});var e=this.getColCnt(),i=[];"string"==typeof t&&(t=t.split(","));for(var o=0;o<t.length;o++){if(null!=this.bodyIdColIndexMap[t[o]]&&(t[o]=this.bodyIdColIndexMap[t[o]]),t[o]=Number(t[o]),"number"!=typeof t[o])return void $l(this.id+".setColumnOrder : wrong column order array.");i[t[o]]=!0}if(e>t.length){for(o=0;o<t.length;o++)t[o]=this.colIndexes.headerColInfo.colIndexArr[t[o]+this.defaultColCnt]-this.defaultColCnt;for(o=0;o<t.length;o++){var r=this.getCellInfo(t[o]).options.colSpan
;if(r>1)for(var n=1;n<r;n++)t.splice(o+n,0,t[o]+n)}for(o=0;o<t.length;o++)i[t[o]]=!0}for(o=t.length-1;o>=0;o--)for(n=o-1;n>=0;n--)t[o]===t[n]&&t.splice(o,1);for(o=0;o<e;o++)i[o]||t.push(o);if(e!=t.length)return $l(this.id+".setColumnOrder : wrong column order array."),!1;var l=[];for(o=0;o<t.length;o++)for(n=0;n<this.columnOrder.length;n++)if(this.columnOrder[n]==t[o]){l[o]=n;break}if(!0===this.checkRefreshAdaptive()&&this.removeAdaptive(),this.columnOrder=l.slice(0),this.drawedRowLength<=0&&this.drawDataTable(),this._moveColumnByOrder(this.id+"_body_tbody",this.htmlInfo.body.rowArr),this._moveColumnByOrder(this.id+"_head_table",this.htmlInfo.head.rowArr),this.hasFooter&&this.options.columnMoveWithFooter){var h=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumnByOrder(h.getAttribute("id"),this.htmlInfo.foot.rowArr)}if(null!=this.initVisibilityArr){var d=[];for(o=0;o<this.initVisibilityArr.length-this.defaultColCnt;o++){var u=Math.floor(o/this.columnOrder.length),p=o%this.columnOrder.length,g=u*this.columnOrder.length+this.columnOrder[p]+this.defaultColCnt;d.push(this.initVisibilityArr[g])}for(o=0;o<d.length;o++)this.initVisibilityArr[o+this.defaultColCnt]=d[o]}this._swapItem(this.colIndexInfo.body.colInfo.colIndexMatch,this.columnOrder,this.defaultColCnt),this._swapItem(this.colWidthList,this.columnOrder,this.defaultColCnt),this.initialColWidthList=this.colWidthList.slice(),this._swapItem(this.hiddenList,this.columnOrder,this.defaultColCnt),"allColumn"===this.options.autoFit&&this._swapItem(this.autoFitColWidthList,this.columnOrder,this.defaultColCnt);for(o=0;o<this.tdIdList.length;o++)for(n=0;n<t.length;n++)if(o==t[n]){this.colMoveIndexMap[this.tdIdList[o]]=n,this.colMoveHeaderIndexMap[this.thIdList[o]]=n;break}return this.columnOrder=t.slice(0),this.arrangeOverflowXScroll(),this._handleScrollX(),!0===this.checkRefreshAdaptive()&&this.addAdaptive(),!0}catch(t){return s.Y.printStackTrace(t,null,this),!1}},f.prototype._moveColumnByOrder=function(t,e){try{var i=document.getElementById(t),o=[],r={},n=e.length;(isNaN(n)||n<=0)&&(n=1);for(var l=0;l<n;l++){if(!(I=i.rows[l]))break;var h=0;0===l&&(h=this.defaultColCnt);for(var d={},u=0,p=0,c=h;c<I.childNodes.length;c++){for(;null!=r[l]&&null!=r[l][c+u+p];)p+=r[l][c+u+p];d[c+u-h+p]=c;var g=parseInt(I.childNodes[c].getAttribute("colSpan"),10)||1;this.options.lazyDrawHiddenColumn&&"true"==I.childNodes[c].getAttribute("data-lazydrawtd")&&(g=1);var f=parseInt(I.childNodes[c].getAttribute("rowSpan"),10)||1;if(f>1)for(var m=l;m<l+f-1;m++)null==r[m+1]&&(r[m+1]={}),null==r[m+1][c-h+u+p]?r[m+1][c-h+u+p]=g:r[m+1][c-h+u+p]+=g;g>1&&(u+=g-1)}var y=0,b=0;o[l]=[];for(c=h;c<I.childNodes.length;c++){for(;null!=r[l]&&null!=r[l][this.columnOrder[c+b+y]];)b+=r[l][this.columnOrder[c+b+y]];var v=d[[this.columnOrder[c-h+y+b]]];null==v&&(v=0),o[l].push(v-h);var w=I.childNodes[v];g=parseInt(w.getAttribute("colSpan"),10);this.options.lazyDrawHiddenColumn&&"true"==w.getAttribute("data-lazydrawtd")&&(g=1),g>1&&(y+=g-1)}}for(l=0;l<i.rows.length;l++){h=0;var C=l%n;0===C&&(h=this.defaultColCnt);var I=i.rows[l];a.Z.isIEAllVersion()&&"11"==a.Z.browserVersion()&&l>=(this.lastIndex+1)*this.oneRowLength&&(I.style.backgroundColor="");var _=[];for(c=0;c<o[C].length;c++)_.push(I.childNodes[o[C][c]+h]);for(c=0;c<_.length;c++)I.appendChild(_[c])}for(var x,S=n-o.length;S>0;)x||(x=this.columnOrder.slice(0)),o.push(x),S--;for(l=0;l<n;l++)this._swapItem(e[l],o[l],0);this.updateStruct(e)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._swapItem=function(t,e,i){try{for(var o=[],r=null==i?0:i,a=0;a<e.length;a++)o.push(t[e[a]+r]);for(a=0;a<o.length;a++)t[a+r]=o[a]}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getColumnOrder=function(t){try{if(t){for(var e=[],i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.defaultColCnt;o<i.length;o++){if(0==i[o].length)return void $l(this.id+".getColumnOrder : use getColumnOrder(false). cannot express column order by name.")
;for(var r=this.tdIdList[i[o][0]-this.defaultColCnt],a=!1,n=0;n<e.length;n++)if(e[n]===r){a=!0;break}a||e.push(r)}return e}return this.columnOrder.slice(0)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getDisplayColumnIndex=function(t){try{for(var e=parseInt(t,10),i=0;i<this.columnOrder.length;i++)if(e===this.columnOrder[i])return i;return t}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getColumnMoveIndex=function(t){try{if(t<0||isNaN(t))return t;for(var e=this.colIndexInfo.body.colInfo.colIndexArr[t+this.defaultColCnt],i=this.colIndexInfo.body.colInfo.trIndexArr[t+this.defaultColCnt],o=this.colIndexInfo.body.colInfo.colIndexMatch[e],r=0;r<o.length;r++){var a=o[r];if(a>=t+this.defaultColCnt)break;var n=this.colIndexInfo.body.colInfo.rowSpanArr[a];n>1&&(i=i-n+1)}return o[i]-this.defaultColCnt}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleGroupbyZoneClick=function(t){try{for(var e=a.Z.getDataPrefix("header_id"),i=a.Z.getDataPrefix("col_id"),o=this.event.getTargetIterator(t,this.render);o.next()&&(!this.options.groupbyZoneSearch||!o.match("w2grid_groupbyZone_search"));){if(o.match("w2grid_groupbyZone_column")){var r=o.getElement(),n={};n.render=r,n.parentRender=this.render.getElementsByTagName("div")[0],n.headerID=r.getAttribute(e);var l=this.headerToBodyRelation[n.headerID],h=this.getColumnIndex(l);n.headerIndex=this._getColumnMoveIndex(h),n.dataIndex=this._getDataColIndex(this._getRealHeaderColIndex(n.headerID)),this.toggleGroupbyFilterList(n),p.f.stopEvent(t);break}if(o.match("w2grid_groupbyZone_column_closeButtonImg")){r=o.getElement();this.hideGroupbyFilterList(),this.ungroupColumn(r.getAttribute(i));break}if(o.match("w2grid_groupbyZone")){this.hideGroupbyFilterList(),p.f.stopEvent(t);break}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.toggleGroupbyFilterList=function(t){try{var e=t.render.tagName,i=t.headerIndex;"number"==typeof this.groupbyZoneStatus.beforeOpenedColIndex?(this.groupbyFilterList.saveState(this.groupbyZoneStatus.beforeOpenedColIndex.toString()),i==this.groupbyZoneStatus.beforeOpenedColIndex&&e==this.groupbyZoneStatus.beforeOpenedColTagName?"block"==this.groupbyFilterList.render.style.display?this.hideGroupbyFilterList():this.showGroupbyFilterList(t,!0):this.showGroupbyFilterList(t,!0,!0)):this.createGroupbyFilterList(t)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.applyFilterListFormat=function(t,e){try{var i=this.headerToBodyRelation[e],o=this.getCellInfo(i);if(this.options.displayValueOnUseFilterList)for(var r=0;r<t.length;r++)null!=t[r].id3&&(this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(r,"id2",t[r].id3):this.customFilterList.setCellDataNM(r,"id2",t[r].id3));else if(this.options.useFilterListFormat&&!this.options.useFilterSearch&&!this.options.useSearchFilter&&!o.useCustomFormatter){var a=0,n=this.headerInfoHash[e];if(n&&n.options.hideCustomFilter&&(a=1),o.options.displayFormat||o.options.displayFormatter||o.options.ioFormat)for(r=2-a;r<t.length;r++){var l=o.formatter.format(t[r].id2);this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(r,"id2",l):this.customFilterList.setCellDataNM(r,"id2",l)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.createGroupbyFilterList=function(t){try{var e=t.render,i=t.parentRender,o=t.headerIndex,r=t.headerID;if(!this.groupbyFilterList){this.groupbyStatus.filter={};"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >","        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>",
"        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>","    </w2:listRow>","</w2:list>";var n=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>    </w2:listRow></w2:list>",!0).documentElement;this.groupbyFilterList=new WebSquare.uiplugin.list(this.id+"_groupbyZone_list","",n),this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]};var l=this;this.groupbyFilterList._handleClickEvent=this.groupbyFilterList.handleClickEvent,this.groupbyFilterList.handleClickEvent=function(t){try{p.f.stopPropagation(t);var e=p.f.getTarget(t),i=e;if((e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")||e.className.match("w2grid_groupbyZone_list_listColumn_text"))&&(i=e.parentElement),!i.className.match("w2grid_groupbyZone_list_listRow"))return;var o=i.children[0],r=l.getHeaderID(this.headerIndex),n=l.getColumnID(this.headerIndex);0==this.isGroupbyColumn&&(r=this.currentHeaderID,n=l.headerToBodyRelation[r]);var h=a.Z.getDataPrefix("unique_id"),d=i.getAttribute(h),u=this.getAllData(),c=l.getCellInfo(n);if(this.options.useFilterSearch&&this.options.useFilterListFormat&&c.formatter&&(c.options.displayFormat||c.options.displayFormatter||c.options.ioFormat))for(var g=2;g<u.length;g++)u[g].id2=c.formatter.unformat(u[g].id2);u[0].customerFilter&&u[0][h]==d?e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")&&this._handleClickEvent(t):this._handleClickEvent(t);var f=o.checked,m=!1,y=!1,b=!1;if(u[0].customerFilter&&u[0][h]==d){if(!e.className.match("w2grid_groupbyZone_list_listColumn_checkbox"))return l.firstOpenCustomFilter[r]||(l.firstOpenCustomFilter[r]=!0),void(l.options.groupbyFilterIcon?l._showCustomFilter(r):l.showCustomFilter(r));if(f)return l.firstOpenCustomFilter[r]?(l._dataList.filterManager.headerID=r,l._dataList.filterManager.targetColID=n,void l.setCustomFilterExpression()):(l.hideGroupbyFilterList(),l.firstOpenCustomFilter[r]||(l.firstOpenCustomFilter[r]=!0),void(l.options.groupbyFilterIcon?l._showCustomFilter(r):l.showCustomFilter(r)));for(var v in l.customFilterStatusObj[r]=!1,l.dataList.removeColumnFilter(n),l.customFilterStatusObj)if(l.customFilterStatusObj[v])return;m=!0,y=!0,b=!0;for(g=1;g<u.length;g++)u[g].id1=!0}else if(u[1].gridCheckedAll&&u[1][h]==d){y=!0,f&&(b=!0);for(g=2;g<u.length;g++)u[g].id1=f}if(!m&&!b&&u.length-2>0){l.groupbyStatus.filter[n]=[];for(g=2;g<u.length;g++)u[g].id1&&l.groupbyStatus.filter[n].push(u[g].id2);l.groupbyStatus.filter[n]=l.changeItemValue("value",n,l.groupbyStatus.filter[n]);var w=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(g=0;g<l.groupbyStatus.filter[n].length;g++){var C=l.groupbyStatus.filter[n][g];"string"==typeof C&&(l.groupbyStatus.filter[n][g]=C.replace(w,(function(t){return l.replacechar(t)})))}}if(y){if(b&&this.filterHistory.column[0]===n)this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),delete l.groupbyStatus.filter[n];else if(!b&&this.filterHistory.column[0]!==n&&u.length-2>0){for(g=1;g<this.filterHistory.column.length;g++)if(this.filterHistory.column[g]===n){l.dataList.removeColumnFilter(n,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(n),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else{var I=u.length-2;if(I>l.groupbyStatus.filter[n].length){if(u[1].id1=!1,this.filterHistory.column[0]!==n){
for(var g=1;g<this.filterHistory.column.length;g++)if(this.filterHistory.column[g]===n){l.dataList.removeColumnFilter(n,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(n),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else l.groupbyStatus.filter[n].length==I&&(u[1].id1=!0,delete l.groupbyStatus.filter[n],this.filterHistory.column[0]===n&&(this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()))}this.setFirstRowIndex(this.firstListIndex,!0);var _={};if(_.sortIndex=l.groupbyStatus.sortIndexArr,_.sortOrder=l.groupbyStatus.sortOrderArr,null!=l.groupbyStatus.filter&&(_.filter=l.groupbyStatus.filter,l.groupbyStatus.filter[n]&&2*l.groupbyStatus.filter[n].length>u.length)){var x=[],S="*";for(g=2;g<u.length;g++)if(!u[g].id1){if(u[g].id2===l.filterEmptyStr||u[g].id2===l.filterNullStr){S="+";continue}x.push(u[g].id2)}((c=l.getCellInfo(n)).itemsetObj||c.itemArr)&&(x=l.changeItemValue("value",n,x));var R="^\\n*(?:(?!^";for(w=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,g=0;g<x.length;g++){var D=x[g];"string"==typeof D&&(D=D.replace(w,(function(t){return l.replacechar(t)}))),R+=D+="$)(?!^"}R+="$).)"+S+"\\n*$",_.filterRegExp={},_.filterRegExp[n]=new RegExp(R,"gi")}if(_.noRefreshAfter=!0,!1===p.f.fireEvent(l,"ongroupby",_)){var T=l.getColCnt()+l.defaultColCnt,L=WebSquare.language.getMessage("Grid_cases")||"cases";_.rowNumHeader={colSpan:T,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+L+" ] ' ",align:"left"},_.footerVisible=!1,_.rowNumFooter={colSpan:T},l.groupby(_)}l.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},this.groupbyFilterList.writeTo(this),this.groupbyFilterList.activate()}if(!0===t.noDraw)return;var h=e.clientWidth,d=WebSquare.style.getRelativeTop(e,i)+e.offsetHeight,u=WebSquare.style.getRelativeLeft(e,i);this.groupbyFilterList.setPosition(u,d),this.groupbyFilterList.render.style.width=h+"px";var c=this.render.offsetHeight-d;this.groupbyFilterList.options.visibleRowNum=Math.floor(c/21);var g=this.getGroupbyDepthInfo(t);if(this.groupbyFilterList.setJSON(g),this.applyFilterListFormat(g,r),this.groupbyFilterList.currentHeaderID=r,this.groupbyFilterList.headerIndex=o,this.groupbyFilterList.isGroupbyColumn=t.isGroupbyColumn,WebSquare.style.show(this.groupbyFilterList.render),a.Z.getBoolean(this.headerInfoHash[r].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)){var f=this.groupbyFilterList.getMaxItemWidth();f>h&&(this.groupbyFilterList.render.style.width=f+"px")}this.groupbyFilterList.focus(),this.groupbyZoneStatus.beforeOpenedColIndex=o,this.groupbyZoneStatus.beforeOpenedColTagName=e.tagName}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.showGroupbyFilterList=function(t,e,i){try{var o=t.render,r=t.parentRender,n=t.headerIndex,l=t.headerID;if(this.groupbyFilterList.currentHeaderID=t.headerID,this.groupbyFilterList.headerIndex=n,this.groupbyZoneStatus.beforeOpenedColIndex=n,this.groupbyZoneStatus.beforeOpenedColTagName=o.tagName,WebSquare.style.show(this.groupbyFilterList.render),this.groupbyFilterList.focus(),e){var h,d=WebSquare.style.getRelativeTop(o,r)+o.offsetHeight,u=WebSquare.style.getRelativeLeft(o,r),p=this.render.offsetHeight-d;this.groupbyFilterList.options.visibleRowNum=Math.floor(p/21);var c=this.getGroupbyDepthInfo(t);this.groupbyFilterList.setJSON(c),!0===i&&this.groupbyFilterList.loadState(n),a.Z.getBoolean(this.headerInfoHash[l].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)?(h=this.groupbyFilterList.getMaxItemWidth(),o.clientWidth>h&&(h=o.clientWidth)):h=o.clientWidth,this.groupbyFilterList.setPosition(u,d),this.groupbyFilterList.render.style.width=h+"px",this.applyFilterListFormat(c,l)}else if(!0===i){this.groupbyFilterList.loadState(n);c=this.getGroupbyDepthInfo(t);this.applyFilterListFormat(c,l)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.hideGroupbyFilterList=function(){try{
this.groupbyFilterList&&(WebSquare.style.hide(this.groupbyFilterList.render),this.groupbyFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.groupbyFilterList.isChanged=!1))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getGroupbyDepthInfo=function(t){try{t.headerIndex;var e,i=t.headerID,o=this.headerToBodyRelation[i];0==t.isGroupbyColumn&&(o=this.headerToBodyRelation[i]),e=this.groupbyFilterList.filterHistory.column[0]===o?this.groupbyFilterList.filterHistory.filteredRowIndexArr[0]:this._dataList.filteredRowIndexArr;var r=this.dataList.getColData(o,e),a=this.getCellInfo(o),n=this.getUniqueValueOfArray(r),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("");var h,d,u=this.changeItemValue("label",o,n.slice(0)),p=this.customFilterStatusObj[i]||!1,c=WebSquare.language.getMessage("Grid_Customized_Filter")||"Customized Filter",g=WebSquare.language.getMessage("Grid_checked_all")||"choose all",f=[];f.push({id1:p,id2:c,customerFilter:!0}),f.push({id1:!p,id2:g,gridCheckedAll:!0}),!p&&this.groupbyStatus.filter&&o in this.groupbyStatus.filter&&(d=(h=this.groupbyStatus.filter[o]).slice(0));for(var m=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,y=this,b=0;b<u.length;b++){var v={};if(d){var w=!1,C=a.itemArr?a.itemHash[u[b]]:u[b];"string"==typeof C&&(C=C.replace(m,(function(t){return y.replacechar(t)})));for(var I=d.length-1;I>-1;I--){if(C==d[I]){w=!0,d.splice(I,1);break}if("string"==typeof d[I]){for(var _=!1,x=0;x<l.length;x++)if(l[x]==d[I]){_=!0;break}if(_&&(u[b]==this.options.useFilterEmptyMsg||u[b]==this.filterEmptyStr)){w=!0;break}}}v.id1=w}else v.id1=!p;v.id2=u[b],this.options.displayValueOnUseFilterList&&(v.id3=n[b]),f.push(v)}if(h){var S=!0,R=f;for(b=2;b<R.length;b++)if(!R[b].id1){S=!1;break}f[1].id1=!!S}return this._dataList.getDataLength()||(f[1].id1=!1),f}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.showGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(this.groupbyZoneStatus.groupbyZoneRender.offsetHeight>0)return;if(WebSquare.style.show(this.groupbyZoneStatus.groupbyZoneRender),this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.Y.printStackTrace(t,null,this)}this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.hideGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(0==this.groupbyZoneStatus.groupbyZoneRender.offsetHeight)return;if(this.dom[this.id+"_main_div"].style.top="0px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight+this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.Y.printStackTrace(t,null,this)}WebSquare.style.hide(this.groupbyZoneStatus.groupbyZoneRender),this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.showGroupbyZoneMessage=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.show(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.hideGroupbyZoneMessage=function(){try{if(this.options.groupbyZone&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.hide(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.syncWithGroupbyZone=function(){try{if(this.groupbyStatus.grouped&&this.options.groupbyZone){this.clearGroupbyZone();for(var t=a.Z.getDataPrefix("header_id"),e=a.Z.getDataPrefix("col_id"),i=this.groupbyStatus.sortIndexArr,o=0;o<i.length;o++){
var r=i[o],n=this.getColumnID(r),l=this.bodyToHeaderRelation[n],h=document.createElement("div");h.setAttribute(t,l),h.className="w2grid_groupbyZone_column";var d=document.createElement("div");d.className="w2grid_groupbyZone_column_closeButtonDiv";var u=document.createElement("div");u.className="w2grid_groupbyZone_column_closeButtonImg",u.setAttribute(e,n);var p=document.createElement("div");p.className="w2grid_groupbyZone_column_labelDiv";var c=document.createElement("span"),g="textContent"in c?"textContent":"innerText";c[g]=this.getHeaderValue(l).replace(/<(\/)?br(\\s)*(\/)?>/gi," "),c.setAttribute("title",c[g]),p.appendChild(c),d.appendChild(u),h.appendChild(p),h.appendChild(d),this.groupbyZoneStatus.groupbyZoneRender.appendChild(h),c.className="w2grid_groupbyZone_column_value"}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.clearGroupbyZone=function(){try{if((this.groupbyStatus.grouped||this.clearGrouping)&&this.options.groupbyZone){for(var t=this.groupbyZoneStatus.groupbyZoneRender,e=t.childNodes,i=[],o=0;o<e.length;o++)null!=e[o].className.match("w2grid_groupbyZone_column")&&i.push(e[o]);for(o=0;o<i.length;o++)t.removeChild(i[o])}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.handleChangeGroupDepth=function(t){try{for(var e=a.Z.getDataPrefix("header_id"),i=this.event.getTargetIterator(t);i.next();)if(i.match("w2grid_groupbyZone_column")){this.addClass("w2noselect"),a.Z.emptySelection();var o=i.getElement().getAttribute(e),r=this.getHeaderIndex(o),n=this.getHeaderValue(o),l=this;return void WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_column_drag",contents:n,delay:15,applyMousePosition:!0,onDrop:function(t,i,o,s,a,n,h){var d,u=null;for(this.isMobile?(u=new WebSquare.targetIterator(document.elementFromPoint(h.changedTouches[0].clientX,h.changedTouches[0].clientY)),h.preventDefault()):u=l.event.getTargetIterator(h);u.next();){if(u.match("w2grid_groupbyZone_column")){d=l.getHeaderIndex(u.getElement().getAttribute(e));break}if(u.match("w2grid_groupbyZone")){var p=l.groupbyStatus.sortIndexArr;d=p[p.length-1];break}if(u.match(null,null,"body"))return}r!=d&&(!1===l.options.noSelect&&!1===l.options.preventCopy&&l.removeClass("w2noselect"),l.hideGroupbyFilterList(),l.changeGroupDepth(r,d))}})}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.createContextMenu=function(t,e){try{if("object"===(0,l.A)(e)&&!0===e.hideSystemMenu)return;var i="";!0===this.options.useAccessibleContextMenu?(i+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='ul' style='' class='w2grid_contextMenu_accessibility'>",i+="    <w2:listRow tagName='li' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>",i+="        <w2:listColumn id='col1' inputType='link' style='' class='w2grid_contextMenu_column'/>",i+="    </w2:listRow>",i+="</w2:list>"):(i+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>",i+="    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>",i+="        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>",i+="    </w2:listRow>",i+="</w2:list>");var o=WebSquare.xml.parse(i,!0).documentElement;this.contextMenu=new WebSquare.uiplugin.list(this.id+"_contextMenu_list","",o),this.contextMenu.writeTo(WebSquare.getBody()),this.contextMenu.activate();var r=this;this.contextMenu.event.addListener(this.contextMenu.render,"onclick",(function(t){try{p.f.stopPropagation(t),r.contextMenu.clickFunc.call(r.contextMenu,t)}catch(t){s.Y.printStackTrace(t,null,this)}})),this.contextMenu.clickFunc=function(t){try{for(var e,i,o=r.event.getTargetIterator(t,this.render),a=r.contextMenu;o.next();){if(o.match("w2grid_contextMenu_column")){e=o.getElement().parentNode;break}if(o.match("w2grid_contextMenu_row")){e=o.getElement()
;break}if(o.match("w2grid_contextMenu")||o.match("w2grid_contextMenu_accessibility"))return}for(var n=0;n<a.getLength();n++)if(e==a.render.childNodes[n]){i=n;break}r.callSelectedAPI(a.getRowData(i).col1,a.info),r.hideContextMenu();var l=r.contextMenu.getAllData()[i],h={row:a.info.rowIndex,col:a.info.colIndex,focusedCell:a.info.focusedCell,userMenuId:l.userMenuId,isSystemMenu:l.isSystemMenu,systemMenu:l.systemMenu};a.info=null,p.f.fireEvent(r,"oncontextclick",h.row,h.col,h.userMenuId,h.isSystemMenu,h.systemMenu,h.focusedCell)}catch(t){s.Y.printStackTrace(t,null,this)}},!0===this.options.useAccessibleContextMenu&&(this.contextMenu.event.addListener(this.contextMenu.render,"onkeydown",(function(t){try{var e=r.contextMenu,i=e.getLength(),o=t.charCode?t.charCode:t.keyCode;if(27==o)return void r.hideContextMenu();38==o?(p.f.preventDefault(t),e.selectedIndex--,e.selectedIndex<0&&(e.selectedIndex=0),e._setSelectedIndex()):40==o?(p.f.preventDefault(t),e.selectedIndex++,e.selectedIndex>=i&&(e.selectedIndex=i-1),e._setSelectedIndex()):9==o&&(p.f.preventDefault(t),t.shiftKey?(e.selectedIndex--,e.selectedIndex<0&&(e.selectedIndex=i-1)):(e.selectedIndex++,e.selectedIndex>=i&&(e.selectedIndex=0)),e._setSelectedIndex())}catch(t){s.Y.printStackTrace(t,null,this)}})),setTimeout((function(){for(var t=r.contextMenu.getLength(),e=0;e<t;e++){var i=r.contextMenu.render.childNodes[e].firstChild;r.contextMenu.event.addListener(i,"onclick",(function(t){try{p.f.stopPropagation(t),r.contextMenu.clickFunc.call(r.contextMenu,t)}catch(t){s.Y.printStackTrace(t,null,this)}})),r.contextMenu.event.addListener(i,"onfocus",(function(t){try{for(var e,i=r.contextMenu,o=0;o<i.getLength();o++)if(this==i.render.childNodes[o].firstChild){e=o;break}i.selectedIndex=e,i._setSelectedIndex()}catch(t){s.Y.printStackTrace(t,null,this)}}))}}),0));var a=this.getContextMenuData(t);if(e&&e.hideSystemMenu&&"object"===(0,l.A)(e.hideSystemMenu)&&e.hideSystemMenu.indexOf)for(var n=0;n<a.length;n++){var h=a[n].systemMenu;e.hideSystemMenu.indexOf(h)>-1&&(a.splice(n,1),n--)}if(e&&e.appendMenu&&"object"===(0,l.A)(e.appendMenu)&&e.appendMenu.length)for(n=0;n<e.appendMenu.length;n++){var d=e.appendMenu[n];d.col1=d.label,d.isSystemMenu=!1,a.push(d)}if(a.length>0){this.showContextMenu(t,a);for(n=0;n<a.length;n++){var u=a[n];u.className&&(this.contextMenu.render.children[n].className=this.contextMenu.render.children[n].className+" "+u.className)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getContextMenuData=function(t){try{var e=[],i=!0;if(this.groupbyStatus.grouped)for(var o=WebSquare.language.getMessage("Grid_ungroup")||"Ungroup",r=0;r<this.groupbyStatus.sortIndexArr.length;r++)if(t.focusedCell&&t.focusedCell.length>1){for(var a=0;a<t.focusedCell.length;a++)if(this.groupbyStatus.sortIndexArr[r]==t.focusedCell[a].focusedColIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(!i)break}else if(this.groupbyStatus.sortIndexArr[r]==t.colIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(i){var n=WebSquare.language.getMessage("Grid_group")||"Group";e.push({col1:n,isSystemMenu:!0,systemMenu:"Group"})}var l=WebSquare.language.getMessage("Grid_column_hide")||"Hide";if(e.push({col1:l,isSystemMenu:!0,systemMenu:"ColumnHide"}),0==this.options.fixedColumn||this.options.fixedColumn-1<t.colIndex){var h=WebSquare.language.getMessage("Grid_column_fix")||"Fix";e.push({col1:h,isSystemMenu:!0,systemMenu:"ColumnFix"})}if(this.options.fixedColumn>0){var d=WebSquare.language.getMessage("Grid_column_unfix")||"Unfix All Columns";e.push({col1:d,isSystemMenu:!0,systemMenu:"ColumnUnfixAll"})}var u=WebSquare.language.getMessage("Grid_column_adjustWidth")||"Adjust Width",p=WebSquare.language.getMessage("Grid_column_showAll")||"Show All Columns";e.push({col1:u,isSystemMenu:!0,systemMenu:"ColumnAdjustWidth"});for(r=0;r<this.hiddenList.length;r++)if(this.hiddenList[r]){e.push({col1:p,isSystemMenu:!0,systemMenu:"ColumnShowAll"});break}
var c=WebSquare.language.getMessage("Grid_column_adjustAuto")||"Adjust All Column Widths";e.push({col1:c,isSystemMenu:!0,systemMenu:"ColumnAdjustAuto"});var g=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"UnAdjust All Column Widths";if(e.push({col1:g,isSystemMenu:!0,systemMenu:"ColumnAdjustAutoNone"}),this.groupbyStatus.grouped){var f=WebSquare.language.getMessage("Grid_fold_all")||"Fold All",m=WebSquare.language.getMessage("Grid_unfold_all")||"Unfold All",y=WebSquare.language.getMessage("Grid_ungroup_all")||"Ungroup All";e.push({col1:f,isSystemMenu:!0,systemMenu:"FoldAll"}),e.push({col1:m,isSystemMenu:!0,systemMenu:"UnfoldAll"}),e.push({col1:y,isSystemMenu:!0,systemMenu:"UngroupAll"})}return e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.showContextMenu=function(t,e){try{e||(e=this.getContextMenuData(t),this.contextMenu.setPosition(0,0));var i=e.length*(this.options.contextMenuRowHeight+1);this.contextMenu.show(),this.contextMenu.setSize(null,i),this.contextMenu.setJSON(e);var o=p.f.getMouseX(t.event),r=p.f.getMouseY(t.event),a=document.body.scrollTop;a<document.documentElement.scrollTop&&(a=document.documentElement.scrollTop);var n=(r-a)*WebSquare.style.getScale(),l=document.documentElement.clientHeight-n,h=Math.max(l,n),d=WebSquare.style.getSize(this.contextMenu.render,"outerheight");if((h<d&&e.length>0||l<d&&n>d)&&(r-=d),r<0&&(r=0),document.documentElement.clientWidth<o+this.contextMenu.render.offsetWidth&&(o-=this.contextMenu.render.offsetWidth)<0&&(o=WebSquare.style.getAbsoluteLeft(this.render)),this.contextMenu.setPosition(o,r),this.contextMenu.info=t,!0===this.options.useAccessibleContextMenu){this.contextMenu.render.setAttribute("tabindex","0");for(var u=this.contextMenu.getLength(),c=0;c<u;c++){var g=this.contextMenu.render.childNodes[c];g.setAttribute("aria-selected","false"),g.setAttribute("aria-setsize",u),g.setAttribute("aria-posinset",c+1)}this.contextMenu.selectedIndex=0,this.contextMenu._setSelectedIndex()}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.hideContextMenu=function(){try{if(this.contextMenu){var t,e=WebSquare.style.getStyle(this.contextMenu.render,"display")||"";if(this.contextMenu.hide(),!0===this.options.useAccessibleContextMenu&&"none"!=e)if(this.contextMenu.render.setAttribute("tabindex","-1"),this.contextMenu.selectedIndex=null,this.focusedCell[0]&&(t=this.focusedCell[0].focusedTd),t){var i=a.Z.getDataPrefix("col_id");this.getCellInfo(t.getAttribute(i)).options.embeddedInput?this.applyFocusedCellIn(t,!0):this.applyFocusedCellIn(t)}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.callSelectedAPI=function(t,e){try{var i=WebSquare.language.getMessage("Grid_column_hide")||"Hide",r=WebSquare.language.getMessage("Grid_column_showAll")||"Show All Columns",a=WebSquare.language.getMessage("Grid_column_fix")||"Fix",n=WebSquare.language.getMessage("Grid_column_unfix")||"Unfix All Columns",l=WebSquare.language.getMessage("Grid_column_adjustWidth")||"Adjust Width",h=WebSquare.language.getMessage("Grid_column_adjustAuto")||"Adjust All Column Widths",d=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"UnAdjust All Column Widths",u=WebSquare.language.getMessage("Grid_fold_all")||"Fold All",c=WebSquare.language.getMessage("Grid_unfold_all")||"Unfold All",f=WebSquare.language.getMessage("Grid_ungroup_all")||"Ungroup All",m=WebSquare.language.getMessage("Grid_ungroup")||"Ungroup",y=WebSquare.language.getMessage("Grid_group")||"Group",b=e.focusedCell||[],v=[];if(b.length>0){for(var w=0;w<e.focusedCell.length;w++)v.push(e.focusedCell[w].colIndex);v.sort((function(t,e){return t-e}));for(w=0;w<v.length-1;)v[w]===v[w+1]?v.splice(w,1):w++}switch(t){case i:if(-1===e.colIndex)break;if(v.length>1)for(w=0;w<v.length;w++)this.setColumnVisible(v[w],!1),this.groupbyStatus.grouped&&this.ungroupColumn(v[w]);else this.setColumnVisible(e.colIndex,!1),this.groupbyStatus.grouped&&this.ungroupColumn(e.colIndex);break;case r:
for(w=0;w<this.hiddenList.length;w++)this.hiddenList[w]&&this.setColumnVisible(this.columnOrder[w-this.defaultColCnt],!0);break;case a:if(-1===e.colIndex)break;if(v.length>1)for(w=0;w<v.length;w++)this.setFixedColumn(parseInt(v[w],10)+1);else this.setFixedColumn(parseInt(e.colIndex,10)+1);break;case n:if(-1===e.colIndex)break;this.setFixedColumn(0);break;case l:if(-1===e.colIndex)break;if(!this.autofitColumn){var C={type:"selectedColumn",colIndex:e.colIndex};this.setAutoFit(C)}break;case h:C={type:"allColumn"};this.setAutoFit(C);break;case d:this.clearAutoFit();break;case u:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.foldAll();break;case c:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.unfoldAll();break;case f:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.clearGroupby();break;case m:if(-1===e.colIndex)break;if(v.length>1)for(w=0;w<v.length;w++)this.ungroupColumn(v[w]);else this.ungroupColumn(e.colIndex);break;case y:if(-1===e.colIndex)break;if(this.groupbyStatus.grouped){if((C={}).sortIndex=this.groupbyStatus.sortIndexArr,C.sortOrder=this.groupbyStatus.sortOrderArr,v.length>1)for(w=0;w<v.length;w++)C.sortIndex.push(v[w]),C.sortOrder.push(1);else C.sortIndex.push(e.colIndex),C.sortOrder.push(1);!1===p.f.fireEvent(this,"ongroupby",C)&&((C=o.q.extend({},this.groupbyDisplayOptions)).sortIndex=this.groupbyStatus.sortIndexArr,C.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(C,!0))}else{C={};if(v.length>1){C.sortIndex=v,C.sortOrder=[];for(w=0;w<v.length;w++)C.sortOrder.push(1)}else C.sortIndex=[e.colIndex],C.sortOrder=[1];if(!1===p.f.fireEvent(this,"ongroupby",C)){var I=this.getColCnt()+this.defaultColCnt,_=g.B.getMessage("Grid_groupby_count")||"items";C.rowNumHeader={colSpan:I,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+_+" ] ' ",align:"left"},C.rowNumFooter={colSpan:I},this.groupby(C,!0)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.createCustomFilterList=function(t,e){try{var i;!0!==e&&(i=this.headerToBodyRelation[t]);var o=this.options.filterListRowHeight+1,r=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum,n=WebSquare.language.getMessage("Grid_filter_search")||"search",l=this.getElementById(this.id+"_head_table");this._dataLayerHeight=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight,this._dataLayerHeight=this._dataLayerHeight-l.offsetHeight;var h=0;this.options.useFilterSearch?(h=Math.min(parseInt(this._dataLayerHeight/o),r),this.customFilterScrollViewRenderHeight=h*o):this.customFilterScrollViewRenderHeight=r*o;"<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'>","</w2:scrollView>";var d=WebSquare.xml.parse("<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'></w2:scrollView>",!0).documentElement;WebSquare.xml.setAttribute(d,"bounce",!1),WebSquare.xml.setAttribute(d,"paging",!1),a.Z.isMobile()||(WebSquare.xml.setAttribute(d,"horizontalScroll",!1),WebSquare.xml.setAttribute(d,"scrollType","auto"),WebSquare.xml.setAttribute(d,"showHorizontalScroll",!1),WebSquare.xml.setAttribute(d,"showVerticalScroll",!1),WebSquare.xml.setAttribute(d,"verticalScroll",!1)),this.customFilterScrollView=new WebSquare.uiplugin.scrollView(this.id+"_customFilter_scrollView","",d);var u="";if(this.options.useFilterSearch)u+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list' placeholder='"+n+"' virtualized='true' visibleRowNum='"+(h-1)+"' useSearch='true' wheelRows='1' _listRowHeight='"+o+"'>";else{this.options.useSearchFilter&&(useSearchFilterStr=" useSearchFilter='true'"),
u+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list'>"}u+="    <w2:listRow tagName='div' style='height: "+this.options.filterListRowHeight+"px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_customFilter_list_listRow'>",u+="        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_customFilter_list_listColumn_checkbox'/>",u+="        <w2:listColumn id='id2' inputType='text' style='' class='w2grid_customFilter_list_listColumn_text'/>",u+="        <w2:listColumn id='id3' inputType='text' style='display:none;'/>",u+="    </w2:listRow>",u+="</w2:list>";var c=WebSquare.xml.parse(u,!0).documentElement;if(this.customFilterList=new WebSquare.uiplugin.list(this.id+"_customFilter_list","",c),this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterScrollView.addControl(this.customFilterList),this.customFilterScrollView.writeTo(this),this.customFilterScrollView.activate(),this.options.useSearchFilter){this.customFilterList.myhelper=new WebSquare.korHelper;var g=WebSquare.document.createElement("div");g.id=this.id+"_filter_Search_div",g.style.position="relative",g.style.backgroundColor="white",g.style.boxSizing="border-box",this._filter_searchInput=WebSquare.document.createElement("input"),this._filter_searchInput.id=this.id+"_filter_search_input",this._filter_searchInput.className="w2grid_filter_search_input",this._filter_searchInput.name=this.id+"_filter_search_input",this._filter_searchInput.style.height=o-3+"px",a.Z.isIEAllVersion(),this._filter_searchInput.placeholder=n,g.appendChild(this._filter_searchInput),this.customFilterScrollView.render.insertBefore(g,this.customFilterScrollView.render.firstChild);var f=this.uuid,m=this.id;p.f.addListener(g,"onkeydown",(function(t){p.f.stopPropagation(t),a.Z.setTimeout((function(){WebSquare.idCache[f].customFilterList.find()}),{key:m+"_customFilterList_search",delay:100})})),p.f.addListener(g,"onkeyup",(function(t){p.f.stopPropagation(t);var e=WebSquare.idCache[f],i=e.getHeaderDIV(e.customFilterList.currentHeaderID).getElementsByClassName("w2grid_customFilter_open")[0];if(13==t.keyCode){(e.options.useFilterSearch?this.dom.input.value:e._filter_searchInput.value)&&(e.hideCustomFilterList(),i&&i.focus())}else 27==t.keyCode&&(e.hideCustomFilterList(),i&&i.focus())})),this.customFilterScrollViewRenderHeight+=o}var y=this;if(this.customFilterScrollView.event.addListener(this.customFilterScrollView.render,"onclick",this.customFilterScrollView.event.bindAsEventListener(this.customFilterList,(function(t){try{p.f.stopPropagation(t);var e=p.f.getTarget(t);if(e.className.match("w2list_input")||e.className.match("w2list_scroll_thumb")||e.className.match("w2grid_filter_search_input")||e.className.match("w2grid_customFilter_scrollView"))return;var i,o=e.parentNode,r=0;if(this.options.virtualized?(i=this.getElementById(this.id+"_items_main").childNodes,r=this.firstListIndex):i=this.render.childNodes,e.className.match("w2grid_customFilter_list_listRow")){e=(o=e).firstChild;for(var a=0;a<this.getLength();a++)if(o==i[a]){this.setCellData(a+r,"id1",!e.checked);break}}if(e.className.match("w2grid_customFilter_list_listColumn_text")&&(i[0]!=o||this.options.virtualized&&r>0)){e=o.firstChild;for(a=0;a<this.getLength();a++)if(o==i[a]){this.setCellData(a+r,"id1",!e.checked);break}}var n=this.currentHeaderID,l=y.headerToBodyRelation[n],h=y._dataList.getColumnIndex(l),d=y.headerInfoHash[n],u=0;if(d&&d.options.hideCustomFilter&&(u=1),1!==u&&o==i[0]&&0===r){if(e.className.match("w2grid_customFilter_list_listColumn_checkbox")){if(e.checked){if(y.firstOpenCustomFilter[n]){y.headerID=n,y.targetColID=l,(y.options.useFilterSearch||y.options.useSearchFilter)&&y.setAutoCompleteItem(l,n),y.setCustomFilterExpression();for(a=1;a<this.getLength();a++)this.setCellData(a,"id1",!1)
;if(y.options.useFilterSearch||y.options.useSearchFilter){var c=y.getCustomFilterListJSON({colID:l,headerID:n});y._setFilterListHeight(n,c.length)}return}return y.hideCustomFilterList(),y.firstOpenCustomFilter[n]||(y.firstOpenCustomFilter[n]=!0),void y._showCustomFilter(n)}if(y.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],y.dataList.removeColumnFilter(l),y.options.useFilterSearch||y.options.useSearchFilter){(c=y.getCustomFilterListJSON({colID:l,headerID:n}))[0].id1=!1;for(a=1-u;a<c.length;a++)c[a].id1=!0}for(a=1;a<this.getLength();a++)this.setCellData(a,"id1",!0);y.options.useFilterSearch&&(this.setJSON(c),y._setFilterListHeight(n,c.length))}else if(e.className.match("w2grid_customFilter_list_listColumn_text"))return void y._showCustomFilter(n)}else if(1!==u&&this.setCellData(0,"id1",!1),y.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],o==i[1-u-r]){var g=e.checked;if(e.className.match("w2grid_customFilter_list_listColumn_text"))g=!i[1-u].firstChild.checked;for(a=1-u;a<this.getLength();a++)this.setCellData(a,"id1",g)}var f=[],m=[],b=[],v=this.getLength();for(a=2-u;a<v;a++)this.getCellData(a,"id1")?m.push(a):b.push(a);var w=m.length>b.length,C=(y._dataList.getFilterList(),this.getLength()-2+u),I=y.getCellInfo(l),_=w?b:m,x="*";for(a=0;a<_.length;a++){var S=this.getCellData(_[a],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&I.formatter&&(I.options.displayFormat||I.options.displayFormatter||I.options.ioFormat)&&(S=I.formatter.unformat(S)),y.options.useFilterListFormat&&I.useCustomFormatter&&""===(S=this.getCellData(_[a],"id3"))&&(x="+"),w&&S===y.filterEmptyStr?x="+":(S===y.filterNullStr&&(S="null"),f.push(S))}y.options.useFilterListFormat&&I.useCustomFormatter||(f=y.changeItemValue("value",l,f));var R=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(a=0;a<f.length;a++){var D=f[a];"string"==typeof D&&(f[a]=D.replace(R,(function(t){return y.replacechar(t)})))}var T="";0==m.length?T+="/^[a-z0-9_-]{3,16}$/":T+=w?"^\\n*(?:(?!^"+f.join("$)(?!^")+"$).)"+x+"\\n*$":"^"+f.join("$|^")+"$";var L,k="";if(I&&(k=y.getColumnOption(I.options.col_id,"dataType")),L="number"==k?new RegExp(T):new RegExp(T,"gi"),p.f.fireEvent(y._dataList,"onbeforecolumnfilterchange"),m.length<C&&(WebSquare.DataCollection.stopBroadCast=!0),y.dataList.removeColumnFilter(l,{noRefreshAfter:!0}),this.filterHistory.column[0]!==l&&(this.filterHistory.column.unshift(l),this.filterHistory.filteredRowIndexArr.unshift(y._dataList.filteredRowIndexArr.slice(0))),m.length<C){if(WebSquare.DataCollection.stopBroadCast=!1,w){this.customFilterListFilterInfo[l]=[];for(a=0;a<m.length;a++){S=this.getCellData(m[a],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&I.formatter&&(I.options.displayFormat||I.options.displayFormatter||I.options.ioFormat)&&(S=I.formatter.unformat(S)),y.options.useFilterListFormat&&I.useCustomFormatter&&(S=this.getCellData(m[a],"id3")),this.customFilterListFilterInfo[l].push(S)}(I.itemsetObj||I.itemArr)&&(y.options.useFilterListFormat&&I.useCustomFormatter||(this.customFilterListFilterInfo[l]=y.changeItemValue("value",l,this.customFilterListFilterInfo[l])));for(a=0;a<this.customFilterListFilterInfo[l].length;a++){var F=this.customFilterListFilterInfo[l][a];F===y.filterEmptyStr?this.customFilterListFilterInfo[l][a]="":F===y.filterNullStr?this.customFilterListFilterInfo[l][a]=null:"string"==typeof F&&(F=F.replace(R,(function(t){return y.replacechar(t)})),this.customFilterListFilterInfo[l][a]=F)}}else this.customFilterListFilterInfo[l]=f;y.dataList.setColumnFilter({type:"regExp",colIndex:h,key:L,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[l];var A=y.getElementById(y.id+"_"+n+"_filter");1!==u&&this.getCellData(0,"id1")||WebSquare.style.removeClass(A,"w2grid_customFilter_filter");var E=!0,M=(C=this.getLength()-2+u,this.getAllData());for(a=2-u;a<M.length;a++)if(!M[a].id1){E=!1;break}
E?(this.setCellData(1-u,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()):(this.setCellData(1-u,"id1",!1),WebSquare.style.addClass(A,"w2grid_customFilter_filter")),p.f.fireEvent(y._dataList,"onaftercolumnfilterchange"),y.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){s.Y.printStackTrace(t,null,this)}}))),(this.options.useFilterSearch||this.options.useSearchFilter)&&(this.customFilterList.find=function(){this.search="contain";var t="";t=y.options.useFilterSearch?this.dom.input.value:y._filter_searchInput.value,!y.options.caseSensitive&&t&&(t=t.toLowerCase());var e=[],i=this.currentHeaderID,o=y.headerToBodyRelation[i],s=y._dataList.getColumnIndex(o),r=y.getCellInfo(o),a=y.headerInfoHash[i],n=0;a&&a.options.hideCustomFilter&&(n=1);for(var l=0;l<2-n;l++)e.push({id1:l-n==1,id2:b[l].id2});if(""!=t){y.itemValueObj={},y.customFilterStatusObj[i]=!1,y.firstOpenCustomFilter[i]=!1;var h=e.length;y.dataList.removeColumnFilter(o),delete this.customFilterListFilterInfo[o];for(N=y.getCustomFilterListJSON({colID:o,headerID:i,useFormat:!1}),l=2-n;l<N.length;l++){var d=!1,u=N[l].id2+"";if(y.options.caseSensitive||(u=u.toLowerCase()),"contain"==this.search?d=this.myhelper.containWith(u,t):"start"==this.search?d=this.myhelper.startWith(u,t):"none"==this.search&&(d=u==t),d){var c,g=N[l].id2;(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.formatter&&(r.options.displayFormat||r.options.displayFormatter||r.options.ioFormat)&&(g=r.formatter.format(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.useCustomFormatter&&(g=N[l].id2,c=N[l].id3),e.push({id1:!0,id2:g,id3:c})}}h===e.length&&e.splice(1-n,1),this.setJSON(e),y._setFilterListHeight(i,N.length,e.length);var f=[],m=[],v=[],w=this.getLength();for(l=2-n;l<w;l++)this.getCellData(l,"id1")?m.push(l):v.push(l);if(0!=m.length||0!=v.length){var C=m.length>v.length;0===v.length&&(C=!1);var I=C?v:m,_="*";for(l=0;l<I.length;l++){g=this.getCellData(I[l],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.formatter&&(r.options.displayFormat||r.options.displayFormatter||r.options.ioFormat)&&(g=r.formatter.unformat(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.useCustomFormatter&&(g=this.getCellData(I[l],"id3")),C&&g===y.filterEmptyStr?_="+":(g===y.filterNullStr&&(g="null"),f.push(g))}y.options.useFilterListFormat&&r.useCustomFormatter||(f=y.changeItemValue("value",o,f));var x=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(l=0;l<f.length;l++){var S=f[l];"string"==typeof S&&(f[l]=S.replace(x,(function(t){return y.replacechar(t)})))}var R="";0==m.length?R+="/^[a-z0-9_-]{3,16}$/":R+=C?"^\\n*(?:(?!^"+f.join("$)(?!^")+"$).)"+_+"\\n*$":"^"+f.join("$|^")+"$";var D,T="";(r=y.getCellInfo(o))&&(T=y.getColumnOption(r.options.col_id,"dataType")),D="number"==T?new RegExp(R):new RegExp(R,"gi"),p.f.fireEvent(y._dataList,"onbeforecolumnfilterchange");var L=this.getLength()-2+n;if(m.length<L&&(WebSquare.DataCollection.stopBroadCast=!0),y.dataList.removeColumnFilter(o,{noRefreshAfter:!0}),this.filterHistory.column[0]!==o&&(this.filterHistory.column.unshift(o),this.filterHistory.filteredRowIndexArr.unshift(y._dataList.filteredRowIndexArr.slice(0))),m.length<=L){if(WebSquare.DataCollection.stopBroadCast=!1,C){this.customFilterListFilterInfo[o]=[];for(l=0;l<m.length;l++){g=this.getCellData(m[l],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.formatter&&(r.options.displayFormat||r.options.displayFormatter||r.options.ioFormat)&&(g=r.formatter.unformat(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&r.useCustomFormatter&&(g=this.getCellData(m[0],"id3")),this.customFilterListFilterInfo[o].push(g)}(r.itemsetObj||r.itemArr)&&(this.customFilterListFilterInfo[o]=y.changeItemValue("value",o,this.customFilterListFilterInfo[o]))
;for(l=0;l<this.customFilterListFilterInfo[o].length;l++){var k=this.customFilterListFilterInfo[o][l];k===y.filterEmptyStr?this.customFilterListFilterInfo[o][l]="":k===y.filterNullStr?this.customFilterListFilterInfo[o][l]=null:"string"==typeof k&&(k=k.replace(x,(function(t){return y.replacechar(t)})),this.customFilterListFilterInfo[o][l]=k)}}else this.customFilterListFilterInfo[o]=f;y.dataList.setColumnFilter({type:"regExp",colIndex:s,key:D,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[o];O=y.getElementById(y.id+"_"+i+"_filter");1!==n&&this.getCellData(0,"id1")||WebSquare.style.removeClass(O,"w2grid_customFilter_filter");var F=!0,A=(L=this.getLength()-2+n,this.getAllData());for(l=2-n;l<A.length;l++)if(!A[l].id1){F=!1;break}F?(this.setCellData(1-n,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),this.listRowObjArr.length!==this.jsonData.length&&WebSquare.style.addClass(O,"w2grid_customFilter_filter")):(this.setCellData(1-n,"id1",!1),WebSquare.style.addClass(O,"w2grid_customFilter_filter")),p.f.fireEvent(y._dataList,"onaftercolumnfilterchange"),y.options.groupbyFilterBox&&(this.isChanged=!0)}}else{for(var E=y._dataList.getFilterList(),M=!1,l=0;l<E.length;l++)if(E[l]&&E[l].colIndex===s&&"func"!==E[l].type){M=!0;break}if(this.listRowObjArr.length!==this.jsonData.length&&M){y.itemValueObj={},y.customFilterStatusObj[i]=!1,delete this.customFilterListFilterInfo[o],y.firstOpenCustomFilter[i]=!1,y.dataList.removeColumnFilter(o);var O=y.getElementById(y.id+"_"+i+"_filter");1!==n&&this.getCellData(0,"id1")||WebSquare.style.removeClass(O,"w2grid_customFilter_filter");for(var N=y.getCustomFilterListJSON({colID:o,headerID:i}),l=2-n;l<N.length;l++)e.push({id1:!0,id2:N[l].id2});this.setJSON(e),y._setFilterListHeight(i,e.length)}else M||e.length-(2-n)!=0||(this.setJSON(this.jsonData),y._setFilterListHeight(i,this.jsonData.length))}},this.customFilterList._inputKeyDown=this.customFilterList.inputKeyDown,this.customFilterList.inputKeyDown=function(t,e){var i=this;this.mytime=setTimeout((function(t){i.find()}),100,t)}),!0===e)return;var b=this.getCustomFilterListJSON({colID:i,headerID:t});if(this.customFilterList.jsonData=b,this.customFilterList.setJSON(b),this.applyFilterListFormat(b,t),this._setFilterListSize({headerID:t,dataLen:b.length,type:"create"}),this.options.useFilterSearch){this.removeFocusedCell();var v=this.customFilterList.getElementById(this.customFilterList.id+"_input");WebSquare.style.getSize(v,"innerwidth"),WebSquare.style.getSize(v,"width");this.customFilterList.dom.input.focus()}else if(this.options.useSearchFilter){this.removeFocusedCell();v=this.customFilterScrollView.getElementById(this.id+"_filter_search_input"),WebSquare.style.getSize(v,"innerwidth"),WebSquare.style.getSize(v,"width");v.focus()}this.customFilterList.currentHeaderID=t,this.customFilterList.customFilterListFilterInfo={},this.customFilterList.customFilterListAction=!1,this.customFilterList.customUserFilterListAction=!1,WebSquare.style.show(this.customFilterScrollView.render)}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setFilterListSize=function(t){try{var e,i,o=t.headerID,r=t.dataLen,n=t.type,l=this.getElementById(this.id+"_"+o),h=this.options.filterListRowHeight+1,d=(this.options.useFilterSearch?r+1:r)*h-1,u=d;if("height"!=n){var p=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum;if(this.options.useFilterSearch){var c=Math.min(parseInt(this._dataLayerHeight/h),p);this.customFilterScrollViewRenderHeight=c*h}else this.customFilterScrollViewRenderHeight=p*h}
var g=WebSquare.style.getSize(this.customFilterScrollView.render,"outerwidth")-WebSquare.style.getSize(this.customFilterScrollView.render,"width"),f=WebSquare.style.getSize(this.customFilterScrollView.render,"outerHeight")-WebSquare.style.getSize(this.customFilterScrollView.render,"height"),m=WebSquare.style.getRelativeTop(l,this.render)+l.offsetHeight+1,y=WebSquare.style.getRelativeLeft(l,this.render),b=0,v=this.getElementById(this.id+"_head_table"),w=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight;w-=v.offsetHeight,this.options.useSearchFilter&&(b=h);var C=Math.min(this.customFilterScrollViewRenderHeight+b,d+b,w-f),I=this.getElementById(this.id+"_customFilter_scrollView_container");this.options.useFilterSearch?d=C:WebSquare.style.setStyle(I,"overflow-x","auto");var _=this.getElementById(this.id+"_size_y").clientWidth,x=this.getElementById(this.id+"_body_table"),S=WebSquare.style.getSize(x,"outerwidth")-WebSquare.style.getSize(x,"width"),R=this.getElementById(this.id+"_dataLayer").clientWidth-l.offsetLeft-g-S,D=e=this.customFilterList.getMaxItemWidth();if(a.Z.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)){l.clientWidth>e&&(e=l.clientWidth);var T=document.getElementById(this.id+"_dataLayer"),L=T.clientWidth,k=WebSquare.style.getRelativeLeft(T,this.render);i=e+(C<d?_:0),this.options.useFilterSearch&&u>C&&(e+=_,i+=_),R<i?(L<i?(y=k,i=L):y=k+L-i-g,R=L):i=Math.min(R,i),this.options.useSearchFilter?e>D&&WebSquare.style.setStyle(I,"overflow-x","hidden"):this.options.useFilterSearch&&WebSquare.style.setStyle(I,"overflow-x","hidden")}else{var F=parseInt(this.headerInfoHash[o].options.filterListWidth);F>0?e<(i=F-g)&&(e=i):this.options.filterListWidth>0?e<(i=this.options.filterListWidth-g)&&(e=i):(i=l.clientWidth,l.clientWidth>e&&(e=l.clientWidth)),R<i&&(i=R),(this.options.useFilterSearch||e>D)&&WebSquare.style.setStyle(I,"overflow-x","hidden")}"height"!=n&&this.customFilterScrollView.setPosition(y,m-1);var A=0;if(this.options.useSearchFilter){var E=this.customFilterScrollView.getElementById(this.id+"_filter_search_input");A=E.offsetHeight,I.style.height=C-A+"px"}this.customFilterScrollView.setSize(i,C),this.customFilterList.setSize(e,d);var M,O,N=0;if(a.Z.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)||this.options.useFilterSearch||(I.clientWidth<D?(N=I.offsetHeight-I.clientHeight,this._dataLayerHeight>C+N&&(this.customFilterScrollView.setSize(null,C+N),this.options.useSearchFilter&&(I.style.height=I.offsetHeight+N+"px"))):WebSquare.style.setStyle(I,"overflow-x","hidden")),this.options.useResizeFilterList)this.customFilterScrollView.addClass("w2scrollView_resize"),a.Z.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList)?(M=l.clientWidth,O=i):(M=i,O=Math.min(R,e)),this.customFilterScrollView.render.style.minWidth=M+"px",this.customFilterScrollView.render.style.maxWidth=O+"px",this.customFilterScrollView.render.style.minHeight=I.offsetHeight+A+"px",this.customFilterScrollView.render.style.maxHeight=Math.min(this._dataLayerHeight,d+A)+N+"px","create"==n&&(scrollViewObserver=new ResizeObserver((function(t){var e=t[0].contentRect.height-A;I.offsetHeight!=e&&(I.style.height=e+"px")})),scrollViewObserver.observe(this.customFilterScrollView.render))}catch(t){s.Y.printStackTrace(t)}},f.prototype._setFilterListHeight=function(t,e,i){try{var o=i||e;this._setFilterListSize({headerID:t,dataLen:o,type:"height"})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.toggleCustomFilterList=function(t){try{this.customFilterScrollView&&this.customFilterList&&("none"==this.customFilterScrollView.render.style.display||this.customFilterList.currentHeaderID!=t?this.moveCustomFilterList(t):this.hideCustomFilterList())}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.showCustomFilterList=function(t,e){try{
if(this.customFilterScrollView&&this.customFilterList){if(e){WebSquare.style.show(this.customFilterScrollView.render),this.options.useResizeFilterList&&(this.customFilterScrollView.render.style.minWidth="",this.customFilterScrollView.render.style.maxWidth="",this.customFilterScrollView.render.style.minHeight="",this.customFilterScrollView.render.style.maxHeight="");var i=t.headerID,o=t.dataLength;this._setFilterListSize({headerID:i,dataLen:o})}var r=this.getElementById(this.id+"_customFilter_scrollView_container");if(this.customFilterList.currentHeaderID=i,r.scrollLeft=0,r.scrollTop=0,this.options.useFilterSearch){this.removeFocusedCell(),this.customFilterList.dom.input.value="";var a=this.customFilterList.getElementById(this.customFilterList.id+"_input");WebSquare.style.getSize(a,"innerwidth"),WebSquare.style.getSize(a,"width");this.customFilterList.dom.input.focus()}else if(this.options.useSearchFilter){this.removeFocusedCell();a=this.customFilterScrollView.getElementById(this.id+"_filter_search_input"),WebSquare.style.getSize(a,"innerwidth"),WebSquare.style.getSize(a,"width"),r.offsetWidth,r.clientWidth;WebSquare.style.getSize(a,"outerwidth")-WebSquare.style.getSize(a,"width"),a.value="",a.focus()}WebSquare.style.show(this.customFilterScrollView.render)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.moveCustomFilterList=function(t){try{if(this.customFilterScrollView&&this.customFilterList){var e=this.headerToBodyRelation[t];WebSquare.style.show(this.customFilterScrollView.render);var i=this.getCustomFilterListJSON({colID:e,headerID:t});this.customFilterList.jsonData=i,this.customFilterList.setJSON(i),this.applyFilterListFormat(i,t),this.customFilterList.currentHeaderID=t,this.showCustomFilterList({headerID:t,dataLength:i.length},!0)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.hideCustomFilterList=function(){try{this.customFilterScrollView&&this.customFilterList&&(WebSquare.style.hide(this.customFilterScrollView.render),this.customFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.customFilterList.isChanged=!1))}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.getCustomFilterListJSON=function(t){try{var e;if(this.customFilterList.filterHistory.column[0]!==t.colID||this.options.showAllFilterList)if(this.options.useFilterSearch||this.options.useSearchFilter){var i=this._dataList.getFilterList();if(i.length>0){var o=!1;1==i.length&&this._dataList.getColumnID(i[0].colIndex)===t.colID&&(o=!0)}e=o?this._dataList.filterManager.allRowIndexArr:this._dataList.filteredRowIndexArr}else this.options.showAllFilterList?(this.customFilterList.customFilterListFilterInfo,e=this._dataList.filterManager.firstFiltering?this._dataList.filteredRowIndexArr:this._dataList.filterManager.allRowIndexArr):e=this._dataList.filteredRowIndexArr;else e=this.customFilterList.filterHistory.filteredRowIndexArr[0];var r=this.dataList.getColData(t.colID,e),a=this.getCellInfo(t.colID),n=this.getUniqueValueOfArray(r,a.options.dataType),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("");var h,d,u=("select"==a.options.inputType||"text"==a.options.inputType)&&this.options.useFilterListFormat&&a.useCustomFormatter?"customFormatted":"label",p=this.changeItemValue(u,t.colID,n.slice(0)),c=this.customFilterStatusObj[t.headerID]||!1,g=WebSquare.language.getMessage("Grid_Customized_Filter")||"Customized Filter",f=WebSquare.language.getMessage("Grid_checked_all")||"choose all",m=!c;if(!c)if(this.customFilterList.customFilterListFilterInfo&&Object.keys(this.customFilterList.customFilterListFilterInfo).length>0)t.colID in this.customFilterList.customFilterListFilterInfo&&(d=(h=this.customFilterList.customFilterListFilterInfo[t.colID]).slice(0));else if(this.options.showAllFilterList){var y=this._dataList.getFilteredColData(t.colID);d=this.getUniqueValueOfArray(y).slice(0),c||r.length==y.length||(m=!1)}for(var b=[{id1:c,id2:g},{id1:m,id2:f
}],v=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,w=this,C=this._dataList.options.useNull,I=0;I<p.length;I++){var _={};if(d){var x,S=!1;"string"==typeof(x=a.useCustomFormatter&&a.mainGrid.options.useFilterListFormat?n[I]:a.itemArr?a.itemHash[p[I]]:p[I])&&(x=x.replace(v,(function(t){return w.replacechar(t)}))),C&&x===this.filterNullStr&&(x="null");for(var R=d.length-1;R>-1;R--){if(x==d[R]){S=!0,d.splice(R,1);break}if("string"==typeof d[R]){for(var D=!1,T=0;T<l.length;T++)if(l[T]==d[R]){D=!0;break}if(D&&(p[I]==this.options.useFilterEmptyMsg||p[I]==this.filterEmptyStr)){S=!0;break}}}_.id1=S}else _.id1=!c;var L=p[I],k=n[I];(this.options.useFilterSearch||this.options.useSearchFilter)&&this.options.useFilterListFormat&&a.useCustomFormatter&&(L=this._applyFormatter(a,k)),_.id2=L,(this.options.displayValueOnUseFilterList||this.options.useFilterListFormat&&a.useCustomFormatter)&&(_.id3=n[I]),b.push(_)}var F=0,A=this.headerInfoHash[t.headerID];if(A&&A.options.hideCustomFilter&&(b.shift(),F=1),h){var E=!0,M=b;for(I=2-F;I<M.length;I++)if(!M[I].id1){E=!1;break}b[1-F].id1=!!E}return this._dataList.getDataLength()||(b[1-F].id1=!1),b}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.changeItemValue=function(t,e,i,o){try{var r,n=[],l=!1,h=!1,d=this.getCellInfo(e),u=d.options.inputType;"custom"==u&&(d=d.cellManagerHashByRowIndex[d.editRowIndex]?d.cellManagerHashByRowIndex[d.editRowIndex]:d),d.itemHash={},!1===o||(r=d.options.filterDisplayMode?d.options.filterDisplayMode:"label");var p=this._dataList.options.useNull;if(d.itemsetObj&&""!=d.itemsetObj.nodeset&&d.itemsetObj.nodeset.wq_replaceAll(" ","").indexOf("data:")>=0&&(!d.itemArr||d.itemArr.length<1)){d.itemArr=[];var c=d.itemsetObj.nodeset.replace("data:",""),g=this.modelControl.getDataComp(c),f=function(t,e){var i=null===t?"":t,o=null===e?"":e,s=d.options.delimiter?d.options.delimiter:"";switch(r){case"value delim label":i=o+s+i;break;case"label delim value":i=i+s+o;break;case"value":i=o}return i};if(g&&WebSquare.idCache[g.uuid])switch(p=g.options&&!0===g.options.useNull,g.initializeType){case"linkedDataList":for(var m=[],y={},b=g.getAllNoFilteredData(),v=0;v<g._dataList.getDataLength();v++){var w=b[v*g.cellIdList.length+g.bodyIdColIndexMap[d.itemsetObj.label]],C=b[v*g.cellIdList.length+g.bodyIdColIndexMap[d.itemsetObj.value]];if(a.Z.isNumber(C)&&(C+=""),p&&null===C){if(null===y[w])continue}else if(y[w]==C)continue;y[w]=C,m.push({orgLabel:w,label:f(w,C),value:C})}d.itemArr=m;break;case"dataList":for(m=[],y={},v=0;v<g.getDataLength();v++){w=g.getCellData(v,d.itemsetObj.label),C=g.getCellData(v,d.itemsetObj.value);if(a.Z.isNumber(C)&&(C+=""),p&&null===C){if(null===y[w])continue}else if(y[w]==C)continue;y[w]=C,m.push({orgLabel:w,label:f(w,C),value:C})}d.itemArr=m;break;case"dataMap":for(m=[],y={},v=0;v<g.getCount();v++){w=g.get(d.itemsetObj.label),C=g.get(d.itemsetObj.value);if(a.Z.isNumber(C)&&(C+=""),p&&null===C){if(null===y[w])continue}else if(y[w]==C)continue;y[w]=C,m.push({orgLabel:w,label:f(w,C),value:C})}d.itemArr=m}}if(d.itemArr){if("customFormatted"==t){for(v=0;v<i.length;v++){var I=this._applyFormatter(d,i[v]);n.push(I),d.itemHash[I]=i[v]}return n}var _="label"==t?"value":"label";"label"==t&&!1===o&&d.itemArr.length>0&&d.itemArr[0].orgLabel&&(t="orgLabel");var x=d.itemArr.slice(0);for(v=0;v<i.length;v++){var S=i[v];if(a.Z.isNumber(S)&&(S+=""),"custom"==u)-1==this.modelControl.getDataComp(d.dataComp).dataArr.indexOf(i[v])&&n.push(i[v]);for(var R=x.length-1;R>-1;R--){var D=x[R];if(D[_]==S){n.push(D[t]),x.splice(R,1),"label"==t&&(d.itemHash[D[t]]=D[_]);break}if("label"==t||"orgLabel"==t){if(p&&null==S&&!h){h=!0,n.push(this.filterNullStr);break}if(!S||this.useFilterEmptyValueInfo[S]){l||(l=!0,n.push(this.filterEmptyStr));break}}else if("value"==t&&S==this.filterEmptyStr){for(var T in this.useFilterEmptyValueInfo)n.push(T);break}}}}else{if("customFormatted"==t){for(v=0;v<i.length;v++){I=this._applyFormatter(d,i[v]);n.push(I),d.itemHash[I]=i[v]}return n}for(v=0;v<i.length;v++){if("label"==t){
if(p&&null==i[v]&&!h){h=!0,n.push(this.filterNullStr);continue}if(!i[v]&&0!==i[v]||this.useFilterEmptyValueInfo[i[v]]){l||(l=!0,n.push(this.filterEmptyStr));continue}}else if("value"==t&&i[v]==this.filterEmptyStr){for(var T in this.useFilterEmptyValueInfo)n.push(T);continue}n.push(i[v]),d.itemHash[i[v]]=i[v]}}return n}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.resizeGridList=function(){try{var t,e;if(this.groupbyFilterList)return;if(!this.customFilterList)return;t=this.customFilterList,e=this.customFilterScrollView;var i=document.getElementById(this.id+"_"+t.currentHeaderID);if(i){var o,r=i.clientWidth,n=(this.options.useFilterSearch?t.listRowObjArr.length+1:t.listRowObjArr.length)*(this.options.filterListRowHeight+1)-1,l=e.render.clientHeight,h=WebSquare.style.getSize(this.customFilterScrollView.render,"outerwidth")-WebSquare.style.getSize(this.customFilterScrollView.render,"width"),d=WebSquare.style.getRelativeTop(i,this.render)+i.offsetHeight+1,p=WebSquare.style.getRelativeLeft(i,this.render),c=this.getElementById(this.id+"_customFilter_scrollView_container");this.options.useSearchFilter&&WebSquare.style.setStyle(c,"overflow-x","auto");var g=this.getElementById(this.id+"_size_y").clientWidth,f=this.getElementById(this.id+"_body_table"),m=WebSquare.style.getSize(f,"outerwidth")-WebSquare.style.getSize(f,"width"),y=this.getElementById(this.id+"_dataLayer").clientWidth-i.offsetLeft-h-m,b=r=this.customFilterList.getMaxItemWidth();if(a.Z.getBoolean(this.getHeaderInfo(t.currentHeaderID).options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList))if(this.customFilterList){i.clientWidth>r&&(r=i.clientWidth);var v=document.getElementById(this.id+"_dataLayer"),w=v.clientWidth,C=WebSquare.style.getRelativeLeft(v,this.render);o=r+(l<t.render.clientHeight?g:0),this.options.useFilterSearch&&n>l&&(r+=g,o+=g),y<o?((w=v.clientWidth)<o?(p=C,o=w):p=C+w-o-h,y=w):o=Math.min(y,o),this.options.useSearchFilter?r>b&&WebSquare.style.setStyle(c,"overflow-x","hidden"):this.options.useFilterSearch&&WebSquare.style.setStyle(c,"overflow-x","hidden")}else this.groupbyFilterList&&(o=r=b);else if(this.customFilterList){var I=parseInt(this.headerInfoHash[t.currentHeaderID].options.filterListWidth);I>0?r<(o=I-h)&&(r=o):this.options.filterListWidth>0?r<(o=this.options.filterListWidth-h)&&(r=o):(o=i.clientWidth,i.clientWidth>r&&(r=i.clientWidth)),y<o&&(o=y),(this.options.useFilterSearch||r>b)&&WebSquare.style.setStyle(c,"overflow-x","hidden")}if(e.setPosition(p,d-1),t.setSize(r,null),a.Z.getBoolean(this.getHeaderInfo(t.currentHeaderID).options.autoFitFilterList)||a.Z.getBoolean(this.options.autoFitFilterList))if(document.getElementById(this.id+"_scrollX_div").clientHeight>0){var _=document.getElementById(this.id+"_head_table"),x=v.offsetHeight-_.offsetHeight;x<l&&(this._saveScrollViewHeight=(0,u.A)({},i.id,l),l=x)}else if(this._saveScrollViewHeight&&i.id in this._saveScrollViewHeight){var S=this._saveScrollViewHeight[i.id];l!==S&&(l=S)}e.setSize(o,l)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.showGroupbyHeaderGhost=function(t,e){try{var i=this.getHeaderValue(e);WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_header_drag",contents:i,delay:15,applyMousePosition:!0,onDrop:function(t,e,i,o,s,r,a){}})}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setAdaptiveColumnVisible=function(t,e){try{if(this.hiddenAdaptiveList[t]==!e||t>=this.hiddenAdaptiveList.length)return;var i=this,o=function t(e){var o=i.getColumnID(e),s=null!=i.bodyToHeaderRelation[o]?i.getHeaderLayer(i.bodyToHeaderRelation[o]):null;return null!=s?s:t(e-1)}(t),r=document.getElementsByClassName(this.id+"_columnstyle_"+(t-this.defaultColCnt)+"_"),n=this.getColumnStyleValue(t-this.defaultColCnt,"height");if(null==this.oldOptions.headerColBorder&&null!=o&&(this.oldOptions.headerColBorder=WebSquare.style.getStyle(o,"border-top")),
null==this.oldOptions.headerPaddingTop&&null!=o&&(this.oldOptions.headerPaddingTop=WebSquare.style.getStyle(o,"padding-top")),null==this.oldOptions.headerPaddingBottom&&null!=o&&(this.oldOptions.headerPaddingBottom=WebSquare.style.getStyle(o,"padding-bottom")),r.length>0&&""!=this.oldOptions.bodyColBorder&&(this.oldOptions.bodyColBorder=WebSquare.style.getStyle(r[0],"border-top")),this.hasSubtotal)for(var l=0,h=0,d=this.drawedSubtotal[0][0].childNodes,u=0;u<d.length&&((w=parseInt(d[u].getAttribute("colSpan")))||(w=1),!(h<=t&&t<h+w));u++)h+=w,l++;if(this.hasFooter){var p=0,c=0,g=this.htmlInfo.foot.rowArr;for(u=0;u<g.length;u++)for(var f=g[u],m=0;m<f.length;m++){var y=f[m];if((w=parseInt(y.colSpan))||(w=1),c<=t-this.defaultColCnt&&t-this.defaultColCnt<c+w)break;c+=w,p++}}if(e){o.style.height=n,o.style.removeProperty("padding"),o.style.borderTop=this.oldOptions.headerColBorder;for(u=0;u<r.length;u++)r[u].style.height=n,r[u].style.removeProperty("padding"),r[u].style.borderTop=this.oldOptions.bodyColBorder;if(this.setAdaptiveColumnStyle(t,"height",n),this.setAdaptiveColumnStyle(t,"padding",""),this.setAdaptiveColumnStyle(t,"border-top",this.oldOptions.bodyColBorder),this.hasFooter)for(u=0;u<g.length;u++){y=g[u][p];var b=parseInt(this.getFooterStyle(y.id,"height"))+parseInt(o.offsetHeight);!(w=parseInt(y.colSpan))||parseInt(this.getFooterStyle(y.id,"height"))<=0?(this.setFooterStyle(y.id,"height",o.style.height),this.setFooterStyle(y.id,"padding",o.style.padding),this.setFooterStyle(y.id,"borderTop",o.style.borderTop)):this.setFooterStyle(y.id,"height",b+"px")}if(this.hasSubtotal)for(u=0;u<this.drawedSubtotal.length;u++)for(m=0;m<this.drawedSubtotal[u].length;m++){var v=this.drawedSubtotal[u][m].childNodes;b=parseInt(v[l].style.height)+parseInt(o.offsetHeight);!(w=parseInt(v[l].getAttribute("colSpan")))||parseInt(v[l].style.height)<=0?(v[l].style.height=o.style.height,v[l].style.padding=o.style.padding,v[l].style.borderTop=o.style.borderTop):v[l].style.height=b+"px"}}else{if(this.hasFooter)for(u=0;u<g.length;u++){y=g[u][p],b=parseInt(this.getFooterStyle(y.id,"height"))-parseInt(o.offsetHeight);!(w=parseInt(y.colSpan))||b<=0?(this.setFooterStyle(y.id,"height","0px"),this.setFooterStyle(y.id,"padding","0px"),this.setFooterStyle(y.id,"borderTop","0px")):this.setFooterStyle(y.id,"height",b+"px")}if(this.hasSubtotal)for(u=0;u<this.drawedSubtotal.length;u++)for(m=0;m<this.drawedSubtotal[u].length;m++){var w;v=this.drawedSubtotal[u][m].childNodes,b=parseInt(v[l].style.height)-parseInt(o.offsetHeight);!(w=parseInt(v[l].getAttribute("colSpan")))||b<=0?(v[l].style.height="0px",v[l].style.padding="0px",v[l].style.borderTop="0px"):v[l].style.height=b+"px"}var C=parseInt(o.colSpan,10),I=!1;if(C>1)for(var _=a.Z.getDataPrefix("header_id"),x=this.headerToBodyRelation[o.getAttribute(_)],S=this.getColumnIndex(x),R=S;R<S+C;R++)this.hiddenList[R]||(I=!0);(C<2||!I)&&(o.style.height="0px",o.style.padding="0px",o.style.borderTop="0px");for(u=0;u<r.length;u++)r[u].style.height="0px",r[u].style.padding="0px",r[u].style.borderTop="0px";this.setAdaptiveColumnStyle(t,"height","0px"),this.setAdaptiveColumnStyle(t,"padding","0px"),this.setAdaptiveColumnStyle(t,"border-top","0px")}parseInt(o.colSpan,10)>1&&this.setAdaptiveGridHeaderHeight(),this.hiddenAdaptiveList[t]=!e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.applyFilterHistory=function(){try{if(this.getElementById(this.id+"_groupbyFilterBox_apply").checked=this.groupbyFilterBox_history.length>0,!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var t=this.groupbyFilterBox_select.getSelectedIndex(),e=this.groupbyFilterBox_history[t];if(e.groupbyOptions)this.groupby(JSON.parse(e.groupbyOptions,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.A)(i)&&i.constructor===RegExp?i:e}catch(t){return e}}))),this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),
e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={};else{for(var i in this.groupbyStatus.grouped&&this.clearGroupby(),this._dataList.clearFilter(e.filterOption.length>0),this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.refreshCustomFilterHistory(t),this._dataList.broadcast({gridView:["clearHeaderSort"]}),this._dataList.broadcast({gridView:["notifyMultisort"]})}}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._refreshCustomFilterHistory=function(t,e,i){try{for(var o=t?JSON.parse(t,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.A)(i)&&i.constructor===RegExp?i:"object"===(0,l.A)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):[],r="",a="",n=0;n<o.length;n++){var h=o[n];h.noRefresh=n<o.length-1,h.keepTop=!1,h.internal=!0;var d="";for(var u in h.bodyIdColIndexMap)h.bodyIdColIndexMap[u]===h.colIndex&&(d=u);"sort"!==h.type&&(r=',"'+d+'"'+r,a=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+a),this._dataList.setFilter(h);var p=this.bodyToHeaderRelation[this._dataList.cellIdList[h.colIndex]],c=this.getElementById(this.id+"_"+p+"_filter");c&&WebSquare.style.addClass(c,"w2grid_customFilter_filter")}r=r.slice(1)+"],",a=a.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var g='{"column":['+r+'"filteredRowIndexArr":['+a;this.customFilterList.filterHistory=JSON.parse(g),this.customFilterList.customFilterListFilterInfo=e?JSON.parse(e,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.A)(i)&&i.constructor===RegExp?i:"object"===(0,l.A)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):{},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),this.customFilterStatusObj=i?JSON.parse(i):{},this.groupbyStatus.grouped||this.drawHeaderSortImages()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.refreshCustomFilterHistory=function(t){try{for(var e=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()],i="",o="",r=0;r<e.filterOption.length;r++){var a=e.filterOption[r];a.noRefresh=r<e.filterOption.length-1,a.keepTop=!1,a.internal=!0;var n="";for(var h in a.bodyIdColIndexMap)a.bodyIdColIndexMap[h]===a.colIndex&&(n=h);"sort"!==a.type&&(i=',"'+n+'"'+i,o=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+o),this._dataList.setFilter(a);var d=this.bodyToHeaderRelation[this._dataList.cellIdList[a.colIndex]],u=this.getElementById(this.id+"_"+d+"_filter");u&&WebSquare.style.addClass(u,"w2grid_customFilter_filter")}i=i.slice(1)+"],",o=o.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var p='{"column":['+i+'"filteredRowIndexArr":['+o;this.customFilterList.filterHistory=JSON.parse(p),e.customFilterListFilterInfo?this.customFilterList.customFilterListFilterInfo=JSON.parse(e.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.A)(i)&&i.constructor===RegExp?i:"object"===(0,l.A)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):this.customFilterList.customFilterListFilterInfo={},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.clearFilterHistory=function(){try{this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!1,this.groupbyFilterBox_history=[],this.groupbyFilterBox_select.removeAll(),
this.groupbyStatus.grouped?this.clearGroupby():this._dataList.clearFilter()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.refreshGroupbyFilterBox=function(){try{var t=this._dataList.getFilterList(),e="",i=!(!this.options.customFilterBox||!this.groupbyStatus.groupbyOptions),o=i?"[Groupby] ":"";if(!this.options.customFilterBox&&!this.groupbyStatus.groupbyOptions)return;e+=o,e+="(";for(var r,n=null,h="",d=!0,u=o,p=!1,c=this.options.groupbyFilterBoxLabelSize,g=this._dataList.options.useNull,f=0;f<t.length;f++){var m="regExp"===(D=t[f]).type,y="func"===D.type&&D.param;if(m||y){d||(e+=" "+D.condition+" ",u+=D.condition),e+="(";var b=this._dataList.cellIdList[D.colIndex],v=this.getHeaderValue(this.bodyToHeaderRelation[b])||b;if(m){var w=this.dataList.getColData(b,this._dataList.filteredRowIndexArr);if((k=this.getUniqueValueOfArray(w)).length<=0){if(a.Z.isNullReg(D.key)){n=b,h=v;break}continue}for(var C=0,I=0;I<k.length;I++){var _=k[I];g&&null==_?_=this.filterNullStr:this.useFilterEmptyValueInfo[_]&&(_=this.filterEmptyStr),C>0&&(C<c&&(e+=" OR "),u+="OR"),C<c&&(e+=v+" = "+_),u+=b+"="+_,C++}C>c&&(e+=" OR ... ("+(C-c)+" omitted)")}else if(y)for(I=0;I<D.param.length;I++){null!=(E=D.param[I]).radio&&(e+=1===E.radio?" OR ":" AND ",u+=1===E.radio?" OR ":" AND ");var x="string"==typeof E.auto?E.auto.replace(/[\\](?![\\])/g,""):E.auto;e+=v+" "+this.selectboxItemSet[E.select-1]+" "+x,u+=b+" "+this.selectboxItemSet[E.select-1]+" "+E.auto}e+=")",d=!1}}if(e+=")",n&&(e=o+"("+h+" = NULL)",u=o+n+"_NULL_"),"()"!==e&&e!==o+"()"||(e=o+"ALL",u=o+"_ALL_",p=!0),!p&&this.options.groupbyFilterBoxFormatter){var S=a.Z.getGlobalFunction(this.options.groupbyFilterBoxFormatter,this.scope_id);if("function"==typeof S){var R=[];if(u===o+n+"_NULL_")R.push({header:h,filter:[]});else for(f=0;f<t.length;f++){var D;m="regExp"===(D=t[f]).type,y="func"===D.type&&D.param;if(m||y){b=this._dataList.cellIdList[D.colIndex];var T=this.getHeaderValue(this.bodyToHeaderRelation[b])||b;if(m){var L={header:T,filter:[]},k=(w=this.dataList.getColData(b,this._dataList.filteredRowIndexArr),this.getUniqueValueOfArray(w)),F=[];for(I=0;I<k.length;I++){_=k[I];g&&null==_?_=this.filterNullStr:this.useFilterEmptyValueInfo[_]&&(_=this.filterEmptyStr),F.push(_)}var A=this.getCellInfo(b);L.filter.push({operator:"in",values:F,labels:A.itemsetObj||A.itemArr?this.changeItemValue("label",b,k.slice(0)):F}),R.push(L)}else if(y){for(L={header:T,filter:[]},I=0;I<D.param.length;I++){var E=D.param[I],M={};null!=E.radio&&(M.gate=1===E.radio?"or":"and"),M.operator=this.selectboxItemSet[E.select-1];x="string"==typeof E.auto?E.auto.replace(/[\\](?![\\])/g,""):E.auto;M.values=x;A=this.getCellInfo(b);M.labels=A.itemsetObj||A.itemArr?this.changeItemValue("label",b,[x])[0]:x,L.filter.push(M)}D.param.length>0&&R.push(L)}}}var O=S.call(this,R,i);null!=O&&!1!==O&&(e=O)}}if(!p&&!1===this.groupbyFilterBox_select.setValueNM(u))this.groupbyFilterBox_select.addItem(u,e),this.groupbyFilterBox_select.setValueNM(u),u===o+"_ALL_"?r={filterOption:[],customFilterStatusObj:"{}"}:(r={filterOption:t,customFilterStatusObj:JSON.stringify(this.customFilterStatusObj)},this.groupbyStatus.grouped&&this.groupbyStatus.filter?r.customFilterListFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e})):this.customFilterList&&this.customFilterList.customFilterListFilterInfo&&(r.customFilterListFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e})))),this.groupbyStatus.groupbyOptions&&(r.groupbyOptions=this.groupbyStatus.groupbyOptions),this.groupbyFilterBox_history.push(r);this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!p}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getMouseColumnIndex=function(t){try{var e=t.colIndex,i=t.offsetX,o=t.offsetLeft,r=t.colSpan
;if(i-o<(l=.3*this.colWidthList[e]>10?10:parseInt(.3*this.colWidthList[e],10))&&0!=e)e--;else{for(var a=e-1;a>=0&&!0===this.hiddenList[a];a--)r--;for(var n=0;n<r;n++){var l,h=parseInt(this.colGroup.bodyColList[e+n].style.width,10);if((o+=h)-(l=.3*h>10?10:parseInt(.3*h,10))<i&&i<o+l){e+=n;break}}}return e}catch(t){return s.Y.printStackTrace(t,null,this),e}},f.prototype._useRole=function(){try{return!a.Z.isMobile()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype.setAdaptive=function(){try{var t=this.options.adaptive,e=parseInt(this.options.adaptiveThreshold)||480;for(var i in this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=a.Z._getBrowserWidth()?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}"crosstab"==t&&(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10||(a.Z._getBrowserWidth()<=e?this.addAdaptive():this.removeAdaptive()))}catch(t){s.Y.printStackTrace(t)}},f.prototype.setAdaptiveFrame=function(t){try{var e=this.options.adaptive,i=parseInt(this.options.adaptiveThreshold)||480;for(var o in this.hideThresholdObj){parseInt(this.hideThresholdObj[o])>=a.Z._getBrowserWidth()?this.setColumnVisible(o,!1):this.setColumnVisible(o,!0)}"crosstab"==e&&(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10||(t&&0<t.newWidth&&t.newWidth<=i?this.addAdaptive():this.removeAdaptive()))}catch(t){s.Y.printStackTrace(t)}},f.prototype.addAdaptive=function(){try{var t,e=this.options.adaptive;for(var i in"crosstab"==e&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=a.Z._getBrowserWidth()?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}if(!this.hasClass(t)){this.oldOptions.visibleRowNum=this.options.visibleRowNum,this.oldOptions.drawType=this.options.drawType,this.options.visibleRowNum="all",this.options.drawType="virtual",this.adjustDraw(this.lastIndex),this.addClass(t),this.setAdaptiveGridBodyHeight(),this.setAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight(),this.options.autoScope&&this._setScope(!0);for(var o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}if(this.options.adaptiveSlideHeader){var r=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody");this.slideHeadObj||(this.slideHeadObj={},this.slideHeadObj.render=r,this.slideHeadObj.headTableWidth=r.offsetWidth,this.slideHeadObj.hidden=!1),"absolute"!=this.slideHeadObj.render.style.position?n.scrollWidth>n.clientWidth+this.slideHeadObj.headTableWidth&&(this.slideHeadObj.render.style.position="absolute",this.options.adaptiveSlideHeaderOnScroll||($(this.slideHeadObj.render.firstChild).animate({width:"hide"}),this.slideHeadObj.hidden=!0)):n.scrollWidth==n.clientWidth&&(a.Z.clearTimeout(this.id+"_adaptiveSlideHeader"),this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1)}}catch(t){s.Y.printStackTrace(t)}},f.prototype.removeAdaptive=function(){try{var t;if("crosstab"==this.options.adaptive&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.options.adaptiveSlideHeader&&this.slideHeadObj&&(this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1),this.hasClass(t)){this.options.visibleRowNum=this.oldOptions.visibleRowNum,this.options.drawType=this.oldOptions.drawType;for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);if(this.removeClass(t),this.removeAdaptiveGridBodyHeight(),this.removeAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),
this.options.autoScope&&this._setScope(!1),this._isBrowserScroll()){if(this._refreshDataChanged(),this._isHybridScroll())document.getElementById(this.id+"_scrollY_div").scrollTop=0}else if(""!=this.options.visibleRowNum){this.focusedCell=[],this.initializeDrawController(),this.dataRowList=[],this.drawedRowLength=0,this.lastDisplayedRow=-1;for(var i=this.getElementById(this.id+"_body_tbody");i.firstChild;)i.removeChild(i.firstChild);if(this.options.senseReader){for(e=0;e<this.adaptiveEmbeddedInputIdList.length;e++)delete this.dom[this.adaptiveEmbeddedInputIdList[e]];this.adaptiveEmbeddedInputIdList=[]}this.drawDataTable(0)}this.event.removeEvent(this.id+"_body_tbody","onscroll")}}catch(t){s.Y.printStackTrace(t)}},f.prototype._setScope=function(t){try{for(var e=document.getElementById(this.id).getElementsByClassName(this.options.headerTdClass),i=0;i<e.length;i++){var o=e[i],r=o.getAttribute("scope");t&&"col"===r?o.setAttribute("scope","row"):t||"row"!=r||o.setAttribute("scope","col")}}catch(t){s.Y.printStackTrace(t)}},f.prototype.doAdaptive=function(){try{if(""!=this.options.adaptive)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="9999999",this.setAdaptive(),this.adaptiveDoneBy="doAdaptive"}catch(t){s.Y.printStackTrace(t)}},f.prototype.undoAdaptive=function(){try{if("doAdaptive"!=this.adaptiveDoneBy)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="1",this.setAdaptive(),this.options.adaptive="",this.options.adaptiveThreshold="",this.adaptiveDoneBy=""}catch(t){s.Y.printStackTrace(t)}},f.prototype.checkRefreshAdaptive=function(){try{var t=!1;if(!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)){var e=WebSquare.BootLoader.fullViewed||!1,i=a.Z.fullViewed||!1;if(!e&&!i&&this.checkAdaptiveGridType()&&(""!=this.options.adaptive||0!=Object.keys(this.hideThresholdObj).length)){var o=this.options.adaptive,n=parseInt(this.options.adaptiveThreshold)||480;"crosstab"==o&&a.Z._getBrowserWidth()<=n&&(t=!0)}}return t}catch(t){s.Y.printStackTrace(t)}},f.prototype.refreshAdaptive=function(t){try{if(!0===this.checkRefreshAdaptive())if(t&&!0===t.simple){for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);for(var i in this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=a.Z._getBrowserWidth()?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!1)}else this.removeAdaptive(),this.addAdaptive()}catch(t){s.Y.printStackTrace(t)}},f.prototype._applyFormatter=function(t,e){try{var i=a.Z.getGlobalFunction(t.options.customFormatter,this.scope_id),o=e,r=e;if("text"==t.options.inputType)(t.options.displayFormat||t.options.displayFormatter||t.options.ioFormat)&&(r=t.formatter.format(e));else if("select"==t.options.inputType)for(var n=t.itemArr.slice(0),l=0;l<=n.length-1;l++)if(n[l].value==e){r=n[l].label;break}"function"==typeof(i=a.Z.getGlobalFunction(t.options.customFormatter,this.scope_id))&&(o=i.call(t.mainGrid,o,r));var h=this._dataList.options.useNull,d=o;return h&&null==o?d=this.filterNullStr:""==o&&(d=this.filterEmptyStr),d}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getScrollYWidth=function(t){try{var e=0,i=document.getElementById(this.id+"_scrollY_div");if(!0!==this._isBrowserScroll()||this.options.autoFitFixYScroll)e="offsetWidth"===t?i.offsetWidth:this.options.autoFitFixYScroll?this.scrollLayerWidthSize:parseInt(i.style.width,10);else{var o=this.id+"_dataLayer",r=0;!0===this._isHybridScroll()&&(i.offsetWidth>this._getEpsilon()?(o=this.id+"_scrollY_div",r=1):o=this.id+"_main_div");var a=document.getElementById(o);e=a.offsetWidth-a.clientWidth+r}return e}catch(t){return s.Y.printStackTrace(t,null,this),0}},f.prototype._autoFitRefreshNative=function(){try{
if(!0===this._isNativeScroll())this._getScrollYWidth()!==this._bScrollYWidth&&this._setAutoFit()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._isBrowserScroll=function(){try{return"native"===this.options.drawType||"hybrid"===this.options.drawType}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._isNativeScroll=function(t){try{return"X"===t?!0===this.options.scrollXNative:"both"===t?"native"===this.options.drawType||!0===this.options.scrollXNative:"native"===this.options.drawType}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._isHybridScroll=function(){try{return"hybrid"===this.options.drawType}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridRowNum=function(){try{return Math.abs(this.options.hybridRowNum)||1}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridVisibleHeightInfo=function(t){try{if(t<=0)return{height:0,cnt:0};var e=document.getElementById(this.id+"_body_tbody").childNodes;isNaN(t)&&(t=this._getHybridRowNum(),this.oneRowLength>1&&(t*=this.oneRowLength));for(var i=0,o=0,r=0,a=0;a<e.length&&t>0;a++){var n=e[a].offsetHeight,l=n>0;if(l&&(i+=n),!this.hasSubtotal||null==e[a].getAttribute("data-subtotal")){if(--t<=0||a>=e.length-1)for(var h=0;h<e[a].childNodes.length;h++){var d=e[a].childNodes[h].clientHeight;if(d>0){o=n-d;break}}l||r++}}return{height:i,cnt:t+r,borderHeight:o}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setHybridVisibleHeight=function(t,e){try{null==t&&(t=this._hybridRowIndex);var i=this._getHybridLastIndex();null==e&&(e=this._getHybridVisibleHeightInfo());var o=e.height,r=this._hybridScrollHash[t];null==r&&(r=this._hybridScrollHeight),this._hybridScrollHash[t]=o;var a=this._hybridScrollDupHeight,n=0;t===i&&(this._hybridScrollDupHeight=this._getHybridDupHeight(),n=this._hybridScrollDupHeight-a);for(var l=0,h=!0,d=0,u=0;u<=i;u++){if(null==this._hybridScrollHash[u]){h=!1;break}d+=this._hybridScrollHash[u]}var p=document.getElementById(this.id+"_size_y"),c=this.getFooterHeight();if(!0!==this._hasHybridScroll()){var g=document.getElementById(this.id+"_body_table"),f=document.getElementById(this.id+"_main_div");l=Math.max(g.offsetHeight,f.offsetHeight-1)+c+this._getHybridScrollXHeight()-p.offsetHeight+1,this._hybridScrollLastTop=0}else if(!0===h){l=d+document.getElementById(this.id+"_head_table").offsetHeight-p.offsetHeight-this._hybridScrollDupHeight+c+this._getHybridScrollXHeight()+1,this._hybridScrollLastTop=d-this._hybridScrollHash[i]-this._getHybridLastSubtotalHeight()-e.borderHeight}else l=o-r-n;if(0!==l&&!0===this._useHybridScroll()){var m=p.offsetHeight+l;this._setHybridSizeY(m)}return l}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridVisibleTop=function(){try{var t=document.getElementById(this.id+"_scrollY_div"),e=1;return a.Z.isIEAllVersion()||(e=document.getElementById(this.id+"_head_table").offsetHeight),t.scrollTop-e-this._hybridScrollYPos}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._adjustHybridEditedPosition=function(t,e){try{isNaN(e)&&(e=3);var i=document.getElementById(t),o=document.getElementById(this.id+"_head_table").offsetHeight;if(i.offsetTop<o)i.style.top=o+"px";else if(i.offsetTop+i.offsetHeight>this.render.offsetHeight){var r=document.getElementById(this.id+"_scrollX_div").offsetHeight;i.style.top=Math.max(this.render.offsetHeight-i.offsetHeight-r-e,o)+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridLastIndex=function(){try{var t=this.getDataLength(),e=0,i=t;return this.oneRowLength>1&&(i*=this.oneRowLength),i>this._getHybridTrCount()&&(e=Math.max(Math.ceil(t/this._getHybridRowNum())-1,0)),e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._hasHybridScroll=function(){try{if(document.getElementById(this.id+"_body_tbody").offsetHeight<this._getEpsilon())return!1;var t=this.getDataLength(),e=this._getHybridTrCount(),i=this._getHybridRowNum();return this.oneRowLength>1&&(i*=this.oneRowLength,t*=this.oneRowLength),e>i&&t>e}catch(t){
s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridTrCount=function(){try{var t=document.getElementById(this.id+"_body_tbody").childNodes,e=t.length;if(this.hasSubtotal)for(var i=0;i<t.length;i++)null!=t[i].getAttribute("data-subtotal")&&e--;return e}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridDupHeight=function(){try{if(!0!==this._hasHybridScroll())return 0;var t=this._getHybridRowNum(),e=this.getDataLength(),i=e-Math.floor(e/t)*t,o=0;if(i>0){var r=t-i;this.oneRowLength>1&&(r*=this.oneRowLength),o=this._getHybridVisibleHeightInfo(r).height}return o}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridLastSubtotalHeight=function(){try{var t=0;if(this.hasSubtotal)for(var e=this.lastSubtotalRow;null!=e&&null!=e.getAttribute("data-subtotal");e=e.previousSibling)t+=e.offsetHeight;return t}catch(t){return s.Y.printStackTrace(t,null,this),0}},f.prototype._setHybridYPosition=function(t){try{if(isNaN(t))return;var e=a.Z.isIEAllVersion(),i=e?"_body_table":"_body_tbody",o=document.getElementById(this.id+i);if(!o||!o.style)return;if("relative"!=o.style.position&&(o.style.position="relative;"),o.style.transform="translate3d(0,"+-t+"px,0)",e)for(var r=o.getElementsByTagName("th"),n=0;n<r.length;n++){var l=r[n];"relative"!=l.style.position&&(l.style.position="relative"),l.style.transform="translate3d(0,"+t+"px,0)";var h=parseInt(l.style.zIndex);(h<10||isNaN(h))&&(l.style.zIndex=10)}}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._getHybridWheelDeltaY=function(t){try{var e=t;this._hybridWheelCntY>0?this._hybridWheelCntY++:this._hybridWheelCntY=1;var i=this._hybridWheelCntY/10,o=Math.min(i,1),r=Math.max(i,1);r>1&&a.Z.isMobile()&&(r=1+.1*r),r=Math.min(r,5),e=Math.round(e*(l=o,1-Math.pow(1-l,3))*r);var n=this.uuid;return a.Z.setTimeout((function(){WebSquare.idCache[n]._hybridWheelCntY=0}),{key:this.id+"_getHybridWheelDeltaY",delay:100}),e}catch(e){return s.Y.printStackTrace(e,null,this),t}var l},f.prototype._setHybridWheelDeltaY=function(t){try{var e=document.getElementById(this.id+"_scrollY_div"),i=e.scrollTop+this._getHybridWheelDeltaY(t);e.scrollTop=i}catch(e){return s.Y.printStackTrace(e,null,this),t}},f.prototype._setHybridWheelDeltaX=function(t){try{var e=document.getElementById(this.id+"_scrollX_right"),i=e.scrollLeft+t;e.scrollLeft=i}catch(t){return s.Y.printStackTrace(t,null,this),deltaY}},f.prototype._getHybridScrollXHeight=function(){try{var t=0,e=document.getElementById(this.id+"_scrollX_div");return null!=e&&(t=e.offsetHeight),t}catch(t){return s.Y.printStackTrace(t,null,this),0}},f.prototype._drawDataHybrid=function(t,e){try{if(!0!==this._isHybridScroll())return this.drawData(t);void 0!==e&&null!=e||(e={});var i=this._getHybridRowNum(),o=this.getDataLength(),r=Math.floor(t/i),a=t-r*i;if(this._hybridRowIndex===r&&!0!==e.redraw)return!1;this._hybridRowIndex=r;var n=Math.min(r*i,o-i);n=Math.max(n,0),this.drawData(n),!0===e.redraw&&this.setScrollYHeightHybrid(),this._setHybridVisibleHeight();for(var l=0,h=0;h<r;h++){l+=null==this._hybridScrollHash[r]?this._hybridScrollHeight:this._hybridScrollHash[r]}if(a>0){this._getHybridVisibleHeightInfo(a);this.oneRowLength>1&&(a*=this.oneRowLength),l+=this._getHybridVisibleHeightInfo(a).height}e={scrollTop:l,maxRepeat:5,skipEndEdit:!0};return document.getElementById(this.id+"_scrollY_div").scrollTop=l,this.handleScrollYHybrid({},e),!0}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._useHybridScroll=function(){try{var t=document.getElementById(this.id+"_main_div"),e=document.getElementById(this.id+"_body_table"),i=this.getFooterHeight();return t.offsetHeight<e.offsetHeight+i}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setHybridSizeY=function(t,e){try{if(!0===this._useHybridScroll()){this.setOverflowYScroll();var i=document.getElementById(this.id+"_size_y");i.offsetHeight!==t&&(i.style.height=t+"px")}else this.setOverflowYHidden()}catch(t){s.Y.printStackTrace(t,null,this)}},f.prototype._setHybridDataLayerTop=function(){try{
var t=document.getElementById(this.id+"_dataLayer");0!==t.scrollTop&&(t.scrollTop=0)}catch(t){s.Y.printStackTrace(t,null,this)}};var m=function(){};m.prototype.setTableLayout=function(){try{this.initializeHead(),this.initializeFooter(),this.setDataLayerPosition(),this.arrangeOverflowXScroll(),this.handlerResize_drawInitializer(),this.setTrRowTable(),this.setTrSubtotalRowTable(),this.initialColWidthList=this.colWidthList.slice(),this.initialGridWidth=this.gridWidth,this._setAutoFit(),this.realRowDataLength=this.oneRowDataLength+this.defaultColCnt,this.associateHeaderBody(),this.options.columnMove&&this.createBlockedHeaderInfo(),this.lastDisplayedRow=-1;for(var t=0;t<this.oneRowDataLength;t++){var e=this.cellInfoHash2[this.tdIdList[t]],i=new WebSquare.uiplugin.cellInfo(e,this);"textarea"==i.options.inputType&&(this.isExistTextarea=!0),i.options.colMerge&&(this.isColMerge=!0,a.Z.getBoolean(this.options.colMergeAnd)&&(this.isColMergeAnd=!0),i.options.upperColumn&&(this.upperToLowerColumnRelation[i.options.upperColumn]||(this.upperToLowerColumnRelation[i.options.upperColumn]=[]),this.upperToLowerColumnRelation[i.options.upperColumn].push(i.options.id))),null!=i.options.maxLength&&""!==i.options.maxLength&&(i.options.maxlength=i.options.maxLength),this.cellInfoHash[i.id]=i,this.cellIdList.push(i.id);var o=i.options.hideThreshold;void 0!==o&&(this.hideThresholdObj[i.id]=o)}this.drawFooter(),this.drawHeader();for(var r=0;r<this.thIdList.length;r++){var n=this.headerInfoHash2[this.thIdList[r]];if(n){var l=new WebSquare.uiplugin.headerInfo(n,this);this.headerInfoHash[l.id]=l,this.colMoveHeaderIndexMap[l.id]=r}}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setDataLayerPosition=function(){try{var t=this.getElementById(this.id+"_dataLayer");if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table").offsetHeight;e=0==e?this.footerHeight:e,t.style.bottom=e+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.arrangeOverflowXScroll=function(t){try{this.fixedWidth=0;for(var e=this.getFixedColumnLastIndex(),i=0;i<e;i++)this.hiddenList[i]||(this.fixedWidth+=this.colWidthList[i]);this.fixedWidth=parseInt(this.fixedWidth,10)||0,this.fixedWidthRight=0;var o=this.getFixedRightColumnLastIndex(),r=this.colWidthList.length;for(i=r-1;i>=o;i--)this.hiddenList[i]||(this.fixedWidthRight+=this.colWidthList[i]);if(this.fixedWidthRight=parseInt(this.fixedWidthRight,10)||0,e>this.defaultColCnt||o<r)for(var a=this.getColumnCount(),n=this.data_td_list.length/a,l=0;l<n+1;l++){if(e>this.defaultColCnt){var h=e-this.defaultColCnt;(u=this.data_td_list[l*a+(e-this.defaultColCnt)])&&this.addClass(u,"w2grid_fixedColumn");for(var d=0;d<h;d++){(g=this.data_td_list[l*a+d])&&this.addClass(g,"w2grid_fixedColumn_td")}}if(o<r){var u,p=o-this.defaultColCnt;(u=this.data_td_list[l*a+(o-this.defaultColCnt)])&&this.addClass(u,"w2grid_fixedRightColumn");for(var c=a-1;c>=p;c--){var g;(g=this.data_td_list[l*a+c])&&this.addClass(g,"w2grid_fixedRightColumn_td")}}}if(!0!==t){var f=this.getElementById(this.id+"_scrollX_div"),m=this.getElementById(this.id+"_scrollX_table"),y=0===f.offsetWidth?0:f.offsetWidth-m.offsetWidth,b=this.getElementById(this.id+"_scrollX_left"),v=this.getElementById(this.id+"_scroll_size"),w=this.getElementById(this.id+"_scrollX_fixedRight");b.style.width=this.fixedWidth+"px",v.style.width=this.gridWidth-this.fixedWidth-this.fixedWidthRight-y+"px",w.style.width=this.fixedWidthRight+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.handlerResize_drawInitializer=function(){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;if(this.setOverflowY(),this.setOverflowX(),this.setIE6Fix(),this.options.headFiller){var t=this.getElementById(this.id+"_header_bg_td"),e=this.getElementById(this.id+"_dataLayer").offsetWidth-1,i=this.getElementById(this.id+"_head_table").offsetHeight,o=e,r=i;for(t.style.width=e+"px";t.offsetWidth!=o;)t.offsetWidth>o?e--:e++,t.style.width=e+"px"
;for(t.style.height=i+"px";t.offsetHeight!=r;)t.offsetHeight>r?i--:i++,t.style.height=i+"px"}if(this.options.groupbyZone){var a=this.getElementById(this.id+"_main_div"),n=this.groupbyZoneStatus.groupbyZoneRender?this.groupbyZoneStatus.groupbyZoneRender.offsetHeight:0;if(this.isIE6or7&&(a.style.height=a.offsetHeight-n),this.options.groupbyFilterBox){var l=this.getElementById(this.id+"_groupbyFilterBox_div"),h=this.getElementById(this.id+"_groupbyFilterBox_buttons");if(this.isIE6or7){a.style.height=a.offsetHeight-(this.scrollLayerWidthSize+l.offsetHeight)-3+"px",h.style.left=-h.offsetWidth;var d=this.scrollLayerWidthSize+l.offsetHeight+n,u=Math.ceil(d/this.oneRowScrollHeight),p=this.getElementById(this.id+"_scrollY_div");this.lastIndex>-1&&this.lastIndex>u&&p.offsetHeight<p.scrollHeight&&this.cutGridBottom(this.lastIndex-u)}else"bottom"===this.options.groupbyFilterBoxLocation&&(a.style.bottom=this.scrollLayerWidthSize+l.offsetHeight+"px",a.style.height="")}else this.isIE6or7&&this.cutGridBottom(this.lastIndex-Math.ceil(n/this.oneRowScrollHeight))}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setIE6Fix=function(){try{var t=this.options.fixPrint&&(a.Z.isIE(9)||a.Z.isIE(10)||r.I.browserCheck.ieAllVersion&&"11"==document.documentMode||a.Z.isFF());if(this.isIE6or7||a.Z.isOpera()||t){var e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_scrollY_div"),o=this.getElementById(this.id+"_main_div"),n=this.render.offsetHeight-e.offsetHeight,l=this.render.offsetWidth-i.offsetWidth+2;n=n<0?0:n,l=l<0?0:l,o.style.height=n+"px",o.style.width=l+"px";var h,d=0;if(this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d),""!==this.options.visibleRowNum){var u=this.getElementById(this.id+"_body_table");h=!this.defaultDataLayerHeight||u.offsetHeight>this.defaultDataLayerHeight?u.offsetHeight+d:this.defaultDataLayerHeight+d}else h=n-d-1;h=h<0?0:h;var p=this.getElementById(this.id+"_dataLayer");p.style.height=h+"px",this.dataLayerHeight=h;var c=this.getElementById(this.id+"_scrollX_right");c.style.width=c.parentNode.offsetWidth+"px",t&&(o.style.position="relative",o.style.bottom="",o.style.right="",p.style.position="relative",p.style.bottom="")}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype._setOverflowXNative=function(t){if(!0===this._isBrowserScroll()){var e=document.getElementById(this.id+"_scrollX_div"),i=document.getElementById(this.id+"_dataLayer");if(!1===t||this.options.fixedColumn<=0&&this.options.fixedRightColumn<=0)return e.style.visibility="hidden",void(i.style.overflowX="auto");!0===t&&(e.style.visibility="visible",i.style.overflowX="hidden")}},m.prototype.setOverflowX=function(t){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowX=t):e=!1,t=this.isMobile?"hidden":this.options.overflowX){case"auto":this.setOverflowXAuto();break;case"hidden":this.setOverflowXHidden();break;default:this.setOverflowXScroll()}this.isMobile&&this.setIScrollX(),e&&this.setIE6Fix()},m.prototype.setOverflowXAuto=function(){var t=this.getElementById(this.id+"_scrollX_div"),e=this.getElementById(this.id+"_scrollX_left"),i=this.getElementById(this.id+"_scrollX_right"),o=e.offsetWidth;if(this.options.fixedRightColumn){var s=this.getElementById(this.id+"_scrollX_fixedRight");s&&(o+=s.offsetWidth)}i.firstChild.offsetWidth>t.offsetWidth-o?this.setOverflowXScroll():this.setOverflowXHidden()},m.prototype.setOverflowXScroll=function(){try{var t=(l=this.getElementById(this.id+"_scrollX_div")).style.height;if(l.style.height=this.scrollLayerWidthSize+"px",this.options.scrollFocus){var e=this.getElementById(this.id+"_scrollX_right"),i=this.getElementById(this.id+"_scrollX_left");e.firstChild.offsetWidth>l.offsetWidth-i.offsetWidth?e.setAttribute("tabIndex","0"):e.setAttribute("tabIndex","-1")}var o=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation
;if(-1!==this.rowIndex&&"0px"===t&&!o&&!0!==this._isBrowserScroll())if(""!==this.options.visibleRowNum){var r=parseInt(this.render.style.height,10);this.setSize(null,r+this.scrollWidthSize)}else{this.dataLayerHeight-=this.scrollWidthSize;var a=this.dataRowList[(this.lastIndex+1)*this.oneRowLength-1];a&&a.offsetTop+a.offsetHeight>this.dataLayerHeight&&(this._setRowDisplay(this.lastIndex,"none"),this.lastIndex=this.lastIndex-1,this.maxRowLength=this.maxRowLength-1,this.lastDisplayedRow=this.lastIndex,this.lastTopRowIndex=null,this.setScrollYHeight({noDraw:!0}),this.setOverflowYAuto())}if(!this.isIE6or7){var n=this.getElementById(this.id+"_main_div"),l=this.getElementById(this.id+"_scrollX_div"),h=parseInt(l.style.height,10);if(n.style.bottom=h+"px",this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation){var d=this.getElementById(this.id+"_groupbyFilterBox_div");n.style.bottom=this.scrollLayerWidthSize+d.offsetHeight+"px"}}if(o)(d=this.getElementById(this.id+"_groupbyFilterBox_div")).style.bottom=this.scrollLayerWidthSize+"px"}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setOverflowXHidden=function(){try{var t=this.getElementById(this.id+"_scrollX_div"),e=t.style.height;if(t.style.height="0px",this.options.scrollFocus){var i=this.getElementById(this.id+"_scrollX_right"),o=this.getElementById(this.id+"_scrollX_left");i.firstChild.offsetWidth>t.offsetWidth-o.offsetWidth?i.setAttribute("tabIndex","0"):i.setAttribute("tabIndex","-1")}"0px"!=e&&this.handleScrollX();var r=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"!==e&&!r&&!0!==this._isBrowserScroll())if(""!==this.options.visibleRowNum){var a=parseInt(this.render.style.height,10);this.setSize(null,a-this.scrollWidthSize)}else{this.dataLayerHeight+=this.scrollWidthSize,this.maxRowLength=this.maxRowLength+1;var n=this.getDataLength();this.maxRowLength>=n&&(this.getElementById(this.id+"_size_y").style.height="0px"),this.setOverflowYAuto(),this.drawData(this.rowIndex,this.lastIndex);for(var l=0;l<this.tdIdList.length;l++){var h=this.cellInfoHash[this.tdIdList[l]];if(h.dataComp){var d=this.modelControl.getDataComp(h.dataComp);"linkedDataList"===d.initializeType&&d.syncWithParent()}}this.lastTopRowIndex=null}var u=this.getElementById(this.id+"_main_div");if(this.isIE6||(u.style.bottom="0px"),r)this.getElementById(this.id+"_groupbyFilterBox_div").style.bottom="0px"}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setOverflowY=function(t){if(!0!==this._isBrowserScroll()){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowY=t):e=!1,t=this.isMobile?"hidden":this.options.overflowY){case"auto":this.setOverflowYAuto();break;case"hidden":this.setOverflowYHidden();break;default:this.setOverflowYScroll()}this.isMobile&&this.setIScrollY(),e&&this.setIE6Fix()}},m.prototype.setOverflowYAuto=function(){if(!0!==this._isBrowserScroll()){var t=this.getElementById(this.id+"_scrollY_div");t.offsetHeight<t.scrollHeight?this.setOverflowYScroll():this.setOverflowYHidden()}},m.prototype.setOverflowYScroll=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_main_div"),o=parseInt(t.style.width,10);if(t.style.width=this.scrollLayerWidthSize+"px",t.style.overflowY="scroll",this.isIE6){var s=this.render.offsetWidth-this.scrollWidthSize;e.style.width=(s>0?s:0)+"px",t.style.height=this.render.offsetHeight+"px"}else i.style.right=this.scrollWidthSize-1+"px",e.style.right=this.scrollWidthSize+"px";this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);0==o&&!0!==this._setOverflowYScrollFlag&&(this._setOverflowYScrollFlag=!0,this._setAutoFit(),this._setOverflowYScrollFlag=!1),
this.options.scrollFocus&&(t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1"))},m.prototype.setOverflowYHidden=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=parseInt(t.style.width,10);t.style.width="0px",t.style.overflowY="hidden";var i=this.getElementById(this.id+"_main_div");this.isIE6||(i.style.right="0px",this.getElementById(this.id+"_scrollX_div").style.right="0px");this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);if(0!=e&&!0!==this._setOverflowYHiddenFlag&&(this._setOverflowYHiddenFlag=!0,this._setAutoFit(),this._setOverflowYHiddenFlag=!1),this.options.scrollFocus&&(t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1")),!0===this._isHybridScroll()){var o=document.getElementById(this.id+"_size_y"),s=t.offsetHeight;o.offsetHeight!==s&&(o.style.height=s+"px")}},m.prototype.setTrRowTable=function(){try{this.tempDiv=document.createElement("div"),this.tempDiv.style.width="0px",this.tempDiv.style.height="0px",this.tempDiv.style.overflow="hidden",this.tempDiv.innerHTML="<table id='tempTable' style='table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.htmlInfo.body,"tbody","td",this.options.bodyTdClass)+"</table>",this.tempTr=this.tempDiv.getElementsByTagName("table")[0];var t=this.tempTr.getElementsByTagName("td");this.aria_labelledby=[];for(var e=0;e<t.length;e++)this.aria_labelledby[e]=t[e].getAttribute("aria-labelledby"),t[e].innerHTML="";this.tempDiv.id=this.id,this.tempDiv.className=this.options.className+" w2grid",this.render.parentNode.appendChild(this.tempDiv);var i,o=this.tempDiv.getElementsByTagName("tbody")[0],r=o.getElementsByTagName("tr")[0];0==(i=r?r.offsetHeight:o.offsetHeight)?(i=-1!=this.options.defaultCellHeight?this.options.defaultCellHeight:20,this._visibleRowNumFixResetFlag=!0):this._visibleRowNumFixResetFlag=!1,this.oneRowHeight=i+(a.Z.isIE(6)||a.Z.isIE(7)?1:0),this.options.scrollRowHeight&&(this.oneRowScrollHeight=this.oneRowHeight),this.render.parentNode.removeChild(this.tempDiv)}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setTrSubtotalRowTable=function(){try{for(var t in this.subtotalTableList={},this.subtotalStrList){var e=document.createElement("div");e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",this.subtotalClassList&&this.subtotalStrList[t].attr?e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.subtotalStrList[t].attr.subtotalClass)+"</table>":e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.options.subtotalTdClass)+"</table>";for(var i=e.getElementsByTagName("table")[0],o=i.getElementsByTagName("td"),r=a.Z.getDataPrefix("or_wd"),n=a.Z.getDataPrefix("width"),l=!0===this._isHybridScroll(),h=0;h<o.length;h++){var d=o[h],u=d.getAttribute(n);u&&(d.removeAttribute(n),d.setAttribute(r,u)),l&&this.defaultColCnt,this.setConfigOptions(d,"subtotal")}this.subtotalTableList[t]=i}}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype._setAutoFit=function(t){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;this.autofitDone=!0;var e=(t=t||{}).type?t.type:this.options.autoFit;"none"!==e&&e||(e="clear");var i=t.exceptCol,o=t.exceptWidth||0,r=this._getScrollYWidth();!0===this._isNativeScroll()&&(this._bScrollYWidth=r);var n=this.render.clientWidth;a.Z.isIEAllVersion()&&(n=this.render.clientWidth||parseInt(this.render.style.width,10)||parseInt(WebSquare.style.getComputedStyle(this.render,"width"),10)),this.autofit_clientWidth=n;for(var l=0,h=this.colWidthList.length-1;h>=0;h--)if(0==this.hiddenList[h]){l=h;break}if("selectedColumn"==e&&!this.autofitColumn){
if(this.gridWidth>=n)return;this.autofitColumn=!0;var d=this.defaultColCnt+t.colIndex;this.gridWidth-=this.colWidthList[d],this.autofitColumnIndexArr.push(d),this.colWidthList[d]="*",this.autofitColumnWidthArr[d]="*"}if(this.autofitColumn){var u=n,p=this.autofitColumnIndexArr.slice();r>0&&(u-=r);for(h=p.length-1;h>=0;h--){var c=p[h];1!=this.hiddenList[c]&&c!==i||p.splice(h,1)}var g=0,f=[];for(h=0;h<this.colWidthList.length;h++)if(1!=this.hiddenList[h])if(h===i)this._setColumnWidth(h,o),u-=o;else if(h<this.autofitColumnWidthArr.length&&this.autofitColumnWidthArr[h]){var m=this.autofitColumnWidthArr[h].substring(0,this.autofitColumnWidthArr[h].indexOf("*"));m.length>0?f.push(parseInt(m,10)):0==m.length&&f.push(1)}else u-=this.colWidthList[h];var y=function(t){if(!t.length)return 0;for(var e,i=t.length-1,o=t[i];i;)for(var s=t[--i];e=s%o;s=o,o=e);return o}(f);for(h=0;h<f.length;h++)f[h]=f[h]/y,g+=f[h];var b=Math.floor(u/g),v=u-b*g;for(h=0;h<p.length;h++){var w=this.options.autoFitMinWidth||0,C=b*f[h];f[h]=Math.max(C,w)}if(v>0)if(1==p.length)f=[u];else{var I=f.slice();for(h=v;h>0;h--){for(var _={},x=0;x<f.length;x++)if(1!=this.hiddenList[p[x]]){var S=Math.abs((I[x]-(f[x]+1))*(this.gridWidth/I[x]));(null==_.distortion||_.distortion>S)&&(_.distortion=S,_.index=x)}f[_.index]++}}for(var R=0;R<f.length;R++)this._setColumnWidth(p[R],f[R])}if("lastColumn"==e){this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth,this.orgLastWidth=this.colWidthList[l],this.orgLastVisibleCol=l),"number"==typeof i&&i!=l&&(this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o));var D=n-r-this.gridWidth+this.colWidthList[l];D>this.orgLastWidth?this._setColumnWidth(l,D):this._setColumnWidth(l,this.orgLastWidth)}else if("allColumn"==e){if(!this.autofitColumn){var T=this.autoFitColWidthList||this.colWidthList,L=n-r,k={},F=0;for(h=this.defaultColCnt;h<this.hiddenList.length;h++)1==this.hiddenList[h]&&F++;if(this.options.keepDefaultColumnWidth)for(h=0;h<this.defaultColCnt;h++)k[h]=!0;for(h=this.defaultColCnt;h<T.length;h++)!1===this.isColumnResizable(h)&&(k[h]=!0);var A=parseInt(this.options.autoFitCellMinWidth);if(!isNaN(A)&&A>0){w=A*(this.getColumnCount()-F);for(var E=0;E<this.defaultColCnt;E++)w+=this.colWidthList[E]}else w=parseInt(t.minWidth?t.minWidth:this.options.autoFitMinWidth,10);for(var M in!isNaN(w)&&w>L&&(L=w),L-=o,k)this.hiddenList[M]||(L-=this.colWidthList[M]);var O=0;for(h=0;h<T.length;h++)O+=this.hiddenList[h]||h===i||k[h]?0:T[h];var N=0,H=O?L/O:0,G=[];if(H){for(h=0;h<T.length;h++)if(h==i)this.colWidthList[h]=o;else if(k[h]);else{G[h]=H*T[h];var W=Math.round(G[h]);this.colWidthList[h]=W,N+=this.hiddenList[h]?0:W}var B=L-N,V=B>0?1:-1;for(h=0;h<B*V;h++){var q={};for(x=0;x<T.length;x++)if(!this.hiddenList[x]&&x!=i&&!k[x]){S=Math.abs(G[x]-(this.colWidthList[x]+V))*(N/this.colWidthList[x]);(null==q.value||q.value>S)&&(q.value=S,q.index=x)}this.colWidthList[q.index]+=V,N+=V}if(this.hiddenList[0]&&a.Z.isIE(8))for(h=0;h<this.colWidthList.length;h++)if(!this.hiddenList[h]){this.colWidthList[h]=this.colWidthList[h]-2;break}}for(var M in this.autoFitColWidthList||(this.autoFitColWidthList=this.colWidthList.slice(0)),this.gridWidth=N+o,k)this.hiddenList[M]||(this.gridWidth+=this.colWidthList[M]);this.arrangeOverflowXScroll();var Y="";this.options.autoFitMinWidth||this.options.autoFitCellMinWidth||(Y="hidden"),this.setOverflowX(Y),this.scrollXPreventEndEdit=!0,this.handleScrollX(),this.scrollXPreventEndEdit=!1,this.handlerResize_drawInitializer()}if(!this.groupbyStatus.grouped)for(h=0;h<this.oneRowDataLength;h++){var Z=this.getCellInfo(h);"text"!=Z.options.inputType&&"secret"!=Z.options.inputType&&"calendar"!=Z.options.inputType||!Z.options.embeddedInput||!this.options.autoResizeEmbeddedInput&&"calendar"!=Z.options.inputType||this.hiddenList[h]||(this.embeddedWidthObj[h]&&(this.embeddedWidthObj[h].isChanged=!0),this.drawColumnData(h))}}else"clear"==e&&"number"==typeof i&&(this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth),
this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o))}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setAutoFit=function(t){try{t&&(this.options.autoFit=t.type),this._setAutoFit(t)}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.clearAutoFit=function(t){try{this.options.autoFit="",-1===this.initialColWidthList.indexOf("*")&&(this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autoFitColWidthList=null,this.gridWidth=this.initialGridWidth,this.colWidthList=this.initialColWidthList.slice(),this.arrangeOverflowXScroll(),this.setOverflowX("auto"),this.handleScrollX())}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.autoFitFunc=function(){this.autofit_clientWidth===this.render.clientWidth?r.I.clearTimer(this.id+"_autofit"):r.I.setTimer(this._setAutoFit,{key:this.id+"_autofit",caller:this,delay:100})},m.prototype.setIScrollX=function(){try{if(!0===this.options.scrollXNative)return;var t=this.getElementById(this.id+"_iScrollX");if(!t)return;var e=this.getElementById(this.id+"_scrollX_right");if(e.offsetWidth>=e.firstChild.offsetWidth)return void(t.style.visibility="hidden");var i=this.getElementById(this.id+"_dataLayer"),o=parseInt(this.getElementById(this.id+"_scrollX_left").style.width,10),r=e.firstChild.offsetWidth-e.offsetWidth,a=parseInt(e.offsetWidth*e.offsetWidth/e.firstChild.offsetWidth,10);t.style.width=(a<30?30:a)+"px",t.style.left=o+e.scrollLeft/r*(i.offsetWidth-o-t.offsetWidth)+"px",t.style.visibility=""}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.setIScrollY=function(){try{if(!0===this._isBrowserScroll())return;var t=this.getElementById(this.id+"_iScrollY");if(!t)return;var e=this.getDataLength(),i=this.rowIndex,o=this.getElementById(this.id+"_size_y").parentNode.offsetHeight;if(0==o&&(o=parseInt(this.getStyleValue("height"))),-1==i||0==i&&i+this.lastIndex+1==e){var r=!this.hasSubtotal;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var a=this.drawedSubtotal[this.drawedSubtotal.length-1];if(a.rowIndex==e-1)"none"!=a[a.length-1].style.display&&(r=!0)}if(r)return void(t.style.visibility="hidden")}var n=this.getElementById(this.id+"_scrollY_div"),l=n.firstChild.offsetHeight,h=this.getElementById(this.id+"_dataLayer"),d=l-h.offsetHeight,u=parseInt(h.offsetHeight*h.offsetHeight/l,10);t.style.height=(u<30?30:u)+"px",t.style.top=n.scrollTop/d*(h.offsetHeight-t.offsetHeight)+"px",t.style.visibility=""}catch(t){s.Y.printStackTrace(t,null,this)}},m.prototype.createBlockedHeaderInfo=function(){try{this.columnBlock={info:{},hash:{}};for(var t=[],e=this.getColCnt(),i=0;i<e;i++)t.push(1);for(var o in this.struct){var r;if("subtotalArr"===o)r=this.struct[o][0].rowArr;else{if(!this.struct[o]||!this.struct[o].rowArr)continue;r=this.struct[o].rowArr}for(var a=0;a<r.length;a++)for(var n=0,l=0;l<r[a].length;l++){var h=parseInt(r[a][l].colSpan,10)||1;for(i=1;i<h;i++)t[n+i]=0;n+=h}}var d=0;for(i=0;i<t.length;i++){var u=t[i];1===u?(this.columnBlock.info[i]=[i],this.columnBlock.hash[i]=i,d=i):0===u&&(this.columnBlock.info[d].push(i),this.columnBlock.hash[i]=d)}}catch(t){s.Y.printStackTrace(t,null,this)}};var y=function(){};y.prototype.initializeEvent=function(){try{if(this.otherClickEvent(),this.checkResize(),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblClickEvent)),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),a.Z.isIEAllVersion()){if(a.Z.isIEAllVersion()){if(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||p.f.preventDefault(t)}))),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||p.f.preventDefault(t)}))),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,(function(t){
this.options.preventPaste&&!this.editedCell&&"native"!==this.options.copyType&&p.f.preventDefault(t)}))),!0===this.options.noSelect)document.getElementById(this.id+"_main_div").onselectstart=function(t){if(a.Z.isIEAllVersion()&&t&&t.srcElement){var e=t.srcElement;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName)return!0}return!1};else!0===this.options.preventCopy&&(this.render.onselectstart=function(){return!1})}}else r.I.browserCheck.safari?(this.event.addListener(WebSquare.getBody().render,"onbeforecopy",this.event.bindAsEventListener(this,this.handleBeforeCopyEvent)),this.event.addListener(WebSquare.getBody().render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(WebSquare.getBody().render,"onbeforecut",this.event.bindAsEventListener(this,this.handleBeforeCutEvent)),this.event.addListener(WebSquare.getBody().render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent))):!1===a.Z.isExecCommandSupported()&&(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent)));this.isMobile||(this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollX_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)),this.options.useMoreButton&&this.event.addListener(this.getElementById(this.id+"_grid_more_button"),"onclick",this.event.bindAsEventListener(this,(function(t){WebSquare.event.fireEvent(this,"onscrollend")}))),this.hasFooter&&this.event.addListener(this.getElementById(this.id+"_foot_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)));var t=this.isHammerEnabled();if(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"oncontextmenu",this.event.bindAsEventListener(this,this.clickRightButtonCell)),this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,(function(t){WebSquare.event.fireEvent(this,"ongridmouseleave",t)}))),this.event.addListener(this.render,"onmouseenter",this.event.bindAsEventListener(this,(function(t){WebSquare.event.fireEvent(this,"ongridmouseenter",t)}))),t||(this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.gridOut)),this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseout",this.event.bindAsEventListener(this,this.gridHeaderOut))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeyDownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyUpEvent)),a.Z.isOpera()&&this.event.addListener(this.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||p.f.preventDefault(t)})),this.options.dataDragDrop||this.options.dataDragDropSelf||this.options.dataDragDropCell){if(1==this.isMobile){if(t){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}
}else this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0;this.options.dataDragDropOther||this.options.dataDragDropSelf||(this._useShiftKey=!0)}else this.options.dataDragDrop||this.options.dataDragDropSelf||this.options.dataDragDropCell||!this.options.dataDragSelect||this.isMobile||this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.handleDragSelectEvent));if(r.I.setTimer((function(){this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(t){var e=WebSquare.getBody().getLayerListener();if(e.layers[this.id]){for(var i=e.layers[this.id].component,o={};i.parentControl;)for(var s in i=i.parentControl,e.useOtherComponentId)e.useOtherComponentId[s]==i.id&&(o[s]=!0);WebSquare.getBody().getLayerListener().hideAll(o)}this.parentControl&&this.parentControl.options&&("gridItemTable"==this.parentControl.options.pluginName||"gridViewItemTable"==this.parentControl.options.pluginName)||p.f.stopPropagation(t)})))}),{key:this.id+"initializeEvent",caller:this,delay:100}),!0===this._isBrowserScroll()&&this.options.scrollXNative||(a.Z.isTouchDevice()&&!window.navigator.msPointerEnabled?(this.iScroll={},this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,this.handleTouchStart)),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"ontouchend",this.event.bindAsEventListener(this,this.handleTouchEnd))):window.navigator.msPointerEnabled&&-1!=window.navigator.userAgent.toLowerCase().indexOf("touch")?(this.iScroll={},this.render.style.touchAction="none",this.event.addListener(this.render,"onMSPointerDown",this.event.bindAsEventListener(this,this.handleTouchStart)),this.event.addListener(this.render,"onMSPointerMove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"onMSPointerUp",this.event.bindAsEventListener(this,this.handleTouchEnd))):!0===this._isBrowserScroll()||(this.options.senseReader?(this.options.useStartEndDiv&&(this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onfocus",this.event.bindAsEventListener(this,this.handleStartDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleStartDivKeyDown)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onfocus",this.event.bindAsEventListener(this,this.handleEndDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeyup",this.event.bindAsEventListener(this,this.handleEndDivKeyUp))),this.options.scrollFocus?this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)):this.options.useStartEndDiv&&this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleEndDivKeyDown))):this.options.scrollFocus&&this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)))),t&&!this._bindPressEvent)try{e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.render),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){if(!o._bindPressEvent){for(var e,i=p.f.getTarget(t),s=-1;i&&"BODY"!=i.tagName;){if("TD"==i.tagName&&o.hasClass(i,o.options.bodyTdClass)){s=o.getElemRowIndex(i),e=i;break}i=i.parentNode}o.removeFocusedCell(),o._dataList.setRowPosition(s),e&&o.__setFocusedCell({},e,{editMode:"none"}),o.handleDblClickEvent(t),p.f.fireEvent(o,"ondblclick",t)}})))}))}catch(t){
s.Y.printStackTrace(t,null,this)}if(this._isNativeScroll("both")){var o=document.getElementById(this.id+"_dataLayer");i=this.uuid;o&&(o.onscroll=function(t){var e=WebSquare.idCache[i];e._endEdit();var o=document.getElementById(e.id+"_dataLayer"),s=o.scrollTop,r=o.offsetHeight,a=o.scrollLeft;e._nativeScrollInfo||(e._nativeScrollInfo={x:0,y:0});var n=a-e._nativeScrollInfo.x,l=s-e._nativeScrollInfo.y;if(Math.abs(l)>0&&!0===e._isNativeScroll()){if(WebSquare.util.isIEAllVersion())for(var h=document.getElementById(e.id+"_head_table").getElementsByTagName("th"),d=s+"px",u=0;u<h.length;u++){var c=h[u];"relative"!=c.style.position&&(c.style.position="relative"),c.style.top=d}r+s>=o.scrollHeight&&p.f.fireEvent(e,"onscrollend"),p.f.fireEvent(e,"onscrolly",t)}Math.abs(n)>0&&!0===e.options.scrollXNative&&p.f.fireEvent(e,"onscrollx",t),e._nativeScrollInfo={x:a,y:s}})}this.initializeLayoutEvents(),n.q.addCheckResize(this.uuid,"checkResize")}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleStartDivFocus=function(t){try{if(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[],"true"!==this.options.keepScrollForSenseReader&&!0!==this._isBrowserScroll()){var e=this.getElementById(this.id+"_scrollY_div"),i=this.getElementById(this.id+"_size_y");i&&i.offsetHeight>0&&(this.addGridScroll(0-this.rowIndex),0!=e.scrollTop&&this.addGridScroll(0-this.rowIndex)),this._dataList.setRowPosition(-1)}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleEndDivFocus=function(t){this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[]},y.prototype.handleScrollDivKeyDown=function(t){if(t.shiftKey&&9==t.keyCode){for(var e=this.getRowCount()-1,i=this.getRightMostFocusableColIndex(e);e>=0&&null==i;)e-=1,i=this.getRightMostFocusableColIndex(e);if(null!==i){var o=this.getCellInfo(i),s=0;if("radio"===o.options.inputType){var r=this.getCheckedIndex(o.colID)[0];r>0&&(s=r),this._setFocusedCell(s,i,!1,{tabDirection:"left"}),p.f.stopEvent(t)}else this.options.senseReader&&"link"===o.options.inputType&&(null==this.focusedCell||this.focusedCell&&0==this.focusedCell.length)&&(s=this.rowIndex+this._getVisibleLastIndex(this.lastIndex),this._setFocusedCell(s,i,!1,{tabDirection:"left"}),p.f.stopEvent(t))}}else switch(t.keyCode){case 38:case 40:case 9:p.f.stopPropagation(t)}},y.prototype.handleStartDivKeyDown=function(t){try{if("Tab"===t.key)if(t.shiftKey){if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID){var e=a.Z.getPreTabbableComp(this.id);e&&e.focus(t),p.f.preventDefault(t)}}else t.shiftKey||9!=t.keyCode||this._lastHeaderElementId||this._setFirsCellFocus(t)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleEndDivKeyDown=function(t){try{if(9==t.keyCode)if(t.shiftKey){if("none"===this.options.focusMode)return;var e=this.getElementById(this.id+"_main_div").offsetHeight,i=parseInt(this.getElementById(this.id+"_size_y").style.height,10)-e,o=this.getElementById(this.id+"_scrollY_div").scrollTop,r=this._getEpsilon();if(o<i&&(o=Math.min(Math.round(o)+r,i)),i!=o){for(var n=0,l=0;l<this.getRowCount();l++)n+=this.getHasSubtotalCount(l);this.addGridScroll(this.getRowCount()-this.rowIndex-this.lastIndex-1+n)}for(var h=this.getRowCount()-1,d=this.getRightMostFocusableColIndex(h,{shiftTab:!0});h>=0&&null==d;)h-=1,d=this.getRightMostFocusableColIndex(h);null!=d&&(this._setFocusedCell(h,d,!1,{tabDirection:"left"}),p.f.stopEvent(t))}else if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID){var u=a.Z.getNextTabbableComp(this.id);u&&u.focus(t),p.f.preventDefault(t)}}catch(t){return s.Y.printStackTrace(t,null,this),!1}},y.prototype.handleEndDivKeyUp=function(t){try{38==t.keyCode&&"all"!=this.options.visibleRowNum&&(this.getElementById(this.id+"_scrollY_div").scrollTop=0)}catch(t){return s.Y.printStackTrace(t,null,this),!1}},y.prototype.handleTdFocus=function(t){
var e,i=p.f.getTarget(t),o=this.getLastFocusedCell(),s=a.Z.getDataPrefix("tdIndex"),r=a.Z.getDataPrefix("col_id");if("TD"==i.tagName&&o.focusedTd!=i&&!this.focusedByApi){var n,l,h,d,u,c,g=parseInt(i.getAttribute(s)),f=parseInt(g/this.realRowDataLength)+this.rowIndex,m=i.getAttribute(r);if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&(e=null!=this.editedCell)){var y=this.getCellInfo(this.editedCell.colID);n=y.editRowIndex,l=this._dataList.getColumnIndex(y.id),h=this.getColumnIndex(y.id),d=this.getRealRowIndex(n),u=this._dataList.dataArr[d*this._dataList.getColumnCount()+l],c=y.comp&&y.comp.selectedIndex}if(this._setFocusedCell(f,m),e){var b=this._dataList.dataArr[d*this._dataList.getColumnCount()+l];if(0===u&&(u="0"),0===b&&(b="0"),u!=b){var v={oldValue:u,newValue:b,rowIndex:n,colIndex:h,colId:this.getColumnID(h)};isNaN(c)||(v.oldSelectedIndex=c,v.newSelectedIndex=y&&y.comp&&y.comp.selectedIndex),p.f.fireEvent(this,"onviewchange",v)}}}this.focusedByApi=!1},y.prototype.handleDragSelectEvent=function(t){if(!this._bindDrag&&!1!==this.options.dataDragSelect)for(var e=this.body_table.offsetHeight,i=this.event.getTargetIterator(t);i.next();)if(i.match(this.options.bodyTdClass,null,"td")){var o=this,s=i.getElement();if(!0===this.getCellInfo(s).options.blockSelect)return;return void WebSquare.dragdrop.gDragManager.activate(t,this.render,{id:this.id+"_dragSelect",delay:15,handleStart:function(t){a.Z.isIEAllVersion()&&(a.Z.emptySelection(),p.f.preventDefault(t));var e,i,r,n,l,h,d=null!=o.editedCell;if(d&&(e=o.editedCell.editRowIndex,i=o._dataList.getColumnIndex(o.editedCell.id),r=o.getColumnIndex(o.editedCell.id),n=o._grid.getRealRowIndex(e),l=o._dataList.dataArr[n*o._dataList.getColumnCount()+i]),o.__setFocusedCell(t,s,{editMode:!1}),d&&l!=(h=o._dataList.dataArr[n*o._dataList.getColumnCount()+i])){var u={oldValue:l,newValue:h,rowIndex:e,colIndex:r,colId:o.getColumnID(r)};p.f.fireEvent(o,"onviewchange",u)}},handleUpdate:function(t,i,s,r,a){for(var n=null,l=null,h=o.event.getTargetIterator(a);h.next();){if(h.match("w2grid")){n=h.getElement().id;break}h.match(o.options.bodyTdClass,null,"td")&&(l=h.getElement())}var d=o.focusedCell[0];o.options.dataDragSelectAutoScroll&&d.focusedColIndex>-1&&o.dragSelectAutoScroll(p.f.getMouseY(a),e,p.f.getMouseX(a)),null!=n&&null!=l&&o.id==n&&d.focusedColIndex>-1&&(l.className.indexOf("_rowNum")>=0||l.className.indexOf("_rowStatus")>=0||o.__setFocusedCell({shiftKey:!0},l,{editMode:!1}))},handleFinish:function(){o.dragSelectAutoScrollFinish()}})}},y.prototype.handleDragEvent=function(t){if((!this.options.rowResize||!this.rowResizeStarted)&&(!this.isDrillDown||this.drillDownDragDrop)&&!this.editedCell&&(0!=this.options.dataDragDrop||0!=this.options.dataDragDropSelf||0!=this.options.dataDragDropCell))for(var e=a.Z.getDataPrefix("tdIndex"),i=a.Z.getDataPrefix("col_id"),o=(a.Z.getDataPrefix("colindex"),a.Z.getDataPrefix("index")),s=this.event.getTargetIterator(t);s.next();){if(this.options.dataDragDropCell){if(s.match("gridBodyDefault_rowNumber")||s.match("gridBodyDefault_rowStatus"))return;if(!s.match("gridBodyDefault_data"))continue}else if(this.options.dataDragDrop&&!(s.match("gridBodyDefault_data")||s.match("gridBodyDefault_rowNumber")||s.match("gridBodyDefault_rowStatus")))continue;var n=s.getElement(),l=[],h=n.getAttribute(e),d=this.rowIndex+parseInt(parseInt(h)/(this.oneRowDataLength+this.defaultColCnt));""==this.options.dragDisplayColumn?l.push(n.getAttribute(i)):l=this.options.dragDisplayColumn.split(",");for(var u=[],c=0;c<l.length;c++){var g;g=null==l[c]||null==l[c]?(d+1).toString():this._getCellDisplayData(d,l[c].wq_trim()),u.push(g)}if(u=u.join(","),this.isMobile){for(var f=p.f.getTarget(t);f&&"TD"!=f.tagName&&"TH"!=f.tagName&&"DIV"!=f.tagName;)f=f.parentNode;this.__setFocusedCell(t,f)}var m=this,y={id:this.id+"_drag",component:m,className:"w2grid_drag",contents:u,delay:15,applyMousePosition:!0,showNoData:!0,handleStart:function(t){
m._useShiftKey&&(t.shiftKey?m.options.dataDragDropOther=!0:m.options.dataDragDropOther=!1),p.f.fireEvent(m,"ondatadragstart",d)},handleUpdate:function(t,e,i,o,s){var r=null;r=m.isMobile?new WebSquare.targetIterator(document.elementFromPoint(s.changedTouches[0].clientX,s.changedTouches[0].clientY)):m.event.getTargetIterator(s);for(var a=null;r.next()&&!m.options.dataDragDropCell;)if(m.options.dataDragDrop){if(!(r.match("gridBodyDefault_data")||r.match("gridBodyDefault_rowNumber")||r.match("gridBodyDefault_rowStatus")))continue;a=r.getElement()}var n=m.getElementById(m.id+"_resize_line");if(a&&!m.options.dataDragDropOther&&m.options.useDataDragDropGuideLine){var l=a.offsetHeight+a.offsetTop+"px";n.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",n.style.display="block",n.style.zIndex=999,n.style.top=l,n.style.width=m.render.offsetWidth+"px",n.style.left=0,n.style.border="1px solid #3a3f44"}},handleFinish:function(){m.getElementById(m.id+"_resize_line").style.display="none"},onDragover:function(t,e,i,o,s,r,n){if(t&&e){var l=null;for(l=m.isMobile?new WebSquare.targetIterator(document.elementFromPoint(n.changedTouches[0].clientX,n.changedTouches[0].clientY)):m.event.getTargetIterator(n);l.next();)if(l.match("w2grid")||l.match("w2grid_tooltip")){if(l.match("w2grid_tooltip"))l.getElement().style.display="none",l=new WebSquare.targetIterator(document.elementFromPoint(p.f.getClientX(n),p.f.getClientY(n)));var h=a.Z.getComponentById(l.getElement().id);h&&m.id!=h.id&&p.f.fireEvent(h,"ondatadragover",m.id,d),l.stop()}}},onDrop:function(t,s,n,l,h,u,c){var g=null,f=null,y=null,b=null,v=null,w=null,C={},I=null,_=null;for(w=m.isMobile?new WebSquare.targetIterator(document.elementFromPoint(c.changedTouches[0].clientX,c.changedTouches[0].clientY)):m.event.getTargetIterator(c);w.next();){if(w.match(null,null,"body"))return;if(w.match("w2grid")){g=w.getElement().id;break}if(w.match("w2grid_tooltip"))w.getElement().style.display="none",w=new WebSquare.targetIterator(document.elementFromPoint(p.f.getClientX(c),p.f.getClientY(c)));if(w.match("w2treeview")||w.match("w2treeview_virtual")||w.match("w2input")||w.match("w2textarea")||m.options.dataDragDropClass&&w.match(m.options.dataDragDropClass)){I=w.getElement().id;break}if(w.match("w2treeview_node")||w.match("treeview_virtual_node"))_=w.getElement().getAttribute(o);else if(null==y){if(m.options.dataDragDropCell){if(w.match("gridBodyDefault_rowNumber")||w.match("gridBodyDefault_rowStatus"))return;if(!w.match("gridBodyDefault_data"))continue}else if(m.options.dataDragDrop&&!(w.match("gridBodyDefault_data")||w.match("gridBodyDefault_rowNumber")||w.match("gridBodyDefault_rowStatus")))continue;var x=w.getElement();y=parseInt(x.getAttribute(e),10),"string"!=typeof(b=x.getAttribute(i))&&(b=void 0)}}if((!m.options.dataDragDropSelf||m.id===g)&&(!m.options.dataDragDropOther||m.id!=g)&&(null!=g&&(f=(g=a.Z.getComponentById(g)).getDataLength(),null!=y&&(f=g.rowIndex+parseInt(y/(g.oneRowDataLength+g.defaultColCnt)))),null!=I&&(I=a.Z.getComponentById(I)),g||I)){var S,R,D,T=t.getAttribute(i),L=m.getColumnIndex(T);if(m.options.dataDragDropCell)if(S=[],m.focusedCell.length>1)for(var k=0;k<m.focusedCell.length;k++){var F=(O=m.focusedCell[k]).focusedColIndex,A={rowIndex:O.focusedRowIndex,colIndex:F,colId:m.getColumnID(F),data:m.dataList.getCellData(O.focusedRowIndex,F)};S.push(A)}else{A={rowIndex:d,colIndex:L,colId:T,data:m.dataList.getCellData(d,L)};S.push(A)}else if(m.options.dataDragDrop){var E=g&&""==g.options.dragEndFunction&&""==m.options.dragStartFunction;if(m.focusedCell.length>1&&(m.options.dataDragDropClass||E)){P=[],j=[];var M=[];for(k=0;k<m.focusedCell.length;k++){var O,N=(O=m.focusedCell[k]).focusedRowIndex;M.push(N)}j=M.filter((function(t,e,i){return i.indexOf(t)===e})),j.sort((function(t,e){return t-e}));for(k=0;k<j.length;k++)for(var H=m.dataList.getRowArray(j[k]).data,G=0;G<H.length;G++)P.push(H[G])}else R=m.dataList.getRowArray(d).data}
if(""!=m.options.dragStartFunction){var W=a.Z.getGlobalFunction(m.options.dragStartFunction,m.scope_id);if("function"==typeof W)if(m.drillDownDragDrop){var B,V;m.getRowCount()<=f?(B=void 0,V=void 0):(B=m.getRealRowIndex(f),V=m.dataList.getRowData(f));var q=[U=m.getRealRowIndex(d)].concat(m.drilldown.getRecursiveRowIndex(U)),Y=[];for(k=0;k<q.length;k++)Y=Y.concat(m.dataList.getRowData(m.getDisplayRowIndex(q[k])));if(!W.call(m,{parentRowIndex:B,parentRowData:V,beforeRemoveData:Y,beforeRemoveRowIndex:q}))return}else{var Z={fromColumnId:T,fromColumnIndex:L,rowJSON:m.dataList.getRowJSON(d)};null==D&&(D=m.dataList.getRowXML(d)),D=W.call(m,d,D,Z)}}else if(g&&m.id!==g.id&&m.drillDownDragDrop){var j=[U=m.getRealRowIndex(d)].concat(m.drilldown.getRecursiveRowIndex(U)),P=[];for(k=0;k<j.length;k++)P=P.concat(m.dataList.getRowData(m.getDisplayRowIndex(j[k])))}if(g&&""!=g.options.dragEndFunction){var z=a.Z.getGlobalFunction(g.options.dragEndFunction,g.scope_id);if("function"==typeof z)if(m.drillDownDragDrop){if(m.id==g.id){if(m.isDrillDown&&f!=d){var U=m.getRealRowIndex(d);if(m.getRowCount()<=f)m.drilldown.bodyDrop=!0,Q=(tt=m.getRealRowIndex(f-1))+m.drilldown.getRecursiveRowCount(tt);else Q=m.getRealRowIndex(f)+1;var X=[U].concat(m.drilldown.getRecursiveRowIndex(U)),K=m.drilldown.moveNode(U,Q),$=[K.insertedRowIndex].concat(m.drilldown.getRecursiveRowIndex(K.insertedRowIndex)),J=[];for(k=0;k<X.length;k++)J.push(m.dataList.getRowJSON(X[k]));C={removedData:K.detachedData,removedRowIndex:X,insertedData:K.insertedData,insertedRowIndex:$,fromRowIndex:U,toRowIndex:$[0],rowJSON:J},z.call(m,Q,m.dataList.getRowXML(d),C)}}else if(g.drillDownDragDrop&&g.isDrillDown){var Q,tt;U=m.getRealRowIndex(d);if(g.getRowCount()<=f)g.drilldown.bodyDrop=!0,Q=(tt=g.getRealRowIndex(f-1))+g.drilldown.getRecursiveRowCount(tt);else Q=g.getRealRowIndex(f);for(q=[U].concat(m.drilldown.getRecursiveRowIndex(U)),Y=[],k=0;k<q.length;k++)Y=Y.concat(m.dataList.getRowData(m.getDisplayRowIndex(q[k])));D=m.dataList.getRowXML(d);for(J=[],k=0;k<q.length;k++)J.push(m.dataList.getRowJSON(q[k]));C={removedData:Y,removedRowIndex:q,fromRowIndex:U,toRowIndex:Q,rowJSON:J},z.call(m,Q,D,C)&&m._dataList.removeRow(U)}}else{v="string"==typeof b?g.getColumnIndex(b):void 0;Z={};if(m.options.dataDragDropCell){if(Z={fromColumnId:T,fromColumnIndex:L,toColumnId:b,toColumnIndex:v,cellDataArray:S},z.call(m,f,null,Z)){m._setEmbeddedInputValue(g,d,L,!0);for(k=0;k<S.length;k++){var et=S[k];m._dataList.setCellData(et.rowIndex,et.colId,null)}}}else m.options.dataDragDrop&&(Z={fromColumnId:T,fromColumnIndex:L,toColumnId:b,toColumnIndex:v,rowJSON:m.dataList.getRowJSON(d)},!0!==r.I.isXML(D)&&(D=m.dataList.getRowXML(d)),z.call(m,f,D,Z)&&(m._setEmbeddedInputValue(g,d,L,!0),m.dataList.removeRow(d)))}}else if(g){v="string"==typeof b?g.getColumnIndex(b):void 0;var it={_this:m,targetGrid:g,cellDataArray:S,rowsArray:P,rowsArrayIndex:j,rowIndex:d,rowXml:D,targetRowIndex:f,rowArray:R,fromColumnIndex:L,toColumnId:b,toColumnIndex:v};m._defaultDragEndHandler(it),m.removeFocusedCell(),m.id!=g.id?p.f.fireEvent(g,"ondatadrop",{fromId:m.id,fromRowIndex:d,toRowIndex:f}):p.f.fireEvent(g,"ondatadropself",{id:m.id,fromRowIndex:d,toRowIndex:f}),t.blur()}else if(I){var ot;null!=_&&(ot=I.tree.findNodeByIndex(_),_=parseInt(_,10)),p.f.fireEvent(I,"ondropfromgrid",{dataListId:m._dataList.id,fromId:m.id,fromRowIndex:d,value:this.contents,dropNode:ot,toRowIndex:_,rowIndexArr:j||[d]}),m.removeFocusedCell(),t.blur()}}}};return this.isMobile&&(y.passive=!1,y.showGhostOnActivate=!0,y.ghostRightTop=!0,y.delay=0),void WebSquare.dragdrop.gDragManager.activate(t,n,y)}},y.prototype._defaultDragEndHandler=function(t){try{var e=t._this,i=t.targetGrid,o=t.cellDataArray,a=t.rowsArray,n=t.rowsArrayIndex,l=t.rowIndex,h=t.rowXml,d=t.targetRowIndex,u=t.rowArray,p=t.fromColumnIndex,c=(t.toColumnId,t.toColumnIndex);if(e.isDrillDown)if(e.id==i.id&&d!=l){if(e.drillDownDragDrop){var g=e.getRealRowIndex(l);if(e.getRowCount()<=d)e.drilldown.bodyDrop=!0,
f=(m=e.getRealRowIndex(d-1))+e.drilldown.getRecursiveRowCount(m);else f=e.getRealRowIndex(d)+1;return void e.drilldown.moveNode(g,f)}}else if(i.drillDownDragDrop&&i.isDrillDown){var f,m;g=e.getRealRowIndex(l);if(i.getRowCount()<=d)i.drilldown.bodyDrop=!0,f=(m=i.getRealRowIndex(d-1))+i.drilldown.getRecursiveRowCount(m);else f=i.getRealRowIndex(d)+1;for(var y=[g].concat(e.drilldown.getRecursiveRowIndex(g)),b=[],v=y.length-1;v>=0;v--)b=b.concat(e.dataList.getRowData(e.getDisplayRowIndex(y[v])));return i.drilldown.appendNode(f,b),void e.dataList.removeRow(g)}var w=i._dataList.getBroadcast();if(i._dataList.setBroadcast(!1),e.options.dataDragDropCell&&o){if(void 0===c)return;e._setEmbeddedInputValue(i,l,p,!0);for(v=0;v<o.length;v++){var C=o[v];e._dataList.setCellData(C.rowIndex,C.colId,null)}var I=o[0].rowIndex,_=o[0].colIndex;for(v=1;v<o.length;v++)o[v].rowIndex<I&&(I=o[v].rowIndex),o[v].colIndex<_&&(_=o[v].colIndex);for(var x=i.getRowCount(),S=i.getColumnCount(),R=0;R<o.length;R++){var D=(C=o[R]).rowIndex-I,T=C.colIndex-_,L=d+D,k=c+T;if(!(L<0||L>=x||k<0||k>=S)){var F=k,A=i.tdIdList[F],E=i._dataList.getColumnIndex(A),M=C.data,O=i.getCellInfo(F);M=i._validateAndFormat(M,O,i,A,E,F),i._dataList.setCellData(L,E,M)}}}else if(e.options.dataDragDrop){if(a&&n){var N=-1;if(e.id==i.id)for(v=0;v<n.length;v++)n[v]<d&&N++;N=Math.max(0,N);var H=i.dataList.getRealRowIndex(d),G={};if(e.options.dataDragDropStatus)for(var W=0;W<n.length;W++)G[W]=e.dataList.getRowStatus(n[W]);e.dataList.removeRows(n),void 0===H&&(H=d,N=0);var B=H-N;e.id==i.id&&(B=Math.min(B,e.getRowCount())),i._dataList.insertData(B,a);var V=0;if(e.options.dataDragDropStatus){for(var q in G){var Y=B+V,Z=e._dataList.options.depthColumn?Y:e._dataList.getRealRowIndex(Y);e._dataList._setRowStatus(Z,G[q]),V++}e.setFocusedMultiCell(B,0,B+V-1,0)}e.id===i.id?e._moveCellVisible(n,B,{remove:!0,insert:!0}):(e._moveCellVisible(n,B,{remove:!0}),i._moveCellVisible(n,B,{insert:!0}))}else{var j=e.dataList.getRowStatus(l);if(e.dataList.removeRow(l),!0===r.I.isXML(h)?i.dataList.setRowXML(d,h):i.dataList.setRowData(d,u),e.options.dataDragDropStatus){Z=e._dataList.options.depthColumn?d:e._dataList.getRealRowIndex(d);e._dataList._setRowStatus(Z,j),e.setFocusedCell(Z,0)}e.id===i.id?e._moveCellVisible([l],d,{remove:!0,insert:!0}):(e._moveCellVisible(n,B,{remove:!0}),i._moveCellVisible(n,B,{insert:!0}))}e._setEmbeddedInputValue(i,l,p)}!1!==w&&i._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0}]})}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype._setEmbeddedInputValue=function(t,e,i,o){try{var r=t.cellInfoHash[t.tdIdList[i]];if(r.options.embeddedInput){var a=t.data_td_list[i+e*t.oneRowDataLength],n=t.dataList.getCellData(e,i);t.getInput(r,a,n).render.value=o?null:n}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.dragSelectAutoScroll=function(t,e,i){try{this._dragSelectAutoScrollStartTime=new Date,a.Z.setInterval((function(t,e,i){this._dragSelectAutoScroll(t,e,i)}),{key:this.id+"_dragSelectAutoScroll",caller:this,delay:this.options.dataDragSelectAutoScrollPeriod,args:[t,e,i]})}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype._dragSelectAutoScroll=function(t,e,i){try{var o=0,r=this.getRowCount(),n=null==this.lastTopRowIndex?r-this.lastIndex:this.lastTopRowIndex,l=WebSquare.style.getAbsoluteTop(this.render),h=l+e,d=1;if(t>h?o=t-h:l>t&&(o=l-t,d=-1),0!==o){var u=new Date-this._dragSelectAutoScrollStartTime,p=Math.floor(u/this.options.dataDragSelectAutoScrollLevel),c=Math.pow(2,p),g=Math.ceil(o*this.options.dataDragSelectAutoScrollDPI/100)*c*d,f=Math.max(Math.min(this.rowIndex+g,n-1),0);this.rowIndex!==f&&(this.scrollEvent=!1,this.checkScrollEnd=!0,this.rowIndex=f,this.fastDrawData(0,{scroll:!0}),this._dragSelectAutoScrollFlag=!0,document.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(f))}for(var m=0,y=WebSquare.style.getAbsoluteLeft(this.render),b=y+this.render.offsetWidth,v=0;v<this.defaultColCnt;v++)y+=this.colWidthList[v];d=1
;if(i>b?m=i-b:y>i&&(m=y-i,d=-1),0!==m){var w=a.Z.getDataPrefix("tdIndex"),C=this.focusedCell[0],I=this.getLastFocusedCell().focusedTd,_=parseInt(I.getAttribute(w)),x=parseInt(_/this.realRowDataLength),S=C.focusedRowIndex,R=C.focusedColIndex,D=x+this.rowIndex,T=_%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);T=d<0?Math.max(0,T-1):Math.min(this.oneRowDataLength-1,T+1),this._applyFocusedMultiCell(S,R,D,T),d<0?this.fixScrollLeftDirection():this.fixScrollRightDirection()}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.dragSelectAutoScrollFinish=function(){try{if(a.Z.clearInterval(this.id+"_dragSelectAutoScroll"),!0!==this._dragSelectAutoScrollFlag)return;this._dragSelectAutoScrollFlag=!1,this._dragSelectAutoScrollStartTime=0;var t=a.Z.getDataPrefix("tdIndex");r.I.setTimer((function(){var e=this.focusedCell[0],i=this.getLastFocusedCell().focusedTd,o=parseInt(i.getAttribute(t)),s=parseInt(o/this.realRowDataLength),r=e.focusedRowIndex,a=e.focusedColIndex,n=s+this.rowIndex,l=o%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),h=null==this.lastTopRowIndex?this.getRowCount()-this.lastIndex-1:this.lastTopRowIndex,d=r<=n?1:-1,u=Math.max(Math.min(this.rowIndex+d,h),0);this.drawData(u,0),this._applyFocusedMultiCell(r,a,n,l)}),{key:this.id+"__dragSelectAutoScroll_drawData",caller:this,delay:this.options.dataDragSelectAutoScrollDelay})}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.otherClickEvent=function(){try{this.isMobile?(this.event.addListener(document.documentElement,"ontouchstart",this.event.bindAsEventListener(this,this.handleClickEventDocument)),this.options.tooltipDisplay&&this.hideTooltip()):WebSquare.getBody().getLayerListener().addListener({component:this,event:{},otherClick:this.handleClickEventDocument,frameClick:this.handleClickEventFrame})}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleClickEventFrame=function(t){try{this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,!0]),this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),this.hideContextMenu(),this.groupbyFilterList&&this.hideGroupbyFilterList(),this.options.focusAutoRemove&&this.removeFocusedCell()}catch(t){s.Y.printStackTrace(t)}},y.prototype.handleClickEventDocument=function(t){this.lastEvent=t,this.isHammerEnabled()&&!t.srcElement.id==this.id+"_toGoButton"&&this.hideTooltip(),this.event.isMe(t,this.render)||this.isMine(t)?this.handleClickEventDocumentAfter(t):(this.editedCell?this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,{otherClick:!0}],{beforeFunc:function(t,e){t.handleClickEventDocumentAfter(e);var i=WebSquare.getBody();i.layerListener.handleMouseDownEventDocument.call(i,e),i=null},beforeFuncArgs:[this,t]}):this.handleClickEventDocumentAfter(t),this.options.tooltipDisplay&&this.isMobile&&(!t.srcElement.id==this.id+"_toGoButton"&&this.hideTooltip(),t.srcElement.id==this.id+"_tooltip"&&p.f.stopEvent(t)))},y.prototype.handleClickEventDocumentAfter=function(t){if(this.contextMenu){var e=p.f.getTarget(t);e&&e.className.match("contextMenu")||this.hideContextMenu()}if(this.groupbyFilterList||this.customFilterScrollView){var i=this.event.getTargetIterator(t,this.render),o=!0;if(this.customFilterScrollView&&this.customFilterScrollView.render&&"none"==this.customFilterScrollView.render.style.display)o=!1;else for(;i.next();)if(i.match("gridHeaderTDDefault")||i.match("w2grid_groupbyZone_scrollView")||i.match("w2grid_groupbyZone_column")||i.match("w2grid_customFilter_scrollView")||i.match("w2grid_customFilter_column")){o=!1;break}o&&this.hideCustomFilterList()}if(this.options.groupbyZone&&this.options.groupbyFilterBox)for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_filterBox_select_tbody")||i.match("w2grid_filterBox_itemTable")){o=!1;break}if(this.groupbyFilterList){for(i=this.event.getTargetIterator(t,this.render),
o=!0;i.next();)if(i.match("w2grid_groupbyZone_list")||i.match("w2grid_groupbyZone_column")||i.match("gridHeaderTDDefault")){o=!1;break}o&&this.hideGroupbyFilterList()}this.options.focusAutoRemove&&this.removeFocusedCell()},y.prototype.isMine=function(t){try{for(var e=p.f.getTarget(t);null!=e;){if(e.id&&e.id.indexOf&&e.id.indexOf("G_"+this.id+"__")>=0)return!0;e=e.parentNode}return!1}catch(t){s.Y.printStackTrace(t)}},y.prototype.handleResize=function(t){try{var e=t||{},i=this.render.offsetWidth,o=this.render.offsetHeight;if(i>0&&o>0)if(this.delayedDrawObj)this.resizeObj={width:i,height:o,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.setRedrawStatus("draw");else{var n=i-this.resizeObj.width,l=o-this.resizeObj.height,h=!1,d=this.hiddenCellObj.length>0;if(!0===this._isHybridScroll()&&0!==l)this.setScrollYHeightHybrid();else if(l>0){if(this.options.adaptive){var u=parseInt(this.options.adaptiveThreshold)||480;if(!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)&&a.Z._getBrowserWidth()<=u)return}this._setGridHeightBefore(),h=!0;var p=this.getDataLength(),c=this.drawedRowLength;this.lastTopRowIndex=null,this.setDataTable(),this.setScrollYHeight();var g=this._getVisibleLastIndex(this.lastIndex+1);if(p<=0);else if(this.rowIndex+g-1+this.drawedRowLength-c<p){var f=p-this.drawedRowLength+1,m=this.rowIndex;this.rowIndex+1>f&&f>=-1&&(m=f>=0?f:0),d?(this.rowIndex=m,this._setCellVisibleRefresh()):this.drawData(m,0,null,null,{noApplyRealFocus:!0})}else{var y,b;if((m=p-this.drawedRowLength>0?p-this.drawedRowLength:0)==this.rowIndex)y=g-1;else this.scrollEvent=!1,this.checkScrollEnd=!0,this.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(m);if(d)this.rowIndex=m,this._setCellVisibleRefresh();else e.startPoint&&(b=parseInt(e.startPoint),isNaN(b)||(y=b)),this.drawData(m,y,null,null,{noApplyRealFocus:!0})}this._setGridHeightAfter()}else if(l<0&&"all"!=this.options.visibleRowNum){this._setGridHeightBefore(),this._setGridHeightAfter(),h=!0;var v=this.getElementById(this.id+"_body_table");this.dataLayerHeight=v.parentNode.offsetHeight;var w=Number(this.options.visibleRowNum),C=this.getVisibleRowNum();d?this._setCellVisibleRefresh():(!isNaN(w)&&w>0&&w>=C||(this.lastTopRowIndex=null,this.cutGridBottom(this.lastIndex)),this.setScrollYHeight())}0!=n&&(h=!0,this.resizeObj.clientWidth=this.render.clientWidth,this.setScrollYHeight(),this.options.autoFit||this.setOverflowX(),this._handleScrollX(),this.options.autoFit&&this.autoFitFunc(),d&&this._setCellVisibleRefresh(),this.displayFixedColumnLine()),h&&this.groupbyZoneStatus.groupbyZoneRender&&this.resizeGroupbyZone()}else this.setRedrawStatus("stop");this.groupbyZoneStatus.groupbyZoneRender&&!this.adjustGroupbyZone&&(this.adjustGroupbyZone=!0,this.resizeGroupbyZone()),this.resizeObj={width:i,height:o,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.resizeObj.width>0&&this.resizeObj.height>0&&(this.resizeObj.scrollLeft=this.getElementById(this.id+"_scrollX_right").scrollLeft,this.resizeObj.scrollTop=this.getElementById(this.id+"_scrollY_div").scrollTop)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.resizeGroupbyZone=function(){if(this.groupbyZoneStatus.groupbyZoneRender){var t=this.resizeObj.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder,e=this.dom[this.id+"_scrollY_div"].offsetWidth;0!=e&&(t-=e),t+="px",this.groupbyZoneStatus.groupbyZoneRender.style.width!=t&&(this.groupbyZoneStatus.groupbyZoneRender.style.width=t)}},y.prototype.checkResize=function(){try{if(this.render){var t=!0;if(WebSquare.getBody().modalStack&&WebSquare.getBody().modalStack.length>0&&this.getDisabled()){for(var e=this.parentControl;e&&(!e.options||"floatingLayer"!=e.options.pluginName&&("wframe"!==e.options.pluginName&&"pageFrame"!==e.options.pluginName||!e._isWframePopup));)e=e.parentControl;null==e&&(t=!1)}
t&&!this.startedDisplayNone&&this.handleResize()}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleDblClickEvent=function(t){try{for(var e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match(this.options.bodyTdClass)||WebSquare.idToUUID[e.getElement().getAttribute("id")]){this.bodyDblClick(t,e.getElement());break}if(e.match(this.options.headerTdClass)){this.headerDdlClick(t,e.getElement());break}if(this.hasFooter&&e.match(this.options.footerTdClass)){this.footerDblClick(t,e.getElement());break}if(this.hasSubtotal){if(this.subtotalClassList){for(var i=!1,o=0;o<this.subtotalClassList.length;o++)if(this.subtotalClassList[o].length>0&&e.match(this.subtotalClassList[o])){this.subtotalDblClick(t,e.getElement()),i=!0;break}if(i)break}else if(e.match(this.options.subtotalTdClass)){this.subtotalDblClick(t,e.getElement());break}}else e.match("w2grid_customFilter_sortable_open")&&(p.f.stopEvent(t),e.stop())}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleClickEvent=function(t){try{if(this.lastEvent=t,p.f.fireEvent(this,"onclick",t),this.isMobile&&this.iScroll&&this.iScroll.moveDirection&&this.iScroll.moveDistance>10)return;var e,i,o,r,a,n,l,h=this.event.getTargetIterator(t,this.render),d=null!=this.editedCell,u=this.lastEvent;d&&(e=this.editedCell.editRowIndex,i=this._dataList.getColumnIndex(this.editedCell.id),l=this.getCellInfo(this.editedCell.id),o=this.getColumnIndex(this.editedCell.id),r=this._grid.getRealRowIndex(e),a=this._dataList.dataArr[r*this._dataList.getColumnCount()+i],n=l.comp&&l.comp.selectedIndex);for(var c=function(t,e){var i=!1;if(e.subtotalClassList)for(var o=0;o<e.subtotalClassList.length;o++)if(e.subtotalClassList[o].length>0&&t.match(e.subtotalClassList[o])){i=!0;break}return i},g=!1;h.next();){if(h.match(this.options.bodyTdClass)){g=!0,this.bodyClick(t,h.getElement(),{from_handleClickEvent:!0});break}if(h.match(this.options.headerTdClass)){g=!0,this.headerClick(t,h.getElement(),{from_handleClickEvent:!0}),d&&null==this.editedCell&&(e=this.getDisplayRowIndex(r));break}if(this.hasFooter&&h.match(this.options.footerTdClass)){g=!0,this.footerClick(t,h.getElement(),{from_handleClickEvent:!0});break}if(this.hasSubtotal&&(h.match(this.options.subtotalTdClass)||c(h,this))){g=!0,this.subtotalClick(t,h.getElement(),{from_handleClickEvent:!0});break}if(this.isMine(t));else{if(h.match(this.options.headerTableClass))break;if(h.getElement().getAttribute("id")==this.id+"_dataLayer"){g=!0,null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,{from_handleClickEvent:!0}),p.f.fireEvent(this,"onblankclick",t);break}}}if(d){var f=this._dataList.dataArr[r*this._dataList.getColumnCount()+i];if(0===a&&(a="0"),0===f&&(f="0"),a!=f){var m={oldValue:a,newValue:f,rowIndex:e,colIndex:o,colId:this.getColumnID(o)};isNaN(n)||(m.oldSelectedIndex=n,m.newSelectedIndex=l&&l.comp&&l.comp.selectedIndex),p.f.fireEvent(this,"onviewchange",m)}var y=this._getGroupbyDisplayRowIndex(e);this.options.viewChangeAfterEdit&&g&&p.f.fireEvent(this,"onafteredit",y,o,f,u)}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.gridDataLayerOut=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},y.prototype.gridHeaderOver=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},y.prototype.gridOver=function(t){for(var e=a.Z.getDataPrefix("colIndex"),i=a.Z.getDataPrefix("col_id"),o=p.f.getTarget(t);o&&("TD"!=o.tagName||null==o.getAttribute(e)||!(this.hasClass(o,this.options.bodyTdClass)||this.hasClass(o,this.options.subtotalTdClass)||this.hasClass(o,this.options.footerTdClass)));){if("TD"==o.tagName&&null!=o.getAttribute(e)&&this.subtotalClassList){for(var s=!1,r=0;r<this.subtotalClassList.length;r++)if(this.subtotalClassList[r].length>0&&this.hasClass(o,this.subtotalClassList[r])){s=!0;break}if(s)break}
if(this.options.tooltipHeader&&"TH"==o.tagName&&null!=o.getAttribute(e))break;if("DIV"==o.tagName&&o.getAttribute("id")==this.id+"_dataLayer")break;if("TABLE"==o.tagName&&o.getAttribute("id")==this.id+"_foot_table")break;if("TH"==o.tagName&&this.hasClass(o,this.options.headerTdClass))break;o=o.parentNode}if(o.id==this.id+"_dataLayer")this.overElem&&(this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null);else if(o.id==this.id+"_foot_table")this.overElem&&(this.bodyOut(t,this.overElem),this.overElem=null);else if(o&&"TD"==o.tagName){if(this.overElem!=o&&-1==o.className.indexOf(this.options.headerTdClass)){this.bodyOut(t,this.overElem),(this.options.tooltipDisplay||this.options.rowStatusTooltipDisplay)&&this.bodyOver(t,o),this.options.rowMouseOver&&(this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.hasClass(o,"w2grid_groupby")||this.addRowOverStyle(o.parentNode)),this.overElem=o;var n={};o.getAttribute(i)&&(n.rowIndex=this._getGroupbyDisplayRowIndex(this.getElemRowIndex(o)),n.colIndex=this.getColumnIndex(o.getAttribute(i))),p.f.fireEvent(this,"onbodymouseover",n)}}else if(o&&"TH"==o.tagName&&this.overElem!=o){this.bodyOut(t,this.overElem),(this.options.tooltipHeader||this.options.headerTooltipDisplay)&&this.headerOver(t,o),this.options.rowMouseOver&&this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.overElem=o;n={};var l=a.Z.getDataPrefix("header_id"),h=this.overElem.getAttribute(i),d=this.overElem.getAttribute(l);if(d&&d===this._headerOverElemId)return;this.getHeaderInfo(h)&&(n.header_id=d,n.id=this.overElem.id,this._headerOverElemId=d),p.f.fireEvent(this,"onheadermouseover",n)}},y.prototype.gridOver1=function(t){var e=p.f.getTarget(t);("NOBR"==e.tagName||"SPAN"==e.tagName&&e.className.indexOf("w2grid_span")>-1)&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem&&this.removeRowOverStyle(this.overElem.parentNode),this.addRowOverStyle(e.parentNode)),this.overElem=e)},y.prototype.gridOver2=function(t){var e=p.f.getTarget(t);("NOBR"==e.tagName||"SPAN"==e.tagName&&e.className.indexOf("w2grid_span")>-1)&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem,this.addRowOverStyle(e.parentNode)),this.overElem=e)},y.prototype.handlePasteEvent=function(t){try{var e=this.options.preventPasteColumn,i=e?e.split(","):[];if(this.options.preventPaste&&!this.editedCell||p.f.getTarget(t)&&p.f.getTarget(t).getAttribute("class")&&p.f.getTarget(t).getAttribute("class").indexOf("w2grid_head_input")>-1)return;if(!1===p.f.fireEvent(this,"oncustompaste",t))return;var o,n,l,h,d=a.Z.isIEAllVersion()?window.clipboardData:t.clipboardData;if("native"!==this.options.copyType&&!0===this.options.noUseCSVParser&&(o=d.getData("gridView")),o||(o=d.getData("Text")),1==this.options.ctrlShiftKey&&(n=d.getData("Nofocus")),"\r\n"==o.slice(-2)?o=o.slice(0,o.length-2):"\n"==o.slice(-1)&&(o=o.slice(0,o.length-1)),this.options.customPasteFormatter)if("string"==typeof this.options.customPasteFormatter){var u=a.Z.getGlobalFunction(this.options.customPasteFormatter.wq_trim(),this.scope_id);if("function"==typeof u){var c=u.call(this,o);o=c||o}}else $l("The type of customPasteFormatter must be string.");if("native"===this.options.copyType?l=[[o]]:(1==this.options.ctrlShiftKey&&(h=Papa.parse(n,{delimiter:"\t"}).data),l=Papa.parse(o,{delimiter:"\t"}).data),a.Z.isIEAllVersion("6 7")&&'"'===o.slice(0,1)&&'"'===o.slice(-1)&&-1==o.slice(1,-1).indexOf("\t")&&(l=[[o.slice(1,o.length-1)]]),!l||null==l||"undefined"==l||0==l.length)return;if(this.focusedCell.length>0){for(var g,f=this.getColumnOrder(),m=this.htmlInfo.body.rowAttrArr.length,y=this.getDataLength()*m,b=0,v=f.length,w=0,C=null,I=0,_=0;_<this.focusedCell.length;_++){var x=this.focusedCell[_],S=x.focusedRowIndex,R=x.focusedColIndex,D=this.getLocationRowCol(S,R);S=D.rowIndex,R=D.colIndex,
I+=D.rowSize*D.colSize-1,y>S&&(y=S),b<S+D.rowSize-1&&(b=S+D.rowSize-1),v>R&&(v=R),w<R+D.colSize-1&&(w=R+D.colSize-1),y==S&&v==R&&(C=x)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(v=0,w=f.length-1);var T=0;for(_=this.defaultColCnt+v;_<this.defaultColCnt+w;_++)1==this.hiddenList[_]&&(T+=1);if(this.focusedCell.length>1&&this.focusedCell.length+I!=(b-y+1)*(w-v-T+1))return;var L=!1;if(I>0&&(L=!0),g={focusedRange:{minRow:y,maxRow:b,minCol:v,maxCol:w},startCell:C},C.focusedRowIndex>=0&&C.focusedColIndex>=0){var k=C.focusedTd;if(k){var F=a.Z.getDataPrefix("col_id"),A=a.Z.getDataPrefix("colMerged"),E=k.getAttribute(F);if(null==E||""==E.wq_trim())return;if("1"==k.getAttribute(A))return}else{var M=this.getCellInfo(C.focusedColIndex);if(M&&(M.options.colMerge||M.options.colMergeAnd))return}var O=y,N=v,H=this.getOriginalRowCol(y,v),G=(R=H.colIndex,S=H.rowIndex,this.getTotalRow()),W=(this.getTotalCol(),G*m),B=f.length;if(this.options.checkBlankRowOnPaste)for(_=l.length-1;_>-1;_--){for(var V=!0,q=0;q<l[0].length;q++)if(""!=l[_][q].wq_trim()){V=!1;break}V&&l.splice(_,1)}if(!1===p.f.fireEvent(this,"onbeforepaste",{rowIndex:this._getGroupbyDisplayRowIndex(S),colIndex:R,data:l.slice(0)}))return;this.isPaste=!0;var Y,Z=this,j=function(t){for(var e=Z.defaultColCnt+t;e<Z.hiddenList.length;e++)if(0==Z.hiddenList[e])return e-Z.defaultColCnt},P=this.uuid,z=!1,U=function(t){var e=WebSquare.idCache[P],o=e.options.checkReadOnlyOnPasteEnable,s=o?o.split(","):[];if(O+l.length>W&&!a.Z.getBoolean(Z.options.preventAddRowOnPaste)&&"focus"!==Z.options.pasteOption){var r=Math.ceil((O+l.length-W)/m),n=Array(Z._dataList.getTotalCol()*r);if(""!=Z.depthColumn)for(var d=Z._dataList.getCellInfo(Z.depthColumn).options.defaultValue,u=0;u<r;u++)n[u*Z._dataList.getTotalCol()+Z._dataList.getColumnIndex(Z.depthColumn)]=d;if(Z.options.setDefaultValueOnPaste){var c=Z._dataList.getTotalCol();for(u=0;u<c;u++)for(var g=Z._dataList.getCellInfo(u).options.defaultValue,f=0;f<r;f++)n[f*c+Z._dataList.getColumnIndex(u)]=g}if(Z.options.checkReadOnlyOnPaste){var C=!0,I=!1;for(u=0;u<l.length;u++){var _=N,x=O+u;for(f=0;f<l[0].length&&!(null==_||_>=B);f++){var S=(k=Z.getOriginalRowCol(x,_)).colIndex,R=k.rowIndex;I=!1;for(var D=0;D<s.length;D++)if(s[D]==e.getColumnID(S)){I=!0;break}if(!Z.___getEditReadOnly(R,S)||Z.___getEditReadOnly(R,S)&&I){C=!1;break}_=j(_+1)}}if(C)return}if(Z.options.checkDisabledOnPaste){var T=!0;for(u=0;u<l.length;u++)for(_=N,x=O+u,f=0;f<l[0].length&&!(null==_||_>=B);f++){var k;S=(k=Z.getOriginalRowCol(x,_)).colIndex,R=k.rowIndex;if(!Z._getEditDisabled(R,S)){T=!1;break}_=j(_+1)}if(T)return}if(n.length>0){z=!0,Z._dataList.setData(n,!0);var F=[];F[r-1]=void 0;u=0;for(var A=r;u<A;u++)F[u]="C";Y=F.length,Z._dataList.rowStatusArr=Z._dataList.rowStatusArr.slice(0,G).concat(F)}}var E=function(o,r,n){for(var d=function(t,e,i,o){var s=Z.data_td_list[e+(t-Z.rowIndex)*Z.oneRowDataLength];if(t<Z.rowIndex&&(s=null),!(Z.groupbyStatus.grouped&&s&&Z.hasClass(s,"w2grid_groupby"))){var r=Z.getCellInfo(e),a=Z._getRealColIndex("body",r.options.col_id)+Z.defaultColCnt;if(!r.options.blockSelect&&!Z.hiddenList[a]){if(1==Z.options.ctrlShiftKey)if("true"!=(h[o].length>1?h[o][e]:h[o]))return;var n={focusedTd:s,focusedRowIndex:t,focusedColIndex:e};Z.options.groupbyDisplayRowIndex&&(n.groupbyDisplayRowIndex=Z._getGroupbyDisplayRowIndex(t)),i?Z.focusedCell.push(n):Z.focusedCell.unshift(n),null!=s&&Z.applyFocusedCellIn(s,i)}}},u=o,c=0;c<l.length;c++){for(var g=r,f=0;f<l[c].length&&!(null==g||g>=B);f++){var y=Z.getOriginalRowCol(u,g),b=y.colIndex,v=y.rowIndex;if(y.noLeftTop)y.leftCell&&(g=j(g+y.colSize));else{1==Z.options.ctrlShiftKey?d(v,b,n,c):d(v,b,n);for(var w=!1,C=0;C<s.length;C++)if(s[C]==e.getColumnID(b)){w=!0;break}if(Z.options.checkReadOnlyOnPaste&&Z.___getEditReadOnly(v,b)&&!w)g=j(g+y.colSize);else if(Z.options.checkDisabledOnPaste&&Z._getEditDisabled(v,b))g=j(g+y.colSize);else{var I=!1;for(C=0;C<i.length;C++)if(i[C]==e.getColumnID(b)){g=j(g+y.colSize),I=!0;break}
if(!I&&!(a.Z.getBoolean(Z.options.preventAddRowOnPaste)&&Z.dataList.getRowCount()*m-1<v||"focus"===Z.options.pasteOption&&(g>t.focusedRange.maxCol||g<t.focusedRange.minCol||u>t.focusedRange.maxRow||u<t.focusedRange.minRow))){var _,x=b,S=Z.tdIdList[x],R=Z._dataList.getColumnIndex(S),D=Z._dataList.dataArr[Z.getRealRowIndex(v)*Z._dataList.getColumnCount()+R],T=l[c][f];1==Z.options.ctrlShiftKey&&(_=h[c][f]);var L=Z.getCellInfo(x),k=!(!Z.isDrillDown||!Z._dataList.options.depthColumn)?Z.getRealRowIndex(v):v;if("number"!=L.options.dataType&&"float"!=L.options.dataType||"."!==(T=T.wq_trim())&&"-"!==T&&"+"!==T){if((L.options.selectedDataOnPaste||Z.options.selectByLabel)&&("autoComplete"===L.options.inputType||"select"===L.options.inputType)){var F,A=L.getItemArray(),E=L.dataComp;if(L.existGridViewItemsetNode||"gridViewItemset"===L.options.itemTableType){var M=L.itemsetObj.nodeset;M.indexOf("data:")>=0&&(E=M.slice(5))}if(E&&(F=L.mainGrid.modelControl.getDataComp(E)),F&&(!A||0==A.length||1==A.length&&(!0===L.options.chooseOption||!0===L.option.allOption)||2==A.length&&!0===L.options.chooseOption&&!0===L.option.allOption)){var O=F.bodyIdColIndexMap[L.itemsetObj.label],N=F.bodyIdColIndexMap[L.itemsetObj.value],H=F.cellIdList.length,G=F.filteredRowIndexArr.length;if(A=[],F&&"linkedDataList"===F.initializeType&&null!=F.conditionInfo&&F.conditionInfo.filterInfo.useRef)for(var W=0;W<F._dataList.getDataLength();W++){(V={}).label=F._dataList.dataArr[W*H+O],V.value=F._dataList.dataArr[W*H+N],A[W]=V}else for(C=0;C<G;C++){var V={};"linkedDataList"!=F.initializeType&&F.dataArr?(V.label=F.dataArr[F.filteredRowIndexArr[C]*H+O],V.value=F.dataArr[F.filteredRowIndexArr[C]*H+N]):(V.label=F._dataList.dataArr[F.filteredRowIndexArr[C]*H+O],V.value=F._dataList.dataArr[F.filteredRowIndexArr[C]*H+N]),A[C]=V}}var q=!1;if(L.options.selectedDataOnPaste)if(0===A.length)q=!0;else for(var P=0;P<A.length;P++){var U=A[P];switch(L.options.selectedDataOnPaste){case"true":case"both":U.value!==T&&U.label!==T||(q=!0);break;case"value":U.value===T&&(q=!0);break;case"label":U.label===T&&(q=!0);break;default:q=!0}if(q)break}if(!q&&L.options.selectedDataOnPaste){l.length<=Y+c&&0===f&&z&&Z._drawRowStatus(k-Z.rowIndex,k),g=j(g+y.colSize);continue}if(Z.options.selectByLabel)for(P=0;P<A.length;P++){if((U=A[P]).label===T){T=U.value;break}}}var X=L.comp&&L.comp.selectedIndex;if("true"===Z.options.unformatOnPaste||"true"===L.options.unformatOnPaste){if("calendar"==L.options.inputType&&"date"==L.options.dataType){var K=0;"yearMonthDate"==L.options.calendarValueType?K=8:"yearMonth"==L.options.calendarValueType?K=6:"yearMonthDateHour"==L.options.calendarValueType?K=10:"yearMonthDateTime"==L.options.calendarValueType?K=12:"yearMonthDateTimeSec"==L.options.calendarValueType?K=14:"year"==L.options.calendarValueType&&(K=4);var $=new WebSquare.validator.validateInvoker;$.addCommand(new WebSquare.validator.allowCharCommand("0-9")),$.addCommand(new WebSquare.validator.maxLengthCommand(K)),T=$.validateString(T)}var J=T,Q=L.formatter.masking,tt=L.formatter.type;T=J=void 0===tt||null==tt||"number"!=tt&&"float"!=tt?void 0!==tt&&null!=tt&&"date"==tt?WebSquare.text.unformatDate2(Q,J):void 0!==tt&&null!=tt&&"time"==tt?WebSquare.text.unformatTime(Q,J):WebSquare.text.unformatText(Q,J):WebSquare.text.unformatCurrency(Q,J)}if(T=Z._validateAndFormat(T,L,Z,S,R,x),1==Z.options.ctrlShiftKey?"true"==_&&Z._dataList.setCellData(k,R,T):Z._dataList.setCellData(k,R,T),!T&&z&&l.length<=Y+c&&Z._drawRowStatus(k-Z.rowIndex,k),D!=T){if(1==Z.options.ctrlShiftKey)var et={oldValue:D,newValue:"true"==_?T:D,rowIndex:v,colIndex:x,colId:Z.getColumnID(x)};else et={oldValue:D,newValue:T,rowIndex:v,colIndex:x,colId:Z.getColumnID(x)};isNaN(X)||(et.oldSelectedIndex=X,et.newSelectedIndex=L.comp&&L.comp.selectedIndex),p.f.fireEvent(Z,"onviewchange",et)}g=j(g+y.colSize)}}}}}u+=1}},M=y,H=v;if(l.length>0&&!L)for(u=1;u<l.length;u++)if(l[u].length!==l[0].length){L=!0;break}if(Z.applyFocusedCellOut(),Z.focusedCell=[],
L)E(y,v,!1);else if(b-y+1>=l.length&&w-v+1>=l[0].length)for(;M<=b-l.length+1;){for(H=v;H<=w-l[0].length+1;){var V=!0;M+l.length>b-l.length+1&&H+l[0].length>w-l[0].length+1&&(V=!1),E(M,H,V),H+=l[0].length}M+=l.length}else if(b-y+1>=l.length)for(;M<=b-l.length+1;){V=!0;M+l.length>b-l.length+1&&(V=!1),E(M,H,V),M+=l.length}else if(w-v+1>=l[0].length)for(;H<=w-l[0].length+1;){V=!0;H+l[0].length>w-l[0].length+1&&(V=!1),E(M,H,V),H+=l[0].length}else E(y,v,!1)};if("true"===this.options.showMessageOnPaste){var X=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/pasteMessage/@value");WebSquare.layer.pasteMessageLoaded=!1,WebSquare.layer.showProcessMessage(X,{type:"pasteMsg",scope:this.scope_id||""});!function t(){WebSquare.layer.pasteMessageLoaded?(a.Z.clearTimeout(Z.id+"_pasteMessageLoaded"),U(),WebSquare.layer.hideProcessMessage({type:"pasteMsg",scope:this.scope_id||""}),p.f.fireEvent(Z,"onafterpaste")):a.Z.setTimeout(t,{delay:500,key:Z.id+"_pasteMessageLoaded"})}()}else U(g),p.f.fireEvent(this,"onafterpaste")}}this.isPaste=!1,p.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype._validateAndFormat=function(t,e,i,o,r,n){try{if(e.options.maxLength)if("float"==e.options.dataType)t=new WebSquare.validator.maxFloatLengthCommand(e.options.maxLength,e.options.decimalDelimiter,e.options.delimiter).executeValidateString(t);else if("number"==e.options.dataType||"bigDecimal"==e.options.dataType){t=new WebSquare.validator.maxLengthCommand(e.options.maxLength).executeValidateString(t)}else{var l=parseInt(e.options.maxLength);isNaN(l)||(t=t.slice(0,l))}else if(e.options.maxByteLength){if("number"==e.options.dataType||"bigDecimal"==e.options.dataType)t=new WebSquare.validator.maxByteLengthCommand(e.options.maxByteLength,e.options.byteCheckIgnoreChar).executeValidateString(t)}var h=e.options.allowChar;if(e.options.allowChar||"float"!=e.options.dataType&&"number"!=e.options.dataType&&"bigDecimal"!=e.options.dataType||(h="0-9+-"+e.options.decimalDelimiter),h&&void 0!==h&&null!=h&&""!=h){for(var d=new RegExp("["+h+"]"),u=!0,p=0;p<t.length;p++){if(null==t.charAt(p).match(d)){u=!1;break}}!1===u&&(t="")}if(e.options.ignoreChar)t=new WebSquare.validator.ignoreCharCommand(e.options.ignoreChar).executeValidateString(t);if((""!==e.options.escape?e.options.escape:i.options.escape)+""=="true"&&(t=WebSquare.xml.decode(t)),"radio"===e.options.inputType&&e.options.trueValue===t)for(var c=i.getCheckedIndex(n),g=0;g<c.length;g++)i._dataList.setCellData(c[g],r,e.options.falseValue);if("text"===e.options.inputType||"textImage"===e.options.inputType){var f=a.Z.getGlobalFunction(e.options.customModelFormatter,i.scope_id);"function"==typeof f?(i.useCustomModelFormatter=!0,t=f.call(i,t,t,e.editRowIndex,e.getColumnIndex(o))):i.useCustomModelFormatter=!1}return"text"===e.options.inputType&&"float"===e.options.dataType&&t.charAt(t.length-1)===e.options.decimalDelimiter&&(t=t.substr(0,t.length-1)),t}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype._doPaste=function(){try{if(a.Z.isIEAllVersion())this.handlePasteEvent({});else if(!a.Z.isIEAllVersion()&&(r.I.browserCheck.moz||r.I.browserCheck.chrome||r.I.browserCheck.safari)){var t=document.createElement("textarea"),e=this;t.style.opacity="0",t.onpaste=function(t){e.handlePasteEvent(t),i.removeChild(this)},t.textContent="temp";var i=document.getElementsByTagName("body")[0];i.appendChild(t),t.select();try{document.execCommand("paste")}catch(t){c.v.printLog(this.id+"_doPaste skip.")}}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleBeforeCopyEvent=function(t){p.f.preventDefault(t)},y.prototype.handleBeforeCutEvent=function(t){p.f.preventDefault(t)},y.prototype.handleCopyEvent=function(t,e){try{if(!1===p.f.fireEvent(this,"oncustomcopy",t))return;var i=this.options.preventCopyColumn,o=i?i.split(","):[];if(this.options.preventCopy||"native"===this.options.copyType)return;if(r.I.browserCheck.safari){for(var n=document.activeElement,l=!1;null!=n;)n.id&&n.id==this.id&&(l=!0),
n=n.parentNode;if(!l)return}var h=a.Z.isIEAllVersion()?window.clipboardData:t.clipboardData,d=this.options.copyAmount;if(d||(d="cell"),"cell"==d&&this.focusedCell.length>0){for(var u=[],c=[],g=this.getColumnOrder(),f=this.htmlInfo.body.rowAttrArr.length,m=this.getDataLength()*f,y=0,b=g.length,v=0,w=0,C=0;C<this.focusedCell.length;C++){var I=this.focusedCell[C],_=I.focusedRowIndex,x=I.focusedColIndex,S=this.getLocationRowCol(_,x);_=S.rowIndex,x=S.colIndex,w+=S.colSize*S.rowSize-1,m>_&&(m=_),y<_+S.rowSize-1&&(y=_+S.rowSize-1),b>x&&(b=x),v<x+S.colSize-1&&(v=x+S.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(b=0,v=g.length-1);var R=0;for(C=this.defaultColCnt+b;C<v+this.defaultColCnt;C++)1==this.hiddenList[C]&&(R+=1);if(this.focusedCell.length+w==(y-m+1)*(v-b-R+1)||1==this.options.ctrlShiftKey||"row"==this.options.focusMode&&1==this.options.rowCopy&&this.focusedCell.length==y-m+1)if(this.isDrillDown){var D=this._dataList.getRealRowIndex(y),T=this.drilldown.getChildrenRowArr(D),L=this._dataList.getRealRowIndex(m),k=D;this.drilldown.isOpen(y)||function t(e){var i=e[e.length-1];k=k<i?i:k;for(var o=0;o<e.length;o++){var s=this.drilldown.getChildrenRowArr(e[o]);s.length>0&&t.call(this,s)}}.call(this,T);for(C=L;C<=k;C++){for(var F=[],A=[],E=b;E<=v;E++){var M=(Z=this.getOriginalRowCol(C,E)).colIndex,O=Z.rowIndex;if((!Z.noLeftTop||Z.leftCell)&&1!=this.hiddenList[E+this.defaultColCnt]){for(var N=this.getCellInfo(M),H=!1,G=0;G<o.length;G++)if(o[G]==N.colID){H=!0;break}if(!H){var W=""!==N.options.escape?N.options.escape:this.options.escape,B=this.drilldown.statusArr;if("display"==N.options.copyOption)U=!1===B[C]?this._getDisplayData(O,this.getColumnID(M)):this._getDisplayData(this.getRealRowIndex(O),this.getColumnID(M));else{var V=this.getColumnID(M);U=this.dataList.getColData(V)[O]}Z.noLeftTop&&(U=""),X=W+""=="true"?WebSquare.xml._encode(U+""):U,(U||this.focusedCell.length>1)&&(F.push(X),A.push(U))}}}u.push(F),c.push(A)}}else{var q=[];for(C=m;C<=y;C++){F=[],A=[];var Y=[];for(E=b;E<=v;E++){var Z;M=(Z=this.getOriginalRowCol(C,E)).colIndex,O=Z.rowIndex;if((!Z.noLeftTop||Z.leftCell)&&1!=this.hiddenList[E+this.defaultColCnt]){for(N=this.getCellInfo(M),H=!1,G=0;G<o.length;G++)if(o[G]==N.colID){H=!0;break}if(!H){W=""!==N.options.escape?N.options.escape:this.options.escape;var j=!1;if(1==this.options.ctrlShiftKey){var P=this.getAllFocusedIndex();for(G=0;G<P.length;G++)if(O===P[G].row&&M===P[G].col){j=!0;break}Y.push(j)}U="display"==N.options.copyOption?this._getDisplayData(this.getRealRowIndex(O),this.getColumnID(M)):this.dataList.getCellData(O,this.getColumnID(M)),Z.noLeftTop&&(U=""),X=W+""=="true"?WebSquare.xml._encode(U+""):U,(U||this.focusedCell.length>1)&&(1==this.options.ctrlShiftKey?!0===j&&(F.push(X),A.push(U)):(F.push(X),A.push(U)))}}}u.push(F),c.push(A),1==this.options.ctrlShiftKey&&q.push(Y)}}else{var z=this.focusedCell[this.focusedCell.length-1];if(null!=z){var U,X;for(W=""!==(N=this.getCellInfo(z.focusedColIndex)).options.escape?N.options.escape:this.options.escape,C=0;C<o.length;C++)if(o[C]==N.colID)return;U="display"==N.options.copyOption?this._getDisplayData(this.getRealRowIndex(z.focusedRowIndex),this.getColumnID(z.focusedColIndex)):this.dataList._getCellData(z.focusedRowIndex,this.getColumnID(z.focusedColIndex)),X=W+""=="true"?WebSquare.xml._encode(U+""):U,u.push([X]),c.push([U])}}var K=Papa.unparse(u,{delimiter:"\t"});if(1==this.options.ctrlShiftKey){var $=Papa.unparse(q,{delimiter:"\t"});h.setData("noFocus",$)}for(var J="",Q=0;Q<c.length;Q++)0!=Q&&(J+="\n"),J+=c[Q].join("\t");if(this.options.noUseCSVParser)if(t.shiftKey||e){K=Papa.unparse(c,{delimiter:"\t"});h.setData("Text",K)}else h.setData("Text",J),h.setData("gridView",K);else h.setData("Text",K)}p.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleCutEvent=function(t,e,i){try{if(!e)if(!1===p.f.fireEvent(this,"oncustomcut",t))return;var o=this.options.preventCopyColumn,n=o?o.split(","):[];if(this.options.preventCopy)return
;if(r.I.browserCheck.safari){for(var l=document.activeElement,h=!1;null!=l;)l.id&&l.id==this.id&&(h=!0),l=l.parentNode;if(!h)return}var d=a.Z.isIEAllVersion()?window.clipboardData:t.clipboardData,u=this.options.copyAmount;if(u||(u="cell"),"cell"==u&&this.focusedCell.length>0){for(var c=[],g=[],f=this.getColumnOrder(),m=this.htmlInfo.body.rowAttrArr.length,y=this.getDataLength()*m,b=0,v=f.length,w=0,C=0,I=0;I<this.focusedCell.length;I++){var _=this.focusedCell[I],x=_.focusedRowIndex,S=_.focusedColIndex,R=this.getLocationRowCol(x,S);x=R.rowIndex,S=R.colIndex,C+=R.rowSize*R.colSize-1,y>x&&(y=x),b<x+R.rowSize-1&&(b=x+R.rowSize-1),v>S&&(v=S),w<S+R.colSize-1&&(w=S+R.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(v=0,w=f.length-1);var D=0;for(I=this.defaultColCnt+v;I<w+this.defaultColCnt;I++)1==this.hiddenList[I]&&(D+=1);if(this.focusedCell.length+C==(b-y+1)*(w-v-D+1)||1==this.options.ctrlShiftKey||"row"==this.options.focusMode&&1==this.options.rowCopy&&this.focusedCell.length==b-y+1)for(I=y;I<=b;I++){for(var T=[],L=[],k=v;k<=w;k++){var F=this.getOriginalRowCol(I,k),A=F.colIndex,E=F.rowIndex,M=k+this.defaultColCnt;if(1!=this.hiddenList[M]&&!(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(E,A)||e&&this.___getEditReadOnly(E,A)||this.options.checkDisabledOnCut&&this._getEditDisabled(E,A)||e&&this._getEditDisabled(E,A))){for(var O=this.getCellInfo(A),N=!1,H=0;H<n.length;H++)if(n[H]==O.colID){N=!0;break}if(!N&&!F.noLeftTop){var G=""!==O.options.escape?O.options.escape:this.options.escape;if(Z="display"==O.options.copyOption?this._getDisplayData(this.getRealRowIndex(E),this.getColumnID(A)):this.dataList.getCellData(E,this.getColumnID(A)),j=G+""=="true"?WebSquare.xml._encode(Z+""):Z,this.dataList.setCellData(E,this.getColumnID(A),""),""!==Z){var W={oldValue:Z,newValue:"",rowIndex:E,colIndex:A,colId:this.getColumnID(A)};p.f.fireEvent(this,"onviewchange",W)}T.push(j),L.push(Z)}}}c.push(T),g.push(L)}else{var B=this.focusedCell[this.focusedCell.length-1],V=B.focusedRowIndex,q=this.getColumnID(B.focusedColIndex),Y=!1;if(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(V,q)&&(Y=!0),this.options.checkDisabledOnCut&&this._getEditDisabled(V,q)&&(Y=!0),null!=B&&!0!==Y){var Z,j;for(O=this.getCellInfo(q),I=0;I<n.length;I++)if(n[I]==O.colID)return;G=""!==O.options.escape?O.options.escape:this.options.escape;if(Z="display"==O.options.copyOption?this._getDisplayData(this.getRealRowIndex(V),q):this.dataList.getCellData(V,q),j=G+""=="true"?WebSquare.xml._encode(Z+""):Z,this.dataList.setCellData(V,q,""),""!==Z){W={oldValue:Z,newValue:"",rowIndex:V,colIndex:B.focusedColIndex,colId:this.getColumnID(B.focusedColIndex)};p.f.fireEvent(this,"onviewchange",W)}c.push([j]),g.push([Z])}}if(!e){for(var P=Papa.unparse(c,{delimiter:"\t"}),z="",U=0;U<g.length;U++)0!=U&&(z+="\n"),z+=g[U].join("\t");if(this.options.noUseCSVParser)if(t.shiftKey||i){P=Papa.unparse(g,{delimiter:"\t"});d.setData("Text",P)}else d.setData("Text",z),d.setData("gridView",P);else d.setData("Text",P)}}p.f.preventDefault(t)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.clickRightButtonCell=function(t){for(var e=a.Z.getDataPrefix("header_id"),i=a.Z.getDataPrefix("colIndex"),o=a.Z.getDataPrefix("tdIndex"),s=a.Z.getDataPrefix("rowIndex"),r=p.f.getTarget(t);r&&"TD"!=r.tagName&&"TH"!=r.tagName&&"DIV"!=r.tagName;)r=r.parentNode;var n=r&&this.hasClass(r,this.options.headerTdClass);if(r&&this.hasClass(r,this.options.bodyTdClass)&&(n=!1),n)"touch"===t.pointerType&&!1===this.options.contextMenu||p.f.preventDefault(t),p.f.fireEvent(this,"onheaderrightbuttonclick",r.getAttribute(e));else{for(var l=r;l;){if("TH"===l.tagName&&this.hasClass(l,this.options.headerTdClass)){n=!0;break}if("TD"===l.tagName&&this.hasClass(l,this.options.bodyTdClass)){n=!1;break}if("DIV"===l.tagName&&this.hasClass(l,"w2grid_dataLayer")&&0===this.getRowCount()){n=!1;break}l=l.parentNode}r=l}var h,d,u,c,g,f,m=null!=this.editedCell;if(!n&&m&&(h=this.editedCell.editRowIndex,
d=this._dataList.getColumnIndex(this.editedCell.id),I=this.getCellInfo(this.editedCell.id),u=this.getColumnIndex(this.editedCell.id),c=this._grid.getRealRowIndex(h),g=this._dataList.dataArr[c*this._dataList.getColumnCount()+d],f=I.comp&&I.comp.selectedIndex),n&&this.options.useHeaderContextMenu){var y=void 0,b=-1,v=parseInt(r.getAttribute(i),10)-this.defaultColCnt;(L={}).result=y,L.rowIndex=b,L.colIndex=v,L.event=t;var w=[];if(this.focusedCell)for(var C=0;C<this.focusedCell.length;C++)w.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[C].focusedRowIndex),colIndex:this.focusedCell[C].focusedColIndex});L.focusedCell=w,(T={isHeader:!0}).headerId=r.getAttribute(e),(k=p.f.fireEvent(this,"oncontextopen",b,v,w,T))?this.createContextMenu(L,k):this.contextMenu?this.showContextMenu(L):this.createContextMenu(L)}else if(r&&"TD"==r.tagName&&this.hasClass(r,this.options.bodyTdClass)){var I;if(!1===(y=!(!this.options.keepDataDragSelection||!this.options.dataDragSelect)||this.__setFocusedCell(t,r,{allowContextMenuMultiCell:this.options.allowContextMenuMultiCell}))){if(this.focusedCell.length>0)for(C=0;C<this.focusedCell.length;C++)this._applyFocusedCellOut(this.focusedCell[C]);var _=r.className,x=parseInt(r.getAttribute(o)),S=parseInt(x/this.realRowDataLength);null!=_.match("rowNum")?(b=S,v="rowNum"):null!=_.match("rowStatus")?(b=S,v="rowStatus"):null!=_.match("groupby")?(b="groupby",v=-1):null!=_.match("Subtotal")&&(b="subtotal",v="number"==typeof(v=parseInt(r.getAttribute(i),10))?v:-1)}else r&&(this.hasClass(r,"w2grid_textImage")||this.hasClass(r,"w2grid_textImage_image"))?(b=parseInt(r.getAttribute(s),10),v=parseInt(r.getAttribute(i),10),this._setFocusedCell(b,v)):n?(b=parseInt(r.getAttribute(s),10),v=parseInt(r.getAttribute(i),10)):(b=this.getFocusedRowIndex(),v=this.getFocusedColumnIndex());if(!n&&r&&m){var R=this._dataList.dataArr[c*this._dataList.getColumnCount()+d];if(g!=R){var D={oldValue:g,newValue:R,rowIndex:h,colIndex:u,colId:this.getColumnID(u)};isNaN(f)||(D.oldSelectedIndex=f,D.newSelectedIndex=I&&I.comp&&I.comp.selectedIndex),p.f.fireEvent(this,"onviewchange",D)}}if(this.options.senseReader)("text"!=(I=this.getCellInfo(v)).options.inputType&&"secret"!=I.options.inputType||this.___getEditReadOnly(b,v)||this.options.contextMenu)&&p.f.preventDefault(t);else"touch"===t.pointerType&&!1===this.options.contextMenu||p.f.preventDefault(t);if(p.f.fireEvent(this,"onrightbuttonclick",this._getGroupbyDisplayRowIndex(b),v,t),this.options.contextMenu){(L={}).result=y,L.rowIndex=b,L.colIndex=v;w=[];if(this.focusedCell)for(C=0;C<this.focusedCell.length;C++)w.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[C].focusedRowIndex),colIndex:this.focusedCell[C].focusedColIndex});L.focusedCell=w,L.event=t;var T={isHeader:!1};(k=p.f.fireEvent(this,"oncontextopen",this._getGroupbyDisplayRowIndex(b),v,w,T))?this.createContextMenu(L,k):this.contextMenu?this.showContextMenu(L):this.createContextMenu(L)}}else if(r&&"DIV"==r.tagName&&this.hasClass(r,"w2grid_dataLayer")&&0===this.getRowCount()&&(p.f.preventDefault(t),p.f.fireEvent(this,"onrightbuttonclick",-1,-1,t),this.options.contextMenu)){var L;(L={result:!1,rowIndex:-1,colIndex:-1,focusedCell:null}).event=t;var k;T={isHeader:!1};(k=p.f.fireEvent(this,"oncontextopen",-1,-1,null,T))?this.createContextMenu(L,k):this.contextMenu?this.showContextMenu(L):this.createContextMenu(L)}},y.prototype.fireImageClick=function(t,e){var i=this.getCellInfo(e),o=this._getEditDisabled(t,e);if(this.options.useImageClick||0==o){var s=a.Z.getGlobalFunction(i.options.imageClickFunction,this.scope_id);"function"==typeof s&&s.call(this,t,e,this.dataList._getCellData(t,e))}},y.prototype.gridHeaderOut=function(t){try{for(var e=p.f.getRelatedTarget(t);!this.hasClass(e,this.options.headerTdClass)&&null!=e&&e!=this.render&&e!=document.documentElement;)e=e.parentNode;if(!e)return;var i=a.Z.getDataPrefix("header_id"),o=e.getAttribute(i);if(o===this._headerOverElemId)return;var r={};r.newHeaderId=o
;for(var n=p.f.getTarget(t),l=!1,h=this.event.getTargetIterator(t,this.render);h.next();)h.match(this.options.headerTdClass)&&(n=h.getElement(),h.stop(),l=!0);r.oldHeaderId=l?n.getAttribute(i):null,r.header_id=r.oldHeaderId,r.id=n.id,this._headerOverElemId="",p.f.fireEvent(this,"onheadermouseout",r)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.gridOut=function(t){var e=p.f.getTarget(t);if(this.overElem&&(e.id==this.id+"_dataLayer"||e.id==this.overElem.id||""==e.id)){if(this.options.rowMouseOver&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),"TD"===this.overElem.tagName){var i=a.Z.getDataPrefix("col_id"),o={};this.overElem.getAttribute(i)&&(o.rowIndex=this.getElemRowIndex(this.overElem),o.colIndex=this.getColumnIndex(this.overElem.getAttribute(i))),p.f.fireEvent(this,"onbodymouseout",o)}this.bodyOut(t,this.overElem),this.overElem=null}},y.prototype.addRowOverStyle=function(t){for(var e=a.Z.getDataPrefix("trIndex"),i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("style_bak");null!=t&&(1!=t.nodeType||null==t.getAttribute(e));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var s=parseInt(t.getAttribute(e));s>0;)s--,t=a.Z.prev(t);var r=a.Z.first(t),n=parseInt(r.getAttribute(i));if(!isNaN(n)){n=parseInt(n/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var l=this.options.rowMouseOverColor.wq_trim(),h=""==this.options.selectedCellOverColor?"":this.options.selectedCellOverColor.wq_trim(),d=""==this.options.selectedRowOverColor?"":this.options.selectedRowOverColor.wq_trim(),u=0;u<this.realRowDataLength;u++){var p=this.all_data_td_list[n+u],c=l;if(!(""==d||"row"!=this.options.focusMode&&"both"!=this.options.focusMode||"row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&u<this.options.fixedColumn))for(var g=parseInt(p.getAttribute(i)),f=parseInt(g/this.realRowDataLength)+this.rowIndex,m=0;m<this.focusedCell.length;m++)if(f==this.focusedCell[m].focusedRowIndex){c=d;break}if(""!=h&&("cell"==this.options.focusMode||"both"==this.options.focusMode)){g=parseInt(p.getAttribute(i)),f=parseInt(g/this.realRowDataLength)+this.rowIndex;var y=g%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);for(m=0;m<this.focusedCell.length;m++)if(f==this.focusedCell[m].focusedRowIndex&&y==this.focusedCell[m].focusedColIndex){c=h;break}}if(!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&u<this.options.fixedColumn)){if(u<this.defaultColCnt){var b=p.className;((""===this.options.rowNumBackgroundColor||!0===this.options.rowNumRowMouseOverColor)&&b.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||b.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)&&(p.style.backgroundColor=c,a.Z.isIEAllVersion(11)&&this.__addClass(p,"w2BackgroundClip"))}else p.style.backgroundColor=c,a.Z.isIEAllVersion(11)&&this.__addClass(p,"w2BackgroundClip");this.options.rowMouseOverClass&&this.__addClass(p,this.options.rowMouseOverClass)}p.removeAttribute(o)}}}},y.prototype.removeRowOverStyle=function(t,e){if(!(this.options.tooltipHeader&&t&&t.getElementsByTagName("TH").length>0)){for(var i=a.Z.getDataPrefix("trIndex"),o=a.Z.getDataPrefix("tdIndex"),s=a.Z.getDataPrefix("or_bgColor"),r=a.Z.getDataPrefix("style_bak");null!=t&&(1!=t.nodeType||null==t.getAttribute(i));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var n=parseInt(t.getAttribute(i));n>0;)n--,t=a.Z.prev(t);var l=a.Z.first(t),h=parseInt(l.getAttribute(o));if(!isNaN(h)){h=parseInt(h/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var d=0;d<this.realRowDataLength;d++){var u=this.all_data_td_list[h+d];if(d<this.defaultColCnt){var p=u.className;if((""===this.options.rowNumBackgroundColor||!0===this.options.rowNumRowMouseOverColor)&&p.indexOf(this.options.bodyTdClass+"_rowNumber")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){
for(var c=parseInt(u.getAttribute(o)),g=parseInt(c/this.realRowDataLength)+this.rowIndex,f=!1,m=0;m<this.focusedCell.length;m++)if(g==this.focusedCell[m].focusedRowIndex){f=!0;break}u.style.backgroundColor=f?this.options.selectedRowColor.wq_trim():""}else u.style.backgroundColor="";else if(p.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(c=parseInt(u.getAttribute(o)),g=parseInt(c/this.realRowDataLength)+this.rowIndex,f=!1,m=0;m<this.focusedCell.length;m++)if(g==this.focusedCell[m].focusedRowIndex){f=!0;break}u.style.backgroundColor=f?this.options.selectedRowColor.wq_trim():""}else u.style.backgroundColor=""}else!0!==e&&(u.style.backgroundColor=u.getAttribute(s)||"");this.hasClass(u,"w2BackgroundClip")&&this.__removeClass(u,"w2BackgroundClip"),!0!==e&&u.removeAttribute(r),this.options.rowMouseOverClass&&this.hasClass(u,this.options.rowMouseOverClass)&&this.__removeClass(u,this.options.rowMouseOverClass)}}}}},y.prototype.handleKeyDownEvent=function(t){if(!(this.parentControl&&this.parentControl.options&&"gridViewItemTable"===this.parentControl.options.pluginName||"gridItemTable"===this.parentControl.options.pluginName)&&0!=p.f.fireEvent(this,"onkeydown",t)){this.lastEvent=t;var e=WebSquare.event.getTarget(t);if(this.headerFocus);else{var i,o;if(e&&(e.className.match("w2grid_head_sort_div_main_btn")||e.className.match("w2grid_customFilter_open")))for(var s=e;s;){if("TH"===s.tagName&&this.hasClass(s,this.options.headerTdClass)){var r=WebSquare.util.getDataPrefix("header_id");i=s.getAttribute(r),e.className.match("w2grid_head_sort_div_main_btn")?o="sort":e.className.match("w2grid_customFilter_open")&&(o="filter");break}s=s.parentNode}if(!t.shiftKey&&9==t.keyCode&&i&&this.options.senseReader&&i===this._lastHeaderElementId&&o===this._lastHeaderElementType)this._setFirsCellFocus(t);else{if(e&&e.className.match("w2grid_start_div")&&this.options.senseReader&&"none"===this.options.focusMode)return;this.handleBodyKeyDown(t)}}}},y.prototype.handleKeyUpEvent=function(t){try{if(0==p.f.fireEvent(this,"onkeyup",t))return;if(this.lastEvent=t,this.editedCell&&this.editedCell._getEditedValue){var e=this.editedCell.options.inputType;if("custom"===e&&!this.editedCell.internal&&this.editedCell.editRowIndex){var i=this.getRealRowIndex(this.editedCell.editRowIndex);e=this.editedCell.cellManagerHashByRowIndex[i].options.inputType}if("text"===e||"textarea"===e||"calendar"===e||"textImage"===e||"secret"===e){var o=t.charCode?t.charCode:t.keyCode,r={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:e,keyCode:o};p.f.fireEvent(this,"oneditkeyup",r)}}else null!=this.beforeEditedCellInfo&&p.f.fireEvent(this,"oneditkeyup",this.beforeEditedCellInfo);if(this.beforeEditedCellInfo=null,!0===this.options.accessibility)for(var a=this.event.getTargetIterator(t,this.render);a.next();)a.match(this.options.bodyTdClass)&&a.stop(),a.match(this.options.headerTdClass)&&(this.removeFocusedCell(),a.stop())}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.headerOver=function(t,e){if(!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)){var i=e.offsetWidth;if(!(i<2)&&e.firstChild){var o,r=a.Z.getDataPrefix("col_id"),n=e.getAttribute(r),l=null;if(n){var h,d=this.getHeaderInfo(n);if(y=this.getHeaderInputType(n),o=d.options.embeddedInput,this.options.tooltipHeaderShowAlways&&(d.options.tooltipLocaleRef||d.options.tooltip)&&(h=d.options.tooltip,(this.options.useLocale||d.options.useLocale)&&d.options.tooltipLocaleRef)){var u=this.getLocaleValue(d.options.tooltipLocaleRef);u&&(h=u)}if(o&&"text"==y){var p=this.getElemRowIndex(e),g=this.getColumnIndex(e.getAttribute(r));o=!this._getEditDisabled(p,g)&&!this.___getEditReadOnly(p,g)}
if("textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==d.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)l=e.getElementsByTagName("th")[0];else{var f=this.event.getTargetIterator(t),m="w2grid_textImage_image";for("true"===d.options.viewTypeIconImage&&("autoComplete"==y?m=this.options.bodyTdClass+"_autoComplete_img":"calendar"==y&&(m=this.options.bodyTdClass+"_calendar_div_img"));f.next();)if(f.match(null,null,"th")&&f.getElement().id){l=this.hasClass(e,m)?e.previousSibling:e,e=f.getElement();break}}}else var y="text";if("text"==y||"textarea"==y||"textImage"==y||"link"==y||"calendar"==y||"expression"==y||"select"==y&&!o||"drilldown"==y||"autoComplete"==y||"checkcombobox"==y||"button"==y||this.options.showImageTooltip&&"image"==y){var b;"textarea"==y?(b=e.cloneNode(!0)).firstChild.style.width="":b=l||e;var v=i,w=e.offsetHeight,C=WebSquare.style.getStyle(e,"text-overflow"),I=20,_=w+3;try{this.options.tooltipPositionX&&(I=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(v,w)),this.options.tooltipPositionY&&(_=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(v,w))}catch(t){c.v.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.Y.printStackTrace(t,null,this)}this.options.tooltipShowAlwaysColumns;var x="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1;if(this.options.tooltipHeaderShowAlways){var S=WebSquare.style.getAbsoluteLeft(e)+I,R=WebSquare.style.getAbsoluteTop(e)+_,D="";if(h)D=h;else{if("text"==y&&o)D=b.firstChild.value;else if("link"==y)D=b.firstChild.innerHTML;else if("textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==d.options.viewTypeIconImage)D="NOBR"==l.firstChild.tagName||"SPAN"==l.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?b.firstChild.innerHTML:b.innerHTML;else if("image"==y)D=b.firstChild.innerHTML;else if("drilldown"==y)D=x?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else{D=x||"BUTTON"==e.firstChild.tagName?b.firstChild.innerHTML:b.innerText.wq_trim();var T=a.Z.getDataPrefix("sort");"TABLE"==e.firstChild.tagName&&"sort"==e.firstChild.getAttribute(T)&&D.split("\t")&&D.split("\t").length>1&&(D=D.split("\t")[0])}if(this.options.tooltipFormatterHeader)try{if("function"==typeof(O=a.Z.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))D=O(e.getAttribute(r),D)}catch(t){s.Y.printStackTrace(t,null,this)}}""!=D&&this.showTooltip(S,R,D,_)}else if("ellipsis"==C){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=b.className,"text"==y&&o?(this.toolTipRuler.innerHTML="<div>"+b.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(b.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(b.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(b.firstChild,"font-weight")):(this.toolTipRuler.innerHTML=b.innerHTML,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(b,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(b,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(b,"font-weight"));var L=this.toolTipRuler.firstChild.offsetWidth;if("textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==d.options.viewTypeIconImage)var k=l.clientWidth;else k=e.clientWidth;if(3!=b.firstChild.nodeType){var F=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),A=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");L-=parseInt(F||"0",10),L-=parseInt(A||"0",10),
"textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==d.options.viewTypeIconImage?(k-=parseInt(WebSquare.style.getStyle(l.firstChild,"padding-left"),10),k-=parseInt(WebSquare.style.getStyle(l.firstChild,"padding-right"),10),k-=parseInt(WebSquare.style.getStyle(l,"padding-left"),10),k-=parseInt(WebSquare.style.getStyle(l,"padding-right"),10)):(k-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),k-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),k-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),k-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(k<L||"image"==y||k==L&&e.clientWidth<e.scrollWidth){S=WebSquare.style.getAbsoluteLeft(e)+I,R=WebSquare.style.getAbsoluteTop(e)+_,D="";if(D="text"==y&&o?b.firstChild.value:"link"==y?b.firstChild.innerHTML:"textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==d.options.viewTypeIconImage?"NOBR"==l.firstChild.tagName||"SPAN"==l.firstChild.tagName&&l.firstChild.className.indexOf("w2grid_span")>-1?b.firstChild.innerHTML:b.innerHTML:"image"==y?b.firstChild.innerHTML:"drilldown"==y?x?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:x||"BUTTON"==e.firstChild.tagName?b.firstChild.innerHTML:b.innerText.wq_trim(),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatterHeader)try{if("function"==typeof(O=a.Z.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))D=O(e.getAttribute(r),D)}catch(t){s.Y.printStackTrace(t,null,this)}D.match('href=""')&&(D=D.wq_replaceAll('href=""',"")),this.showTooltip(S,R,D,_)}else this.render.removeChild(this.toolTipRuler)}else{var E=e.firstChild.offsetWidth;if(!0===this.options.showSortableImage){var M=e.firstChild.getElementsByTagName(this.options.dataTag)[0];M&&("NOBR"==M.tagName||"SPAN"==M.tagName&&M.className.indexOf("w2grid_span")>-1)&&(E=M.offsetWidth+parseInt(WebSquare.style.getStyle(e.firstChild,"margin-left"),10))}if(i+3<E){S=WebSquare.style.getAbsoluteLeft(e)+I,R=WebSquare.style.getAbsoluteTop(e)+_,D="";if(D="text"==y&&o?b.firstChild.value:"link"==y||"image"==y?b.firstChild.innerHTML:"drilldown"==y?x?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:x||"BUTTON"==e.firstChild.tagName?b.firstChild.innerHTML:b.innerText.wq_trim(),this.options.tooltipFormatterHeader)try{var O;if("function"==typeof(O=a.Z.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))D=O(e.getAttribute(r),D)}catch(t){s.Y.printStackTrace(t,null,this)}this.showTooltip(S,R,D,_)}}}}}},y.prototype.bodyOver=function(t,e){try{var i=a.Z.getDataPrefix("col_id"),o=e.offsetWidth,r=o,n=e.offsetHeight,l=20,h=n+3;if(this.options.rowStatusTooltipDisplay&&e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0){var d="";try{this.options.tooltipPositionX&&(l=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(r,n)),this.options.tooltipPositionY&&(h=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(r,n))}catch(t){c.v.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.Y.printStackTrace(t,null,this)}var u=WebSquare.style.getAbsoluteLeft(e)+l,p=WebSquare.style.getAbsoluteTop(e)+h,g=this.getElemRowIndex(e);switch(this.getRowStatus(g)){case"C":d=WebSquare.language.getMessage("Grid_rowStatus_insert");break;case"R":d=WebSquare.language.getMessage("Grid_rowStatus_initialValue");break;case"U":d=WebSquare.language.getMessage("Grid_rowStatus_update");break;case"D":d=WebSquare.language.getMessage("Grid_rowStatus_delete");break;case"V":d=WebSquare.language.getMessage("Grid_rowStatus_D_After_C");break;default:return}this.options.tooltipFormatter&&(d=this._showTooltopFormatter(e.id,d,!0)),""!=d&&this.showTooltip(u,p,d,h)}else{if(!this.options.tooltipDisplay)return;if(e.className.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)return;if(o<2||!e.firstChild)return;var f=e.getAttribute(i)
;if(this.options.tooltipDisplayColumn&&f&&-1===this.options.tooltipDisplayColumn.indexOf(f))return;var m,y,b,v=null;if(f){var w=this.getCellInfo(f);if(m=w.options.escape,0==w.internal&&"custom"==w.options.inputType&&(g=this.getRealRowIndex(this.getElemRowIndex(e)),w=w.cellManagerHashByRowIndex[g]?w.cellManagerHashByRowIndex[g]:w),y=w.options.inputType,(b=w.options.embeddedInput)&&"text"==y){g=this.getElemRowIndex(e);var C=this.getColumnIndex(e.getAttribute(i));b=!this._getEditDisabled(g,C)&&!this.___getEditReadOnly(g,C)}if("textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==w.options.viewTypeIconImage){var I="w2grid_textImage";"autoComplete"==y?I=this.options.bodyTdClass+"_autoComplete_table":"calendar"==y&&(I=this.options.bodyTdClass+"_calendar_table"),(v=e.getElementsByClassName(I)[0])||(v=e)}}else y="text";if(this.options.tooltipHideInputType&&this.options.tooltipHideInputType.split(",").indexOf(y)>-1)return;if("checkbox"==y||"radio"==y||"text"==y||"textarea"==y||"textImage"==y||"link"==y||"calendar"==y||"expression"==y||"select"==y||"drilldown"==y||"autoComplete"==y||"checkcombobox"==y||"button"==y||this.options.showImageTooltip&&"image"==y){var _;"textarea"==y?(_=e.cloneNode(!0)).firstChild.style.width="":_=v?this._getWrapperCell(v,g):this._getWrapperCell(e,g),n=e.offsetHeight;var x=WebSquare.style.getStyle(e,"text-overflow");h=n+3;try{this.options.tooltipPositionX&&(l=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(r,n)),this.options.tooltipPositionY&&(h=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(r,n))}catch(t){c.v.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.Y.printStackTrace(t,null,this)}var S=this.options.tooltipShowAlwaysColumns.split(","),R="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1;if(this.options.tooltipShowAlways||S.indexOf(f)>-1){u=WebSquare.style.getAbsoluteLeft(e)+l,p=WebSquare.style.getAbsoluteTop(e)+h,d="";if("text"==y&&b)d=_.firstChild.value;else if("link"==y)d=R?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML;else if("textImage"==y)if(b){var D=_.firstChild.getElementsByClassName("w2grid_textImage_div_input")[0];d=D?D.firstChild.value:_.innerHTML}else d="NOBR"==v.firstChild.tagName||"SPAN"==v.firstChild.tagName&&v.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:"DIV"==v.firstChild.tagName&&v.firstChild.className.indexOf("w2grid_textImage_div")>-1?_.firstChild.innerText:_.innerHTML;else if("autoComplete"!=y&&"calendar"!=y||"true"!=w.options.viewTypeIconImage)if("image"==y)d=_.firstChild.src;else if("drilldown"==y)d=R?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else if("select"==y&&"ul"===w.options.tableRender)d=_.innerText.wq_trim();else if("select"==y&&b)d=e.querySelector("select").value;else if("checkbox"==y||"radio"==y){(L=_.getElementsByTagName("label")[0])&&(d=L.innerText)}else d=R||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim();else d="NOBR"==v.firstChild.tagName||"SPAN"==v.firstChild.tagName&&v.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:_.innerHTML;if(this.options.tooltipFormatter){var T=o<e.scrollWidth;d=this._showTooltopFormatter(e.id,d,T)}""!=d&&this.showTooltip(u,p,d,h,m)}else if("ellipsis"==x){var L,k;if(("checkbox"==y||"radio"==y)&&!(L=_.getElementsByTagName("label")[0]))return;if(this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=_.className,"text"==y&&b)this.toolTipRuler.innerHTML="<div>"+_.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(_.firstChild,"font-size"),
this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(_.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(_.firstChild,"font-weight");else{if("drilldown"==y&&"line"==w.options.depthType){var F,A=this.options.dataTag.toUpperCase();"NOBR"===A?"NOBR"==(F=_.getElementsByTagName(this.options.dataTag)[0]).tagName&&(this.toolTipRuler.innerHTML=F.outerHTML):"SPAN"===A&&"SPAN"==(F=_.getElementsByClassName("w2grid_span")[0]).tagName&&F.className.indexOf("w2grid_span")>-1&&(this.toolTipRuler.innerHTML=F.outerHTML)}else if("checkbox"==y||"radio"==y)this.toolTipRuler.innerHTML=L.outerHTML;else if("select"==y&&b){for(var E=this.event.getTargetIterator(t),M=null;E.next();)if(E.match(this.options.bodyTdClass,null,"td")&&E.getElement().id){M=E.getElement();break}if(null!=M){var O=this.getInput(w,M).dom.select,N=document.createElement("div"),H=document.createElement("select");H.className=O.className;var G=document.createElement("option");G.value=O.value,G.text=O.value,H.add(G),N.appendChild(H),this.toolTipRuler.innerHTML=N.innerHTML,k=O.value}}else this.toolTipRuler.innerHTML=_.innerHTML;this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(_,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(_,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(_,"font-weight")}var W,B=this.toolTipRuler.firstChild.offsetWidth;if(null!=e.getBoundingClientRect&&(B=this.toolTipRuler.firstChild.getBoundingClientRect().width),"textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==w.options.viewTypeIconImage)W=v.clientWidth,null!=e.getBoundingClientRect&&(W=v.getBoundingClientRect().width);else{if(W=e.clientWidth,null!=e.getBoundingClientRect){var V=(WebSquare.style.getSize(e,"outerwidth")-WebSquare.style.getSize(e,"width"))/2;W=e.getBoundingClientRect().width-V}"drilldown"==y&&"line"==w.options.depthType?W=e.clientWidth-e.firstChild.clientWidth:"checkbox"!=y&&"radio"!=y||(W=e.clientWidth-WebSquare.style.getSize(e.firstChild,"outerMarginWidth"))}if(3!=_.firstChild.nodeType){var q=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),Y=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");B-=parseInt(q||"0",10),B-=parseInt(Y||"0",10),"textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==w.options.viewTypeIconImage?(W-=parseInt(WebSquare.style.getStyle(v.firstChild,"padding-left"),10),W-=parseInt(WebSquare.style.getStyle(v.firstChild,"padding-right"),10),W-=parseInt(WebSquare.style.getStyle(v,"padding-left"),10),W-=parseInt(WebSquare.style.getStyle(v,"padding-right"),10)):(W-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),W-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),W-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),W-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(W<B||"image"==y||W==B&&e.clientWidth<e.scrollWidth){u=WebSquare.style.getAbsoluteLeft(e)+l,p=WebSquare.style.getAbsoluteTop(e)+h,d="";d=k||("text"==y&&b?_.firstChild.value:"link"==y?R?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML:"textImage"==y||("autoComplete"==y||"calendar"==y)&&"true"==w.options.viewTypeIconImage?"NOBR"==v.firstChild.tagName||"SPAN"==v.firstChild.tagName&&v.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:_.innerHTML:"image"==y?_.firstChild.src:"drilldown"==y?R?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:R||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim()),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatter&&(d=this._showTooltopFormatter(e.id,d,!0)),d.match('href=""')&&(d=d.wq_replaceAll('href=""',"")),this.showTooltip(u,p,d,h,m)}else this.render.removeChild(this.toolTipRuler)}else{if(o+3<e.firstChild.offsetWidth){u=WebSquare.style.getAbsoluteLeft(e)+l,p=WebSquare.style.getAbsoluteTop(e)+h,d=""
;d="text"==y&&b?_.firstChild.value:"link"==y?R?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML:"image"==y?_.firstChild.src:"drilldown"==y?R?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:R||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim(),this.options.tooltipFormatter&&(d=this._showTooltopFormatter(e.id,d,!0)),this.showTooltip(u,p,d,h,m)}}}}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype._showTooltopFormatter=function(t,e,i){try{var o=document.getElementById(t),r=a.Z.getDataPrefix("col_id"),n=a.Z.getDataPrefix("colindex"),l=a.Z.getDataPrefix("trindex"),h=a.Z.getGlobalFunction(this.options.tooltipFormatter,this.scope_id);if("function"==typeof h){var d,u,p="body";this.hasClass(o,this.options.subtotalTdClass)?(p="subtotal",d=parseInt(o.parentNode.getAttribute(l),10),u=parseInt(o.getAttribute(n),10)):this.hasClass(o,this.options.footerTdClass)?(p="footer",d=parseInt(o.parentNode.getAttribute("data-trindex"),10),u=parseInt(o.getAttribute(n),10)):(d=this.getElemRowIndex(o),u=this.getColumnIndex(o.getAttribute(r))),e=h(d,u,e,i,p)}return e}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.bodyOut=function(t,e){var i=this;(i.options.tooltipDisplay||i.options.headerTooltipDisplay||this.options.tooltipHeader||i.options.rowStatusTooltipDisplay)&&e&&i.hideTooltip()},y.prototype.showTooltip=function(t,e,i,o,n){if(null==this.editedCell){try{var l=r.I.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(l){var h=a.Z.getGlobalFunction(l,this.scope_id),d=!0;if("function"==typeof h&&(d=h(this)),!d)return}}catch(t){s.Y.printStackTrace(t)}var u=document.body.scrollWidth,c=this.options.useMobileTooltip&&this.isMobile?"w2grid_mobileTooltip":"";this.tooltip||(this.tooltip=new WebSquare.uiplugin.output(this.id+"_tooltip",{className:"w2grid_tooltip "+this.options.tooltipClass+c,style:"position:absolute;"+this.options.tooltipStyle}),this.tooltip.parentFrame=this.parentFrame,this.tooltip.writeTo(WebSquare.getBody()),this.tooltip.activate(),"click"===this.options.tooltipHide?this.tooltip.render.onclick=function(){this.style.display="none"}:this.tooltip.render.onmouseover=function(){this.style.display="none"}),"click"===this.options.tooltipHide&&(1==WebSquare.getBody().hasClass("w2drag_activate")?(this.tooltip.render.onclick=null,this.tooltip.render.onmouseover=function(){this.style.display="none"}):(this.tooltip.render.onclick=function(){this.style.display="none"},this.tooltip.render.onmouseover=null)),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",t+"px"),this.tooltip.setStyle("top",e+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip");var g=n?WebSquare.xml._encode(i):i,f=this,m=this.getCellInfo(this.getFocusedColumnIndex()).options.inputType;if(this.options.useMobileTooltip&&(a.Z.isMobile()||this.isHammerEnabled())){var y="",b="<button type='button' id='"+this.id+"_mobileTooltipCloseButton' onclick='' class='w2grid_mobileTooltipClose_button'>X</button>";if("link"==m){y="<p id='"+this.id+"_toGoButton'><a href class='w2grid_mobileTooltip_anchor' onClick='event.returnValue=false; return false;'>"+g+"</a></p>";y+=b,this.tooltip.render.innerHTML=y,this.tooltip.event.addListener(this.tooltip.render.querySelector(".w2grid_mobileTooltip_anchor"),"onclick",(function(t){try{var e=f.getFocusedColumnIndex();p.f.fireEvent(f,"oncellclick",f._getGroupbyDisplayRowIndex(f._getFocusedRowIndex()),e,f.getFocusedColumnID())}catch(t){s.Y.printStackTrace(t,null,this)}}))}else"text"==m&&(y="<p>"+g+"</p>"+b,this.tooltip.render.innerHTML=y)}else this.tooltip.render.innerHTML=g;p.f.fireEvent(this,"ontooltipshow");var v=this.tooltip.render.offsetTop+this.tooltip.render.offsetHeight+20,w=document.body.scrollHeight;if(null!=WebSquare.BootLoader.fullViewRatio&&(w=document.body.clientHeight+Math.abs(document.body.getBoundingClientRect().top)),v>w){var C=e-(o+this.tooltip.render.offsetHeight);C<0&&(C=0),this.tooltip.setStyle("top",C+"px")}if(document.body.scrollWidth>u){
var I=t-(document.body.scrollWidth-u);I<0&&(I=0),this.tooltip.setStyle("left",I+"px")}this.options.tooltipDisplayTime>0&&r.I.setTimer(this.hideTooltip,{key:this.id+"_tooltip_hide_timer",caller:this,delay:this.options.tooltipDisplayTime})}},y.prototype.hideTooltip=function(){this.tooltip&&(this.options.tooltipDisplayTime>0&&r.I.clearTimer(this.id+"_tooltip_hide_timer"),p.f.fireEvent(this,"ontooltiphide"),this.tooltip.setStyle("display","none"))},y.prototype.bodyClick=function(t,e,i){try{var r=this.getLastFocusedCell().focusedTd;this.options.rowMouseOver&&this.removeRowOverStyle(this.lastOverSrc,"grid_body_row_over","grid_body_row");var n=a.Z.getDataPrefix("tdIndex"),l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("colIndex"),d=this.rowIndex,u=parseInt(e.getAttribute(n)),c=(O=parseInt(u/this.realRowDataLength))+this.rowIndex,g=e.getAttribute(l),f=this._dataList.getRowPosition(),m=this.getColumnIndex(this._dataList.getColumnPosition()),y=O+d,b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(g&&(K=this.getCellInfo(g)),"number"!=typeof(G=this.dataList.getRealRowIndex(c)))return void(G&&"header"==G.type&&this.toggleGroup(G.groupId));if(this.options.focusDefaultColumn){var v=e.getAttribute("id")||"",w="_headerRowNumber"===v.slice(0,16),C="_headerRowStatus"===v.slice(0,16);if(w||C)return this.__setFocusedCell(t,e,{editMode:!1}),void(C?p.f.fireEvent(this,"onrowstatusclick",y):p.f.fireEvent(this,"onrownumclick",y))}if(null==g)return;this.moveDirection=null;var I=m-b,_=f-y;0==I&&0==_?this.moveDirection="none":(I>0||I<0)&&(_>0||_<0)?this.moveDirection="both":I>0||I<0?this.moveDirection="column":(_>0||_<0)&&(this.moveDirection="row");var x=a.Z.getDataPrefix("editModeEvent"),S=e.getAttribute(x)||"",R=!1;if(""!=S&&"onsecondclick"==S.toLowerCase()||""==S&&"onsecondclick"==this.options.editModeEvent.toLowerCase())for(var D=0;D<this.focusedCell.length;D++)this.focusedCell[D].focusedRowIndex==y&&this.focusedCell[D].focusedColIndex==b&&(R=!0);K=this.getCellInfo(e);var T,L="";"custom"===K.options.inputType&&(L=(T=K.cellManagerHashByRowIndex[this.getRealRowIndex(y)]?K.cellManagerHashByRowIndex[this.getRealRowIndex(y)]:K).options.inputType);var k,F=!0,A=p.f.getTarget(t);if(!K.options.blockSelect&&("button"!==K.options.inputType&&"button"!==L||("button"===K.options.inputType||"button"===L)&&A&&"TD"===A.tagName)){var E,M=!0;if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&"link"!==K.options.inputType&&(M=!1),this.options.preventMultipleClick&&"checkbox"===K.options.inputType&&A&&"LABEL"===A.tagName&&(M=!1),M){if("enter"===this.options.drilldownToggle&&this.isMobile&&this.isHammerEnabled())if(1==this.focusedCell.length)if((K=this.getCellInfo(this.focusedCell[0].focusedColIndex))&&"drilldown"==K.options.inputType){u=parseInt(e.getAttribute(n));var O=parseInt(u/this.realRowDataLength),N=(g=parseInt(e.getAttribute(h)),y=this._getGroupbyDisplayRowIndex(O+d),b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),this.focusedCell[0].focusedColIndex),H=this.focusedCell[0].focusedRowIndex;if(y===H&&b===N){var G=this.dataList.getRealRowIndex(H);this.toggle(G)}}var W={editMode:"none"==K.options.focusMode,dont_fixScroll:this.options.CellClickFixScrollX};o.q.extend(W,i),E=this.__setFocusedCell(t,e,W)}"multiCell"===E&&(F=!1),K.options.embeddedInput&&(this.focusedByApi=!1)}if(t.altKey&&!0===this.options.contextMenuAltClick)return void this.clickRightButtonCell(t);var B=!0;k=a.Z.isIE()?t.srcElement:t.target;var V=!1;switch(K.options.inputType){case"radio":case"checkbox":if("INPUT"!=k.tagName)if(!this.options.checkOnCellClick||"LABEL"==k.tagName||this._getEditDisabled(y,b)||this.___getEditReadOnly(y,b))B=!1;else{var q=e.getElementsByTagName("input")[0];!q||"checkbox"!=K.options.inputType&&q.checked||(q.checked=!q.checked,V=!0)}break;case"drilldown":this.options.ignoreToggleOnDisabled&&this._getEditDisabled(c,g)&&(B=!1)}var Y,Z=!1,j=this.isHammerEnabled()
;if(B)if(Y=this.setCellClickEdit(e))V&&p.f.fireEvent(this,"oncellclick",y,b,U);else{S=e.getAttribute(x)||K.options.editModeEvent||"";var P=null!=r&&r===e,z=""!=S&&"onclick"==S.toLowerCase()||""==S&&"onclick"==this.options.editModeEvent.toLowerCase()||R;if((!j||P)&&z){if(!this._getEditDisabled(c,g)){u=parseInt(e.getAttribute(n)),O=parseInt(u/this.realRowDataLength),g=parseInt(e.getAttribute(h));var U=e.getAttribute(l);y=this._getGroupbyDisplayRowIndex(O+d),b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.hideTooltip(),!("button"===(K=this.getCellInfo(b)).options.inputType||!K.options.embeddedInput&&("checkbox"===K.options.inputType||"radio"===K.options.inputType)&&this.options.preventMultipleClick)){var X=!1;if(0==K.internal&&"custom"==K.options.inputType)("button"===T.options.inputType||!T.options.embeddedInput&&("checkbox"===T.options.inputType||"radio"===T.options.inputType)&&this.options.preventMultipleClick)&&(X=!0);X||"drilldown"==K.options.inputType&&this.options.ignoreCellClick&&Y||p.f.fireEvent(this,"oncellclick",y,b,U)}Z=!0}F&&this.setEditMode(e)}}if(!Z&&!this._getEditDisabled(c,g)){var K;u=parseInt(e.getAttribute(n)),O=parseInt(u/this.realRowDataLength),g=parseInt(e.getAttribute(h)),U=e.getAttribute(l),y=O+d,b=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(j||this.options.tooltipDisplay&&this.isMobile?this.bodyOver(t,e):this.hideTooltip(),!("button"===(K=this.getCellInfo(b)).options.inputType||!K.options.embeddedInput&&("checkbox"===K.options.inputType||"radio"===K.options.inputType&&this.options.preventDuplicateFocusedCell)&&this.options.preventMultipleClick&&!(this.options.checkOnCellClick&&"LABEL"!=k.tagName))){if(0==K.internal&&"custom"==K.options.inputType)if("button"===T.options.inputType||!T.options.embeddedInput&&"checkbox"===T.options.inputType&&this.options.preventMultipleClick)return;y=this._getGroupbyDisplayRowIndex(y),"drilldown"==K.options.inputType&&this.options.ignoreCellClick?Y||p.f.fireEvent(this,"oncellclick",y,b,U):("radio"===K.options.inputType||"checkbox"===K.options.inputType)&&("LABEL"===k.tagName||"TD"===k.tagName)||"link"===K.options.inputType&&this.options.contentCellClick&&"A"!==k.tagName||"link"===K.options.inputType&&this.options.useMobileTooltip&&(j||this.options.tooltipDisplay&&this.isMobile)||"image"===K.options.inputType&&this.options.contentCellClick&&"IMG"!==k.tagName||p.f.fireEvent(this,"oncellclick",y,b,U)}}}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.bodyDblClick=function(t,e){var i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("col_id"),s=a.Z.getDataPrefix("editModeEvent");if("INPUT"==e.tagName)var r=this.getLastFocusedCell(),n=r.focusedRowIndex,l=r.focusedColIndex;else{var h=parseInt(e.getAttribute(i));n=parseInt(h/this.realRowDataLength)+this.rowIndex,l=e.getAttribute(o)}if(null!=l){var d=e.getAttribute(s)||"";if((""!=d&&"ondblclick"==d.toLowerCase()||""==d&&"ondblclick"==this.options.editModeEvent.toLowerCase())&&this.setEditMode(e),!this._getEditDisabled(n,l)){this.rollbackCommitFlag=!1;var u=this.isHammerEnabled(),c=this.getCellInfo(l);if(u||c.options.blockSelect)p.f.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(n),this.getColumnIndex(l),this.getColumnID(l));else{var g=this.getFocusedColumnIndex();p.f.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(this._getFocusedRowIndex()),g,this.getColumnID(g))}this.rollbackCommitFlag=!0}}},y.prototype.headerClick=function(t,e,i){this.focusedByApi=!1,this.options.tooltipHeader&&this.hideTooltip();var o=a.Z.getDataPrefix("header_id"),s=e.getAttribute(o);if((this.options.preventMultipleClick||this.options.senseReader)&&this.headerInfoHash[s]&&this.headerInfoHash[s].options&&"checkbox"===this.headerInfoHash[s].options.inputType||1!=this._getHeaderDisabled(s)&&p.f.fireEvent(this,"onheaderclick",s),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i),
1==this.noevent);else if(this.getDataLength()>0&&"onclick"==this.options.sortEvent&&this._checkSortable(e)&&!this.groupbyStatus.grouped&&(this.fireSortEvent(t,e),this.options.sortHeaderDiv)){var r=e.getElementsByTagName("button");if(r.length>0){var n=r[r.length-1];if(!0!==this.options.accessibility){var l=this.getElementById(this.id+"_scrollX_div");if(l.offsetHeight){for(var h=this.getElementById(this.id+"_scrollX_right").scrollLeft,d=parseInt(e.getAttribute("colSpan"))||1,u=this.headerToBodyRelation[s],c=this._getRealColIndex("body",u)+this.defaultColCnt,g=e.offsetWidth,f=this.colWidthList[c],m=1;m<d;m++)f+=this.colWidthList[c+m];var y=this._getRealColIndex("body",u)+this.defaultColCnt+d-1,b=0;for(m=0;m<=y;m++)!0!==this.hiddenList[m]&&(b+=this.colWidthList[m]);var v=b-(h+l.offsetWidth);v>0?this.setScrollLeft(h+v):g<f&&this.setScrollLeft(h-(f-g))}}a.Z.requestAnimationFrame((function(){n.focus()})),1==this.options.senseReader&&this.addGridScroll(0-this.rowIndex)}}this.noevent=!1},y.prototype.headerDdlClick=function(t,e){var i=a.Z.getDataPrefix("header_id");p.f.fireEvent(this,"onheaderdblclick",e.getAttribute(i));var o=this._checkSortable(e);this.getDataLength()>0&&"ondblclick"==this.options.sortEvent&&o&&!this.groupbyStatus.grouped&&this.fireSortEvent(t,e),this.groupbyStatus.grouped&&o||(this.noevent=!1)},y.prototype.fireGroupByRangeSortEvent=function(t,e){try{return}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.recursiveRangeSort=function(t,e,i){try{return}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.fireSortEvent=function(t,e){if(!e.disabled&&!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)&&this._checkSortable(e)){var i=a.Z.getDataPrefix("header_id"),o=e.getAttribute(i),s=this.headerToBodyRelation[o],r=a.Z.getDataPrefix("orderByColumn"),n=e.getAttribute(r);n&&this.bodyIdColIndexMap[n]&&(s=n);var l=this.options.useCtrlOnMultisort?t.ctrlKey||t.metaKey:!(t.ctrlKey||t.metaKey);this.options.preventMultisort&&(l=!1);var h=this.cellInfoHash[s];if("gridView"!=this.initializeType||("expression"!=h.options.inputType||"true"==h.options.expressionSort)&&"drilldown"!=h.options.inputType){if(null==this.headerSortStatusArr&&(this.headerSortStatusArr=[]),this.headerSortStatusArr[s]){if(this.options.noSortInit?-1==this.headerSortStatusArr[s].sortOrder?this.headerSortStatusArr[s].sortOrder=1:this.headerSortStatusArr[s].sortOrder=-1:this.options.sortOrderReverse?this.headerSortStatusArr[s].sortOrder=(this.headerSortStatusArr[s].sortOrder+3)%3-1:this.headerSortStatusArr[s].sortOrder=(this.headerSortStatusArr[s].sortOrder-3)%3+1,!l){var d=this.headerSortStatusArr[s];this.clearHeaderSort(),this.headerSortStatusArr.push(d),this.headerSortStatusArr[s]=this.headerSortStatusArr[0]}}else{if(this.headerSortStatusArr.length>0&&l){if(isNaN(this._grid._dataList.getColumnIndex(s)))return void c.v.printLog("fake columns do not supported multiple sort.["+this.id+"]");for(var u=0;u<this.headerSortStatusArr.length;u++)if(isNaN(this._grid._dataList.getColumnIndex(this.headerSortStatusArr[u].colID)))return void c.v.printLog("fake columns do not supported multiple sort.["+this.id+"]")}(d={}).headerId=o,d.colID=s,this.options.sortOrderReverse?d.sortOrder=-1:d.sortOrder=1;h=this.getCellInfo(s);var g=this.getColumnOption(h.options.col_id,"dataType"),f=this._dataList.getCellInfo(s).options.dataType;d.dataType="number"==g||"bigDecimal"===g||"float"==g?g:f,l?(this.headerSortStatusArr.push(d),this.headerSortStatusArr[s]=this.headerSortStatusArr[this.headerSortStatusArr.length-1]):(this.clearHeaderSort(),this.headerSortStatusArr.push(d),this.headerSortStatusArr[s]=this.headerSortStatusArr[0])}if(!0===this.options.accessibility&&!l){var m=this.getElementById(this.id+"_sort_info");if(0===(v=d.sortOrder))m.innerText="";else{
var y=1===v?WebSquare.language.getMessage("Grid_sort_asc_info",this.getHeaderValue(o)):WebSquare.language.getMessage("Grid_sort_desc_info",this.getHeaderValue(o));m.innerText=y}}var b=[],v=[],w=(g=[],{});if(w.headerId=o,w.bodyColId=s,w.sortOrder=this.headerSortStatusArr[s].sortOrder,0==this.headerSortStatusArr.length)this.dataList.clearSortFilter();else{for(u=this.headerSortStatusArr.length-1;u>=0;u--)if(0==this.headerSortStatusArr[u].sortOrder){var C=this.headerSortStatusArr[u].colID;if(this.setHeaderSortImage(o,0,0),this.headerSortStatusArr.splice(u,1),delete this.headerSortStatusArr[C],0==this.headerSortStatusArr.length)return p.f.fireEvent(this,"onbeforesort",w),this.dataList.clearSort(),void p.f.fireEvent(this,"onsort",w)}else b.push(this.headerSortStatusArr[u].colID),v.push(this.headerSortStatusArr[u].sortOrder),g.push(this.headerSortStatusArr[u].dataType);if(b.reverse(),v.reverse(),g.reverse(),0==p.f.fireEvent(this,"onbeforesort",w))return;this.dataList.setFilter({type:"sort",sortIndex:b.join(" "),sortOrder:v.join(" "),dataType:g.join(" "),focuseMode:this.options.filterFocusMode,ignoreEmptyStringOnSort:this.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:this.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:this.options.setEmptyStringSortableOnSort})}this.drawHeaderSortImages(),p.f.fireEvent(this,"onsort",w)}}},y.prototype.footerClick=function(t,e,i){var o=a.Z.getDataPrefix("footer_id");p.f.fireEvent(this,"onfooterclick",e.getAttribute(o)),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)},y.prototype.footerDblClick=function(t,e,i){var o=a.Z.getDataPrefix("footer_id");p.f.fireEvent(this,"onfooterdblclick",e.getAttribute(o)),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)},y.prototype.subtotalClick=function(t,e,i){try{for(var o=e.getAttribute("id"),r=a.Z.getDataPrefix("targetcolumnid"),n=e.parentNode.getAttribute(r),l=0,h=-1,d=0;d<this.subtotalRowHash[n].length;d++)if(this.subtotalRowHash[n][d]===e.parentNode){h=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(h>-1){var u=this._dataList.getCellData(h,n);for(l=h-1;this._dataList.getCellData(l,n)==u&&l>=0;l--);l++}var c={colID:o,startRowIndex:l,endRowIndex:h,element:e};p.f.fireEvent(this,"onsubtotalclick",c),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.subtotalDblClick=function(t,e){try{for(var i=e.getAttribute("id"),o=a.Z.getDataPrefix("targetcolumnid"),r=e.parentNode.getAttribute(o),n=0,l=-1,h=0;h<this.subtotalRowHash[r].length;h++)if(this.subtotalRowHash[r][h]===e.parentNode){l=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(l>-1){var d=this._dataList.getCellData(l,r);for(n=l-1;this._dataList.getCellData(n,r)==d&&n>=0;n--);n++}var u={colID:i,startRowIndex:n,endRowIndex:l,element:e};p.f.fireEvent(this,"onsubtotaldblclick",u)}catch(t){s.Y.printStackTrace(t,null,this)}},y.prototype.handleTouchStart=function(t){!this.isHammerEnabled()&&this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),r.I.clearTimer(this.id+"_iScroll_slideX");var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;(e||i)&&(this.iScrollAddMoveClass(),this.iScroll.moveDirection=null,this.iScroll.propagation=null,this.iScroll.prevTouches=[{x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY}],r.I.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime}))},y.prototype.handleTouchMove=function(t){if("pass"!=this.iScroll.propagation){this.iScroll.addMoveClass&&(this.iScrollAddMoveClass(),this.iScroll.addMoveClass=!1);var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;if(e||i){var o=this.scrollX_right,s=this.getElementById(this.id+"_scrollY_div");this.iScroll.prevTouches.push({
x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY});var a=this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2);if(a.length<2)return;var n=a[0].x-a[1].x,l=a[0].y-a[1].y,h=this.iScroll.moveDirection;if(h||(h=this.iScroll.moveDirection=Math.abs(l)>=Math.abs(n)?"Y":"X",this.iScroll.moveDistance=Math.abs(l)>=Math.abs(n)?Math.abs(l):Math.abs(n)),this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===h)return void p.f.stopEvent(t);var d=this.hasSubtotal&&this.lastSubtotalRow&&"none"==this.lastSubtotalRow.style.display;if("X"==h&&n<0&&0==o.scrollLeft||"X"==h&&n>0&&o.scrollLeft>=o.firstChild.offsetWidth-o.offsetWidth||"Y"==h&&l<0&&0==s.scrollTop||"Y"==h&&l>0&&this.rowIndex+this.lastIndex+1==this.getDataLength()&&!d||"Y"==h&&this.hasClass("w2grid_adaptive_crosstab")||"Y"==h&&0===this.getDataLength())return void("stop"==this.iScroll.propagation?p.f.stopEvent(t):(this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"));"X"==h?this.moveXScroll(n):!0!==this._isBrowserScroll()&&this.moveYScroll(l),this.iScroll.propagation="stop",!0===this._isBrowserScroll()&&"X"!=h||p.f.stopEvent(t),r.I.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.addMoveClass=!0}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime})}}},y.prototype.handleTouchEnd=function(t){if(this.isMobile||window.navigator.msPointerEnabled&&this.iScroll.prevTouches&&"touch"==t.pointerType){r.I.clearTimer(this.id+"_iScroll"),this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2);var e=this.iScroll.prevTouches;if(e.length>=2){var i=e[0].x-e[1].x;if(this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===this.iScroll.moveDirection){var o=this.getElementById(this.id+"_body_tbody"),s=o.firstChild.offsetWidth,a=0;return i>0?a=Math.ceil(i/s)*s:i<0&&(a=Math.floor(i/s)*s),void(o.scrollLeft=Math.floor((o.scrollLeft+a)/s)*s)}var n=new Date;this.slideX(i,n)}else this.iScrollRemoveMoveClass()}},y.prototype.iScrollAddMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__addClass(t,"w2grid_iScrollX_move"),this.__addClass(e,"w2grid_iScrollY_move")},y.prototype.iScrollRemoveMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__removeClass(t,"w2grid_iScrollX_move"),this.__removeClass(e,"w2grid_iScrollY_move")},y.prototype.moveXScroll=function(t){var e=this.getElementById(this.id+"_iScrollX"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_scrollX_left"),s=this.scrollX_right;s.scrollLeft+=t;var r=parseInt(o.style.width,10),a=s.firstChild.offsetWidth-s.offsetWidth,n=parseInt(s.offsetWidth*s.offsetWidth/s.firstChild.offsetWidth,10);e.style.width=(n<30?30:n)+"px",e.style.left=r+s.scrollLeft/a*(i.offsetWidth-r-e.offsetWidth)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},y.prototype.slideX=function(t,e){var i=new Date,o=parseInt(t/3,10);this.moveXScroll(o),t-=o,Math.abs(t)>=0&&i-e<this.options.iScrollSlideTime?(r.I.clearTimer(this.id+"_iScroll_slideX"),r.I.setTimer(this.slideX,{key:this.id+"_iScroll_slideX",caller:this,delay:this.options.iScrollSlidePeriod,args:[t,e]})):this.iScrollRemoveMoveClass()},y.prototype.moveYScroll=function(t){t*=parseInt(this.options.touchScrollDelta,10)||5;var e=this.getElementById(this.id+"_iScrollY"),i=this.getElementById(this.id+"_scrollY_div");i.scrollTop+=t;var o=i.firstChild.offsetHeight,s=this.getElementById(this.id+"_dataLayer"),r=o-s.offsetHeight,a=parseInt(s.offsetHeight*s.offsetHeight/o,10);e.style.height=(a<30?30:a)+"px",e.style.top=i.scrollTop/r*(s.offsetHeight-e.offsetHeight)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},y.prototype.tbodyMoveXScroll=function(t){if(this.editedCell&&this.editedCell.handleEndEdit(),!this.mobile&&this.options.scrollByColumnAdaptive,
this.options.adaptiveSlideHeader){var e=this.options.adaptive,i=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==e&&!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)&&a.Z._getBrowserWidth()<=i&&this.slideHeadObj&&"absolute"==this.slideHeadObj.render.style.position){this.slideHeadObj.hidden&&($(this.slideHeadObj.render.firstChild).animate({width:"show"}),this.slideHeadObj.hidden=!1);var o=this;!function t(){a.Z.setTimeout((function(){null!=WebSquare.userTimerHash[o.id+"_adaptiveSlideHeader"]?(a.Z.clearTimeout(o.id+"_adaptiveSlideHeader"),t()):o.slideHeadObj.hidden||($(o.slideHeadObj.render.firstChild).animate({width:"hide"}),o.slideHeadObj.hidden=!0)}),{delay:1e3,key:o.id+"_adaptiveSlideHeader"})}()}}};var b=function(){};b.prototype.nonCharKeys={4:"insert",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",9:"tab",13:"enter",46:"del",16:"shift",17:"ctrl",18:"alt",21:"hanyoung",25:"hanja",91:"window",20:"capslock",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"numlock",145:"scrolllock"},b.prototype.handleBodyKeyDown=function(t){this.isKeyPressed=!0;for(var e=this.event.getTargetIterator(t,this.render),i=!1;e.next()&&e.element;)e.match(this.options.bodyTdClass)?(i=!1,e.stop()):e.match(this.options.headerTdClass)&&(i=!0,e.stop());if(this.editMode){var o=this.editedCell.options.inputType;switch("text"!==o&&"textarea"!==o&&"calendar"!==o&&"textImage"!==o&&"secret"!==o||(this.beforeEditedCellInfo={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:o,keyCode:t.charCode?t.charCode:t.keyCode}),A=t.keyCode){case 9:if(p.f.stopEvent(t),"down"==this.options.tabKeyMove){if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;u=!1,"calendar"===o&&(u=this.options.keyMoveEditMode&&"down"==this.options.tabKeyMove);var n=this.editedCell.id}if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,u],{checkFunc:function(t){return t+""!="false"}})){var l=!1;if("down"===this.options.tabKeyMove){var h=this.getLastFocusedCell().focusedColIndex;l=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,n);var d=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===l?(this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))]),this.focusNextTabOrder()):(!l||h!==d&&null!=h&&null!=d)&&this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))])}else l=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);l||this._setFocusedCell(this.editMode)}break;case 13:if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;var u=!1;a.Z.isIEAllVersion()&&"calendar"===o&&(u=this.options.keyMoveEditMode&&"right"!=this.options.enterKeyMove&&"none"!=this.options.enterKeyMove);n=this.editedCell.id;if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}}))if(u){L=this;setTimeout((function(){var e=!1;if("right"==L.options.enterKeyMove||"editRight"==L.options.enterKeyMove)e=L.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=L.options.enterKeyMove&&"edit"!=L.options.enterKeyMove){
var i=L.getLastFocusedCell().focusedColIndex;e=L.moveVertical(t,t.shiftKey?"up":"down",L.options.keyMoveEditMode,n);var o=L.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===e?(L._fireOnviewchange(n,"_handleEndEdit_focus",[L.getInput(L.getCellInfo(n))]),L.focusNextTabOrder()):(!e||i!==o&&null!=i&&null!=o)&&L._fireOnviewchange(n,"_handleEndEdit_focus",[L.getInput(L.getCellInfo(n))])}e||L._setFocusedCell(L.editMode)}),1)}else{l=!1;if("right"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove)l=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=this.options.enterKeyMove&&"edit"!=this.options.enterKeyMove){h=this.getLastFocusedCell().focusedColIndex;l=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,n);d=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===l?(this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))]),this.focusNextTabOrder()):(!l||h!==d&&null!=h&&null!=d)&&this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))])}l||this._setFocusedCell(this.editMode)}break;case 27:this.editedCell.handleCancelEdit(t),this._setFocusedCell(),p.f.stopEvent(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){p.f.stopEvent(t);break}this.options.checkEditOnPaste&&this._doPaste()}default:var c={};c.rowIndex=this.editedCell.editRowIndex,c.colIndex=this._dataList.getColumnIndex(this.editedCell.id),c.colID=this.editedCell.id,c.keyCode=t.charCode?t.charCode:t.keyCode,this.editedCell._getEditedValue&&(this.editedCell.beforeEditValue=this.editedCell._getEditedValue()),p.f.fireEvent(this,"oneditkeydown",c)}}else{if(i){if(35===t.keyCode&&t.ctrlKey)return void this.focusToEnd();if(36===t.keyCode&&t.ctrlKey)return void this.focusToStart();this.removeFocusedCell()}if(this.options.ignoreKeyCheckFunction){var g=null,f=!1;try{if("function"==typeof this.options.ignoreKeyCheckFunction?g=this.options.ignoreKeyCheckFunction:"function"==typeof(g=a.Z.getGlobalFunction(this.options.ignoreKeyCheckFunction,this.scope_id))&&(this.options.ignoreKeyCheckFunction=g),"function"==typeof g&&(f=g.call(this,t)),f)return void p.f.preventDefault(t)}catch(t){g=null}}var m=a.Z.getDataPrefix("tdIndex"),y=a.Z.getDataPrefix("colIndex"),b=a.Z.getDataPrefix("col_id"),v=a.Z.getDataPrefix("directItemChoice");if("none"!=this.options.focusMode&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){if(13==t.keyCode&&document.activeElement==this.render&&(this._setFocusedCell(),p.f.stopEvent(t)),"A"!=p.f.getTarget(t).tagName)return;e=this.event.getTargetIterator(t,this.render);for(var w=!1;e.next();)if(e.match(this.options.bodyTdClass)){w=!0;var C=e.getElement(),I=parseInt(C.getAttribute(m)),_=parseInt(I/this.realRowDataLength),x=C.getAttribute(b),S=this.getColumnIndex(x);this.focusedCell.push({focusedTd:C,focusedRowIndex:_,focusedColIndex:S});var R=C.getElementsByTagName("a");if(-1==this.focusedCellLinkIndex)for(var D=0;D<R.length;D++)document.activeElement==R[D]&&(this.focusedCellLinkIndex=D);this.focusedCellLinkLength=R.length;break}if(!w)return}var T=!1;if(r.I.browserCheck.safari&&(t.ctrlKey||t.metaKey)){this.tempEditableCell=document.activeElement,this.tempEditableCell.contentEditable="true",this.tempEditableCell.style.textShadow="0 0 0 "+WebSquare.style.getStyle(this.tempEditableCell,"color"),this.tempEditableCell.style.color="transparent";var L=this;r.I.setTimer((function(){L.tempEditableCell.contentEditable="inherit",this.tempEditableCell.style.color="",this.tempEditableCell.style.textShadow=""}),{key:this.id+"_tempEditableCell_contentEditable",caller:this,delay:500})}switch(t.keyCode){case 37:case 39:if(this.options.moveKeyEditMode){var k=37==t.keyCode?"left":"right";return this.moveHorizontal({byApi:!0},k,this.options.moveKeyEditModeAll),void p.f.stopEvent(t)}case 38:case 40:if(this.skipScrollEndEvent=!1,this.skipScrollStartEvent=!1,this.options.moveKeyEditMode){
k=38==t.keyCode?"up":"down";return this.moveVertical({},k,!0),void p.f.stopEvent(t)}case 33:case 34:case 35:case 36:case 9:T=!0;break;case 13:if(this.options.senseReader&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex)if((N=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"image"==N.options.inputType)for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_image")){var F=a.Z.getGlobalFunction(N.options.imageClickFunction,this.scope_id);"function"==typeof F&&F.call(this,this.getLastFocusedCell().focusedRowIndex,N.id,this.dataList.getCellData(this.getLastFocusedCell().focusedRowIndex,N.id))}if(this.options.senseReader&&null!=this.getLastFocusedCell().focusedColIndex)if((N=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"select"==N.options.inputType&&"ul"==N.options.tableRender)return this.setEditHtml(t),void p.f.stopEvent(t);T=!0;break;default:T=!1}if(1==T){var A=t.charCode?t.charCode:t.keyCode;if("false"==this.options.focusMove){if(!this.options.senseReader)return;if(9!=A){if(38!=A&&40!=A||!this.options.focusMoveByUpDownKey){if(35===A&&t.ctrlKey)return void this.focusToEnd();if(36===A&&t.ctrlKey)return void this.focusToStart();if(13==A){N=this.getCellInfo(this.focusedCell[0].focusedColIndex);if("enter"===this.options.drilldownToggle&&1==this.focusedCell.length&&N&&"drilldown"==N.options.inputType){var E=this.focusedCell[0].focusedRowIndex,M=this.dataList.getRealRowIndex(E);this.toggle(M)}}return}for(C=p.f.getTarget(t);C&&("TD"!=C.tagName||null==C.getAttribute(y));)C=C.parentNode;if(C){x=C.getAttribute(b);if("radio"!=(N=this.getCellInfo(x)).options.inputType)return}}}else if("true"==this.options.focusMove){var O=document.activeElement;if(O&&O.id===this.id+"_scrollX_right")return}}if(this.F2Mode)switch(t.keyCode){case 8:case 46:case 35:case 36:case 37:case 38:case 39:case 40:return}switch(t.keyCode){case 4:break;case 46:this.removeCellData(t),p.f.stopEvent(t);break;case 32:this.doDefaultAction(t);break;case 33:this.movePageUp(t),p.f.stopEvent(t);break;case 34:this.movePageDown(t),p.f.stopEvent(t);break;case 35:this.moveHorizontal(t,"end"),p.f.stopEvent(t);break;case 36:this.moveHorizontal(t,"home"),p.f.stopEvent(t);break;case 37:this.moveHorizontal(t,"left"),p.f.stopEvent(t);break;case 38:this.moveVertical(t,"up"),p.f.stopEvent(t);break;case 39:this.moveHorizontal(t,"right"),p.f.stopEvent(t);break;case 40:this.moveVertical(t,"down"),p.f.stopEvent(t);break;case 9:var N=this.getCellInfo(this.getLastFocusedCell().focusedColIndex);if(this.options.senseReader&&N&&"image"==N.options.inputType&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex){p.f.stopPropagation(t);for(e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match("w2grid_image"))if(p.f.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else(this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)||"linear"!=this.options.focusFlow)&&p.f.stopEvent(t)}}else if(p.f.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else{(("down"==this.options.tabKeyMove?this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode):"none"==this.options.tabKeyMove||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode))||"linear"!=this.options.focusFlow)&&p.f.stopEvent(t)}break;case 13:N=this.getCellInfo(this.focusedCell[0].focusedColIndex);var H=this.focusedCell[0].focusedRowIndex,G=this.focusedCell[0].focusedColIndex,W=!0===this.options.senseReader&&WebSquare.util.isIEAllVersion()&&(this.___getEditReadOnly(H,G)||this._getEditDisabled(H,G));if("enter"===this.options.drilldownToggle&&1==this.focusedCell.length&&N&&"drilldown"==N.options.inputType){E=this.focusedCell[0].focusedRowIndex,M=this.dataList.getRealRowIndex(E);this.toggle(M);break}
if(this.editMode||"autoComplete"!==N.options.inputType&&"select"!==N.options.inputType||!N.options.directOpen)if("edit"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove||"editDown"==this.options.enterKeyMove)this.setEditHtml(t);else if("none"==this.options.enterKeyMove);else if("right"==this.options.enterKeyMove){if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===N.options.inputType)if(!W)(B=this.getInput(N,this.focusedCell[0].focusedTd))&&B.blur();W||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)}else{var B;if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===N.options.inputType)if(!W)(B=this.getInput(N,this.focusedCell[0].focusedTd))&&B.blur();W||this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode)}else"autoComplete"===N.options.inputType&&(N.autoCompleteImageClicked=!0),this.setEditHtml(t);p.f.stopEvent(t);break;case 67:if("native"===this.options.copyType)break;if(t.ctrlKey||t.metaKey){if(a.Z.isIEAllVersion())this.handleCopyEvent({});else if(!a.Z.isIEAllVersion()&&(r.I.browserCheck.moz||r.I.browserCheck.chrome&&!this.options.preventCopy)&&a.Z.isExecCommandSupported()){var V=document.activeElement,q=document.createElement("textarea"),L=this,Y=document.getElementsByTagName("body")[0],Z=!!t&&t.shiftKey;q.oncopy=function(t){L.handleCopyEvent(t,Z),Y.removeChild(this),document.activeElement!=V&&V.focus()},q.textContent="temp",Y.appendChild(q),q.select();try{document.execCommand("copy")}catch(t){s.Y.printStackTrace(t,null,this)}}}else a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 88:if(t.ctrlKey||t.metaKey){if(a.Z.isIEAllVersion())this.handleCutEvent({});else if(!a.Z.isIEAllVersion()&&(r.I.browserCheck.moz||r.I.browserCheck.chrome)&&a.Z.isExecCommandSupported()){q=document.createElement("textarea"),L=this,Y=document.getElementsByTagName("body")[0],Z=!!t&&t.shiftKey;q.oncut=function(t){L.handleCutEvent(t,!1,Z),Y.removeChild(this)},q.textContent="temp",Y.appendChild(q),q.select();try{document.execCommand("cut")}catch(t){s.Y.printStackTrace(t,null,this)}}}else a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){p.f.stopEvent(t);break}this._doPaste()}else{a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}break;case 90:if(t.ctrlKey);else a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 27:"none"!=this.options.focusMode&&"linear"!=this.options.focusFlow&&(this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1),this.render.focus());break;case 16:case 17:case 18:case 21:case 229:case 25:case 91:case 20:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:break;case 65:if(this.options.useSelectAll&&t.ctrlKey){this.setFocusedMultiCell(0,0,this.getRowCount()-1,this.getColumnCount()-1);break}default:if(!t.ctrlKey&&!t.metaKey&&!t.altKey)a.Z.getBoolean(t.srcElement.getAttribute(v))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}}this.isKeyPressed=!1},b.prototype.handleOnfocus=function(t){if(this.getDataLength()>0&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){for(var e=null,i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.colIndexes.bodyColInfo.trIndexArr,s=o[this.defaultColCnt],r=0;r<i.length;r++){var a=i[r];if(!this.hiddenList[r]){for(var n=a.length-1;n>=0;n--){var l=a[n]-this.defaultColCnt;if(o[a[n]]<=s){
if(this.options.readOnlyTabIgnore&&this.___getEditReadOnly(0,l))break;if(this.options.ignoreNonEditableCell&&(this.___getEditReadOnly(0,l)||this._getEditDisabled(0,l)))break;e=l;break}}if(null!==e)break}}null!==e&&this._setFocusedCell(0,e)}},b.prototype.removeCellData=function(t){this.handleCutEvent(t,!0)},b.prototype.doDefaultAction=function(t){if("none"==this.options.focusMode){for(var e=p.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;e&&this.getCellInfo(e).doDefaultAction(t)}else this.getCellInfo(this.getLastFocusedCell().focusedColIndex).doDefaultAction(t)},b.prototype.setEditHtml=function(t){var e=p.f.getTarget(t);if(this.options.fastEditMode||"INPUT"==e.tagName||p.f.stopEvent(t),this.focusedCell.length>0){var i=this.focusedCell[this.focusedCell.length-1];null!=i.focusedTd&&this.setEditMode(i.focusedTd)}},b.prototype.getFirstTdTrIndex=function(t){for(var e=t.parentNode,i=a.Z.getDataPrefix("trIndex");"0"!=e.getAttribute(i);)e=a.Z.prev(e);return e},b.prototype.fixScrollRightDirection=function(){if(!0!==this.options.scrollXNative){var t=this.getLastFocusedCell(),e=this.getElementById(this.id+"_dataLayer").offsetWidth,i=this.getElementById(this.id+"_scrollX_right");if(t&&t.focusedTd){var o=t.focusedTd.offsetLeft,s=t.focusedTd.offsetWidth+1;a.Z.isFF()&&(s-=1),a.Z.isOpera()&&(s+=2);var r=o+s-e;if(this.options.lazyDrawHiddenColumn){var n=this.focusedCell[0].focusedTd;if("none"==n.style.display||r>0)if(this.options.scrollByColumn){for(var l=e-this.fixedWidth,h=0;h<this.columnOrder.length;h++)if(this.columnOrder[h]==t.focusedColIndex){m=h+this.defaultColCnt;break}var d=-1,u=0;a.Z.isOpera()&&(u=2);for(var p=m;p>=0;p--)if(!this.hiddenList[p]&&(l-=this.colWidthList[p])<0){d=p;break}p=0;for(this.fixedWidth>0&&(p=this.getFixedColumnLastIndex());p<=d;p++)this.hiddenList[p]||(u+=this.colWidthList[p]);this.scrollXPreventEndEdit=!0,i.scrollLeft=u,this._handleScrollX()}else{var c=a.Z.getDataPrefix("colIndex"),g=parseInt(n.getAttribute(c),10),f=0;a.Z.isOpera()&&(f=2);for(h=0;h<=g;h++)this.hiddenList[h]||(f+=this.colWidthList[h]);this.scrollXPreventEndEdit=!0,i.scrollLeft=f-e,this._handleScrollX()}}else if(r>0)if(this.options.scrollByColumn){l=e-this.fixedWidth;var m,y=t.focusedColIndex%this.columnOrder.length;for(h=0;h<this.columnOrder.length;h++)if(this.columnOrder[h]==y){m=h+this.defaultColCnt;break}for(d=-1,u=0,p=m;p>=0;p--)if(!this.hiddenList[p])if(0!=this.colIndexes.bodyColInfo.colSpanArr.length){if((l-=this.colWidthList[p]*(this.colIndexes.bodyColInfo.colSpanArr[p]?this.colIndexes.bodyColInfo.colSpanArr[p]:1))<0){d=p;break}}else if((l-=this.colWidthList[p])<0){d=p;break}p=0;for(this.fixedWidth>0&&(p=this.getFixedColumnLastIndex());p<=d;p++)this.hiddenList[p]||(0!=this.colIndexes.bodyColInfo.colSpanArr.length?u+=this.colWidthList[p]*(this.colIndexes.bodyColInfo.colSpanArr[p]?this.colIndexes.bodyColInfo.colSpanArr[p]:1):u+=this.colWidthList[p]);this.scrollXPreventEndEdit=!0,i.scrollLeft=u,this._handleScrollX()}else this.scrollXPreventEndEdit=!0,i.scrollLeft=i.scrollLeft+r,this._handleScrollX()}}},b.prototype.fixScrollLeftDirection=function(){if(!0!==this.options.scrollXNative){var t=this.getLastFocusedCell();if(t&&t.focusedTd){for(var e=a.Z.getDataPrefix("col_id"),i=t.focusedTd.getAttribute(e),o=this._getRealColIndex("body",i)+this.defaultColCnt,s=this.getElementById(this.id+"_scrollX_right"),r=0,n=this.getFixedColumnLastIndex();n<o;n++){if(!this.hiddenList[n])r+=this.colWidthList[n]}s.scrollLeft>r&&(this.scrollXPreventEndEdit=!0,s.scrollLeft=r,this._handleScrollX())}}},b.prototype.getLeftMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.dataList.getRowCount()||t<0)return i;for(var o=0;o<e.length-this.defaultColCnt;o++){var s=!1,r=this.getCellInfo(o);if(!0!==r.options.skipKeyMove){if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),
this.options.senseReader&&"radio"==r.options.inputType&&this.getCellData(t,o)!=r.options.trueValue){var a=this.getCheckedIndex(r.colID);a?s=a[0]!==t:0!=t&&(s=!0)}var n;if("custom"==r.options.inputType&&(n=r.cellManagerHashByRowIndex[this.dataList.getRealRowIndex(t)]),(this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))&&("user"==r.options.inputType||"link"==r.options.inputType||n&&"link"==n.options.inputType)){var l=this.data_td_list[o+(t-this.rowIndex)*this.oneRowDataLength];if(l){var h=l.getElementsByTagName("a");0==h.length&&(h=l.getElementsByTagName("input")),0!=h.length&&(s=!1)}else s=!1}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var d=this.dataList.getCellData(t-1,o),u=this.upperGroupingTest(t,o);d==this.dataList.getCellData(t,o)&&u&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o]&&!s){i=o;break}}}return i},b.prototype.getRightMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.getRowCount()||t<0)return i;for(var o=e.length-1-this.defaultColCnt;o>=0;o--){var s=!1,r=this.getCellInfo(o);if(!0!==r.options.skipKeyMove){if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==r.options.inputType&&this.getCellData(t,o)!=r.options.trueValue){var a=this.getCheckedIndex(r.colID);a?s=a[0]!==t:0!=t&&(s=!0)}var n;if("custom"==r.options.inputType&&(n=r.cellManagerHashByRowIndex[this.dataList.getRealRowIndex(t)]),(this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))&&("user"==r.options.inputType||"link"==r.options.inputType||n&&"link"==n.options.inputType))if(t<this.rowIndex)s=!0;else{var l=this.data_td_list[o+(t>=this.rowIndex?t-this.rowIndex:t)*this.oneRowDataLength],h=l.getElementsByTagName("a");0==h.length&&(h=l.getElementsByTagName("input")),s=0==h.length}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var d=this._dataList.getCellData(t-1,o),u=this.upperGroupingTest(t,o);d==this._dataList.getCellData(t,o)&&u&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o+this.defaultColCnt]&&!s){i=o;break}}}return i},b.prototype.moveHorizontal=function(t,e,i,o){if("false"==this.options.focusMove||"vertical"==this.options.focusMove){o=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return!1;if(9!=o)return!1}var s,r=this.getLastFocusedCell(),n=r.focusedRowIndex,l=r.focusedColIndex,h=(this.colIndexInfo.body.colInfo.colIndexArr,this._getRealColIndex("body",this.tdIdList[l])+this.defaultColCnt),d=this.colIndexInfo.body.colInfo.colIndexMatch,u=this.columnOrder,c=this.colIndexes.bodyColInfo.trIndexArr,g=c[l+this.defaultColCnt],f=!!t&&9==t.keyCode,m=!!t&&(9==t.keyCode||13==t.keyCode),y=!!t&&t.shiftKey,b=(e=e||"right",0==t||t&&!0===t.byApi);s=1==this.options.moveKeyEditModeAll&&b?!!o&&(37==o||39==o):!!t&&(37<=t.keyCode&&t.keyCode<=40),r.bTrIndex&&(g=r.bTrIndex);var v=null,w=n;if(this.options.focusMultiRow){if("left"==e)var C=h-1,I=this.defaultColCnt-1,_=-1;else if("right"==e)C=h+1,I=d.length,_=1;else if("home"==e)C=this.defaultColCnt,I=d.length,_=1;else C=d.length-1,I=this.defaultColCnt-1,_=-1;for(var x=C;x!=I;x+=_){var S=d[x];if(!this.hiddenList[x]){for(var R=S.length-1;R>=0;R--){var D=S[R]-this.defaultColCnt;if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,D)||this.cellMergeInfo[n+"_"+D])if(!0!==(k=this.getCellInfo(D)).options.skipKeyMove)if(c[S[R]]<=g&&("left"!=e&&"right"!=e||D!=l)){if((this.options.readOnlyTabIgnore||this.options.senseReader)&&this.___getEditReadOnly(n,D))break
;if(m&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,D)||this._getEditDisabled(n,D)))break;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[D]].options.colMerge){var T=this.dataList.getCellData(n-1,D),L=this.upperGroupingTest(n,D);if(T==(Y=this.dataList.getCellData(n,D))&&L)break}v=D;break}}if(null!==v)break}}}else{var k=this.getCellInfo(l),F=!1;this.options.senseReader&&"user"==k.options.inputType&&this.___getEditReadOnly(n,l)?F=!0:(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0);var A=this.getLocationRowCol(n,l),E=A.rowIndex,M=A.colIndex,O=this.htmlInfo.body.rowAttrArr.length;r.bMovedRow&&(E=r.bMovedRow);var N=E%O;if("left"==e)if(F&&this.focusedCellLinkIndex>0)C=M,I=u.length,_=1;else C=M-1,I=-1,_=-1;else if("right"==e)if(F&&this.focusedCellLinkIndex+1<this.focusedCellLinkLength)C=M,I=u.length,_=1;else{this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0;C=M+A.colSize,I=u.length,_=1}else if("home"==e){C=0,I=u.length,_=1;E-=N}else{C=u.length-1,I=0,_=-1;E=E+O-N-1}for(x=C;;x+=_){if(x==I)if("left"==e&&N>0)x=u.length-1,N--,E--;else{if(!("right"==e&&N<O-1))break;x=0,N++,E++}var H=this.getOriginalRowCol(E,x);if(!H.noLeftTop){_>0&&(_=H.colSize);D=H.colIndex;if(!this.hiddenList[x+this.defaultColCnt])if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,D)||this.cellMergeInfo[n+"_"+D])if(!(k=this.getCellInfo(D)).options.blockSelect&&!0!==k.options.skipKeyMove){if(this.options.senseReader&&"radio"==k.options.inputType&&this.getCellData(n,D)!=k.options.trueValue&&0!=n){if(this.getCheckedIndex(k.colID))continue;if(0!=n)continue}var G;if("custom"==k.options.inputType&&(G=k.cellManagerHashByRowIndex[this.dataList.getRealRowIndex(n)]),"left"!=e&&"right"!=e||(F||D!=l)){var W=!1;if(this.options.senseReader&&("user"==k.options.inputType||"link"==k.options.inputType||G&&"link"==G.options.inputType)){var B=this.data_td_list[D+(w-this.rowIndex)*this.oneRowDataLength],V=B.getElementsByTagName("a");if(0==V.length&&(V=B.getElementsByTagName("input")),"right"==e)for(var q=0;q<V.length;q++){if(document.activeElement==V[q]){this.focusedCellLinkIndex=q;break}this.focusedCellLinkIndex=-1}else if("left"==e)for(q=V.length-1;q>-1;q--){if(document.activeElement==V[q]){this.focusedCellLinkIndex=q;break}this.focusedCellLinkIndex=-1}V[0]&&("right"==e&&this.focusedCellLinkIndex!=V.length-1||"left"==e&&0!=this.focusedCellLinkIndex)&&(W=!0)}if(f&&this.___getEditReadOnly(n,D)&&(this.options.readOnlyTabIgnore||this.options.senseReader)){if(!("user"==k.options.inputType||"link"==k.options.inputType||G&&"link"==G.options.inputType)||!this.options.senseReader){if(!this.options.senseReader||"a"!==k._realInputType&&"button"!==k._realInputType)continue;v=D;break}if(!1===V)continue}if(this.___getEditReadOnly(n,D)||this._getEditDisabled(n,D))if(m&&(this.options.ignoreNonEditableCell||this.options.senseReader)){if(!f||1!=W)continue}else if(s&&(this.options.ignoreNonEditableCell||this.options.senseReader)){y=t&&t.shiftKey;if(!1===W&&!1===y)continue}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[D]].options.colMerge){var Y;T=this.dataList.getCellData(n-1,D),L=this.upperGroupingTest(n,D);if(T==(Y=this.dataList.getCellData(n,D))&&L&&""!==T&&""!==Y)continue}v=D;break}if(null!==v)break}}}}null===v&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0);var Z=!1;if(t&&t.shiftKey&&s&&(Z=!0),null!==v){if(i&&(this.___getEditReadOnly(w,v)||this._getEditDisabled(w,v))&&(i=!1),i&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){k=this.getCellInfo(v);a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setFocusedCell(n,v,i,{tabDirection:e,shifted:Z}),(r=this.getLastFocusedCell()).bTrIndex=g,r.bMovedRow=E,!0}if("linear"==this.options.focusFlow){if(n>0&&y&&!s){var j=this.getRightMostFocusableColIndex(n-1);if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&null==j)for(;n>=0&&null==j;){this._setGridBorderNoRefresh=!0
;var P=-1;this.hasSubtotal&&(P-=this.getHasSubtotalCount(n-1)),"true"!==this.options.keepScrollForSenseReader&&!0!==this._isBrowserScroll()&&this.addGridScroll(P),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(j=this.getRightMostFocusableColIndex(n-1)),null==j&&(n-=1)}else for(;n>=0&&null==j;)n-=1,j=this.getRightMostFocusableColIndex(n-1);if(null==j)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),n-1<this.rowIndex){this._setGridBorderNoRefresh=!0;P=-1;this.hasSubtotal&&(P-=this.getHasSubtotalCount(n-1)),!0!==this._isBrowserScroll()&&this.addGridScroll(P),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&null!=j&&"all"!=this.options.visibleRowNum&&(j=this.getRightMostFocusableColIndex(n-1))}return"custom"==(k=this.getCellInfo(j)).options.inputType&&n-1>=0&&(w=n-1),i&&(this.___getEditReadOnly(w,j)||this._getEditDisabled(w,j))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)&&a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1),this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,j,i,{tabDirection:e,shifted:Z}),this._setGridBorderNoRefresh=!1,!0}if("left"==e&&n>0&&!y){for(var z=this.getRightMostFocusableColIndex(n-1);n>0&&null==z;)n-=1,z=this.getRightMostFocusableColIndex(n-1);if(null==z)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(n-1>0&&n==this.rowIndex){this._setGridBorderNoRefresh=!0;P=-1;!0!==this._isBrowserScroll()&&this.addGridScroll(P),this._setGridBorderNoRefresh=!1}if(i&&(this.___getEditReadOnly(w,z)||this._getEditDisabled(w,z))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){k=this.getCellInfo(z);a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,z,i,{tabDirection:e,shifted:Z}),this._setGridBorderNoRefresh=!1,!0}if("right"!=e||y){if("left"===e&&0===n&&f&&l-1==0){!0===(k=this.getCellInfo(l-1)).options.skipKeyMove&&p.f.preventDefault(t)}}else{if(n<this.getDataLength()-this._getVisibleLastIndex(1)){for(z=this.getLeftMostFocusableColIndex(n+1);n!=this.dataList.getRowCount()&&null==z;)n+=1,z=this.getLeftMostFocusableColIndex(n+1);if(null==z)return this.editedCell&&this.editedCell.handleEndEdit(t),1==this.options.moveKeyEditModeAll&&n==this.dataList.getRowCount()&&document.getElementById(this.id+"_gridend_div").focus(),!1;var U=this._getVisibleLastIndex(this.lastIndex+1);if(n+1>this.rowIndex+U-1){this._setGridBorderNoRefresh=!0;P=1;this.hasSubtotal&&(P+=this.getHasSubtotalCount(n+1)),1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(P+=n-(this.rowIndex+U-1),this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),!0!==this._isBrowserScroll()&&this.addGridScroll(P),this._setGridBorderNoRefresh=!1}if(i)"custom"==(k=this.getCellInfo(z)).options.inputType&&(w=n+1),(this.___getEditReadOnly(w,z)||this._getEditDisabled(w,z))&&(i=!1);if(i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var k=this.getCellInfo(z);a.Z.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n+1,z,i,{tabDirection:e,shifted:Z}),this._setGridBorderNoRefresh=!1,!0}f&&!0===(k=this.getCellInfo(l+1)).options.skipKeyMove&&p.f.preventDefault(t)}}if(f&&null!=WebSquare.tabOrder[this.id])if(0===h&&0===n&&"left"==e){if(this.options.senseReader&&this.options.useStartEndDiv);else if(null!=WebSquare.tabOrder[this.id].preTabID&&(X=a.Z.getPreTabbableComp(this.id)))return X.focus(t),!0}else if(h===d.length-1&&n===this.getDataLength()-this._getVisibleLastIndex(1)&&"right"==e){var X
;if(this.options.senseReader&&this.options.useStartEndDiv);else if(null!=WebSquare.tabOrder[this.id].nextTabID)if(X=a.Z.getNextTabbableComp(this.id))return X.focus(t),!0}return this.editedCell?(this._setGridBorderNoRefresh=!0,this.editedCell.handleEndEdit(t),this._setGridBorderNoRefresh=!1):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(n,l,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!1},b.prototype.moveVertical=function(t,e,i){this.moveDirection="row";var o=this.getLastFocusedCell(),s=o.focusedRowIndex,r=o.focusedColIndex,n=this.getCellInfo(r).options.inputType,l=this.options.focusMoveByUpDownKey&&this.options.senseReader&&"radio"==n&&(38==t.keyCode||40==t.keyCode);if(("false"==this.options.focusMove||"horizontal"==this.options.focusMove)&&!l)return!1;var h,d=this.defaultColCnt,u=this.colIndexInfo.body.colInfo.colIndexArr,c=this.colIndexInfo.body.colInfo.colIndexMatch,g=this.colIndexes.bodyColInfo.trIndexArr,f=this.colIndexes.bodyColInfo.colSpanArr,m=this.colIndexes.bodyColInfo.rowSpanArr,y=u[r+d],b=g[r+d],v=f[r+d],w=m[r+d],C=r,I=s,_=(!!t&&t.keyCode,!!t&&9==t.keyCode);h=!!t&&(37<=t.keyCode&&t.keyCode<=40);var x=this.getDataLength()-this._getVisibleLastIndex(1),S=!1,R=!!(this.oneRowLength>1&&this.options.skipMultiRowMove);if(v&&o.bColIndex&&(y=o.bColIndex),"up"==e)var D=0==b?this.oneRowDataLength-1:r-1,T=-1,L=-1;else D=b+w==this.oneRowLength?0:r+1,T=this.oneRowDataLength,L=1;if(R){for(var k=m[0],F=(k=m[this.defaultColCnt],this.defaultColCnt+1);F<m.length;F++)if(k!=m[F]){R=!1;break}R&&(D=r)}var A=!1,E=!1;t&&t.shiftKey&&h&&(E=!0);for(F=D;F!=T;F+=L){var M=u[F+d],O=M+(f[F+d]?f[F+d]:1)-1,N=this._getArrayIndexOf(this.columnOrder,u[F+d]-d)+d;if(M<=y&&y<=O&&(!this.hiddenList[N]||A)){if(C=F,N=this._getArrayIndexOf(this.columnOrder,u[C]+1)+this.defaultColCnt,I==x&&"down"==e&&this.hiddenList[N]){A=!0,y++;continue}if(N=this._getArrayIndexOf(this.columnOrder,u[C]-1)+this.defaultColCnt,0==I&&"up"==e&&this.hiddenList[N]){A=!0,y--;continue}if("up"==e){for(var H=s;H>=0;H--)if(I=0==b?H-1:H,R&&(I=0==b?I:I-1),(!(this.hiddenRowObj.length>0)||this._getRowVisible(I))&&(!this.getMerged(I,C)||this.cellMergeInfo[I+"_"+C])){if(this.hiddenCellObj.length>0&&!1===this.getCellVisible(I,C))for(;!1===this.getCellVisible(I,C);){if(0===(V=g[C+this.defaultColCnt])&&I>0){I--;for(var G=!1,W=C+1+d;W<u.length;W++)if(u[W]===r+d&&g[W]===this.oneRowLength-1){C=W-d,G=!0;break}if(!G)break}else if(V>0){for(G=!1,W=C+d;W>=0;W--)if(u[W]===r+d&&g[W]===V-1){C=W-d,G=!0;break}if(!G)break}}if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(I,C))break;if(!this.options.ignoreNonEditableCell||!this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C))break;if(this.oneRowLength>1&&!R){var B=b;for(F=0;F<c[y].length;F++){if(0>--B&&(B=c[y].length-1,0!==b&&I--),C=c[y][B],I<0){P=!0;break}if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(I,C)){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}}}if(P){P=!1;break}}}else for(H=s;H<=x;H++)if(I=b+w==this.oneRowLength?H+1:H,R&&(I=b+w==this.oneRowLength?I:I+1),(!(this.hiddenRowObj.length>0)||this._getRowVisible(I))&&(!this.getMerged(I,C)||this.cellMergeInfo[I+"_"+C])){if(this.hiddenCellObj.length>0)for(;!1===this.getCellVisible(I,C);){var V;if((V=g[C+this.defaultColCnt])>=this.oneRowLength-1&&I<=x){I++;for(G=!1,W=d;W<u.length;W++)if(u[W]===r+d&&0===g[W]){C=W-d,G=!0;break}if(!G)break}else if(V<this.oneRowLength-1){for(G=!1,W=C+1+d;W<u.length;W++)if(u[W]===r+d&&g[W]===V+1){C=W-d,G=!0;break}if(!G)break}}if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C))break;if(E)break
;if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C))break;if(this.oneRowLength>1&&!R)for(B=b,F=0;F<c[y].length;F++){if(B++,c[y].length<=B&&(B=0,b+w!==this.oneRowLength&&I++),C=c[y][B],I>x){P=!0;break}if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}}if(P){P=!1;break}}break}}if(0<=I&&I<=x&&(s!=I||r!=C)){if(p.f.stopEvent(t),i&&(this.___getEditReadOnly(I,C)||this._getEditDisabled(I,C))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var q=this.getCellInfo(C);a.Z.getBoolean(q.options.skipKeyMoveEditMode)&&(i=!1)}if(this.setFocusedCell2(I,C,i,{tabDirection:e,shifted:E})){if((o=this.getLastFocusedCell()).bColIndex=y,l){var Y=this.tdIdList.length;this.data_td_list[(I-this.rowIndex)*Y+C].firstChild.click()}return!0}return!1}if("linear"==this.options.focusFlow){var Z=!1;if((-1==I&&"up"==e&&0==r||I==x+1&&"down"==e&&null==u[r+d+1]||-1==I&&"up"==e&&-1!==c[0].indexOf(r)&&R||I==x+1&&"down"==e&&-1!==c[this.columnOrder.length-1].indexOf(r)&&R)&&(Z=!0),!Z&&(-1==I||I==x+1)){var j=this.getLastFocusedCell().focusedTd;if("text"!=(q=this.getCellInfo(j)).options.inputType||!q.options.embeddedInput||t.shiftKey&&h){var P=!1;if("up"==e&&-1==I&&C-1>-1){for(var z=C-1;null!=u[z+d]&&(!R||-1===c[u[u.length-1]].indexOf(z));z--)if(N=this._getArrayIndexOf(this.columnOrder,z)+this.defaultColCnt,!this.hiddenList[N]){for(var U=x;U>-1;U--){if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(U,z)&&!this._getEditDisabled(U,z)){I=U,C=z,P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(U,z)&&!this._getEditDisabled(U,z)){I=U,C=z,P=!0;break}if(this.oneRowLength>1&&!R){I=U,C=z;var X=u[z+d];for(B=b,F=0;F<c[X].length;F++){if(0>--B&&(B=c[X].length-1),C=c[X][B],I<0){P=!0;break}if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}}}if(P)break}if(P)break}}else if("down"==e&&I==x+1)for(z=C+1;null!=u[z+d]&&(!R||-1===c[u[d]].indexOf(z));z++)if(N=this._getArrayIndexOf(this.columnOrder,z)+this.defaultColCnt,!this.hiddenList[N]){for(U=0;U<=x;U++){if(h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(U,z)&&!this._getEditDisabled(U,z)){I=U,C=z,P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(U,z)&&!this._getEditDisabled(U,z)){I=U,C=z,P=!0;break}if(this.oneRowLength>1&&!R){I=U,C=z;for(X=u[z+d],B=b,F=0;F<c[X].length;F++){if(B++,c[X].length<=B&&(B=0),C=c[X][B],h&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(I,C)&&!this._getEditDisabled(I,C)){P=!0;break}}}if(P)break}if(P)break}if(P){if(p.f.stopEvent(t),i&&(this.___getEditReadOnly(I,C)||this._getEditDisabled(I,C))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){q=this.getCellInfo(C);a.Z.getBoolean(q.options.skipKeyMoveEditMode)&&(i=!1)}return!!this.setFocusedCell2(I,C,i,{tabDirection:e,shifted:E})&&((o=this.getLastFocusedCell()).bColIndex=y,!0)}_&&WebSquare.tabOrder[this.id]&&WebSquare.tabOrder[this.id].nextTabID&&(S=!0)}else{var K=this.getInput(q,j);this.showFakeInput(K),this.fakeInput.setValue(K.getValue()),this.F2Mode=!1,
K.select()}}}return this.editedCell?this.editedCell.handleEndEdit(t):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(s,r,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!0===S&&"focusNextTabOrder"},b.prototype.moveEnd=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(var e=a.Z.getDataPrefix("colIndex");this._moveRight(t););for(var i=!1;!i;){for(var o=!0,s=this.getLastFocusedCell(),r=parseInt(s.focusedTd.getAttribute(e)),n=parseInt(s.focusedTd.getAttribute("colSpan")||1),l=0;l<n;l++)if(0==this.hiddenList[r+l]){o=!1;break}1==o?this._moveLeft(t):i=!0}this.fixScrollRightDirection()}},b.prototype.moveHome=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(var e=a.Z.getDataPrefix("colIndex");this._moveLeft(t););for(var i=!1;!i;){for(var o=!0,s=this.getLastFocusedCell(),r=parseInt(s.focusedTd.getAttribute(e)),n=parseInt(s.focusedTd.getAttribute("colSpan")||1),l=0;l<n;l++)if(0==this.hiddenList[r+l]){o=!1;break}1==o?this._moveRight(t):i=!0}this.fixScrollLeftDirection()}},b.prototype.movePageUp=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(this.rowIndex<=0)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e),this.focusedCell&&this.focusedCell.pop();var s,r=this._getScrollRowIndex(this.rowIndex);return(s=r<this.lastIndex?-1:this._getVisibleRowIndex(r-this.lastIndex))>=0?(this.setTopRowIndex(s),this._setFocusedCell(i+this.rowIndex,o)):(this.setTopRowIndex(0),this._setFocusedCell(0,o)),!0}}},b.prototype.movePageDown=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(null!=this.lastTopRowIndex&&this.rowIndex>=this.lastTopRowIndex)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e);var s=this.rowIndex+this.lastIndex,r=this.getDataLength(),a=r-this._getVisibleLastIndex(1),n=r-this._getVisibleLastIndex(this.lastIndex+1);return s<=n?(this.setTopRowIndex(s),this._setFocusedCell(Math.min(i+this.rowIndex,a),o)):(this.setTopRowIndex(n),this._setFocusedCell(a,o)),!0}}},b.prototype.findTd=function(t,e,i){for(var o=0,s=a.Z.getDataPrefix("colIndex");null!=t;){for(var r=a.Z.first(t);null!=r;){var n=parseInt(r.getAttribute(s));if(n<=e&&e<=n+r.colSpan-1&&o<=i&&i<=o+r.rowSpan-1)return r;if(n>e)break;r=a.Z.next(r)}if(t=a.Z.next(t),o>i)break;o++}},b.prototype.pasteFromClipboard=function(){for(var t=this.parseClipboardExcel(),e=this._getFocusedRowIndex(),i=this.getFocusedColumnIndex(),o=[],r=0;r<t.length;r++){o.push([]);for(var a=0;a<t[0].length;a++)o[r][a]=this.dataList._getCellData(r+e,this.getColumnID(a+i))}for(r=0;r<t.length;r++)for(a=0;a<t[0].length;a++){var n=t[r][a];try{n=n.wq_trim();var l=this.getCellInfo(a+i),h=this.mainGrid.getColumnOption(l.options.col_id,"dataType");"number"==h&&(n=n.replace(/[^(\-0-9)]/g,""))}catch(t){s.Y.printStackTrace(t,null,this)}1!=this.___getEditReadOnly(r+e,a+i)&&1!=this._getEditDisabled(r+e,a+i,!0)&&this.dataList.__setCellData(r+e,this.getColumnID(a+i),n)}var d=this;WebSquare.historyManager.set("grid","grid1",{focusRowIndex:e,focusColIndex:i,data2d:o},{onRestore:function(t){for(var o=t.data2d,s=0;s<o.length;s++)for(var r=0;r<o[0].length;r++){var a=o[s][r];d.dataList.__setCellData(s+e,this.getColumnID(r+i),a)}}})},b.prototype.parseClipboardExcel=function(){for(var t=[],e=window.clipboardData.getData("Text").split("\n"),i=0;i<e.length-1;i++){var o=e[i].split("\t");t.push(o)}return t},b.prototype.copyToClipboard=function(){var t=this.options.copyAmount;if(t||("cell"==this.options.focusMode?t="cell":"both"!=this.options.focusMode&&"row"!=this.options.focusMode||(t="row")),"cell"==t){for(var e=this.getDataLength(),i=this.getTotalCol(),o=[],s=0;s<this.focusedCell.length;s++){var r=(u=this.focusedCell[s]).focusedRowIndex,a=u.focusedColIndex;null==o[r]&&(o[r]=[]),
o[r][a]=u,e>r&&(e=r),i>a&&(i=a)}var n=[];for(s=e;s<o.length;s++){var l=[];if(void 0!==(p=o[s]))for(var h=i;h<p.length;h++){o[s][h]?l.push(this.dataList._getCellData(s,this.getColumnID(h))):l.push("")}n.push(l.join("\t"))}window.clipboardData.setData("Text",n.join("\n"))}else if("row"==t){var d=[];for(s=0;s<this.focusedCell.length;s++){var u;d[(u=this.focusedCell[s]).focusedRowIndex]=1}var p=[];for(var r in d)p.push(r);p.sort((function(t,e){return parseInt(t)>parseInt(e)?1:-1}));for(o=[],s=0;s<p.length;s++){r=p[s];var c=this.getRowData(r);o.push(c.join("\t"))}window.clipboardData.setData("Text",o.join("\n"))}},b.prototype.getEditCursorEnable=function(t,e){try{if(!t)return!1;var i=p.f.getTarget(t);if(!i)return!1;var o=i.tagName.toUpperCase();if(("INPUT"==o||"TEXTAREA"==o)&&null!=i.value){if(a.Z.isIEAllVersion("6 7 8")){var r=document.selection.createRange();if(r.text.length>0)return!0;r.moveStart("character",-i.value.length);var n=r.text.length;if("left"===e){if(n>0)return!0}else if("right"===e&&n<i.value.length)return!0;return!1}if(null!=i.selectionStart&&i.selectionStart!=i.selectionEnd)return!0;if("left"===e){if(i.selectionEnd>0)return!0}else if("right"===e&&i.selectionEnd<i.value.length)return!0}return!1}catch(t){return s.Y.printStackTrace(t,null,this),!1}},b.prototype._moveKeyEdit=function(t,e,i){try{if(void 0!==i&&null!=i||(i={}),!(this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.moveKeyEditMode))return;var o=this.uuid,r=WebSquare.idCache[t];r["_"+e]=r[e];var a=i.itemTable,n=i.skipVertical,l=i.skipHorizontal,h=this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.arrowMove;r[e]=function(t,i){this["_"+e]&&this["_"+e](t,i);var s=WebSquare.idCache[o],r=!1;if(s&&s.editedCell){var d=s.getCellInfo(s.editedCell.colID);(s.options.keyMoveEditMode||s.options.moveKeyEditMode||s.options.moveKeyEditModeAll)&&d.options.skipKeyMoveEditMode&&(r=!0);var u=!1;!r||"select"!=d.options.inputType&&"autoComplete"!=d.options.inputType&&"checkcombobox"!=d.options.inputType||(u=!0)}var c={37:"left",38:"up",39:"right",40:"down"}[t.keyCode];if(c)switch(c){case"left":case"right":if(!0!==l&&(a||0==this.getValue().length||h&&!s.getEditCursorEnable(t,c)))s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"&&s.moveHorizontal({byApi:!0},c,!0,t.keyCode),p.f.stopEvent(t);break;case"up":case"down":if(!0!==u&&!0!==n&&(!a||0==this.getItemCount()||this._keyIndex<0||this._keyIndex===this.getItemCount())){if(s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"){var g=!0!==r;s.moveVertical({},c,g,t.keyCode)}p.f.stopEvent(t)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},b.prototype._directEdit=function(t){var e=this.focusedCell[this.focusedCell.length-1],i=this.getCellInfo(e.focusedTd);if("textarea"!==i.options.inputType||!this._getEditDisabled(e.focusedRowIndex,e.focusedColIndex)&&!this.___getEditReadOnly(e.focusedRowIndex,e.focusedColIndex)){var o,s=i.comp,r=this.getInput(i);r&&(r.reFocus=!0,r._focusStatus="cancel");var a=s.render.tagName.toLowerCase();(o="input"===a||"textarea"===a?s.render:s.render.getElementsByTagName("input")[0])&&WebSquare.text.setCaretPos(o,o.value.length);var n=t.keyCode,l=null;t.key&&1===t.key.length?l=t.key:!t.shiftKey&&65<=n&&n<=90?(n+=32,l=String.fromCharCode(n)):l=n>=96||n<65?{96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"}[n+""]||"":String.fromCharCode(n),"autoComplete"===i.options.inputType?(s.dom.input.value=l,s.inputKeyDown(t)):r&&r.setValueNM(l)}};var v=i(467),w=i(4756),C=i.n(w),I=i(1304),_=function(t){};_.prototype.initializeDrawController=function(){this.data_td_list=[],this.data_num_td_list=[],this.data_status_td_list=[],this.all_data_td_list=[]},_.prototype.showAllBodyTR=function(t){t=t||"";for(var e=0;e<this.drawedRowLength;e++)this._setRowDisplay(e,t)
;this.lastDisplayedRow="none"===t?-1:this.drawedRowLength-1},_.prototype._setRowDisplay=function(t,e){for(var i=null,o=0;o<this.oneRowLength;o++)(i=this.dataRowList[this.oneRowLength*t+o])&&(i.style.display=e,"none"==e?this.__addClass(i,"w2grid_hidedRow"):this.__removeClass(i,"w2grid_hidedRow"));return i},_.prototype.drawColumnData=function(t,e){var i=this._dataList.rowPosition,o=!1;t=this.getColumnIndex(t);var s=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,r=this.getCellInfo(t);if(r.dataComp){var a=this.modelControl.getDataComp(r.dataComp);null!=a&&"linkedDataList"===a.initializeType&&null!=a.conditionInfo&&a.conditionInfo.filterInfo.useRef&&"number"==typeof i&&(o=!0)}for(var n=0;n<=s;n++){var l=n+this.rowIndex;e&&r.select&&r.hasRef&&(r.select.itemArr=r.getRefItemArr(l),r.select.setSelectOptions(),r.select.setValueNM(r.mainGrid._dataList._getData(l,t))||r.mainGrid._dataList._setData(l,t,"")),o&&n===i||this.drawCellData(n,l,t)}o&&this.drawCellData(i,i+this.rowIndex,t)},_.prototype._setMouseOverTr=function(t,e){this.setOverClass(e,"overTd",!0)},_.prototype._setMouseOutTr=function(t,e){this.setOverClass(e,"overTd",!1)},_.prototype.setOverClass=function(t,e,i){for(var o=t.parentNode,s=a.Z.getDataPrefix("trIndex"),r=a.Z.getDataPrefix("row_out_style"),n=parseInt(o.getAttribute(s));n>0;)n--,o=a.Z.prev(o);do{for(var l=a.Z.first(o);null!=l&&!(l.offsetLeft>this.render.offsetWidth);)l.offsetWidth>0&&(i?(l.setAttribute(r,l.style.cssText),l.style.cssText=l.style.cssText+";background-color:"+this.options.rowMouseOverColor):l.style.cssText=l.getAttribute(r)),l=a.Z.next(l);o=a.Z.next(o)}while(null!=o&&"0"!=o.getAttribute(s))},_.prototype.changeFocusedCellPosition=function(t,e,i,o){try{if(0==this.focusedCell.length)return;o=o||{};this.applyFocusedCellOut();for(var r=0;r<this.focusedCell.length;r++){var a=this.focusedCell[r].focusedRowIndex-t,n=this.focusedCell[r].focusedColIndex,l=null;if(this.options.focusDefaultColumn&&n<0&&this.defaultColCnt&&("row"===this.options.focusMode||"both"===this.options.focusMode))l=this.all_data_td_list[this.defaultColCnt+n+a*(this.oneRowDataLength+this.defaultColCnt)];else if(this.options.fixedRow>0&&this.options.fixedRow>this.focusedCell[r].focusedRowIndex||this.options.lastFixedRow>0&&this.focusedCell[r].focusedRowIndex>this.lastIndex-this.options.lastFixedRow)l=this.data_td_list[n+this.focusedCell[r].focusedRowIndex*this.oneRowDataLength],this.applyFocusedCellIn(l,e);else if(a<0||a>this.maxRowLength+this.hiddenRowObj.extraRow)l=null;else if(l=this.data_td_list[n+a*this.oneRowDataLength]){var h=this.getCellInfo(n);i&&h.options.embeddedInput&&(e=!1),this.applyFocusedCellIn(l,e,o)}this.focusedCell[r].focusedTd=l}}catch(t){s.Y.printStackTrace(t)}},_.prototype.setTRClass=function(t,e,i){for(var o=t.parentNode,s=a.Z.getDataPrefix("trIndex"),r=parseInt(o.getAttribute(s));r>0;)r--,o=a.Z.prev(o);do{for(var n=a.Z.first(o);null!=n;)i?this.addClass(n,e):this.removeClass(n,e),n=a.Z.next(n);o=a.Z.next(o)}while(null!=o&&"0"!=o.getAttribute(s))},_.prototype.setEditMode=function(t){try{var e=a.Z.getDataPrefix("tdIndex"),i=a.Z.getDataPrefix("col_id"),o=a.Z.getDataPrefix("colMerged"),n=t.getAttribute(i);if(null==n||""==n.wq_trim())return;var l,h=parseInt(t.getAttribute(e)),d=parseInt(h/this.realRowDataLength);if(this.options.fixedRow>0&&this.options.fixedRow>d)l=d;else if(this.options.lastFixedRow>0&&d>this.lastIndex-this.options.lastFixedRow){l=this.getDataLength()-1-(this.lastIndex-d)}else l=d+this.rowIndex;var u=a.Z.getBoolean(r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/colIdToColIndex/@value"))?this.getColumnIndex(t.getAttribute(i)):t.getAttribute(i),c=this.getCellInfo(u);if(!c.options.colMergeEdit&&"1"==t.getAttribute(o))return;if(c.options.embeddedInput||this.groupbyStatus.grouped)return;if("custom"===c.options.inputType&&!c.internal){var g=this.getRealRowIndex(l);if((m=c.cellManagerHashByRowIndex[g])&&m.options.embeddedInput)return}var f=this.__getEditReadOnly(t,l)
;if(f)return this.editMode=!1,void(c.options.showReadOnly&&(this.editMode=!0,c.showReadonly(t,l)));if(this._getEditDisabled(l,u))return this.editMode=!1,void(c.options.showReadOnly&&(this.editMode=!0,c.showReadonly(t,l)));if(0!=p.f.fireEvent(this,"onbeforeedit",l,u,this.dataList._getCellData(l,this.getColumnID(u)))&&null==this.editedCell)if(this.editMode=!0,this.setCellEditMode(t,l),c.comp)c.comp.setReadOnly(f);else if("custom"===c.options.inputType&&!c.internal){var m;g=this.getRealRowIndex(l);(m=c.cellManagerHashByRowIndex[g]).comp&&m.comp.setReadOnly(f)}}catch(t){s.Y.printStackTrace(t)}},_.prototype.getEditReadOnly=function(t,e){var i=a.Z.getDataPrefix("col_id"),o=t.getAttribute(i);return this._getEditReadOnly(e,o)},_.prototype.getReadOnly=function(){var t=a.Z.getBoolean,e=arguments[0];if("grid"==e||0==arguments.length)return t(this.options.readOnly);if("row"==e)return t(this.getRowReadOnly(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnReadOnly(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellReadOnly(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this._getEditReadOnly(o,i)}},_.prototype.setReadOnly=function(){try{var t=arguments[0];if(1==arguments.length||"grid"==t){var e=arguments[arguments.length-1],i=this.options.readOnly,o=a.Z.getBoolean(e);if("clear"==e?(this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],2===arguments.length?(o=!1,this.options.readOnly=o):3===arguments.length&&(o=a.Z.getBoolean(arguments[arguments.length-2]),this.options.readOnly=o)):this.options.readOnly=o,0!=this.getDataLength()&&(i!==o||"clear"===e)){var r=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex;for(var n in this.cellInfoHash){"clear"===e&&(this.cellInfoHash[n].options.readOnly="");var l=this.getColumnIndex(n);if(!isNaN(l)){for(var h=0;h<=r;h++)this.drawCellData(h,h+this.rowIndex,l);this.applyColumnStyleOptions(l)}}}this.options.readOnly?this.addClass(" w2grid_readonly_outer"):this.removeClass("w2grid_readonly_outer")}else"row"==t?this.setRowReadOnly(arguments[1],arguments[2]):"column"==t?this.setColumnReadOnly(arguments[1],arguments[2]):"cell"==t&&this.setCellReadOnly(arguments[1],arguments[2],arguments[3])}catch(t){s.Y.printStackTrace(t)}},_.prototype._getEditReadOnly=function(t,e,i){try{e=this.getColumnID(e);var o=this.getCellReadOnly(t,e,i),r=this.cellInfoHash[e];if(null==r)return;var n=a.Z.getBoolean;if(o+""!="")return n(o);var l=this.options.readOnlyPriority,h=r.options.readOnly,d=this.getRowReadOnly(t,i);return"column"==l&&""!==h?n(h):"row"==l&&""!==d?n(d):h+""=="true"||d+""=="true"||h+""!="false"&&d+""!="false"&&(this.options.readOnly+""!=""&&n(this.options.readOnly))}catch(t){s.Y.printStackTrace(t)}},_.prototype.__getEditReadOnly=function(t,e){var i=a.Z.getDataPrefix("col_id"),o=t.getAttribute(i);return this.___getEditReadOnly(e,o)},_.prototype.___getEditReadOnly=function(t,e,i){var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)?this.dataList.getRealRowIndex(t):this._getGroupbyDisplayRowIndex(t);return this._getEditReadOnly(o,e,i)},_.prototype.getDisabled=function(){var t=a.Z.getBoolean,e=arguments[0];if("grid"==e||null==e)return t(this.options.disabled);if("row"==e)return t(this.getRowDisabled(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnDisabled(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellDisabled(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this.getEditDisabled(o,i)}},_.prototype.setDisabled=function(t,e,i,o){try{for(var r=[t,e,i,o];r.length>0&&null==r[r.length-1];)r.pop();var n=r[0],l=1==r.length||"grid"==n,h=2==r.length&&"boolean"==typeof r[0]&&"boolean"==typeof r[1],d=a.Z.getDataPrefix("header_id");if(l||h){var u=l?r[r.length-1]:r[0];if((u=a.Z.getBoolean(u))!=this.options.disabled){this.options.disabled=u;var p=this.getElementById(this.id+"_dataLayer")
;!l&&u||(p.disabled=u),(h||!u&&p.disabledW2)&&(p.disabledW2=u),u?(this.addClass(p,"w2grid_disabled"),this.addClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowXHidden(),this.setOverflowYHidden())):(this.removeClass(p,"w2grid_disabled"),this.removeClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowX(),!0===this._isHybridScroll()?this.setScrollYHeightHybrid():this.setOverflowY()));for(var c=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),g=0;g<c.length;g++){var f=c[g].getAttribute(d),m=this.headerObj[f];m?m.setDisabled?m.setDisabled(u):m.render?m.render.disabled=u:m.disabled=u:c[g].disabled=u}for(var y in this.cellInfoHash){var b=this.cellInfoHash[y];b&&"checkbox"===b.options.inputType&&(""===b.options.disabled?(b._oriDisabled=b.options.disabled,b.options.disabled=u):""===b._oriDisabled&&(b.options.disabled=u));var v=this.getColumnIndex(y);this.drawColumnData(v),this.applyColumnStyleOptions(v)}}return u}"row"==n?this.setRowDisabled(r[1],r[2]):"column"==n?this.setColumnDisabled(r[1],r[2]):"cell"==n&&this.setCellDisabled(r[1],r[2],r[3])}catch(t){s.Y.printStackTrace(t)}},_.prototype.getEditDisabled=function(t,e,i){return this._getEditDisabled(this._getGroupbyGroupedRowIndex(t),e,i)},_.prototype._getEditDisabled=function(t,e,i){try{var o=-1,r="";"number"==typeof e?(o=e,r=this.cellIdList[e]):(o=this.bodyIdColIndexMap[e],r=e);var a=-1;if(!0===i)a=t;else if(this._linkedDataList)a=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var n=!0;for(var l in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[l]){a=this._dataList.filteredRowIndexArr[t],n=!1;break}n&&(a=this.groupbyStatus.groupedRowIndexArr[t])}else a=this._dataList.filteredRowIndexArr[t];var h=this.cellInfoHash[r]||{options:{}},d=this.cellDisabledArr[a*this.oneRowDataLength+o];if(!0!==d&&!1!==d){var u=h.options.disabled,p=this.rowDisabledArr[a],c=this.options.disabledPriority;!0!==p&&!1!==p&&(p=""),d="column"===c&&""!==u?u:"row"===c&&""!==p?p:u+""=="true"||p+""=="true"||u+""!="false"&&p+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}return d}catch(t){s.Y.printStackTrace(t)}},_.prototype.getElemRowIndex=function(t){var e=a.Z.getDataPrefix("tdIndex"),i=parseInt(t.getAttribute(e));return parseInt(i/this.realRowDataLength)+this.rowIndex},_.prototype.notifyDataChanged=function(t){try{if("active"!=this.activeStatus)return;void 0!==t&&null!=t||(t={}),this.initHeightCompleted=!1,this.checkResize();var e=t&&t.append||!1,i=t&&t.keepTop||!1,o=t&&t.refreshScroll||!1,r=t&&t.refreshInstance||!1,a=i&&this.rowIndex>=0?this.rowIndex:0,n=t&&!0===t.gridData,l={sortIcon:this.options.hideSortIconOnNoData};if(this.delayedDraw({rowIndex:a}))return!0===r&&this._refreshInstance(void 0,e),void this.changeCount++;if(this._mergeRefresh(),!0===this._isBrowserScroll())return t.sync=!i,this.changeCount++,this._refreshDataChanged(t);var h=this._setGridBorderNoRefresh||!1;if(this._setGridBorderNoRefresh=!0,this.options.senseReader&&this.rowIndex<=0)return this.changeCount++,this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),o&&"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(void 0,l),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),this._setGridBorderNoRefresh=h,!0===r&&this._refreshInstance(void 0,e),void this.refreshAdaptive({simple:!0});if(e&&!this.loadFlag)return this.drawFooter(),this.drawHeader(void 0,l),void(!0===r&&this._refreshInstance(void 0,e));if(this.changeCount++,!0===e&&"true"===this.options.keepScrollForSenseReader&&!0===this.options.senseReader&&this.options.visibleRowNum>0)var d=this.drawDataTable(0,{keepScrollTop:!0});else d=this.drawDataTable(0);for(var u in o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),0==d&&(e&&!o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),
this.hiddenCellObj.length>0?(this.rowIndex=a,!0!==n&&this._setCellVisibleRefresh()):this.drawData(a)),this.displayNoResultMessage(),this.displayFixedColumnLine(),this.drawFooter(),this.drawHeader(void 0,l),this._setGridBorderNoRefresh=h,this.refreshAdaptive({simple:!0}),this.cellInfoHash)this.cellInfoHash[u].refreshCell();if(this.hasCustomInputType)for(var p=0;p<this.cellIdList.length;p++){var c=this.cellInfoHash[this.cellIdList[p]];c&&c.options&&"custom"===c.options.inputType&&c.options.typeGetter&&c.refreshCellManagerHash()}!0===r&&this._refreshInstance(void 0,e)}catch(t){s.Y.printStackTrace(t)}},_.prototype.notifyCellChanged=function(t,e,i,o){if(this.changeCount++,!this.delayedDraw({})){var s=this._getTrRowIndex(t);if(e=this.getColumnIndex(e),this._drawRowStatus(s,t),this._drawCellStatus(s,t,e),!0!==i&&(this.drawCellData(s,t,e),this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex)){for(var r=t+1,n=s+1;"number"==typeof this.groupbyStatus.groupedRowIndexArr[r]&&r<this.groupbyStatus.groupedRowIndexArr.length;)r++,n++;if("object"===(0,l.A)(this.groupbyStatus.groupedRowIndexArr[r])&&"footer"===this.groupbyStatus.groupedRowIndexArr[r].type){var h=this.dataList.getRealRowIndex(r);if(null!=h){var d=this.all_data_td_list[n*this.realRowDataLength];d&&this.drawGroupData(d,h,n)}}}var u=this.getColumnID(e);this._refreshExpression(t,u);var p=this.labelColumnAssArr[u];if(null!=p)for(var c=0;c<p.length;c++){var g=this.getColumnIndex(p[c]);this.drawCellData(s,t,g)}this.displayNoResultMessage(),this.hasSubtotal&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex)),this.drawFooter(u),this.drawHeader(u),o||this._setCheckboxHead(u),"never"!==this.options.mergeCellsFixedCols&&a.Z.setTimeout((function(){var t={fixedCols:!0,fixedRows:!1};this._mergeCells(this.options.mergeCellsFixedCols,t,{type:"mergeCellsFixedCols"})}),{key:this.id+"notifyCellChanged_mergeRefresh",caller:this,delay:200})}},_.prototype._getTrRowIndex=function(t){try{var e=t;if(this.rowIndex>=0){var i=this.getDataLength();this.options.fixedRow>0&&this.options.fixedRow>t||(this.options.lastFixedRow>0&&e>=i-this.options.lastFixedRow?e=this.lastIndex-(i-1-e):e-=this.rowIndex)}return e}catch(t){s.Y.printStackTrace(t)}},_.prototype._refreshExpression=function(t,e){try{var i=this._getTrRowIndex(t),o=this.expressionAssArr[e];if(null!=o){var r=this.searchExpression(o);for(var a in r){var n=this.getColumnIndex(a);this.drawCellData(i,t,n),this.drawFooter(n),this.drawHeader(n)}}}catch(t){s.Y.printStackTrace(t)}},_.prototype.searchExpression=function(t){for(var e={},i=[t];i.length>0;)for(var o=i.pop(),s=0;s<o.length;s++)if(e[o[s]]=!0,this.expressionAssArr[o[s]]){var r=this.expressionAssArr[o[s]];if(r.length>1)i.push(r);else null!=this.expressionAssArr[r]&&i.push(r),e[r]=!0}return e},_.prototype.notifyRowChanged=function(t,e){if(this.changeCount++,!this.delayedDraw({rowIndex:t})){if(!0===this._isBrowserScroll())return this._refreshDataChanged(e);var i={sortIcon:this.options.hideSortIconOnNoData};if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(void 0,i),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),void this.refreshAdaptive({simple:!0});if(-1==this.rowIndex)this.drawDataTable(0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(e&&!0===e.keepScrollTop)this.lastTopRowIndex=null,this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0});else{this.lastTopRowIndex=null;var o=this._dataList.options.depthColumn?this.getDrawCount()+this.rowIndex:this.getDataLength(),s=(t=t||this.rowIndex)-this.rowIndex,r=this.rowIndex;if(0<=s&&s<=this.lastIndex&&(this.rowIndex<=0||this.rowIndex+this.lastIndex<o))if(this.isDrillDown&&!this.drilldown.isOpen(t)){
var n=("linkedDataList"===this.drilldown.mode?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr).length-(t+1),l=this.lastIndex-s-n;r=h=l<=0?this.rowIndex:(h=this.rowIndex-l)>0?h:0}else r=this.rowIndex;else if(0<=s&&s<=this.lastIndex||s<0){var h;(h=this.rowIndex-1)+this.lastIndex>=o&&(h=o-this.lastIndex-1),r=h=h>0?h:0}this.hiddenCellObj.length>0?(this.rowIndex=r,a.Z.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200})):this.drawData(r,0)}this.displayNoResultMessage(),this.displayFixedColumnLine(),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader(void 0,i),this.refreshAdaptive({simple:!0})}},_.prototype.notifyRowInserted=function(t){if(t=parseInt(t,10),this.changeCount++,!this.delayedDraw({rowIndex:t})){if(!0===this._isBrowserScroll())return this._refreshDataChanged();var e={sortIcon:this.options.hideSortIconOnNoData};if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(void 0,e),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),void this.refreshAdaptive({simple:!0});if(this.lastTopRowIndex=null,-1==this.rowIndex)0==this.drawDataTable(0)&&this.drawData(0,0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(""!==this.options.visibleRowNum||this.options.initFixedHeightByRowNum>0)this.setDataTable(),this.drawData(0);else{var i=t-this.rowIndex,o=this.getElementById(this.id+"_scrollY_div");if(i<0){var s=this.getElementById(this.id+"_scrollY_div");this.scrollEvent=!1,s.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0)}else(o.offsetHeight>=o.scrollHeight||i<=this.lastIndex)&&(this.hasSubtotal&&(i=0),this.drawData(this.rowIndex,i))}0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight();var r=this._getVisibleLastIndex(this.lastIndex+1);if(this.rowIndex+r-1<t){this.scrollEvent=!1,(s=this.getElementById(this.id+"_scrollY_div")).scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t);var n=this._getEpsilon(),l=Math.round(s.scrollTop)+n,h=this._getVisibleRowIndex(parseInt(l/this.oneRowScrollHeight));this.hiddenCellObj.length>0?(this.rowIndex=h,a.Z.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200}),this.lastTopRowIndex=null):this.drawData(h)}this.displayNoResultMessage(),this.displayFixedColumnLine(),this.drawFooter(),this.drawHeader(void 0,e),this.refreshAdaptive({simple:!0})}},_.prototype.makeNoResultMessage=(0,v.A)(C().mark((function t(){var e,i,o,r,a,n,l;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=document.getElementById(this.id+"_noresult"),i=this.options.noResultMessageURL,o=this.getOriginalID(),r=o+"_noResultMessageFrame",WebSquare.util.getComponentById(r,this.scope_id)){t.next=15;break}return a=this.options._scope_obj_uuid,!0,n={className:"noResultDiv",scope:"true",pluginName:"wframe",src:i,preload:!0},l=I.o.create(r,n,null,this.scope_obj,a,true),t.next=12,I.o.initAsync();case 12:l.writeTo(e),l.activate(),this.addControl(l);case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),s.Y.printStackTrace(t.t0);case 20:case"end":return t.stop()}}),t,this,[[0,17]])}))),_.prototype.calculateBottomFilterBoxHeight=function(t){try{var e=document.getElementById(this.id+"_foot_table"),i=t?t.offsetHeight:0,o=document.getElementById(this.id+"_main_div");if(e){if(!t||"function"!=typeof t.getBoundingClientRect||!o||"function"!=typeof o.getBoundingClientRect)return i;i+=(t.getBoundingClientRect().top||0)-(o.getBoundingClientRect().bottom||0)}return i}catch(t){s.Y.printStackTrace(t)}},_.prototype.createWrapperDiv=function(t,e){try{var i=document.createElement("div"),o=this.id+"_noresult_wrapper",r=document.getElementById(this.id+"_noresult");t=t||0,
e=e||0;var a=this._groupbyFilterBoxObj(t,e);return t=a.topHeight,e=a.bottomHeight,i.style.top=t+"px",i.style.bottom=e+"px",i.id=o,i.classList.add("w2grid_noresult_wrapper"),r.parentNode.insertBefore(i,r),i.appendChild(r),i}catch(t){s.Y.printStackTrace(t)}},_.prototype._getGroupZoneHeight=function(){try{var t=0;return this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(t=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),t}catch(t){s.Y.printStackTrace(t)}},_.prototype._groupbyFilterBoxObj=function(t,e){try{var i={topHeight:t,bottomHeight:e},o=document.getElementById(this.id+"_groupbyFilterBox_div");if(o&&this.options.groupbyFilterBox&&this.options.groupbyFilterBoxLocation){var r=o.offsetHeight;"top"===this.options.groupbyFilterBoxLocation?i.topHeight+=r-2:"bottom"===this.options.groupbyFilterBoxLocation&&(i.bottomHeight+=this.calculateBottomFilterBoxHeight(o))}return i}catch(t){s.Y.printStackTrace(t)}},_.prototype.displayNoResultMessage=function(){try{var t="removed"!==this.options.noResultMessageExclude||0==this.removed,e=document.getElementById(this.id+"_noresult");if(e&&this.options.noResultMessageVisible&&t&&0==this.initFlag&&0==this.getDataLength()){var i=document.getElementById(this.id+"_main_div"),o=i.offsetHeight,r=document.getElementById(this.id+"_body_table"),a=this.options.noResultMessageCenter||this.options.useNoResultMessageURL?r.offsetHeight:r.offsetHeight+3,n=document.getElementById(this.id+"_foot_table"),l=0;n&&(l=n.offsetHeight);var h=o-a-l;if(!0!==this.options.useNoResultMessageURL){var d=document.getElementById(this.id+"_noresult");e.innerHTML=this.options.noResultMessage,e.style.display="block";var u=parseInt(WebSquare.style.getStyle(d,"margin-top"),10)||0,p=parseInt(WebSquare.style.getStyle(d,"margin-bottom"),10)||0,c=d.offsetHeight+u+p,g=document.getElementById(this.id+"_scrollX_div").offsetHeight;if(h<=0);else if(h<=c)d.style.top=a+u+"px",this.setSize(i,a+l+c+g+u+p);else{var f=document.getElementById(this.id+"_head_table"),m=0;if(f&&f.childNodes)for(var y=0;y<f.childNodes.length;y++)"string"==typeof f.childNodes[y].tagName&&"TR"===f.childNodes[y].tagName.toUpperCase()&&m++;if(this.options.noResultMessageCenter){var b=this._getGroupZoneHeight(),v=this.id+"_noresult_wrapper",w=document.getElementById(v);if(!w){var C=a+b,I=l+g;w=this.createWrapperDiv(C,I)}this.options.noResultMessageStylePriority||d.classList.add("w2grid_noresult_message_default")}else if((m>1||this.options.groupbyZone)&&!this.options.noResultMessageStylePriority){var _;_=this._noResultMessageDivTop.indexOf("px")>0?o-parseInt(this._noResultMessageDivTop):o*parseInt(this._noResultMessageDivTop)/100;b=0;this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(b=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),d.style.top=parseInt(m*this.oneRowHeight/2+_)+b+"px"}}}else{var x=this.makeNoResultMessage(),S=this.id+"_noresult";x.then(function(t){if(0===this.getDataLength()){var e=document.getElementById(S);if(e)if(document.getElementById(this.id+"_main_div").offsetHeight>0){var i=document.getElementById(this.id+"_body_table"),o=this.options.noResultMessageCenter||this.options.useNoResultMessageURL?i.offsetHeight:i.offsetHeight+3,s=document.getElementById(this.id+"_foot_table"),r=s?s.offsetHeight:0;o+=this._getGroupZoneHeight();var a=this._groupbyFilterBoxObj(o,r);o=a.topHeight,r=a.bottomHeight,e.style.top=o+"px",e.style.bottom=r+"px",e.style.display=""}}}.bind(this))}}else e.style.display="none";this.removed=!1,this.delayedDrawObj||this.removeAllFinish||(this.initFlag=!1)}catch(t){s.Y.printStackTrace(t)}},_.prototype.displayFixedColumnLine=function(){try{if(!this.options.fixedColumnLineDiv)return;var t,e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_head_table").offsetHeight,r=this.getRowCount(),n=this.getElementById(this.id+"_fixedColumnDiv"),l=Math.min(e.offsetHeight,i.offsetHeight);if(this.options.fixedColumn>0){
var h=this.getElementById(this.id+"_scrollX_left"),d=parseInt(a.Z.getStyleProperty(n,"border-right-width"),10)||0;"tbody"===this.options.fixedColumnLineDivStart?(t=0==r?0:l-o,n.style.top=o+"px"):t=0==r?o:l;var u=h.offsetWidth;n.style.left=u-(d-1)/2+"px",n.style.height=t+"px",n.style.display="block"}else n.style.display="none";var p=this.getElementById(this.id+"_fixedRightColumnDiv");if(this.options.fixedRightColumn>0){var c=this.getElementById(this.id+"_scrollX_fixedRight");d=parseInt(a.Z.getStyleProperty(p,"border-right-width"),10)||0;"tbody"===this.options.fixedColumnLineDivStart?(t=0==r?0:l-o,p.style.top=o+"px"):t=0==r?o:l;u=e.offsetWidth-c.offsetWidth;p.style.left=u-(d-1)/2-1+"px",p.style.height=t+"px",p.style.display="block"}else p.style.display="none"}catch(t){s.Y.printStackTrace(t)}},_.prototype.delayedDraw=function(t){return(0==this.resizeObj.width||0==this.resizeObj.height)&&(this.delayedDrawObj||(this.delayedDrawObj={}),this.delayedDrawObj.redraw=!0,t.hasOwnProperty("rowIndex")?this.delayedDrawObj.rowIndex=t.rowIndex:t.hasOwnProperty("subTotalVisible")?this.delayedDrawObj.subTotalVisible=t.subTotalVisible:t.hasOwnProperty("newColumnOrder")?this.delayedDrawObj.newColumnOrder=t.newColumnOrder:t.hasOwnProperty("columnNodeset")&&(this.delayedDrawObj.columnNodeset={colIndex:t.columnNodeset.colIndex,nodeset:t.columnNodeset.nodeset,label:t.columnNodeset.label,value:t.columnNodeset.value}),!0)},_.prototype.delayedAction=function(){this.startedDisplayNone=!1,this.setPreAction(),this.getRowCount&&this.getRowCount()>0&&this.notifyDataChanged(),this.options.focusOnSetData&&this._setFocusedCell(0,0);var t=WebSquare.BootLoader.fullViewed||!1,e=a.Z.fullViewed||!1;t||e||this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),a.Z.isMobile()&&this.options.fixAdaptive||this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),this.delayedDrawObj=null,this.initFlag=!1},_.prototype.setRedrawStatus=function(t){if(!this.startedDisplayNone||"stop"!=t)if("stop"==t)this.delayedDrawObj||(this.delayedDrawObj={});else{this.setDataLayerPosition(),this.scrollX_right.scrollLeft=this.resizeObj.scrollLeft,this.getElementById(this.id+"_scrollY_div").scrollTop=this.resizeObj.scrollTop,this.handlerResize_drawInitializer(),this._handleScrollX();for(var e=!1,i=0;i<this.colWidthList.length;i++)if(this.colWidthList[i].toString().indexOf("*")>-1){e=!0;break}if((this.options.autoFit||e)&&this.autoFitFunc(),this.delayedDrawObj.redraw){this.lastTopRowIndex=null,this.setDataTable(),this.setTrRowTable(),this.setColIndexInfo();var o=this.delayedDrawObj.rowIndex||0,s=o,r=this.getDataLength();if(r-this.drawedRowLength<s&&(s=r-this.drawedRowLength)<0&&(s=0),"all"!==this.options.visibleRowNum)for(;this.hiddenRowObj.extraRow<this.hiddenRowObj.length;)this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.extraRow);if(!0===this._isHybridScroll())this._drawDataHybrid(s,{redraw:!0}),null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal&&this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible);else{this.drawData(s),null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal?this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible):this.setScrollYHeight();var a=this.rowIndex+this.lastIndex,n=this._getScrollRowIndex(o);if(a<o||n<o){this.scrollEvent=!1;var l=this.getElementById(this.id+"_scrollY_div");l.scrollTop=this.oneRowScrollHeight*n;var h=this._getVisibleRowIndex(parseInt(l.scrollTop/this.oneRowScrollHeight));this.drawData(h)}}this.drawFooter(),this.drawHeader(),this.displayNoResultMessage(),this.displayFixedColumnLine();var d="never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols;for(var u in d||(this._mergeRefresh(),
this.dynamicMergeHTML()),this.cellInfoHash)this.cellInfoHash[u].refreshCell();if(this._drawGroupbyZone(),void 0!==this.delayedDrawObj.newColumnOrder&&this.delayedDrawObj.newColumnOrder.length>0&&this.setColumnOrder(this.delayedDrawObj.newColumnOrder),void 0!==this.delayedDrawObj.columnNodeset){var p=this.delayedDrawObj.columnNodeset;this.setColumnNodeSet(p.colIndex,p.nodeset,p.label,p.value)}}this._setVisibleRowNumFix(),this.delayedDrawObj=null,this.initFlag=!1,0===this.getDataLength()&&this.displayNoResultMessage()}},_.prototype._refreshDataChanged=function(t){try{void 0!==t&&null!=t||(t={}),this._hybridRefreshCnt++;var e={sortIcon:this.options.hideSortIconOnNoData};this.setDataTable();var i=t.keepTop||t.keepScrollTop||!0===this._isHybridScroll();if(!0!==i&&this.drawData(0),this.drawFooter(),this.drawHeader(void 0,e),this.displayNoResultMessage(),t.refreshInstance&&this._refreshInstance(void 0,t.append),!0===i){var o=this.uuid;!0===t.sync||this._hybridRefreshCnt<this._hybridRefreshMax?(!0===t.sync?this._hybridRefreshCnt=0:(this._hybridRefreshCnt++,a.Z.setTimeout((function(){WebSquare.idCache[o]._hybridRefreshCnt=0}),{key:this.id+"_refreshDataChanged_reset",delay:100})),this._refreshScrollYHybrid(t)):a.Z.setTimeout((function(t){var e=WebSquare.idCache[o];e._refreshScrollYHybrid(t),e._hybridRefreshCnt=0}),{key:this.id+"_refreshDataChanged",delay:50,args:[t]})}else this._autoFitRefreshNative();return void this.refreshAdaptive({simple:!0})}catch(t){s.Y.printStackTrace(t)}};var x=function(){};x.prototype.setScrollYHeight=function(t){if(!0!==this._isNativeScroll()){if(!0===this._isHybridScroll())return this.setScrollYHeightHybrid(t);void 0!==t&&null!=t||(t={});var e=this.getDataLength(),i=this.rowIndex,o=!0===t.noDraw,s=!0===t.keepScrollTop,n=this.getElementById(this.id+"_size_y"),l=this.getElementById(this.id+"_scrollY_div"),h=n.parentNode.offsetHeight;0==h&&(h=parseInt(this.getStyle("height")));var d=this._getScrollRowIndex(i);if(-1==i||0==d&&d+this._getVisibleLastIndex(this.lastIndex+1)==e){var u=!0;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var p=this.drawedSubtotal[this.drawedSubtotal.length-1];p.length>0&&(p.rowIndex+1!=e||"none"===p[p.length-1].style.display||this._getLastSubtotalCount()>this.drawedSubtotal.length)&&(u=!1)}else this.hasSubtotal&&0==this.drawedSubtotal.length&&this.lastSubtotalRow&&e>0&&(u=!1);if(u)return"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),void(0!==n.offsetHeight&&(n.style.height="0px",this.handlerResize_drawInitializer()))}var c=l.scrollTop;if(!0!==t.skipResize){var g;if("number"==typeof t.restRowCnt)g=t.restRowCnt;else if(""!==this.options.visibleRowNum)this.options.senseReader&&"all"===this.options.visibleRowNum||this.isDrillDown?g=e-(this.lastIndex+1):(g=e-this.drawedRowLength,this._dynamicVisibleRowNum>0&&(g=e-this._dynamicVisibleRowNum),this.options.initFixedHeightByRowNum>-1&&(g+=this._getLastSubtotalCount())),g<0&&(g=0),g=Math.max(0,g-this._getHiddenRowCount());else if(this.lastTopRowIndex&&this.lastTopRowIndex>0)g=this._getScrollRowIndex(Math.ceil(this.lastTopRowIndex));else{var f=this.getElementById(this.id+"_head_table"),m=this.dataLayerHeight-f.offsetHeight,y=parseInt(m/this.oneRowHeight),b=this.drawedRowLength;this.oneRowLength>1&&(b=Math.ceil(this.drawedRowLength/this.oneRowLength)),y+(this.isMobile?0:1)<b&&(b=y+(this.isMobile?0:1)),g=this.options.fixHeight||this.hasSubtotal?0===i?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-y>1?e-y:1:this.options.senseReader?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-b+1>1?e-b+(this.isMobile?0:1):1,g=Math.max(0,g-this._getHiddenRowCount())}var v=h+this.oneRowScrollHeight*g;if(v>r.I.domMaxHeight&&this.oneRowScrollHeight>1&&(this.oneRowScrollHeight=Math.max(Math.floor((r.I.domMaxHeight-h)/g),1),v=h+this.oneRowScrollHeight*g),h=l.offsetHeight,
v<=1e6&&"table"!=n.tagName.toLowerCase())n.style.height=v+"px";else if(v<=1e6)l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,(n=this.getElementById(this.id+"_size_y")).style.height=v+"px";else if(r.I.browserCheck.ieAllVersion&&!this.isIE6or7||a.Z.isSpartan()){var w=[];for(w.push("<table id='"+this.id+"_size_y' style='border-collapse:collapse; border-spacing:0px;height:0px; position:absolute; top:0px; left:0px; width:18px'><tbody>");v>1e6;)w.push("<tr style='height:1000000px'><td></td></tr>"),v-=1e6;w.push("<tr style='height:"+v+"px'><td></td></tr></tbody></table>"),l.innerHTML=w.join(""),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")}else"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),r.I.browserCheck.moz?n.style.height=v+1+"px":n.style.height=v+"px"}else h=l.offsetHeight;if(!0!==t.skipScrollEnd){var C=n.offsetHeight;C<1e6&&(C=parseInt(n.style.height,10));var I=C-h,_=this._getEpsilon(),x=Math.min(Math.round(c)+_,I),S=this._getScrollMaxRowIndex();if(S>e-this._getHiddenRowCount())this._applyScrollEnd(S,{noDraw:!0});else{var R=this.options.syncWithScrollTrack?Math.ceil:Math.floor;if(I>=0&&R.call(this,x/this.oneRowScrollHeight)!=this._getScrollRowIndex(i)){this.lastTopRowIndex&&this.lastTopRowIndex==i&&(i=this.lastTopRowIndex+1);var D=this._getScrollRowIndex(i);o&&l.scrollTop!=this.oneRowScrollHeight*D&&(this.scrollEvent=!1),x=Math.min(this.oneRowScrollHeight*D,I),l.scrollTop=x;var T=this._getVisibleRowIndex(parseInt(x/this.oneRowScrollHeight));this.bScrollTop=T,this.rowIndex=T}!s&&I>0&&I==x&&this._applyScrollEnd(this.rowIndex),this.lastScrollYTop=l.scrollTop,!0!==t.skipResize&&this.handlerResize_drawInitializer(),this.isMobile&&this.setIScrollY()}}else this.handlerResize_drawInitializer()}},x.prototype.setScrollYHeightHybrid=function(t){try{if(void 0!==t&&null!=t||(t={}),!0===t.skipResize)return;var e,i,o,r,a,n=document.getElementById(this.id+"_main_div"),l=this.getFooterHeight(),h=!0===this._hasHybridScroll();if(h&&(e=this._getHybridVisibleHeightInfo(),o=this.getDataLength(),a=r=this._getHybridRowNum(),this.oneRowLength>1&&(a*=this.oneRowLength),h=(a-=e.cnt)>=1),h){var d=Math.floor(o/r),u=e.height;e.cnt>0&&(u=Math.round(u*(a+e.cnt)/a));var p=o-d*r,c=0;if(p>0){var g=r-p;this.oneRowLength>1&&(g*=this.oneRowLength);var f=this._getHybridVisibleHeightInfo(g);c=f.height,f.cnt>0&&(c=Math.round(c*g/(g-f.cnt))),d++}var m=document.getElementById(this.id+"_head_table").offsetHeight,y=0,b=!1;if(!0===t.keepHybridHash){b=!0;for(var v=0;v<d;v++)"number"==typeof this._hybridScrollHash[v]?y+=this._hybridScrollHash[v]:"number"==typeof this._hybridScrollHeight?y+=this._hybridScrollHeight:(y+=u,b=!1)}else y=u*d;i=y-c+m+l+this._getHybridScrollXHeight()+1,this._hybridScrollLastTop=NaN,this._hybridScrollDupHeight=c,!0!==b&&(this._hybridScrollHeight=u),e.cnt>0&&(this._hybridScrollHeight=Math.round(e.height*(a+e.cnt)/a))}else{var w=document.getElementById(this.id+"_body_table");i=Math.max(w.offsetHeight,n.offsetHeight-1)+l+this._getHybridScrollXHeight()+1,this._hybridScrollHeight=i,this._hybridScrollLastTop=i,this._hybridScrollDupHeight=0}document.getElementById(this.id+"_size_y").offsetHeight!==i&&!0!==t.keepHybridHash&&(this._hybridScrollHash={}),this._setHybridSizeY(i,t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._checkScrollEnd=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=t.offsetHeight;o<1e6&&(o=parseInt(t.style.height,10));var r=o-i,a=this._getEpsilon(),n=e.scrollTop,l=Math.min(Math.round(n)+a,r);return r>0&&r===l}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._checkScrollEnd2=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=parseInt(t.style.height,10)-i,r=this._getEpsilon(),a=e.scrollTop,n=Math.min(Math.round(a)+r,o)
;return o<=0?-1:n<3?1:n<o?0:2}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._applyScrollEnd=function(t,e){try{if(""!==this.options.visibleRowNum||this.lastTopRowIndex>0||0===this.lastTopRowIndex||this.groupbyStatus.grouped)return 0;if(this.hiddenCellObj.length>0)return 0;if(isNaN(t)&&(t=this.rowIndex),void 0!==e&&null!=e||(e={}),this._applyScrollEndCnt){if(this._applyScrollEndCnt>4)return;this._applyScrollEndCnt++}else this._applyScrollEndCnt=0;var i=0,o=this.getDataLength(),r=!1;if(this.hasSubtotal){if(this.drawedSubtotal.length>0){var a=this.drawedSubtotal[this.drawedSubtotal.length-1];if(a.rowIndex==o-1)"none"!=a[a.length-1].style.display&&(r=!0)}}else r=!0;var n=this.lastIndex+1,l=this._getVisibleLastIndex(n);if(t+l==o&&r)!0!==this._onSetHeight&&(this.lastTopRowIndex=t);else{var h=o-l;i=this._getScrollRowIndex(h)-this._getScrollRowIndex(t);var d=this.getElementById(this.id+"_size_y");if(this.hasSubtotal&&!r&&!0!==this._onSetHeight)if(this.struct.subtotalArr.length>1&&""===this.options.visibleRowNum&&!0!==e.noDraw){var u=this._getDrawedRowCount();if(u>0)return this.options.initFixedHeightByRowNum=u,this.options.visibleRowNum=u,this.drawedRowLength=u,this.lastTopRowIndex=null,this.drawedRowLength=this.options.initFixedHeightByRowNum,void this.drawData(this.rowIndex,0);i+=this.struct.subtotalArr.length}else i+=this.struct.subtotalArr.length;if(0!==i){this.lastTopRowIndex=null;var p=d.offsetHeight;p<1e6&&(p=parseInt(d.style.height,10)),d.style.height=p+this.oneRowScrollHeight*i+"px",!0!==e.noDraw&&this.drawData(Math.max(t+i,0)),this.handlerResize_drawInitializer()}}return this._applyScrollEndCnt=0,i}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.addGridScroll=function(t){try{var e=this.rowIndex+t;e=(e=e<0?0:e)>=this.getDataLength()-this.lastIndex?this.getDataLength()-this.lastIndex:e,this.scrollEvent=!1,this.checkScrollEnd=!0,this.drawData(e,0)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.handleScrollY=function(t,e){try{if(!0===this._isBrowserScroll())return;var i=this.getElementById(this.id+"_scrollY_div").scrollTop;if(i==this.bScrollY)return;if(this.bScrollY=i,0===this.getElementById(this.id+"_size_y").offsetHeight)return;var o=this._getEpsilon(),r=Math.round(i)+o,n=this._getVisibleRowIndex(parseInt(r/this.oneRowScrollHeight)),l=this.getDataLength(),h=this._checkScrollEnd();if(this.scrollEvent&&(null!=this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleScrollY",[t]),this.bScrollTop!=n||this.rowIndex!=n)){this.hasClass(document.activeElement,this.options.bodyTdClass)&&document.activeElement.blur&&document.activeElement.blur();var d="async",u=e&&!0===e.changedHeight;(u||h)&&(d="sync",u||this.handleResize()),this.drawData(n,null,d)}this.bScrollTop=n;var c=this._getVisibleLastIndex(this.lastIndex+1);if(0==i&&this.checkScrollStart&&(this.skipScrollStartEvent||(this.scrollEvent=!0,this.checkScrollStart=this.options.alwaysTriggerScrollStart,p.f.stopEvent(t),a.Z.setTimeout((function(){p.f.fireEvent(this,"onscrollstart")}),{key:this.id+"_scrollstart",caller:this,delay:150}))),(this.scrollEvent||this.checkScrollEnd)&&this.options.loadCount>0&&this.loadFlag){var g=n+c-1;l-this.options.loadCount-1<=g&&null==this.loadCheck[l]&&(this.skipScrollEndEvent||(this.loadCheck[l]=!0,this.scrollEvent=!0,this.loadFlag=!1,p.f.stopEvent(t),a.Z.setTimeout((function(){p.f.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150})))}else(this.scrollEvent||this.checkScrollEnd)&&0==this.options.loadCount&&!0===h&&(!this.scrollEvent||this._applyScrollEnd(this.rowIndex)<=0)&&(p.f.stopEvent(t),a.Z.setTimeout((function(){p.f.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150}));if(this.skipScrollStartEvent=!1,this.skipScrollEndEvent=!1,this.scrollEvent=!0,this.checkScrollEnd=!1,1==this.options.syncScroll&&this.options.syncScrollId)for(var f=this.options.syncScrollId.split(","),m=0;m<f.length;m++){var y=a.Z.getComponentById(f[m],this.scope_id)
;y&&this.getRowCount()==y.getRowCount()&&y.setScrollTop(i)}p.f.fireEvent(this,"onscrolly",t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.handleScrollYHybrid=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"number"==typeof e.maxRepeat&&e.maxRepeat<=0)return;!0!==e.skipEndEdit&&this._endEdit();var i=this._getHybridVisibleHeightInfo();this._setHybridVisibleHeight(this._hybridRowIndex,i);var o=document.getElementById(this.id+"_scrollY_div"),r=document.getElementById(this.id+"_size_y"),a=this.getDataLength(),n=a;this.oneRowLength>1&&(n*=this.oneRowLength);var l=this._getHybridTrCount(),h=this.getFooterHeight(),d=document.getElementById(this.id+"_body_table");if(n<=l){this._setHybridYPosition(o.scrollTop),this._hybridScrollYPos=0;var u=o.scrollHeight-o.offsetHeight;return void(u>0&&o.scrollTop>=u&&p.f.fireEvent(this,"onscrollend"))}var c=o.scrollTop;"number"==typeof e.scrollTop&&(c=e.scrollTop);var g=0,f=c,m=this._getHybridLastIndex(),y=this._hybridScrollDupHeight;if(f>0&&f>=this._hybridScrollLastTop)g=m,f=c-this._hybridScrollLastTop+this._hybridScrollDupHeight;else{for(;f>0&&g<m;){var b=null==this._hybridScrollHash[g]?this._hybridScrollHeight:this._hybridScrollHash[g];if(!(f>=b))break;f-=b,g++}g===m&&(f+=y+this._getHybridLastSubtotalHeight()+i.borderHeight)}var v=c-f,w=c-v;if(this._setHybridYPosition(w),g!==this._hybridRowIndex){var C=this._getHybridRowNum(),I=Math.min(g*C,a-C);this.drawData(I),this._hybridRowIndex=g;var _=null==this._hybridScrollHash[g]?this._hybridScrollHeight:this._hybridScrollHash[g];if(this._setHybridVisibleHeight(),_!==this._hybridScrollHash[g])return"number"==typeof e.maxRepeat?e.maxRepeat--:e.maxRepeat=10,e.scrollEvent=!0,this.handleScrollYHybrid({},e)}var x=0;0!==(x=g===m?r.offsetHeight-d.offsetHeight-v-h-this._getHybridScrollXHeight()-1:y-this._hybridScrollDupHeight)&&(v+=x,this._setHybridYPosition(w-x)),this._hybridScrollYPos=v,"scroll"!==t.type&&"onscroll"!==t.type&&!0!==e.scrollEvent||(p.f.fireEvent(this,"onscrolly",t),o.scrollTop>=o.scrollHeight-o.offsetHeight&&p.f.fireEvent(this,"onscrollend")),this._setHybridDataLayerTop()}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._refreshScrollYHybrid=function(t){try{var e=this._getHybridRowNum(),i=this.getDataLength(),o=Math.max(i-e,0),r=Math.min(this._hybridRowIndex*e,o);this._hybridRowIndex=Math.ceil(r/e),this.drawData(r),this.setScrollYHeightHybrid(t),this._autoFitRefreshNative();this.handleScrollYHybrid({},t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.drawDataTable=function(t,e){try{null==t&&(t=this.rowIndex),-1==t&&(t=0);var i=this.drawedRowLength;return this.setDataTable(),this.headerTds=null,this.footerTds=null,this.drawedRowLength!=i&&(this.setColIndexInfo(),e&&e.keepScrollTop?this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0}):this.drawData(t,0)),this.drawedRowLength-i}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.drawData=function(t,e,i,o,a){try{r.I.clearTimer(this.id+"_drawData"),r.I.clearTimer(this.id+"_completiveDrawData"),r.I.clearTimer(this.id+"_adjustDraw");i=i||"sync";var n=!0;this.options.senseReader&&(n=!1);var l=this.getDataLength();t=Math.min(t,l),l>0&&(t=Math.max(0,t));var h=a?a.noApplyRealFocus:void 0;this.changeFocusedCellPosition(t,n,!0,{linkNoFocus:!0});var d=this.maxRowLength;if(this.rowIndex=t,null!=this.editedCell&&this.editedCell.handleEndEdit(null,o),this.subtotalHidden(e?{startRowIndex:e+this.rowIndex}:null),-1!=this.rowIndex&&"sync"!=i&&"all"!==this.options.visibleRowNum||this.startedDisplayNone)e=this.fastDrawData(e,{scroll:!0}),r.I.setTimer((function(e){r.I.setTimer(this.completiveDrawData,{key:this.id+"_completiveDrawData",caller:this,delay:120,args:[e],callback:function(e){r.I.setTimer((function(){this.startedDisplayNone||(this.adjustDraw(e),this._setGridBorder(),this._setCheckboxHead()),d!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}),{key:this.id+"_adjustDraw",caller:this})}})}),{key:this.id+"_drawData",caller:this,delay:1,args:[e]});else{
var u=this.completiveDrawData(e,{noApplyRealFocus:h});this.adjustDraw(u,a),this._setGridBorder(),this._setCheckboxHead(),d!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.fastDrawData=function(t,e){try{var i=this.options.initFixedHeightByRowNum>-1;i&&(void 0===e||null==e?e={skipSubtotal:!0}:e.skipSubtotal=!0),this.options.measureTime&&r.I.measureTime((function(t){var e=t.aver,i=parseInt(1e3/e*10,10)/10;c.v.printLog("Id : "+this.id+", time : "+e+"ms   ,fps : "+i)}),{key:this.id+"_measureDrawTime",caller:this});var o=this.rowIndex,a=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var n=this._getVisibleTrRowIndex(t,o),h=this.hiddenCellObj.length>0;if(a>0){0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);new Date;var d,u=1;h?(d=a,u=a):""===this.options.visibleRowNum?d=this._getVisibleTrRowIndex(this.drawedRowLength,o):("all"===this.options.visibleRowNum||(u=parseInt(this.options.visibleRowNum,10)-t),d=a);for(this._getVisibleTrRowIndex(this.options.drawLimitRow,o);n<d&&n+o<a&&u>0;n++){var p=!this.hiddenRowObj.length>0||this._getRowVisible(n+o);p&&!0===this.hiddenRowObj.init&&this._setRowDisplay(n,""),this.options.fixedRow>0&&this.options.fixedRow>n?this.fastDrawRowData(n,n,e):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(n,n+o,e);var g=this.options.backgroundColorMode.toLowerCase();if("always"==g?"object"!=(0,l.A)(this.dataList.getRealRowIndex())&&(this.options.fixedRow>0&&this.options.fixedRow>n?this.applyRowStyleOptions(n):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.applyRowStyleOptions(o+n)):"full"==g&&"object"!=(0,l.A)(this.dataList.getRealRowIndex())&&(this.options.fixedRow>0&&this.options.fixedRow>n?(this.applyRowStyleOptions(n),this.setEvenOddBackground(n,n)):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||(this.applyRowStyleOptions(o+n),this.setEvenOddBackground(n,o+n))),p?this.lastDisplayedRow<n&&!0!==this.hiddenRowObj.init&&(this._setRowDisplay(n,""),h||(this.lastDisplayedRow=n)):this._setRowDisplay(n,"none"),p&&""!==this.options.visibleRowNum)if(u--,i&&this.hasSubtotal&&u>=1)u-=this.drawSubtotalRow(n+1,n+o,{maxCount:u});if(h)for(var f=0;f<this.oneRowDataLength;f++){var m=n+o,y=this._getTdElem(n+o,f);if(y){var b=!0===this.hiddenCellObj[m+"_"+f];y.style.display=b?"none":""}}}}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),null!==this.lastTopRowIndex&&o>=this.lastTopRowIndex&&!0!==this.hiddenRowObj.init&&!h){for(f=n;f<=this.lastDisplayedRow;f++)this._setRowDisplay(f,"none");this.lastDisplayedRow=n-1}return this.options.mergeRefreshAlways&&this.dynamicMergeHTML(),!0===this.hiddenRowObj.init?t:n}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.completiveDrawData=function(t,e){try{!this.autofitDone&&this.options.autoFit&&this._setAutoFit();var i=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var o=this.rowIndex,r=t-1,n=this.dataLayerHeight,l=this.hiddenCellObj.length>0;if(i>0){if(o=Math.max(0,o),this.rowIndex=o,!0===this.hiddenRowObj.init)this._applyRowVisible({applyStyle:!0,drawRow:!0}),r=this.lastIndex;else{var h=this.options.initFixedHeightByRowNum>-1;0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);var d,u=this.drawedRowLength;this._dynamicVisibleRowNum>0&&(u=this._dynamicVisibleRowNum),h&&this.hasSubtotal&&this.drawedSubtotal&&(u-=this.drawedSubtotal.drawedRowLength),h&&(d={skipSubtotal:!0});for(var p=t;p<u&&p+o<i;p++){var c=p+this.rowIndex;if(this.options.fixedRow>0&&this.options.fixedRow>p?this.fastDrawRowData(p,p,d):this.fastDrawRowData(p,c,d),r=p,h&&this.hasSubtotal&&p<u-1)u-=this.drawSubtotalRow(p+1,c,{maxCount:u-p-1})}if(h&&this.hasSubtotal&&u>r+1&&(u-=this.drawSubtotalRow(0,o-1,{maxCount:u-r-1})),this.options.rowResize&&this.rowResized){var g=n-this.getElementById(this.id+"_head_table").offsetHeight,f=0
;for(p=0;p<this.dataRowList.length;p++){if(!(f<g)){r=p;break}f+=this.dataRowList[p].offsetHeight}}if("native"==this.options.drawType&&0!=t&&(r=this.getDataLength()-1),l){for(p=r+1;p<this.drawedRowLength+this.hiddenRowObj.extraRow;p++)this._setRowDisplay(p,"none");for(p=0;p<=r;p++)this._setRowDisplay(p,"")}else{for(p=r+1;p<=this.lastDisplayedRow+this.hiddenRowObj.extraRow;p++)this._setRowDisplay(p,"none");for(p=this.lastDisplayedRow+1;p<=r;p++)this._setRowDisplay(p,"")}var m=l||!l&&"native"===this.options.drawType||""===this.options.visibleRowNum&&-1==this.options.initFixedHeightByRowNum||this.options.accessibility;if(m){var y=0,b=this.options.backgroundColorMode.toLowerCase();if("always"!==b&&"full"!==b||(y=t),this.defaultColCnt)for(p=0;p<this.dataRowList.length;p++)this.removeRowOverStyle(this.dataRowList[p],!0);for(p=y;p<=r;p++)this.options.fixedRow>0&&this.options.fixedRow>p?this.applyRowStyleOptions(p):this.applyRowStyleOptions(o+p);this.options.autoResizeEmbeddedInput&&this.firstEmbeddedInputResize&&(this.setAutoResizeEmbeddedInput(),this.firstEmbeddedInputResize=!1)}this.lastDisplayedRow=r,m&&"all"!==this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&(r=this.cutGridBottom(r,e)),!0===this._isBrowserScroll()&&(this.lastIndex=r)}for(p=0;p<=r;p++)this.options.fixedRow>0&&this.options.fixedRow>p?this.setEvenOddBackground(p,p):this.setEvenOddBackground(p,o+p);if(this.options.lastFixedRow>0)for(p=0;p<this.options.lastFixedRow;p++)this.options.lastFixedRowStartIndex>0?(this.fastDrawRowData(r-p,this.options.lastFixedRowStartIndex+1-p),m&&this.applyRowStyleOptions(r-p),this.setEvenOddBackground(r-p,this.options.lastFixedRowStartIndex+1-p)):(this.fastDrawRowData(r-p,i-1-p),m&&this.applyRowStyleOptions(r-p),this.setEvenOddBackground(r-p,i-1-p));if(!0!==this.hiddenRowObj.init&&!l){var v=this._getVisibleLastIndex(r+1);r+1<this.drawedRowLength&&(this._setRowDisplay(v,""),this.setEvenOddBackground(v,o+v),this.applyRowStyleOptions(o+v),this.options.showLastRow&&!this.hasSubtotal?this.getDataLength()<=o+v&&this._setRowDisplay(v,"none"):this._setRowDisplay(v,"none"))}}else{var w=this.options.showLastRow&&!this.hasSubtotal?1:0,C=this.lastDisplayedRow+w;!0===this.hiddenRowObj.init&&(C=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(p=0;p<=C;p++)this._setRowDisplay(p,"none");r=this.lastDisplayedRow=-1}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),this.focusedCell.length>0&&!this.editedCell){var I,_=this.focusedCell[this.focusedCell.length-1].focusedRowIndex-this.rowIndex,x=this.focusedCell[this.focusedCell.length-1].focusedColIndex;if(0<=_&&_<=r)if(I=this.options.focusDefaultColumn&&x<0&&this.defaultColCnt&&("row"===this.options.focusMode||"both"===this.options.focusMode)?this.all_data_td_list[this.defaultColCnt+x+_*(this.oneRowDataLength+this.defaultColCnt)]:this.data_td_list[x+_*this.oneRowDataLength]){var S=e?e.noApplyRealFocus:void 0;this.applyFocusedCellIn(I,S,{noApplyRealFocus:S})}}var R=WebSquare.BootLoader.fullViewed||!1,D=a.Z.fullViewed||!1;if(!R&&!D&&"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")){this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(p=this.defaultColCnt;p<this.hiddenList.length;p++)1==this.hiddenList[p]&&this.setAdaptiveColumnVisible(p,!1)}return r}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.adjustDraw=function(t,e){try{void 0!==e&&null!=e||(e={});var i=this.rowIndex;this.dataLayerHeight;if(this.options.lazyDrawHiddenColumn)this.initVisibilityArr=this.colIndexInfo.body.visibilityArr.slice(0),this.hideInvisibleTds();else{this.rollbackCommitFlag=!1;var o=this.lastDisplayedRow;!0===this.hiddenRowObj.init&&(o=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(var r=0;r<=o-this.options.lastFixedRow;r++)this.groupbyStatus.grouped&&"object"==(0,
l.A)(this.dataList.getRealRowIndex(r+i))||(!0!==this.hiddenRowObj.init||this._getRowVisible(r+i))&&(this.options.fixedRow>0&&r<=this.options.fixedRow-1?this.lazyDrawRowData(r,r):this.lazyDrawRowData(r,r+i));this.rollbackCommitFlag=!0}t=this.options.initFixedHeightByRowNum>-1?this.adjustInitFixedByRowNum(t):""!==this.options.visibleRowNum?this.adjustVisibleRowNum(t):this.adjustDefault(t),this.maxRowLength=t,!this.isIE6or7||1==this.options.senseReader&&""==this.options.visibleRowNum||(this._setRowDisplay(t+1,""),this.dataRowList[(t+1)*this.oneRowLength]&&this.dataRowList[(t+1)*this.oneRowLength].offsetHeight,this._setRowDisplay(t+1,"none")),this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.adjustVisibleRowNum=function(t){try{if(""===this.options.visibleRowNum||!0===this._isBrowserScroll())return t;var e=this.rowIndex,i=this.getDataLength();this.setDataTable();var o={noDraw:!0,skipResize:null!=this.lastTopRowIndex};this.setScrollYHeight(o),!0===this.hiddenRowObj.init&&this.applyStyleOptions(t);var r,n=this.getElementById(this.id+"_scrollX_div"),l=parseInt(n.style.height,10),h=this.getElementById(this.id+"_body_table"),d=0;if(!0===this.hiddenRowObj.init)this.lastDisplayedRow=t,this.lastIndex=t,r=h.offsetHeight,a.Z.isIE(9)&&(r=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d);else{var u="all"==this.options.visibleRowNum?i:u=parseInt(this.options.visibleRowNum,10);this.options.initFixedHeightByRowNum>-1&&this.hasSubtotal&&this.drawedSubtotal&&(u-=this.drawedSubtotal.drawedRowLength);for(var p=t+1;p+e<i&&p<u;p++)this.drawRowData(p,p+e),t++;for(p=this.lastDisplayedRow+1;p<=t;p++)this._setRowDisplay(p,"");this.applyStyleOptions(t);for(p=t+1;p<=this.lastDisplayedRow;p++)this._setRowDisplay(p,"none");this.lastDisplayedRow=t,this.lastIndex=t,r=h.offsetHeight,a.Z.isIE(9)&&(r=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d)}this.options.initFixedHeightByRowNum>-1&&i>this.options.initFixedHeightByRowNum||!(r<this.defaultDataLayerHeight)||!0===this.options.isItemTable||this._dynamicVisibleRowNum>0||(r=this.defaultDataLayerHeight);var c=0;""!==this.options.visibleRowNum&&this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(c=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight,this.options.groupbyFilterBox&&(c+=this.groupbyZoneStatus.groupbyFilterBoxRender.offsetHeight));var g=this.getSize("height"),f=r+l+d+c,m=!0!==this._isBrowserScroll();if(this.options.visibleRowNumFix){var y=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(!isNaN(y)){var b=this.getElementById(this.id+"_head_table").offsetHeight;f<this.oneRowHeight*y+b+l+d+1&&(m=!1)}}if((i>0||"all"==this.options.visibleRowNum)&&g!=f&&(m&&this.setSize(null,f),null!=this.lastTopRowIndex)){var v=this._getScrollRowIndex(this.lastTopRowIndex);v!==this._getScrollMaxRowIndex()&&(o.skipResize=!1,o.restRowCnt=v,this.lastTopRowIndex=null)}if(this.options.autoFit&&this._setAutoFit(),this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight,clientWidth:this.render.clientWidth},this.dataLayerHeight=h.parentNode.offsetHeight,this.setScrollYHeight(o),null==this.lastTopRowIndex){var w=this._getVisibleRowIndex(this._getScrollMaxRowIndex()),C=this._getVisibleLastIndex(this.lastIndex+1);this.rowIndex===w&&this.rowIndex+C===i&&(this.lastTopRowIndex=this.rowIndex)}return t}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.adjustInitFixedByRowNum=function(t){try{return this.adjustVisibleRowNum(t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.adjustDefault=function(t){try{return""!==this.options.visibleRowNum||(this.adjustDraw_keepTop?this.adjustDraw_keepTop=null:this.setScrollYHeight({skipResize:!0})),t}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.drawBottomData=function(t){try{
if(this.rowIndex<0||0==this.rowIndex&&t<=this.lastIndex||this.rowIndex>=0&&this.rowIndex+this.lastIndex==t||isNaN(Number(t)))return;if(!0===this._isNativeScroll())return void this.drawData(0);if(!0===this._isHybridScroll()){var e=Math.max(drawedRowLength-this._getHybridRowNum(),0),i=Math.min(t-e,0);return void this._drawDataHybrid(i)}var o=this.getDataLength();t>=o&&(t=o-1);var r=0;this.lastIndex>-1&&(r=Math.max(t-this.lastIndex,0)),this.rowIndex!==r&&this.drawData(r);var a=this.rowIndex+this.lastIndex-t,n={};n[this.rowIndex]=a;for(var l=5;Math.abs(a)>0&&null==n[this.rowIndex-a]&&l>0;)this.drawData(this.rowIndex-a),a=this.rowIndex+this.lastIndex-t,n[this.rowIndex]=a,l--}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.cutGridBottom=function(t,e){try{if(!0===this._isBrowserScroll())return;var i=this.rowIndex,o=this.dataLayerHeight,r=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody"),l=WebSquare.style.getStyle(r,"border-top-width");l="thin"==l?a.Z.isIE(6)||a.Z.isIE(7)?2:1:"medium"==l?a.Z.isIE(6)||a.Z.isIE(7)?4:3:"thick"==l?a.Z.isIE(6)||a.Z.isIE(7)||a.Z.isOpera()?6:5:parseInt(l,10);var h=parseInt(l/2,10)-r.offsetTop;if(n.getBoundingClientRect){var d=n.getBoundingClientRect(),u=d.bottom-d.top;h+=u-parseInt(u,10)>0?1:0}for(var p=o-h,c=this.getElementById(this.id+"_body_tbody").childNodes,g=(t=-1,!0),f=this.getDataLength(),m=this.oneRowLength*f-1,y=i*this.oneRowLength,b=this.hiddenCellObj.length>0,v={row:[],cnt:0},w=0;w<c.length;w++){var C=c[w],I=!1,_=!1;if(0!==C.offsetHeight){v.row[w]="visible",v.cnt++,this.hasClass(C,"grid_body_row")?(g&&y+t<m?t++:(C.style.display="none",this.addClass(C,"w2grid_hidedRow")),I=!0):C.getAttribute("data-subtotal")&&(g||this._subtotalHidden([C]),_=!0);var x=C.offsetTop+C.offsetHeight-p;if(g&&x>0){if(g=!1,I){var S=t%this.oneRowLength;if(b){var R=this.oneRowHeight/this.oneRowLength;S=Math.floor(x/R)}for(var D=0;D<=S&&w>=D;D++){var T=c[w-D];T.style.display="none",this.addClass(T,"w2grid_hidedRow"),t--}}_&&this._subtotalHidden([C])}}else v.row[w]="hidden"}if(v.cnt-=t+1,b){var L=-1,k=-1;for(w=0;w<v.row.length&&k<t;w+=this.oneRowLength){var F=!1;for(D=0;D<this.oneRowLength;D++)"visible"===v.row[w+D]&&(!1===F&&(L++,F=!0),k++)}t=L}else if(t=Math.floor(t/this.oneRowLength),!this.senseReaderMode){if(!0!==this.hiddenRowObj.init)for(w=t+1;w<=this.drawedRowLength;w++)this._setRowDisplay(w,"none");this.lastDisplayedRow=t}var A=this.options.showLastRow&&!this.hasSubtotal,E=!(1==this.options.senseReader&&"all"!==this.options.visibleRowNum);if(A&&(!this.senseReaderMode||E)){f=this.getDataLength();var M=b?Math.floor(t/this.oneRowLength):t,O=this._getVisibleRowIndex(this._getScrollRowIndex(this.rowIndex)+M+1);if(f>0){for(;!this._getRowVisible(O)&&O<f;)O++;O<f&&this._getRowVisible(O)&&(this._setRowDisplay(O-this.rowIndex,""),this.lazyDrawRowData(O-this.rowIndex,O))}}this.lastIndex=t,!0===this.hiddenRowObj.init&&(this.lastDisplayedRow=t);var N=t;if(e&&!0===e.extraRowByCellHidden){var H=0;for(w=0;w<v.row.length&&v.cnt>0;w+=this.oneRowLength)for(F=!1,D=0;D<this.oneRowLength;D++)"visible"===v.row[w+D]&&(!1===F&&(H++,F=!0),v.cnt--);N=H}return N}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.getLastIndex=function(t){try{var e=this.dataLayerHeight;if(t<0)return this.lastDisplayedRow=-1,-1;for(;;){var i=this.dataRowList[(t+1)*this.oneRowLength-1];if(!(t>0&&i.offsetTop+i.offsetHeight>e))break;t--}return t}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.lazyDrawRowData=function(t,e){try{for(var i=0;i<this.colIndexInfo.body.invisibleTds.length;i++){var o=this.colIndexInfo.body.invisibleTds[i]-this.defaultColCnt,r=this._getColumnMoveIndex(o);r>=0&&this.drawCellData(t,e,r,!0)}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.fastDrawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),r=this.all_data_td_list[t*this.realRowDataLength],a=0;if("number"==typeof o){
if((this.groupbyStatus.grouped||this.clearGrouping)&&this.defaultColCnt>0)for(var n=r,h=!0,d=0;d<this.defaultColCnt;d++){var u=this.colIndexes.bodyColInfo.colSpanArr[d]||1;n.setAttribute("colSpan",u),n.style.display="",n.innerText="",n.textContent="",n.className.match("w2grid_groupby")&&(n.className=r.className.split(" ").splice(0,1),this.options.rowNumVisible&&h?(n.className+=" gridBodyDefault_rowNumber",h=!1):n.className+=" gridBodyDefault_rowStatus"),n=n.nextSibling}if(this.options.rowMerge){var p={rowMergeStartPoint:[],rowMergeSameDataLength:[]},c=this.getRowData(e),g=!1,f=0;for(d=0;d<c.length;d++)c[d]==c[d+1]?(g||p.rowMergeStartPoint.push(d),f++,g=!0):(g&&(f++,p.rowMergeSameDataLength.push(f)),g=!1,f=0)}this._drawRowNumData(t,e,i),this._drawRowStatus(t,e,i);var m=this.colIndexInfo.body.visibleTds,y=m.length;i&&!0===i.refreshColumn&&(y=this.oneRowDataLength);for(d=0;d<y;d++){var b;if(i&&!0===i.refreshColumn)b=d;else{var v=m[d]-this.defaultColCnt;b=this._getColumnMoveIndex(v)}if(b>=0)if(this.options.rowMerge){u=null;for(var w=0;w<p.rowMergeStartPoint.length;w++)b==p.rowMergeStartPoint[w]?u=p.rowMergeSameDataLength[w]:p.rowMergeStartPoint[w]<b&&b<p.rowMergeStartPoint[w]+p.rowMergeSameDataLength[w]&&(u=-1);this.drawCellData(t,e,b,null,u,i)}else this.drawCellData(t,e,b,null,null,i)}i&&!0===i.skipSubtotal||(a=this.drawSubtotalRow(t+1,e))}else"object"==(0,l.A)(o)&&this.drawGroupData(r,o,t);return a}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.clearGroupedRow=function(t,e){try{if(this.defaultColCnt>0)for(var i=this.all_data_td_list[t*this.realRowDataLength],o=i,r=!0,a=0;a<this.defaultColCnt;a++){var n=this.colIndexes.bodyColInfo.colSpanArr[a]||1;o.setAttribute("colSpan",n),o.style.display="",o.innerText="",o.textContent="",o.className.match("w2grid_groupby")&&(o.className=i.className.split(" ").splice(0,1),this.options.rowNumVisible&&r?(o.className+=" gridBodyDefault_rowNumber",r=!1):o.className+=" gridBodyDefault_rowStatus"),o=o.nextSibling}for(a=0;a<this.oneRowDataLength;a++){var l=a,h=this._getColumnMoveIndex(l);h>=0&&this.drawCellData(t,e,h)}this.drawSubtotalRow(t+1,e)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.drawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),r=0;if(null==o)return r;var n=a.Z.getDataPrefix("colMerged"),l=this.all_data_td_list[t*this.realRowDataLength];if("number"==typeof o){this._drawRowNumData(t,e),this._drawRowStatus(t,e);for(var h=0;h<this.oneRowDataLength;h++){var d=h,u=this.getCellInfo(d);if(this.drawCellData(t,e,d),u&&u.options.colMerge&&!this.groupbyStatus.grouped)for(var p=this._dataList.getColumnIndex(this.getColumnID(d)),c=this._dataList.dataArr[e*this._dataList.oneRowDataLength+p],g=0;g<=this.maxRowLength-t;g++){var f=this.data_td_list[(t+g)*this.oneRowDataLength+d];if(f){var m=c==this.dataList.getCellData(t+g+1,d)?"1":"0";f.setAttribute(n,m),this.drawCellData(t+g,e+g,d)}}}i&&!0===i.skipSubtotal||(r=this.drawSubtotalRow(t+1,e))}else this.drawGroupData(l,o,t);return r}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.hideNochangeDataLayer=function(t){if(null==this.hideDataLayer){this.hideDataLayer=document.createElement("div"),this.hideDataLayer.className="w2grid_fastScroll_layer";var e=document.createElement("div");e.innerHTML=this.options.scrollMsg,e.className="w2grid_fastScroll_msg",this.hideDataLayer.appendChild(e),this.getElementById(this.id+"_dataLayer").appendChild(this.hideDataLayer)}var i=this.all_data_td_list[(t-1)*this.realRowDataLength],o=i.offsetHeight;0!=o?(this.hideDataLayer.style.display="block",this.hideDataLayer.style.top=i.offsetTop+o+1+"px"):this.hideDataLayer.style.display="none"},x.prototype.setEvenOddBackground=function(t,e){if(this.options.oddEvenColorDisplay){var i=this.data_td_list[t*this.oneRowDataLength],o=null;if(i){var s=a.Z.getDataPrefix("trIndex");o=i.parentNode;do{o.style.backgroundColor=e%2==1?this.options.evenRowBackgroundColor:this.options.oddRowBackgroundColor,o=a.Z.next(o)
}while(null!=o&&"0"!=o.getAttribute(s))}}},x.prototype._drawRowNumData=function(t,e,i){try{if(this.options.rowNumVisible){var o=this.data_num_td_list[t],r="";r=o&&null!=o.textContent?"textContent":o&&null!=o.innerText?"innerText":"innerHTML";var a=this.startRowNumber;this.rowNumArr?"number"==typeof this.rowNumArr[e]&&(a=1+this.rowNumArr[e]):o&&(a=1+e+this.startRowNumber),a>this.startRowNumber&&("span"===this.options.dataTag?o.innerHTML=this.dataTagOpen+a+this.dataTagClose:o[r]=a)}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._drawRowStatus=function(t,e,i){if(this.options.rowStatusVisible){var o=this.data_status_td_list[t];if(o){var s,r=this._linkedDataList||this._dataList;s="linkedDataList"==r.initializeType?r.getRowStatusValue(e):this._dataList.options.depthColumn||this.groupbyStatus.grouped?r._getRowStatusValue(this.getRealRowIndex(e)):r.getRowStatusValue(e),this._drawStatus(s,o,"w2grid_rowStatus_")}}},x.prototype._drawCellStatus=function(t,e,i,o){if(this.options.cellStatusVisible){var s=this.data_td_list[i+t*this.oneRowDataLength];if(s){var r,a=this.getColumnID(i),n=this._linkedDataList||this._dataList;r="linkedDataList"==n.initializeType?n.getCellStatusValue(e,a):this._dataList.options.depthColumn||this.groupbyStatus.grouped?n._getCellStatusValue(this.getRealRowIndex(e),a):n.getCellStatusValue(e,a),this._drawStatus(r,s,"w2grid_cellStatus_","_"+this.options.cellStatusIconPosition,!0)}}},x.prototype._drawStatus=function(t,e,i,o,r){try{var n="",l="";switch("string"!=typeof o&&(o=""),t){case 0:n="R",l=WebSquare.language.getMessage("Grid_rowStatus_initialValue")||"initial value";break;case 1:n="U",l=WebSquare.language.getMessage("Grid_rowStatus_update")||"updated";break;case 2:n="C",l=WebSquare.language.getMessage("Grid_rowStatus_insert")||"inserted";break;case 3:n="D",l=WebSquare.language.getMessage("Grid_rowStatus_delete")||"deleted";break;case 4:n="V",l=WebSquare.language.getMessage("Grid_rowStatus_D_After_C")||"deleted after insertion"}var h=a.Z.getDataPrefix("imageName"),d=e.getAttribute(h)||"";if((d!=n||this.clearGrouping)&&(this.removeClass(e,i+(d||"R")+o),""!=n&&this.addClass(e,i+n+o),"imageName"===h&&(e.imageName=n),e.setAttribute(h,n),!0===this.options.accessibility)){var u=e.id+"_altspan",p=document.getElementById(u);if(!p){(p=document.createElement("span")).id=u;var c=i+"span";!0===r&&(c="w2blind "+c),p.className=c,e.appendChild(p)}p.textContent=l}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.drawCellData=function(t,e,i,o,r,n){try{o||null==this.editedCell||this.editedCell.options.colIndex+""!=i+""||this.editedCell.handleCancelEdit();var l=this.data_td_list[i+t*this.oneRowDataLength];if(l){var h=this.cellInfoHash[this.tdIdList[i]];if(this.groupbyStatus.grouped||this.clearGrouping){var d=this.colIndexes.bodyColInfo.colSpanArr[i+this.defaultColCnt]||1;l.setAttribute("colSpan",d),l.style.display="",l.style.textAlign=h.options.textAlign}if(this.options.rowMerge)if(null==r)l.setAttribute("colSpan",""),l.style.display="",l.style.textAlign="";else if(r>0){d=r;l.setAttribute("colSpan",d),l.style.display="",l.style.textAlign=h.options.textAlign}else-1==r&&(l.style.display="none");!h.options.embeddedInput&&this.groupbyStatus.grouped&&(l.textContent=""),(this.groupbyStatus.grouped||this.clearGrouping)&&this.hasClass(l,"w2grid_groupby")&&(l.className="gridBodyDefault");var u=this.aria_labelledby[i];if(u){var p=t+e+1;l.setAttribute("aria-labelledby",u+" r"+p)}if(h.options.headers&&this.options.applyScopeHeaders){var c=this.scope_id?this.scope_id+"_":"",g=a.Z.getDataPrefix("headers");l.setAttribute(g,c+h.options.headers)}this.isColMerge&&h.options.colMerge&&!this.groupbyStatus.grouped?this.setColMergeCellData(t,e,i,n):this.setInnerHTML(l,e,i,n),this._drawCellStatus(t,e,i)}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.setColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.setColMergeAndCellData(t,e,i,o);var s=this.data_td_list[i+t*this.oneRowDataLength],r=this.getHasSubtotalCount(e)
;if(0==t)return 0!=r&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);var n=this.getColumnID(i),l=this.dataList._getCellData(e-1,n),h=this.data_td_list[i+(t-1)*this.oneRowDataLength],d=this.upperGroupingTest(e,i,t),u=this.dataList._getCellData(e,n),p=this._getWrapperCell(s,e);if(l==u&&d){this.options.readOnly&&this.options.readOnlyBackgroundColor?(h.style.borderBottomColor=s.style.backgroundColor,s.style.borderTopColor=s.style.backgroundColor,s.style.borderBottomColor=s.style.backgroundColor):(h.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px"),p.innerHTML="";var c=a.Z.getDataPrefix("viewType"),g=a.Z.getDataPrefix("inputType");if("icon"==s.getAttribute(c)){var f=s.getAttribute(g);this.removeClass(s,this.options.bodyTdClass+"_"+f)}if(this.options.senseReader&&(0==r&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(h.style.borderBottomWidth="1px")),0!=r&&(s.style.borderBottomWidth="1px"),null!=h)return this.applyCellStyleOptions(e,i,!1),"mergeCellBackgroundColor"}else{var m=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==m&&!this.groupbyStatus.grouped&&(m="1px"),this.options.readOnly&&this.options.readOnlyBackgroundColor?s.style.borderTopColor=s.style.backgroundColor:s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=m}},x.prototype.setColMergeAndCellData=function(t,e,i,o){var s=this.data_td_list[i+t*this.oneRowDataLength],r=this.getHasSubtotalCount(e);if(0==t)return 0!=r&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]};var a=this.getColumnID(i);if(null==this.colMergeObj.colArr[i]){var n=this.dataList._getCellData(e-1,a),l=this.dataList._getCellData(e,a);if(this.colMergeObj.colArr[i]=n==l,this.colMergeObj.colArr[i])for(var h=0;h<this.oneRowDataLength;h++){if(null==this.colMergeObj.colArr[h])if(this.getCellInfo(h).options.colMerge){var d=this.getColumnID(h),u=this.dataList._getCellData(e-1,d),p=this.dataList._getCellData(e,d);this.colMergeObj.colArr[h]=u==p}else this.colMergeObj.colArr[h]=!0}}var c=!0;for(h=0;h<this.colMergeObj.colArr.length;h++)if(!this.colMergeObj.colArr[h]){c=!1;break}var g=this.data_td_list[i+(t-1)*this.oneRowDataLength];if(c){g.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px",this._getWrapperCell(s,e).innerHTML="",this.options.senseReader&&(0==r&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(g.style.borderBottomWidth="1px")),0!=r&&(s.style.borderBottomWidth="1px")}else{var f=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==f&&(f="1px"),s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=f}},x.prototype.drawColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.drawColMergeAndCellData(t,e,i,o);var s=this.getColumnID(i),r=this.data_td_list[i+t*this.oneRowDataLength];if(this.options.readOnly&&this.options.readOnlyBackgroundColor||(r.style.borderBottomWidth="0px"),0!=t||o){var n=this.getHasSubtotalCount(e);0==n&&(this.options.readOnly&&this.options.readOnlyBackgroundColor||(r.style.borderBottomWidth="0px"));var l=this.dataList._getCellData(e-1,s),h=this.data_td_list[i+(t-1)*this.oneRowDataLength];this.options.readOnly&&this.options.readOnlyBackgroundColor||(r.style.borderTopWidth="0px");var d=this.upperGroupingTest(e,i,t),u=this.dataList._getCellData(e,i),p=WebSquare.style.getComputedStyle(h,"border-right-width"),c=WebSquare.style.getComputedStyle(h,"border-left-width"),g="";if("0px"!=p?g=WebSquare.style.getComputedStyle(h,"border-right-color"):"0px"!=c&&(g=WebSquare.style.getComputedStyle(h,"border-left-color")),l==u&&d){
null!=h&&(this.options.readOnly&&this.options.readOnlyBackgroundColor?h.style.borderBottomColor=r.style.backgroundColor:h.style.borderBottomWidth="0px");var f=a.Z.getDataPrefix("colMerged"),m=a.Z.getDataPrefix("viewType"),y=a.Z.getDataPrefix("inputType");if(this.options.readOnly&&this.options.readOnlyBackgroundColor?(r.style.borderTopColor=r.style.backgroundColor,r.style.borderBottomColor=r.style.backgroundColor,t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(h.style.borderBottomColor=g)):(r.style.borderTopWidth="0px",r.style.borderBottomWidth="0px"),r.setAttribute(f,"1"),this._getWrapperCell(r,e).innerHTML="",0!=n&&(r.style.borderBottomWidth="1px"),"icon"===r.getAttribute(m)){var b=r.getAttribute(y);this.removeClass(r,this.options.bodyTdClass+"_"+b)}if(null!=h&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else this.options.readOnly&&this.options.readOnlyBackgroundColor?h.style.borderBottomColor=g:r.style.borderTopWidth="1px"}},x.prototype.drawColMergeAndCellData=function(t,e,i,o){var s=this.getColumnID(i),r=this.data_td_list[i+t*this.oneRowDataLength];if(r.style.borderBottomWidth="0px",0!=t||o){var n=this.getHasSubtotalCount(e);if(0==n&&(r.style.borderBottomWidth="0px"),this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]},null==this.colMergeObj.colArr[i]){var l=this.dataList._getCellData(e-1,s),h=this.dataList._getCellData(e,s);if(this.colMergeObj.colArr[i]=l==h,this.colMergeObj.colArr[i])for(var d=0;d<this.oneRowDataLength;d++){if(null==this.colMergeObj.colArr[d])if(this.getCellInfo(d).options.colMerge){var u=this.getColumnID(d),p=this.dataList._getCellData(e-1,u),c=this.dataList._getCellData(e,u);this.colMergeObj.colArr[d]=p==c}else this.colMergeObj.colArr[d]=!0}}var g=!0;for(d=0;d<this.colMergeObj.colArr.length;d++)if(!this.colMergeObj.colArr[d]){g=!1;break}if(g){var f=this.data_td_list[i+(t-1)*this.oneRowDataLength];null!=f&&(f.style.borderBottomWidth="0px");var m=a.Z.getDataPrefix("colMerged");if(r.style.borderTopWidth="0px",r.style.borderBottomWidth="0px",r.setAttribute(m,"1"),this._getWrapperCell(r,e).innerHTML="",0!=n&&(r.style.borderBottomWidth="1px"),null!=f&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else r.style.borderTopWidth="1px"}},x.prototype.upperGroupingTest=function(t,e,i){try{var o=this.getCellInfo(e),r=o.options.upperColumn;if(this.hasSubtotal&&this.hasUpperSubtotalRow(t))return!1;if(""!=r){if(i){var n=a.Z.getDataPrefix("colMerged"),l=this.getColumnIndex(r),h=this.data_td_list[l+i*this.oneRowDataLength],d=this.getCellInfo(l);if(h&&""==h.style.width&&(""==d.options.upperColumn||d.options.upperColumn&&"1"!=h.getAttribute(n))&&"1"!=h.getAttribute(n)&&1==d.options.colMerge&&!this.groupbyStatus.grouped)return!1}if(this.dataList._getCellData(t,r)!=this.dataList._getCellData(t-1,r))return!1;var u=this.getCellInfo(r);if(u.options.upperColumn&&""!=u.options.upperColumn&&u.options.upperColumn!=o.id)return this.upperGroupingTest(t,r,i)}else{if(this.dataList._getCellData(t,e)!=this.dataList._getCellData(t-1,e))return!1}return!0}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.setDataTable=function(){try{var t=this.getElementById(this.id+"_head_table"),e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_body_tbody");if(this.dataLayerHeight=e.parentNode.offsetHeight,""===this.options.visibleRowNum&&0==this.dataLayerHeight)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex});this.defaultDataLayerHeight||(this.isIE6or7||a.Z.isOpera()?this.defaultDataLayerHeight=this.getElementById(this.id+"_main_div").offsetHeight:this.defaultDataLayerHeight=this.dataLayerHeight);var o=0,r=this.getDataLength();if(!0===this._isHybridScroll()){
var n=Math.ceil((this.render.offsetHeight-t.offsetHeight)/this.oneRowHeight),l=Math.min(this._getHybridRowNum()+n,r);o=Math.max(l,1)}else if(this.options.senseReader&&"all"===this.options.visibleRowNum)o=r;else if(""===this.options.visibleRowNum)if(this.options.initFixedHeightByRowNum>-1)o=parseInt(this.options.initFixedHeightByRowNum,10)+1;else{var h=this.oneRowHeight;this.hiddenCellObj.length>0&&(h=this.oneRowHeight/this.oneRowLength),o=parseInt((this.dataLayerHeight-t.offsetHeight)/h)+1}else o="all"===this.options.visibleRowNum?r:parseInt(this.options.visibleRowNum,10);if(0==this.drawedRowLength&&(this.tdCellClassArr=[],this.tdCellClassArr[o*this.oneRowLength-1]=this.tdCellClassArr),o>this.drawedRowLength){var d=this.drawedRowLength;this.drawedRowLength=o;var u=[],p=!!(this.subtotalStrList&&Object.keys(this.subtotalStrList).length>0);0==d&&p&&(u=u.concat(this.createSubtotalRows(-1)));for(var c=d;c<this.drawedRowLength;c++){var g=[];this.trRowClassArr.push(null);for(var f=0;f<this.oneRowLength;f++){var m=this.tempTr.rows[f].cloneNode(!0);g[f]=m,u.push(m),this.tdCellClassArr.push(null)}this.addBodyRow(c,g),p&&(u=u.concat(this.createSubtotalRows(c)))}0==this.drawedRowLength?e.style.borderWidth="0px":e.style.borderWidth="";for(f=0;f<u.length;f++)i.appendChild(u[f]);for(c=d+this.hiddenRowObj.extraRow;c<this.drawedRowLength+this.hiddenRowObj.extraRow;c++)this._setRowDisplay(c,"none")}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.applyStyleOptions=function(t){try{for(var e=this.rowIndex>=0?this.rowIndex:0,i=0;i<=t+1+this.hiddenRowObj.extraRow&&i<this.drawedRowLength+this.hiddenRowObj.extraRow;i++)"object"!=(0,l.A)(this.dataList.getRealRowIndex(i+e))&&(this.options.fixedRow>0&&i<=this.options.fixedRow-1||this.options.lastFixedRow>0&&i>t-this.options.lastFixedRow?this.applyRowStyleOptions(i):(!this.hiddenRowObj.length>0||this._getRowVisible(i+e))&&this.applyRowStyleOptions(i+e))}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._setCheckboxHead=function(t){try{if(t)if(1==this.htmlInfo.head.rowArr.length)this.checkHeader(this.bodyToHeaderRelation[t]);else for(var e in this.headerToBodyRelation)this.headerToBodyRelation[e]==t&&this.checkHeader(e);else for(var e in this.headerInfoHash)this.checkHeader(e)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.applyColumnStyleOptions=function(t){try{t=this.getColumnIndex(t);for(var e=0;e<this.drawedRowLength;e++)this.applyCellStyleOptions(e+this.rowIndex,t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.applyRowStyleOptions=function(t,e){try{var i=this._getTrIndex(t);e&&(i=this._getTrIndex(this.getDisplayRowIndex(t)));for(var o=0,r=this.rowIndex;r<t&&this.hiddenRowObj.length>0;r++)this._getRowVisible(r)||o++;if(i<0||i-o>=this.drawedRowLength)return;var a=this.dataRowList[this.oneRowLength*i];if(!a&&!e)return;if(a&&"none"==a.style.display&&!e)return;if(this.options.fixedRow>0&&i==this.options.fixedRow-1){var n=this.dataRowList[this.oneRowLength*(i+1)-1];this.addClass(n,"w2grid_fixedRow")}if(this.options.lastFixedRow>0&&i==this.lastIndex-this.options.lastFixedRow+1){n=this.dataRowList[this.oneRowLength*(i-1)];this.addClass(n,"w2grid_lastFixedRow")}if(this.options.lazyDrawHiddenColumn){var l=this.colIndexInfo.body.visibleTds,h=i*this.oneRowDataLength;for(r=this.defaultColCnt;r<l.length;r++){var d=l[r]-this.defaultColCnt;this.all_data_td_list[h+d]&&(e?this.applyCellStyleOptions(this.getDisplayRowIndex(t),d):this.applyCellStyleOptions(t,d))}}else for(r=0;r<this.oneRowDataLength;r++){h=i*this.oneRowDataLength;this.data_td_list[h+r]&&(e?this.applyCellStyleOptions(this.getDisplayRowIndex(t),r):this.applyCellStyleOptions(t,r))}var u=!0===this._isHybridScroll(),p=a,c="w2grid_lastRow_hybrid";if(this.hasSubtotal&&this.lastSubtotalRow?(p=this.lastSubtotalRow,c="w2grid_lastRow_subtotal_hybrid"):this.oneRowLength>1&&(p=this.dataRowList[this.oneRowLength*(i+1)-1]),t===this.getRowCount()-1?(this.__addClass(a,"w2grid_lastRow"),
u&&this.__addClass(p,c)):this.hasClass(a,"w2grid_lastRow")&&(this.__removeClass(a,"w2grid_lastRow"),u&&this.__removeClass(p,c)),this.hasSubtotal&&!0===this._isBrowserScroll()){var g="w2grid_firstRow_subtotal_native";0===t?this.__addClass(a,g):this.hasClass(a,g)&&this.__removeClass(a,g)}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.setAutoResizeEmbeddedInput=function(){try{for(var t=this.data_td_list,e="",i=null,o=null,r=0,n=0,l=!1,h=a.Z.getDataPrefix("inputType"),d=a.Z.getDataPrefix("colindex"),u=a.Z.getDataPrefix("col_id"),p=a.Z.getDataPrefix("rowindex"),c=0;c<t.length;c++){var g=this._getWrapperCell(t[c],t[c].getAttribute(p));if("text"==t[c].getAttribute(h)||"secret"==t[c].getAttribute(h)){e=t[c].getAttribute(u),o=this.cellInfoHash[e];var f=!1;if((this.dom[o.mainGridId+o.id]||this.dom[t[c].getAttribute("id")+"_"+t[c].getAttribute(h)])&&(f=!0),1==o.options.embeddedInput&&f){i=this.getInput(o,t[c]),null==this._getWrapperTD(i.render.parentNode)&&(g.innerHTML="",g.appendChild(i.render)),"none"==t[c].parentNode.style.display&&(t[c].parentNode.style.display="",l=!0);var m=parseInt(t[c].getAttribute(d),10);this.embeddedStyleObj||(this.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t[c],"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t[c],"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t[c],"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t[c],"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(i.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(i.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(i.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(i.render,"padding-right"),10)});var y=parseInt(WebSquare.style.getStyle(i.render,"border-top-width"),10),b=parseInt(WebSquare.style.getStyle(i.render,"border-bottom-width"),10),v=parseInt(WebSquare.style.getStyle(i.render,"border-left-width"),10),w=parseInt(WebSquare.style.getStyle(i.render,"border-right-width"),10);r=t[c].offsetHeight-parseInt(WebSquare.style.getStyle(t[c],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[c],"border-bottom-width"),10),r-=this.embeddedStyleObj.top+this.embeddedStyleObj.bottom,r-=y+b,this.embeddedWidthObj[m]&&!this.embeddedWidthObj[m].isChanged||(this.embeddedWidthObj[m]={isChanged:!1,width:t[c].clientWidth}),n=this.embeddedWidthObj[m].width,n-=this.embeddedStyleObj.left+this.embeddedStyleObj.right,n-=v+w,n-=this.embeddedStyleObj.inputLeft+this.embeddedStyleObj.inputRight,a.Z.isOpera()&&(r+=2),l?t[c].parentNode.style.display="none":a.Z.isIE("6 7")&&(r-=2),i.setSize(n-2,r-(this.embeddedStyleObj.inputTop+this.embeddedStyleObj.inputBottom)),i.setStyle("lineHeight",r+"px")}}else if("calendar"==t[c].getAttribute(h)){e=t[c].getAttribute(u),o=this.cellInfoHash[e];var C=null;if(1==o.options.embeddedInput){C=this.getInput(o,t[c]),null==this._getWrapperTD(C.render.parentNode)&&(g.innerHTML="",g.appendChild(C.render)),"none"==t[c].parentNode.style.display&&(t[c].parentNode.style.display="",l=!0),r=t[c].offsetHeight-parseInt(WebSquare.style.getStyle(t[c],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[c],"border-bottom-width"),10),r-=this.embeddedCalendarStyleObj.top+this.embeddedCalendarStyleObj.bottom;m=parseInt(t[c].getAttribute(d),10);this.embeddedWidthObj[m]&&!this.embeddedWidthObj[m].isChanged||(this.embeddedWidthObj[m]={isChanged:!1,width:t[c].clientWidth}),n=this.embeddedWidthObj[m].width,n-=this.embeddedCalendarStyleObj.left+this.embeddedCalendarStyleObj.right,l?t[c].parentNode.style.display="none":a.Z.isIE("6 7")&&(r-=2),C.setSize(n-2,r)}}}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.applyCellStyleOptions=function(t,e,i,o){try{var r=this._getTrIndex(t),n=this._getTdElem(t,e);if(n){var l,h,d,u=[],p=!1;if("number"==typeof e?(l=e,h=this.cellIdList[e]):(l=this.bodyIdColIndexMap[e],h=e),this._linkedDataList)d=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var c=!0
;for(var g in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[g]){d=this._dataList.filteredRowIndexArr[t],c=!1;break}c&&(d=this.groupbyStatus.groupedRowIndexArr[t])}else d=this._dataList.filteredRowIndexArr[t];var f=this.cellInfoHash[h]||{options:{}};if("custom"==f.options.inputType&&(f=f.cellManagerHashByRowIndex[d]?f.cellManagerHashByRowIndex[d]:f),"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&"true"==f.options.hidden)return;null!=this.initStyleValueObj[l]&&u.push(this.initStyleValueObj[l].style),""!=f.options.textAlign&&u.push("text-align:"+f.options.textAlign),this.options.adjustAlign&&"left"==f.options.textAlign&&u.push("padding-left:"+this.options.adjustAlign+"px"),null!=this.defaultStyleValueObj[l]&&u.push(this.defaultStyleValueObj[l].style);var m=null,y=null,b=null,v=null,w=null,C=null,I=!1;(t<this.options.fixedRow||l<this.options.fixedColumn||l>=this.tdIdList.length-this.options.fixedRightColumn)&&(I=!0),null!=d?(m="number"==typeof d?this.rowStyleArr[d]:this.rowStyleArr[d.type+"_"+d.groupId],y="number"==typeof d?this.rowStyleFixedArr[d]:this.rowStyleFixedArr[d.type+"_"+d.groupId],b="number"==typeof d?this.rowStyleDataArr[d]:this.rowStyleDataArr[d.type+"_"+d.groupId],w="number"==typeof d?this.cellStyleArr[d*this.oneRowDataLength+l]:this.cellStyleArr[d.type+"_"+d.groupId+"_"+l],C=this.cellClassArr[d*this.oneRowDataLength+l],v="number"==typeof d?this.rowClassArr[d]:this.rowClassArr[d.type+"_"+d.groupId]):(C=this.cellClassArr[t*this.oneRowDataLength+l],v=this.rowClassArr[t]),null!=m&&u.push(this.rowStyleValueObj[m].style),null!=y&&I&&u.push(this.rowStyleFixedValueObj[y].style),null==b||I||u.push(this.rowStyleDataValueObj[b].style);var _=this.columnStyleValueObj[l],x=this.columnStyleFixedValueObj[l],S=this.columnStyleDataValueObj[l];null!=_&&u.push(this.columnStyleValueObj[l].style),null!=x&&I&&u.push(this.columnStyleFixedValueObj[l].style),null==S||I||u.push(this.columnStyleDataValueObj[l].style),null!=this.adaptiveColumnStyleValueObj[l]&&!0===this.checkRefreshAdaptive()&&u.push(this.adaptiveColumnStyleValueObj[l].style),null!=w&&u.push(this.cellStyleValueObj[w].style),m=="rowResizeStyle_"+t&&u.push(this.rowStyleValueObj[m].style);var R=this.___getEditReadOnly(t,e),D=this.cellDisabledArr[d*this.oneRowDataLength+l],T=D;if(!0!==D&&!1!==D){var L=f.options.disabled,k=this.rowDisabledArr[d],F=this.options.disabledPriority;!0!==k&&!1!==k&&(k=""),D="column"===F&&""!==L?L:"row"===F&&""!==k?k:L+""=="true"||k+""=="true"||L+""!="false"&&k+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}var A=!0===D||"true"===D;""!=this.options.readOnlyBackgroundColor&&"number"==typeof d&&(1==R?(u.push(this.readOnlyTdStyle),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||(A?n.setAttribute("tabIndex",-1):n.setAttribute("tabIndex",0)))),""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(1==R?(u.push(this.readOnlyTdImg),this.options.readOnlyBackgroundImgCSS||(a.Z.isIE(8)||a.Z.isIE(6)||a.Z.isIE(7))&&(u.push("filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\""),u.push("-ms-filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\"")),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||(A?n.setAttribute("tabIndex",-1):n.setAttribute("tabIndex",0)))),n.disabled=!1,n.removeAttribute("disabled"),A&&(u.push(this.disabledTdStyle),
this.disabledCellStyleObj&&this.disabledCellStyleObj[t+"_"+e]&&this.disabledCellStyleObj[t+"_"+e].style&&u.push(this.disabledCellStyleObj[t+"_"+e].style));var E=this.options.focusMode;if(o&&(E="cell"),!i&&"transparent"!=this.options.selectedRowColor&&("row"==E||"both"==E))for(var M=0;M<this.focusedCell.length;M++)if(t==this.focusedCell[M].focusedRowIndex&&!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&e<this.options.fixedColumn)){u.push("background-color:"+this.options.selectedRowColor),p=!0;break}if(!i&&"transparent"!=this.options.selectedCellColor&&("cell"==E||"both"==E))for(M=0;M<this.focusedCell.length;M++)if(t==this.focusedCell[M].focusedRowIndex&&e==this.focusedCell[M].focusedColIndex){u.push("background-color:"+this.options.selectedCellColor),p=!0;break}("none"!=n.style.display||this.hiddenCellObj.length>0)&&!0!==this.hiddenCellObj[t+"_"+e]||u.push("display:none");var O=!1;this.hiddenCellObj.length>0&&(!0===this.hiddenCellObj[t+"_"+e]&&"none"!==n.style.display||!0!==this.hiddenCellObj[t+"_"+e]&&"none"===n.style.display)&&(O=!0);var N=u.join(";"),H=a.Z.getDataPrefix("style_bak"),G=a.Z.getDataPrefix("colMerged"),W=a.Z.getDataPrefix("or_bgColor"),B=n.style.borderBottomWidth;(N!=n.getAttribute(H)||this.groupbyStatus.grouped||O)&&(n.style.cssText=N);var V=this.cellStyleValueObj[w];if(V&&V["background-repeat"]?n.style.backgroundRepeat=V["background-repeat"]:V&&V["background-size"]?n.style.backgroundSize=V["background-size"]:V&&V["background-position"]&&(n.style.backgroundPosition=V["background-position"]),this.isColMerge&&f.options.colMerge&&!this.groupbyStatus.grouped){n.setAttribute(G,"0");var q=this.drawColMergeCellData(r,t,e);if(this.options.senseReader&&B&&-1!=B.indexOf("px")&&(n.style.borderBottomWidth=B),"mergeCellBackgroundColor"===q&&!p){var Y,Z=this.getCellStyleValue(t-1,h,"background-color",!0)||this.getColumnStyleValue(e,"background-color"),j=!0;n.readOnly||this.__getEditReadOnly(n,t)?(Y=Z,this.options.readOnlyBackgroundColor?Y=this.options.readOnlyBackgroundColor:(f.options.readOnlyClass||this.options.readOnlyClass)&&(j=!1)):(Y=""!=Z?Z:t%2?this.options.oddRowBackgroundColor:this.options.evenRowBackgroundColor,this.options.disabledClass&&A&&(j=!1)),j&&(n.style.backgroundColor=Y,this._setMergeCellBackground(t,h,Y)),""!=f.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,f.options.readOnlyClass):this.removeClass(n,f.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,this.options.readOnlyClass):this.removeClass(n,this.options.readOnlyClass))}}if(n.setAttribute(H,N),n.setAttribute(W,n.style.backgroundColor),this.cellReadOnlyArr[d*this.oneRowDataLength+e]||R?(n.setAttribute("readonly","true"),this.options.senseReader&&!f.options.embeddedInput?"linear"===this.options.focusFlow&&"button"!=f.options.inputType&&n.setAttribute("tabIndex",-1):"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):!1===this.cellReadOnlyArr[d*this.oneRowDataLength+e]||!1===R?(n.setAttribute("readonly","false"),this.options.senseReader&&!f.options.embeddedInput?"linear"===this.options.focusFlow&&(A?n.setAttribute("tabIndex",-1):n.setAttribute("tabIndex",0)):"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||(A?n.setAttribute("tabIndex",-1):n.setAttribute("tabIndex",0))):n.removeAttribute("readonly"),null!=C){var P=r*this.oneRowDataLength+e;this.tdCellClassArr[P]&&this.tdCellClassArr[P]!=C&&this.removeClass(n,this.tdCellClassArr[P]),this.tdCellClassArr[P]=C,this.addClass(n,C)}else{P=r*this.oneRowDataLength+e;this.tdCellClassArr[P]&&(this.removeClass(n,this.tdCellClassArr[P]),this.tdCellClassArr[P]=void 0)}if(null!=v){P=r;this.trRowClassArr[r]&&this.trRowClassArr[r]!=v&&this.removeClass(n.parentNode,this.trRowClassArr[r]),this.trRowClassArr[r]=v,this.addClass(n.parentNode,v)
}else this.trRowClassArr[r]&&(this.removeClass(n.parentNode,this.trRowClassArr[r]),this.trRowClassArr[r]=void 0);if(""!=f.options.disabledClass&&(A?this.addClass(n,f.options.disabledClass):this.removeClass(n,f.options.disabledClass)),!0!==T&&"true"!==T||(""!=this.options.disabledClass?this.addClass(n,this.options.disabledClass):this.removeClass(n,this.options.disabledClass)),""!=this.options.hiddenClass||""!=f.options.hiddenClass){var z=this.options.hiddenClass;""!=f.options.hiddenClass&&(z=f.options.hiddenClass);var U=this._getRealColIndex("body",f.options.col_id)+this.defaultColCnt;this.hiddenList[U]?this.addClass(n,z):this.removeClass(n,z)}}}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.dynamicMergeHTML=function(){try{for(var t in this.tdMergeInfo){var e=this.data_td_list[t];this.tdMergeInfo[t].orgColSpan>1?e.setAttribute("colSpan",this.tdMergeInfo[t].orgColSpan):e.removeAttribute("colSpan"),this.tdMergeInfo[t].orgRowSpan>1?e.setAttribute("rowSpan",this.tdMergeInfo[t].orgRowSpan):e.removeAttribute("rowSpan"),e.style.display=this.tdMergeInfo[t].display,delete this.tdMergeInfo[t]}var i=this.getRowCount(),o=!0===this._isBrowserScroll()?i:Math.min(this.lastIndex+2,i),r=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=!1;for(var l in this.cellMergeInfo){var h=l.split("_"),d=Number(h[0]),u=d;if(!(r&&(d=this.getDisplayRowIndex(d),isNaN(d)||d<0))){var p=Number(h[1]),c=d;this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>d||this.options.lastFixedRow>0&&d>this.lastIndex-this.options.lastFixedRow||(c-=this.rowIndex));var g=this.cellMergeInfo[l].rowSpan,f=this.cellMergeInfo[l].colSpan;if(r){for(var m=g,y=0;y<m;y++)0==this.drilldown.statusArr[u+y]&&g--;g=Math.max(g,1)}var b=0;if(this.hiddenRowObj.length>0)for(y=this.rowIndex;y<d;y++)this._getRowVisible(y)||b++;if(!(c<0&&c+g<=0||c-b>=o||(c<this.options.fixedRow&&c+g>this.options.fixedRow&&(g=c+g-this.options.fixedRow-b,c=this.options.fixedRow),c<this.options.fixedRow&&d>=this.options.fixedRow))){var v=0,w=0;if(this.hiddenRowObj.length>0)for(y=0;y<g;y++)this._getRowVisible(c+y+this.rowIndex)||(w++,y===v&&v++);c+(g-=w)>o+b&&(g=o-c+b);var C=g,I=this.oneRowLength;for(y=0;y<C;y++){for(var _=!1,x=0;x<f;x++){t=(c+y)*this.oneRowDataLength+(p+x);if(null!=(e=this.data_td_list[t]))if(this.hiddenRowObj.length>0&&!this._getRowVisible(c+y+this.rowIndex))e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),_=!0;else if(this.tdMergeInfo[t]={orgColSpan:e.getAttribute("colSpan"),orgRowSpan:e.getAttribute("rowSpan"),display:e.style.display},y===v&&0===x){f>1?(e.setAttribute("colSpan",f),n=!0):e.removeAttribute("colSpan");var S=g*I;if(S>1)if(I>1){var R=parseInt(e.getAttribute("rowSpan"),10);!isNaN(R)&&R>1&&(e.setAttribute("rowSpan",S),n=!0)}else e.setAttribute("rowSpan",g),n=!0;else e.removeAttribute("rowSpan");e.style.display=""}else e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),e.style.display="none"}!0===_&&C++}}}}!0===n&&this.isWebKit&&a.Z.setTimeout(this.redrawTable,{key:this.id+"_dynamicMergeHTML",delay:50,caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.createSubtotalRows=function(t){var e=[];for(var i in this.subtotalTableList){var o=this.subtotalRowHash[i];null==o&&(o=[]);for(var s=this.subtotalTableList[i],r=0;r<s.rows.length;r++){var a=s.rows[r].cloneNode(!0);if(a.style.display="none",this.options.rowNumStatusUniqueId)for(var n=a.getElementsByTagName("td"),l=0;l<this.defaultColCnt;l++){var h=n[l].getAttribute("id");"_headerRowNumber"!==h&&"_headerRowStatus"!==h||n[l].setAttribute("id",h+"_subtotal_"+t)}a.setAttribute("data-subtotal",i+"_"+r),o.push(a),e.push(a)}this.subtotalRowHash[i]=o}return e},x.prototype.addBodyRow=function(t,e){var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),r=0,n=0,l="grid_body_row"
;!0===this._isBrowserScroll()&&(l+=" "+this.options.gridNativeClass);for(var h=a.Z.getDataPrefix("tdIndex"),d=a.Z.getDataPrefix("or_wd"),u=a.Z.getDataPrefix("col_id"),p=a.Z.getDataPrefix("width"),c=0;c<e.length;c++){this.dataRowList.push(e[c]),e[c].className=l;for(var g=e[c].getElementsByTagName("td"),f=0;f<g.length;f++){var m=g[f],y=m.className;m.setAttribute(h,t*this.realRowDataLength+r),m.removeAttribute("title");var b=m.getAttribute(p);if(b&&(m.removeAttribute(p),m.setAttribute(d,b)),this.options.rowNumStatusUniqueId){var v=m.getAttribute("id");"_headerRowNumber"!==v&&"_headerRowStatus"!==v||m.setAttribute("id",v+"_bodyRow_"+t)}if(r++,this.all_data_td_list.push(m),i.test(y))this.data_num_td_list.push(m);else if(o.test(y))this.data_status_td_list.push(m);else if(!this.hasSubtotal||s.test(y)){this.data_td_list.push(m);var w=this.id+"_columnstyle_"+n+"_";this.addClass(m,w);var C=m.getAttribute(u),I=this.getCellInfo(C);if(this.addClass(m,I.options.className),m.style.cssText=""==I.options.textAlign?"":"text-align:"+I.options.textAlign+";",m.setAttribute("id",this.id+"_cell_"+t+"_"+n),this.options.fixedColumn>0){var _=this.getFixedColumnLastIndex();_==f&&this.addClass(m,"w2grid_fixedColumn"),_>f&&this.addClass(m,"w2grid_fixedColumn_td")}if(this.options.fixedRightColumn>0){var x=this.getFixedRightColumnLastIndex();x==f&&this.addClass(m,"w2grid_fixedRightColumn"),x<=f&&this.addClass(m,"w2grid_fixedRightColumn_td")}n++,"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(I.options.embeddedInput||"custom"==I.options.inputType&&1==this.options.senseReader||("link"!=I.options.inputType&&"button"!=I.options.inputType&&"image"!=I.options.inputType&&"user"!=I.options.inputType&&"ul"!=I.options.tableRender&&("expression"==I.options.inputType&&1==this.options.senseReader||m.setAttribute("tabIndex","0")),this.event.addListener(m,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}!0===this._isBrowserScroll()&&this.addClass(m,this.options.gridNativeClass)}}var S=[];if(!this.options.duplicateColumnId){for(c=0;c<e.length;c++){g=e[c].getElementsByTagName("td");var R=[];for(f=0;f<g.length;f++)R[f]=g[f];for(f=0;f<R.length;f++){y=R[f].className;i.test(y)||o.test(y)||S.push(R[f].parentNode.removeChild(R[f]))}}for(c=0;c<this.htmlInfo.body.rowArr.length;c++)for(f=0;f<this.htmlInfo.body.rowArr[c].length;f++)for(var D=this.htmlInfo.body.rowArr[c][f].col_id,T=0;T<S.length;T++)if(S[T].getAttribute(u)==D){e[c].appendChild(S[T]);break}}},x.prototype.addBodyRow2=function(t,e){for(var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),r=[],n=a.Z.getDataPrefix("tdIndex"),l=a.Z.getDataPrefix("or_wd"),h=a.Z.getDataPrefix("col_id"),d=a.Z.getDataPrefix("width"),u=0;u<e.length;u++){this.dataRowList.push(e[u]),e[u].className="grid_body_row";for(var p=e[u].getElementsByTagName("td"),c=0;c<p.length;c++){var g=p[c],f=g.className,m=parseInt(g.getAttribute(n),10)%this.realRowDataLength;g.setAttribute(n,t*this.realRowDataLength+m),g.removeAttribute("title");var y=g.getAttribute(d);if(y&&(g.removeAttribute(d),g.setAttribute(l,y)),this.options.rowNumStatusUniqueId){var b=g.getAttribute("id");"_headerRowNumber"!==b&&"_headerRowStatus"!==b||g.setAttribute("id",b+"_bodyRow_"+t)}if(i.test(f))this.data_num_td_list.push(g),this.all_data_td_list.push(g);else if(o.test(f))this.data_status_td_list.push(g),this.all_data_td_list.push(g);else if(!this.hasSubtotal||s.test(f)){var v=m-this.defaultColCnt;r[v]=g;var w=this.id+"_columnstyle_"+v+"_";this.addClass(g,w);var C=g.getAttribute(h),I=this.getCellInfo(C);this.addClass(g,I.options.className),g.style.cssText=""==I.options.textAlign?"":"text-align:"+I.options.textAlign+";",g.setAttribute("id",this.id+"_cell_"+t+"_"+v),
"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(I.options.embeddedInput||("link"!=I.options.inputType&&"button"!=I.options.inputType&&"image"!=I.options.inputType&&g.setAttribute("tabIndex","0"),this.event.addListener(g,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}}}[].push.apply(this.all_data_td_list,r),[].push.apply(this.data_td_list,r)},x.prototype.addRows=function(t){for(var e=this.drawedRowLength,i=[],o=0;o<t;o++){for(var s=0;s<this.oneRowLength;s++){var r=this.tempTr.rows[s].cloneNode(!0);i.push(r)}this.addBodyRow(e+o,[]),this.hasSubtotal&&(i=i.concat(this.createSubtotalRows(e+o)))}var a=this.getElementById(this.id+"_body_tbody");for(o=0;o<i.length;o++)a.appendChild(i[o])},x.prototype.notifyStatusChanged=function(t){var e,i,o=!1;"object"==(0,l.A)(t.rowIndex)?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getRowCount()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var s=e;s<i;s++){var r;if(r=o?t.rowIndex[s]:s,null!=this.rowStatusColIDArr)for(var a=0;a<this.rowStatusColIDArr.length;a++){var n=this.getColumnIndex(this.rowStatusColIDArr[a]);this.drawCellData(r-this.rowIndex,r,n)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))},x.prototype.refreshColumn=function(t){try{t=this.getColumnIndex(t),this.redrawColumn(t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.refreshRow=function(t){try{var e=t-this.rowIndex;this.drawRowData(e,t)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype.refreshCell=function(t,e){try{e=this.getColumnIndex(e);var i=t-this.rowIndex;this.drawCellData(i,t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._setVisibleRowNumFix=function(){try{if(!this.options.visibleRowNumFix)return;var t=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(t)||t<0||""==t)return;!0===this._visibleRowNumFixResetFlag&&this.setTrRowTable();var e=this._getVisibleRowNumHeight(!0);this.setSize(null,e)}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._getVisibleRowNumHeight=function(t){try{var e=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(e))return 0;!0===t&&this.oneRowLength>1&&(e*=this.oneRowLength);var i=this.getElementById(this.id+"_scrollX_div"),o=parseInt(i.style.height,10),r=0;this.hasFooter&&(r=0==(r=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:r);var a=this.getElementById(this.id+"_head_table").offsetHeight;return this.oneRowHeight*e+a+o+r+1}catch(t){s.Y.printStackTrace(t,null,this)}},x.prototype._getDrawedRowCount=function(){try{for(var t=0,e=this.getElementById(this.id+"_body_tbody").childNodes,i=0;i<e.length;i++){e[i].offsetHeight>0&&t++}}catch(e){s.Y.printStackTrace(e,null,this),t=this.drawedRowLength}return t};var S=function(){};S.prototype.setCellInfo=function(){for(var t=a.Z.getDataPrefix("inputType"),e=a.Z.getDataPrefix("depthColumn"),i=a.Z.getDataPrefix("showDepth"),o=this.tempDiv.getElementsByTagName("td"),s=0;s<o.length;s++){"drilldown"==o[s].getAttribute(t)&&(this.isDrillDown=!0,this.depthColumn=o[s].getAttribute(e),this.showDepth=o[s].getAttribute(i),this._dataList.options.depthColumn||"grid"==this.options.pluginName&&!this.options.drilldownRealRowIndex||(this._dataList.options.depthColumn=this.depthColumn))}},S.prototype.setDataListCellInfo=function(){if(this.successBinding)for(var t=this.getColCnt(),e=0;e<t;e++){var i=this.getColumnID(e),o=this.getCellInfo(i);if(o&&o.options&&o.options.importExp){var s=this._dataList.getCellInfo(i);s&&s.options&&!s.options.importExp&&(s.options.importExp=o.options.importExp)}}},S.prototype.setInnerHTML=function(t,e,i,o){
var s=this.getColumnID(i),r=this.dataList._getCellData(e,s),a=this.cellInfoHash[this.tdIdList[i]];""===r&&(r=a.options.groupName?this.dataList._getCellData(e,a.options.groupName)==a.options.groupValue?a.options.trueValue:a.options.falseValue:a.options.defaultValue);if(a.setInnerHTML(t,r,e,i,o),""!=a.options.disabledClass&&(this._getEditDisabled(e,i)?this.addClass(t,a.options.disabledClass):this.removeClass(t,a.options.disabledClass)),""!=this.options.disabledClass&&!1===this.options.disabled&&(this._getEditDisabled(e,i)?this.addClass(t,this.options.disabledClass):this.removeClass(t,this.options.disabledClass)),""!=a.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,a.options.readOnlyClass):this.removeClass(t,a.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,this.options.readOnlyClass):this.removeClass(t,this.options.readOnlyClass)),""!=this.options.hiddenClass||""!=a.options.hiddenClass){var n=this.options.hiddenClass;""!=a.options.hiddenClass&&(n=a.options.hiddenClass);var l=this._getRealColIndex("body",s)+this.defaultColCnt;this.hiddenList[l]?this.addClass(t,n):this.removeClass(t,n)}},S.prototype.getCellInfo=function(t){try{var e=a.Z.getDataPrefix("col_id"),i="";return i="string"==typeof t?t:"number"==typeof t?this.tdIdList?this.tdIdList[t]:"":t?t.getAttribute(e):null,this.cellInfoHash[i]||{options:{}}}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype._endEdit=function(){null!=this.editedCell&&this.editedCell.handleEndEdit()},S.prototype.initColumns=function(){for(var t in this.cellInfoHash){var e=this.cellInfoHash[t];if("select"==e.options.inputType&&(e.initializeCellInfo(e.element),e.style="",e.comp=null),this.options.initColumns)for(var i in e.dynamicAttrInfo){var o=e.dynamicAttrInfo[i];o&&(e.options[i]=o.originalValue,"displayFormat"!=i&&"displayFormatter"!=i||e.initFormatter())}}},S.prototype.initHeaders=function(){for(var t in this.headerInfoHash){"checkbox"==this.headerInfoHash[t].options.inputType&&this.setHeaderValue(t,!1)}},S.prototype._setCellInfo=function(t,e){this.cellInfoHash2[t]=e},S.prototype.getColumnCount=function(){return this.tdIdList.length},S.prototype.getColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[t];return e||null},S.prototype.getMovedColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[this.columnOrder[t]];return e||null},S.prototype.getColumnIndex=function(t){return"number"==typeof t?t:this.bodyIdColIndexMap[t]},S.prototype.getDisplayColumnIndex=function(t){return"number"==typeof t?t:this.colMoveIndexMap[t]},S.prototype.setExpressionAssociation=function(t,e){try{null==this.expressionAssArr[t]&&(this.expressionAssArr[t]=[]),this.expressionAssArr[t].push(e)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.setLabelColumnAssociation=function(t,e){try{null==this.labelColumnAssArr[t]&&(this.labelColumnAssArr[t]=[]),this.labelColumnAssArr[t].push(e)}catch(t){s.Y.printStackTrace(t,null,this)}},S.prototype.setCellEditMode=function(t,e){this.hideTooltip();var i=this.getCellInfo(t);this.editedCell=i,this.rollbackCommitFlag=!1;var o=this.render.offsetWidth,s=this.render.offsetHeight;i.setEditMode(t,e),o===this.render.offsetWidth&&s===this.render.offsetHeight||(this.handleResize(),i.setEditMode(t,e)),this.rollbackCommitFlag=!0},S.prototype.setCellClickEdit=function(t){var e=this.getElemRowIndex(t),i=this.getCellInfo(t);if("custom"==i.options.inputType&&!i.internal){var o=e;this.isDrillDown&&this._dataList.options.depthColumn&&(o=this.getRealRowIndex(e)),i=i.cellManagerHashByRowIndex[o]?i.cellManagerHashByRowIndex[o]:i}var s=!1;switch(i.options.inputType){case"checkbox":case"radio":case"drilldown":s=i.handleClick(t,e)}return s},S.prototype.getInput=function(t,e,i){var n=t.options.inputType||"text",l=t.options.embeddedInput,h=this.getColumnOption(t.id,"dataType");"text"===n&&"number"===h&&"true"===this.options.floatNumber&&(h="float",t.options.dataType="float")
;var d,u="bigDecimal"==h,g=this;if(this.options.titleFormatter&&e)try{if("function"!=typeof this.options.titleFormatter){var f=a.Z.getGlobalFunction(this.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.options.titleFormatter=f,d=f.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i))}else d=this.options.titleFormatter.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i)}catch(t){s.Y.printStackTrace(t,null,this)}var m,y=a.Z.getDataPrefix("col_id"),b=a.Z.getDataPrefix("rowIndex"),v=a.Z.getDataPrefix("rowindex");if(e&&e instanceof HTMLElement&&(m=this._getWrapperCell(e,e.getAttribute(v))),l){if("custom"==t.options.inputType&&!t.internal){var w=this.getElemRowIndex(e);this.isDrillDown&&this._dataList.options.depthColumn&&(w=this.getRealRowIndex(w)),t=t.cellManagerHashByRowIndex[w]?t.cellManagerHashByRowIndex[w]:t}t.parentColumnInfo?C=this.id+"_"+t.id:e?C=e.getAttribute("id")+"_"+n:"calendar"===n&&(C=this.id+"_cell_0_0_"+n),this.fakeInput||"text"!=n&&"secret"!=n&&"calendar"!=n&&"textImage"!=n||(this.makeFakeInput=function(){this.fakeInput=new WebSquare.uiplugin.input(this.id+"_fakeInput",{style:"visibility:hidden;position:absolute;z-index:100;background-color:"+this.options.selectedCellColor,className:"w2grid_embedded_input",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",useKeyupBlur:!1,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){g.lastEvent=t,p.f.stopEvent(t);var e=this;setTimeout((function(){e.lastInput.focus()}),1)}}},{name:"oncontextmenu",action:"script",param:{handler:function(t){g.lastEvent=t}}},{name:"ondblclick",action:"script",param:{handler:function(t){g.lastEvent=t,g.hideFakeInput(this),p.f.stopPropagation(t),g.F2Mode=!0,WebSquare.text.setCaretPos(this.lastInput.render,this.lastInput.render.value.length)}}}]}),this.fakeInput.setAction=function(){},this.fakeInput.writeTo(this.render),this.fakeInput.activate(),this.fakeInput.render.parentNode.removeChild(this.fakeInput.render);var t=null;this.showFakeInput=function(e){var i=this._getWrapperTD(e.render.parentNode);if(this.render.appendChild(this.fakeInput.render),!t){var o=this.all_data_td_list[0];t=1-o.offsetLeft}var s=this.getElementById(this.id+"_dataLayer");this.fakeInput.setPosition(i.offsetLeft+t-s.scrollLeft,i.offsetTop+t-s.scrollTop),this.fakeInput.setSize(i.clientWidth,i.clientHeight),a.Z.isIE()&&this.fakeInput.setVerticalAlign(),this.fakeInput.lastInput=e;var r=e.getStyle("text-align");r?this.fakeInput.setStyle("text-align",r):this.fakeInput.setStyle("text-align","")},this.hideFakeInput=function(t){this.fakeInput.render.parentNode&&this.fakeInput.render.parentNode.removeChild(this.fakeInput.render)}})}else var C=t.mainGridId+t.id;var I=!!(q=this.dom[C]);q&&(q.render?"select"!=n||!l||q.render.parentElement||this.groupbyStatus.grouped||(I=!1):q.ownerDocument&&!q.parentNode&&(I=!1)),I&&""!==d&&null!=d&&("text"==n?q.render.setAttribute("title",d):q.setAttribute("title",d));a.Z.getDataPrefix("dateValidCheck");if(I){if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),A=(L=t.mainGridId+"_checkbox_"+t.id)+"_"+k,E=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(M=t.options.checkboxLabelColumn.split(","),O="",N=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showCheckboxLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showCheckboxLabelUserFormat){W=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+W+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}E=E?O+N+E:O}
if(t.options.checkboxLabelFormatter)try{"function"==typeof(B=a.Z.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(E=B.call(this,F,this.getColumnIndex(t.colID),E))}catch(e){c.v.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}t.getEscape()&&(E=WebSquare.xml._encode(E+"")),(_=e.getElementsByTagName("label")[0])&&(_.innerHTML=E)}}else if("radio"==n&&l){if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var _;k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),j=(Z=t.mainGridId+"_radio_"+t.id)+"_"+k,P=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(M=t.options.radioLabelColumn.split(","),O="",N=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showRadioLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showRadioLabelUserFormat){W=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+W+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}P=P?O+N+P:O}if(t.options.radioLabelFormatter)try{"function"==typeof(z=a.Z.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(P=z.call(this,F,this.getColumnIndex(t.colID),P))}catch(e){c.v.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}t.getEscape()&&(P=WebSquare.xml._encode(P+"")),(_=e.getElementsByTagName("label")[0])&&(_.innerHTML=P)}}else if("text"==n&&l){if(!(U=d||t.options.title||"")){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";this.options.titleAuto&&(U=""==i||null==i?S:S+" "+i,q.render.title=U)}}this.options.titleFormatter&&l&&d&&q.title!==d&&(q.title=d)}else{if("text"!=n&&"secret"!=n&&"textImage"!=n||!l){if("select"==n&&l){var x=d||t.options.title||"";if(this.options.titleAuto&&!x){var S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";x=""!==i&&null!=i?S+" "+(this.changeItemValue("label",t.id,[i])[0]||i):S+WebSquare.language.getMessage("Grid_select")}q=new WebSquare.uiplugin.selectbox_native(C,{className:"w2grid_embedded_select",style:"$blank",pluginName:"selectbox",renderType:"native",title:x,emptyItem:t.options.emptyItem,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.options.accessibility,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){var e=this.render.parentNode.getAttribute(y);g.getCellInfo(e).options.noDisabledOnReadOnly&&this.getReadOnly()?p.f.preventDefault(t):p.f.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:return void p.f.stopPropagation(t)}}}}]},t.xml),m.innerHTML=q.toHTML();var R=WebSquare.uiplugin.selectbox_native.prototype.handleOnchange;q.handleOnchange=function(t){var e=g._getWrapperTD(this.render.parentNode).getAttribute(y),i=parseInt(this.render.getAttribute(v),10),o=g._getGroupbyDisplayRowIndex(i),s=g.getColumnIndex(e),r=this.selectedIndex,a=this.getValue();if(R.call(this,t),g.dataList.__setCellData(i,e,this.getValue()),g._dataList.setRowPosition(i),r!=this.selectedIndex){var n={oldValue:a,newValue:this.getValue(),oldSelectedIndex:r,newSelectedIndex:this.selectedIndex,rowIndex:i,colIndex:s,colId:g.getColumnID(s)};p.f.fireEvent(g,"onviewchange",n)}p.f.fireEvent(g,"onafteredit",o,s,this.getValue(),t)};var D=WebSquare.uiplugin.selectbox.prototype.refreshItemset;q.refreshItemset=function(t){var e=g._getWrapperTD(this.render.parentNode).getAttribute(y),i=parseInt(this.render.getAttribute(v),10);D.call(this,t);var o=g._dataList.getCellData(i,e);this.setValueNM(o)},q.activate();var T=q.uuid;q.event.addListener2(q.dom.select,"onfocus",(function(t){g.lastEvent=t;var e=WebSquare.idCache[T]
;g.getLastFocusedCell().focusedTd==g._getWrapperTD(e.render.parentNode)||g.focusedByApi||g._setFocusedCell(e.render.getAttribute(v),g._getWrapperTD(e.render.parentNode).getAttribute(y)),g.focusedByApi=!1}))}else if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){var L,k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),A=(L=t.mainGridId+"_checkbox_"+t.id)+"_"+k,E=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(var M=t.options.checkboxLabelColumn.split(","),O="",N=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){var G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showCheckboxLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showCheckboxLabelUserFormat){var W=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+W+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}E=E?O+N+E:O}if(t.options.checkboxLabelFormatter)try{var B;"function"==typeof(B=a.Z.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(E=B.call(this,F,this.getColumnIndex(t.colID),E))}catch(e){c.v.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}Y="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check'  id='"+A+"' name='"+L+"'/>",t.getEscape()&&(E=WebSquare.xml._encode(E+""));var V="<label class='w2checkbox_label ' for='"+A+"'>"+E+"</label>";"left"===t.options.checkboxLabelPosition?Y=V+Y:Y+=V,m.innerHTML=Y;var q=m.getElementsByTagName("input")[0]}else{Y="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check' />",m.innerHTML=Y;q=m.getElementsByTagName("input")[0];if(d)q.title=d;else if(t.options.title)q.title=t.options.title;else if(this.options.titleAuto){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";q.title=i?S+WebSquare.language.getMessage("Grid_title"):S+WebSquare.language.getMessage("Grid_title_not_choose"),E&&(q.title=q.title+E)}}if(this.event.addListener(q,"onclick",this.event.bindAsEventListener(this,(function(t){var e=p.f.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),r=this.getCellInfo(o),a=r.id,n=this.getColumnIndex(a);if(!0===this.options.useShiftKeyCheck&&t.shiftKey){var l={td:o,rowIndex:s,checked:e.checked};this._ShiftKeyMultiCheck(this,l,o)}!0===this.options.useShiftKeyCheck&&(this.beforeChecked={td:o,rowIndex:s,checked:e.checked}),i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,a),this.focusedByApi=!1,r.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&p.f.preventDefault(t)}))),t.options.noDisabledOnReadOnly){var k=this.getElemRowIndex(e);this._getEditReadOnly(k,t.id)?this.addClass(q,this.options.readOnlyClass+"_nodisabled"):this.removeClass(q,this.options.readOnlyClass+"_nodisabled")}}else if("radio"==n&&l){var Y;if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var Z,k=this.getElemRowIndex(e),F=this._getGroupbyDisplayRowIndex(k),j=(Z=t.mainGridId+"_radio_"+t.id)+"_"+k,P=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(var M=t.options.radioLabelColumn.split(","),O="",N=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",H=0;H<M.length;H++){var G=this.bodyToHeaderRelation[M[H]];if(H===M.length-1)this.options.showRadioLabelUserFormat?O+=" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0}):O+=this._getCellDisplayData(k,M[H],{removeTag:!0});else if(this.options.showRadioLabelUserFormat){var W=WebSquare.language.getMessage("Grid_row")||"row";O+=(0===H?k+1+W+N:"")+" "+this.getHeaderValue(G)+" "+this._getCellDisplayData(k,M[H],{removeTag:!0})+N}else O+=this._getCellDisplayData(k,M[H],{removeTag:!0})+N}P=P?O+N+P:O}
if(t.options.radioLabelFormatter)try{var z;"function"==typeof(z=a.Z.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(P=z.call(this,F,this.getColumnIndex(t.colID),P))}catch(e){c.v.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}Y="<INPUT style='border-width:0px;' type='radio' class='w2grid_embedded_radio'  id='"+j+"' name='"+Z+"'/>",t.getEscape()&&(P=WebSquare.xml._encode(P+""));V="<label class='w2radio_label ' for='"+j+"'>"+P+"</label>";"left"===t.options.radioLabelPosition?Y=V+Y:Y+=V,m.innerHTML=Y;q=m.firstChild}else{Y="<INPUT style='border-width:0px;' type='radio' name='"+(t.mainGridId+"_radio_"+t.id)+"' class='w2grid_embedded_radio' />",m.innerHTML=Y;q=m.firstChild;if(d)q.title=d;else if(t.options.title)q.title=t.options.title;else if(this.options.titleAuto){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";q.title=i?S+WebSquare.language.getMessage("Grid_title"):S+WebSquare.language.getMessage("Grid_title_not_choose"),P&&(q.title=q.title+P)}}if(this.event.addListener(q,"onclick",this.event.bindAsEventListener(this,(function(t){var e=p.f.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),r=this.getCellInfo(o),a=r.id,n=this.getColumnIndex(a);i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,a),this.focusedByApi=!1,r.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&p.f.preventDefault(t)}))),t.options.noDisabledOnReadOnly){k=this.getElemRowIndex(e);this._getEditReadOnly(k,t.id)?this.addClass(q,this.options.readOnlyClass+"_nodisabled"):this.removeClass(q,this.options.readOnlyClass+"_nodisabled")}}else if("calendar"==n&&l){var U=d||t.options.title||"";if(this.options.titleAuto&&!U){S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";U=""!==i?S+" "+i:S+WebSquare.language.getMessage("Grid_calendar")}var X=t.options.ioFormat,K={style:"width:0px; height:0px;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:X,ioFormatter:"$blank",displayFormat:t.options.displayFormat||X,displayFormatter:t.options.displayFormatter,displayFormatFunc:t.options.displayFormatFunc,calendarDisplayFormatFunc:t.options.calendarDisplayFormatFunc,footerDiv:!0,renderDiv:!0,keepFocusSelect:!0,focusOnOuterDiv:!0,renderType:"native",readOnly:"$blank",disabled:"$blank",title:U,validCheck:!1,_scope_obj_uuid:t.options._scope_obj_uuid,senseReader:t.options.senseReader,accessibility:this.options.accessibility,disableAfterDate:t.options.disableAfterDate,disableBeforeDate:t.options.disableBeforeDate,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(b),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o=g.getColumnIndex(i);p.f.fireEvent(g,"oncellclick",e,o,i),p.f.stopPropagation(t)}}},{name:"onafterviewchange",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=g._getGroupbyDisplayRowIndex(e),o=g.getColumnIndex(g._getWrapperTD(this.render.parentNode).getAttribute(y));t.oldValue!=t.newValue&&p.f.fireEvent(g,"onviewchange",{oldValue:t.oldValue,newValue:t.newValue,rowIndex:i,colIndex:o,colId:g.getColumnID(o)})}}},{name:"ondateselect",action:"script",param:{handler:function(t,e){this.options.senseReader||this.dom.input.blur();var i=this.render.getAttribute(v),o=g._getWrapperTD(this.render.parentNode).getAttribute(y),s=this.getValue();g.dataList.__setCellData(i,o,s),i=parseInt(i,10);var r=g.getColumnIndex(o);p.f.fireEvent(g,"ondateselect",i,r,t,e)}}},{name:"onconfirm",action:"script",param:{handler:function(){this.options.senseReader||this.dom.input.blur();var t=this.render.getAttribute(v),e=g._getWrapperTD(this.render.parentNode).getAttribute(y),i=q.validator.validateString(this.getValue());g.dataList.__setCellData(t,e,i)}}},{name:"onyearselect",action:"script",param:{handler:function(t){
var e=parseInt(this.render.getAttribute(v),10),i=g.getColumnIndex(g._getWrapperTD(this.render.parentNode).getAttribute(y));p.f.fireEvent(g,"onyearselect",e,i,{oldValue:t.oldValue,newValue:t.newValue})}}},{name:"onmonthselect",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=g.getColumnIndex(g._getWrapperTD(this.render.parentNode).getAttribute(y));p.f.fireEvent(g,"onmonthselect",e,i,{oldValue:t.oldValue,newValue:t.newValue})}}},{name:"onbeforepaste",action:"script",param:{handler:function(t){var e={rowIndex:parseInt(this.render.getAttribute(v),10),colIndex:g.getColumnIndex(this.render.parentNode.getAttribute(y)),data:[[t]]};return p.f.fireEvent(g,"onbeforepaste",e)}}}]};q=new WebSquare.uiplugin.inputCalendar(C,K,t.element);try{t.element&&!t.element.getAttribute("dateValidCheck")&&(q.options.dateValidCheck=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false")}catch(t){s.Y.printStackTrace(t,null,this)}if(l&&!e)return q;m.innerHTML="",q.writeTo(m),q.parentControl||this.addControl(q),X!=q.options.ioFormat&&(t.options.ioFormat=q.options.ioFormat,t.initFormatter()),q.setVerticalAlign=function(){},q.handleKeyupEvent=function(){};var $=WebSquare.uiplugin.inputCalendar.prototype.handleFocusEvent;q.handleFocusEvent=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return p.f.stopEvent(t),!1;var e=this.render.getAttribute(v),i=g._getGroupbyDisplayRowIndex(e),o=g._getWrapperTD(this.render.parentNode).getAttribute(y);if(g.lastEvent=t,g.getLastFocusedCell().focusedTd==g._getWrapperTD(this.render.parentNode)||g.focusedByApi||g._setFocusedCell(e,o),$.call(this,t),g.focusedByApi=!1,!this.reFocus&&(g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),this.select(),this.focus(),g.fakeInput.render.parentNode)){var s=g.getColumnIndex(o);p.f.fireEvent(g,"onbeforeedit",i,s,g._dataList.getCellData(e,s))}g.F2Mode=!1,this.reFocus=!1};var J=WebSquare.uiplugin.inputCalendar.prototype.handleKeyEvent;q.handleKeyEvent=function(t){g.lastEvent=t,J.call(this,t);var e=this.dom[q.id+"_input"];switch(t.keyCode){case 46:return void p.f.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void p.f.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(e,e.value.length),g.hideFakeInput(this),void p.f.stopPropagation(t);case 9:for(var i=this.event.getTargetIterator(t,this.render);i.next();){if(i.match("w2inputCalendar_divInput")){p.f.stopPropagation(t);break}if(i.match("w2inputCalendar_button")&&t.shiftKey){p.f.stopPropagation(t);break}}return}var o=t.which||t.keyCode;g.nonCharKeys[o]||(32!=o?(g.fakeInput.render.parentNode&&g.hideFakeInput(this),p.f.stopPropagation(t)):p.f.stopPropagation(t))};var Q=WebSquare.uiplugin.inputCalendar.prototype.handleBlurEvent;q.handleBlurEvent=function(t){var e,i=this.render.getAttribute(v),o=g._getGroupbyDisplayRowIndex(i),s=g._getWrapperTD(this.render.parentNode).getAttribute(y),r=g.getColumnIndex(s),a=q.validator.validateString(this.getValue()),n=WebSquare.historyManager.get(this.options.pluginName,this.id);if(n&&(e=n.value),this.options.disableDateValidSet&&this.disableValidate(a))return null!=n.value&&this._setValue(n.value,{skipValidate:!0}),!1;if(!1===this.validate(a)&&""!=a){if(this.options.dateValidSet&&this.options.dateValidSetCustom);else if(this.options.dateValidSet&&null!=n.value&&this._setValue(n.value,{skipValidate:!0}),"false"!==this.options.displaymessage){var l=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"Invalid date format";this.options.invalidMessageFunc||alert(l)}return!1}if(p.f.fireEvent(g,"oneditend",o,r,a,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=g._getWrapperTD(this.render.parentNode)&&g._setFocusedCell(i,s),p.f.stopEvent(t),!1;g.editEndFlag=!1,
Q.call(this,t);g.getCellInfo(s);g.dataList.__setCellData(i,s,a),a=g._dataList.getCellData(i,s);var h=q.sub_validator.validateString(a);this._setValue(h,{skipValidate:!0}),p.f.fireEvent(this,"onafterviewchange",{oldValue:e,newValue:a});p.f.fireEvent(g,"onafteredit",i,r,a,g.lastEvent);g.F2Mode=!1},q.setStyle("z-index","10"),q.activate(),this.fakeInput||this.makeFakeInput()}else if("text"==n||"textImage"==n||"drilldown"==n||"secret"==n){st=t.options.type?t.options.type:"text",U=d||"";"secret"==n&&(st="password"),u&&(h="bigDecimal");at={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;z-index:10;",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"all"==t.options.applyFormat?"":"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",title:U,type:st,dataType:h,editType:t.options.editType,byteCheckIgnoreChar:t.options.byteCheckIgnoreChar,maxlength:t.options.maxLength||t.options.maxlength||-1,maskFormat:t.options.maskFormat,maskFormatModelNumber:t.options.maskFormatModelNumber,customModelFormatter:t.options.customModelFormatter,customModelUnformatter:t.options.customModelUnformatter,customPasteFormatter:this.options.customPasteFormatter,useMaxLength:t.options.useMaxLength,adjustMaxLength:t.options.adjustMaxLength,useKeyupBlur:!1,inputMode:t.options.inputMode||"",_scope_obj_uuid:t.options._scope_obj_uuid,xmlEvents:[{name:"ondblclick",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);p.f.fireEvent(g,"oneditdblclick",i,o,t.id)}}}]};t.options.maskFormat&&"display"==t.options.applyFormat&&(at.displayFormat=t.options.displayFormat),t.internal&&(at=o.q.extend(o.q.extend(at,t.initializeInfo.options))),"float"===t.options.dataType&&(at.dataType=t.options.dataType),(q=new WebSquare.uiplugin.input(C,at,t.element)).writeTo(this),this.options.editInputClass&&"text"==n&&this.addClass(q.render,this.options.editInputClass),q.event.addListener(q.render,"oncopy",this.event.bindAsEventListener(this,(function(t){p.f.stopPropagation(t)}))),q.event.addListener(q.render,"onpaste",this.event.bindAsEventListener(this,(function(t){p.f.stopPropagation(t)}))),q.activate(),"number"==t.options.dataType?""==t.options.displayFormat?q.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):t.options.maskFormat&&t.options.displayFormat||q.validator.addCommand(new WebSquare.validator.numberCommand):"euro"==t.options.dataType?q.validator.addCommand(new WebSquare.validator.euroCommand(q.options.delimiter,q.options.decimalDelimiter)):"text"==t.options.dataType&&(t.options.maskFormat&&t.options.displayFormat||(t.options.applyFormat="display")),q.setVerticalAlign=function(){},this._moveKeyEdit(q.uuid,"handleKeydownEvent",{oldMode:!0})}else if("textarea"==n){if(l){var tt,et,it;e&&(k=this.getElemRowIndex(e),tt=this.getColumnIndex(e.getAttribute(y)),et=this._getEditDisabled(k,tt),it=this.___getEditReadOnly(k,tt));var ot="position:relative;display:none;width:150px;height:60px;resize:none;";!0!==this.options.accessibility&&(ot+="z-index:1000;"),q=new WebSquare.uiplugin.textarea(C,{style:ot,className:"$blank",readOnly:!0===it?it:"$blank",disabled:!0===et?et:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.options.accessibility,xmlEvents:[{name:"onkeydown",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode;9!==e&&35!==e&&36!==e&&p.f.stopPropagation(t)}}}]},t.element);Q=WebSquare.uiplugin.textarea.prototype.handleBlurEvent;q.handleBlurEvent=function(t){Q.call(this,t);var e=parseInt(this.render.getAttribute(v),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o=g.getCellInfo(i),s=this.getValue();"number"==o.mainGrid.getColumnOption(o.options.col_id,"dataType")&&""!=s&&(s=Number(s)),o.mainGrid.dataList.__setCellData(e,i,s)}}else{K={style:"position:absolute;display:none;width:150px;height:60px;z-index:1000;resize:none;",className:"$blank",readOnly:"$blank",
disabled:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid};!0===t.options.keepCellClass&&(K.className=""),t.internal&&(K=o.q.extend(o.q.extend(K,t.initializeInfo.options))),q=new WebSquare.uiplugin.textarea(C,K,t.element)}q.writeTo(this),q.event.addListener(q.render,"oncopy",this.event.bindAsEventListener(this,(function(t){p.f.stopPropagation(t)}))),q.event.addListener(q.render,"onpaste",this.event.bindAsEventListener(this,(function(t){p.f.stopPropagation(t)}))),this._moveKeyEdit(q.uuid,"handleKeydownEvent"),q.activate()}else if("calendar"==n){X=t.options.ioFormat,K={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:X,ioFormatter:"$blank",displayFormat:t.options.displayFormat||X,applyFormat:t.options.applyFormat||"display",displayFormatter:"$blank",holidayRef:t.options.holidayRef||"",keepFocusSelect:!0,focusOnOuterDiv:!0,footerDiv:t.options.footerDiv,_scope_obj_uuid:t.options._scope_obj_uuid,readOnly:"$blank",disabled:"$blank",validCheck:!1,renderDiv:!0,inputReadOnly:t.options.inputReadOnly,unformatOnPaste:t.options.unformatOnPaste,pickerType:t.options.pickerType,fixPickerStatus:t.options.fixPickerStatus,xmlEvents:[{name:"ondateselect",action:"script",param:{handler:function(e,i){var o=t.editRowIndex,s=g.getColumnIndex(t.id);p.f.fireEvent(g,"ondateselect",o,s,e,i)}}},{name:"onmonthselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);p.f.fireEvent(g,"onmonthselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onyearselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);p.f.fireEvent(g,"onyearselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onbeforepaste",action:"script",param:{handler:function(e){var i={rowIndex:t.editRowIndex,colIndex:g.getColumnIndex(t.id),data:[[e]]};return p.f.fireEvent(g,"onbeforepaste",i)}}}]};t.internal&&(K=o.q.extend(o.q.extend(K,t.initializeInfo.options)));q=new WebSquare.uiplugin.inputCalendar(C,K,t.element);try{0==t.internal?t.element&&!t.element.getAttribute("dateValidCheck")&&(q.options.dateValidCheck=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false"):1!=t.options.dateValidCheck&&"true"!=t.options.dateValidCheck||(q.options.dateValidCheck="true")}catch(t){s.Y.printStackTrace(t,null,this)}q.writeTo(this),q.event.addListener(q.render,"oncopy",this.event.bindAsEventListener(this,(function(t){p.f.stopPropagation(t)}))),q.event.addListener(q.render,"onpaste",this.event.bindAsEventListener(this,(function(t){p.f.stopPropagation(t)}))),X!=q.options.ioFormat&&(t.options.ioFormat=q.options.ioFormat,t.initFormatter()),this._moveKeyEdit(q.uuid,"handleKeyEvent"),q.activate(),q.setVerticalAlign=function(){},"display"===t.options.applyFormat&&(q.handleKeyupEvent=function(){}),q.setStyle("z-index","10"),q.options.dateValidSet&&q.options.dateValidSetCustom&&(q._skipDateValidSet=!0)}else if("autoComplete"==n&&l){(K={}).titleStr=d,K.input_id=C,K.dataRowIndex=b,K.dataCol_id=y,q=t.getInput(t,e,i,K)}}else{var U=d||t.options.title||"",S=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";U||this.options.titleAuto&&("text"==n&&""!==i?U=S+" "+i:("text"==n&&""==i||"secret"==n)&&(U=S));var st=t.options.type?t.options.type:"text",rt="w2grid_embedded_input";"secret"==n&&(st="password",a.Z.isIEAllVersion()?rt+=" w2grid_secret":rt="w2grid_embedded_secret");var at={className:rt,style:"$blank",ioFormat:"$blank",ioFormatter:"$blank",readOnly:"$blank",disabled:"$blank",hidden:"$blank",title:U,type:st,adjustMaxLength:t.options.adjustMaxLength,useMaxLength:t.options.useMaxLength,useKeyupBlur:!1,accessibility:this.options.accessibility,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){
var e=parseInt(this.render.getAttribute(b),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o=g.getColumnIndex(i);p.f.fireEvent(g,"oncellclick",e,o,i),p.f.stopPropagation(t)}}},{name:"oncopy",action:"script",param:{handler:function(t){p.f.stopPropagation(t)}}},{name:"onpaste",action:"script",param:{handler:function(t){p.f.stopPropagation(t)}}},{name:"oncut",action:"script",param:{handler:function(t){p.f.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){this._SenSeReaderBeforeEditValue=null;var e={},i=g._getWrapperTD(this.render.parentNode).getAttribute(y);e.rowIndex=parseInt(this.render.getAttribute(b),10),e.colIndex=g.getColumnIndex(i),e.colID=i,e.keyCode=t.charCode?t.charCode:t.keyCode,this._SenSeReaderBeforeEditValue=this.render.value,e.oldValue=this.render.value,p.f.fireEvent(g,"oneditkeydown",e)}}},{name:"onkeyup",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode,i=g._getWrapperTD(this.render.parentNode).getAttribute(y),o={rowIndex:parseInt(this.render.getAttribute(b),10),colIndex:g.getColumnIndex(i),colID:i,oldValue:this._SenSeReaderBeforeEditValue||"",newValue:this.render.value,inputType:"text",keyCode:e};this._SenSeReaderBeforeEditValue=null,p.f.fireEvent(g,"oneditkeyup",o)}}}]};if(!0!==this._isBrowserScroll()&&at.xmlEvents.unshift({name:"onmousedown",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(b),10),i=g._getWrapperTD(this.render.parentNode).getAttribute(y);if(e-g.rowIndex>=g.lastIndex+1)return p.f.stopEvent(t),g.addGridScroll(1),void g._setFocusedCell(e,i,!0)}}}),"float"===t.options.dataType&&(at.dataType=t.options.dataType),t.options.delimiter="",q=new WebSquare.uiplugin.input(C,o.q.extend(o.q.extend({},t.options),at)),"textImage"===n){var nt=e.getElementsByClassName("w2grid_textImage_div_input")[0];q.writeTo(nt)}else m.innerHTML="",q.writeTo(m);"number"==t.options.dataType&&(""==t.options.displayFormat?q.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):q.validator.addCommand(new WebSquare.validator.numberCommand)),a.Z.isIE()&&q.setVerticalAlign(),q.setVerticalAlign=function(){};var lt=WebSquare.uiplugin.input.prototype.handleBlurEventBasic,ht=this.uuid;q.handleBlurEventBasic=function(t){var e=parseInt(this.render.getAttribute(v),10),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode;"textImage"==n&&(o=this.render.parentNode.parentNode);var s=g._getWrapperTD(o).getAttribute(y),r=g._dataList.getColumnIndex(s),l=g.getColumnIndex(s),h=q.validator.validateString(this.getValue());if(p.f.fireEvent(g,"oneditend",i,l,h,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=g._getWrapperTD(this.render.parentNode)&&g._setFocusedCell(e,s),p.f.stopEvent(t),!1;g.editEndFlag=!1,lt.call(this,t,{skipEditEnd:!0});var d=g.getCellInfo(s),u=g.getColumnOption(d.id,"dataType");if(this._isNumberType(u)){var c=h.wq_trim();"."!==c&&"-"!==c&&"+"!==c&&","!==c&&c!=="+"+d.options.decimalDelimiter&&c!=="-"+d.options.decimalDelimiter||(h="")}var f=!(!g.isDrillDown||!g._dataList.options.depthColumn),m=e,b=g._dataList.getRealRowIndex(m);f&&(m=b);var w=g._dataList.dataArr[b*g._dataList.getColumnCount()+r];if(g.dataList.__setCellData(e,s,h),h=g._dataList.getCellData(m,s),"all"==d.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||d._changeDisplayFormat||(h=d.getDisplayData(h)),this.setValue(h),WebSquare.idCache[ht].options.senseReader&&this.options.customFormatter){var C=null;try{"function"==typeof this.options.customFormatter?C=this.options.customFormatter:"function"==typeof(C=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=C)}catch(t){C=null}var I=h,_=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&_&&(I=this.formatter.format(h)),"function"==typeof C){this.useCustomFormatter=!0
;var x=C.call(this.mainGrid,h,I,i,r);this.render.value=x}}p.f.fireEvent(g,"onafteredit",i,l,h,g.lastEvent);w!=h&&p.f.fireEvent(g,"onviewchange",{oldValue:w,newValue:h,rowIndex:i,colIndex:l,colId:g.getColumnID(l)}),g.hideFakeInput(q),g.F2Mode=!1};var dt=WebSquare.uiplugin.input.prototype.handleFocusValueEventAdv;q.handleFocusValueEventAdv=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return p.f.stopEvent(t),!1;var e=parseInt(this.render.getAttribute(v),10),i=g._getGroupbyDisplayRowIndex(e),o=g._getWrapperTD(this.render.parentNode).getAttribute(y);g.lastEvent=t;var s,r=g.getLastFocusedCell();if(!(!g.isDrillDown||!g._dataList.options.depthColumn)&&(e=g._dataList.getRealRowIndex(e)),r.focusedTd!=g._getWrapperTD(this.render.parentNode)&&(s=!g.focusedByApi||r.focusedRowIndex===e&&r.focusedColIndex===g.getColumnIndex(o)?g._setFocusedCell(e,o):g._setFocusedCell(e,o,!1)),!1!==s){var a=this.reFocus;if(dt.call(this,t),this.reFocus=a,g.focusedByApi=!1,!this.reFocus){var n=g._dataList.getCellData(e,o);if(n!==this.getValue()&&(this.formatter&&"all"===this.options.applyFormat&&(n=this.formatter.format(n)),this.setValue(n)),g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),"select"===this.options.editType&&this.select(),this.focus(),g.fakeInput.render.parentNode){var l=g.getColumnIndex(o);p.f.fireEvent(g,"onbeforeedit",i,l,g._dataList.getCellData(e,l))}}g.F2Mode=!1,this.reFocus=!1}};var ut=WebSquare.uiplugin.input.prototype.handleKeydownEvent;q.handleKeydownEvent=function(t){switch(g.lastEvent=t,ut.call(this,t),t.keyCode){case 46:return void p.f.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void p.f.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(this.render,this.render.value.length),g.hideFakeInput(this),void p.f.stopPropagation(t);case 9:for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2inputCalendar_divInput")){p.f.stopPropagation(t);break}return}var i=t.which||t.keyCode;if(!g.nonCharKeys[i])if(32!=i){if(g.fakeInput.render.parentNode){var o=this.render.getAttribute(v),s=g._getGroupbyDisplayRowIndex(o),r=g._getWrapperTD(this.render.parentNode).getAttribute(y),a=g.getColumnIndex(r);p.f.fireEvent(g,"onbeforeedit",s,a,g.dataList._getCellData(o,a)),g.hideFakeInput(this)}p.f.stopPropagation(t)}else p.f.stopPropagation(t)},q.activate(),this.fakeInput||this.makeFakeInput()}this.dom[C]=q,l&&this.adaptiveEmbeddedInputIdList.push(C)}return q},S.prototype.getTemporaryDataCollectionItemArr=function(t){try{var e=[],i=this.modelControl.getDataComp(t.dataCompID);if(i)switch(i.initializeType){case"linkedDataList":for(var o={},r=0;r<i.filteredRowIndexArr.length;r++){var a=i.getRealRowIndex(r),n=i._dataList.dataArr[a*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[a*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataList":for(o={},r=0;r<i.filteredRowIndexArr.length;r++){n=i.dataArr[i.filteredRowIndexArr[r]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i.dataArr[i.filteredRowIndexArr[r]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataMap":for(o={},r=0;r<i._dataList.oneRowDataLength;r++){n=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}}return e}catch(t){s.Y.printStackTrace(t)}},S.prototype._getWrapperCell=function(t,e){try{if(!t)return t;var i=t;if(this.options.wrapperCell&&this.options.wrapperCellElem){if(!t.firstChild||t.firstChild.tagName!==this.options.wrapperCellElem.toUpperCase()){var o=document.createElement(this.options.wrapperCellElem);o.id=this.id+"_wrapperCell_"+this.getCellInfo(t).colID+"_"+e,o.className="w2grid_wrapperCell",t.appendChild(o)}
i=t.firstChild}return i}catch(e){return s.Y.printStackTrace(e),t}},S.prototype._getWrapperTD=function(t){try{if(!t)return t;var e=t;return this.options.wrapperCell&&this.options.wrapperCellElem&&t.tagName===this.options.wrapperCellElem.toUpperCase()&&(e=t.parentNode),e}catch(e){return s.Y.printStackTrace(e),t}};var R=function(){};R.prototype.initializeHead=function(){try{this.headerObj={},this.headerConfigOptions={};for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=[],i={},o=0;o<t.length;o++){if(i[t[o].id]){var r=WebSquare.language.getMessage("E_comp_duplicated_Msg",t[o].id)||"id["+t[o].id+"] is duplicated. Check the source code.";$l(r)}else i[t[o].id]=t[o].id;e.push(t[o])}var n=a.Z.getDataPrefix("header_id"),l=a.Z.getDataPrefix("inputType"),h=a.Z.getDataPrefix("dataType"),d=a.Z.getDataPrefix("value"),u=a.Z.getDataPrefix("useLocale"),p=a.Z.getDataPrefix("localeRef");for(a.Z.getDataPrefix("toolTip"),o=0;o<e.length;o++){var c=e[o];if(!c.getAttribute(n)){var g=c.getAttribute(l),f=c.getAttribute(h),m=c.getAttribute(d),y=null;if(this.setConfigOptions(c,"header"),"checkbox"==g)c.innerHTML="",(y=this.setCheckboxHead(c,m)).headInputType="checkbox";else if("select"==g)(y=this.setSelectboxHead(c,m)).headInputType="select";else if("text"==g&&"own"==f)(y=this.setInputHead(c,m)).headInputType="input";else if("checkcombobox"==g)(y=this.setCheckcomboboxHead(c,m)).headInputType="checkcombobox";else if("textImage"==g)(y=this.setTextImageHead(c,m)).headInputType="textImage";else{var b=c.getAttribute(d),v=c.getAttribute(u);if("true"===v||this.options.useLocale&&!v){var w=c.getAttribute(p);if(w){(I=this.getLocaleValue(w))&&(b=I)}else{var C=c.getAttribute("id");if(null!=C&&C.match("RowNumber")&&this.options.rowNumLocaleRef)(I=this.getLocaleValue(this.options.rowNumLocaleRef))&&(b=I);else if(null!=C&&C.match("RowStatus")&&this.options.rowStatusLocaleRef){var I;(I=this.getLocaleValue(this.options.rowStatusLocaleRef))&&(b=I)}}}b=null!=b?b:"",c.innerHTML=this.dataTagOpen+b+this.dataTagClose}var _=c.getAttribute("id");c.setAttribute(n,_);var x=c.className;if(!0===this._isBrowserScroll()&&(x+=" "+this.options.gridNativeClass,this.struct.head.rowArr.length>1&&(x+=" "+this.options.gridNativeClass+"MultiHeader")),x+=" "+this.id+"_header__column"+o,this.headCellInfoHash[_]){var S=this.headCellInfoHash[_].getAttribute("class");S&&(x+=" "+S)}if(c.className=x,c.setAttribute("id",this.id+"_"+_),this.options.autoScope&&c.setAttribute("scope","col"),this._checkUseFilter(c)){var R="width:100%;height:100%;",D="";this.options.filterShowAlways&&(R+="table-layout:fixed;",D="overflow:hidden;");var T=document.createElement("table");T.style.cssText=R;var L=document.createElement("tr"),k=document.createElement("td");k.style.cssText="width:100%;"+D;for(var F=c.childNodes.length,A=0;c.childNodes.length>0&&A<F;A++)k.appendChild(c.childNodes[0]);L.appendChild(k);var E=document.createElement("td"),M=WebSquare.language.getMessage("Grid_filter_button");if(E.innerHTML="<input type='button' id='"+this.id+"_"+_+"_filter' class='w2trigger w2grid_customFilter_open' onclick='"+this.id+'.showCustomFilter("'+_+"\");' title='"+M+"'/>",L.appendChild(E),T.appendChild(L),c.appendChild(T),this.options.filterShowAlways){var O=document.getElementById(this.id+"_"+_+"_filter");O&&O.parentNode&&(O.parentNode.style.width=O.offsetWidth+2+"px")}}if(this._checkSortable(c)&&(c.className+=" w2grid_head_sortable"),this.headerObj[_]=y,c.disabled=!1,!1===this.options.tooltipHeader){var N=c.getAttribute("tooltip"),H=c.getAttribute("toolTipLocaleRef");N&&WebSquare.getBody().setToolTip(c,N,H)}}}this.clearHeaderSort()}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.associateHeaderBody=function(){try{for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=0,i=-1,o="",r=a.Z.getDataPrefix("colIndex"),n=a.Z.getDataPrefix("header_id"),l=a.Z.getDataPrefix("col_id"),h=0;h<t.length;h++){var d=t[h]
;if(d.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||d.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0);else{var u=d.getAttribute(r);parseInt(u)<=i&&e++,i=parseInt(u);var p=e;p+1>this.tempTr.rows.length&&(p=this.tempTr.rows.length-1);for(var c=null;p>=0;){for(var g=this.tempTr.rows[p],f=a.Z.first(g);f;){if(u==f.getAttribute(r)){c=f;break}f=a.Z.next(f)}if(c)break;p--}if(c){var m=d.getAttribute(n),y=c.getAttribute(l);o=y,this.headerToBodyRelation[m]=y,this.bodyToHeaderRelation[y]=m}else{m=d.getAttribute(n);this.passiveColSpanRelation[m]=o}}}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderConfigValue=function(t,e,i,o){try{var r=a.Z.getDataPrefix("col_id"),n=t.getAttribute(r),l=t&&(t.getAttribute(i)||t.getAttribute(i.toLowerCase())),h=this.headerConfigOptions[n]&&this.headerConfigOptions[n][o];return l||h||""}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setCheckboxHead=function(t,e){try{var i=a.Z.getDataPrefix("col_id"),o=a.Z.getDataPrefix("onChangeFunction"),n=a.Z.getDataPrefix("onchangeFunction"),l=a.Z.getDataPrefix("localeRef"),h=a.Z.getDataPrefix("checkboxLabel"),d=a.Z.getDataPrefix("checkboxLabelPosition"),u=a.Z.getDataPrefix("colId"),c=t.getAttribute(i),g=t.getAttribute(o)||t.getAttribute(n),f="<INPUT type='checkbox' />",m=this.getHeaderConfigValue(t,e,h,"checkboxLabel");if(this.options.useLocale){var y=t.getAttribute(l);if(y){var b=this.getLocaleValue(y);b&&(m=b)}}if(m){var v=this.uuid+"_header__"+c+"_checkboxLabel_",w=v+"_id",C=" for='"+w+"'";!1===this.options.useHeaderCheckboxLabelFor&&(C=""),f="left"===this.getHeaderConfigValue(t,e,d,"checkboxLabelPosition")?"<label class='w2checkbox_label'"+C+">"+m+"</label><INPUT type='checkbox' name='"+v+"' id='"+w+"'/>":"<INPUT type='checkbox' name='"+v+"' id='"+w+"'/><label class='w2checkbox_label'"+C+">"+m+"</label>",t.getAttribute(h)||t.setAttribute(h,m)}t.innerHTML=f;var I=t.getElementsByTagName("input")[0];0==this.getHeaderColumnVisible(c)&&I.setAttribute("tabIndex","-1"),I.setAttribute(u,e),("true"==t.getAttribute("disabled")||a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<9&&"true"==this.headCellInfoHash[c].getAttribute("disabled"))&&I.setAttribute("disabled","disabled");var _=t.getAttribute("title");_&&I.setAttribute("title",_);var x=this;p.f.addListener(I,"onkeydown",(function(t){p.f.fireEvent(x,"onkeydown",t),"32"==(t.charCode?t.charCode:t.keyCode)&&p.f.stopPropagation(t)})),p.f.addListener(I,"ondblclick",(function(t){p.f.stopPropagation(t)})),p.f.addListener(I,"onfocus",(function(t){var e=x.headerToBodyRelation[c];x.getCellInfo(e).options.keepFocusOnCheckHeaderClick||(x.removeFocusedCell(),1==x.options.senseReader&&x.rowIndex>0&&x.addGridScroll(0-x.rowIndex))}));var S=this.uuid;return null!=g&&""!=g?p.f.addListener(I,"onclick",(function(t){if(!WebSquare.idCache[S].options.checkHeaderOnly){x.noevent=!0;var i=a.Z.getGlobalFunction(g,x.scope_id);if("function"==typeof i)try{i.call(this,this.checked,e)}catch(t){s.Y.printStackTrace(t,null,this)}(x.options.preventMultipleClick||x.options.senseReader)&&p.f.fireEvent(x,"onheaderclick",c)}})):p.f.addListener(I,"onclick",(function(t){if(!WebSquare.idCache[S].options.checkHeaderOnly){x.noevent=!0;var e,i,o,r,a,n,l,h=x.headerToBodyRelation[c],d=x.getCellInfo(h),u=d,g=d.options.trueValue,f=d.options.falseValue,m=!(!x.isDrillDown||!x._dataList.options.depthColumn),y=!("checkbox"!==d.options.inputType||!x.options.ref);if(!0===y){var b=x._dataList._getXPath({colID:h,skipValueNode:!0});y=(e=WebSquare.ModelUtil.findInstanceNodes(b,null,x.scope_id)).length>=x.getTotalRow()}if("checkbox"===d.options.inputType||"custom"===d.options.inputType||"radio"===d.options.inputType){if(x.editedCell)try{a=x.editedCell.editRowIndex,n=x.getColumnIndex(x.editedCell.id);var v=x._dataList.getColumnIndex(x.editedCell.id);r=x._grid.getRealRowIndex(a)*x._dataList.getColumnCount()+v,o=x._dataList.dataArr[r]}catch(t){s.Y.printStackTrace(t,null,this)}if(this.checked){
for(var w=x.getUnCheckedIndex(h),C=0;C<w.length;C++)if("custom"==d.options.inputType&&0==d.internal&&(u=d.cellManagerHashByRowIndex[w[C]])&&(g=u.options.trueValue,f=u.options.falseValue),u.options.checkAlways||!x.___getEditReadOnly(w[C],h,m)&&!x._getEditDisabled(w[C],h,m)){var I=w[C];m?x._dataList._setCellData(I,h,g,!0,!0,null,null,y):x.dataList.setCellData(I,h,g,!0,!0,null,null,y),i=g;var _=I;m&&(_=x._dataList.getFilteredRowIndex(_)),null!=_&&x._dataList.broadcast({gridView:["notifyCellChanged",[_,h,null,!0]]}),u.options.checkHeaderOnViewchange&&p.f.fireEvent(x,"onviewchange",{oldValue:f,newValue:g,rowIndex:I,colIndex:x.getColumnIndex(h),colId:x.getColumnID(x.getColumnIndex(h))})}}else{var R=x.getCheckedIndex(h);for(C=0;C<R.length;C++)if("custom"==d.options.inputType&&0==d.internal&&(u=d.cellManagerHashByRowIndex[R[C]])&&(g=u.options.trueValue,f=u.options.falseValue),u.options.checkAlways||!x.___getEditReadOnly(R[C],h,m)&&!x._getEditDisabled(R[C],h,m)){I=R[C];m?x._dataList._setCellData(I,h,f,!0,!0,null,null,y):x.dataList.setCellData(I,h,f,!0,!0,null,null,y),i=f;_=I;m&&(_=x._dataList.getFilteredRowIndex(_)),null!=_&&x._dataList.broadcast({gridView:["notifyCellChanged",[_,h,null,!0]]}),u.options.checkHeaderOnViewchange&&p.f.fireEvent(x,"onviewchange",{oldValue:f,newValue:g,rowIndex:I,colIndex:x.getColumnIndex(h),colId:x.getColumnID(x.getColumnIndex(h))})}}if(x.checkHeader(c),!0===y)for(C=0;C<e.length;C++){var D=e[C];(u.options.checkAlways||!x.___getEditReadOnly(C,h,m)&&!x._getEditDisabled(C,h,m))&&(x._dataList.valueNode?D.setAttribute(x._dataList.valueNode,i):WebSquare.xml.setTextNodeValue(D,i))}x._dataList.broadcast({linkedDataList:["notifyRowChanged"],fusionChart:["refresh"],fwFunnelChart:["refresh"],fwSparkChart:["refresh"],fwPyramidChart:["refresh"],fwGanttChart:["refresh"],generalComp:"both"})}else if(x.options.titleAuto){var T=!0===this.checked?WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose");this.setAttribute("title",T)}if(x.options.senseReader&&x.rowIndex<=0&&(x.senseReaderMode=!0,x._setGridBorderNoRefresh=!0),x.options.senseReader&&x.rowIndex<=0&&(x.senseReaderMode=!1,x._setGridBorderNoRefresh=!1),x.drawFooter(),x.drawHeader(),(x.options.preventMultipleClick||x.options.senseReader)&&p.f.fireEvent(x,"onheaderclick",c),null!=r)try{var L=x._dataList.dataArr[r];l=x.getColumnID(n),o!=L&&p.f.fireEvent(x,"onviewchange",{oldValue:o,newValue:L,rowIndex:a,colIndex:n,colId:l})}catch(t){s.Y.printStackTrace(t,null,this)}}})),I}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.checkHeader=function(t){try{if(this.headerObj){var e=this.headerObj[t],i=this.headerToBodyRelation[t],o=this.headerInfoHash[t];if(e&&o&&o.options&&"checkbox"==o.options.inputType){var r=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=this.getCellInfo(i),l=r?this.getTotalRow():this.getRowCount();if("checkbox"!==n.options.inputType&&"custom"!==n.options.inputType&&"radio"!==n.options.inputType){if(this.options.titleAuto){var h=!0===e.checked?WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose");e.setAttribute("title",h)}return}if(this.hasCustomInputType&&0==n.internal&&"custom"==n.options.inputType){for(var d=l,u=0;u<d;u++){var p=r?u:this.dataList.getRealRowIndex(u),c=n.cellManagerHashByRowIndex[p]?n.cellManagerHashByRowIndex[p]:n;"checkbox"!=c.options.inputType&&"radio"!=c.options.inputType&&l--}if(0===l)return}var g="exclude"===this.options.checkAllType?this.getCheckedIndex(i,!0):this.getCheckedIndex(i),f=g.length;if(0==l)e.checked=!1,e.indeterminate=!1;else if(l==f)e.checked=!0,e.indeterminate=!1;else if(f>0){var m=!1;if(n.options.checkAlways)n.options.usePartialCheck&&"uncheck"===n.options.partialCheckNextClick&&(m=!0);else{for(u=0;u<g.length;u++)if(!this.___getEditReadOnly(g[u],i,r)&&!this._getEditDisabled(g[u],i,r)){(n.options.usePartialCheck||a.Z.isIEAllVersion())&&(m=!0);break}
n.options.usePartialCheck&&"check"===n.options.partialCheckNextClick&&m&&(m=!1)}a.Z.isIEAllVersion()?e.checked=!m:e.checked=m,n.options.usePartialCheck&&(e.indeterminate=!0)}else l-f==l&&(e.checked=!1,e.indeterminate=!1);if(this.options.titleAuto)h=e.checked?n.options.usePartialCheck&&e.indeterminate?WebSquare.language.getMessage("Grid_title_partial"):WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose"),e.setAttribute("title",h)}}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setSelectboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:select",i.A&&(i.A.style="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff");else{this.tmpSelectbox||(this.tmpSelectbox=new WebSquare.uiplugin.selectbox("___tmp_selectbox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",r.I._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var u in i=WebSquare.xml.parse('<w2:select xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:select>",!0).documentElement,this.tmpSelectbox.options){var p=t.getAttribute(u);null!=p&&""!=p&&("style"==u&&(p="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(u,p))}a.Z.isIE(8)&&"true"==this.headCellInfoHash[n].getAttribute("disabled")&&i.setAttribute("disabled","true")}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_selectbox_"+t.getAttribute("id"),{pluginType:"uiplugin.selectbox",pluginName:"selectbox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=a.Z.getDataPrefix("onChangeFunction"),f=a.Z.getDataPrefix("onchangeFunction"),m=t.getAttribute(g)||t.getAttribute(f);return c.changeFuncName=m,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=a.Z.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){s.Y.printStackTrace(t,null,this)}})),c.addEvent("onclick",(function(t){o.noevent=!0})),this.addControl(c),c}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setInputHead=function(t,e){try{t.innerHTML="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";var i=a.Z.first(t),o=this,r=a.Z.getDataPrefix("onChangeFunction"),n=a.Z.getDataPrefix("onchangeFunction"),l=a.Z.getDataPrefix("changeFuncName"),h=a.Z.getDataPrefix("colId"),d=a.Z.getDataPrefix("col_id"),u=t.getAttribute(r)||t.getAttribute(n);i.setAttribute(l,u),i.setAttribute(h,e),i.scope_id=this.scope_id,i.headerId=t.getAttribute(d);var c=this.getHeaderInfo(i.headerId).options,g=t.getAttribute("title")||c.title;g&&(i.setAttribute("title",g),t.removeAttribute("title"));var f=WebSquare.idCache[this.uuid];return p.f.addListener(i,"onfocus",(function(){o.noevent=!0,o.headerFocus=!0})),p.f.addListener(i,"onblur",(function(t){o.headerFocus=!1;var e=a.Z.getGlobalFunction(this.getAttribute(l),this.scope_id);if("function"==typeof e)try{e.call(this,this.value,this.getAttribute(h),this.headerId)}catch(t){s.Y.printStackTrace(t,null,this)}})),p.f.addListener(i,"onclick",(function(t){o.noevent=!0})),p.f.addListener(i,"onkeyup",(function(t){13==t.keyCode&&this.blur()})),p.f.addListener(i,"onpaste",(function(t){f.options.preventPaste?p.f.preventDefault(t):13==t.keyCode&&this.blur()})),i}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setCheckcomboboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:checkcombobox",i.A={style:"width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"};else{this.tmpCheckcombobox||(this.tmpCheckcombobox=new WebSquare.uiplugin.checkcombobox("___tmp_checkcombobox__"+this.id,{},null))
;var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",r.I._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var u in i=WebSquare.xml.parse('<w2:checkcombobox xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:checkcombobox>",!0).documentElement,this.tmpCheckcombobox.options){var p=t.getAttribute(u);null!=p&&""!=p&&("style"==u&&(p="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(u,p))}}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_checkcombobox_"+t.getAttribute("id"),{pluginType:"uiplugin.checkcombobox",pluginName:"checkcombobox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=a.Z.getDataPrefix("onChangeFunction"),f=a.Z.getDataPrefix("onchangeFunction"),m=t.getAttribute(g)||t.getAttribute(f);return c.changeFuncName=m,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=a.Z.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){s.Y.printStackTrace(t,null,this)}})),c.addEvent("onclick",(function(t){o.noevent=!0})),c}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setTextImageHead=function(t,e){try{var i,o=t.getAttribute("id"),r=this.headCellInfoHash[o];"json"===r._elementType&&(i=r.cloneNode(!0)._element.A);var n=i.viewType?i.viewType:"default",l=i.imageSrc?i.imageSrc:"",h=null!=i.value?i.value:"",d=i.imageStyle?'style="'+i.imageStyle+'"':"",u=i.imageAlign?i.imageAlign:"right";if(t.innerHTML="","icon"==n){t.innerHTML=["<div class='headerTextImageAlign'>"].join("");var c=t.querySelector(".headerTextImageAlign");"left"===u?c.innerHTML=["<img src='"+l+"' "+d+"/>",this.dataTagOpen+h+this.dataTagClose].join(""):"right"===u&&(c.innerHTML=[this.dataTagOpen+h+this.dataTagClose,"<img src='"+l+"' "+d+"/>"].join(""));var g=this,f=t.getElementsByTagName("img")[0];p.f.addListener(f,"onclick",(function(t){p.f.stopPropagation(t),g._getHeaderDisabled(o)||p.f.fireEvent(g,"onheadertextimageclick",o,h)}))}else"default"==n&&(t.innerHTML=this.dataTagOpen+h+this.dataTagClose);var m=a.Z.first(t),y=a.Z.getDataPrefix("colId"),b=a.Z.getDataPrefix("col_id");return m.setAttribute(y,e),m.scope_id=this.scope_id,m.headerId=t.getAttribute(b),m}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderDIV=function(t){return this.getHeaderLayer(t)},R.prototype.getHeaderLayer=function(t){try{for(var e=WebSquare.util.getDataPrefix("header_id"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),r=0;r<i.length;r++){var a=i[r],n=a.getAttribute(e);if("number"==typeof t)t=o[t+this.defaultColCnt].getAttribute(e);if(null!=n&&null!=t&&t.toLowerCase()==n.toLowerCase())return a}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderInfo=function(t){try{return this.headerInfoHash[t]||{options:{}}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getTotalHeaderCol=function(t){try{for(var e=0,i=this.htmlInfo.head.headerTdHtml,o=0,r=i.length;o<r;o++)e+=i[o].length;return t&&t.defaultColumn&&(e+=this.defaultColCnt),e}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderColumnVisible=function(t){var e=this.getHeaderInfo(t),i=this._getRealColIndex("head",t),o=i+this.defaultColCnt,s=!this.hiddenList[o];if(e&&(0===i||i)){for(var r=0;r<e.options.colSpan;r++)s=!this.hiddenList[o+r]||s;return s}c.v.printLog("[getHeaderColumnVisible] Invalid headerId provided.")},R.prototype.setHeaderValue=function(t,e,i){var o=this.getHeaderLayer(t);if(o)if("function"==typeof e)e(o);else{var r=this.headerObj[t],n=e;i&&(e=this.getFormattedHeaderValue(t,e));var l=a.Z.getDataPrefix("value");if(r)if("select"==r.headInputType||"checkcombobox"==r.headInputType)r.setValue(e);else if("checkbox"==r.headInputType)r.checked!=a.Z.getBoolean(e)&&(r.click(),
r.checked=a.Z.getBoolean(e));else if("input"==r.headInputType){if(r.value!=e){r.value=e;var h=a.Z.getGlobalFunction(r.getAttribute("changeFuncName"),this.scope_id);if("function"==typeof h)try{h.call(r,r.value,r.getAttribute("colId"))}catch(t){s.Y.printStackTrace(t,null,this)}}}else"user"==r.headerInputType&&r.setValue(e);else{this.headerDataObj&&t&&(this.headerDataObj[t].value=n);var d=o.getElementsByTagName(this.options.dataTag)[0];d?("NOBR"==d.tagName||"SPAN"==d.tagName&&d.className.indexOf("w2grid_span")>-1)&&(d.innerHTML=e):o.innerHTML=this.dataTagOpen+e+this.dataTagClose}o.setAttribute(l,e);for(var u=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],p=WebSquare.Elem.api.getElementsByTagName(u,"w2:column"),c=0;c<p.length;c++){var g=p[c];if(t==g.getAttribute("id")){g.setAttribute("value",e);break}}}},R.prototype.setHeaderNodeSet=function(t,e,i,o){if(this.getHeaderLayer(t)){var s=this.headerObj[t];s&&("select"!=s.headInputType&&"checkcombobox"!=s.headInputType||s.setNodeSet(e,i,o))}},R.prototype.setHeaderUserObject=function(t,e){this.headerObj[t]=e,e.headerInputType="user";var i=this.getHeaderLayer(t);i.innerHTML="",i.appendChild(e.getContent())},R.prototype._getHeaderValue=function(t){var e="";if(t&&(e=this.getHeaderLayer(t)),e){var i=this.headerObj[t];if(i){var o="";if("select"==i.headInputType||"checkcombobox"==i.headInputType)o=i.getValue();else if("checkbox"==i.headInputType){o=!i.indeterminate&&i.checked;var s=this.headerToBodyRelation[t];if(this.options.returnTrueFalseValue&&s){var r=this.getCellInfo(s),n=r.options.trueValue,l=r.options.falseValue;o&&n?o=n:l&&(o=l)}}else"input"==i.headInputType?o=i.value:"user"==i.headerInputType&&(o=i.getValue());return o}var h=a.Z.first(e),d=h.getElementsByTagName(this.options.dataTag.toUpperCase())[0];if(d)h=d;else for(d=h;d&&"NOBR"!=d.tagName&&!("SPAN"==d.tagName&&d.className.indexOf("w2grid_span")>-1);){if("TD"==d.tagName){h=a.Z.first(d);break}d=a.Z.first(d)}return h?h.innerHTML:""}},R.prototype.getHeaderValue2=function(t){return this._getHeaderValue(t)},R.prototype.getHeaderValue=function(t){var e="";if(t&&(e=this.getHeaderLayer(t)),e){var i=a.Z.getDataPrefix("inputtype");if(!this.options.titleAuto||"text"!=e.getAttribute(i))return this._getHeaderValue(t);var o=e.getElementsByTagName(this.options.dataTag.toUpperCase())[0];if(o&&("NOBR"==o.tagName||"SPAN"==o.tagName&&o.className.indexOf("w2grid_span")>-1))return null!=o.textContent?o.textContent:o.innerHTML||""}},R.prototype.getFormattedHeaderValue=function(t,e){var i=this.getHeaderLayer(t);if(i){var o=a.Z.getDataPrefix("header_id");return this.headerDataObj[i.getAttribute(o)]&&(e=this.headerDataObj[i.getAttribute(o)].formatter.format(e)),e}},R.prototype.getHeaderValueList=function(t){for(var e=[],i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=a.Z.getDataPrefix("header_id"),s=a.Z.getDataPrefix("inputtype"),r=0;r<i.length;r++)if(null==this.hiddenList[r]||1==t||1!=this.hiddenList[r]){var n=i[r],l=n.getAttribute(o);if(null!=l&&n)if(this.options.captionAuto||this.options.summaryOnlyAuto){if("text"!=n.getAttribute(s))continue;var h=n.getElementsByTagName(this.options.dataTag.toUpperCase())[0];(h&&"NOBR"==h.tagName||"SPAN"==h.tagName&&h.className.indexOf("w2grid_span")>-1)&&(null!=h.innerText&&""!=h.innerText&&"\n"!=h.innerText?e.push(h.innerText):null!=h.textContent&&""!=h.textContent?e.push(h.textContent):null!=h.innerHTML&&""!=h.innerHTML?e.push(h.innerHTML):e.push(""))}else{var d,u=this.headerObj[l];u&&("select"==u.headInputType||"checkcombobox"==u.headInputType?d=u.getValue():"checkbox"==u.headInputType?d=u.checked:"input"==u.headInputType?d=u.value:"user"==u.headerInputType&&(d=u.getValue()),e.push(d));for(var p=a.Z.first(n),c=p;c&&"NOBR"!=c.tagName&&!("SPAN"==c.tagName&&c.className.indexOf("w2grid_span")>-1);){if("TD"==c.tagName){p=a.Z.first(c);break}c=a.Z.first(c)}p?e.push(p.innerHTML):e.push("")}}return e},R.prototype.getHeaderSpan=function(t,e){
for(var i=0;i<this.htmlInfo.head.rowArr.length;i++)for(var o=0;o<this.htmlInfo.head.rowArr[i].length;o++)if(this.htmlInfo.head.rowArr[i][o].id===t){if("row"===e)return this.htmlInfo.head.rowArr[i][o].rowSpan;if("col"===e)return this.htmlInfo.head.rowArr[i][o].colSpan}},R.prototype.getHeaderInputType=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].inputType},R.prototype.getSortableArr=function(){for(var t=[],e=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),i=0;i<e.length;i++){var o=this._checkSortable(e[i]);t.push(o)}return t},R.prototype.getSortableStatus=function(){return this.headerSortStatusArr.slice(0)},R.prototype.setSortable=function(t,e,i){try{i=i||{};var o=this.getElementById(this.id+"_"+t);if(null==o)return void c.v.printLog("["+this.id+"] Unable to find headerId : "+t);if(!0!==e&&!1!==e)return;var r=a.Z.getDataPrefix("sortable");if(this._checkSortable(o)!==e&&(o.setAttribute(r,e),!0!==i.keepSortImage)){for(var n,l=0;l<this.headerSortStatusArr.length;l++){var h=this.headerToBodyRelation[t];if(h===this.headerSortStatusArr[l].colID){n=h;break}}n?!1===e?this.setHeaderSortImage(t,0,0):this.setHeaderSortImage(t,this.headerSortStatusArr[n].sortOrder,0):this.options.showSortableImage&&!0===e&&this.setHeaderSortImage(t,0,0)}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.clearHeaderSort=function(){this.headerSortStatusArr=[];for(var t=a.Z.getDataPrefix("sortable"),e=a.Z.getDataPrefix("header_id"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=this.htmlInfo.head.rowArr,s=0;s<i.length;s++){if("_headerRowNumber"!==(u=i[s].getAttribute(e))&&"_headerRowStatus"!==u&&("false"!==i[s].getAttribute(t)||!0===this.options.showSortableImage)){if(o.length>1&&"top"==this.options.sortedImagePosition)for(var r=this.headerToBodyRelation[u],n=this.getColumnIndex(r),l=o[0],h=0;h<l.length;h++)if(l[h]["@col"]==n){u=l[h].id;break}var d=this.headerObj[u];d&&"user"==d.headerInputType||this.setHeaderSortImage(u,0,0)}}for(s=0;s<i.length;s++){var u="";i[s].getElementsByClassName("w2grid_customFilter_open").length>0?(u=i[s].getAttribute(e),this._lastHeaderElementType="filter"):i[s].getElementsByClassName("w2grid_head_sort_div_main_btn").length>0&&(u=i[s].getAttribute(e),this._lastHeaderElementType="sort"),u&&(this._lastHeaderElementId=u)}},R.prototype.drawHeaderSortImages=function(){for(var t=this.htmlInfo.head.rowArr,e=0;e<this.headerSortStatusArr.length;e++){var i="";if(t.length>1&&"top"==this.options.sortedImagePosition){for(var o=this.headerSortStatusArr[e].colID,s=this.getColumnIndex(o),r=t[0],a=0;a<r.length;a++)if(r[a]["@col"]==s){i=r[a].id;break}}else if(!(i=this.bodyToHeaderRelation[this.headerSortStatusArr[e].colID])){var n=this.headerSortStatusArr[e].colID,l=this.getColumnIndex(n);for(l--;l>=0&&(n=this.getColumnID(l),!(i=this.bodyToHeaderRelation[n]));)l--}i&&this.setHeaderSortImage(i,this.headerSortStatusArr[e].sortOrder,e+1)}},R.prototype.setHeaderSortImage=function(t,e,i){var o=this.getElementById(this.id+"_"+t);if(null!=o){e=parseInt(e,10),i=parseInt(i,10);isNaN(i)||i<=0||this.headerSortStatusArr.length<2?i="":i+="",this._clearHeaderSortImage(o,"table"),this._clearHeaderSortImage(o,"div");var n="",l=this.options.showSortableImage;this.options.showSortableImage&&(l=!!(n=this._checkSortable(o)));var h=this._checkUseFilter(o),d=!1,u=!1;if(0===this.getDataLength()&&this.options.hideSortIconOnNoData&&(u=!0),0===this.getDataLength()&&this.options.hideFilterIconOnNoData&&(d=!0),h){var p=d?"none":"",g=o.getElementsByTagName("input");g&&g[0]&&(g[0].style.display=p)}if(!0!==this.options.showSortableImage){var f;if(0!==e){f=a.Z.first(o);var m=null,y=null,b=null;try{this._useCheckboxLabel(t)&&(y=document.createElement("div"),m=a.Z.next(f),y.appendChild(m))}catch(t){s.Y.printStackTrace(t,null,this)}
"nobr"==f.nodeName.toLowerCase()||"span"==f.nodeName.toLowerCase()&&f.className.indexOf("w2grid_span")>-1?(f=o.innerHTML,o.innerHTML=""):f=o.removeChild(f),this.headerObjArr[t]=f;var v=1==e?"w2grid_head_sort_asc":"w2grid_head_sort_desc",w=0,C="w2grid_head_sort_table_main",I="w2grid_head_sort_td",_="<table "+(B=a.Z.getDataPrefix("sort"))+"='sort' class='"+C+"'><tr><td></td><td class='"+I+" "+v+"'>"+i+"</td></tr></table>";"left"===this.options.sortedIconPosition&&(w=1,_="<table "+B+"='sort' class='"+C+"'><tr><td class='"+I+" "+v+"'>"+i+"</td><td></td></tr></table>"),o.innerHTML=_;var x=o.getElementsByTagName("td");"string"==typeof f?x[w].innerHTML=f:(x[w].appendChild(f),m&&y&&(x[w].appendChild(y.removeChild(m)),y=null))}}else{var S=a.Z.getDataPrefix("checkboxLabelPosition"),R=this.headerObj[t];if(R)R.render&&(R=R.render);else{var D=o.getElementsByTagName(this.options.dataTag)[0];(D&&"NOBR"==D.tagName||"SPAN"==D.tagName&&D.className.indexOf("w2grid_span")>-1)&&(R=D)}m=null;var T=null;try{this._useCheckboxLabel(t)&&("left"===this.headerInfoHash2[t].getAttribute(S)?(T="left",y=document.createElement("div"),m=a.Z.prev(R),y.appendChild(m)):(y=document.createElement("div"),m=a.Z.next(R),y.appendChild(m)))}catch(t){s.Y.printStackTrace(t,null,this)}try{h&&this.options.showSortableUseFilter&&(b=o.getElementsByTagName("input")[0])}catch(t){s.Y.printStackTrace(t,null,this)}R.parentNode.removeChild(R);v="";var L="";switch(e){case 0:!1!==l||n?(v="w2grid_head_sort_none",L=WebSquare.language.getMessage("Grid_sort_asc")):(v="w2grid_head_sort_image_none",L="");break;case 1:v="w2grid_head_sort_asc",L=WebSquare.language.getMessage("Grid_sort_desc");break;case-1:v="w2grid_head_sort_desc",L=WebSquare.language.getMessage("Grid_sort_none");break;default:v="w2grid_head_sort_none",L=WebSquare.language.getMessage("Grid_sort_asc")}if(this.options.sortHeaderDiv)if(!0===this.options.accessibility){v+="_btn";var k="_accessibility",F="w2grid_head_sort_div_main_btn";"left"===this.options.sortedIconPosition&&(v+="_left"),F+=k,v+=k;var A,E=u?"style = 'display:none'":"";B=a.Z.getDataPrefix("sort");if(n){var M="";!1===this.getHeaderColumnVisible(t)&&(M=" tabIndex='-1'"),o.innerHTML="<button "+B+"='sort' class='"+F+" "+v+"' "+E+M+"></button>",A=o.getElementsByTagName("button")[0]}else o.innerHTML="",A=o;if(A.appendChild(R),m&&y)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute(S)?A.appendChild(y.removeChild(m)):A.insertBefore(y.removeChild(m),R),y=null;else if(h&&this.options.showSortableUseFilter){var O=n?A:R;q=O.parentElement;(V=document.createElement("div")).appendChild(O),V.appendChild(b),this.addClass(V,"w2grid_head_sort_div_main_outer_box"),q.appendChild(V),this.addClass(b,"w2grid_customFilter_sortable_open"),a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<8?this.addClass(O,"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(O,"w2grid_head_sort_usefilter_div_main")}}else{v+="_btn";F="w2grid_head_sort_div_main_btn",E=u?"style = 'display:none'":"",B=a.Z.getDataPrefix("sort");var N="";0==this.getHeaderColumnVisible(t)&&(N=" tabIndex='-1'"),o.innerHTML="<div "+B+"='sort' class='w2grid_head_sort_div_main_outer'><button class='"+F+" "+v+"'"+E+N+" >"+L+"</button></div>";x=o.getElementsByTagName("div");var H=o.getElementsByTagName("button")[0];if(x[0].insertBefore(R,H),m&&y)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute(S)?x[0].insertBefore(y.removeChild(m),H):x[0].insertBefore(y.removeChild(m),R),y=null;else if(h&&this.options.showSortableUseFilter){q=x[0].parentElement;(V=document.createElement("div")).appendChild(x[0]),V.appendChild(b),this.addClass(V,"w2grid_head_sort_div_main_outer_box"),q.appendChild(V),this.addClass(b,"w2grid_customFilter_sortable_open"),a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<8?this.addClass(x[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(x[1],"w2grid_head_sort_usefilter_div_main")}}else{var G="w2grid_head_sort_div_main",W="w2grid_head_sort_div_sub"
;"left"===this.options.sortedIconPosition&&(G="w2grid_head_sort_div_main_left"),!0===this.options.showSortableImage&&(W="left"===this.options.sortedIconPosition?"w2grid_head_sort_div_sub_sortable_image_left":"w2grid_head_sort_div_sub_sortable_image"),u&&(v="");var B=a.Z.getDataPrefix("sort");if(o.innerHTML="<div "+B+"='sort' class = '"+G+" "+v+"'><div class = '"+W+"'>"+i+"</div></div>",(x=o.getElementsByTagName("div"))[0].appendChild(R),m&&y)"left"===T?x[0].insertBefore(y.removeChild(m),R):x[0].appendChild(y.removeChild(m)),y=null;else if(h&&this.options.showSortableUseFilter){var V,q=x[0].parentElement;(V=document.createElement("div")).appendChild(x[0]),V.appendChild(b),this.addClass(V,"w2grid_head_sort_div_main_outer_box"),q.appendChild(V),this.addClass(b,"w2grid_customFilter_sortable_open"),a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<8?this.addClass(x[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(x[1],"w2grid_head_sort_usefilter_div_main")}}}if(n){var Y="other";switch(e){case 0:Y="other";break;case 1:Y="ascending";break;case-1:Y="descending";break;default:Y="other"}o.setAttribute("aria-sort",Y)}}else c.v.printLog("["+this.id+"] Unable to find headerId : "+t)},R.prototype._clearHeaderSortImage=function(t,e){var i=t.getElementsByTagName(e),o=a.Z.getDataPrefix("sort"),r=a.Z.getDataPrefix("header_id");if(i.length>0&&"sort"==i[0].getAttribute(o)){var n=t.getAttribute(r),l=this.headerObjArr[n];if(l)if("string"==typeof l)t.innerHTML=l;else{var h=null,d=null;try{this._useCheckboxLabel(n)&&(d=document.createElement("div"),h=a.Z.next(l),d.appendChild(h))}catch(t){s.Y.printStackTrace(t,null,this)}l=t.appendChild(l),h&&d&&(t.appendChild(d.removeChild(h)),d=null),t.removeChild(l.previousSibling)}}},R.prototype.getColIdByHeaderId=function(t){return this.headerToBodyRelation[t]},R.prototype.setHeaderHide=function(t){if(t=a.Z.getBoolean(t),this.options.hideHeader!=t){this.options.hideHeader=t;var e=this.getElementById(this.id+"_head_table"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));if(t){e.style.display="none";for(var o=0;o<i.length;o++){var s=i[o].getAttribute("class");null!=s&&(i[o].setAttribute("data-bkclass",s),i[o].removeAttribute("class"))}}else{e.style.display="";for(o=0;o<i.length;o++){var r=i[o].getAttribute("data-bkclass");null!=r&&(i[o].setAttribute("class",r),i[o].removeAttribute("data-bkclass"))}}this.refresh(),this.setScrollYHeight()}},R.prototype.setHeaderDisabled=function(t,e){try{e=a.Z.getBoolean(e);var i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?(o.setDisabled?o.setDisabled(e):o.render?o.render.disabled=e:o.disabled=e,i.disabled=e):i.disabled=e}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype._getHeaderDisabled=function(t){try{var e=!1,i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?o.getDisabled?e=o.getDisabled():o.render?e=o.render.disabled:o.disabled&&(e=o.disabled):i.disabled&&(e=i.disabled)}return e}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderID=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,r=0;r<e.children.length;r++){var a=e.children[r].children;if((o+=a.length)>t){var n=a[i];return n?n.id.replace(this.id+"_",""):null}i-=a.length}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderIDArr=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,r=[],a=0;a<e.children.length;a++){var n=e.children[a].children;if((o+=n.length)>t){var l=n[i];l&&r.push(l.id.replace(this.id+"_",""))}else i-=n.length}return r}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderIndex=function(t){try{if("number"==typeof t)return t;var e=this.head_table;e||(e=this.getElementById(this.id+"_head_table"));for(var i=0,o=0;o<e.children.length;o++){for(var r=e.children[o].children,a=0;a<r.length;a++){if(r[a].id.replace(this.id+"_","")==t)return i+a-this.defaultColCnt}i+=r.length}
}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderRowIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return e},R.prototype.getHeaderColIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].colIndex},R.prototype.getHeaderColID=function(t,e){try{void 0!==e&&null!=e||(e={});for(var i="",o=this.struct.head.rowArr,r=!0===e.firstRow?1:o.length,a=0;a<r;a++){for(var n=o[a],l=0;l<n.length;l++)if(n[l].colIndex===t){i=n[l].id;break}if(i)break}return i}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setHeaderStyle=function(t,e,i){try{var o,r=a.Z.getDataPrefix("header_id"),n=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(o=n[t+this.defaultColCnt]).getAttribute(r);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var l=0;l<n.length;l++)(o=n[l]).getAttribute(r)==t&&WebSquare.style.setStyle(o,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.setHeaderClass=function(t,e){try{var i,o=a.Z.getDataPrefix("header_id"),r=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(i=r[t+this.defaultColCnt]).getAttribute(o);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var n=0;n<r.length;n++)(i=r[n]).getAttribute(o)==t&&(this.addClass(i,e),this.headerCellClassObj[t]=e)}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.getHeaderClass=function(t){try{var e=a.Z.getDataPrefix("header_id"),i=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=i[t+this.defaultColCnt].getAttribute(e);"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var o=0;o<i.length;o++)if(i[o].getAttribute(e)==t)return this.headerCellClassObj[t]}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.removeHeaderClass=function(t,e){try{var i,o=a.Z.getDataPrefix("header_id"),r=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(i=r[t+this.defaultColCnt]).getAttribute(o);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var n=0;n<r.length;n++)(i=r[n]).getAttribute(o)==t&&(this.removeClass(i,e),delete this.headerCellClassObj[t])}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.drawHeader=function(t,e){try{if(!this.head_table)return;null==this.headerDataObj&&this.initHeaderDataObj();var i=this.head_table.getElementsByTagName("th");this.headerTempSum=[];var o=a.Z.getDataPrefix("header_id");if(t){t=this.getColumnID(t);for(var r=0;r<i.length;r++){if(d=(h=i[r]).getAttribute(o))if(u=this.headerDataObj[d])if("expression"==u.inputType){var n=u.expression.match(/headercol(sum|avg|max|min)\s*\([^\)]*/g);if(n)for(var l=0;l<n.length;l++)n[l].split("(")[1].wq_replaceAll("'","").wq_replaceAll('"',"").wq_trim()==t&&(u.value=new Function("_this","return "+u.expression)(this),isNaN(u.value)&&"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat),h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose)}else""===u.displayFormat||"number"!=u.dataType||"text"!=u.inputType&&"textarea"!=u.inputType&&"button"!=u.inputType&&"textImage"!=u.inputType||(h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose)}}else for(r=0;r<i.length;r++){var h,d,u;if(d=(h=i[r]).getAttribute(o))if(u=this.headerDataObj[d])if("expression"==u.inputType){try{u.value=new Function("_this","return "+u.expression)(this),isNaN(u.value)&&"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat)}catch(t){s.Y.printStackTrace(t,null,this)}
h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose}else""===u.displayFormat||"number"!=u.dataType||"text"!=u.inputType&&"textarea"!=u.inputType&&"button"!=u.inputType&&"textImage"!=u.inputType||(h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose)}!e||!e.sortIcon||this.headerSortStatusArr&&0!==this.headerSortStatusArr.length||this.clearHeaderSort()}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.initHeaderDataObj=function(){try{var t=this.head_table.getElementsByTagName("th");this.headerDataObj={};for(var e=a.Z.getDataPrefix("header_id"),i=a.Z.getDataPrefix("expression"),o=a.Z.getDataPrefix("value"),n=a.Z.getDataPrefix("localeRef"),l=a.Z.getDataPrefix("inputType"),h=a.Z.getDataPrefix("dataType"),d=a.Z.getDataPrefix("displayFormat"),u=a.Z.getDataPrefix("displayFormatter"),p=a.Z.getDataPrefix("NaNFormat"),c=0;c<t.length;c++){var g=t[c],f={};f.id=g.getAttribute(e);var m=g.getAttribute(i)||"";if(""!=m&&(m=(m=(m=(m=m.replace(/[sS][uU][mM][\s]*[(]/g,"_this.headercolsum( ")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.headercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.headercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.headercolmin( ")),f.value=g.getAttribute(o)||"",this.options.useLocale){var y=g.getAttribute(n);if(y){var b=this.getLocaleValue(y);b&&(f.value=b)}}f.inputType=g.getAttribute(l),f.dataType=g.getAttribute(h)||"text",f.expression=m,f.displayFormat=g.getAttribute(d)||"",f.displayFormatter=g.getAttribute(u)||"",f.formatter=WebSquare.format.createFormatter(f.dataType,f.displayFormat,f.displayFormatter,null,null,null,this.scope_id,this.id),f.NaNFormat=g.getAttribute(p)||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||"NaN","$blank"==f.NaNFormat&&(f.NaNFormat=""),this.headerDataObj[f.id]=f}}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype.headercolsum=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].sum){var e="";if(this.groupbyStatus.grouped);else{var i=this.getColumnAllDataArray(t);e=a.Z.sum(i)}this.headerTempSum[t].sum=e}return a.Z.setPrecision(this.headerTempSum[t].sum)},R.prototype.headercolavg=function(t){var e=this.getColumnAllDataArray(t);this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={});var i="";if(this.groupbyStatus.grouped)return i;if(void 0===this.headerTempSum[t].sum){if(e.length>0){for(var o=0;o<e.length;o++)""==e[o].replace(/^\s+|\s+$/g,"")&&(e[o]="0");i=a.Z.sum(e)}this.headerTempSum[t].sum=i}return""==this.headerTempSum[t].sum?"":this.headerTempSum[t].sum/e.length},R.prototype.headercolmax=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e<s)&&(e=s)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.headerTempSum[t].max=e}return this.headerTempSum[t].max},R.prototype.headercolmin=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e>s)&&(e=s)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.headerTempSum[t].min=e}return this.headerTempSum[t].min},R.prototype._getMatchedHeaderId=function(t){try{return this.bodyToHeaderRelation[t]}catch(t){s.Y.printStackTrace(t,null,this)}};var D=function(t,e){try{this.options={id:"",value:"",inputType:"text",useFilter:!1,textAlign:""},this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),this.id=this.options.id}catch(t){s.Y.printStackTrace(t,null,this)}};R.prototype._setHeaderInfo=function(t,e){this.headerInfoHash2[t]=e},
R.prototype.setCheckboxHeader=function(t){try{"function"==typeof this.cellInfoHash[t].checkHeader&&this.cellInfoHash[t].checkHeader()}catch(t){s.Y.printStackTrace(t,null,this)}},D.prototype.setOptions=function(t){this.options.useFilter=a.Z.getBoolean(r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/header/column/useFilter/@value")),this.options.hideCustomFilter=a.Z.getBoolean(r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/header/column/hideCustomFilter/@value"));var e=[];for(var i in this.options)e[i.toLowerCase()]=i;var o=this.mainGrid.headerConfigOptions[t.getAttribute("id")]||{};for(var i in o)this.options[i]=o[i];var s=WebSquare.Parser.parseAttribute(t);for(var n in s){var l=s[n];"class"==n?this.options.className=l:""!=String(l).wq_trim()&&(e[n]&&(n=e[n]),"boolean"==typeof this.options[n]?l=a.Z.getBoolean(l):"number"==typeof this.options[n]&&(l=a.Z.getNumber(l)),this.options[n]=l)}},R.prototype._useCheckboxLabel=function(t){try{var e=a.Z.getDataPrefix("inputType"),i=a.Z.getDataPrefix("checkboxLabel"),o=a.Z.getDataPrefix("checkboxlabel"),r=this.getHeaderLayer(t);return"checkbox"===r.getAttribute(e)&&(r.getAttribute(i)||r.getAttribute(o))}catch(t){s.Y.printStackTrace(t,null,this)}},R.prototype._checkUseFilter=function(t){try{if(!t)return!1;if("string"==typeof t&&!(t=this.getHeaderLayer(t)))return!1;var e=a.Z.getDataPrefix("useFilter"),i=t.getAttribute(e);if(i&&"string"==typeof i){var o=i.toLowerCase();if("true"===o)return!0;if("false"===o)return!1}var n=a.Z.getDataPrefix("header_id"),l=t.getAttribute(n);if(!l||"_headerRowNumber"===l||"_headerRowStatus"===l)return!1;var h=a.Z.getDataPrefix("inputType"),d=t.getAttribute(h),u="/WebSquare/"+this.options.pluginName+"/header/column[@inputType='"+d+"']/useFilter/@value",p=r.I.getConfiguration(u),c=(this.headerConfigOptions[l]||{}).useFilter;return a.Z.getBoolean(p)||a.Z.getBoolean(c)}catch(t){return s.Y.printStackTrace(t,null,this),!1}},R.prototype._checkSortable=function(t){try{if(!t)return!1;if("string"==typeof t&&!(t=this.getHeaderLayer(t)))return!1;var e=a.Z.getDataPrefix("sortable"),i=t.getAttribute(e);if(i&&"string"==typeof i){var o=i.toLowerCase();if("true"===o)return!0;if("false"===o)return!1}if(this.options.sortable)return!0;var r=a.Z.getDataPrefix("header_id"),n=t.getAttribute(r);if(!n||"_headerRowNumber"===n||"_headerRowStatus"===n)return!1;var l=(this.headerConfigOptions[n]||{}).sortable;return a.Z.getBoolean(l)}catch(t){return s.Y.printStackTrace(t,null,this),!1}};var T=function(){};T.prototype.getLastFocusedCell=function(){if(this.focusedCell.length>0)return this.focusedCell[this.focusedCell.length-1];var t={focusedRowIndex:-1,focusedColIndex:null};return this.options.groupbyDisplayRowIndex&&(t.groupbyDisplayRowIndex=-1),t},T.prototype.getFocusedRowIndex=function(){return this._getFocusedRowIndex(this.options.groupbyDisplayRowIndex)},T.prototype._getFocusedRowIndex=function(t){return this.getLastFocusedCell()[!0===t&&this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex"]},T.prototype.getFocusedRealRowIndex=function(){return this.getLastFocusedCell().focusedRealRowIndex},T.prototype.getAllFocusedIndex=function(){for(var t=this.focusedCell,e=[],i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<t.length;o++){var s={};s.col=t[o].focusedColIndex,s.row=t[o][i],e.push(s)}return e},T.prototype.getAllFocusedRowIndex=function(){for(var t=[],e={},i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<this.focusedCell.length;o++){e[this.focusedCell[o][i]]=!0}for(var s in e)t.push(parseInt(s,10));return t},T.prototype.getFocusedColumnIndex=function(){return this.getLastFocusedCell().focusedColIndex},T.prototype.getFocusedColumnID=function(){return this.getColumnID(this.getFocusedColumnIndex())},T.prototype.getFocusedRowStatus=function(){var t=this._getFocusedRowIndex(!0);return-1==t?null:this.dataList.getRowStatus(t)},
T.prototype.setFocusedCell2=function(t,e,i,o){try{o=o||{};i=a.Z.getBoolean(i),e=this.getColumnIndex(e);var r=!1;try{r=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){r=!1}var n=this.getLastFocusedCell(),l=i&&n.focusedColIndex==e;if((this.___getEditReadOnly(t,e)||this._getEditDisabled(t,e))&&(l=!1),this.editedCell&&!this.editedCell.handleEndEdit(null,l))return!1;if(r||!0===this._isBrowserScroll()){if(!0===this._isHybridScroll()){!0===this._drawDataHybrid(t)&&(o.hybridAsync=!0),y=t-(this.rowIndex>0?this.rowIndex:0)}}else{var h=this._getVisibleLastIndex(this.lastIndex+1),d=this.getDataLength(),u=this.rowIndex+this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex);!0===this.hiddenRowObj.init&&this.rowIndex===d-h&&(u=d-this._getVisibleLastIndex(1));var p=this.rowIndex,c=this.hiddenCellObj.length>0;if(c&&t===u&&(u=Math.max(u-1,0)),t<p||t>u){var g=t<p?t-p:t-u;if(t>u&&this.hasSubtotal){for(var f in this.rollbackCommitFlag=!1,this.subtotalTableList){if(u<d-1)this.dataList._getCellData(u,f)!=this.dataList._getCellData(u+1,f)&&g++}this.rollbackCommitFlag=!0}var m=this.rowIndex+g;m=(m=m<0?0:m)>d-h?d-h:m,c&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(m=Math.min(m,this.lastTopRowIndex)),m!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!0,m=Math.max(0,m),isNaN(this.lastTopRowIndex)||null==this.lastTopRowIndex||(m=Math.min(m,this.lastTopRowIndex)),this.drawData(m,0,"keymove",l),!0===this.hiddenRowObj.init||c||(this.lastIndex=this.getLastIndex(this.lastDisplayedRow)))}}var y=t-(this.rowIndex>0?this.rowIndex:0),b=this.data_td_list[e+y*this.oneRowDataLength];return!!b&&("rollback"==this.__setFocusedCell({ctrl:!1},b,{editMode:i,dont_hide:l,dont_fixScroll:!0,tabDirection:o.tabDirection,shifted:o.shifted})&&this._setFocusedCell(n.focusedRowIndex,n.focusedColIndex,!0,{tabDirection:o.tabDirection}),!0)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setFocusedCell=function(t,e,i,o){try{(o=o||{}).groupbyDisplayRowIndex=this.options.groupbyDisplayRowIndex;var r=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),a=t;if(r&&(a=this.getDisplayRowIndex(t)),!isNaN(a)){if(!0===o.keepFocusedCell)for(var n=this.getColumnIndex(e),l=0;l<this.focusedCell.length;l++)if(this.focusedCell[l].focusedRowIndex===t&&this.focusedCell[l].focusedColIndex===n)return;return this._setFocusedCell(a,e,i,o)}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype._setFocusedCell=function(t,e,i,o){try{if(o=o||{},"none"==this.options.focusMode)return;if(!0===o.groupbyDisplayRowIndex&&(t=this._getGroupbyGroupedRowIndex(t,!0)),0==arguments.length||1==arguments.length){i=0!=arguments.length&&arguments[0];var r=this.colIndexInfo.body.colInfo.colIndexMatch;if(this.focusedCell.length>0)t=this.focusedCell[this.focusedCell.length-1].focusedRowIndex,e=this.focusedCell[this.focusedCell.length-1].focusedColIndex;else if(this.lastFocusedCell&&null!=this.lastFocusedCell.focusedColIndex&&this.lastFocusedCell.focusedRowIndex>=0)t=this.lastFocusedCell.focusedRowIndex,e=this.lastFocusedCell.focusedColIndex;else{var n=this.getLastFocusedCell();t=n.focusedRowIndex;if(null==(e=n.focusedColIndex)||-1==t)return this.focusedCell=[{focusedRowIndex:0,focusedColIndex:r.length-this.defaultColCnt-1}],this.moveHorizontal(null,"home"),void(i&&this._setFocusedCell(!0))}}var l=this.getDataLength(),h=this.getDataLength()-this._getVisibleLastIndex(1);if(e=this.getColumnIndex(e),t<0||t>h||e<0||e>=this.oneRowDataLength)return;var d=!1;try{d=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){d=!1}if(i=a.Z.getBoolean(i),this.delayedDraw({rowIndex:t}))return this.focusedCell=[{focusedRowIndex:t,focusedColIndex:e}],this._linkedDataList?this._linkedDataList.setRowPosition(t):this._dataList.setRowPosition(t),void this._dataList.setColumnPosition(this.getColumnID(e))
;var u=this.getElementById(this.id+"_scrollY_div");!0!==this._isBrowserScroll()&&u&&0==u.scrollTop&&this.rowIndex>0&&(u.scrollTop=this.lastScrollYTop);var p=t-(this.rowIndex>0?this.rowIndex:0);if(d||!0===this._isBrowserScroll()){if(!0===this._isHybridScroll()){!0===this._drawDataHybrid(t)&&(o.hybridAsync=!0),p=t-(this.rowIndex>0?this.rowIndex:0)}}else if(p<0)this.scrollEvent=!1,u.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0),p=0;else if(this.options.showLastRow&&p-this.lastIndex==1&&""===this.options.visibleRowNum);else if(p>this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex)){var c=this._getVisibleLastIndex(this.lastIndex+1);this.hiddenCellObj.length>0&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(c=l-this.lastTopRowIndex);var g=t+c>l?l-c:t;this.hiddenCellObj.length>0&&(g=Math.max(0,g)),g!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!o.isSort||"string"!=typeof this.options.filterFocusMode||"followfocus"!==this.options.filterFocusMode.toLowerCase(),u.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(g),g>this.rowIndex+c-1&&(this.adjustDraw_keepTop=!0),this.drawData(g,0),p=t-this.rowIndex)}var f=this.data_td_list[e+p*this.oneRowDataLength];if(f){for(var m=5;!0!==this._isBrowserScroll()&&this.hiddenCellObj.length>0&&0===f.offsetHeight&&m>0;){this.lastTopRowIndex++;var y=this.getElementById(this.id+"_size_y"),b=(u=this.getElementById(this.id+"_scrollY_div"),y.offsetHeight);b<1e6&&(b=parseInt(y.style.height,10)),y.style.height=u.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",this.drawData(this.lastTopRowIndex,0),p--,f=this.data_td_list[e+p*this.oneRowDataLength],m--}return o.editMode=i,this.__setFocusedCell({ctrl:!1},f,o)}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.removeFocusedCell=function(){try{this.lastFocusedCell=this.getLastFocusedCell(),this.applyFocusedCellOut(),this.focusedCell=[],this._dataList.setRowPosition(null)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.applyFocusedCell=function(t,e){if(e||(this.applyFocusedCellOut(),this.focusedCell=[]),null!=t){this.applyFocusedCellIn(t);var i={};i.focusedTd=t,this.focusedCell.push(i)}},T.prototype.__setFocusedCell=function(t,e,i){try{i=i||{};var r=t.ctrlKey||i.ctrled,n=t.shiftKey||i.shifted,l=e.className,h="";if(this.options.focusDefaultColumn){if(l.indexOf("_groupby")>=0||l.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1}else if(l.indexOf("_rowNum")>=0||l.indexOf("_rowStatus")>=0||l.indexOf("_groupby")>=0||l.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1;var d=a.Z.getDataPrefix("tdIndex"),u=a.Z.getDataPrefix("colIndex"),c=parseInt(e.getAttribute(d)),g=parseInt(c/this.realRowDataLength),f=parseInt(e.getAttribute(u)),m=g+this.rowIndex,y=this._getGroupbyDisplayRowIndex(m),b=m;this.isDrillDown&&this._dataList.options.depthColumn&&(b=this.getRealRowIndex(m));var v=c%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),w=this.getColumnID(v),C=!0,I=this.getLastFocusedCell();this.focusedCell.length>0&&I.focusedTd==e&&(C=!1);var _,x={focuseChanged:C};if(o.q.extend(x,i),C&&this.editedCell&&!this.editedCell.handleEndEdit(t,!!i.dont_hide,x))return!1;_=this._linkedDataList?this._linkedDataList.setRowPosition(y):this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex?this._dataList.setRowPosition(y):this._dataList.setRowPosition(b);var S=this._dataList.setColumnPosition(w);if(!1===_||!1===S)return this.options.senseReader&&I&&I.focusedTd&&I.focusedTd.focus(),!1;var R=this._getFocusedRowIndex(),D=this.getFocusedColumnIndex(),T=!(a.Z.getBoolean(this.options.useCtrlKey)&&r||a.Z.getBoolean(this.options.useShiftKey)&&n||i.keepFocusedCell||i.keepFocusedMultiCell),L=!1;if(T&&a.Z.getBoolean(i.allowContextMenuMultiCell)&&(T=!1,L=!0,this.focusedCell)){for(var k=!1,F=0;F<this.focusedCell.length;F++)if(this.focusedCell[F].focusedTd==e){k=!0;break}k||(T=!0,L=!1)}
if(T&&(this.applyFocusedCellOut(),this.focusedCell=[]),i.keepFocusedMultiCell&&this.focusedCell.length>0)for(F=0;F<this.focusedCell.length;F++){if(m===(V=this.focusedCell[F]).focusedRowIndex&&v===V.focusedColIndex){this._applyFocusedCellOut(V),this.focusedCell.splice(F,1);break}}if(i.tabDirection||(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),this.focusedCell.length>0&&a.Z.getBoolean(this.options.useShiftKey)&&n){var A,E=(A=!0===this.options.ctrlShiftKey||!0===i.keepFocusedMultiCell?this.focusedCell[this.focusedCell.length-1]:this.focusedCell[0]).focusedRowIndex,M=A.focusedColIndex,O=!1;if((this.options.focusDefaultColumn&&A.focusedColIndex<0&&v<0&&this.hasClass(e,"gridBodyDefault_rowNumber")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowStatus")||this.hasClass(A.focusedTd,"gridBodyDefault_rowNumber")&&this.hasClass(e,"gridBodyDefault_rowStatus")||this.hasClass(e,"gridBodyDefault_rowNumber")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowNumber")||this.hasClass(e,"gridBodyDefault_rowStatus")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowStatus"))&&(O=!0),O)return this.applyFocusedCellOut(),this.focusedCell=[],void this.__setFocusedCell(t,e);h="multiCell",this._applyFocusedMultiCell(E,M,m,v,i.ignoreFocusMode,i),i.dont_fixScroll||(f>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}else if(!L){var N;if(this.getCellInfo(e).options.blockSelect)return;var H={focusedTd:e,focusedRealRowIndex:b,focusedRowIndex:N=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>m-this.rowIndex||this.options.lastFixedRow>0&&m-this.rowIndex>this.lastIndex-this.options.lastFixedRow?m-this.rowIndex:m,focusedColIndex:v};this.options.groupbyDisplayRowIndex&&(H.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(N)),this.focusedCell.push(H),i.dont_fixScroll||(f>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds();var G=!0!==this._isBrowserScroll()&&!!i.editMode;if(this.applyFocusedCellIn(e,G,{tabDirection:i.tabDirection,ignoreFocusMode:i.ignoreFocusMode,dataListRowPositionChanged:i.dataListRowPositionChanged,customRowIndex:m}),"linear"===this.options.focusFlow&&!0===i.editMode&&(this.focusedByApi=!1),I=this.getLastFocusedCell(),i.ignoreFocusMode||"cell"==this.options.focusMode){for(F=this.focusedCell.length-2;F>=0;F--)if(this.focusedCell[F].focusedTd==I.focusedTd){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1);break}}else if("both"==this.options.focusMode){for(F=this.focusedCell.length-2;F>=0;F--)if(this.focusedCell[F].focusedTd==I.focusedTd){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1),this.changeFocusedCellPosition(this.rowIndex);break}}else if("row"==this.options.focusMode){var W=a.Z.getDataPrefix("trIndex"),B=I.focusedTd?I.focusedTd.parentNode:null;for(F=this.focusedCell.length-2;F>=0;F--){var V;if(null!=(V=this.focusedCell[F]).focusedTd){var q=V.focusedTd.parentNode;for(g=parseInt(q.getAttribute(W));g>0;)g--,q=a.Z.prev(q);do{if(q==B){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1),this.changeFocusedCellPosition(this.rowIndex,!0);break}if(!(q=a.Z.next(q)))break}while("0"!=q.getAttribute(W))}}}}var Y=this.getCellInfo(v);if("custom"==Y.options.inputType&&(Y=Y.cellManagerHashByRowIndex[m]),(R=this._getGroupbyDisplayRowIndex(R))==(m=this._getGroupbyDisplayRowIndex(m))&&D==v||p.f.fireEvent(this,"oncellindexchange",m,v,R,D),R!=m&&p.f.fireEvent(this,"onrowindexchange",m,R),D!=v&&p.f.fireEvent(this,"oncolumnindexchange",v,D),!0===this._isHybridScroll()&&!0!==i.hybridAsync){
var Z=document.getElementById(this.id+"_main_div"),j=document.getElementById(this.id+"_scrollY_div"),P=Math.round(j.scrollTop),z=this.getFooterHeight(),U=document.getElementById(this.id+"_head_table").offsetHeight,X=Z.offsetHeight,K=e.offsetHeight,$=X-U-z,J=P-this._hybridScrollYPos-e.offsetTop;a.Z.isIEAllVersion()&&(J+=U);var Q=K-J-$;if(J>0){var tt=P-J;j.scrollTop=tt}else if(Q>0){tt=P+Q;j.scrollTop=tt}}if(i.editMode){var et=this.uuid,it=e.id;if(!0===this._isNativeScroll()){var ot=e.parentNode,st=this.id+"_dataLayer",rt=document.getElementById(st),at=(U=this.head_table.offsetHeight,ot.offsetHeight*this.oneRowLength);tt=ot.offsetTop-rt.offsetHeight+at+2;a.Z.requestAnimationFrame((function(){var t,e=document.getElementById(st);e.scrollTop<tt?e.scrollTop=tt:e.scrollTop>(t=tt+e.offsetHeight-U-at)&&(e.scrollTop=Math.max(t,0)),a.Z.requestAnimationFrame((function(){var t=WebSquare.idCache[et],e=document.getElementById(it);t.setEditMode(e)}))}))}else!0===this._isHybridScroll()?a.Z.requestAnimationFrame((function(){var t=WebSquare.idCache[et],e=document.getElementById(it);t.setEditMode(e)})):this.setEditMode(e)}return h}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.applyFocusedCellOut=function(){if(this.focusedCell.length>0)for(var t=0;t<this.focusedCell.length;t++){var e=this.focusedCell[t];this._applyFocusedCellOut(e)}},T.prototype._applyFocusedCellOut=function(t){if("row"==this.options.focusMode||"both"==this.options.focusMode){if(null==(o=t.focusedTd)&&this.options.showLastRow){var e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&this.removeFocusRowStyle(o)}if("cell"==this.options.focusMode||"both"==this.options.focusMode){var o;if(null==(o=t.focusedTd)&&this.options.showLastRow){e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&("linear"!=this.options.focusFlow&&o.setAttribute("tabIndex",-1),this.removeClass(o,"focusedTd"),(!this.options.focusDefaultColumn||t.focusedColIndex>=0)&&(this.options.fixedRow>0&&t.focusedRowIndex-this.rowIndex>=0&&this.options.fixedRow>t.focusedRowIndex-this.rowIndex||this.options.lastFixedRow>0&&t.focusedRowIndex-this.rowIndex>this.lastIndex-this.options.lastFixedRow?this.applyCellStyleOptions(t.focusedRowIndex-this.rowIndex,t.focusedColIndex,!0):this.applyCellStyleOptions(t.focusedRowIndex,t.focusedColIndex,!0)),this.options.rowMouseOver&&this.addRowOverStyle(this.overElem))}},T.prototype.removeFocusRowStyle=function(t){try{if(null==t)return;for(var e=a.Z.getDataPrefix("trIndex"),i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("style_bak"),r=t.parentNode,n=parseInt(r.getAttribute(e));n>0;)n--,r=a.Z.prev(r);var l=a.Z.first(r),h=parseInt(l.getAttribute(i));n=parseInt(h/this.realRowDataLength);for(var d=0;d<this.realRowDataLength;d++){var u=d;d>=this.defaultColCnt&&(u=Math.floor((d-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(d-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var p=n*this.realRowDataLength+u,c=this.all_data_td_list[p];if(this.removeClass(c,"focusedTr"),d<this.defaultColCnt){var g=c.className;g.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||g.indexOf("w2grid_groupby_depth_0")>=0?""!=this.options.rowNumBackgroundColor&&!0!==this.options.rowNumRowMouseOverColor||(c.style.backgroundColor="",c.removeAttribute(o)):g.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(c.style.backgroundColor="",c.removeAttribute(o))}else{var f=parseInt(c.getAttribute(i)),m=n+this.rowIndex,y=f%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(m,y,!0)}}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.applyFocusedCellIn=function(t,e,i){try{if("none"==this.options.focusMode)return;var o=(i=i||{}).tabDirection,r=i.ignoreFocusMode,n=i.linkNoFocus,l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("tdIndex"),d=this.getCellInfo(t.getAttribute(l)),u=d.options.inputType||"text",p=!1
;"custom"==d.options.inputType&&"undefined"!==i.customRowIndex&&(u=(d=d.cellManagerHashByRowIndex[i.customRowIndex]?d.cellManagerHashByRowIndex[i.customRowIndex]:d).options.inputType||"text"),this.options.useTextMultiLink&&this.options.senseReader&&"user"===u&&d.options.customFormatter&&(p=!0);var c,g=!0;if(i.dataListRowPositionChanged&&"sytle"===this.options.syncRowPositionOption&&(g=!1),!0===i.shifted&&this.options.senseReader&&(e=!0),g)if(this.focusedByApi=!0,d._realInputType&&(c=t.getElementsByTagName(d._realInputType)[0]),c instanceof HTMLElement)c.focus();else if(d.options.embeddedInput&&!1===p){var f=this.getElemRowIndex(t);if(e)if("text"!=u&&"link"!=u||!this._getEditDisabled(f,d.id)&&!this.__getEditReadOnly(t,f))this.getInput(d,t).focus();else!0===i.shifted&&this.options.senseReader&&t.setAttribute("tabIndex",0),t.focus();else if(o)if(this._getEditDisabled(f,d.id)||this.__getEditReadOnly(t,f))t.focus();else this.getInput(d,t).focus();else this.__getEditReadOnly(t,f)&&!0!==this.options.readOnlyTabIgnore&&(t.setAttribute("tabIndex",0),t.focus())}else{var m=!1;try{var y=this.focusedCell[this.focusedCell.length-1].focusedRealRowIndex-this.rowIndex;(this.rowIndex>0&&this.options.fixedRow>0&&y>=0&&this.options.fixedRow>y||this.options.lastFixedRow>0&&y-this.rowIndex>this.lastIndex-this.options.lastFixedRow)&&(m=!0)}catch(t){s.Y.printStackTrace(t,null,this)}if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum||this.___getEditReadOnly(y,t.getAttribute(l))&&!0===this.options.readOnlyTabIgnore||t.setAttribute("tabIndex",0),"custom"==u&&this.options.senseReader){f=this.getElemRowIndex(t);var b=d.cellManagerHashByRowIndex[f];u=b?b.options.inputType:"text"}if(e&&("text"==u||"secret"==u||"textarea"==u||"textImage"==u||"calendar"==u)||m||i.noApplyRealFocus);else if("button"==u&&this.options.senseReader){var v=t.getElementsByTagName("button");(v=v[0]).focus()}else if("link"==u&&this.options.senseReader){I=(I=t.getElementsByTagName("a"))[0],this.hasClass(document.activeElement,"w2grid_scrollY")?o&&I.focus():I.focus()}else if("checkbox"==u&&this.options.senseReader){t.getElementsByTagName("input")[0].focus()}else if("user"==u&&this.options.senseReader){var w;if(0==(I=t.getElementsByTagName("a")).length&&(I=t.getElementsByTagName("input")),-1!=this.focusedCellLinkIndex)if("right"==o){for(var C=0;C<I.length;C++)document.activeElement==I[C]&&(this.focusedCellLinkIndex=C);w=this.focusedCellLinkIndex+1}else w=this.focusedCellLinkIndex-1;else{if("right"==o)w=0;else if(null==o){if(w=0,document.activeElement)for(C=0;C<I.length;C++)document.activeElement==I[C]&&(w=C)}else w=I.length-1;this.focusedCellLinkLength=I.length}I=I[w],this.focusedCellLinkIndex=w,I?o&&I.focus():this._getEditDisabled(f,d.id)||this.__getEditReadOnly(t,f)?t.blur():t.focus()}else if("select"!=u||1!=this.options.senseReader||"ul"!=d.options.tableRender||this.isVirtualCursor())a.Z.isIE(8)?"none"!=t.parentElement.style.display&&t.focus():n||t.focus();else{var I;(I=(I=t.getElementsByTagName("a"))[0]).focus()}}var _=!1;try{_=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){_=!1}if(!0===this._isHybridScroll())this._setHybridDataLayerTop();else if(!_&&!e){var x=this.getElementById(this.id+"_dataLayer"),S=this.getElemRowIndex(t),R=this.getLastFocusedCell().focusedRowIndex;if(!0===this._isNativeScroll("both")){for(var D=0;D<this.focusedCell.length;D++)if(0!==this.focusedCell[D].focusedRowIndex){!1;break}0===S&&0===R&&0!=x.scrollTop&&(x.scrollTop=0)}else x.scrollLeft=0,x.scrollTop=0}var T=this.options.focusMode;if(r&&(T="cell"),"row"!=T&&"both"!=T||this.setFocusRowStyle(t),"cell"==T||"both"==T){this.addClass(t,"focusedTd");var L=parseInt(t.getAttribute(h)),k=parseInt(L/this.realRowDataLength),F=k+this.rowIndex;(this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>k||this.options.lastFixedRow>0&&k>this.lastIndex-this.options.lastFixedRow)&&(F=k)
;var A=L%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.options.focusDefaultColumn&&A<0)return;this.applyCellStyleOptions(F,A,null,r)}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setFocusRowStyle=function(t){try{if(null==t)return;for(var e=a.Z.getDataPrefix("trIndex"),i=a.Z.getDataPrefix("tdIndex"),o=a.Z.getDataPrefix("style_bak"),r=t.parentNode,n=parseInt(r.getAttribute(e));n>0;)n--,r=a.Z.prev(r);var l=a.Z.first(r),h=parseInt(l.getAttribute(i));n=parseInt(h/this.realRowDataLength);for(var d=0;d<this.realRowDataLength;d++){var u=d;d>=this.defaultColCnt&&(u=Math.floor((d-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(d-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var p=n*this.realRowDataLength+u,c=this.all_data_td_list[p];if(this.addClass(c,"focusedTr"),d<this.defaultColCnt){var g=c.className;g.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""!=this.options.rowNumBackgroundColor&&!0!==this.options.rowNumRowMouseOverColor||(c.style.backgroundColor=this.options.selectedRowColor.wq_trim(),c.removeAttribute(o)):g.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(c.style.backgroundColor=this.options.selectedRowColor.wq_trim(),c.removeAttribute(o))}else{var f=parseInt(c.getAttribute(i)),m=n+this.rowIndex,y=f%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(m,y)}}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.outFocusedCell=function(){this.removeFocusedCell()},T.prototype.getFocusedCellData=function(){var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex(),i=this.getColumnID(e);return t>-1?this.dataList._getCellData(t,i):null},T.prototype.getFocusedRowData=function(){var t=this._getFocusedRowIndex();return t>-1?this.dataList.getRowData(t):null},T.prototype.getFocusedRowXML=function(){var t=this._getFocusedRowIndex(!0);return t>-1?this.dataList.getRowXML(t):null},T.prototype.removeRowFocus=function(t){for(var e=[],i=0;i<this.focusedCell.length;i++)t!=this.focusedCell[i].focusedRowIndex?e.push(this.focusedCell[i]):this._applyFocusedCellOut(this.focusedCell[i]);this.focusedCell=e},T.prototype.setFocusedHeaderObj=function(t){if(this.getHeaderLayer(t)){var e=this.headerObj[t];if(e)switch(e.headInputType){case"checkcombobox":case"select":case"checkbox":case"input":e.focus()}}},T.prototype.focus=function(t){try{if(this.options.senseReader&&this.options.useStartEndDiv){var e=this.getElementById(this.id+"_gridstart_div"),i=this.getElementById(this.id+"_gridend_div");t&&"object"===(0,l.A)(t)&&(t.shiftKey?i.focus():e.focus())}else{var o=this.getLastFocusedCell(),r=-1!=o.focusedRowIndex?o.focusedRowIndex:0,a=null!=o.focusedColIndex?o.focusedColIndex:0;this._setFocusedCell(r,a,!1)}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setFocusedMultiCell=function(t,e,i,o,r){try{r=r||{};var a=this.options.useShiftKey;this.options.useShiftKey=!0;var n=Number(t),l=Number(e),h=Number(i),d=Number(o);isNaN(n)||isNaN(l)||this._setFocusedCell(n,l,null,{ignoreFocusMode:r.ignoreFocusMode,keepFocusedMultiCell:r.keepFocusedMultiCell}),isNaN(h)||isNaN(d)||this._setFocusedCell(h,d,!1,{shifted:!0,ignoreFocusMode:r.ignoreFocusMode,keepFocusedMultiCell:r.keepFocusedMultiCell}),this.options.useShiftKey=a}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype._setMultiFocus=function(t,e){try{if(!t)return!1;var i={keepFocusedMultiCell:!0};if("single"===e){var o=Number(t.row),r=Number(t.col);if(isNaN(o)||isNaN(r))return!1;this._setFocusedCell(o,r,!1,{ctrled:!0,keepFocusedMultiCell:i.keepFocusedMultiCell})}else if("multi"===e){var a=Number(t.startRow),n=Number(t.startCol),l=Number(t.endRow),h=Number(t.endCol);if(isNaN(a)||isNaN(n)||isNaN(l)||isNaN(h))return!1;this.setFocusedMultiCell(a,n,l,h,i)}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.setMultiFocus=function(t){try{if(!Array.isArray(t))return;for(var e=0;e<t.length;e++){var i=t[e],o="",r=i&&"object"===(0,
l.A)(i)&&"row"in i&&"col"in i,a=i&&"object"===(0,l.A)(i)&&"startRow"in i&&"startCol"in i&&"endRow"in i&&"endCol"in i;if(!0===r)o="single";else{if(!0!==a)return;o="multi"}if(!1===this._setMultiFocus(i,o))return}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype._removeMultiFocus=function(t){try{for(var e={},i=function(t){for(var i=t.endRow-t.startRow+1,o=t.endCol-t.startCol+1,s=i*o,r=0;r<s;r++){var a=Math.floor(r/o)+t.startRow,n=r%o+t.startCol;a=Number(a),n=Number(n),e[a+","+n]=!0}},o=0;o<t.length;o++){var r=t[o],a=r&&"object"===(0,l.A)(r)&&"row"in r&&"col"in r,n=r&&"object"===(0,l.A)(r)&&"startRow"in r&&"startCol"in r&&"endRow"in r&&"endCol"in r;if(!0===a){var h=Number(r.row),d=Number(r.col);if(isNaN(h)||isNaN(d))return!1;e[h+","+d]=!0}else if(!0===n){var u=Number(r.startRow),p=Number(r.startCol),c=Number(r.endRow),g=Number(r.endCol);if(isNaN(u)||isNaN(p)||isNaN(c)||isNaN(g))return!1;i(r)}}return e}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.removeMultiFocus=function(t){try{if(!Array.isArray(t))return;var e=this._removeMultiFocus(t);if(!0!==a.Z.isEmptyObject(e))for(var i=this.focusedCell.length-1;i>=0;i--){var o=this.focusedCell[i];e[o.focusedRowIndex+","+o.focusedColIndex]&&(this._applyFocusedCellOut(o),this.focusedCell.splice(i,1))}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.removeFocusedMultiCell=function(t,e,i,o){try{for(var r="focusedColIndex",a="focusedRowIndex",n=this.focusedCell.length-1;n>=0;n--){var l=this.focusedCell[n];l[a]>=t&&l[a]<=i&&l[r]>=e&&l[r]<=o&&(this._applyFocusedCellOut(l),this.focusedCell.splice(n,1))}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype._applyFocusedMultiCell=function(t,e,i,o,r,a){try{(a=a||{})&&!0===a.keepFocusedMultiCell&&this.focusedCell.length>0?this.removeFocusedMultiCell(t,e,i,o):!0!==this.options.ctrlShiftKey&&(this.applyFocusedCellOut(),this.focusedCell=[]);var n=this.getLocationRowCol(t,e);t=n.rowIndex,e=n.colIndex;var l=t,h=e;"row"===this.options.focusMode&&!0!==r&&(o=this.getColumnCount()-1);var d=this.getLocationRowCol(i,o);i=d.rowIndex,o=d.colIndex;for(var u=i,p=o,c=t>i,g=e>o,f=this.htmlInfo.body.rowAttrArr.length,m=c?i:t,y=c?t:i,b=g?o:e,v=g?e:o,w=!0;w;){w=!1;var C=y,I=0;for(var _ in this.cellMergeInfo)this.cellMergeInfo.hasOwnProperty(_)&&I++;y-m>f&&I<1&&(C=m+f);for(var x=b,S=m;S<=C;S++){var R=this.getOriginalRowCol(S,b);R.colSize>1&&x>(R=this.getLocationRowCol(R.rowIndex,R.colIndex)).colIndex&&(x=R.colIndex,w=!0),b=x}var D=v;for(S=m;S<=C;S++){var T=this.getOriginalRowCol(S,v);T.colSize>1&&D<(T=this.getLocationRowCol(T.rowIndex,T.colIndex)).colIndex+T.colSize-1&&(D=T.colIndex+T.colSize-1,w=!0),v=D}for(var L=m,k=b;k<=v;k++){var F=this.getOriginalRowCol(m,k);F.rowSize>1&&L>(F=this.getLocationRowCol(F.rowIndex,F.colIndex)).rowIndex&&(L=F.rowIndex,w=!0),m=L}var A=y;for(k=b;k<=v;k++){var E=this.getOriginalRowCol(y,k);E.rowSize>1&&A<(E=this.getLocationRowCol(E.rowIndex,E.colIndex)).rowIndex+E.rowSize-1&&(A=E.rowIndex+E.rowSize-1,w=!0),y=A}}i=c?m:y,e=g?v:b,o=g?b:v;for(S=t=c?y:m;c?S>=i:S<=i;c?S--:S++)for(k=e;g?k>=o:k<=o;g?k--:k++){var M=this.getOriginalRowCol(S,k),O=M.colIndex,N=M.rowIndex;if(!M.noLeftTop){var H=this.data_td_list[O+(N-this.rowIndex)*this.oneRowDataLength];if(N<this.rowIndex&&(H=null),!(this.groupbyStatus.grouped&&H&&this.hasClass(H,"w2grid_groupby"))){var G=this.getCellInfo(O),W=this._getRealColIndex("body",G.options.col_id)+this.defaultColCnt;if(!G.options.blockSelect&&!this.hiddenList[W]){var B={focusedTd:H,focusedRowIndex:N,focusedColIndex:O};if(this.options.groupbyDisplayRowIndex&&(B.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(N)),S==l&&k==h?this.focusedCell.unshift(B):this.focusedCell.push(B),null!=H){var V=!0;(G.options.embeddedInput||k==p&&S==u)&&(V=!1),this.applyFocusedCellIn(H,V,{ignoreFocusMode:r,shifted:a.shifted})}
(""==G.options.inputType||"text"==G.options.inputType&&!G.options.embeddedInput||"textImage"==G.options.inputType||"calendar"==G.options.inputType)&&(this.getInput(G).options.editType=G.options.editType?G.options.editType:this.options.editType)}}}}}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype._addFocus=function(t){try{var e=a.Z.getDataPrefix("tdIndex"),i=parseInt(t.getAttribute(e)),o=parseInt(i/this.realRowDataLength)+this.rowIndex,r=o;this.isDrillDown&&this._dataList.options.depthColumn&&(r=this.getRealRowIndex(o));var n,l=i%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),h={focusedTd:t,focusedRealRowIndex:r,focusedRowIndex:n=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>o-this.rowIndex||this.options.lastFixedRow>0&&o-this.rowIndex>this.lastIndex-this.options.lastFixedRow?o-this.rowIndex:o,focusedColIndex:l};this.options.groupbyDisplayRowIndex&&(h.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(n)),this.focusedCell.push(h)}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.focusToStart=function(){try{var t=document.getElementById(this.id+"_head_table").getElementsByTagName("button")[0];if(t)return this.removeFocusedCell(),void t.focus();for(var e=0,i=0,o=!1,r=this.getDataLength(),a=this.getColumnCount();e<r;){for(;i<a;){var n=this.getCellInfo(i);if(!this.___getEditReadOnly(e,i)&&!this._getEditDisabled(e,i)&&"radio"!==n.options.inputType){o=!0;break}i++}if(o)break;e++}this._setFocusedCell(e,i,this.options.keyMoveEditMode,{tabDirection:"left"})}catch(t){s.Y.printStackTrace(t,null,this)}},T.prototype.focusToEnd=function(){try{for(var t=this.getDataLength()-1,e=this.getColumnCount()-1,i=!1;t>=0;){for(;e>=0;){var o=this.getCellInfo(e);if(!this.___getEditReadOnly(t,e)&&!this._getEditDisabled(t,e)&&"radio"!==o.options.inputType){i=!0;break}e--}if(i)break;t--}if(t<0){var r=document.getElementById(this.id+"_head_table").getElementsByTagName("button");r.length>0&&r[r.length-1].focus()}else this._setFocusedCell(t,e,this.options.keyMoveEditMode,{tabDirection:"right"})}catch(t){s.Y.printStackTrace(t,null,this)}};var L=function(t){};L.prototype._subtotalHidden=function(t){try{for(var e=0;e<t.length;e++){if(this.isIE6or7)for(var i=t[e].getElementsByTagName("td"),o=0;o<i.length;o++)i[o].style.borderWidth="0px";"none"!==t[e].style.display&&(this.drawedSubtotal&&this.drawedSubtotal.drawedRowLength--,t[e].style.display="none")}}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalHidden=function(t){try{if(!this.hasSubtotal)return;if(t){if("number"==typeof t.index)for(var e=this.drawedSubtotal.splice(t.index,1),i=0;i<e.length;i++)this._subtotalHidden(e[i]);if("number"==typeof t.rowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex==t.rowIndex){e=this.drawedSubtotal.splice(i,1);for(var o=0;o<e.length;o++)this._subtotalHidden(e[o])}if("number"==typeof t.startRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex>=t.startRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o]);if("number"==typeof t.endRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex<=t.endRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o])}else{for(var r in this.subtotalTableList){var a=this.subtotalRowHash[r];a&&this._subtotalHidden(a)}this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0}}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.refreshSubtotalRow=function(t){try{for(var e=t-this.rowIndex,i=!0===this._isBrowserScroll()?this.getRowCount()-1:this.lastIndex,o=e;o<=i;o++)this.drawSubtotalRow(o+1,o+this.rowIndex);var n=WebSquare.BootLoader.fullViewed||!1,l=a.Z.fullViewed||!1;if(!n&&!l){var h=this.options.adaptive,d=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==h&&!(a.Z.isIE()&&parseInt(r.I.browserVersion(),10)<10)&&a.Z._getBrowserWidth()<=d){
for(o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!0);this.removeAdaptiveGridSubtotalHeight(),this.setAdaptiveGridSubtotalHeight();for(o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}}}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.drawSubtotalRow=function(t,e,i){try{var o=0;if(!this.hasSubtotal||e<0||e>=this.getDataLength())return o;var r=NaN;if(i&&!isNaN(i.maxCount)&&(r=i.maxCount),r<=0)return o;for(var a in this.subtotalTableList){var n=this.dataList._getCellData(e,a),l=n+"_12";if(e<this.getDataLength()-1)l=this.dataList._getCellData(e+1,a);if(n!=l){var h=this.subtotalRowHash[a],d=this.subtotalTableList[a],u=d.rows.length,p=[];p.rowIndex=e,p.targetID=a;for(var c=0;c<u;c++){var g=h?h[t*u+c]:void 0;if(g){if(this.isIE6or7)for(var f=g.getElementsByTagName("td"),m=0;m<f.length;m++)f[m].style.borderWidth="";o>=r?g.style.display="none":(g.style.display="",o++),g.setAttribute("data-subtotalrowindex",e),p.push(g),this.lastSubtotalRow=g}}if(this.drawedSubtotal.push(p),this.drawedSubtotal.drawedRowLength+=o,this.setSubtotalData(d,a,n,e,p,i),o>=r)break}}return o}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.hasUpperSubtotalRow=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return!1;for(var e in this.subtotalTableList){var i=this.dataList._getCellData(t,e),o=i;if(t<this.getDataLength())o=this.dataList._getCellData(t-1,e);if(i!=o)return!0}return!1}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.getHasSubtotalCount=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return 0;var e=0;for(var i in this.subtotalTableList){var o=this.dataList._getCellData(t,i),r=o;t+1<this.getDataLength()?r=this.dataList._getCellData(t+1,i):t+1==this.getDataLength()&&e++,o!=r&&e++}return e}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.setSubtotalData=function(t,e,i,o,r,n){try{var l,h=this.subtotalDataArr[e+"_"+i];if(null==h&&(h=this.getSubtotalData(t,e,i,o)),this.options.subtotalStyleFormatter)try{"function"==typeof this.options.subtotalStyleFormatter?l=this.options.subtotalStyleFormatter:null!=(l=a.Z.getGlobalFunction(this.options.subtotalStyleFormatter,this.scope_id))&&(this.options.subtotalStyleFormatter=l)}catch(t){l=null}for(var d=a.Z.getDataPrefix("inputType"),u=a.Z.getDataPrefix("NaNFormat"),p=a.Z.getDataPrefix("colMerge"),c=a.Z.getDataPrefix("value"),g=a.Z.getDataPrefix("useLocale"),f=a.Z.getDataPrefix("localeRef"),m=0;m<r.length;m++)for(var y=r[m].getElementsByTagName("td"),b=0;b<y.length;b++){var v=y[b],w=v.getAttribute("id"),C=this.subtotalConfigOptions[w]||{};if(null!=h[w]){var I=h[w];if("expression"==v.getAttribute(d)&&isNaN(I)){var _=v.getAttribute(u)||C.NaNFormat;null!=_&&"NaN"!=_&&(I=_)}if(v.innerHTML=this.dataTagOpen+I+this.dataTagClose,"function"==typeof l){var x=h[w+"_org"];null==x&&(x=I);var S=l(x,I,v.id);if(v&&S){var R=v.getAttribute("data-bkclassname");null==R&&(R=v.className,v.setAttribute("data-bkclassname",R)),v.className=v.getAttribute("data-bkclassname")+" "+S}}}else if("true"!=v.getAttribute(p)||this.groupbyStatus.grouped){var D=v.getAttribute(c),T=v.getAttribute(g),L=v.getAttribute(d);if("true"===T||this.options.useLocale&&!T||"false"!==T&&C.useLocale){var k=v.getAttribute(f)||C.localeRef;if(k&&"expression"!==L){var F=this.getLocaleValue(k);F&&(D=F)}}D=null!=D?D:"",v.innerHTML=this.dataTagOpen+D+this.dataTagClose}else v.style.borderTopWidth="0px",v.style.borderBottomWidth="0px"}}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.getSubtotalData=function(t,e,i,o){try{var r=e,n=this.subtotalObj[e];if(null==n){n={}
;for(var l=a.Z.getDataPrefix("inputType"),h=a.Z.getDataPrefix("expression"),d=a.Z.getDataPrefix("colindex"),u=a.Z.getDataPrefix("dataType"),p=a.Z.getDataPrefix("displayFormat"),c=a.Z.getDataPrefix("displayFormatter"),g=0;g<t.rows.length;g++)for(var f=t.rows[g].getElementsByTagName("td"),m=0;m<f.length;m++){var y=f[m],b=this.subtotalConfigOptions[y.id]||{};if("expression"==y.getAttribute(l)){(F={}).id=y.getAttribute("id");var v,w=y.getAttribute(h)||"";if(!w&&b.expression&&(w=b.expression),""!=w){var C="";this.options.groupbyStatus||(w.toLowerCase().indexOf("sumifs")>-1?C="sumifs":w.toLowerCase().indexOf("sumif")>-1&&(C="sumif")),v=C?w.substring(w.indexOf("(")+1,w.indexOf(",")):w.substring(w.indexOf("(")+1,w.indexOf(")")),w=w.replace(/[sS][uU][mM][\s]*[(]/g,"this.subtotalcolsum( obfuscator_st, obfuscator_en ,"),this.options.groupbyStatus||(w=(w=w.replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"this.subtotalcolsumif( obfuscator_st, obfuscator_en ,")).replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"this.subtotalcolsumifs( obfuscator_st, obfuscator_en ,")),w=(w=(w=(w=(w=(w=(w=w.replace(/[aA][vV][gG][\s]*[(]/g,"this.subtotalcolavg( obfuscator_st, obfuscator_en ,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.subtotalcolmax( obfuscator_st, obfuscator_en ,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.subtotalcolmin( obfuscator_st, obfuscator_en ,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"this.subtotalcolcnt( obfuscator_st, obfuscator_en ,")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][vV][aA][lL][uU][eE][\s]*[(]/g,"this.dataList._getCellData( obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][lL][aA][bB][eE][lL][\s]*[(]/g,"this.subtotaltargetcollabel( obfuscator_st, obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][fF][oO][oO][tT][eE][rR][vV][aA][lL][uU][eE][\s]*[(]/g,"this.subtotaltargetfootervalue( obfuscator_st, obfuscator_en,")}var I="text",_=parseInt(y.getAttribute(d))-this.defaultColCnt;if(_>=0&&(I=this._dataList.getCellInfo(_).options.dataType),"true"===this.options.useCurrency?F.dataType=y.getAttribute(u):F.dataType=y.getAttribute(u)||I,!F.dataType&&b.dataType&&(F.dataType=b.dataType),F.expression=w,!F.dataType){var x=this.getCellInfo(v),S=x&&x.options&&x.options.dataType;v&&"true"===this.options.useCurrency?(F.dataType=S,"function"==typeof x.options.customModelUnformatter?F.customModelUnformatter=x.options.customModelUnformatter:F.customModelUnformatter=a.Z.getGlobalFunction(x.options.customModelUnformatter,this.scope_id)):F.dataType=I}F.displayFormat=y.getAttribute(p)||b.displayFormat||"",F.displayFormatter=y.getAttribute(c)||b.displayFormatter||"","true"!==this.options.useCurrency||F.displayFormatter||(F.displayFormat=x.options.displayFormat||y.getAttribute(p)||"",F.displayFormatter=x.options.displayFormatter||""),F.formatter=WebSquare.format.createFormatter(F.dataType,F.displayFormat,F.displayFormatter,null,null,null,this.scope_id,this.id),n[F.id]=F}}this.subtotalObj[e]=n}for(var R=o;R>0&&i==this.dataList._getCellData(R-1,e);)R--;var D=R,T=o,L={};for(var k in n){var F=n[k],A=a.Z.scopingFuncBody(F.expression,this.scope_id);this._subtotalDisplayFormat=F.displayFormat||"";var E=Function("obfuscator_st","obfuscator_en","obfuscator_targetID",A).call(this,D,T,r);F.customModelUnformatter&&(E=F.customModelUnformatter.call(this,E));var M=F.formatter.format(E);L[k]=M,this.options.subtotalStyleFormatter&&E!==M&&(L[k+"_org"]=E)}return this._subtotalDisplayFormat="",L}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.getSubtotalRowList=function(t){try{var e=[];t&&"object"===t.returnType&&(e={});var i=this.getDataLength();for(var o in this.subtotalStrList)for(var r=1;r<i;r++){this.dataList._getCellData(r-1,o)!=this.dataList._getCellData(r,o)&&(t&&"object"===t.returnType?e[r]=!0:e.push(r))}return e}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolsumif=function(t,e,i,o,r){try{var a=[],n=[],l=[];if(o){var h=this._getOperator(o);if(!h.operator||!h.value)return
;return n.push(h.operator),l.push(h.value),a?a.push(r):a.push(i),this._subtotalcolsum(t,e,i,a,n,l)}}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolsumifs=function(t,e,i){try{for(var o=[],r=[],a=[],n=(arguments.length-3)/2,l=0;l<n;l++){var h=this._getOperator(arguments[2*l+3]),d=arguments[2*l+4];h.operator&&h.value&&(r.push(h.operator),a.push(h.value)),o.push(d)}return this._subtotalcolsum(t,e,i,o,r,a)}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolsum=function(t,e,i){try{try{return this._subtotalcolsum(t,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}}catch(t){WebSquare.exception.printStackTrace(t,null,this)}},L.prototype._subtotalcolsum=function(t,e,i,o,r,n){try{var l={};!this.options.groupbyStatus&&o&&(l={conditionColumn:o,targetOperator:r,conditionValue:n,blank:!1});var h,d=this.getColumnSubtotalRangeDataArray(t,e,i,l),u="";if(d.length>0)if(h=this.getColumnOption(i,"dataType"),u=0,"bigDecimal"===h)for(var p=0;p<d.length;p++)u=WebSquare.bigDecimal(u+"").plus(d[p]);else if("time"===h)for(p=0;p<d.length;p++){var c=WebSquare.text.fillZero(u,4);u=WebSquare.date.dateTimeAdd(c,d[p],"hour","time")}else u=a.Z.sum(d,{displayFormat:this._subtotalDisplayFormat});return a.Z.setPrecision(u)}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolavg=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),r="",a=this.getColumnOption(i,"dataType");if(o.length>0)if("bigDecimal"===a){for(var n in r="0",o)r=WebSquare.bigDecimal(r).plus(o[n]);r=r.divide(WebSquare.bigDecimal(o.length))}else r=WebSquare.util.sum(o,{displayFormat:this._subtotalDisplayFormat})/o.length;return r}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolmax=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),r=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===r)for(var l in o)n=null==n?o[l]:n.compare(o[l]);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n<h)&&(n=h)}return n=null==n?"":n,a.Z.setPrecision(n)}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolmin=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),r=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===r)for(var l in o)n=null==n?o[l]:n.compare(o[l],!0);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n>h)&&(n=h)}return n=null==n?"":n,a.Z.setPrecision(n)}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotalcolcnt=function(t,e,i,o){try{o=o||{};return(this.getColumnSubtotalRangeDataArray(t,e,i,o)||[]).length}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.subtotaltargetcollabel=function(t,e,i,o){var r="";try{r=this.dataList._getCellData(e,i);var a=this.getCellInfo(i),n=a.options.inputType;"select"!==n&&"autoComplete"!==n&&"checkcombobox"!==n||(r=a.getData(r,e))}catch(t){s.Y.printStackTrace(t,null,this)}return r},L.prototype.subtotaltargetfootervalue=function(t,e,i,o){var r;try{this.hasFooter&&this.footerTempSum&&this.footerTempSum[i]&&(r=this.footerTempSum[i].sum)}catch(t){s.Y.printStackTrace(t,null,this)}return r},L.prototype.getColumnSubtotalRangeDataArray=function(t,e,i,o){try{for(var r,a=[],n=this.getColumnID(i),h=this.getColumnOption(n,"dataType"),d=this.dataList.getDeletedIndex(),u=this.dataList.getModifiedIndex(),p=t;p<=e;p++){if(this.options.excludeDeletedRows){for(var c=!1,g=0;g<d.length;g++)if(d[g]===p){c=!0;break}if(c)continue}if(this.options.excludeModifiedRows){for(c=!1,g=0;g<u.length;g++)if(u[g]===p){c=!0;break}if(c)continue}if("object"===(0,l.A)(o)&&o.conditionColumn&&o.conditionColumn.length>0){var f=!0;for(g=0;g<o.conditionColumn.length;g++){var m=this.dataList.getCellData(p,o.conditionColumn[g]),y=o.targetOperator[g],b=o.conditionValue[g],v=this.getColumnOption(o.conditionColumn[g],"dataType");if(0==(f=this._isMatched(b,m,y,v)))break}if(0==f)continue}"bigDecimal"===h?r=WebSquare.bigDecimal(this.dataList._getCellData(p,i)):(r=this.dataList._getCellData(p,i),r+=""),
void 0===r||""==r?(r="0","object"===(0,l.A)(o)&&!1!==o.blank&&a.push(r)):a.push(r)}return a}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype._getLastSubtotalCount=function(){try{if(!this.hasSubtotal)return 0;for(var t=0,e=this.getDataLength(),i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength),0),o=0,r=e-1;r>=i;r--){for(var a=0;a<this.struct.subtotalArr.length;a++){var n=this.struct.subtotalArr[a],l=n.attr.targetColumnID,h=this.dataList._getCellData(r,l),d=h+"_12";if(r<e-1)d=this.dataList._getCellData(r+1,l);if(h!=d&&(t+=n.rowArr.length,this.options.initFixedHeightByRowNum>-1)){if(o+t>=this.options.initFixedHeightByRowNum){i=r+1;break}i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength-t),0)}}o++}return t}catch(t){s.Y.printStackTrace(t,null,this)}},L.prototype.setSubtotalVisible=function(t){try{if(0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({subTotalVisible:t});!0!==t||this.hasSubtotal?!1===t&&this.hasSubtotal&&(this.subtotalHidden(),this.lastTopRowIndex=null,this.hasSubtotal=!1,this.setScrollYHeight()):(this.hasSubtotal=!0,this.lastTopRowIndex=null,this._applyRowVisible({subtotalDraw:!0}),this.setScrollYHeight())}catch(t){s.Y.printStackTrace(t,null,this)}};var k=function(t){};k.prototype.initializeFooter=function(){try{if(!this.hasFooter)return;for(var t=a.Z.getDataPrefix("footer_id"),e=a.Z.getDataPrefix("inputType"),i=a.Z.getDataPrefix("value"),o=a.Z.getDataPrefix("useLocale"),r=a.Z.getDataPrefix("localeRef"),n=this.getDomList("foot_tds","td",this.getElementById(this.id+"_foot_table")),l=0;l<n.length;l++){var h=n[l],d=h.getAttribute("id");if(d&&!h.getAttribute(t)){for(var u=d,p="",c=0;c<this.struct.foot.rowArr.length;c++)for(var g=0;g<this.struct.foot.rowArr[c].length;g++)if(this.struct.foot.rowArr[c][g].id==d&&(this.struct.foot.rowArr[c][g].class||this.struct.foot.rowArr[c][g].className)){p=this.struct.foot.rowArr[c][g].class||this.struct.foot.rowArr[c][g].className;break}if(this.setConfigOptions(h,"footer"),"_headerRowNumber"!==d&&"_headerRowStatus"!==d||(d+="_footer"),h.setAttribute(t,d),h.setAttribute("id",this.id+"_"+d),h.setAttribute("class",h.getAttribute("class")+" "+this.id+"_footer__column"+l+" "+p),"expression"!=h.getAttribute(e)){var f=h.getAttribute(i),m=h.getAttribute(o),y=this.footerConfigOptions[u]||{};if("true"===m||this.options.useLocale&&!m||"false"!==m&&y.useLocale){var b=h.getAttribute(r)||y.localeRef;if(b){var v=this.getLocaleValue(b);v&&(f=v)}}f=null!=f?f:"",h.innerHTML=this.dataTagOpen+f+this.dataTagClose}}}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.drawFooter=function(t){try{if(!this.hasFooter||!this.drawFooterStatus)return;null==this.footerDataObj&&this.initFooterDataObj();var e=a.Z.getDataPrefix("footer_id"),i=a.Z.getDataPrefix("colindex"),o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");this.footerTempSum=[];var r=!1;if(this._sumifColumnRelation||this._sumifsColumnRelation){if(this._sumifColumnRelation&&Object.keys(this._sumifColumnRelation).length>0)for(var n in this._sumifColumnRelation)if(this._sumifColumnRelation[n]===t){r=!0;break}if(this._sumifsColumnRelation&&!1===r&&Object.keys(this._sumifsColumnRelation).length>0)for(var n in this._sumifsColumnRelation)for(var l=0;l<this._sumifsColumnRelation[n].length;l++)if(this._sumifsColumnRelation[n][h]===t){r=!0;break}}if(t&&!r){t=this.getColumnID(t);for(var h=0;h<o.length;h++){var d=(y=o[h]).getAttribute(e),u=parseInt(y.getAttribute(i))-this.defaultColCnt;if(d)if("expression"==(b=this.footerDataObj[d]).inputType){var p=b.expression.match(/footercol(sum|avg|max|min|custom)\s*\([^\)]*/g);if(p){for(var g=0;g<p.length;g++)if(p[g].indexOf(t)>=0){var f=a.Z.scopingFuncBody(b.expression,this.scope_id);b.value=Function("_this",f).call(this,this),
isNaN(b.value)?"NaN"!=b.NaNFormat&&(b.value=b.NaNFormat):"number"===b.dataType&&0===Number(b.value)&&(b.value=0);var m=b.value;b.customModelUnformatter&&(m=b.customModelUnformatter.call(this,m)),y.innerHTML=this.dataTagOpen+b.formatter.format(m)+this.dataTagClose}}else if(t==this.getCellInfo(u).id){try{f=a.Z.scopingFuncBody(b.expression,this.scope_id);b.value=Function("_this",f).call(this,this),isNaN(b.value)&&"NaN"!=b.NaNFormat&&(b.value=b.NaNFormat)}catch(t){s.Y.printStackTrace(t,null,this)}m=b.value;b.customModelUnformatter&&(m=b.customModelUnformatter.call(this,m)),y.innerHTML=this.dataTagOpen+b.formatter.format(m)+this.dataTagClose}}}}else for(h=0;h<o.length;h++){var y;if(d=(y=o[h]).getAttribute(e)){var b;if("expression"==(b=this.footerDataObj[d]).inputType)try{f=a.Z.scopingFuncBody(b.expression,this.scope_id);b.value=Function("_this",f).call(this,this),isNaN(b.value)?"NaN"!=b.NaNFormat&&(b.value=b.NaNFormat):"number"===b.dataType&&0===Number(b.value)&&(b.value=0)}catch(t){c.v.printLog("[Warning]:"+t.message)}m=b.value;b.customModelUnformatter&&(m=b.customModelUnformatter.call(this,m)),y.innerHTML=this.dataTagOpen+b.formatter.format(m)+this.dataTagClose}}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.initFooterDataObj=function(t){try{var e=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),i=-1,n=!1;t?(i=this.getColumnIndex(t),n=!0):this.footerDataObj={};for(var l=a.Z.getDataPrefix("footer_id"),h=a.Z.getDataPrefix("colindex"),d=a.Z.getDataPrefix("value"),u=a.Z.getDataPrefix("useLocale"),p=a.Z.getDataPrefix("localeRef"),c=a.Z.getDataPrefix("inputType"),g=a.Z.getDataPrefix("dataType"),f=a.Z.getDataPrefix("displayFormat"),m=a.Z.getDataPrefix("displayFormatter"),y=a.Z.getDataPrefix("NaNFormat"),b=a.Z.getDataPrefix("expression"),v=0;v<e.length;v++){var w=e[v],C=w.getAttribute(l);C||(C="f_"+o.q.safeRandom().toString(),w.setAttribute(l,C));var I=parseInt(w.getAttribute(h))-this.defaultColCnt;if(!(i>=0&&i!==I)){var _=this.footerConfigOptions[C]||{},x={};x.id=C;var S=w.getAttribute(b)||"";!S&&_.expression&&(S=_.expression);var R="";""!=S&&(this.options.groupbyStatus||(S.toLowerCase().indexOf("sumifs")>-1?R="sumifs":S.toLowerCase().indexOf("sumif")>-1&&(R="sumif")),S=S.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( "),this.options.groupbyStatus||(S=(S=S.replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"_this.footercolsumif( ")).replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"_this.footercolsumifs( ")),S=(S=(S=(S=(S=S.replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( ")),x.value=w.getAttribute(d),!x.value&&_.value&&(x.value=_.value);var D,T,L=w.getAttribute(u);if("true"===L||this.options.useLocale&&!L||"false"!==L&&_.useLocale){var k=w.getAttribute(p)||_.localeRef;if(k){var F=this.getLocaleValue(k);F&&(x.value=F)}}if(x.inputType=w.getAttribute(c),x.dataType=w.getAttribute(g),!x.dataType&&_.dataType&&(x.dataType=_.dataType),x.col_id=this.getColumnID(I),!x.dataType)try{if(x.dataType=this.getColumnOption(x.col_id,"dataType"),"true"===this.options.useCurrency){var A=this.getCellInfo(x.col_id);A&&(D=A.options.displayFormat,T=A.options.displayFormatter,A.options.customModelUnformatter&&("function"==typeof A.options.customModelUnformatter?x.customModelUnformatter=A.options.customModelUnformatter:x.customModelUnformatter=a.Z.getGlobalFunction(A.options.customModelUnformatter,this.scope_id)))}else if("expression"===x.inputType)x.col_id=R?new Function("_this","return "+S.substring(S.indexOf("(")+1,S.indexOf(",")))(this):new Function("_this","return "+S.substring(S.indexOf("(")+1,S.indexOf(")")))(this),x.dataType=this._dataList.getCellInfo(x.col_id).options.dataType||"text";else{var E="text",M=I;M>=0&&(E=this._dataList.getCellInfo(M).options.dataType),x.dataType=E}
}catch(t){x.dataType="text"}x.expression=S,x.displayFormat=w.getAttribute(f)||_.displayFormat||"",x.displayFormatter=w.getAttribute(m)||_.displayFormatter||"","true"!==this.options.useCurrency||x.displayFormatter||(x.displayFormat=D||w.getAttribute(f)||"",x.displayFormatter=T||""),x.formatter=this._initFooterFormatter(x.col_id,x.dataType,x.displayFormat,x.displayFormatter,this.scope_id,this.id,n),x.NaNFormat=w.getAttribute(y)||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||_.NaNFormat||"NaN","$blank"==x.NaNFormat&&(x.NaNFormat=""),this.footerDataObj[x.id]=x}}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype._initFooterFormatter=function(t,e,i,o,a,n,l){try{if(t){var h=this.getCellInfo(t),d=e||h.options.dataType,u=i;return"euro"==d?(i||(u=this.options.euroMask||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/euroMask/@value')||""),".",","):"rupee"==d?(i||(u=this.options.rupeeMask||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/rupeeMask/@value')||""),",","."):"tenge"==d?(i||(u=this.options.tengeMask||r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/tengeMask/@value')||"")," ",","):!l||"number"!==d&&"float"!==d&&"bigDecimal"!==d||(i||(u=this.options.numberMask||r.I.getConfiguration('/WebSquare/input/dataType[@valueType="'+d+'"]/numberMask/@value')||""),",","."),WebSquare.format.createFormatter(e,u,o,null,null,null,a,n)}return WebSquare.format.createFormatter(e,i,o,null,null,null,a,n)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolsumif=function(t,e,i){try{var o=[],r=[],a=[];if(e){var n=this._getOperator(e);if(!n.operator||!n.value)return;return r.push(n.operator),a.push(n.value),o?o.push(i):o.push(t),this._sumifColumnRelation||(this._sumifColumnRelation={}),this._sumifColumnRelation[t]=i,this._footercolsum(t,o,r,a)}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolsumifs=function(t){try{var e=[],i=[],o=[],r=(arguments.length-1)/2;this._sumifsColumnRelation||(this._sumifsColumnRelation={}),this._sumifsColumnRelation[t]||(this._sumifsColumnRelation[t]=[]);for(var a=0;a<r;a++){var n=this._getOperator(arguments[2*a+1]),l=arguments[2*a+2];n.operator&&n.value&&(i.push(n.operator),o.push(n.value)),this._sumifsColumnRelation[t].push(l),e.push(l)}return this._footercolsum(t,e,i,o)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolsum=function(t,e,i,o){try{return this._footercolsum(t)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype._footercolsum=function(t,e,i,o){try{this.footerTempSum||(this.footerTempSum=[]);var r=t;if(!this.options.groupbyStatus&&e&&e.length>0&&o&&o.length>0&&(r=t+"_"+o.join()),this.footerTempSum[r]||(this.footerTempSum[r]={}),void 0===this.footerTempSum[r].sum||""===this.footerTempSum[r].sum){var n="",l=5e3;if(this.groupbyStatus.grouped)n=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"SUM('"+t+"')");else{var h={};this.options.groupbyStatus||(h={conditionColumn:e,operator:i,conditionValue:o,blank:!1});var d=this.getColumnAllDataArray(t,h),u=this.getColumnOption(t,"dataType"),p=!1;if("bigDecimal"!==u&&"euro"!==u&&"tenge"!==u&&"rupee"!=u||(p=!0),d.length>0&&p||"true"===this.options.useCurrency){for(var c=WebSquare.bigDecimal("0"),g=0;g<d.length;g++)""==d[g].replace(/^\s+|\s+$/g,"")&&(d[g]="0");for(var f=0;f<d.length;f++)d[f]=WebSquare.bigDecimal(d[f]),c=c.plus(d[f]);n=c.toString()}else if(d.length>0)if(d.length>l){var m,y=Math.ceil(d.length/l),b=0;n=0;for(g=0;g<y;g++){for(var v=d.slice(b,l*(g+1)),w=0;w<v.length;w++)""==v[w].replace(/^\s+|\s+$/g,"")&&(v[w]="0"),v[w]=v[w]-0+"";m=a.Z.sum(v),b=parseInt(b,10)+parseInt(v.length,10),n=parseFloat(n,10)+parseFloat(m,10)}}else n=a.Z.sum(d)}this.footerTempSum[r].sum=n}
return a.Z.setPrecision(this.footerTempSum[r].sum)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolavg=function(t){try{var e=this.getColumnAllDataArray(t);this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={});var i="",o=5e3;if(this.groupbyStatus.grouped)return i=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"AVG('"+t+"')");if(void 0===this.footerTempSum[t].sum||""===this.footerTempSum[t].sum){var r=this.getColumnOption(t,"dataType");if(e.length>0&&("bigDecimal"==r||"true"===this.options.useCurrency)){for(var n=WebSquare.bigDecimal("0"),l=0;l<e.length;l++)""==e[l].replace(/^\s+|\s+$/g,"")&&(e[l]="0");for(var h in e)e[h]=WebSquare.bigDecimal(e[h]),n=n.plus(e[h]);return n.divide(WebSquare.bigDecimal(e.length)).toString()}if(e.length>0)if(e.length>o){var d,u=Math.ceil(e.length/o),p=0;i=0;for(l=0;l<u;l++){for(var c=e.slice(p,o*(l+1)),g=0;g<c.length;g++)""==c[g].replace(/^\s+|\s+$/g,"")&&(c[g]="0");d=a.Z.sum(c),p=parseInt(p,10)+parseInt(c.length,10),i=parseFloat(i,10)+parseFloat(d,10)}}else i=a.Z.sum(e);this.footerTempSum[t].sum=i}return""===this.footerTempSum[t].sum?"":i=this.cellInfoHash[t]&&"bigDecimal"==this.cellInfoHash[t].options.dataType?WebSquare.bigDecimal(this.footerTempSum[t].sum).divide(WebSquare.bigDecimal(e.length)).toString():this.footerTempSum[t].sum/e.length}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolmax=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].max||""===this.footerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MAX('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&("bigDecimal"==o||"true"===this.options.useCurrency)){for(var r,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),r=null==r?i[l]:r.compare(i[l],!1);e=r.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e<h)&&(e=h)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.footerTempSum[t].max=e}}return this.footerTempSum[t].max}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolmin=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].min||""===this.footerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MIN('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&("bigDecimal"==o||"true"===this.options.useCurrency)){for(var r,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),r=null==r?i[l]:r.compare(i[l],!0);e=r.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e>h)&&(e=h)}e=null==e?"":e,e=a.Z.setPrecision(e)}this.footerTempSum[t].min=e}}return this.footerTempSum[t].min}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolcnt=function(t,e){try{e=e||{};return(this.getColumnAllDataArray(t,e)||[]).length}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getColumnAllDataArray=function(t,e){try{var i=[],o=this.getColumnID(t),r=this.dataList.getDeletedIndex(),n=this.dataList.getModifiedIndex();if(null!==o){for(var h=this.isDrillDown&&a.Z.getBoolean(this.options.drilldownFooterExpressionAllData)?this.getTotalRow():this.getDataLength(),d=0;d<h;d++){if(this.options.excludeDeletedRows){for(var u=!1,p=0;p<r.length;p++)if(r[p]===d){u=!0;break}if(u)continue}if(this.options.excludeModifiedRows){for(u=!1,p=0;p<n.length;p++)if(n[p]===d){u=!0;break}if(u)continue}var g
;if(this.isDrillDown&&a.Z.getBoolean(this.options.drilldownFooterExpressionAllData)){if("object"===(0,l.A)(e)&&e.conditionColumn&&e.conditionColumn.length>0){var f=!0;for(p=0;p<e.conditionColumn.length;p++){var m=this._dataList.getCellData(d,e.conditionColumn[p]),y=e.operator[p],b=e.conditionValue[p],v=this.getColumnOption(e.conditionColumn[p],"dataType");if(0==(f=this._isMatched(b,m,y,v)))break}if(0==f)continue}g=this._dataList.getCellData(d,o)}else{if("object"===(0,l.A)(e)&&e.conditionColumn&&e.conditionColumn.length>0){for(f=!0,p=0;p<e.conditionColumn.length;p++){m=this.dataList.getCellData(d,e.conditionColumn[p]),y=e.operator[p],b=e.conditionValue[p],v=this.getColumnOption(e.conditionColumn[p],"dataType");if(0==(f=this._isMatched(b,m,y,v)))break}if(0==f)continue}g=this.dataList._getCellData(d,o)}void 0===(g+="")||""==g?(g="0","object"===(0,l.A)(e)&&!1!==e.blank&&i.push(g)):i.push(g)}return i}c.v.printLog("[Warning] Invalid colIndex("+t+"). ["+this.id+"] getColumnAllDataArray.")}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getFooterData=function(t,e){try{var i=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),o=a.Z.getDataPrefix("footer_id");if("number"==typeof t){t=i[t+this.defaultColCnt].getAttribute(o);var r=(h=this.footerDataObj[t]).value;if("expression"==h.inputType){var n=a.Z.scopingFuncBody(h.expression,this.scope_id);r=Function("_this",n).call(this,this)}return"displayData"!=e?r:h.formatter.format(r)}for(var l=0;l<i.length;l++)if(i[l].getAttribute(o)==t){var h;r=(h=this.footerDataObj[t]).value;if("expression"==h.inputType){n=a.Z.scopingFuncBody(h.expression,this.scope_id);r=Function("_this",n).call(this,this)}return"displayData"!=e?r:h.formatter.format(r)}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.setFooterValue=function(t,e){this.setFooterData(t,e)},k.prototype.setFooterData=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td"),r=a.Z.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(r);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(r)==t){var l=this.footerDataObj[t];"text"==l.inputType&&(l.value=e,i.innerHTML=this.dataTagOpen+l.formatter.format(l.value)+this.dataTagClose)}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.setFooterDisplayFormat=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),r=a.Z.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(r);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(r)==t){var l=this.footerDataObj[t];l.displayFormat=e,l.formatter=WebSquare.format.createFormatter(l.dataType,l.displayFormat,l.displayFormatter,null,null,null,this.scope_id,this.id),"number"==l.dataType&&(i.innerHTML=this.dataTagOpen+l.formatter.format(l.value)+this.dataTagClose)}var h=this.footerXml;if(h)for(var d=WebSquare.xml.getElementsByTagName(h,"w2:row"),u=0;u<d.length;u++){var p=WebSquare.xml.getElementsByTagName(d[u],"w2:column");for(n=0;n<p.length;n++){var c=p[n];if(c.getAttribute("id")==t){c.setAttribute("displayFormat",e);break}}}}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getFooterStyle=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),r=a.Z.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(r);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(r)==t)return WebSquare.style.getStyle(i,e)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.setFooterStyle=function(t,e,i){try{var o,r=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),n=a.Z.getDataPrefix("footer_id");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber_footer";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus_footer";else if("number"==typeof t){t=(o=r[t+this.defaultColCnt]).getAttribute(n)}
for(var l=0;l<r.length;l++)(o=r[l]).getAttribute(n)==t&&WebSquare.style.setStyle(o,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getExcelAllFooterXML=function(t,e){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var i=[];i.push("<array><![CDATA["),i.push('["'),this.footerDataObj||this.initFooterDataObj();for(var o="",n=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0].getChildNodes(),l=0;l<n.length;l++){var h=n[l];if(1==h.nodeType)for(var d=h.getChildNodes(),u=0;u<d.length;u++){var p=d[u];if(1==p.nodeType){var c=!1;if(e)for(var g=0;g<e.length;g++)if(e[g]==u){c=!0;break}var f=p.getAttribute("id"),m=this.footerDataObj[f];if("expression"!=m.inputType)o=m.value;else{var y=a.Z.scopingFuncBody(m.expression,this.scope_id);o=Function("_this",y).call(this,this)}!1===c&&(o=m.formatter.format(o)),i.push(o),i.push('"'+t+'"')}}}return i[i.length-1]='"]',i.push("]]></array>"),i.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getExcelAllFooterXMLDisplay=function(t,e,i){try{if(t||(t=","),void 0===i&&(i=!0),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var o=a.Z.getDataPrefix("footer_id"),n=[];n.push("<array><![CDATA["),n.push('["');var l=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td");if(this.groupbyStatus.grouped){this.footerDataObj||this.initFooterDataObj();var h=0;if(this.options.rowNumVisible){var d=(v=this.footerDataObj[l[h].getAttribute(o)]).value||"";n.push(d),n.push('"'+t+'"'),h++}if(this.options.rowStatusVisible){d=(v=this.footerDataObj[l[h].getAttribute(o)]).value||"";n.push(d),n.push('"'+t+'"')}}this.footerDataObj||this.initFooterDataObj();d="";for(var u=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0].getChildNodes(),p=0;p<u.length;p++){var c=u[p];if(1==c.nodeType)for(var g=c.getChildNodes(),f=0;f<g.length;f++){var m=g[f];if(1==m.nodeType){var y=!1;if(e)for(var b=0;b<e.length;b++)if(e[b]==f){y=!0;break}var v,w=m.getAttribute("id");if("expression"!=(v=this.footerDataObj[w]).inputType)d=v.value;else{var C=a.Z.scopingFuncBody(v.expression,this.scope_id);d=Function("_this",C).call(this,this)}(!0===i&&!1===y||!1===i&&!0===y)&&(d=v.formatter.format(d)),n.push(d),n.push('"'+t+'"')}}}return n[n.length-1]='"]',n.push("]]></array>"),n.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getExcelAllFooterXMLRaw=function(t,e){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";this.footerDataObj||this.initFooterDataObj();for(var i=[],o="",a=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0].getChildNodes(),n=0;n<a.length;n++){var l=a[n];if(1==l.nodeType)for(var h=l.getChildNodes(),d=0;d<h.length;d++){var u=h[d];if(1==u.nodeType){var p=!1;if(e)for(var c=0;c<e.length;c++)if(e[c]==d){p=!0;break}var g=u.getAttribute("id"),f=this.footerDataObj[g];o=f.value,!1===p&&(o=f.formatter.format(o)),i[i.length]=o}}}return i[0]='<array><![CDATA[["'+i[0],i[i.length-1]+='"]]]></array>',i.join('"'+t+'"')}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.getExpressionValue=function(t){try{return this.hasFooter||(this.footerTempSum=[]),t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( "),this.options.groupbyStatus||(t=(t=t.replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"_this.footercolsumifs( ")).replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"_this.footercolsumif( ")),t=(t=(t=(t=(t=t.replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( "),new Function("_this","return "+t)(this)}catch(t){s.Y.printStackTrace(t,null,this)}},k.prototype.footercolcustom=function(t,e){try{var i=a.Z.getGlobalFunction(t,this.scope_id),o=""
;return"function"==typeof i&&(o=i(this.getColumnAllDataArray(e),this.getColumnOption(e,"dataType"))),o}catch(e){c.v.printLog("[Warning] "+t+" is not valid function.["+this.id+"]")}},k.prototype.getFooterHeight=function(){try{var t=0;if(this.hasFooter){var e=document.getElementById(this.id+"_foot_table");e&&(t=e.offsetHeight)}return t}catch(t){return s.Y.printStackTrace(t,null,this),0}};var F=i(4640),A=function(t){};A.prototype.setStartRowNumber=function(t){this.startRowNumber=t;for(var e=0;e<=this.lastIndex;e++)this._drawRowNumData(e,e+this.rowIndex)},A.prototype.setNoResultMessage=function(t){this.options.noResultMessage=t,this.displayNoResultMessage()},A.prototype.setNoResultMessageVisible=function(t){this.options.noResultMessageVisible=t,this.displayNoResultMessage()},A.prototype.checkAll=function(t,e){var i=!1,o=this.getCellInfo(t),s=o.id;if("checkbox"!=o.options.inputType){if("custom"!=o.options.inputType){var r=WebSquare.language.getMessage("Grid_warning1")||"The selected column is not a checkbox.";return void $l(r)}i=!0}var a=o.options.trueValue,n=o.options.falseValue;this.drawFooterStatus=!1;var l,h=!(!this.isDrillDown||!this._dataList.options.depthColumn),d=h?this.getTotalRow():this.getDataLength(),u=!1,p=!1;if(this._linkedDataList){(p=this._linkedDataList.getBroadcast())&&this._linkedDataList.setBroadcast(!1);for(var c=0;c<d;c++){var g=this._linkedDataList.initialRowIndexArr[c],f=h?g:this._dataList.getFilteredRowIndex(g);if(i){if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;a=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==a)l!=a&&this._dataList.setCellData(f,s,a);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{var m=l==a?n:a;this._dataList.setCellData(f,s,m)}}}else{(u=this._dataList.getBroadcast())&&this._dataList.setBroadcast(!1);for(f=0;f<d;f++){if(i){var y;g=this.dataList.getRealRowIndex(f);if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;a=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==a)l!=a&&this._dataList.setCellData(f,s,a);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{m=l==a?n:a;this._dataList.setCellData(f,s,m)}}}p&&this._linkedDataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1}]});var b=!!h;u&&this._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1,skipInitDrilldown:b}]}),this.drawFooterStatus=!0,this.drawFooter(),this.drawHeader()},A.prototype.getColumnType=function(t){return this.getCellInfo(t).options.inputType},A.prototype.getColumnNodeSet=function(t){return this.getCellInfo(t).itemsetObj},A.prototype.getDefaultStyle=function(){return this.options.style},A.prototype.setCellChecked=function(t,e,i){if("boolean"==typeof i){var o=this.getCellInfo(e),s=o.id,r=!1;if(0==o.internal&&"custom"==o.options.inputType){var a=this.dataList.getRealRowIndex(t);o=o.cellManagerHashByRowIndex[a]?o.cellManagerHashByRowIndex[a]:o,r=!0}if("checkbox"==o.options.inputType||"radio"==o.options.inputType){if("radio"==o.options.inputType&&0!=i){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn),l=n?this.getTotalRow():this.getDataLength();if(this._linkedDataList)if(r);else for(var h=0;h<l;h++){a=this._linkedDataList.initialRowIndexArr[h];var d=n?a:this._dataList.getFilteredRowIndex(a);this._dataList.setCellData(d,s,o.options.falseValue)}else if(r);else for(d=0;d<l;d++)this._dataList.setCellData(d,s,o.options.falseValue);this.drawColumnData(e)}i=1==i?o.options.trueValue:o.options.falseValue,this._dataList.setCellData(t,s,i)}else{var u=WebSquare.language.getMessage("Grid_warning3")||"inputType is neither a checkbox nor a radio button.";alert(u)}}else{var p=WebSquare.language.getMessage("Grid_warning2")||"Invalid data format encountered. Expected 'true' or 'false', please re-enter.";alert(p)}},
A.prototype.getGridHTML=function(){c.v.printLog("getGridHTML function not yet available.")},A.prototype.redrawColumn=function(t,e){try{var i=void 0===e||e;this.drawColumnData(t,i)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getDrawCount=function(){return this.getVisibleRowNum()},A.prototype.getVisibleRowNum=function(){return this.rowIndex>=0?this.lastIndex+1:0},A.prototype.getTopRowIndex=function(){return this.rowIndex},A.prototype.setTopRowIndex=function(t,e,i){if(!0!==this._isNativeScroll())if(!0!==this._isHybridScroll()){var o=this.getElementById(this.id+"_scrollY_div");if(t<=0&&(t=0),null!==this.lastTopRowIndex)t>this.lastTopRowIndex&&(t=parseInt(this.lastTopRowIndex+.5,10));else if(o.offsetHeight<o.scrollHeight){if(this.rowIndex<t){var s=this._getVisibleLastIndex(this.lastIndex+1);(t=t+s>this.getDataLength()?this.getDataLength()-s:t)>this.rowIndex+s-1&&(this.adjustDraw_keepTop=!0)}}else t=0;if(this.rowIndex!=t){if(this.delayedDraw({rowIndex:t}))return;this.scrollEvent=!1,this.checkScrollEnd=!e,this.drawData(t),i&&this.setFocusedCell2(t,0,!1),o.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t)}}else this._drawDataHybrid(t);else this.drawData(0)},A.prototype.getBottomRowIndex=function(){return this.rowIndex>=0?this.rowIndex+this.lastIndex:-1},A.prototype.setBottomRowIndex=function(t){this.drawBottomData(t)},A.prototype.getCellPosition=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=this.data_td_list[e+t*this.oneRowDataLength];if(!o){var s=t-this.rowIndex;o=this.data_td_list[e+s*this.oneRowDataLength]}if(o){if("top"==i)return o.offsetTop;if("left"==i)return o.offsetLeft}return null},A.prototype.getCellSize=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=t-this.rowIndex,s=this.data_td_list[e+o*this.oneRowDataLength];return"width"==i?s.clientWidth:"height"==i?s.clientHeight:null},A.prototype.getHeaderPosition=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);if("top"==e){var o=i.offsetTop;return this.options.groupbyZone&&(o+=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),o}return"left"==e?i.offsetLeft:null},A.prototype.getHeaderSize=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);return"width"==e?i.clientWidth:"height"==e?i.clientHeight:null},A.prototype.setSummary=function(t){!0!==a.Z.isHTML5()&&this.getElementById(this.id+"_body_table").setAttribute("summary",t)},A.prototype.setFooterSummary=function(t){this.hasFooter&&this.getElementById(this.id+"_foot_table").setAttribute("summary",t)},A.prototype.setCaption=function(t){var e=this.getElementById(this.id+"_body_table").getElementsByTagName("caption")[0];if(e)e.innerHTML=t;else{(e=document.createElement("caption")).innerHTML=t;var i=this.render.getElementsByTagName("colgroup")[0];i.parentNode.insertBefore(e,i)}var o=e.className;e.className=o&&""!=o?o+" setcaption":"setcaption"},A.prototype.setCaptionAuto=function(t){for(var e=this.getHeaderValueList(),i="",o="",s=0;s<e.length;s++)i.length>0&&(o=","),i=i+o+e[s];t&&(this.options.captionTitle=t),this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+i+WebSquare.language.getMessage("Grid_caption")):this.setCaption(i+WebSquare.language.getMessage("Grid_caption"))},A.prototype.setFooterCaption=function(t){if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table"),i=e.getElementsByTagName("caption")[0];if(i)i.innerHTML=t;else{(i=document.createElement("caption")).innerHTML=t;var o=e.getElementsByTagName("colgroup")[0];o.parentNode.insertBefore(i,o)}}},A.prototype.groupby=function(t){try{this.hideCustomFilterList(),this._clearMergeCellBackground(),this.clearSearchData({clearValue:!0});var e="string"==typeof(t=t||{}).sortIndex?t.sortIndex.split(" "):t.sortIndex,i="string"==typeof t.sortOrder?t.sortOrder.split(" "):t.sortOrder,r=e.length
;if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<r)return void c.v.printLog("groupby max column count has been exceeded.["+this.id+"]");for(var n=0;n<r;n++){var h=parseInt(e[n],10);e[n]=isNaN(h)?this.getColumnIndex(e[n]):h}if(!t.filter&&!this.groupbyStatus.grouped&&this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var d=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()];if(!d.groupbyOptions&&d.customFilterListFilterInfo){t.filter=JSON.parse(d.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.A)(i)&&i.constructor===RegExp?i:"object"===(0,l.A)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}}));var u=e.length-1,p=!1;for(var g in t.filter){var f=!1;for(n=u;n>=0;n--)if(this.tdIdList[e[n]]===g){f=!0;break}f||(e.push(this.bodyIdColIndexMap[g]),i.push(i[i.length-1]),p=!0)}p&&(t.sortIndexArr=e,t.sortOrderArr=i),this.groupbyFilterList||this.createGroupbyFilterList({noDraw:!0}),this.groupbyStatus.filter=t.filter,this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],r=e.length}}this.removeFocusedCell(),this._dataList.clearFilter(!0),this.clearHeaderSort(),this.headerSortStatusArr=[],this.groupbyStatus.groupbyOptions=JSON.stringify(t,(function(t,e){return"function"==typeof e||"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e}));var m={};if(t.filter){var y="",b="";for(var g in t.filter){var v,w=t.filter[g];y=',"'+g+'"'+y,b=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+b,"func"===w.type?(w.noRefresh=!0,w.noRefreshAfter=!0,m[this.bodyToHeaderRelation[w.colIndex]]=!0,this.dataList.setColumnFilter(w)):(w.constructor===/a/.constructor?v=w:t.filterRegExp&&t.filterRegExp[g]&&t.filterRegExp[g].constructor===/a/.constructor?v=t.filterRegExp[g]:"object"===(0,l.A)(w)&&(w=0==w.length?"/^[a-z0-9_-]{3,16}$/":"^"+w.join("$|^")+"$",v=new RegExp(w,"gi")),v&&this.dataList.setColumnFilter({type:"regExp",colIndex:g,key:v,condition:"and",noRefresh:!0,noRefreshAfter:!0}))}if(this.groupbyFilterList){var C='{"column":['+(y=y.slice(1)+"],")+'"filteredRowIndexArr":['+(b=b.slice(1)+"]}");if(this.groupbyFilterList.filterHistory=JSON.parse(C),this.getRowCount()<=0)for(;this.groupbyFilterList.filterHistory.filteredRowIndexArr.length>0&&this.groupbyFilterList.filterHistory.filteredRowIndexArr[0].length<=0;)this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift()}t.noRefreshAfter||this._dataList.broadcast({gridView:["notifyAfterSettedColumnFilter"]})}if(t.sortIndex){var I=o.q.extend({},t);I.noRefresh=!0,I.sortIndex=[];for(n=0;n<e.length;n++)I.sortIndex.push(this.getColumnID(e[n]));if(t.sortFunc)if(I.sortFuncArr=[],"string"==typeof t.sortFunc)(_=a.Z.getGlobalFunction(t.sortFunc,this.scope_id))&&I.sortFuncArr.push(_);else if(t.sortFunc.constructor==Array)for(n=0;n<t.sortFunc.length;n++){var _;(_=a.Z.getGlobalFunction(t.sortFunc[n],this.scope_id))&&I.sortFuncArr.push(_)}this.dataList.multisort(I)}this.groupbyInfo={},this.statusArr=[];var x=this._linkedDataList?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr,S=[],R=[],D=0,T=[],L=[];for(var k in this.groupbyStatus.groupedRowIndexArr=[],this.groupbyStatus.groupbyRowIndexArr=x.slice(),this.groupbyStatus.groupbyDepthDelimiter="||",this.customFilterStatusObj={},m)this.customFilterStatusObj[k]=!0;this.groupbyStatus.grouped=!0,this.groupbyStatus.filter=t.filter||{},this.groupbyStatus.sortIndexArr=e,this.groupbyStatus.sortOrderArr=i,this.groupbyStatus.headerValueObj={},this.groupbyStatus.footerValueObj={},t.keepDisplayOptions||(this.groupbyDisplayOptions={},this.groupbyDisplayOptions.rowNumHeader=t.rowNumHeader||{},this.groupbyDisplayOptions.rowStatusHeader=t.rowStatusHeader||{},
this.groupbyDisplayOptions.groupbyHeader=t.groupbyHeader||[],this.groupbyDisplayOptions.rowNumFooter=t.rowNumFooter||{},this.groupbyDisplayOptions.rowStatusFooter=t.rowStatusFooter||{},this.groupbyDisplayOptions.groupbyFooter=t.groupbyFooter||[],this.groupbyDisplayOptions.closeGroup=t.closeGroup||!1,this.groupbyDisplayOptions.showDisplayData=t.showDisplayData||!1,this.groupbyDisplayOptions.showOnlyLastDepth=t.showOnlyLastDepth||!1,this.groupbyDisplayOptions.hideHeader=t.hideHeader||!1,this.groupbyDisplayOptions.hideFooter=t.hideFooter||!1);for(n=0;n<x.length;n++){T=L,L=[];for(var F=x[n],A=F*this._dataList.cellIdList.length,E=0;E<r;E++){var M=this.tdIdList[e[E]],O=this.cellInfoHash[M];O&&"expression"==O.options.inputType?L[E]=O.getExpressionValue(F):L[E]=this._dataList.dataArr[A+this._dataList.bodyIdColIndexMap[M]]||""}if(n>0){var N=!1,H=[];for(E=0;E<r;E++)if(N||T[E]!==L[E]){var G=T.slice(0,E+1).join(this.groupbyStatus.groupbyDepthDelimiter);N=!0;var W={type:"footer",groupId:G,depth:E,status:"open",index:""};this.groupbyInfo[G]=this.groupbyInfo[G]?this.groupbyInfo[G]:{},this.groupbyInfo[G].footer=W,H.push(W)}for(E=H.length-1;E>=0;E--)H[E].index=S.length,this.groupbyDisplayOptions.hideFooter||(S.push(H[E]),R.push("footer"))}var B=!1;for(E=0;E<r;E++)if(B||0==n||T[E]!==L[E]){G=L.slice(0,E+1).join(this.groupbyStatus.groupbyDepthDelimiter);B=!0;W={type:"header",groupId:G,depth:E,status:"open",index:S.length};this.groupbyInfo[G]={header:W},this.groupbyDisplayOptions.hideHeader||(S.push(W),R.push("header"))}S.push(x[n]),R.push(D++)}if(R.length>0)for(n=r-1;n>=0;n--){W={type:"footer",groupId:G=L.slice(0,n+1).join(this.groupbyStatus.groupbyDepthDelimiter),depth:n,status:"open",index:S.length};this.groupbyInfo[G]=this.groupbyInfo[G]?this.groupbyInfo[G]:{},this.groupbyInfo[G].footer=W,this.groupbyDisplayOptions.hideFooter||(S.push(W),R.push("footer"))}if(this.groupbyStatus.groupedRowIndexArr=S,this.rowNumArr=R,this.options.foldAll)for(var G in this.groupbyInfo){"open"==(q=this.groupbyInfo[G].header).status&&0==q.depth&&this._foldRow(q)}else if(this.groupbyDisplayOptions.closeGroup&&R.length>0)for(var V in this.groupbyInfo){var q;r==(q=this.groupbyInfo[V].header).groupId.split(this.groupbyStatus.groupbyDepthDelimiter).length&&"number"!=typeof q&&this.groupbyStatus.groupedRowIndexArr[q.index]==q&&this._foldRow(q)}this.lastTopRowIndex=null,this.rowIndex=0,this.setScrollYHeight(),t.sortIndex?(this._dataList.broadcast({gridView:["notifyMultisort"]}),this._dataList.broadcast({gridView:["notifySettedFilter",[{isSort:!0,keepTop:t.keepTop}]],generalComp:"both"})):this.notifyDataChanged(),this.options.groupbyZoneMessage&&this.hideGroupbyZoneMessage(),this.options.groupbyZone&&this.syncWithGroupbyZone();var Y=e.length;if(this.groupbyStatus.beforeSortIndexLength=Y,a.Z.isIE("8")&&this.drawData(0,null,"async"),this.groupbyStatus.grouped&&!this.options.groupbyFilterIcon){var Z=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(n=0;n<Z.length;n++){var j=Z[n],P=j.getAttribute("id");if(this._checkUseFilter(j)){var z=this.getElementById(P+"_filter");z&&(z.style.display="none")}}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.clearGroupby=function(){try{this.clearGrouping=!0,this.groupbyStatus={},this.groupbyZoneStatus.beforeOpenedColIndex=null,this.groupbyZoneStatus.beforeOpenedColTagName=null,this.groupbyZoneStatus.clickedHeaderInfo=null,this.groupbyDisplayOptions=null,this.rowIndex=0,this.removeFocusedCell(),this.dataList.clearFilter(),this.clearHeaderSort(),this.clearGroupbyZone(),a.Z.isIE("8"),this.options.groupbyZoneMessage&&this.showGroupbyZoneMessage(),this.groupbyFilterList&&this.hideGroupbyFilterList();var t=this.getDataLength();if(t<this.rowIndex+this.drawedRowLength)for(var e=t-this.rowIndex;e<this.drawedRowLength;e++)this.clearGroupedRow(e,e+this.rowIndex);this.clearGrouping=!1;var i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(e=0;e<i.length;e++){
var o=i[e],r=o.getAttribute("id");if(this._checkUseFilter(o)){var n=document.getElementById(r+"_filter");n&&(n.style.display="")}}if(this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var l=this.groupbyFilterBox_select.getSelectedIndex();this.groupbyFilterBox_history[l].groupbyOptions&&(this.notifyBeforeSettedColumnFilter(),this.refreshCustomFilterHistory(l),this.notifyAfterSettedColumnFilter())}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.toggleGroup=function(t){if(this.groupbyInfo[t]){var e=this.groupbyInfo[t].header;"number"!=typeof e&&this.dataList.getRealRowIndex(e.index)==e&&("open"==e.status?this._foldRow(e):this._unfoldRow(e),this.lastTopRowIndex=null,this.setScrollYHeight(),"open"==e.status?this.notifyRowInserted(e.index):this.notifyRowChanged(e.index),this.removeFocusedCell(),this.drawFooter())}},A.prototype._foldRow=function(t){if("open"==t.status){if(t.status="closed",this.groupbyDisplayOptions.hideFooter){for(var e,i=t.index+1;i<this.rowNumArr.length&&!("header"==this.rowNumArr[i]&&this.groupbyStatus.groupedRowIndexArr[i].depth<=t.depth);i++)e=i;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,e-t.index)}else{var o=this.groupbyInfo[t.groupId].footer;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,o.index-t.index-1)}var s=[],r=t.closedChildArr.slice(0).sort();for(i=0;i<this.groupbyStatus.groupbyRowIndexArr.length;i++){for(var a=!1,n=0,l=r.length-1,h=0,d=this.groupbyStatus.groupbyRowIndexArr[i];n<=l;){if(d==r[h=Math.floor((n+l)/2)]){a=!0;break}d<r[h]?l=h-1:n=h+1}a||s.push(this.groupbyStatus.groupbyRowIndexArr[i])}this.groupbyStatus.groupbyRowIndexArr=s;var u=this.groupbyStatus.groupedRowIndexArr.length,p=0;this.rowNumArr=[];for(i=0;i<u;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?this.rowNumArr.push(p++):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},A.prototype._unfoldRow=function(t){if("closed"==t.status){t.status="open",t.closedChildArr.unshift(t.index+1,0),[].splice.apply(this.groupbyStatus.groupedRowIndexArr,t.closedChildArr),t.closedChildArr=[];var e=0;this.rowNumArr=[],this.groupbyStatus.groupbyRowIndexArr=[];for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?(this.rowNumArr.push(e++),this.groupbyStatus.groupbyRowIndexArr.push(this.groupbyStatus.groupedRowIndexArr[i])):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},A.prototype.foldAll=function(){for(var t in this.groupbyInfo){var e=this.groupbyInfo[t].header;"open"==e.status&&0==e.depth&&this._foldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},A.prototype.unfoldAll=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++){var e=this.groupbyStatus.groupedRowIndexArr[t];"number"!=typeof e&&"header"==e.type&&"closed"==e.status&&this._unfoldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},A.prototype.drawGroupData=function(t,e,i){var o,s,r,a=t,n=i*this.realRowDataLength,h=this.realRowDataLength;if("header"==e.type)o=this.groupbyDisplayOptions.rowNumHeader,s=this.groupbyDisplayOptions.rowStatusHeader,r=this.groupbyDisplayOptions.groupbyHeader;else{if("footer"!=e.type)return void(t.innerHTML="");o=this.groupbyDisplayOptions.rowNumFooter,s=this.groupbyDisplayOptions.rowStatusFooter,
r=this.groupbyDisplayOptions.groupbyFooter}this.options.rowNumVisible&&(this._drawGroupData(a,e,o),o.hidden||(h-=o.colSpan||1),n++,a=this.all_data_td_list[n]),this.options.rowStatusVisible&&(this._drawGroupData(a,e,s),s.hidden||(h-=s.colSpan||1),n++,a=this.all_data_td_list[n]);for(var d={},u=0;u<h;u++)if(!d["domIndex_"+n]){n++;var p={};if(r instanceof Array?p=r[u]||{}:r instanceof Object&&"object"==(0,l.A)(r)&&(p=r["depth_"+e.depth][u]||{}),Number(p.targetIndex)>-1){var c=i*this.realRowDataLength+p.targetIndex;d["domIndex_"+c]=!0,this._drawGroupData(this.all_data_td_list[c],e,p)}else this._drawGroupData(a,e,p);a=this.all_data_td_list[n]}},A.prototype._drawGroupData=function(t,e,i){try{var o=i.className||"",r="gridBodyDefault w2grid_groupby w2grid_groupby_depth_"+e.depth+" "+o;t.className=r,t.innerHTML="";var n,l=i.colSpan,h=i.value||"",d=i.inputType||"",u=i.depthVisible||!1,p=i.align||"",c=i.expression||"",g=(l=i.colSpan||1,i.hidden?"none":""),f=i.displayFormatType||"text",m=i.displayFormat||"",y=i.displayFormatter||null;if(t.setAttribute("colSpan",l),t.style.align="",t.style.textAlign="",t.style.display=g,t.style.borderTopWidth="1px",t.style.borderBottomWidth="1px",d){var b=a.Z.getDataPrefix("col_id");switch((m||y)&&(n=new WebSquare.format.createFormatter(f,m,y,null,null,null,this.scope_id,this.id)),d){case"toggleButton":var v="<span class='"+("open"==e.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block;"+(p?"float:"+p+";":"")+" margin-left:"+20*e.depth+"px;'></span>";t.innerHTML+=v;break;case"expression":if(c){var w=this.groupbyInfo[e.groupId].header;w.colID=t.getAttribute(b);var C=0;if("open"==w.status){for(var I,_=!0,x=0,S=w.index;S<this.groupbyStatus.groupedRowIndexArr.length;S++){var R=this.groupbyStatus.groupedRowIndexArr[S];if(this.groupbyDisplayOptions.hideFooter&&_){_=!1;for(var D=S+1;D<this.groupbyStatus.groupedRowIndexArr.length;D++){var T=this.groupbyStatus.groupedRowIndexArr[D];if("header"==T.type&&R.depth>=T.depth)break;x=D}}if(this.groupbyDisplayOptions.hideFooter){if(S>=x){I=S;break}}else if("footer"==R.type&&R.depth==w.depth){I=R.index;break}}C=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,w.index,I,c,w)}else C=this.groupExpression(w.closedChildArr,0,w.closedChildArr.length-1,c,w);n&&(C=n.format(C));var L="<span style='display:inline-block;"+(p?"float:"+p+";":"")+"''>"+C+"</span>";t.innerHTML+=L}}}if(u){var k="";"toggleButton"!=d&&(k="margin-left: "+20*e.depth+"px"),t.innerHTML+="<span style='display:inline-block;"+(p?"float:"+p+";":"")+" "+(k||"")+"'>"+e.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - ")+"</span>"}h&&(n&&(h=n.format(h)),t.innerHTML+="<span style='display:inline-block;"+(p?"float:"+p+";":"")+"'>"+h+"</span>")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.groupExpression=function(t,e,i,o,r){try{var a=o;return a=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(/[sS][uU][mM][\s]*[(]/g,"_this.groupbySum(arr, startIndex, endIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.groupbyAvg(arr, startIndex, endIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.groupbyMax(arr, startIndex, endIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.groupbyMin(arr, startIndex, endIndex,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.groupbyCount(arr, startIndex, endIndex,")).replace(/[dD][eE][pP][tT][hH][\s]*[(]/g,"_this.groupbyDepth(header")).replace(/[tT][oO][gG][gG][lL][eE][\s]*[(]/g,"_this.groupbyToggle(header")).replace(/[dD][eE][pP][tT][hH][sS][tT][rR][\s]*[(]/g,"_this.groupbyDepthStr(header")).replace("endIndex,)","endIndex)"),a=new Function("_this","arr","startIndex","endIndex","expression","header","return "+a)(this,t,e,i,o,r)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.groupbySum=function(t,e,i,o){
for(var s=this.getColumnIndex(o),r=0,a=e;a<=i;a++)"number"==typeof t[a]?r+=parseFloat(this.dataList._getCellData(t[a],this.getColumnID(s),3))||0:"header"==t[a].type&&"closed"==t[a].status&&(r+=this.groupbySum(t[a].closedChildArr,0,t[a].closedChildArr.length-1,o));return r},A.prototype.groupbyAvg=function(t,e,i,o){var s=this._groupbyAvg(t,e,i,o);return s.sum/s.number},A.prototype._groupbyAvg=function(t,e,i,o){for(var s=this.getColumnIndex(o),r={sum:0,number:0},a=e;a<=i;a++)if("number"==typeof t[a])r.sum+=parseFloat(this.dataList._getCellData(t[a],this.getColumnID(s),3))||0,r.number++;else if("header"==t[a].type&&"closed"==t[a].status){var n=this._groupbyAvg(t[a].closedChildArr,0,t[a].closedChildArr.length-1,o);r.sum+=n.sum,r.number+=n.number}return r},A.prototype.groupbyMax=function(t,e,i,o){for(var s=this.getColumnIndex(o),r=0,a=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?r=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(s),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(r=this.groupbyMax(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(a=n=r),n&&a<r&&(a=r);return a},A.prototype.groupbyMin=function(t,e,i,o){for(var s,r=this.getColumnIndex(o),a=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?a=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(r),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(a=this.groupbyMin(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(s=n=a),n&&s>a&&(s=a);return s},A.prototype.groupbyToggle=function(t){return"<span class='"+("open"==t.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block; margin-left:"+20*t.depth+"px;'></span>"},A.prototype.groupbyDepth=function(t){return t.depth},A.prototype.groupbyDepthStr=function(t){try{for(var e=t.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - "),i=!1,o=e.split(" - "),r=0;r<this.groupbyStatus.sortIndexArr.length;r++){if("true"==(g=this.getCellInfo(this.groupbyStatus.sortIndexArr[r])).options.groupbyDepthStrLabel)try{i=!0;var n=o[r];if(g.dataComp){var l=a.Z.getComponentById(g.dataComp,g.scope_id);if(l){var h,d;g.itemsetObj&&(h=g.itemsetObj.label||"label",d=g.itemsetObj.value||"value"),g.element&&(h=g.element.getValue("w2:label","ref"),d=g.element.getValue("w2:value","ref"));for(var u=l.getAllJSON(),p=0;p<u.length;p++){var c=u[p];if(n==c[d]){o[r]=!0!==this.groupbyDisplayOptions.showDisplayData?c[h]:g.getDisplayData(c[h]);break}}}}else for(p=0;p<g.itemArr.length;p++)if(n==g.itemArr[p].value){o[r]=!0!==this.groupbyDisplayOptions.showDisplayData?g.itemArr[p].label:g.getDisplayData(g.itemArr[p].label);break}}catch(t){break}}if(i&&(e=o.join(" - ")),1==this.groupbyDisplayOptions.showDisplayData&&!i){for(r=0;r<o.length;r++){var g=this.getCellInfo(this.groupbyStatus.sortIndexArr[r]);o[r]=g.getDisplayData(o[r])}e=o.join(" - ")}if(1==this.groupbyDisplayOptions.showOnlyLastDepth){var f=e.split(" - ");e=f[f.length-1]}return e}catch(t){s.Y.printStackTrace(t)}},A.prototype.groupbyCount=function(t,e,i){for(var o=0,s=e;s<=i&&s<t.length;s++)"number"==typeof t[s]?o++:"header"==t[s].type&&"closed"==t[s].status&&(o+=this.groupbyCount(t[s].closedChildArr,0,t[s].closedChildArr.length-1));return o},A.prototype._drawGroupbyZone=function(){try{var t=this.uuid;if(this.options.groupbyZone){this.groupbyZoneStatus.groupbyZoneRender=this.dom[this.id+"_groupbyZone_div"];var e=null!=this.options.groupbyZoneHeight.match("%"),i=parseInt(this.options.groupbyZoneHeight),o=i+"px";this.groupbyZoneStatus.groupbyZoneRender.style.height=o,e&&(this.groupbyZoneStatus.groupbyZoneRender.style.height=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px");var r=this.getElementById(this.id+"_main_div"),n=WebSquare.style.getStyle(this.groupbyZoneStatus.groupbyZoneRender,"border-left-width").replace("px","");if(this.groupbyZoneStatus.groupbyZoneBorder=2*n,this.groupbyZoneStatus.groupbyZoneRender.style.width=r.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder+"px",
this.dom[this.id+"_main_div"]&&(this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px"),this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.Y.printStackTrace(t,null,this)}if(this.dom[this.id+"_scrollY_div"].style.top="0px",this.options.groupbyZoneMessage){var l=document.createElement("div");l.innerHTML+=this.options.groupbyZoneMessage,l.className+=" w2grid_groupbyZone_message ",this.groupbyZoneStatus.groupbyZoneRender.appendChild(l),l.style.marginTop=-l.offsetHeight/2+"px",l.style.marginLeft=-l.offsetWidth/2+"px",this.groupbyZoneStatus.groupbyZoneMessageRender=l}if(this.options.groupbyZoneSearch){var h=document.getElementById(this.id+"_groupbyZone_search");this.groupbyZone_searchinput=new WebSquare.uiplugin.input(this.id+"_groupbyZone_searchinput",{className:"w2grid_groupbyZone_searchinput"}),requires("uiplugin.trigger"),this.groupbyZone_searchbtn=new WebSquare.uiplugin.trigger(this.id+"_groupbyZone_searchbtn",{className:"w2grid_groupbyZone_searchbtn"}),this.addControl(this.groupbyZone_searchinput),this.addControl(this.groupbyZone_searchbtn),h.innerHTML=this.groupbyZone_searchinput.toHTML()+this.groupbyZone_searchbtn.toHTML(),this.groupbyZone_searchbtn.activate(),this.groupbyZone_searchinput.activate();var d=this.groupbyZone_searchinput.uuid;this.groupbyZone_searchbtn.bind("onclick",(function(){WebSquare.idCache[d].show()}));var u=this.id;this.groupbyZone_searchinput.bind("onkeydown",(function(e){p.f.stopPropagation(e),a.Z.setTimeout((function(){var e=WebSquare.idCache[t];e._groupbyZoneSearch(),e.groupbyZone_searchinput.focus()}),{key:u+"_groupbyZone_search",delay:50})})),this.groupbyZone_searchinput.hide()}}if(this.options.groupbyZone&&this.options.groupbyFilterBox){this.groupbyZoneStatus.groupbyFilterBoxRender=this.dom[this.id+"_groupbyFilterBox_div"];var c=this.getElementById(this.id+"_groupbyFilterBox_select");this.groupbyFilterBox_select=new WebSquare.uiplugin.selectbox(this.id+"_groupbyFilterBox_select",{className:"w2grid_groupbyFilterBox_select",labelWidthAuto:!1,readOnly:!0,direction:"top"===this.options.groupbyFilterBoxLocation?"down":"up",visibleRowNum:this.options.filterBoxvisibleRowNum}),this.addControl(this.groupbyFilterBox_select),c.innerHTML=this.groupbyFilterBox_select.toHTML(),this.groupbyFilterBox_select.activate(),this.groupbyFilterBox_select.bind("onclick",(function(t){this.handleClickEvent()})),this.groupbyFilterBox_select.bind("onchange",(function(){WebSquare.idCache[t].applyFilterHistory()}));var g=this.getElementById(this.id+"_groupbyFilterBox_div");"bottom"===this.options.groupbyFilterBoxLocation?this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+g.offsetHeight+"px":"top"===this.options.groupbyFilterBoxLocation&&(this.dom[this.id+"_main_div"].style.top=i+g.offsetHeight+"px",this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+"px",this.groupbyZoneStatus.groupbyZoneRender.style.top=g.offsetHeight+"px");var f=this.getElementById(this.id+"_groupbyFilterBox_main"),m=this.getElementById(this.id+"_groupbyFilterBox_buttons");f.style.paddingLeft=m.offsetWidth+"px";var y=this.getElementById(this.id+"_groupbyFilterBox_apply"),b=this.getElementById(this.id+"_groupbyFilterBox_delete");y.onclick=function(){var e=WebSquare.idCache[t];this.checked?e.applyFilterHistory():e.groupbyStatus.grouped?e.clearGroupby():e._dataList.clearFilter()},b.onclick=function(){WebSquare.idCache[t].clearFilterHistory()},this.handlerResize_drawInitializer()}}catch(t){s.Y.printStackTrace(t)}},A.prototype.getCellInputType=function(t,e){try{var i=this.getCellInfo(e);if("custom"==i.options.inputType){var o=this.getRealRowIndex(t);return i.cellManagerHashByRowIndex[o].options.inputType}return i.options.inputType}catch(t){s.Y.printStackTrace(t)}},A.prototype.setCellOption=function(t,e,i,o){var s=this.getColumnIndex(e),r=this.getExtraDataObj("cell",t,s)
;if("viewType"===i)r.key=o,this.rowIndex>=0&&this.drawCellData(t-this.rowIndex,t,s);else{var a=WebSquare.language.getMessage("Grid_warning4",this.id,i)||"["+this.id+"] Changing setting "+i+" is not currently supported.";$l(a)}},A.prototype.getCellOption=function(t,e,i){var o=this.getColumnIndex(e),s=this.getCellInfo(e);if("custom"!=s.options.inputType){var r=this.getExtraDataObj("cell",t,o);return null==r.key?s.options[i]:r.key}var a=s.cellManagerHashByRowIndex[t];if(a)return a.options[i]},A.prototype.getCustomCellOptions=function(t,e){try{var i=this.getCellInfo(e),o={};if("custom"==i.options.inputType){var r=this.getRealRowIndex(t),a=i.cellManagerHashByRowIndex[r];for(var n in a.initializeInfo)"id"!=n&&"displayRowIndex"!=n&&"realRowIndex"!=n&&(o[n]=a.initializeInfo[n])}return o}catch(t){s.Y.printStackTrace(t)}},A.prototype.ungroupColumn=function(t){try{if(this.groupbyStatus.grouped){var e;"string"==typeof t?e=this.getColumnIndex(t):"number"==typeof t&&(e=t);for(var i=!0,o=this.groupbyStatus.sortIndexArr.length-1;o>=0;o--)if(this.groupbyStatus.sortIndexArr[o]==e){this.groupbyStatus.sortIndexArr.splice(o,1),this.groupbyStatus.sortOrderArr.splice(o,1),delete this.groupbyStatus.filter[this.getColumnID(e)],i=!1;break}if(i)return;if(this.groupbyFilterList&&this.groupbyFilterList.filterHistory.column.length>0)if(this.groupbyFilterList.filterHistory.column[0]===this.getColumnID(e))this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift();else{var r=this.groupbyFilterList.filterHistory.column.length,a=this.groupbyFilterList.filterHistory.filteredRowIndexArr[r-1].slice(0),n=0;for(o=0;o<r;o++)if(this.groupbyFilterList.filterHistory.column[o]===this.getColumnID(e)){this.groupbyFilterList.filterHistory.column.splice(o,1),this.groupbyFilterList.filterHistory.filteredRowIndexArr.splice(o,1),n=1;break}for(o=0;o<r-n;o++)this.groupbyFilterList.filterHistory.filteredRowIndexArr[o]=a}if(this.clearSearchData({clearValue:!0}),0==this.groupbyStatus.sortIndexArr.length)this.clearGroupby();else{var l=this.groupbyDisplayOptions;l.filter=this.groupbyStatus.filter,l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(l)}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.changeGroupDepth=function(t,e){try{if(this.groupbyStatus.grouped){var i,o,r,a;"string"==typeof t?i=this.getColumnIndex(t):"number"==typeof t&&(i=t),"string"==typeof e?o=this.getColumnIndex(e):"number"==typeof e&&(o=e);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)this.groupbyStatus.sortIndexArr[n]==i&&(a=n),this.groupbyStatus.sortIndexArr[n]==o&&(r=n);if("number"!=typeof a||"number"!=typeof r||a==r)return;this.groupbyStatus.sortIndexArr.splice(a,1),this.groupbyStatus.sortIndexArr.splice(r,0,i);var l=this.groupbyStatus.sortOrderArr.splice(a,1);this.groupbyStatus.sortOrderArr.splice(r,0,l);var h=this.groupbyDisplayOptions;h.filter=this.groupbyStatus.filter,h.sortIndex=this.groupbyStatus.sortIndexArr,h.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(h)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.removeGroupbyFilterList=function(){try{this.groupbyFilterList&&this.groupbyFilterList.remove()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getGroupbyDisplayRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyDisplayRowIndex(t,e):t}catch(e){return s.Y.printStackTrace(e,null,this),t}},A.prototype.__getGroupbyDisplayRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;var i=this._dataList.getFilteredRowIndex(this.getRealRowIndex(t));return null==i&&!0!==e&&(i=t),i}catch(e){return s.Y.printStackTrace(e,null,this),t}},A.prototype._getGroupbyGroupedRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyGroupedRowIndex(t,e):t}catch(e){return s.Y.printStackTrace(e,null,this),t}},
A.prototype.__getGroupbyGroupedRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;for(var i,o=this._dataList.getRealRowIndex(t),r=0;r<this.groupbyStatus.groupedRowIndexArr.length;r++)if(o===this.groupbyStatus.groupedRowIndexArr[r]){i=r;break}return null==i&&!0!==e&&(i=t),i}catch(e){return s.Y.printStackTrace(e,null,this),t}},A.prototype.isEditing=function(){try{return!!this.editedCell}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.readExcelFile=function(t,e,i,o,s,r,a,n){this.readFile(t,e,i,o,s,"excel",null,r,a,n)},A.prototype.readFile=function(t,e,i,o,s,r,a,n,l,h){o=void 0===o||"string"!=typeof o?this.options.excelUploadPopupURL:this.getURL(o),void 0!==s&&"string"==typeof s||(s="top=280,height=80,left=160,width=400,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no"),o+=1==(t=parseInt(t,10))?"?header=true":"?header=false",o+=1==(e=parseInt(e,10))?"&append=true":"&append=false",o+=1==n?"&fillHidden=true":"&fillHidden=false",o+=1==(i=parseInt(i,10))?"&hidden=true":"&hidden=false",o+=1==(h=h||0)?"&type=true":"&type=false",a&&(o+="&"+a),o+="&action="+this.options.excelUploadURL,o+="&gridID="+this.id;for(var d=[],u=this.defaultColCnt;u<this.hiddenList.length;u++)1==this.hiddenList[u]&&d.push(u-this.defaultColCnt);o+="&columnNum="+this.getTotalCol(),o+="&expressionColumns="+this.getExpressionColumnArr().join(","),o+="&hiddenColumns="+d.join(","),o+="&headerRows="+this.getElementById(this.id+"_head_table").rows.length,o+=l?"&gridStartRow="+l:"&gridStartRow=1",WebSquare.domain&&(o+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain)),window.open(o,"fileupWindow",s)},A.prototype.getExpressionColumnArr=function(t){var e,i=[];e=t&&"1"==t.ignoreSpan?this.getColCnt():this.getTotalCol();for(var o=0;o<e;o++)"expression"==this.getCellInfo(o).options.inputType?i.push("true"):i.push("false");return i},A.prototype.saveExcelFile=function(t,e,i,o,s,r,a,n){var l={};l.fileName=t,l.hidden=e,l.checkButton=i,l.type=o,l.hiddenExpand=s,l.saveList=r,l.useEuroLocale=a,l.httpReadOnly=n,this.saveExcel(l)},A.prototype.saveExcel=function(t){var e=t.processMsg;e&&e.length>0?WebSquare.layer.showProcessMessage(e,{scope:this.scope_id||""}):WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""});for(var i=t.fileName||"default",o=t.hidden||0,s=t.checkButton||0,a=t.type+""||"0",n=t.hiddenExpand||0,l=t.saveList||[],h=t.useEuroLocale||"false",d=t.password||"",u=new F.r.Hashtable,p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],c=WebSquare.Elem.api.getElementsByTagName(p,"w2:column"),g=0;g<c.length;g++){var f=c[g],m=f.getAttribute("id");f.setAttribute("value",this.getHeaderValue(m))}if(u.put("style",WebSquare.xml.serialize(this.element._element)),"0"==a||""==a)u.put("data",this.getExcelAllXML()),u.put("footer_data",this.getExcelAllFooterXML());else if("2"==a){var y=this.getExcelAllXMLRaw();u.put("data",y),u.put("footer_data",this.getExcelAllFooterXMLRaw())}else{y=this.getExcelAllXMLDisplay(a);u.put("data",y),u.put("footer_data",this.getExcelAllFooterXMLDisplay())}var b=[];for(g=0;g<this.getTotalCol();g++){var v=this.getCellInfo(g).options.inputType;"checkbox"!=v&&"radio"!=v&&"button"!=v||b.push('"'+g+'"')}u.put("hiddenArr",this.getHiddenColumnArr()),u.put("fileName",i),u.put("hidden",o),u.put("checkButton",s),u.put("type",a),u.put("rowNumVisible",this.options.rowNumVisible+"");var w=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var C=this.getLocaleValue(this.options.rowNumLocaleRef);C&&(w=C)}u.put("rowNumHeaderValue",w),u.put("hiddenExpand",n),u.put("checkButtonArr","<array><![CDATA[["+b.join(",")+"]]]></array>"),u.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),u.put("useEuroLocale",h),u.put("password",d),t.scopeId=this.scope_id||"",r.I.excelDownload(this.options.excelDownloadURL,u.toString(),"post",t)},A.prototype.saveExcelFile2=function(t,e,i,o,s,r){var a={};if(a.fileName=t,a.type=o,e+""=="0"){
for(var n=[],l=this.defaultColCnt;l<this.hiddenList.length;l++)this.hiddenList[l]&&n.push(l-this.defaultColCnt);a.removeColumns=n.join(",")}var h=[];if(i+""=="0")for(l=0;l<this.getTotalCol();l++){var d=this.getCellInfo(l).options.inputType;"checkbox"!=d&&"radio"!=d&&"button"!=d||h.push(this.getCellInfo(l).options.colIndex-this.defaultColCnt)}for(l=this.defaultColCnt;l<this.hiddenList.length;l++)e+""=="1"&&s+""=="0"&&1==this.hiddenList[l]&&h.push(l-this.defaultColCnt);a.foldColumns=h.join(","),this.advancedExcelDownload(a)},A.prototype.getHiddenColumnArr=function(){for(var t=[],e=this.defaultColCnt;e<this.hiddenList.length;e++)t.push(this.hiddenList[e]);return'<array><![CDATA[["'+t.join('","')+'"]]]></array>'},A.prototype.fireFileReadEnd=function(t){var e=this;setTimeout((function(){p.f.fireEvent(e,"onfilereadend",t)}),10)},A.prototype.readCSV=function(t){var e={};t=t||{};e.wframe=t.wframe||!1;var i=t.type||"1",s=t.delim||",",n=t.escapeChar||"",h=t.header||"1",d=t.footer||"1",u=t.startRowIndex||"0",p=t.startColumnIndex||"0",c=t.append||"0",g=t.hidden||"0",f=t.advancedHidden||"0",m=t.fillHidden||"0",y=t.skipSpace||"0",b=t.removeColumns||"",v=t.optionParam||"",w=document.location.protocol+"//"+document.location.host+"/",C=t.popupUrl?w+t.popupUrl:o.q.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.js"),I=t.popupUrl||this.options.csvUploadPopupURL;I+="?";var _,x=t.processMsg||"",S="";if(e.name=t.name||"FILE UPLOAD",this.options.dataList){var R=this.modelControl.getDataComp(this.options.dataList);null!=R&&(S=R.id)}var D=t.status||"R",T=t.expression||"1",L=t.ignoreSpan||"0",k=t.maxFileSize||-1,F=t.csvUploadURL||t.action||"",A=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",E=t.columnOrder||"",M=t.useModalDisable||"false",O=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false",N=t.filePath||"",H=t.trim||"0";if(t.useDialog=t.useDialog+""!="false",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,void 0===t.features||"string"!=typeof t.features)_="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else if(1==t.wframe){for(var G=t.features.split(","),W={},B=0;B<G.length;B++)0!=G[B].toLowerCase().indexOf("top")?0!=G[B].toLowerCase().indexOf("left")?0!=G[B].toLowerCase().indexOf("height")?0!=G[B].toLowerCase().indexOf("width")||(W.width=parseInt(G[B].split("=")[1])):W.height=parseInt(G[B].split("=")[1]):W.left=parseInt(G[B].split("=")[1]):W.top=parseInt(G[B].split("=")[1]);_=W}else _=t.features;e.sFeatures=_,h=parseInt(h,10),c=parseInt(c,10),g=parseInt(g,10),i=i||0,e.type=1==i?"true":"false",e.uploadType=i,e.delim=s,e.escapeChar=n,e.header=1==h?"true":"false",e.footer=1==d?"true":"false",e.append=1==c?"true":"false",e.hidden=1==g?"true":"false",1==f?(I+="&advancedHidden=true",e.advancedHidden="true"):(I+="&advancedHidden=false",e.advancedHidden="false"),e.fillHidden=1==m?"true":"false",e.skipSpace=1==y?"true":"false",e.removeColumns=b,e.optionParam=v,I+="&gridID="+this.id,e.gridID=this.id;var V=[];for(B=this.defaultColCnt;B<this.hiddenList.length;B++)1==this.hiddenList[B]&&V.push(B-this.defaultColCnt);var q=this.getExpressionColumnArr(t);e.expressionColumns=q.join(","),e.columnNum=q.length,e.hiddenColumns=V.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=u||"1",e.gridStartCol=p||"1",WebSquare.domain?(I+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain),e.domain=WebSquare.text.URLEncoder(WebSquare.domain)):e.domain="";var Y,Z=t.msaName||this._getMsaName()||"";if(""!=Z){var j="";""!=F&&(j=F),F=r.I.getServletURL(this,Z,"csvToXML.wq",j),A=!0}if(""==F&&(F=this.options.csvUploadURL),e.msaName=Z,e.action=F,e.processMsg=WebSquare.text.BASE64URLEncoder(x),e.dataList=S,1==L){var P=[],z={},U=0;for(B=0;B<this.cellIdList.length;B++){
for(var X=this.cellInfoHash[this.cellIdList[B]],K=parseInt(X.options.rowSpan)||1,$=parseInt(X.options.colSpan)||1,J=U,Q=0;Q<this.getRowCount()*this.getColCnt()&&P[J+Q];Q++)U++;for(var tt=0;tt<$;tt++){var et=U;P[et]=X.id,z[et]=!0;for(Q=1;Q<K;Q++){var it=U+Q*this.getColCnt();P[it]=X.id,z[it]=!0}U+=1}}Y=P.join(",")}else Y=this.cellIdList.join(",");e.columnIds=Y,e.expression=1==T?"false":"true",e.status=D,e.maxFileSize=k,e.postMsg=A,e.columnOrder=E,e.useModalDisable=M,e.useXHR=O,e.filePath=N,e.useDialog=t.useDialog,e.trim=1==H?"true":"false";var ot=a.Z.getBoolean(e.wframe);if(this._csvUploadInfo=JSON.stringify(e),0==t.useDialog){var st=new FormData;st.append("type",e.type),st.append("uploadType",e.uploadType),st.append("delim",e.delim),st.append("escapeChar",e.escapeChar),st.append("header",e.header),st.append("footer",e.footer),st.append("append",e.append),st.append("hidden",e.hidden),st.append("fillHidden",e.fillHidden),st.append("advancedHidden",e.advancedHidden),st.append("skipSpace",e.skipSpace),st.append("removeColumns",e.removeColumns),st.append("action",e.action),st.append("gridID",e.gridID),st.append("columnNum",e.columnNum),st.append("expressionColumns",e.expressionColumns),st.append("hiddenColumns",e.hiddenColumns),st.append("headerRows",e.headerRows);var rt=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),at=WebSquare.Elem.api.getElementsByTagName(rt[0],"w2:row");st.append("bodyRows",at.length),st.append("headerRows",e.headerRows),st.append("gridStartRow",e.gridStartRow);var nt="";nt="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),st.append("gridStyle",nt),st.append("columnIds",e.columnIds),st.append("dataList",e.dataList),st.append("expression",e.expression),st.append("status",e.status),st.append("optionParam",e.optionParam),st.append("columnOrder",e.columnOrder),st.append("useXHR",e.useXHR),st.append("filePath",e.filePath),st.append("useDialog",e.useDialog),x&&x.length>0?WebSquare.layer.showProcessMessage(x,t):WebSquare.layer.showProcessMessage("upload...",t);var lt=this,ht=new XMLHttpRequest;ht.onreadystatechange=function(){if(4==ht.readyState)if(200==ht.status)try{var i=ht.responseText,o=WebSquare.xml.parse(i),s=o.getElementsByTagName("Exception");if(s.length>0){var r,n=o.getElementsByTagName("deniedCodeList")[0],l="";if("102"==(l=void 0===n||null==l||void 0===(l=n.firstChild)||null==l||""==l?"":l.nodeValue))h=Upload_msg2;else{var h=o.getElementsByTagName("message")[0].firstChild;h=WebSquare.language.getMessage("Upload_msg3")}(r=t.onFailureCallback||null)&&r(e.action,h)}else{var d=o.getElementsByTagName("array")[0].firstChild.nodeValue;"string"==typeof e.append&&(e.append=a.Z.getBoolean(e.append));var u="",p={columnInfo:e.columnIds.split(","),data:d};if(""!=e.dataList){u=e.dataList;var c=a.Z.getComponentById(u),g=c.getRowCount();if(1==e.uploadType||2==e.uploadType?c.setArrayFile(p,e.append,e.gridID,e.uploadType):c.setArray(p,e.append),"C"==e.status){var f=c.getRowCount();e.append?c.modifyRangeStatus(g,f,"C"):c.modifyRangeStatus(0,f,"C")}}else{u=e.gridID;g=this.getRowCount();if(1==e.uploadType||2==e.uploadType?this.setDataFile(d,e.append,p.columnInfo,e.gridID,e.uploadType):this.setData(d,e.append),"C"==e.status){f=this.getRowCount();e.append?this.modifyRangeStatus(g,f,"C"):this.modifyRangeStatus(0,f,"C")}}var m=t.onSuccessCallback||null;m&&m(e.action);var y=N.split("\\");lt.fireFileReadEnd(y[y.length-1])}}catch(t){s.printStackTrace(t)}finally{WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}else(r=t.onFailureCallback||null)&&r(e.action),WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})},ht.open("POST",e.action,!0),ht.send(st)}else if(!0===ot){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,
-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),a.Z.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):a.Z.isIE(7)||a.Z.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):a.Z.isIE(9)||a.Z.isIE(10)?(e.sizeInfo.height=204,e.sizeInfo.width=446):a.Z.isIEAllVersion(11)?(e.sizeInfo.height=197,e.sizeInfo.width=455):a.Z.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):a.Z.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=198,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=200,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):a.Z.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==(0,l.A)(e.sFeatures)&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var dt={type:"json",name:"csvPopupParam",data:e},ut={id:this.id+"_csvPop",type:"wframePopup",dataObject:dt,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:C,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};this.scope_obj&&WebSquare.idCache[this.scope_obj.uuid]&&(ut.scope_uuid=this.scope_obj.uuid),a.Z.openPopup(ut.popupUrl,ut)}else I=WebSquare.BootLoader.getEngineUri(I),window.open(I,"csvupWindow",e.sFeatures)},A.prototype.saveCSV=function(t){var e=t.maxCellCount||-1;if(-1!=(e=parseInt(e,10))&&e<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var i=WebSquare.language.getMessage("Grid_warning8",e)||"The cell count has exceeded the limit.\n The current limit is : "+e;return void alert(i)}var o=t.maxRowCount||-1;if(-1!=(o=parseInt(o,10))&&o<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){i=WebSquare.language.getMessage("Grid_warning10",o)||"The row count has exceeded the limit.\n The current limit is : "+o;return void alert(i)}WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var s=(t=t||{}).fileName||"csvfile.csv",n=t.type||"1",l=t.delim||";",h=t.displayDelim||"true",d=t.removeColumns||"",u=t.header||"1",p=t.hidden||"0",c=t.checkButton||"1",g=t.removeQuotation||"1",f=t.removeNewLine||"1",m=t.saveList||"",y=this.options.rowNumHeaderValue||"";this.options.useLocale&&this.options.rowNumLocaleRef&&((q=this.getLocaleValue(this.options.rowNumLocaleRef))&&(y=q));var b="";"1"!=t.rowNumVisible&&"true"!=t.rowNumVisible&&1!=t.rowNumVisible||(b=this.options.rowNumVisible||"false");var v=t.textTable||"false",w=t.textTableAlign||"right",C=t.useFooter||"false",I=t.columnMove+""=="true",_=t.columnOrder||"",x=t.optionParam||"",S=t.aposPrefixOnNum||"0",R=t.aposPrefixOnText||"0",D=t.ignoreSpan||"0",T=t.maxDataSize||-1;T=parseInt(T,10);var L=t.csvDownloadURL||t.action||"",k=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=k+""=="true"
;for(var A=t.openFile||"false",E=t.sameSite||"",M=t.useHeaderCheckBoxLabel+""=="true",O=t.opencsv+""=="true",N=t.msaName||"",H=t.trim||"0",G=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],W=WebSquare.Elem.api.getElementsByTagName(G,"w2:column"),B=0;B<W.length;B++){var V=W[B];if("checkbox"===V.getAttribute("inputType")&&!0===M){var q,Y=V.getAttribute("checkboxLabel")||V.getAttribute("value"),Z=V.getAttribute("localeRef");if(this.options.useLocale&&Z)(q=this.getLocaleValue(Z))&&(Y=q);V.setAttribute("value",Y+"")}else{var j=V.getAttribute("id");V.setAttribute("value",this.getHeaderValue(j)+"")}}var P=new F.r.Hashtable,z="",U=(z="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element)).indexOf("<w2:gridView");if(z.indexOf("xmlns:w2")<0&&U>=0){var X=" xmlns:w2='"+WebSquare.core._XML_NAMESPACE.W2+"' ";U+=12,z=z.slice(0,U)+X+z.slice(U)}P.put("style",z),"0"==n?(P.put("data",this.getExcelAllXML()),"true"==C?P.put("footer_data",this.getExcelAllFooterXML()):P.put("footer_data","<array><![CDATA[[]]]></array>")):(P.put("data",this.getExcelAllXMLDisplay(n)),"true"==C?P.put("footer_data",this.getExcelAllFooterXMLDisplay()):P.put("footer_data","<array><![CDATA[[]]]></array>"));var K,$=[];for(B=0;B<this.getTotalCol();B++){var J=this.getCellInfo(B).options.inputType;"checkbox"!=J&&"radio"!=J&&"button"!=J||$.push('"'+B+'"')}I&&(K=""==_?this.getColumnOrder()||"":_.split(","));var Q=[];if(""!=d){var tt=(d+="").split(",");if(I)for(B=0;B<tt.length;B++)for(var et=0;et<K.length;et++)tt[B]==K[et]&&Q.push(et);else Q=tt;Q.sort((function(t,e){return 1*t-1*e})),d=Q.join(",")}var it=d;it='"'+it.wq_replaceAll(",",'","')+'"',P.put("hiddenArr",this.getHiddenColumnArr()),P.put("fileName",s),P.put("hidden",p),P.put("checkButton",c),P.put("type",n),P.put("rowNumVisible",b),P.put("rowNumHeaderValue",y),P.put("removeQuotation",g),P.put("delim",l),P.put("displayDelim",h),P.put("header",u),P.put("textTable",v),P.put("textTableAlign",w),P.put("useFooter",C),P.put("columnMove",I),P.put("columnOrder",K),P.put("optionParam",x),P.put("aposPrefixOnNum",S),P.put("aposPrefixOnText",R),P.put("ignoreSpan",D),P.put("removeNewLine",f),P.put("checkButtonArr","<array><![CDATA[["+$.join(",")+"]]]></array>"),""!=m&&P.put("saveList",'<array><![CDATA[["'+m.join('","')+'"]]]></array>'),P.put("removeColumns","<array><![CDATA[["+it+"]]]></array>"),P.put("openFile",A),""!=E&&P.put("sameSite",E),P.put("opencsv",O),""!=(N=N||this._getMsaName()||"")&&(k="true"),P.put("useXHR",k),P.put("msaName",N),P.put("trim",H);var ot=P.toString();if(-1!=T&&T<a.Z.getByteLengthUtf8(ot)){i=WebSquare.language.getMessage("Grid_warning9",T)||"he data size has exceeded the limit.\n The current limit is : "+e+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(i)}if(""!=N){var st="";""!=L&&(st=L),L=r.I.getServletURL(this,N,"xmlToCSV.wq",st),t.useXHR=!0}""==L&&(L=this.options.csvDownloadURL),t.scopeId=this.scope_id||"",r.I.excelDownload(L,ot,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0))},A.prototype.saveCSVFile=function(t,e,i,o,s,a,n,l,h){WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),n+="";var d=new F.r.Hashtable,u="";u="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),d.put("style",u),"0"==n||""==n?(d.put("data",this.getExcelAllXML()),d.put("footer_data",this.getExcelAllFooterXML())):(d.put("data",this.getExcelAllXMLDisplay(n)),
d.put("footer_data",this.getExcelAllFooterXMLDisplay()));for(var p=[],c=0;c<this.getTotalCol();c++){var g=this.getCellInfo(c).options.inputType;"checkbox"!=g&&"radio"!=g&&"button"!=g||p.push('"'+c+'"')}var f=h||"";f='"'+f.wq_replaceAll(",",'","')+'"',d.put("hiddenArr",this.getHiddenColumnArr()),d.put("fileName",t),d.put("hidden",o),d.put("checkButton","1"),d.put("type",n),d.put("rowNumVisible",this.options.rowNumVisible);var m=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var y=this.getLocaleValue(this.options.rowNumLocaleRef);y&&(m=y)}d.put("rowNumHeaderValue",m),d.put("removeQuotation",a),d.put("delim",e),d.put("header",i),d.put("checkButtonArr","<array><![CDATA[["+p.join(",")+"]]]></array>"),void 0!==l&&l&&d.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),d.put("removeColumns","<array><![CDATA[["+f+"]]]></array>"),r.I.excelDownload(this.options.csvDownloadURL,d.toString(),"post",{scopeId:this.scope_id||""})},A.prototype.getExcelUploadInfo=function(t){var e={},i=(t=t||{}).type||"0",o=t.removeColumns||"",s=t.startRowIndex||"0",a=t.startColumnIndex||"0",n=t.endColumnIndex||"-1",l=t.ignoreStartRowIndexInSAX+""||"1",h=t.ignoreStartColumnIndexInSAX+""||"1",d=t.sheetNo||"0",u=t.sheetName||"",p=t.activeSheet||!1,c=t.headerExist||"0";0===t.footerExist&&(t.footerExist="0");var g=t.footerExist||"1",f=t.append||"0",m=t.hidden||"0",y=t.fillHidden||"0",b=t.optionParam||"",v=t.skipSpace||"0",w=t.readUntilEmptyRow||"0",C=t.insertColumns||[],I=t.processMsg||"",_="";if(this.options.dataList){var x=this.modelControl.getDataComp(this.options.dataList);null!=x&&(_=x.id)}var S=t.status||"R",R=t.delim||",",D="",T="",L="",k=t.pwd||"",F=t.loadingMode||"",A=t.maxFileSize||"-1",E=t.cellDataConvertor||"",M=t.decimal||"4",O=t.applyDecimal||"0",N=t.useModalDisable||"false",H="false",G="";t.frameModal&&(H=!0,G=!0===t.frameModal||"frame"===t.frameModal?this.scope_id:t.frameModal);var W=t.useMaxByteLength||"false",B=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",V=t.dateFormat||"yyyy-MM-dd",q=t.byteCheckEncoding||"EUC-KR",Y=t.columnOrder||"",Z=t.columnMove+""=="true",j=t.chunkNum||0,P=t.trim||0,z=t.useXHR+""=="true",U=t.filePath||"";t.useDialog=t.useDialog+""!="false";for(var X=t.countSkipRow||"",K=0;K<C.length;K++){var $=C[K],J=$.columnIndex+""||"",Q=$.columnValue+""||"";""!=J&&(D=D+T+J+","+Q,T="|")}if(void 0===t.features||"string"!=typeof t.features)L="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else{var tt=t.features.split(","),et={};for(K=0;K<tt.length;K++)0!=tt[K].toLowerCase().indexOf("top")?0!=tt[K].toLowerCase().indexOf("left")?0!=tt[K].toLowerCase().indexOf("height")?0!=tt[K].toLowerCase().indexOf("width")||(et.width=parseInt(tt[K].split("=")[1])):et.height=parseInt(tt[K].split("=")[1]):et.left=parseInt(tt[K].split("=")[1]):et.top=parseInt(tt[K].split("=")[1]);1==t.wframe?L=et:(L=t.features,e.userFeatures=et)}e.sFeatures=L,c=parseInt(c,10),f=parseInt(f,10),m=parseInt(m,10),g=parseInt(g,10),e.header=1==c?"true":"false",e.footer=1==g?"true":"false",e.append=1==f?"true":"false",e.removeColumns=o,e.fillHidden=1==y?"true":"false",e.hidden=1==m?"true":"false",e.type=1==i?"true":"false",e.uploadType=i,e.skipSpace=1==v?"true":"false",e.readUntilEmptyRow=1==w?"true":"false",e.insertColumns=D,e.optionParam=b;var it=t.advancedExcelUploadURL||t.action||"";e.action=it||this.options.advancedExcelUploadURL;var ot=t.msaName||this._getMsaName()||"";if(""!=ot){var st="";it&&(st=it),e.action=r.I.getServletURL(this,ot,"excelToGrid2.wq",st),B=!0}e.gridID=this.id;var rt=[];for(K=this.defaultColCnt;K<this.hiddenList.length;K++)1==this.hiddenList[K]&&rt.push(K-this.defaultColCnt);if(e.columnNum=this.getTotalCol(),e.expressionColumns=this.getExpressionColumnArr().join(","),e.hiddenColumns=rt.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=s||"1",
e.gridStartCol=a||"1",e.gridEndCol=n,e.ignoreStartRowIndexInSAX="0"==l?"true":"false",e.ignoreStartColumnIndexInSAX="0"==h?"true":"false",e.gridSheetNo=d||"0",e.gridSheetName=u,e.activeSheet=p,e.applyDecimal="0"==O?"false":"true",WebSquare.domain&&(e.domain=WebSquare.text.URLEncoder(WebSquare.domain)),e.processMsg=WebSquare.text.BASE64URLEncoder(I),e.delim=R,e.dataList=_,!0===Z){var at=this.htmlInfo.body.rowAttrArr.length,nt=this.getColumnOrder(),lt=nt.length,ht=[];ht[lt-1]=void 0;for(K=0;K<at;K++)for(var dt=0;dt<lt;dt++)ht[lt*K+dt]=this.getColumnID(lt*K+nt[dt]);e.columnIds=ht.join(",")}else e.columnIds=this.cellIdList.join(",");return e.trim=1==P,e.countSkipRow=1==X,e.status=S,e.pwd=k,e.loadingMode=F,e.maxFileSize=A,e.cellDataConvertor=E,e.decimal=M,e.useModalDisable=N+"",e.frameId=G,e.frameModal=H+"",e.useMaxByteLength=W+"",e.postMsg=B+"",e.dateFormat=V,e.byteCheckEncoding=q,e.columnOrder=Y,e.wframe=t.wframe||!1,e.name=t.name||"FILE UPLOAD",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,e.chunkNum=parseInt(j,10),e.useXHR=z,e.filePath=U,e.useDialog=t.useDialog,e.msaName=ot,t.convertIndex&&(t.convertIndex=t.convertIndex.wq_replaceAll(" ",""),e.convertIndexArr=t.convertIndex.split(",")),"grid"==this.initializeType&&this.options.ref&&t.instanceBind&&(e.instanceBind=t.instanceBind),e},A.prototype.advancedExcelUpload=function(t){var e=this.getExcelUploadInfo(t),i=t.popupUrl||this.options.advancedExcelUploadPopupURL,s=document.location.protocol+"//"+document.location.host+"/",r=t.popupUrl?s+t.popupUrl:o.q.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.js"),n=t.advancedHidden||"0",h="";i+="?gridID="+e.gridID,WebSquare.domain&&(i+="&domain="+e.domain),1==n?(i+="&advancedHidden=true",e.advancedHidden="true"):(i+="&advancedHidden=false",e.advancedHidden="false"),""!=e.pwd&&(h=WebSquare.text.BASE64Encoder(e.pwd)),e.pwd=h;var d=a.Z.getBoolean(e.wframe);if(this._excelUploadInfo=JSON.stringify(e),0==t.useDialog){var u=new FormData;u.append("header",e.header),u.append("footer",e.footer),u.append("append",e.append),u.append("hidden",e.hidden),u.append("columnNum",e.columnNum),u.append("hiddenColumns",e.hiddenColumns),u.append("removeColumns",e.removeColumns),u.append("headerRows",e.headerRows);var p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),c=WebSquare.Elem.api.getElementsByTagName(p[0],"w2:row");u.append("bodyRows",c.length),u.append("delim",e.delim),u.append("fillHidden",e.fillHidden),u.append("gridStartRow",e.gridStartRow),u.append("gridStartCol",e.gridStartCol),u.append("gridEndCol",e.gridEndCol),u.append("gridEndCol",e.gridEndCol),u.append("gridSheetNo",e.gridSheetNo),u.append("gridSheetName",e.gridSheetName),u.append("activeSheet",e.activeSheet),u.append("expressionColumns",e.expressionColumns);var g="";g="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),u.append("gridStyle",g),u.append("type",e.type),u.append("uploadType",e.uploadType),u.append("skipSpace",e.skipSpace),u.append("insertColumns",e.insertColumns),u.append("dataList",e.dataList),u.append("instanceBind",e.instanceBind),u.append("columnIds",e.columnIds),u.append("status",e.status),u.append("pwd",e.pwd),u.append("loadingMode",e.loadingMode),u.append("optionParam",e.optionParam),u.append("cellDataConvertor",e.cellDataConvertor),u.append("decimal",e.decimal),u.append("applyDecimal",e.applyDecimal),u.append("useMaxByteLength",e.useMaxByteLength),u.append("dateFormat",e.dateFormat),u.append("byteCheckEncoding",e.byteCheckEncoding),u.append("columnOrder",e.columnOrder),u.append("chunkNum",e.chunkNum||0),u.append("trim",e.trim),u.append("useXHR",e.useXHR),u.append("filePath",e.filePath),u.append("useDialog",e.useDialog),u.append("countSkipRow",e.countSkipRow);var f=WebSquare.text.BASE64URLDecoder(e.processMsg)
;f&&f.length>0?WebSquare.layer.showProcessMessage(f,t):WebSquare.layer.showProcessMessage("upload...",t);var m=this,y=new XMLHttpRequest;y.onreadystatechange=function(){if(4==y.readyState)if(200==y.status){var i=y.responseText;try{var o=WebSquare.xml.parse(i),s=o.getElementsByTagName("Exception");if(s.length>0){var r=o.getElementsByTagName("deniedCodeList")[0],n="";if(void 0===r?n="":void 0!==(n=WebSquare.xml.getTextNodeValue(r))&&null!=n&&""!=n||(n=""),"102"==n)l=WebSquare.language.getMessage("Upload_msg2");else if("101"==n)l=WebSquare.language.getMessage("Upload_msg9");else if("200"==n)l=WebSquare.language.getMessage("Upload_msg10");else if("201"==n)l=WebSquare.language.getMessage("Upload_msg11");else if("202"==n)l=WebSquare.language.getMessage("Upload_msg8");else if("203"==n)l=WebSquare.language.getMessage("Upload_msg12");else if("204"==n)l=WebSquare.language.getMessage("Upload_msg13");else if("205"==n)l=WebSquare.language.getMessage("Upload_msg14");else if("206"==n)l=WebSquare.language.getMessage("Upload_msg15");else if("207"==n)l=WebSquare.language.getMessage("Upload_msg16");else if("208"==n)l=WebSquare.language.getMessage("Upload_msg17");else{var l=WebSquare.xml.getTextNodeValue(o.getElementsByTagName("message")[0]);void 0!==l&&null!=l&&""!=l||(l=WebSquare.language.getMessage("Upload_msg3"))}(b=t.onFailureCallback||null)&&b(e.action,l)}else{var h=o.getElementsByTagName("array")[0].firstChild.nodeValue;"string"==typeof e.append&&(e.append=a.Z.getBoolean(e.append));var d={columnInfo:e.columnIds.split(","),data:h};if(""!=e.dataList){var u=a.Z.getComponentById(e.dataList);d.data=d.data.replaceAll("\\n","\n");var p=u.getRowCount();if(1==e.uploadType||2==e.uploadType?","!=e.delim?u.setArrayFile(d,e.append,e.gridID,e.uploadType,e.delim):u.setArrayFile(d,e.append,e.gridID,e.uploadType):0==e.uploadType&&(","!=e.delim?u.setArray(d,e.append,null,null,e.delim):u.setArray(d,e.append)),"C"==e.status){var c=u.getRowCount();e.append?u.modifyRangeStatus(p,c,"C"):u.modifyRangeStatus(0,c,"C")}}else{p=this.getRowCount();if(!this.options.ref||1!=e.instanceBind&&"true"!=e.instanceBind?1==e.uploadType||2==e.uploadType?this.setDataFile(h,e.append):0==uploadType&&this.setData(h,e.append):(this.options.instanceBindBySetData=!0,1==e.uploadType||2==e.uploadType?this.setDataFile(h,e.append):0==e.uploadType&&this.setData(h,e.append),this.options.instanceBindBySetData=!1),"C"==e.status){c=this.getRowCount();e.append?this.modifyRangeStatus(p,c,"C"):this.modifyRangeStatus(0,c,"C")}}var g=t.onSuccessCallback||null;g&&g(e.action);var f=t.filePath.split("\\");m.fireFileReadEnd(f[f.length-1])}}catch(t){s.printStackTrace(t)}finally{WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}}else{var b;(b=t.onFailureCallback||null)&&b(e.action),WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}},y.open("POST",e.action,!0),y.send(u)}else if(!0===d){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),a.Z.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):a.Z.isIE(7)||a.Z.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):a.Z.isIE(9)?(e.sizeInfo.height=204,e.sizeInfo.width=446):a.Z.isIE(10)?(e.sizeInfo.height=162,e.sizeInfo.width=455):a.Z.isIEAllVersion(11)?(e.sizeInfo.height=198,e.sizeInfo.width=455):a.Z.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):a.Z.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=164,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):a.Z.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,
e.sizeInfo.width=454):a.Z.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.Z.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==(0,l.A)(e.sFeatures)&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var b={type:"json",name:"popupParam",data:e},v={id:this.id+"_excelPop",type:"wframePopup",dataObject:b,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,useModalStack:!0,frameModal:t.frameModal,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:r,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};t.frameModal&&this.scope_obj&&WebSquare.idCache[this.scope_obj.uuid]&&(v.scope_uuid=this.scope_obj.uuid),a.Z.openPopup(v.popupUrl,v)}else i=WebSquare.BootLoader.getEngineUri(i),window.open(i,"fileupWindow",e.sFeatures)},A.prototype.advancedExcelDownload=function(t,e){try{var i=t.maxCellCount||-1;if(-1!=(i=parseInt(i,10)))if(i<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var o=WebSquare.language.getMessage("Grid_warning8",i)||"The cell count has exceeded the limit.\n The current limit is : "+i;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}var r=t.maxRowCount||-1;if(-1!=(r=parseInt(r,10)))if(r<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){o=WebSquare.language.getMessage("Grid_warning10",r)||"The row count has exceeded the limit.\n The current limit is : "+r;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var a=parseInt(t.rowsByN);switch(t.rowsByN=a>100?a:100,t.dataLength=this.getDataLength(),t.multiexcel=!1,t.dataProvider=t.dataProvider||"",t.splitProvider=t.splitProvider||"",t.scope=this.scope_id||"",t.type+""){case"":case"0":t.type=0;break;case"2":t.type=2;break;default:t.type=1}if(!1===t.showProcess)WebSquare.getBody().showModal("w2modal_gridDownload");else if(!0===t.showConfirm)t.massStorage=!0,window.downloadGridId=this.id,WebSquare.getBody().showModal(),this.showSendExcelLayer();else{var n=t.processMsg;n&&n.length>0?WebSquare.layer.showProcessMessage(n,t):WebSquare.layer.showProcessMessage("download...",t)}if(0===t.type||1===t.type||2==t.type){t.cellInfo=[],t.isPlainDataCol=[],t.isSelectCol=[],t.isBasicCol=[],t.isExpCol=[],t.isCustomCol=[],t.isCustomModelCol=[],t.isCustomType=[],t.isEscapeFormatter=[];for(var l=this.oneRowDataLength,h=0;h<l;h++){var d=this.getCellInfo(h),u=d.options.inputType;t.cellInfo[h]=d,t.isCustomType[h]="custom"===u,t.isPlainDataCol[h]="checkbox"===u||"image"===u||"radio"===u,t.isSelectCol[h]="select"===u||"checkcombobox"===u||"autoComplete"===u,t.isExpCol[h]="expression"===u,t.isCustomCol[h]=d.useCustomFormatter,t.isCustomModelCol[h]=d.useCustomModelFormatter,t.isEscapeFormatter[h]=d.useEscapeFormatter,t.isBasicCol[h]=!(t.isPlainDataCol[h]||t.isSelectCol[h]||t.isExpCol[h]||t.isCustomCol[h]||t.isCustomModelCol[h]||t.isCustomType[h]||t.isEscapeFormatter[h])}}if(t.dataHandler=t.dataHandler||"",""!=t.dataHandler){this.sendExcelData(t,e,"")}else this.makeExcelData(0,[],t,e)}catch(t){WebSquare.layer.hideProcessMessage(),s.Y.printStackTrace(t,null,this)}},A.prototype.showSendExcelLayer=function(){if(void 0!==window.gridExceldownloadIframe){
window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.style.display="block";var t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.visibility="visible",window.gridExceldownloadIframe.contentWindow.initialize()}else{window.gridExceldownloadIframe=document.createElement("iframe"),window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.setAttribute("id","gridDownLoadLayer"),window.gridExceldownloadIframe.setAttribute("src",this.options.advancedExcelDownloadPopupURL),window.gridExceldownloadIframe.setAttribute("frameBorder","0"),window.gridExceldownloadIframe.className="w2grid_downloadIframe",window.gridExceldownloadIframe.style.width="300px",window.gridExceldownloadIframe.style.overflow="hidden",document.body.appendChild(window.gridExceldownloadIframe);t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.position="absolute",window.gridExceldownloadIframe.style.visibility="visible"}},A.prototype.checkUpload=function(){var t=this;setTimeout((function(){1==t.downloadInit?window.gridExceldownloadIframe.contentWindow.checkUpload("end"):t.checkUpload()}),10)},A.prototype.sendExcelData=function(t,e,i){try{"boolean"==typeof t.useFooter&&(t.useFooter=t.useFooter+"");var o=WebSquare.xml.encode(t.fileName)||"excel",s=t.extension||"";-1==o.indexOf(".")&&""!=s&&(o=o+"."+s);var n=t.sheetName||"sheet",h=t.type||"0",d=void 0===t.footerType?"1":t.footerType+"",u="false";if(1==t.multiexcel){var p=t.multipleSheet;void 0===t.multipleSheet&&(p=""),u=p+""=="true"||p+""==""?"true":"false"}else u="false";var c=t.removeColumns||"",g=t.removeHeaderRows||"",f=t.foldColumns||"",m=t.startRowIndex||"0",y=t.startColumnIndex||"0",b=t.headerColor||"",v=t.headerFontName||"",w=t.headerFontSize||"",C=t.headerFontColor||"",I=t.headerFontBold||"",_=t.bodyColor||"",x=t.bodyFontName||"",S=t.bodyFontSize||"",R=t.bodyFontColor||"",D=t.bodyFontBold||"",T=t.footerColor||"",L=t.footerFontName||"",k=t.footerFontSize||"",F=t.footerFontColor||"",A=t.footerFontBold||"",E=t.subTotalColor||"",M=t.subTotalFontName||"",O=t.subTotalFontSize||"",N=t.subTotalFontColor||"",H=t.subTotalFontBold||"",G=t.rowNumHeaderColor||"",W=t.rowNumHeaderFontName||"",B=t.rowNumHeaderFontSize||"",V=t.rowNumHeaderFontColor||"",q=t.rowNumBodyColor||"",Y=t.rowNumBodyFontName||"",Z=t.rowNumBodyFontSize||"",j=t.rowNumBodyFontColor||"",P=t.rowNumFooterColor||"",z=t.rowNumFooterFontName||"",U=t.rowNumFooterFontSize||"",X=t.rowNumFooterFontColor||"",K=t.rowNumSubTotalColor||"",$=t.rowNumSubTotalFontName||"",J=t.rowNumSubTotalFontSize||"",Q=t.rowNumSubTotalFontColor||"",tt=t.groupbyColor||"";t.groupbyColor=tt;var et=t.groupbyFontName||"";t.groupbyFontName=et;var it=t.groupbyFontSize||"";t.groupbyFontSize=it;var ot=t.groupbyFontColor||"";t.groupbyFontColor=ot;var st=t.dataProvider||"",rt=t.footerDataProvider||"",at=t.splitProvider||"",nt=t.providerRequestXml||"",lt=t.userDataXml||"",ht=t.optionParam||"",dt=t.bodyWordwrap||"",ut=t.subtotalWordwrap||"",pt=t.footerWordwrap||"",ct=t.useEuroLocale||"false",gt=t.numberLocale||"",ft=t.useHeader||"true",mt=t.useSubTotal||"false",yt=t.useFooter||"true";t.printSet=t.printSet||{}
;var bt=t.printSet.fitToPage||"false",vt=t.printSet.landScape||"false",wt=t.printSet.fitWidth||"1",Ct=t.printSet.fitHeight||"1",It=t.printSet.scale||"100",_t=t.printSet.pageSize||"A4",xt=t.separator||",",St=t.subTotalScale||-1,Rt=t.subTotalRoundingMode||"",Dt=t.footerScale||-1,Tt=t.footerRoundingMode||"",Lt=t.useStyle+""=="true",kt=t.useClass+""=="true";t.useClass=kt;var Ft=t.setFontSize+""=="true",At=t.freezePane||"",Et=t.autoSizeColumn||"false",Mt=t.autoSizeAdjustWith||512,Ot=t.displayGridlines||"",Nt=t.colMerge||"false",Ht=t.colMergeValue||"false",Gt=t.colMergeTextAlign||"center",Wt=t.useDataFormat||"false",Bt=t.useHeaderDataFormat||"",Vt=t.applyDataFormat||"false",qt=t.customToDataType||"false",Yt=t.useSubTotalData+""=="true",Zt=t.useFooterData+""=="true",jt=t.calcFooter+""=="true",Pt=t.columnMove+""=="true",zt=t.columnOrder||"";jt&&(Pt=!1);var Ut=t.columnMoveWithSubTotal||"",Xt=t.columnMoveWithFooter||"",Kt=t.oddRowBackgroundColor||"",$t=t.evenRowBackgroundColor||"",Jt=t.indent||"0",Qt=WebSquare.xml.encode(this.options.rowNumHeaderValue)||t.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef)(yi=this.getLocaleValue(this.options.rowNumLocaleRef))&&(Qt=yi);var te=t.rowNumVisible+""=="true",ee=this.options.startRowNumber||"1",ie=t.bodyNumberDefaultValue||"",oe=t.numberToText||"false",se=t.rowHeight||"-1",re=t.headerRowHeight||"-1",ae=t.maxDataSize||-1;ae=parseInt(ae,10);var ne=t.pwd||"",le=t.useImage||"false",he=t.headerAutoFilter||"false",de=t.filterRowIndex||"-1",ue=t.mergeCell+""=="true",pe=t.noMerge+""=="true";t.httpReadOnly=t.httpReadOnly+""=="true";var ce=t.advancedExcelDownloadURL||t.action||"",ge=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=ge+""=="true";var fe,me=t.openFile||"false",ye=t.macroFileName||"",be=t.useMacro||"false",ve=t.showDialog||"false",we=t.dialogFilter||"",Ce=t.keepType||"false",Ie=t.useHeaderCheckBoxLabel+""=="true",_e=t.lazyInfoArr||"false",xe=t.decimal||"",Se=t.sameSite||"",Re=t.customProvider||"",De=t.customProviderIndex||"",Te=t.rowAccessWindowSize||"",Le=t.trim||"",ke=t.desc||"",Fe=t.footerTop||"",Ae=t.msaName||"",Ee=t.innerBorder+""=="false"?"false":"",Me=t.chart||{};if(Me.chartName)var Oe=Me.chartName||"line",Ne=Me.chartType||"",He=Me.title||"",Ge=Me.xTitle||"",We=Me.yTitle||"",Be=Me.startRowIndex||0,Ve=Me.startColIndex||0,qe=Me.endRowIndex||0,Ye=Me.endColIndex||0,Ze=Me.serAxis||"true",je=Me.catAxis||"true",Pe=Me.catAxisRange||{},ze=Pe.startColIndex||0,Ue=Pe.startRowIndex||0,Xe=Pe.endColIndex||0,Ke=Pe.endRowIndex||0,$e=Me.serAxisRange||{},Je=$e.startColIndex||0,Qe=$e.startRowIndex||0,ti=$e.endColIndex||0,ei=$e.endRowIndex||0,ii=Me.dataAxisRange||{},oi=ii.startColIndex||0,si=ii.startRowIndex||0,ri=ii.endColIndex||0,ai=ii.endRowIndex||0,ni=Me.catGridLines||"true",li=Me.serGridLines||"true",hi=Me.legend||"true",di=Me.legendPosition||"bottom";Pt&&(fe=""==zt?this.getColumnOrder()||"":zt.split(","));var ui=[];if(""!=c){var pi=(c+="").split(",");if(Pt)for(var ci=0;ci<pi.length;ci++)for(var gi=0;gi<fe.length;gi++)pi[ci]==fe[gi]&&ui.push(gi);else ui=pi;ui.sort((function(t,e){return 1*t-1*e})),c=ui.join(",")}var fi=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],mi=WebSquare.Elem.api.getElementsByTagName(fi,"w2:column");for(ci=0;ci<mi.length;ci++){if("checkbox"===(ji=mi[ci]).getAttribute("inputType")&&!0===Ie){var yi,bi=ji.getAttribute("checkboxLabel")||ji.getAttribute("value"),vi=ji.getAttribute("localeRef");if(this.options.useLocale&&vi)(yi=this.getLocaleValue(vi))&&(bi=yi);ji.setAttribute("value",bi+"")}else{var wi=ji.getAttribute("id");ji.setAttribute("value",this.getHeaderValue2(wi)+"")}if("definedFormat"==(Ti=ji.getAttribute("excelCellType"))){var Ci="definedFormat"+this._getDefinedFormatIndex(ji.getAttribute("excelFormat"));ji.setAttribute("excelCellType",Ci)}}var Ii=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),_i=t.toTextIgnoreFormat,xi=!1;if(Ii.length>0){
var Si=Ii[0],Ri=WebSquare.Elem.api.getElementsByTagName(Si,"w2:row");for(ci=0;ci<Ri.length;ci++)for(mi=WebSquare.Elem.api.getElementsByTagName(Ri[ci],"w2:column"),gi=0;gi<mi.length;gi++){wi=(ji=mi[gi]).getAttribute("id");var Di=this.getCellInfo(wi);Di.options.displayFormat&&ji.setAttribute("displayFormat",Di.options.displayFormat);var Ti=ji.getAttribute("excelCellType"),Li="";if(xi=!1,_i&&_i.hasOwnProperty("colID"))xi=-1!==_i.colID.split(",").indexOf(wi);xi&&ji.setAttribute("displayFormat",""),null==Ti||""==Ti||void 0===Ti?(Li=this._dataList.getColumnOption(wi,"dataType"),xi&&(Li="text")):Li=Ti,Li?ji.setAttribute("dataType",Li):ji.setAttribute("dataType","text");var ki=ji.getAttribute("excelFormatter");if(zi=a.Z.getGlobalFunction(ki,this.scope_id)){var Fi=zi.call(this,wi);ji.setAttribute("excelFormat",Fi)}if("definedFormat"==Ti){Ci="definedFormat"+this._getDefinedFormatIndex(ji.getAttribute("excelFormat"));ji.setAttribute("excelCellType",Ci)}}}var Ai,Ei=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:subTotal"),Mi=a.Z.getDataPrefix("dataType"),Oi=a.Z.getDataPrefix("displayFormat");for(ci=0;ci<Ei.length;ci++){Ri=WebSquare.Elem.api.getElementsByTagName(Ei[ci],"w2:row"),Ai=this.subtotalTableList[Ei[ci].getAttribute("targetColumnID")];for(gi=0;gi<Ri.length;gi++){mi=WebSquare.Elem.api.getElementsByTagName(Ri[gi],"w2:column");for(var Ni=Ai?Ai.rows[gi].getElementsByTagName("td"):"",Hi=0;Hi<mi.length;Hi++){wi=(ji=mi[Hi]).getAttribute("id");for(var Gi="",Wi=0;Wi<Ni.length;Wi++)Ni[Wi].id===wi&&(Gi=Ni[Wi]);if(xi=!1,_i&&_i.hasOwnProperty("subtotalColID"))xi=-1!==_i.subtotalColID.split(",").indexOf(wi);xi?(ji.setAttribute("displayFormat",""),ji.setAttribute("dataType","text")):Gi&&(Gi.getAttribute(Oi)&&Gi.getAttribute(Oi)!=ji.getAttribute("displayFormat")&&ji.setAttribute("displayFormat",Gi.getAttribute(Oi)),Gi.getAttribute(Mi)&&"number"==Gi.getAttribute(Mi)&&Gi.getAttribute(Mi)!=ji.getAttribute("dataType")&&ji.setAttribute("dataType",Gi.getAttribute(Mi)));ki=ji.getAttribute("excelFormatter");if(zi=a.Z.getGlobalFunction(ki,this.scope_id)){Fi=zi.call(this,wi);ji.setAttribute("excelFormat",Fi)}if("definedFormat"==(Ti=ji.getAttribute("excelCellType"))){Ci="definedFormat"+this._getDefinedFormatIndex(ji.getAttribute("excelFormat"));ji.setAttribute("excelCellType",Ci)}}}}var Bi=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:footer"),Vi=this.getElementById(this.id+"_foot_table");if(Bi.length>0){var qi=Bi[0];Ri=WebSquare.Elem.api.getElementsByTagName(qi,"w2:row");for(ci=0;ci<Ri.length;ci++){mi=WebSquare.Elem.api.getElementsByTagName(Ri[ci],"w2:column");var Yi=Vi.rows[ci].getElementsByTagName("td"),Zi=a.Z.getDataPrefix("footer_id");for(gi=0;gi<mi.length;gi++){wi=(ji=mi[gi]).getAttribute("id");var ji,Pi="";for(Wi=0;Wi<Yi.length;Wi++)Yi[Wi].getAttribute(Zi)===wi&&(Pi=Yi[Wi]);if(xi=!1,_i&&_i.hasOwnProperty("footerColID"))xi=-1!==_i.footerColID.split(",").indexOf(wi);xi?(ji.setAttribute("displayFormat",""),ji.setAttribute("dataType","text")):Pi&&(Pi.getAttribute(Oi)&&Pi.getAttribute(Oi)!=ji.getAttribute("displayFormat")&&ji.setAttribute("displayFormat",Pi.getAttribute(Oi)),Pi.getAttribute(Mi)&&"number"==Pi.getAttribute(Mi)&&Pi.getAttribute(Mi)!=ji.getAttribute("dataType")&&ji.setAttribute("dataType",Pi.getAttribute(Mi)));var zi;ki=ji.getAttribute("excelFormatter");if(zi=a.Z.getGlobalFunction(ki,this.scope_id)){Fi=zi.call(this,wi);ji.setAttribute("excelFormat",Fi)}if("definedFormat"==(Ti=ji.getAttribute("excelCellType"))){Ci="definedFormat"+this._getDefinedFormatIndex(ji.getAttribute("excelFormat"));ji.setAttribute("excelCellType",Ci)}}}}var Ui=[];Ui.push("<vector result='1'>"),Ui.push("<data vectorkey='0'><hashtable>");var Xi=this.element._elementType,Ki="";if(Ki="json"===Xi?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),Ui.push("<data hashkey='style'>"+Ki+"</data>"),t.dataHandler=t.dataHandler||"",""!=t.dataHandler){
var $i=WebSquare.util.getGlobalFunction(t.dataHandler,this.scope_id);if("function"==typeof $i){var Ji=$i.call(this,this.id);xt=t.separator||",";i='<array><![CDATA[["'+Ji.join('"'+xt+'"')+'"]]]></array>'}}Ui.push("<data hashkey='data'>"+i+"</data>"),(this.startedDisplayNone||0==this.resizeObj.width||0==this.resizeObj.height)&&this.drawFooter(),Ui.push("<data hashkey='groupby' value='"+this.groupbyStatus.grouped+"'/>"),this.groupbyStatus.grouped?(Ui.push("<data hashkey='groupbyStyle'>"+this.getExcelGroupbyStyle()+"</data>"),Ui.push("<data hashkey='groupbyHeaderValue'>"+this.getExcelGroupbyHeaderValue(xt)+"</data>"),Ui.push("<data hashkey='groupbyFooterValue'>"+this.getExcelGroupbyFooterValue(xt)+"</data>"),Ui.push("<data hashkey='groupbyStatusValue'>"+this.getExcelGroupbyStatusValue(xt)+"</data>"),Ui.push("<data hashkey='groupbyStyleData'>"+this.getExcelGroupbyStyleData(t)+"</data>"),Ui.push("<data hashkey='rowNumVisible' value='"+this.options.rowNumVisible+"'/>"),Ui.push("<data hashkey='rowStatusVisible' value='"+this.options.rowStatusVisible+"'/>"),""!=tt&&Ui.push("<data hashkey='groupbyColor' value='"+tt+"'/>"),""!=et&&Ui.push("<data hashkey='groupbyFontName' value='"+et+"'/>"),""!=it&&Ui.push("<data hashkey='groupbyFontSize' value='"+it+"'/>"),""!=ot&&Ui.push("<data hashkey='groupbyFontColor' value='"+ot+"'/>"),a.Z.isEmptyObject(this.groupbyDisplayOptions.rowNumHeader)&&a.Z.isEmptyObject(this.groupbyDisplayOptions.rowStatusHeader)||Ui.push("<data hashkey='rowNone' value='true'/>")):Ui.push("<data hashkey='rowNumVisible' value='"+te+"'/>"),Ui.push("<data hashkey='footer_data'>"+this._getExcelFooterData(xt,d,h,t.footerConvertIndex)+"</data>"),Ui.push("<data hashkey='fileName' value='"+o+"'/>"),Ui.push("<data hashkey='sheetName' value='"+n+"'/>"),Ui.push("<data hashkey='multipleSheet' value='"+u+"'/>"),Ui.push("<data hashkey='stRowIndex' value='"+m+"'/>"),Ui.push("<data hashkey='stColIndex' value='"+y+"'/>"),Ui.push("<data hashkey='removeColumns' value='"+c+"'/>"),Ui.push("<data hashkey='removeHeaderRows' value='"+g+"'/>"),Ui.push("<data hashkey='foldColumns' value='"+f+"'/>"),Ui.push("<data hashkey='headerColor' value='"+b+"'/>"),Ui.push("<data hashkey='headerFontName' value='"+v+"'/>"),Ui.push("<data hashkey='headerFontSize' value='"+w+"'/>"),Ui.push("<data hashkey='headerFontColor' value='"+C+"'/>"),Ui.push("<data hashkey='headerFontBold' value='"+I+"'/>"),Ui.push("<data hashkey='bodyColor' value='"+_+"'/>"),Ui.push("<data hashkey='bodyFontName' value='"+x+"'/>"),Ui.push("<data hashkey='bodyFontSize' value='"+S+"'/>"),Ui.push("<data hashkey='bodyFontColor' value='"+R+"'/>"),""!=D&&Ui.push("<data hashkey='bodyFontBold' value='"+D+"'/>"),Ui.push("<data hashkey='footerColor' value='"+T+"'/>"),Ui.push("<data hashkey='footerFontName' value='"+L+"'/>"),Ui.push("<data hashkey='footerFontSize' value='"+k+"'/>"),Ui.push("<data hashkey='footerFontColor' value='"+F+"'/>"),""!=A&&Ui.push("<data hashkey='footerFontBold' value='"+A+"'/>"),Ui.push("<data hashkey='subTotalColor' value='"+E+"'/>"),Ui.push("<data hashkey='subTotalFontName' value='"+M+"'/>"),Ui.push("<data hashkey='subTotalFontSize' value='"+O+"'/>"),Ui.push("<data hashkey='subTotalFontColor' value='"+N+"'/>"),""!=H&&Ui.push("<data hashkey='subTotalFontBold' value='"+H+"'/>"),te&&(Ui.push("<data hashkey='rowNumHeaderColor' value='"+G+"'/>"),Ui.push("<data hashkey='rowNumHeaderFontName' value='"+W+"'/>"),Ui.push("<data hashkey='rowNumHeaderFontSize' value='"+B+"'/>"),Ui.push("<data hashkey='rowNumHeaderFontColor' value='"+V+"'/>"),Ui.push("<data hashkey='rowNumBodyColor' value='"+q+"'/>"),Ui.push("<data hashkey='rowNumBodyFontName' value='"+Y+"'/>"),Ui.push("<data hashkey='rowNumBodyFontSize' value='"+Z+"'/>"),Ui.push("<data hashkey='rowNumBodyFontColor' value='"+j+"'/>"),Ui.push("<data hashkey='rowNumFooterColor' value='"+P+"'/>"),Ui.push("<data hashkey='rowNumFooterFontName' value='"+z+"'/>"),Ui.push("<data hashkey='rowNumFooterFontSize' value='"+U+"'/>"),
Ui.push("<data hashkey='rowNumFooterFontColor' value='"+X+"'/>"),Ui.push("<data hashkey='rowNumSubTotalColor' value='"+K+"'/>"),Ui.push("<data hashkey='rowNumSubTotalFontName' value='"+$+"'/>"),Ui.push("<data hashkey='rowNumSubTotalFontSize' value='"+J+"'/>"),Ui.push("<data hashkey='rowNumSubTotalFontColor' value='"+Q+"'/>")),Ui.push("<data hashkey='footerDataProvider' value='"+rt+"'/>"),Ui.push("<data hashkey='dataProvider' value='"+st+"'/>"),Ui.push("<data hashkey='userDataXml' value=''>"+lt+"</data>"),Ui.push("<data hashkey='optionParam' value='"+ht+"'/>"),""!=dt&&Ui.push("<data hashkey='bodyWordwrap' value='"+dt+"'/>"),""!=ut&&Ui.push("<data hashkey='subtotalWordwrap' value='"+ut+"'/>"),""!=pt&&Ui.push("<data hashkey='footerWordwrap' value='"+pt+"'/>"),Ui.push("<data hashkey='useEuroLocale' value='"+ct+"'/>"),Ui.push("<data hashkey='numberLocale' value='"+gt+"'/>"),Ui.push("<data hashkey='useHeader' value='"+ft+"'/>"),Ui.push("<data hashkey='useSubTotal' value='"+mt+"'/>"),Ui.push("<data hashkey='useFooter' value='"+yt+"'/>"),Ui.push("<data hashkey='fitToPage' value='"+bt+"'/>"),Ui.push("<data hashkey='landScape' value='"+vt+"'/>"),Ui.push("<data hashkey='fitWidth' value='"+wt+"'/>"),Ui.push("<data hashkey='fitHeight' value='"+Ct+"'/>"),Ui.push("<data hashkey='scale' value='"+It+"'/>"),Ui.push("<data hashkey='pageSize' value='"+_t+"'/>"),Ui.push("<data hashkey='separator' value='"+xt+"'/>"),Ui.push("<data hashkey='subTotalScale' value='"+St+"'/>"),Ui.push("<data hashkey='subTotalRoundingMode' value='"+Rt+"'/>"),Ui.push("<data hashkey='footerScale' value='"+Dt+"'/>"),Ui.push("<data hashkey='footerRoundingMode' value='"+Tt+"'/>"),Ui.push("<data hashkey='useStyle' value='"+Lt+"'/>"),1==Ft&&Ui.push("<data hashkey='setFontSize' value='"+Lt+"'/>"),Ui.push("<data hashkey='freezePane' value='"+At+"'/>"),Ui.push("<data hashkey='autoSizeColumn' value='"+Et+"'/>"),Ui.push("<data hashkey='autoSizeAdjustWith' value='"+Mt+"'/>"),Ui.push("<data hashkey='displayGridlines' value='"+Ot+"'/>"),Ui.push("<data hashkey='colMerge' value='"+Nt+"'/>"),Ui.push("<data hashkey='colMergeValue' value='"+Ht+"'/>"),Ui.push("<data hashkey='colMergeTextAlign' value='"+Gt+"'/>"),Ui.push("<data hashkey='useDataFormat' value='"+Wt+"'/>"),""!=Bt&&Ui.push("<data hashkey='useHeaderDataFormat' value='"+Bt+"'/>"),Ui.push("<data hashkey='customToDataType' value='"+qt+"'/>"),Ui.push("<data hashkey='applyDataFormat' value='"+Vt+"'/>"),Ui.push("<data hashkey='useSubTotalData' value='"+Yt+"'/>"),Ui.push("<data hashkey='useFooterData' value='"+Zt+"'/>"),Ui.push("<data hashkey='calcFooter' value='"+jt+"'/>"),Ui.push("<data hashkey='columnMove' value='"+Pt+"'/>"),Ui.push("<data hashkey='columnOrder' value='"+fe+"'/>"),""!=Ut&&Ui.push("<data hashkey='columnMoveWithSubTotal' value='"+Ut+"'/>"),""!=Xt&&Ui.push("<data hashkey='columnMoveWithFooter' value='"+Xt+"'/>"),Ui.push("<data hashkey='oddRowBgColor' value='"+Kt+"'/>"),Ui.push("<data hashkey='evenRowBgColor' value='"+$t+"'/>"),Ui.push("<data hashkey='indent' value='"+Jt+"'/>"),Ui.push("<data hashkey='rowNumHeaderValue' value='"+Qt+"'/>"),Ui.push("<data hashkey='startRowNumber' value='"+ee+"'/>"),Ui.push("<data hashkey='bodyNumberDefaultValue' value='"+ie+"'/>"),Ui.push("<data hashkey='numberToText' value='"+oe+"'/>"),Ui.push("<data hashkey='rowHeight' value='"+se+"'/>"),re&&"object"==(0,l.A)(re)&&(re=JSON.stringify(re)),Ui.push("<data hashkey='headerRowHeight' value='"+re+"'/>"),Ui.push("<data hashkey='pwd' value='"+ne+"'/>"),Ui.push("<data hashkey='useImage' value='"+le+"'/>"),Ui.push("<data hashkey='headerAutoFilter' value='"+he+"'/>"),Ui.push("<data hashkey='filterRowIndex' value='"+de+"'/>"),Ui.push("<data hashkey='mergeCell' value='"+ue+"'/>"),Ui.push("<data hashkey='noMerge' value='"+pe+"'/>"),Lt&&Ui.push("<data hashkey='styleData'><array><![CDATA[["+this._getExcelStyle(t)+"]]]></array></data>"),Yt&&Ui.push("<data hashkey='subtotalData'><array><![CDATA[["+this._getExcelSubtotalData(xt)+"]]]></array></data>")
;var Qi="",to=t.mergeCellHeaderInfo||"";ue&&(mt=a.Z.getBoolean(mt),Qi=this.getMergeAll(c,mt)),Ui.push("<data hashkey='mergeCellInfo'><array><![CDATA[["+Qi+"]]]></array></data>"),Ui.push("<data hashkey='mergeCellHeaderInfo'><array><![CDATA[["+to+"]]]></array></data>"),Ui.push("<data hashkey='openFile' value='"+me+"'/>"),Ui.push("<data hashkey='macroFileName' value='"+ye+"'/>"),Ui.push("<data hashkey='useMacro' value='"+be+"'/>"),Ui.push("<data hashkey='showDialog' value='"+ve+"'/>"),Ui.push("<data hashkey='dialogFilter' value='"+we+"'/>"),Ui.push("<data hashkey='keepType' value='"+Ce+"'/>"),Ui.push("<data hashkey='lazyInfoArr' value='"+_e+"'/>"),Ui.push("<data hashkey='decimal' value='"+xe+"'/>"),""!=Se&&Ui.push("<data hashkey='sameSite' value='"+Se+"'/>"),Ui.push("<data hashkey='customProvider' value='"+Re+"'/>"),Ui.push("<data hashkey='customProviderIndex' value='"+De+"'/>"),Ui.push("<data hashkey='rowAccessWindowSize' value='"+Te+"'/>"),Ui.push("<data hashkey='trim' value='"+Le+"'/>"),""!=Ee&&Ui.push("<data hashkey='innerBorder' value='"+Ee+"'/>"),""!=(Ae=Ae||this._getMsaName()||"")&&(ge="true"),Ui.push("<data hashkey='useXHR' value='"+ge+"'/>"),Ui.push("<data hashkey='desc' value='"+ke+"'/>"),""!=Fe&&Ui.push("<data hashkey='footerTop' value='"+Fe+"'/>"),""!=Ae&&Ui.push("<data hashkey='msaName' value='"+Ae+"'/>"),Me.chartName&&(Ui.push("<data hashkey='c_chartName' value='"+Oe+"'/>"),Ui.push("<data hashkey='c_chartType' value='"+Ne+"'/>"),Ui.push("<data hashkey='c_title' value='"+He+"'/>"),Ui.push("<data hashkey='c_xTitle' value='"+Ge+"'/>"),Ui.push("<data hashkey='c_yTitle' value='"+We+"'/>"),Ui.push("<data hashkey='c_startRowIndex' value='"+Be+"'/>"),Ui.push("<data hashkey='c_startColIndex' value='"+Ve+"'/>"),Ui.push("<data hashkey='c_endRowIndex' value='"+qe+"'/>"),Ui.push("<data hashkey='c_endColIndex' value='"+Ye+"'/>"),Ui.push("<data hashkey='c_serAxis' value='"+Ze+"'/>"),Ui.push("<data hashkey='c_catAxis' value='"+je+"'/>"),Ui.push("<data hashkey='c_catAxisStartX' value='"+ze+"'/>"),Ui.push("<data hashkey='c_catAxisStartY' value='"+Ue+"'/>"),Ui.push("<data hashkey='c_catAxisEndX' value='"+Xe+"'/>"),Ui.push("<data hashkey='c_catAxisEndY' value='"+Ke+"'/>"),Ui.push("<data hashkey='c_serAxisStartX' value='"+Je+"'/>"),Ui.push("<data hashkey='c_serAxisStartY' value='"+Qe+"'/>"),Ui.push("<data hashkey='c_serAxisEndX' value='"+ti+"'/>"),Ui.push("<data hashkey='c_serAxisEndY' value='"+ei+"'/>"),Ui.push("<data hashkey='c_dataAxisStartX' value='"+oi+"'/>"),Ui.push("<data hashkey='c_dataAxisStartY' value='"+si+"'/>"),Ui.push("<data hashkey='c_dataAxisEndX' value='"+ri+"'/>"),Ui.push("<data hashkey='c_dataAxisEndY' value='"+ai+"'/>"),Ui.push("<data hashkey='c_catGridLines' value='"+ni+"'/>"),Ui.push("<data hashkey='c_serGridLines' value='"+li+"'/>"),Ui.push("<data hashkey='c_legend' value='"+hi+"'/>"),Ui.push("<data hashkey='c_legendPosition' value='"+di+"'/>")),null!=e&&void 0!==e||(e=[]),Ui.push("<data hashkey='information'><vector result='"+e.length+"'>");for(ci=0;ci<e.length;ci++){var eo=e[ci];for(var io in Ui.push("<data vectorkey='"+ci+"'><hashtable>"),eo)"text"==io?Ui.push("<data hashkey='"+io+"' value='"+WebSquare.xml.encode(eo[io])+"'/>"):Ui.push("<data hashkey='"+io+"' value='"+eo[io]+"'/>");Ui.push("</hashtable></data>")}if(Ui.push("</vector></data>"),0!=t.multiexcel)return Ui.push("<data hashkey='splitProvider' value='"+at+"'/>"),Ui.push("<data hashkey='providerRequestXml' value=''>"+nt+"</data>"),Ui.push("</hashtable></data>"),Ui.push("</vector>"),Ui;Ui.push("<data hashkey='splitProvider' value='"+at+"'/>"),Ui.push("<data hashkey='providerRequestXml' value=''>"+nt+"</data>"),Ui.push("</hashtable></data>"),Ui.push("</vector>");var oo=Ui.join("");if(-1!=ae&&ae<a.Z.getByteLengthUtf8(oo)){var so=WebSquare.language.getMessage("Grid_warning9",ae)||"The data size has exceeded the limit.\n The current limit is : "+ae+" byte"
;return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(so)}if(""!=Ae){var ro="";""!=ce&&(ro=ce),ce=r.I.getServletURL(this,Ae,"xmlToExcel2.wq",ro),t.useXHR=!0,t.userExcel=!0}""==ce&&(ce=this.options.advancedExcelDownloadURL),t.scopeId=this.scope_id||"",r.I.excelDownload(ce,oo,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0)),this.xmlData=null,!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm&&this.hideDownloadLayer()}catch(t){throw t}},A.prototype.saveFile=function(t){var e=t.type||"xml",i=t.fileName||"gridView",o=t.extension||"xml",s=t.sameSite||"",a=[];a.push("<vector result='1'>"),a.push("<data vectorkey='0'><hashtable>"),a.push("<data hashkey='type' value='"+e+"'/>"),a.push("<data hashkey='fileName' value='"+i+"'/>"),a.push("<data hashkey='extension' value='"+o+"'/>"),a.push("<data hashkey='sameSite' value='"+s+"'/>"),a.push("</hashtable></data>"),a.push("</vector>");var n=a.join("");n+="\x3c!----VALUESTR----!>",n+=WebSquare.xml.serialize(this.getAllXML());var l=t.action||WebSquare.baseServletURI+"gridToFile.wq";r.I.excelDownload(l,n,"post",t)},A.prototype.getExcelExpression=function(t){var e,i="";return void 0!==t.type&&void 0!==t.id&&void 0!==t.attr&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",r.I._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",r.I._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0]),void 0!==e&&(i=this._getAttribute(e,t))),i},A.prototype.setExcelExpression=function(t){var e;void 0!==t.type&&void 0!==t.id&&void 0!==t.excelExpression&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",r.I._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",r.I._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",r.I._XML_NAMESPACE.W2)[0]),void 0!==e&&this._setAttribute(e,t))},A.prototype._getAttribute=function(t,e){for(var i="",o=WebSquare.Elem.api.getElementsByTagName(t,"w2:row"),s=0;s<o.length;s++)for(var r=WebSquare.Elem.api.getElementsByTagName(o[s],"w2:column"),a=0;a<r.length;a++){var n=r[a];if(n.getAttribute("id")==e.id){i=n.getAttribute("excelExpression");break}}return i},A.prototype._setAttribute=function(t,e){for(var i=WebSquare.Elem.api.getElementsByTagName(t,"w2:row"),o=0;o<i.length;o++)for(var s=WebSquare.Elem.api.getElementsByTagName(i[o],"w2:column"),r=0;r<s.length;r++){var a=s[r];if(a.getAttribute("id")==e.id){a.setAttribute("excelExpression",e.excelExpression);break}}},A.prototype.cancleDownload=function(){clearTimeout(this.excelTime),this.hideDownloadLayer()},A.prototype.hideDownloadLayer=function(){window.gridExceldownloadIframe.style.display="none",this.excelOptions=null,this.excelInfoArr=null,this.excelFinalStr=null,window.downloadGridId=null,WebSquare.getBody().hideModal(!0)},A.prototype.saveBigExcelFile=function(t,e,i){i&&(t.rowsByN=i),t.massStorage=!0,this.advancedExcelDownload(t,e)},A.prototype._getExcelStyle=function(t){try{var e={},i={},o={},r={},n={},l=this.getColumnCount();if(1==t.useClass)for(var h=0;h<l;h++){var d=(v=this.getCellInfo(h)).options.className;if(d){var u=document.querySelector("."+d);if(u){
var p=WebSquare.style.getComputedStyle(u,"text-align"),c=WebSquare.style.getComputedStyle(u,"background-color"),g=WebSquare.style.getComputedStyle(u,"color"),f=WebSquare.style.getComputedStyle(u,"font-weight"),m=WebSquare.style.getComputedStyle(u,"font-family"),y=WebSquare.style.getComputedStyle(u,"font-size"),b=a.Z.getStyleFromCssStr(d,["backgroundColor"]);b&&b.backgroundColor||u.style.backgroundColor||(c=c.replace("rgba(0, 0, 0, 0)","")),void 0===e[h]&&(e[h]={}),""!=p&&(e[h]["text-align"]=p),""!=c&&(e[h]["background-color"]=c),""!=g&&(e[h].color=g),""!=f&&(e[h]["font-weight"]=f),""!=m&&(e[h]["font-family"]=m),""!=y&&(e[h]["font-size"]=y),"underline"!=(W=WebSquare.style.getComputedStyle(u,"text-decoration"))&&"line-through"!=W||(e[h]["text-decoration"]=W)}}}for(var h in this.columnStyleValueObj){var v,w={};for(var C in this.columnStyleValueObj[h])"style"!=C&&(w[C]=this.columnStyleValueObj[h][C]);if(v=this.getCellInfo(parseInt(h,10)))"underline"!=(W=this.getColumnStyleValue(parseInt(h,10),"text-decoration"))&&"line-through"!=W||(w["text-decoration"]=W);if(v&&v.options.textAlign){var I="";""==(I=this.getColumnStyleValue(parseInt(h,10),"text-align"))&&""==(I=v.options.textAlign)&&(I="center"),w["text-align"]=I}if(void 0===e[h])e[h]=w;else for(var C in w)e[h][C]=w[C]}for(h=0;h<this.rowStyleArr.length;h++)if(this.rowStyleArr[h]){w={};for(var C in this.rowStyleValueObj[this.rowStyleArr[h]])"style"!=C&&(w[C]=this.rowStyleValueObj[this.rowStyleArr[h]][C]);var _=this.getDisplayRowIndex(h);isNaN(_)||(i[_]=w)}for(var x in this.cellStyleArr)if(this.cellStyleArr[x]&&!isNaN(x)){w={};var S=parseInt(x/this.oneRowDataLength,10),R=(_=this.getDisplayRowIndex(S),x%this.oneRowDataLength);for(var C in this.cellStyleValueObj[this.cellStyleArr[x]])"style"!=C&&this.cellStyleValueObj[this.cellStyleArr[x]][C]&&(w[C]=this.cellStyleValueObj[this.cellStyleArr[x]][C]);o[_+","+R]=w}var D=function(t,e){t.backgroundColor&&(e["background-color"]=t.backgroundColor),t.color&&(e.color=t.color),t.textAlign&&(e["text-align"]=t.textAlign),t.fontSize&&(e["font-size"]=t.fontSize),t.fontWeight&&(e["font-weight"]=t.fontWeight),t.fontFamily&&(e["font-family"]=t.fontFamily),"underline"!=t["text-decoration"]&&"line-through"!=t["text-decoration"]||(e["text-decoration"]=t["text-decoration"]),t.borderLeft&&(e["border-left"]=t.borderLeft),t.borderRight&&(e["border-right"]=t.borderRight)};if(1==t.useClass){for(h=0;h<this.cellClassArr.length;h++)if(this.cellClassArr[h]){w={},S=parseInt(h/this.oneRowDataLength,10),_=this.getDisplayRowIndex(S),R=h%this.oneRowDataLength;var T=WebSquare.util.getStyleFromCssStr(this.cellClassArr[h],["backgroundColor","color","textAlign","fontSize","fontWeight","fontFamily","text-decoration","borderLeft","borderRight"]);o[_+","+R]&&(w=o[_+","+R]),T&&D(T,w),0!==Object.keys(w).length&&(o[_+","+R]=w)}for(h=0;h<this.rowClassArr.length;h++)if(this.rowClassArr[h]){w={},_=this.getDisplayRowIndex(h),T=WebSquare.util.getStyleFromCssStr(this.rowClassArr[h],["backgroundColor","color","textAlign","fontSize","fontWeight","fontFamily","text-decoration","borderLeft","borderRight"]);i[_]&&(w=i[_]),T&&D(T,w),0!==Object.keys(w).length&&(i[_]=w)}}if(this.options.disabledBackgroundColor||this.options.disabledFontColor){w={};this.options.disabledBackgroundColor&&(w["background-color"]=this.options.disabledBackgroundColor),this.options.disabledFontColor&&(w.color=this.options.disabledFontColor);l=this.getColumnCount();var L=this.getRowCount(),k=!(!this.isDrillDown||!this._dataList.options.depthColumn);for(h=0;h<l;h++)for(C=0;C<L;C++)this._getEditDisabled(h,C,k)&&(o[h+","+C]?(this.options.disabledBackgroundColor&&(o[h+","+C]["background-color"]=this.options.disabledBackgroundColor),this.options.disabledFontColor&&(o[h+","+C].color=this.options.disabledFontColor)):o[h+","+C]=w)}var F=a.Z.getDataPrefix("header_id"),A="",E=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(h=this.defaultColCnt;h<E.length;h++){
var M="",O=E[h].id.replace(this.id+"_",""),N=this.headerCellStyleValueObj[O];A=N&&N["background-color"]?N["background-color"]:t.headerColor?t.headerColor:WebSquare.style.getStyle(E[h],"background-color"),M+="color:"+WebSquare.style.getStyle(E[h],"color")+";",M+="background-color:"+A+";",M+="font-weight:"+WebSquare.style.getStyle(E[h],"font-weight")+";",M+="font-family:"+WebSquare.style.getStyle(E[h],"font-family")+";",M+="text-align:"+WebSquare.style.getStyle(E[h],"text-align")+";","underline"!=(W=WebSquare.style.getStyle(E[h],"text-decoration"))&&"line-through"!=W||(M+="text-decoration:underline;"),r[E[h].getAttribute(F)]=M}if(this.hasFooter){var H=a.Z.getDataPrefix("footer_id"),G=this.getDomList("foot_tds","th",this.getElementById(this.id+"_foot_table"));for(h=this.defaultColCnt;h<G.length;h++){var W;M="";M+="color:"+WebSquare.style.getStyle(G[h],"color")+";",M+="background-color:"+WebSquare.style.getStyle(G[h],"background-color")+";",M+="font-weight:"+WebSquare.style.getStyle(G[h],"font-weight")+";",M+="font-family:"+WebSquare.style.getStyle(G[h],"font-family")+";",M+="text-align:"+WebSquare.style.getStyle(G[h],"text-align")+";","underline"!=(W=WebSquare.style.getStyle(G[h],"text-decoration"))&&"line-through"!=W||(M+="text-decoration:underline;"),n[G[h].getAttribute(H)]=M}}return JSON.stringify({row:i,col:e,cell:o,header:r,footer:n})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getExcelSubtotalData=function(t){t||(t=",");var e=[];e.push('"');for(var i=a.Z.getDataPrefix("colMerge"),o=a.Z.getDataPrefix("value"),s=this.getDataLength(),r=0;r<s;r++){var n=r;for(var l in this.subtotalTableList){var h=this.dataList._getCellData(n,l),d=h+"_12";if(n<s-1)d=this.dataList._getCellData(n+1,l);if(h!=d){var u=this.subtotalTableList[l],p=this.subtotalDataArr[l+"_"+h];null==p&&(p=this.getSubtotalData(u,l,h,n));for(var c="",g=u.getElementsByTagName("td"),f=0;f<g.length;f++){var m=g[f],y=m.getAttribute("id");if(!y.startsWith("_headerRowNumber")&&!y.startsWith("_headerRowStatus")){if(null!=p[y])c=p[y];else if("true"==m.getAttribute(i))c="";else{c=null!=(c=m.getAttribute(o))?c:""}e.push(c),e.push('"'+t+'"')}}}}}return e[e.length-1]='"',e.join("")},A.prototype.getExcelGroupbyStyle=function(){try{if(this.groupbyStatus.grouped){var t={rowNumHeader:{type:"H",index:2},rowNumFooter:{type:"F",index:2},rowStatusHeader:{type:"H",index:3},rowStatusFooter:{type:"F",index:3},groupbyHeader:{type:"H",index:-1},groupbyFooter:{type:"F",index:-1}},e=4,i=4,o=!1,r=!1,a=[],n=[],l=[],h={};a.push("<w2:groupby>"),n.push("<w2:groupbyHeader>"),l.push("<w2:groupbyFooter>"),n.push("<w2:row>"),l.push("<w2:row>");var d=this.defaultColCnt+this.getColCnt(),u=0,p=0;this.options.rowNumVisible&&(this.groupbyDisplayOptions.rowNumHeader&&(this.groupbyDisplayOptions.rowNumHeader.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowNumHeader.colSpan,10)||1)<=d&&(h.rowNumHeader=this.groupbyDisplayOptions.rowNumHeader)),this.groupbyDisplayOptions.rowNumFooter&&(this.groupbyDisplayOptions.rowNumFooter.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowNumFooter.colSpan,10)||1)<=d&&(h.rowNumFooter=this.groupbyDisplayOptions.rowNumFooter))),this.options.rowStatusVisible&&(this.groupbyDisplayOptions.rowStatusHeader&&(this.groupbyDisplayOptions.rowStatusHeader.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowStatusHeader.colSpan,10)||1)<=d&&(h.rowStatusHeader=this.groupbyDisplayOptions.rowStatusHeader)),this.groupbyDisplayOptions.rowStatusFooter&&(this.groupbyDisplayOptions.rowStatusFooter.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowStatusFooter.colSpan,10)||1)<=d&&(h.rowStatusFooter=this.groupbyDisplayOptions.rowStatusFooter))),h.groupbyHeader=[],h.groupbyFooter=[];for(var c=this.groupbyDisplayOptions.groupbyHeader,g=0;g<c.length;g++)c[g].hidden||(p+=parseInt(c[g].colSpan,10)||1,h.groupbyHeader[g]=c[g]);var f=this.groupbyDisplayOptions.groupbyFooter;for(g=0;g<f.length;g++)f[g].hidden||(u+=parseInt(f[g].colSpan,10)||1,h.groupbyFooter[g]=f[g]);if(e<d){var m=d-p
;for(g=0;g<m;g++)h.groupbyHeader.push({temp:!0})}if(i<d)for(m=d-u,g=0;g<m;g++)h.groupbyFooter.push({temp:!0});for(var y in this.groupbyStatus.excelDisplayOptions=h,h){var b,v=[];switch(y){case"rowNumHeader":case"rowNumFooter":case"rowStatusHeader":case"rowStatusFooter":v.push("<w2:column");var w=h[y],C=!1;for(var I in w)if("align"==I||"hidden"==I||"colSpan"==I){if("hidden"==I){C=!0;break}v.push(" "+I+'="'+w[I]+'"'),"rowNumHeader"!=y&&"rowNumFooter"!=y||"colspan"==I.toLowerCase()&&w[I]>=this.defaultColCnt+this.getColCnt()&&("rowNumHeader"==y?o=!0:r=!0)}if(C)break;if("rowStatusHeader"==y&&o)break;if("rowStatusFooter"==y&&r)break;y.match("rowNum")?v.push(' type="rowNum"'):y.match("rowStatus")&&v.push(' type="rowStatus"'),v.push("/>"),b=t[y];break;case"groupbyHeader":case"groupbyFooter":C=!1;var _=h[y];if(_.length>0){var x=0,S=0,R=0,D=0,T=this.htmlInfo?this.htmlInfo.body.rowArr:this.struct.body.rowArr;for(g=0;g<T.length;g++){for(var L=T[g],k=0;k<L.length;k++){var F=L[k];x+=parseInt(F.colSpan,10)||1}S<x&&(S=x),x=0}var A;(A=[])[S-1]=void 0;for(g=0;g<_.length;g++){var E=[];for(var I in E.push("<w2:column"),_[g])if("align"==I||"hidden"==I||"colSpan"==I||"rowSpan"==I||"displayFormat"==I){if("hidden"==I){E.pop();break}E.push(" "+I+'="'+_[g][I]+'"')}E.push("/>"),v.push(E.join(""));var M=parseInt(_[g].colSpan,10)||1,O=parseInt(_[g].rowSpan,10)||1;if(0===D){if(void 0===A[R])if(M>1)for(var N=0;N<M;N++)A[R+N]=O;else A[R]=O}else{A[R]>1?A[R]-=1:A[R]=O;for(var H=R+1;1!==A[H]&&H<S;)A[H]-=1,R+=1,H+=1}S<=(R+=M)&&g!=_.length-1&&(v.push("</w2:row><w2:row>"),R=0,D+=1)}}b=t[y]}b&&("H"==b.type?-1==b.index?(n[e]=v.join(""),e++):n[b.index]=v.join(""):"F"==b.type&&(-1==b.index?(l[i]=v.join(""),i++):l[b.index]=v.join(""))),b=null}return n.push("</w2:row>"),l.push("</w2:row>"),n.push("</w2:groupbyHeader>"),l.push("</w2:groupbyFooter>"),a.push(n.join("")),a.push(l.join("")),a.push("</w2:groupby>"),a.join("")}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getExcelGroupbyHeaderValue=function(t){this.groupbyStatus.headerValueObj={},this.getAllGroupbyHeaderValueObj();var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("header"==o.type){for(var s=this.groupbyStatus.headerValueObj[o.groupId],r=0;r<s.length;r++)null!=s[r]&&(e.push('"'+s[r]+'"'),r<s.length-1&&e.push(t));s.length>0&&e.push(t)}}return e.pop(),e.push("]"),e.push("]]></array>"),e.join("")},A.prototype.getExcelGroupbyFooterValue=function(t){this.groupbyStatus.footerValueObj={},this.getAllGroupbyFooterValueObj();var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("footer"==o.type){for(var s=this.groupbyStatus.footerValueObj[o.groupId],r=0;r<s.length;r++)null!=s[r]&&(e.push('"'+s[r]+'"'),r<s.length-1&&e.push(t));s.length>0&&e.push(t)}}return e.pop(),e.push("]"),e.push("]]></array>"),e.join("")},A.prototype.getExcelGroupbyStatusValue=function(t){var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("number"==typeof o)e.push('"0B"');else{switch(o.type){case"header":var s='"'+o.depth+'H"';break;case"footer":s='"'+o.depth+'F"'}e.push(s)}i<this.groupbyStatus.groupedRowIndexArr.length-1&&e.push(t)}return e.push("]"),e.push("]]></array>"),e.join("")},A.prototype.getExcelGroupbyStyleData=function(t){var e=this.getElementById(this.id+"_body_tbody").childNodes,i=[];i.push("<array><![CDATA["),i.push("[");for(var o=0;o<this.groupbyStatus.groupedRowIndexArr.length;o++){var s=this.groupbyStatus.groupedRowIndexArr[o];if("number"!=typeof s){var r=e[s.index];if(!i[s.depth+2]){var a,n='"';for(var l in 0!=o&&(n=',"'),this.groupbyStatus.excelDisplayOptions){var h=!1;switch(l){case"rowNumHeader":h=!0,a=0;break;case"rowStatusHeader":h=!0,a=this.defaultColCnt-1;break;case"groupbyHeader":h=!0,
a=this.defaultColCnt}if(h)break}var d=r.getElementsByTagName("TD")[a];""==t.groupbyColor&&(n+="background-color:"+WebSquare.style.getStyle(d,"background-color")+";"),""==t.groupbyFontSize&&(n+="font-size:"+WebSquare.style.getStyle(d,"font-size")+";"),""==t.groupbyFontColor&&(n+="color:"+WebSquare.style.getStyle(d,"color")+";"),n+="font-weight:"+WebSquare.style.getStyle(d,"font-weight")+";",""==t.groupbyFontName&&(n+="font-family:"+WebSquare.style.getStyle(d,"font-family")+";"),n+='"',i[s.depth+2]=n}}}return i.push("]"),i.push("]]></array>"),i.join("")},A.prototype.getAllGroupbyHeaderValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumHeader),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusHeader),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyHeader.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyHeader[o]),i++}},A.prototype.getAllGroupbyFooterValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumFooter),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusFooter),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyFooter.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyFooter[o]),i++}},A.prototype.getGroupbyData=function(t){try{if(this.options.groupbyZone&&this.groupbyStatus&&this.groupbyStatus.grouped)return!1===t?this.groupbyStatus.groupbyOptions:JSON.parse(this.groupbyStatus.groupbyOptions)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setGroupbyData=function(t,e,i){try{var o,r,a=(i=i||{}).value||"",n=i.inputType||"",l=i.depthVisible||!1,h=i.expression||"",d=i.hidden?"none":"",u=i.displayFormatType||"text",p=i.displayFormat||"",c=i.displayFormatter||null;if(n)switch((p||c)&&(o=new WebSquare.format.createFormatter(u,p,c,null,null,null,this.scope_id,this.id)),n){case"toggleButton":r="open"==t.status?"-":"+";break;case"expression":if(h){var g=this.groupbyInfo[t.groupId].header;g.colIndex=e;var f=0;if("open"==g.status){for(var m,y=g.index;y<this.groupbyStatus.groupedRowIndexArr.length;y++){if("footer"==(b=this.groupbyStatus.groupedRowIndexArr[y]).type&&b.depth==g.depth){m=b.index;break}}if(!m){for(y=g.index+1;y<this.groupbyStatus.groupedRowIndexArr.length;y++){var b;if("header"==(b=this.groupbyStatus.groupedRowIndexArr[y]).type&&b.depth==g.depth){m=b.index;break}}m||(m=this.groupbyStatus.groupedRowIndexArr.length-1)}f=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,g.index,m,h,g)}else f=this.groupExpression(g.closedChildArr,0,g.closedChildArr.length-1,h,g);if(o&&(f=o.format(f)),"string"==typeof(r=f)&&(r.match("w2grid_minus")||r.match("w2grid_plus"))){var v=r.lastIndexOf("</span>");v>-1&&(v+=7,r=r.slice(v),"open"==t.status?r="-||"+r:"closed"==t.status&&(r="+||"+r))}}}if(l&&(r=t.groupId),a&&(o&&(a=o.format(a)),r=a),!r){r="";y=0;for(var w in i)y++;0==y&&(d="none")}"none"!=d&&("header"==t.type?(this.groupbyStatus.headerValueObj[t.groupId]||(this.groupbyStatus.headerValueObj[t.groupId]=[]),this.groupbyStatus.headerValueObj[t.groupId][e]=r):"footer"==t.type&&(this.groupbyStatus.footerValueObj[t.groupId]||(this.groupbyStatus.footerValueObj[t.groupId]=[]),this.groupbyStatus.footerValueObj[t.groupId][e]=r))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getTotalRow=function(){return this.dataList.getTotalRow()},A.prototype.getTotalCol=function(){return this.oneRowDataLength},A.prototype.editEndBeforeGetData=function(){
this.editedCell&&this.rollbackCommitFlag&&1==this.options.rollbackCommit&&(1==this.options.moveKeyEditModeAll&&1==this.checkScrollEnd||(this.rollbackCommitFlag=!1,this.editedCell.handleEndEdit(),this.rollbackCommitFlag=!0))},A.prototype.getExtraDataObj=function(t,e,i){var o=this.extraData;return"grid"==t?o.grid:"row"==t?(o.row[e]||(o.row[e]={}),o.row[e]):"col"==t?(o.col[e]||(o.col[e]={}),o.col[e]):"cell"==t?(o.cell[e]||(o.cell[e]=[]),o.cell[e][i]||(o.cell[e][i]={}),o.cell[e][i]):null},A.prototype.finalize=function(){try{for(var t in null!=this.tempDiv&&null!=this.tempDiv.parentNode&&(this.tempDiv.innerHTML=""),null!=this.tempTr&&null!=this.tempTr.parentNode&&(this.tempTr.innerHTML=""),n.q.removeCheckResize(this.uuid),a.Z.clearInterval(this.id+"_dragSelectAutoScroll"),r.I.clearTimer(this.id+"initializeEvent"),r.I.clearTimer(this.id+"_autofit"),a.Z.clearTimeout(this.id+"_displayFixedColumnLine"),this.dom)this._removeDom(t);for(var e in this._dataList&&this._dataList.childCompHash&&delete this._dataList.childCompHash[this.id],null!=this._manager&&this._manager.destroy(),null!=this.customFilter&&this.customFilter.remove(),this.cellInfoHash){var i=this.cellInfoHash[e];i&&i.comp&&"function"==typeof i.comp.remove&&i.comp.remove()}this.orgSubtotalHeightArr=[]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setFixedColumn=function(t){try{t=parseInt(t,10),t=isNaN(t)?0:t;var e=0;if(!(t<this.getColumnCount()))return;if(t>0){this.getFixedColumnLastIndex();for(var i=0;i<=t+this.defaultColCnt;i++)this.hiddenList[i]||(e+=this.colWidthList[i])}if(e>this.getElementById(this.id+"_dataLayer").offsetWidth)return;if(this.options.fixedColumn>0){var o=this.getColumnCount();for(i=0;i<this.lastIndex+1;i++){var r=this.data_td_list[i*o+this.options.fixedColumn];r&&this.removeClass(r,"w2grid_fixedColumn");var a=parseInt(this.options.fixedColumn);if(t<a)for(var n=t;n<a;n++){var l=this.data_td_list[i*o+n];l&&this.removeClass(l,"w2grid_fixedColumn_td")}}}this.options.fixedColumn=t,this.options.fixedColumnScrollReset&&this.setScrollLeft(0),this.arrangeOverflowXScroll(),this.displayFixedColumnLine()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setFixedRightColumn=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRightColumn>0)for(var e=this.getColumnCount(),i=this.getFixedRightColumnLastIndex()-this.defaultColCnt,o=0;o<this.lastIndex+1;o++){var r=this.data_td_list[o*e+i];if(r&&this.removeClass(r,"w2grid_fixedRightColumn"),i<e-t)for(var a=e-t-1;a>=i;a--){var n=this.data_td_list[o*e+a];n&&this.removeClass(n,"w2grid_fixedRightColumn_td")}}this.options.fixedRightColumn=t,this.arrangeOverflowXScroll(),this._handleScrollX()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.options.fixedRow-1)];e&&this.removeClass(e,"w2grid_fixedRow")}this.options.fixedRow=t,this.applyRowStyleOptions(t-1)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setLastFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.lastFixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.lastIndex-this.options.lastFixedRow)];e&&this.removeClass(e,"w2grid_lastFixedRow")}this.options.lastFixedRow=t,this.drawData(this.rowIndex,this.lastIndex-t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getOverflowX=function(){return this.options.overflowX},A.prototype.getOverflowY=function(){return this.options.overflowY},A.prototype.getColumnVisible=function(t){try{var e=t,i=(t=this.getColumnIndex(t),r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/getColumnVisible/@useRealColIndex"));if(a.Z.getBoolean(i)){if("number"!=typeof e){for(var o=this.getCellInfo(e),n=this._getRealColIndex("body",e),l=n+this.defaultColCnt,h=!this.hiddenList[l],d=0;d<o.options.colSpan;d++)h=!this.hiddenList[l+d]||h;return 0===n||n?h:void c.v.printLog("[getColumnVisible] Invalid column index provided.")}
t=e%this.columnOrder.length;for(var u=0;u<this.columnOrder.length;u++)if(this.columnOrder[u]==t){t=u;break}if(e>this.columnOrder.length||u===this.columnOrder.length)return void c.v.printLog("[getColumnVisible] Invalid column index provided.")}return!this.hiddenList[this.defaultColCnt+t]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getColumnWidth=function(t,e){try{var i=e?this.defaultColCnt:0;if(t=this.getColumnIndex(t)+i,this.colWidthList[t])return this.colWidthList[t]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnWidth=function(t,e,i){try{if(!this.render)return void c.v.printLog("[setColumnWidth] "+this.options.pluginName+" is not initialized yet");if(0===this.render.offsetHeight&&0===this.render.offsetWidth){var o=!1;if("string"==typeof t&&(o=!0,t=this.getDisplayColumnIndex(t)),this.delayedDrawObj.newColumnOrder)for(var r=0;r<this.delayedDrawObj.newColumnOrder.length;r++)if(this.delayedDrawObj.newColumnOrder[r]==t){t=o?this.delayedDrawObj.newColumnOrder[r]:r;break}}else t=this.getDisplayColumnIndex(t);var a=this.colWidthList[t],n=!0===i?0:this.defaultColCnt;if(this.colWidthList[t]){this.__bResizeObj&&(this.__bResizeObj.isColumnResizing=!0),this.options.autoFit&&!this.hiddenList[t+n]?(this.autoFitColWidthList=null,this._setAutoFit({exceptCol:n+t,exceptWidth:e})):this._setColumnWidth(n+t,e),this.__bResizeObj&&(this.__bResizeObj.isColumnResizing=!1);var l=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],h=WebSquare.Elem.api.getElementsByTagName(l,"w2:column");for(r=0;r<h.length;r++){var d=h[r],u=d.getAttribute("id");if(this.getHeaderIndex(u)+n==t+n){d.setAttribute("width",e+"");break}}}i&&(t-=this.defaultColCnt),p.f.fireEvent(this,"oncolumnwidthchange",{columnIndex:t,columnID:this.getColumnID(t),oldWidth:a,newWidth:e})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.isColumnResizable=function(t){try{if(t<this.defaultColCnt)return!0===this.options.rowNumStatusResize;if(void 0===t||""===t)return!1;if(isNaN(t)&&(t=this.getColumnIndex(t)+this.defaultColCnt),isNaN(t)||t>=this.getColumnCount()+this.defaultColCnt)return!0;for(var e,i=!0,o=0;o<this.htmlInfo.head.rowArr.length;o++)for(var r=this.htmlInfo.head.rowArr[o],n=0;n<r.length;n++)if(r[n].colIndex==this.columnOrder[t]&&"string"==typeof r[n].fixColumnWidth&&"true"===r[n].fixColumnWidth.toLowerCase()){i=!1;break}if(!this.cellInfoHash||a.Z.isEmptyObject(this.cellInfoHash))(e=this.cellInfoHash2[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&!0===a.Z.getBoolean(e.getAttribute("fixColumnWidth"))&&(i=!1);else(e=this.cellInfoHash[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&e.options.fixColumnWidth&&(i=!1);return i}catch(t){return s.Y.printStackTrace(t,null,this),!0}},A.prototype.setColumnDisableEdit=function(t,e){try{var i=this.getCellInfo(t);"autoComplete"==i.options.inputType&&i.setColumnDisableEdit(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnNodeSet=function(t,e,i,o){try{if(!this.render||0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0},this.setRedrawStatus("stop"),void this.delayedDraw({columnNodeset:{colIndex:t,nodeset:e,label:i,value:o}});var r=this.getCellInfo(t),a=r.options.inputType;if("select"!=a&&"autoComplete"!=a&&"checkcombobox"!=a)return;r.setColumnNodeSet(e,i,o),r.hasRef&&(r.refHash=[]),r.itemsetObj&&r.mainGrid.refresh()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnGridItemset=function(t,e){try{var i=this.getCellInfo(t);("select"==i.options.inputType||"autoComplete"==i.options.inputType||"checkcombobox"==i.options.inputType)&&i.setColumnGridItemset(e),i.hasRef&&(i.refHash=[]),i.itemsetObj&&i.mainGrid.refresh()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);if(i.options.displayFormat=e,i._changeDisplayFormat=!0,
i.options.embeddedInput)for(var o=WebSquare.format.createFormatter(i.options.dataType,i.options.displayFormat,i.options.displayFormatter,i.options.ioFormat,null,null,i.mainGrid.scope_id,i.mainGrid.id),r=0;r<i.mainGrid.getDataLength();r++){var a=i.mainGrid.dataList._getCellData(r,t);t=i.mainGrid.getColumnIndex(t);var n=i.mainGrid.data_td_list[t+r*i.mainGrid.oneRowDataLength],l=i.mainGrid.getInput(i,n,a);l&&(l.formatter=o)}return i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnIoFormat=function(t,e,i){try{"object"===(0,l.A)(arguments[0])?this._setColumnIoFormat(arguments[0]):this._setColumnIoFormat({colIndex:t,ioFormat:e,dateMask:i})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setColumnIoFormat=function(t){try{var e=t.colIndex,i=t.ioFormat,o=t.dateMask,r=t.useMonthYearFormat,a=t.calendarDisplayFormat,n=this.getCellInfo(e);if(!n||"custom"===n.options.inputType||"date"!==n.options.dataType)return;var l=!1,h=n.options.ioFormat;if("string"==typeof i&&(l=i!==h,n.options.ioFormat=i),"string"==typeof o&&(n.options.displayFormat=o),"calendar"===n.options.inputType&&(n.options.useMonthYearFormat=r,"string"==typeof a&&(n.options.calendarDisplayFormat=a)),n.initFormatter(),!0===l){for(var d=n.options.embeddedInput?this.getRowCount():1,u=0;u<d;u++){var p=this.dataList._getCellData(u,e),c=this.data_td_list[e+u*this.oneRowDataLength],g=n.mainGrid.getInput(n,c,p);if(g&&"function"==typeof g.setIoFormat){t={ioFormat:i,displayFormat:o,useMonthYearFormat:r,calendarDisplayFormat:a};g.setIoFormat(t)}}if(n.options.useMonthYearFormat)this.drawColumnData(e);else for(var f=WebSquare.format.createFormatter(n.options.dataType,i,"",h,null,null,this.scope_id,this.id),m=0;m<this.getRowCount();m++){var y=this.dataList._getCellData(m,n.colID),b=f.format(y);this.dataList.__setCellData(m,n.colID,b)}}else this.drawColumnData(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnEditFormat=function(t,e){try{t=this.getColumnIndex(t);var i=this.getCellInfo(t),o=i.id,r=i.options.inputType;if("text"!=r&&"input"!=r)return $l("Invalid cell input type."),!1;var a=this.getInput(i);if(a&&a.options&&"input"===a.options.pluginName){i.options.editFormat=e,a.setEditFormat(e);for(var n=this.getTotalRow(),l=0;l<n;l++){var h=this.dataList.getCellData(l,o),d=WebSquare.text.dynamicMask(h,a._editFormat,a._editTokens);this.dataList.setCellData(l,o,d.orgValue)}this.drawColumnData(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnChooseOption=function(t,e,i){try{var o=this.getCellInfo(t);"select"==o.options.inputType&&o.setColumnChooseOption(e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnVisibleColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setVisibleColumn&&o[o.options.inputType].setVisibleColumn(e,i))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnEnableColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setEnableColumn&&o[o.options.inputType].setEnableColumn(e,i))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDisplayMode=function(t,e){try{if("label"==e||"value"==e||"value delim label"==e||"label delim value"==e){var i=this.getCellInfo(t);if(!0==={select:!0,checkcombobox:!0,autoComplete:!0}[i.options.inputType]){var o=i.options.displayMode;i.options.displayMode=e,i._initDisplayMode(),
o!=i.options.displayMode&&(i[i.options.inputType]&&i[i.options.inputType].setDisplayMode(e),i.resetMatchInfo=!0,this.drawColumnData(t))}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDelimiter=function(t,e){try{var i=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[i.options.inputType]&&i.options.delimiter!=e&&(i.options.delimiter=e||"\t","0"!=i.options.displayMode&&"3"!=i.options.displayMode&&(i[i.options.inputType]&&i[i.options.inputType].setDelimiter(e),i.resetMatchInfo=!0,this.drawColumnData(t)))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.showChooseOption=function(t,e){try{var i=this.getCellInfo(t);"select"==i.options.inputType&&i.showChooseOption(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setRowNumColumnWidth=function(t){this.options.rowNumVisible&&!isNaN(Number(t))&&this._setColumnWidth(0,t)},A.prototype.setRowStatusColumnWidth=function(t){var e=0;this.options.rowNumVisible&&(e=1),this.options.rowStatusVisible&&(this.options.autoFit&&!this.hiddenList[e]?(this.autoFitColWidthList=null,this._setColumnWidth(e,t),this._setAutoFit()):this._setColumnWidth(e,t))},A.prototype.setGridHeight=function(t){try{parseInt(t)+""==t&&(t+="px"),this._setGridHeightBefore(),this.setStyle("height",t);var e=document.getElementById(this.id+"_dataLayer");this.dataLayerHeight=e.offsetHeight,this.handleScrollY({},{changedHeight:!0}),this.handleResize(),this._setGridHeightAfter()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setGridHeightBefore=function(t){try{this._onSetHeight=!0,this.lastTopRowIndex=null,-1!==this.options.initFixedHeightByRowNum&&(this.options.initFixedHeightByRowNum=-1,!0!==this._isNativeScroll()&&(this.options.visibleRowNum=""))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setGridHeightAfter=function(t){try{this._onSetHeight=!1}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setGridWidth=function(t){parseInt(t)+""==t&&(t+="px"),this.setStyle("width",t),this.handlerResize_drawInitializer()},A.prototype.setGridSize=function(t,e){var i=parseInt(t),o=parseInt(e);i>=0&&o>=0?(this.setGridWidth(t),this.setGridHeight(e)):c.v.printLog("[Warning] Number of Entered in the width and height must be a valid integer greater than 0.["+this.id+"]")},A.prototype.setGridReadOnly=function(t){try{t=a.Z.getBoolean(t),this.options.readOnly=t,this.notifyDataChanged()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getGridReadOnly=function(){try{return this.options.readOnly}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.initGrid=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.removeAllFinish=!0,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1;var t=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:t,row:{},init:!1},this.clearCellVisible({skipDraw:!0}),this.initHeightCompleted=!1,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj();var e=this.dataList.removeAll();return this.removeAllFinish=!1,this.dataList.clearFilter(),this.initColumns(),e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setInitValue=function(){try{this.initGrid()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);return i.element&&i.element.setAttribute("displayFormat",e),i.options.displayFormat=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setFormat=function(t,e){try{var i=this.getCellInfo(t);if(e.ioFormat){var o=i.mainGridId+i.id,r=this.dom[o];r&&r.setFormat({ioFormat:e.ioFormat,displayFormat:e.ioFormat})
;for(var a=WebSquare.format.createFormatter("date",e.ioFormat,"",i.options.ioFormat,null,null,this.scope_id,this.id),n=0;n<this.getDataLength();n++){var l=this.getColumnID(t),h=this.dataList._getCellData(n,l),d=a.format(h);this.dataList.__setCellData(n,l,d)}}return i.options.ioFormat=e.ioFormat||i.options.ioFormat,i.options.displayFormat=e.displayFormat||i.options.displayFormat,i.options.displayFormatter=e.displayFormatter||i.options.displayFormatter,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCustomFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.customFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setAllowChar=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o)return $l("Invalid cell input type."),!1;var r=this.getInput(i);return i.options.allowChar=e,void(r&&r.options&&("input"===r.options.pluginName||"textarea"===r.options.pluginName)&&r.setAllowChar(e))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setIgnoreChar=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o)return $l("Invalid cell input type."),!1;var r=this.getInput(i);return i.options.ignoreChar=e,void(r&&r.options&&("input"===r.options.pluginName||"textarea"===r.options.pluginName)&&r.setIgnoreChar(e))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.changeCurrency=function(t,e,i,o,r,a,n){try{return 1===arguments.length&&"object"===(0,l.A)(arguments[0])?this._changeCurrency(arguments[0]):this._changeCurrency({colID:t,type:e,format:i,delimiter:o,decimalDelimiter:r,customModelFormatter:a,customModelUnformatter:n})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._changeCurrency=function(t){try{var e=t.colID||"",i=t.type||"",o=t.format,n=t.delimiter||"",l=t.decimalDelimiter||"",h=t.subtotalColID||"",d=t.footerColID||"",u=t.customModelFormatter,p=t.customModelUnformatter,c=WebSquare.util.getDataPrefix("dataType"),g=WebSquare.util.getDataPrefix("displayFormat"),f=this.getColumnIndex(e),m=this.getCellInfo(f);if(!i||"float"!==i&&"number"!==i&&"euro"!==i&&"rupee"!==i&&"tenge"!==i)return;"number"===i&&"true"===this.options.floatNumber&&(i="float");var y=i;switch(i){case"number":case"float":case"bigDecimal":y="number",o||(this.options.numberMask||(this.options.numberMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/numberMask/@value')||""),o=this.options.numberMask),m.options.delimiter=n||",",m.options.decimalDelimiter=l||".";break;case"euro":o||(this.options.euroMask||(this.options.euroMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/euroMask/@value')||""),o=this.options.euroMask),m.options.delimiter=n||".",m.options.decimalDelimiter=l||",";break;case"rupee":o||(this.options.rupeeMask||(this.options.rupeeMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/rupeeMask/@value')||""),o=this.options.rupeeMask),m.options.delimiter=n||",",m.options.decimalDelimiter=l||".";break;case"tenge":o||(this.options.tengeMask||(this.options.tengeMask=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/tengeMask/@value')||""),o=this.options.tengeMask),m.options.delimiter=n||" ",m.options.decimalDelimiter=l||","}if(!o)return;if(m.options.dataType=i,m.options.displayFormat=o,void 0!==u?m.options.customModelFormatter=u:m.options.customModelFormatter||(m.options.customModelFormatter=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/customModelFormatter/@value')||""),
void 0!==p?m.options.customModelUnformatter=p:m.options.customModelUnformatter||(m.options.customModelUnformatter=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+y+'"]/customModelUnformatter/@value')||""),m.initFormatter(),this.drawColumnData(f),this.hasSubtotal){this.subtotalObj={};var b=h.split(",");if(b.length>0)for(var v=0;v<b.length;v++){var w=b[v];for(var C in this.subtotalTableList)for(var I=this.subtotalTableList[C],_=!1,x=0;x<I.rows.length;x++){for(var S=I.rows[x].getElementsByTagName("td"),R=0;R<S.length;R++){var D=S[R];if(D.getAttribute("id")===w&&(D.setAttribute(c,i),D.setAttribute(g,o),_=!0),_)break}if(_)break}}this.refreshSubtotalRow(0)}if(this.hasFooter){var T=d.split(",");if(T.length>0)for(v=0;v<T.length;v++){var L=T[v],k=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),F=a.Z.getDataPrefix("footer_id");for(x=0;x<k.length;x++){var A=k[x];if(A.getAttribute(F)===L){A.setAttribute(c,i),A.setAttribute(g,o);break}}}this.initFooterDataObj(),this.drawFooter(f)}var E=m.mainGridId+m.id;delete this.dom[E]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDataType=function(t,e,i){try{if(!e||"number"!=e&&"text"!=e&&"float"!=e&&"date"!=e)return;var o=this.getCellInfo(t);if(o.options.dataType==e)return;o.options.dataType;o.options.dataType=e;var r=this.getColumnID(t);this.setColumnOption(r,"dataType",e);var a=o.mainGrid.getElementById(o.mainGridId+r);if(o.options.displayFormat="",a){switch(a.validator.clearCommand(),e){case"number":a.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9"));break;case"float":a.validator.addCommand(new WebSquare.validator.floatCommand(a.options.delimiter,a.options.decimalDelimiter,a.options.applyFormat))}var n=a.options.maxlength&&parseInt(a.options.maxlength)>-1?a.options.maxlength:null;n||(n=a.options.maxLength&&parseInt(a.options.maxLength)>-1?a.options.maxLength:null),n&&("float"==e?(o.setFloatMaxLength(n),a.render&&"input"==a.render.tagName.toLowerCase()&&a.render.removeAttribute("maxLength")):o.setMaxLength(n))}o.initFormatter(),o._changeDisplayFormat=!0,i&&i.displayFormat&&this.setColumnDisplayFormat(t,i.displayFormat),o.mainGrid.refreshColumn(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDefaultDate=function(t,e){try{var i=this.getCellInfo(t);if("calendar"!==i.options.inputType)return $l("Invalid cell input type."),!1;var o=this.getInput(i);i.options.defaultDate=e,o&&o.setDefaultDate(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.disableBeforeDate=function(t,e){this.setDisableBeforeDate(t,e)},A.prototype.setDisableBeforeDate=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableBeforeDate(e)}else(i=this.getInput(o))&&i.setDisableBeforeDate(e);o.options.disableBeforeDate=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.disableAfterDate=function(t,e){this.setDisableAfterDate(t,e)},A.prototype.setDisableAfterDate=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableAfterDate(e)}else(i=this.getInput(o))&&i.setDisableAfterDate(e);o.options.disableAfterDate=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDisableBeforeMonth=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength]
;a&&(i=this.getInput(o,a))&&i.setDisableBeforeMonth(e)}else(i=this.getInput(o))&&i.setDisableBeforeMonth(e);o.options.disableBeforeMonth=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDisableAfterMonth=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var r=0;r<this.drawedRowLength;r++){var a=this.data_td_list[t+r*this.oneRowDataLength];a&&(i=this.getInput(o,a))&&i.setDisableAfterMonth(e)}else(i=this.getInput(o))&&i.setDisableAfterMonth(e);o.options.disableAfterMonth=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setMaxLength=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"textarea"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o&&"autoComplete"!=o)return;"text"==o&&"float"==i.options.dataType?i.setFloatMaxLength(e):i.setMaxLength(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getMaxLength=function(t){try{var e=this.getCellInfo(t),i=e.options.inputType;if("text"!=i&&"textarea"!=i&&"input"!=i&&"textImage"!=i&&"secret"!=i)return;return e.options.maxLength}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.spanAll=function(t){try{"number"==typeof t?this.showDepth=t+"":(t=a.Z.getBoolean(t),this.showDepth=1==t?"9999":"1"),this.initDrilldown(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.drawData(0,0),this.setScrollYHeight({noDraw:!0}),this.drawFooter(),this.displayNoResultMessage(),this.displayFixedColumnLine()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCellDisplayData=function(t,e){try{var i=(this._linkedDataList||this._dataList).getRealRowIndex(t);return this._getDisplayData(i,e)}catch(t){s.Y.printStackTrace(t)}},A.prototype._getCellDisplayData=function(t,e,i){try{i=i||{},"string"==typeof e&&(e=e.trim());var o=this.getRealRowIndex(t);return this._getDisplayData(o,e,i)}catch(t){s.Y.printStackTrace(t)}},A.prototype._getDisplayData=function(t,e,i){try{i=i||{},this.editEndBeforeGetData();e=this.getColumnID(e);var o=this.getColumnIndex(e),r=this.cellInfoHash[e];0==r.internal&&"custom"==r.options.inputType&&r.cellManagerHashByRowIndex[t]&&(r=r.cellManagerHashByRowIndex[t]);var n=this.dataList._getData(t,e),l=this.getDisplayRowIndex(t),h=this._getGroupbyDisplayRowIndex(l);if(r.options.customModelUnformatter){var d=a.Z.getGlobalFunction(r.options.customModelUnformatter,this.scope_id);"function"==typeof d&&(n=d.call(this,n,h,o))}if(r.options.maskFormat&&r.options.displayFormat&&(n=this.getInput(r[o]).maskFormatModelUnFormat(n)),r.useEscapeFormatter){var u=a.Z.getGlobalFunction(r.options.escapeFormatter,this.scope_id);"function"==typeof u&&(n=u.call(this,n,h,o))}if(r.useCustomFormatter&&1!=this.options.keepBeforeDisplayData){var p="true"===r.getEscape()?r.getDisplayData(WebSquare.xml._encode(n+""),t):r.getDisplayData(n,t),c=a.Z.getGlobalFunction(r.options.customFormatter,this.scope_id);"function"==typeof c&&(n=this.options.customFormatterRealRowIndex?c.call(this,n,p,t,o):c.call(this,n,p,h,o))}else 0==r.internal&&"custom"==r.options.inputType&&(r=r.cellManagerHashByRowIndex[t]?r.cellManagerHashByRowIndex[t]:r),n=r.getDisplayData(n,t,i);if(!0===i.removeTag){var g=document.createElement("div");g.innerHTML=n,n=g.innerText}return null==n&&(n=""),n}catch(t){s.Y.printStackTrace(t)}},A.prototype.initPasteDrilldown=function(){try{var t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""};"string"==typeof t.depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.pasteDrilldownInitialize(this,t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.initDrilldown=function(t){try{"string"==typeof(t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""
}).depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.initialize(this,t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getRealRowIndex=function(t){return this.dataList.getRealRowIndex(t)},A.prototype.toggle=function(t){try{if("number"!=typeof t)return!1;var e=t;if(this.options.drilldownRealRowIndexAll&&"number"!=typeof(e=this.getDisplayRowIndex(t)))return!1;this._toggle(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._toggle=function(t){try{t=parseInt(t),this.drilldown.toggle(t);var e={};this.options.drilldownToggleScrollFix&&(e.keepScrollTop=!0),this.lastTopRowIndex=null,!0===this._isHybridScroll()?this.hasSubtotal&&(e.keepHybridHash=!0):this.setScrollYHeight(e),this.notifyRowChanged(t,e),this.options.autoFit&&this.autoFitFunc()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.toggles=function(t){try{if("object"!=(0,l.A)(t)||t.constructor!=Array)return!1;for(var e=0;e<t.length;e++){var i=t[e];this.options.drilldownRealRowIndexAll&&"number"!=typeof(i=this.getDisplayRowIndex(i))||(i=parseInt(i),this.drilldown.toggle(i))}this.refresh()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.drillTo=function(t){try{var e=this.drilldown.drillTo(t),i=this.options.drilldownToggleScrollFix?{keepScrollTop:!0}:null;this.setScrollYHeight(i),this.notifyRowChanged(e,i),this.options.autoFit&&this.autoFitFunc()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getParentRowIndex=function(t){return t=parseInt(t),this.drilldown.getParentRowIndex(t)},A.prototype.getChildrenRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildrenRowArr(t)},A.prototype.getAncestorRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getAncestorRowArr(t)},A.prototype.getDescendantRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildRowArr(t,!0)},A.prototype.getOpenStatus=function(t){var e=t=parseInt(t);return(!this.options.drilldownRealRowIndexAll||"number"==typeof(e=this.getDisplayRowIndex(t)))&&this.drilldown.isOpen(e)},A.prototype.getDataLength=function(){var t;if(this.successBinding)if(this.groupbyStatus.grouped){for(var e in this.customFilterStatusObj)if(this.customFilterStatusObj[e])return this._dataList.getDataLength();t=this.groupbyStatus.groupedRowIndexArr.length}else t=this._dataList.getDataLength();else t=0;return t},A.prototype.focusedRowMoveUp=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUp(t)},A.prototype.focusedRowMoveDown=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDown(t)},A.prototype.focusedRowMoveUpFiltered=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUpFiltered(t)},A.prototype.focusedRowMoveDownFiltered=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDownFiltered(t)},A.prototype.initStyleArr=function(t){t<=0&&(this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[]);var e=this.getTotalRow(),i=e*this.oneRowDataLength;this.rowStyleArr[e-1]=void 0,this.rowStyleFixedArr[e-1]=void 0,this.rowStyleDataArr[e-1]=void 0,this.rowReadOnlyArr[e-1]=void 0,this.rowDisabledArr[e-1]=void 0,this.rowClassArr[e-1]=void 0,this.cellStyleArr[i-1]=void 0,this.cellClassArr[i-1]=void 0,this.cellReadOnlyArr[i-1]=void 0,this.cellDisabledArr[i-1]=void 0,this._cellSelectedIndex[i-1]=void 0},A.prototype.modifyCheckedStatus=function(t,e){try{var i=this.getCheckedIndex(t);if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else c.v.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.modifyUncheckStatus=function(t,e){try{if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){
for(var i=this.getUnCheckedIndex(t),o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else c.v.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getVisibleColData=function(t){var e=[];t=this.getColumnIndex(t);for(var i=this.getColumnID(t),o=this.getDataLength(),s=0;s<o;s++)e.push(this.dataList._getCellData(s,i));return e},A.prototype.getCheckedIndex=function(t,e){try{var i,o=[],r=[],a=0,n=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==n.options.inputType||"radio"==n.options.inputType||"custom"==n.options.inputType){i=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var h=n,d=0;d<i.length;d++){if(0==n.internal&&"custom"==n.options.inputType){var u=this.dataList.getRealRowIndex(d);if("checkbox"!=(h=n.cellManagerHashByRowIndex[u]?n.cellManagerHashByRowIndex[u]:n).options.inputType&&"radio"!=h.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==(0,l.A)(this.dataList.getRealRowIndex(d)))continue;if(e){r.push(d);var p=!(!this.isDrillDown||!this._dataList.options.depthColumn);this.___getEditReadOnly(d,t,p)||this._getEditDisabled(d,t,p)?a++:i[d]==h.options.trueValue&&o.push(d)}else i[d]==h.options.trueValue&&o.push(d)}}return e&&a!==r.length&&a+o.length==r.length?r:o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getUnCheckedIndex=function(t){return this.getUncheckedIndex(t)},A.prototype.getUncheckedIndex=function(t){try{var e=[],i=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==i.options.inputType||"radio"==i.options.inputType||"custom"==i.options.inputType){var o=[];o=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var r=i,a=0;a<o.length;a++){if(0==i.internal&&"custom"==i.options.inputType){var n=this.dataList.getRealRowIndex(a);if("checkbox"!=(r=i.cellManagerHashByRowIndex[n]?i.cellManagerHashByRowIndex[n]:i).options.inputType&&"radio"!=r.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==(0,l.A)(this.dataList.getRealRowIndex(a)))continue;o[a]!=r.options.trueValue&&e.push(a)}}return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getAllDisplayData=function(){try{var t=this._linkedDataList||this._dataList;if(t.getTotalRow()==t.getDataLength())return this.getAllVisibleData("displayData");this._endEdit();for(var e=this.getTotalRow(),i=this.getColumnCount(),o=[],r=0;r<e;r++)for(var a=0;a<i;a++)o.push(this._getDisplayData(r,a));return o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getAllDisplayJSON=function(t){try{t||(t={emptyValue:"$$_blank_"});var e=this._linkedDataList||this._dataList;if(e.getTotalRow()==e.getDataLength())return this.getAllVisibleJSON(t);this._endEdit();for(var i=this.getTotalRow(),o=this.getColumnCount(),r=[],a=0;a<i;a++){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._getDisplayData(a,l,t);r.push(n)}return r}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getAllVisibleJSON=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),r=[],a=0;a<i;a++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[a]){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._grid._getCellDisplayData(a,l,t);r.push(n)}return r}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getAllDisplayXML=function(){try{var t=this._linkedDataList||this._dataList;return t.getTotalRow()==t.getDataLength()?this.getAllVisibleXML("displayData"):(this._endEdit(),this.getAllArrXML("displayData",this.id))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getAllVisibleXML=function(t){try{this._endEdit()
;for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=[],r=0;r<i;r++)e&&"number"!=typeof this.groupbyStatus.groupedRowIndexArr[r]||o.push(r);return this.getArrXML(o,t,e)}catch(t){s.Y.printStackTrace(t)}},A.prototype.getAllVisibleData=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),r=[],a=0;a<i;a++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[a])for(var n=0;n<o;n++)"displayData"===t?r.push(this._getCellDisplayData(a,n)):r.push(this.dataList.getCellData(a,n));return r}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.changeToRealRowIndexArr=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCheckedXML=function(t){try{this._endEdit();var e=this.getCheckedIndex(t);return this.getArrXML(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getUncheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getUncheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getUncheckedXML=function(t){try{this._endEdit();var e=this.getUncheckedIndex(t);return this.getArrXML(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCellChecked=function(t,e){try{var i=this.cellInfoHash[this.getColumnID(e)],o=i.id;if(0==i.internal&&"custom"==i.options.inputType){var r=this.dataList.getRealRowIndex(t);i=i.cellManagerHashByRowIndex[r]?i.cellManagerHashByRowIndex[r]:i}if("checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)return!1;var a=this.dataList._getCellData(t,o);return a=a==i.options.trueValue}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.hasChild=function(t){return this.drilldown.hasChild(t)},A.prototype.comparator=function(t,e){return parseInt(e)==parseInt(t)?0:parseInt(e)>parseInt(t)?1:-1},A.prototype.getExcelAllXML=function(t){try{var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=0;i<this.getDataLength();i++)for(var o=0;o<this.getTotalCol();o++)e.push(this.dataList._getCellData(i,this.getColumnID(o))),e.push('","');return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getExcelAllXMLDisplay=function(t){try{null==t&&(t=1);var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=this.getDataLength(),o=this.getColumnCount(),r=0;r<i;r++)for(var a=0;a<o;a++){var n,l=this.getCellInfo(a);if("custom"==l.options.inputType){var h=this.dataList.getRealRowIndex(r);l.cellManagerHashByRowIndex[h]||(this.drawData(r),l=l.cellManagerHashByRowIndex[h]||l)}(n=l.useCustomFormatter||"custom"==l.options.inputType?this._getDisplayData(this.dataList.getRealRowIndex(r),a):1==t?l.getDisplayData(this.dataList._getCellData(r,this.getColumnID(a)),r):this.dataList._getCellData(r,this.getColumnID(a))+"").indexOf("javascript:")>-1&&(n=n.wq_replaceAll("javascript:","")),e.push(n),e.push('","')}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getExcelAllXMLRaw=function(t){try{var e=this.dataArr.length,i=this.dataArr[0],o=this.dataArr[e-1]
;this.dataArr[0]='<array><![CDATA[["'+i,this.dataArr[e-1]=o+'"]]]></array>';var r=this.dataArr.join('","');return this.dataArr[0]=i,this.dataArr[e-1]=o,r}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.makeExcelData=function(t,e,i,o){try{var n=e.length,l=t+i.rowsByN;l=l<i.dataLength?l:i.dataLength;var h,d=this.oneRowDataLength,u=i.separator||",";if(i.convertIndex&&(h=i.convertIndex.split(",")),""==i.dataProvider&&""==i.splitProvider)if(0===i.type)for(var p=t;p<l;p++){if("number"==typeof(b=this.dataList.getRealRowIndex(p)))for(var c=0;c<d;c++){var g=!1;if(h)for(var f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelDisplayData(b,c,e,i,p)).length:(e=this._getExcelRealData(b,c,e,i)).length}}else if(1===i.type||2==i.type)for(p=t;p<l;p++){if("number"==typeof(b=this.dataList.getRealRowIndex(p)))for(c=0;c<d;c++){g=!1;if(h)for(f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelRealData(b,c,e,i)).length:(e=this._getExcelDisplayData(b,c,e,i,p)).length}}else l=i.dataLength,n=(e=this.dataList.getAllData()).length;var m=this;if(l<i.dataLength&&""==i.dataProvider&&""==i.splitProvider)if(!1!==i.massStorage)this.excelTime=setTimeout((function(){try{!0===i.showConfirm&&window.gridExceldownloadIframe.contentWindow.checkUpload(e.length/m.dataArr.length)}catch(t){s.Y.printStackTrace(t,null,this)}if(0!=i.multiexcel)return m.makeExcelData(l,e,i,o);m.makeExcelData(l,e,i,o)}),10);else{if(0!=i.multiexcel)return this.makeExcelData(l,e,i,o);this.makeExcelData(l,e,i,o)}else{var y;if(""==i.dataProvider&&""==i.splitProvider)if(e.length>=2){if(i.groupby&&this.groupbyStatus.grouped&&this.defaultColCnt>0){var b=1,v=this.oneRowDataLength,w=[];for(p=0;p<e.length;p++){if((p%v==0||0==p)&&(b=parseInt(p/v,10),this.options.rowNumVisible&&w.push(b+1),this.options.rowStatusVisible)){var C=this.getRowStatus(b);w.push(C)}w.push(e[p])}n=(e=w).length}if(n>0){var I=e[0],_=e[n-1];e[0]='<array><![CDATA[["'+I,e[n-1]=_+'"]]]></array>',y=e.join('"'+u+'"'),e[0]=I,e[n-1]=_}else y="<array><![CDATA[["+e+"]]]></array>"}else{y="<array><![CDATA[["+(1===e.length?'"'+e[0]+'"':"")+"]]]></array>"}else y="<array><![CDATA[[ ]]]></array>";if(!0===i.showConfirm)this.excelOptions=i,this.excelInfoArr=o,this.excelFinalStr=y,this.checkUpload();else{if(0!=i.multiexcel)return this.sendExcelData(i,o,y);this.sendExcelData(i,o,y)}}}catch(t){var x=r.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/excel/download/errorHandler/@value"),S=a.Z.getGlobalFunction(x,this.scope_id);"function"==typeof S&&S.call(this,this.id),s.Y.printStackTrace(t,null,this)}},A.prototype._getExcelRealData=function(t,e,i,o){try{var r=o.cellInfo,a=o.isExpCol,n=i;if(a[e])n.push(r[e].getExpressionValue(t));else{var l=this.dataList._getData(t,e);n.push(null!=l?l:"")}return n}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getExcelDisplayData=function(t,e,i,o,r){try{var a,n=o.cellInfo,l=o.isSelectCol,h=o.isBasicCol,d=o.isExpCol,u=o.isCustomCol,p=o.isCustomModelCol,c=o.isCustomType,g=o.isEscapeFormatter,f=i;if(d[e]&&(a=n[e].getExpressionValue(t)),u[e]||p[e]||g[e]?a=this._getDisplayData(t,e):(a=this.dataList._getData(t,e),n[e].options.useMonthYearFormat&&"calendar"===n[e].options.inputType&&(a=WebSquare.date.getIOFormatDate(a,n[e].options.ioFormat,n[e].options.calendarValueType)),a=null!=a?a:""),h[e]||d[e])n[e].options.maskFormat&&n[e].options.displayFormat&&(a=this.getInput(n[e]).maskFormatModelUnFormat(a)),a=n[e].formatter?n[e].formatter.format(a):a;else if(!l[e]||u[e]||p[e]){if(c[e]){x=null;var m,y=n[e].cellManagerHashByRowIndex[r];y?m=(n=y).options.inputType:(n=n[e],m="text");var b=n.useCustomFormatter,v=n.useCustomModelFormatter,w=n.useEscapeFormatter,C="select"===m||"checkcombobox"===m||"autoComplete"===m,I="expression"===m,_=!("checkbox"===m||"image"===m||"radio"===m||C||I||b||v||w);if(b||v||w?a=this._getDisplayData(t,e):(a=this.dataList._getData(t,e),
n.options.useMonthYearFormat&&"calendar"===n.options.inputType&&(a=WebSquare.date.getIOFormatDate(a,n.options.ioFormat,n.options.calendarValueType)),a=null!=a?a:""),_||I)n.options.maskFormat&&n.options.displayFormat&&(a=this.getInput(n).maskFormatModelUnFormat(a)),a=n.formatter?n.formatter.format(a):a;else if(C&&!b&&!v){x=null;null==(x=2==o.type?this.dataList._getData(t,e):n.getData(a,t))&&(x=""),a=x}}}else{var x=null;if(2==o.type)x=this.dataList._getData(t,e);else{var S=n[e].dataComp,R=t;if(S){var D=this.modelControl.getDataComp(S);D&&"linkedDataList"===D.initializeType&&(R=r)}x=n[e].getData(a,R)}null==x&&(x=""),a=x}return"string"==typeof a&&a.indexOf("javascript:")>-1&&(a=a.wq_replaceAll("javascript:","")),f.push(a),f}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getStyleRowIndex=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);return null==e?e=null:"number"!=typeof e&&(e=e.type+"_"+e.groupId),e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getRowStyleClassName=function(t,e){try{var i=e?t:this._getStyleRowIndex(t);return null==i?null:this.rowStyleArr[i]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setRowStyleClassName=function(t,e,i){try{var o=i?t:this._getStyleRowIndex(t);if(null==o)return;this.rowStyleArr[o]=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCellStyleClassName=function(t,e,i){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var o=i?t:this._getStyleRowIndex(t);return null==o?void 0:"number"==typeof o?this.cellStyleArr[o*this.oneRowDataLength+e]:this.cellStyleArr[o+"_"+e]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellStyleClassName=function(t,e,i,o){try{e=this.getColumnIndex(e);var r=o?t:this._getStyleRowIndex(t);if(null==r)return;"number"==typeof r?this.cellStyleArr[r*this.oneRowDataLength+e]=i:this.cellStyleArr[r+"_"+e]=i}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getCellClass=function(t,e){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var i=this._getStyleRowIndex(t);return null==i?void 0:"number"==typeof i?this.cellClassArr[i*this.oneRowDataLength+e]:this.cellClassArr[i+"_"+e]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellDefaultStyleClassName=function(t,e,i){try{e=this.getColumnIndex(e);var o=this.getCellStyleClassName(t,e,i);return null==o&&(this.cellStyleIndex++,o=this.id+"_cellstyle_"+this.cellStyleIndex+"_",this.setCellStyleClassName(t,e,o,i)),null==this.cellStyleValueObj[o]&&(this.cellStyleValueObj[o]={}),o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellClass=function(t,e,i,o){try{var r,a;e=this.getColumnIndex(e);var n,l=!(!this.isDrillDown||!this._dataList.options.depthColumn);if(o?(r=t,a=this.getDisplayRowIndex(t)-this.rowIndex):(r=this._getStyleRowIndex(t),a=l?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex),a>=0&&(n=this.data_td_list[a*this.oneRowDataLength+e]),null==r)return;if("number"==typeof r){var h=this.tdCellClassArr[a*this.oneRowDataLength+e];h&&this.removeClass(n,h),this.cellClassArr[r*this.oneRowDataLength+e]=i}else this.cellClassArr[r+"_"+e]=i;n&&(this.tdCellClassArr[a*this.oneRowDataLength+e]=i,this.addClass(n,i))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.removeCellClass=function(t,e,i){try{e=this.getColumnIndex(e);var o,r=this._getStyleRowIndex(t);if(o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex,null==r)return;"number"==typeof r?this.cellClassArr[r*this.oneRowDataLength+e]=void 0:this.cellClassArr[r+"_"+e]=void 0;var a=this.data_td_list[o*this.oneRowDataLength+e];a&&(i||(i=this.tdCellClassArr[o*this.oneRowDataLength+e]),this.tdCellClassArr[o*this.oneRowDataLength+e]=void 0,this.removeClass(a,i))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._removeAllTDCellClass=function(){try{for(var t=this.tdCellClassArr.length,e=0;e<t;e++){var i=this.tdCellClassArr[e],o=this.data_td_list[e]
;o&&i&&this.removeClass(o,i)}this.tdCellClassArr=[]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setColumnClass=function(t,e){try{var i=this.getColumnIndex(t);if(this.columnClassObj[i]){var o=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim();this.columnClassObj[i]=o+" "+e}else this.columnClassObj[i]=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._setColumnClass(t,i[o]);for(o=this.getColumnIndex(t);o<this.data_td_list.length;o+=this.oneRowDataLength){var r=this.data_td_list[o];r&&this.addClass(r,e)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._removeColumnClass=function(t,e){try{var i=this.getColumnIndex(t);this.columnClassObj[i]=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim(),this.columnClassObj[i]||delete this.columnClassObj[i];for(var o=i;o<this.data_td_list.length;o+=this.oneRowDataLength){var r=this.data_td_list[o];r&&this.removeClass(r,e)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.removeColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._removeColumnClass(t,i[o])}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getColumnClass=function(t){try{var e=this.getColumnIndex(t);return this.columnClassObj[e]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._refreshColumnClass=function(){try{for(var t in this.columnClassObj)this.setColumnClass(this.columnClassObj[t])}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setRowClass=function(t,e,i){try{var o,r,a,n=!(!this.isDrillDown||!this._dataList.options.depthColumn);if(i?(o=t,r=this.getDisplayRowIndex(t)-this.rowIndex):(o=this._getStyleRowIndex(t),r=n?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex),r>=0&&(a=this.data_td_list[r*this.oneRowDataLength]),e){var l=e.split(" ").filter((function(t){return t}));l.length>1&&(e=l.join(" "))}if(null==o)return;if("number"==typeof o){var h=this.trRowClassArr[r];h&&this.removeClass(a.parentNode,h),this.rowClassArr[o]=e}else this.rowClassArr[o]=e;a&&(this.trRowClassArr[r]=e,this.addClass(a.parentNode,e))}catch(t){$l("setRowClass :"+t.message),s.Y.printStackTrace(t,null,this)}},A.prototype.removeRowClass=function(t,e){try{var i,o,r=this._getStyleRowIndex(t),a=this.rowClassArr[r];if(!a)return;if(i=!(!this.isDrillDown||!this._dataList.options.depthColumn)?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex,e&&(o=e.split(" ").filter((function(t){return t})),a=this._removeClassName(a,o)),null==r)return;this.rowClassArr[r]=e?a:void 0;var n=this.data_td_list[i*this.oneRowDataLength];if(n)if(this.trRowClassArr[i]=e?a:void 0,o)for(var l=0;l<o.length;l++)this.removeClass(n.parentNode,o[l]);else this.removeClass(n.parentNode,a)}catch(t){$l("removeRowClass :"+t.message),s.Y.printStackTrace(t,null,this)}},A.prototype._removeClassName=function(t,e){try{for(var i=t.split(" ").filter((function(t){return t})),o=[],r=0;r<i.length;r++)e.indexOf(i[r])<0&&o.push(i[r]);return o.join(" ")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._removeAllTRClass=function(){try{for(var t=this.trRowClassArr.length,e=0;e<t;e++){var i=this.trRowClassArr[e],o=this.data_td_list[e*this.oneRowDataLength];o&&i&&this.removeClass(o,i)}this.trRowClassArr=[]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getRowStyleFixedClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleFixedArr[e]}catch(t){$l("getRowStyleFixedClassName :"+t.message),s.Y.printStackTrace(t,null,this)}},A.prototype.setRowStyleFixedClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleFixedArr[i]=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getRowStyleDataClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleDataArr[e]}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setRowStyleDataClassName=function(t,e){
try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleDataArr[i]=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.refreshColumnItemset=function(t){try{var e=this.getCellInfo(t);if(e.resetMatchInfo=!0,e.options.embeddedInput){t=this.getColumnIndex(e.options.col_id);for(var i=0;i<this.drawedRowLength;i++){var o=this.data_td_list[t+i*this.oneRowDataLength];if(o){var r=this.dom[o.getAttribute("id")+"_select"];r&&r.refreshItemset()}}}else"select"==e.options.inputType?(e.hasRef&&(e.refHash=[]),e.select&&e.select.refreshItemset(),e.itemsetObj&&e.mainGrid.refresh()):"checkcombobox"==e.options.inputType&&(e.refreshItemArr(),e.checkcombobox)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.refreshRadioGroup=function(t){try{for(var e={},i=[],o=0;o<this.oneRowDataLength;o++){"radio"==(l=this.getCellInfo(o)).options.inputType&&l.options.groupName==t&&(l.options.groupRef&&(l.options.groupValue=WebSquare.ModelUtil.getInstanceValue(l.options.groupRef,null,this.scope_id)),e[l.options.groupValue]=l,i.push(l))}if(0==i.length)return;var r=this.getDataLength();for(o=0;o<r;o++){var a=e[this.dataList._getCellData(o,t)];if(a)this.dataList.__setCellData(o,a.id,a.options.trueValue);else{for(var n=0;n<i.length;n++){var l=i[n];this.dataList.__setCellData(o,l.id,l.options.defaultValue)}var h=this.getCellInfo(t);h&&this.dataList.__setCellData(o,t,h.options.defaultValue)}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.resetRadioGroup=function(t,e){return this._resetRadioGroup.call(this,t,e,!0)},A.prototype._resetRadioGroup=function(t,e,i){try{for(var o=[],r=0;r<this.oneRowDataLength;r++){"radio"==(h=this.getCellInfo(r)).options.inputType&&h.options.groupName==e&&o.push(h)}if(0==o.length)return;if("number"==typeof t)var a=t,n=t+1;else a=0,n=this.getDataLength();for(r=a;r<n;r++){for(var l=0;l<o.length;l++){var h=o[l];this.dataList.__setCellData(r,h.id,h.options.defaultValue)}if(i){var d=this.getCellInfo(e);d&&this.dataList.__setCellData(r,e,d.options.defaultValue)}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.xmlData2ArrData=function(t,e,i){try{if(null==t)return;if(9==t.nodeType)r=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);else if(o=i&&i.baseNode?i.baseNode:this.options.baseNode,i&&i.isRepeatNode)r=(t=WebSquare.xml.parse(WebSquare.xml.serialize(t))).selectNodes("/"+i.repeatNode);else if(o.startsWith(t.tagName))var o=o.replace(t.tagName,"."),r=t.selectNodes(o+"/"+this.options.repeatNode);else t=WebSquare.xml.parse(WebSquare.xml.serialize(t)),r=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);for(var n=[],l=this.options.valueNode,h=null==l||""==l,d=a.Z.getTextNodeValue,u=r.length,p=this.tdIdList.length,c=[],g=[],f=[],m=0;m<p;m++){c[m]=this.getCellInfo(this.tdIdList[m]);var y=c[m].options;null!=y.importFormatter&&""!=y.importFormatter&&(g[m]=!0),null!=y.importExp&&""!=y.importExp&&(f[m]=!0)}for(m=0;m<u;m++){for(var b=m,v=r[m],w=n.length,C=0;C<p;C++){var I=r[m].selectSingleNode(this.tdIdList[C]);n[w+C]=null!=I?h?d(I):I.getAttribute(l):c[C].options.defaultValue}for(C=0;C<p;C++)if(g[C])try{var _=a.Z.getGlobalFunction(c[C].options.importFormatter,this.scope_id);"function"==typeof _&&(n[w+C]=_.call(this,v,b))}catch(t){n[w+C]=c[C].options.defaultValue,s.Y.printStackTrace(t,null,this)}for(C=0;C<p;C++)if(f[C])try{var x=new Function("_this","obfuscator_rowXml","return "+c[C].options.importExp)(this,v);n[w+C]=x}catch(t){n[w+C]=c[C].options.defaultValue,s.Y.printStackTrace(t,null,this)}for(C=0;C<p;C++){if("radio"==c[C].options.inputType&&c[C].options.groupName&&this.cellInfoHash[c[C].options.groupName]){var S=c[C].options.trueValue,R=c[C].options.falseValue;switch(c[C].options.valueType){case"binary":S="1",R="0";break;case"boolean":S="true",R="false"}this.columnValue(v,c[C].options.groupName)==c[C].options.groupValue?n[w+C]=S:n[w+C]=R}
this.options.xmlEncode&&null!=n[w+C]&&(n[w+C]=WebSquare.xml.decode(n[w+C]))}}return n}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.jsonData2ArrData=function(t){try{if(null==t)return;for(var e=[],i=t.length,o=this.cellIdList.length,r=[],n=0;n<o;n++)r[n]=this.getCellInfo(this.cellIdList[n]);for(n=0;n<i;n++)for(var l=n,h=t[n],d=e.length,u=0;u<o;u++)if(r[u].options.importFormatter)try{var p=a.Z.getGlobalFunction(r[u].options.importFormatter,this.scope_id);"function"==typeof p&&(e[d+u]=p.call(this,h,l))}catch(t){e[d+u]=r[u].options.defaultValue,s.Y.printStackTrace(t,null,this)}else if(r[u].options.importExp)try{var c=new Function("_this","obfuscator_rowXml","return "+r[u].options.importExp)(this,h);e[d+u]=c}catch(t){e[d+u]=r[u].options.defaultValue,s.Y.printStackTrace(t,null,this)}else{var g=t[n][this.cellIdList[u]];e[d+u]=null!=g?g:r[u].options.defaultValue}return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.xpathValue=function(t,e){try{var i=WebSquare.xml.findNode(t,e);if(null==i)return"";if(1!=i.nodeType)return i.nodeValue;for(var o=i.firstChild;null!=o;o=o.nextSibling)if(3==o.nodeType)return o.nodeValue}catch(t){$l("xpath exeption"),s.Y.printStackTrace(t,null,this)}return""},A.prototype.getAllArrXML=function(t){try{var e=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var i=0;i<this.tagNmArr.length;i++)if(null!=this.tagNmArr[i]&&""!=this.tagNmArr[i].wq_trim())if(e)r.push(o.createElement(this.tagNmArr[i])),r[i-1].appendChild(r[i]);else{var o=WebSquare.xml.parse("<"+this.tagNmArr[i]+"/>"),r=[];r.push(o.documentElement),e=!0}var n=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),l=null;for(i=0;i<this.getTotalRow();i++){var h=i;l=[];for(var d=null,u=0;u<n.length;u++)if(""!=n[u]){var p=o.createElement(n[u]);l.push(p),0==u?r[r.length-1].appendChild(p):l[u-1].appendChild(l[u])}(d=l[n.length-1]).setAttribute("status",this.dataList._getRowStatusValue(h)),d.setAttribute("statusValue",this.dataList._getRowStatus(h)),d.setAttribute("id",h);for(var c=this.getColumnCount(),g=new Array(c),f=0;f<c;f++){var m="";m="displayData"!=t?this._dataList._getData(h,f):this._getDisplayData(h,f),this.options.xmlEncode&&(m=WebSquare.xml.encode(m));var y=this.getColumnID(f),b=this.getCellInfo(f);if(""!=b.options.exportFormatter)try{var v=a.Z.getGlobalFunction(b.options.exportFormatter,this.scope_id);"function"==typeof v&&v(d,m,h,y)}catch(t){s.Y.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(g[f]=o.createElement(this.getColumnID(f)),""==this._dataList.options.valueAttribute){var w=o.createTextNode(m);g[f].appendChild(w)}else g[f].setAttribute(this._dataList.options.valueAttribute,m);d.appendChild(g[f])}}}return o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getArrXML=function(t,e,i){try{if(t instanceof Array){var o=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var r=0;r<this.tagNmArr.length;r++)if(null!=this.tagNmArr[r]&&""!=this.tagNmArr[r].wq_trim())if(o)l.push(n.createElement(this.tagNmArr[r])),l[r-1].appendChild(l[r]);else{var n=WebSquare.xml.parse("<"+this.tagNmArr[r]+"/>"),l=[];l.push(n.documentElement),o=!0}var h=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),d=null;for(r=0;r<t.length;r++){var u=t[r];d=[];for(var p=null,c=0;c<h.length;c++)if(""!=h[c]){var g=n.createElement(h[c]);d.push(g),0==c?l[l.length-1].appendChild(g):d[c-1].appendChild(d[c])}(p=d[h.length-1]).setAttribute("status",this.dataList.getRowStatusValue(u)),p.setAttribute("statusValue",this.dataList.getRowStatus(u)),!0===i?p.setAttribute("id",this._getGroupbyDisplayRowIndex(u)):p.setAttribute("id",u);for(var f=this.getColumnCount(),m=new Array(f),y=0;y<f;y++){var b="";"displayData"!=e?null==(b=this.dataList._getCellData(u,y))&&(b=""):null==(b=this._getCellDisplayData(u,y))&&(b=""),this.options.xmlEncode&&(b=WebSquare.xml.encode(b));var v=this.getColumnID(y),w=this.getCellInfo(y)
;if(""!=w.options.exportFormatter)try{var C=a.Z.getGlobalFunction(w.options.exportFormatter,this.scope_id);"function"==typeof C&&C(p,b,u,v)}catch(t){s.Y.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(m[y]=n.createElement(this.getColumnID(y)),""==this._dataList.options.valueAttribute){var I=n.createTextNode(b);m[y].appendChild(I)}else m[y].setAttribute(this._dataList.options.valueAttribute,b);p.appendChild(m[y])}}}return n}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getDisplayRowIndex=function(t){try{return(this._linkedDataList||this._dataList).getFilteredRowIndex(t)}catch(t){s.Y.printStackTrace(t)}},A.prototype.getOption=function(t){try{return this.options[t]}catch(t){s.Y.printStackTrace(t)}},A.prototype.getDataList=function(){try{var t=this._linkedDataList||this._dataList;return t?t.id:null}catch(t){s.Y.printStackTrace(t)}},A.prototype.getRowNumVisible=function(){try{return this.options.rowNumVisible}catch(t){s.Y.printStackTrace(t)}},A.prototype.makeCustomFilter=function(t){try{null!=this.customFilter&&this.customFilter.remove(),this.customFilter=new WebSquare.uiplugin.floatingLayer(this.id+"_customFilter",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter",useModal:!0,useModalStack:!0,frameModal:this.options.customFilterFrameModal+"",headerLeftClass:"w2grid_customFilter_HL",headerRightClass:"w2grid_customFilter_HR",headerCenterClass:"w2grid_customFilter_HC",bodyLeftClass:"w2grid_customFilter_BL",bodyRightClass:"w2grid_customFilter_BR",bodyCenterClass:"w2grid_customFilter_BC",bodyLeftBottomClass:"w2grid_customFilter_FL",bodyRightBottomClass:"w2grid_customFilter_FR",bodyBottomClass:"w2grid_customFilter_FC",closeButtonClass:"w2grid_customFilter_btnClose",_scope_obj_uuid:this.options._scope_obj_uuid,title:WebSquare.language.getMessage("Grid_filter_title")||"Custom Filter",titleClass:"w2grid_customFilter_title"});var e=new WebSquare.uiplugin.textbox(this.id+"_text1_"+this.headerID,{style:"position:absolute; margin:10px;",className:"w2grid_customFilter_text",label:WebSquare.language.getMessage("Grid_filter_search_label")||"Search criteria"});this.customFilter.addControl(e),this.selectboxItemSet=["=","<>",">",">=","<","<=",WebSquare.language.getMessage("Grid_filter_condition7")||"= (Metacharacter)",WebSquare.language.getMessage("Grid_filter_condition1")||"Starting character",WebSquare.language.getMessage("Grid_filter_condition2")||"Starting character to be excluded",WebSquare.language.getMessage("Grid_filter_condition3")||"Ending characters",WebSquare.language.getMessage("Grid_filter_condition4")||"Ending character to be excluded",WebSquare.language.getMessage("Grid_filter_condition5")||"Include",WebSquare.language.getMessage("Grid_filter_condition6")||"Exclude"],this._selectboxIgnoreOperatorItemSet=[">",">=","<","<="],this.customFilterItemCnt=0,this.groupList=[];var i=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute; width:100%; height:22px; margin-bottom:5px; background-color:transparent;"});this.customFilter.addControl(i),this.groupList.push(i);var o=this,r=new WebSquare.uiplugin.selectbox(i.id+"_selectbox_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",wheelRows:1,xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var t=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(t.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? matches any single character."),e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* matches matches zero or more characters."),o.setChildrenPosition(),o.customFilterMetacharPos|=1):(o.customFilterMetacharPos&=-2,o.customFilterMetacharPos<=0&&(t.setLabel(""),e.setLabel(""),o.setChildrenPosition()))}}}]});i.addControl(r)
;var n=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",l=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",d=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",u=new WebSquare.uiplugin.autoComplete(i.id+"_autocomplete_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,wheelRows:1,submenuSize:n,displayMode:l,searchTarget:d,delimiter:h});if(u.__setSelectedIndex1=u.setSelectedIndex1,u.setSelectedIndex1=function(t,e){u.__setSelectedIndex1(t,e);var i=u.getValue(),s=this.parentControl.id;if(s)var r=a.Z.getComponentById(s+"_selectbox_"+o.headerID);if(r){if(isNaN(i)){for(var n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);for(var l=r.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&r.setSelectedIndex(0)}else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}},i.addControl(u),"label"==l||"value delim label"==l||"label delim value"==l)for(var c=this.changeItemValue("label",this.targetColID,this.colDataList,!1),g=0;g<this.colDataList.length;g++){var f=void 0!==c[g]?c[g]:this.colDataList[g];u.addItem(f,this.colDataList[g])}else if(this.colDataList)for(g=0;g<this.colDataList.length;g++)u.addItem(this.colDataList[g],this.colDataList[g]);for(var m=this.headCellInfoHash[this.headerID].getAttribute("customFilterItemCnt")||2,y=0;y<m-1;y++)this.addCustomFilterItem(y);var b=new WebSquare.uiplugin.textbox(this.id+"_text2_"+this.headerID,{style:"position:absolute; margin-left:10px; margin-top:5px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(b);var v=new WebSquare.uiplugin.textbox(this.id+"_text3_"+this.headerID,{style:"position:absolute; margin:5px; margin-bottom:10px; margin-left:10px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(v);var w=new WebSquare.uiplugin.group(this.id+"_buttonGroup_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_buttonGroup"});if(this.customFilter.addControl(w),this.options.showCustomFilterReset){var C=new WebSquare.uiplugin.textbox(this.id+"_btnReset_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",label:WebSquare.language.getMessage("Grid_filter_reset")||"Reset",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.groupbyStatus&&o.groupbyStatus.grouped&&o.options.groupbyFilterBox;for(var e=0;e<o.groupList.length;e++)for(var i=o.groupList[e].getChildren(),s=0;s<i.length;s++){var r=i[s];if(-1!=r.id.indexOf("_selectbox")){var a=o.itemValueObj[o.targetColID]["select"+e];r.setSelectedIndex(a||0)}else if(-1!=r.id.indexOf("_autocomplete")){var n=o.itemValueObj[o.targetColID]["auto"+e];r.setValue(n||"")}else if(-1!=r.id.indexOf("_radio")){var l=o.itemValueObj[o.targetColID]["radio"+e];r.setSelectedIndex(l||0)}}}}}]});w.addControl(C),C.addEvent("onmousedown",(function(){C.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),C.addEvent("onmouseup",(function(){C.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),C.addEvent("onmouseout",(function(){C.toggleClass("w2grid_customFilter_button_selected")}))}var I=new WebSquare.uiplugin.textbox(this.id+"_btnConform_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_confirm")||"OK",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.setCustomFilterExpression()}}},{name:"onkeydown",action:"script",param:{handler:function(t){13==(t.charCode?t.charCode:t.keyCode)&&(o.setCustomFilterExpression(),o.hideCustomFilterList())}}}]});w.addControl(I),
I.addEvent("onmousedown",(function(){I.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),I.addEvent("onmouseup",(function(){I.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),I.addEvent("onmouseout",(function(){I.toggleClass("w2grid_customFilter_button_selected")}));var _=new WebSquare.uiplugin.textbox(this.id+"_btnCancel",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_cancel")||"Cancel",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide()}}},{name:"onkeydown",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode;9==e?(_.tabOrderMoveStart=!1,t.shiftKey||(_.tabOrderMoveStart=!0,p.f.preventDefault(t))):13==e&&(o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide(),o.hideCustomFilterList())}}},{name:"onkeyup",action:"script",param:{handler:function(t){9==(t.charCode?t.charCode:t.keyCode)&&(t.shiftKey||_.tabOrderMoveStart&&(_.tabOrderMoveStart=!1,o.customFilter.render.getElementsByClassName("w2floatingLayer_close_button")[0].focus()))}}}]});w.addControl(_),_.addEvent("onmousedown",(function(){_.toggleClass("w2grid_customFilter_button_selected")})),_.addEvent("onmouseup",(function(){_.toggleClass("w2grid_customFilter_button_selected")})),_.addEvent("onmouseout",(function(){_.toggleClass("w2grid_customFilter_button_selected")})),this.customFilter.writeTo(WebSquare.getBody()),this.customFilter.activate(),this.customFilter.dom.closeButton.addEventListener("keydown",(function(t){9==(t.charCode?t.charCode:t.keyCode)&&t.shiftKey&&_.focus()})),this.setChildrenPosition(),this.setDefaultValue(t),_.render.style.left=w.render.offsetWidth-_.render.offsetWidth-10+"px",I.render.style.left=parseInt(_.render.style.left,10)-I.render.offsetWidth-5+"px",this.options.showCustomFilterReset&&(C.render.style.left=parseInt(I.render.style.left,10)-_.render.offsetWidth-17+"px"),this.customFilter.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setDefaultValue=function(t){for(var e=0;e<this.groupList.length;e++)for(var i=this.groupList[e].getChildren(),o=0;o<i.length;o++){var s,r=i[o];if(-1!=r.id.indexOf("_selectbox")){s=r;for(var a=0;a<this.selectboxItemSet.length;a++)">"===this.selectboxItemSet[a]||">="===this.selectboxItemSet[a]||"<"===this.selectboxItemSet[a]||"<="===this.selectboxItemSet[a]?r.addItemArr(this.selectboxItemSet[a],this.selectboxItemSet[a],!1):r.addItemArr(this.selectboxItemSet[a],this.selectboxItemSet[a]);var n=this.itemValueObj[this.targetColID]["select"+e];r.setSelectedIndex(n||0)}else if(-1!=r.id.indexOf("_autocomplete")){var l=this.itemValueObj[this.targetColID]["auto"+e];r.setValue(l||"");var h=r.getValue();if(s){if(isNaN(h))for(a=0;a<s.itemArr.length;a++)void 0!==s.itemArr[a]._hidden&&(s.itemArr[a]._hidden=!0);else for(a=0;a<s.itemArr.length;a++)!0===s.itemArr[a]._hidden&&(s.itemArr[a]._hidden=!1);s.setSelectOptions(s.itemArr)}s=null}else if(-1!=r.id.indexOf("_radio")){r.addItem("OR","OR","0"),r.addItem("AND","AND","0");var d=this.itemValueObj[this.targetColID]["radio"+e];r.setSelectedIndex(d||0)}}},A.prototype.getUniqueValueOfArray=function(t,e){try{if(this._isNumberType(e))if("bigDecimal"!==e||isNaN(WebSquare.bigDecimal("").big))t.sort((function(t,e){return parseFloat(t)-parseFloat(e)}));else{var i,o;t.sort((function(t,e){if(""===t&&""===e)return 0;i=WebSquare.bigDecimal(t),o=WebSquare.bigDecimal(e);var s=i.minus(o);return"0"===s.toString()?0:"0"!==s.compare("0")?1:-1}))}else t.sort();for(var r=[],a=!1,n=0;n<t.length;n++)null!==t[n]?(0===r.length||r[r.length-1]!==t[n]&&r[r.length-1]+""!=t[n]+"")&&r.push(t[n]):a=!0;return a&&r.unshift(null),r}catch(t){s.Y.printStackTrace(t,null,this)}},
A.prototype.setAutoCompleteItem=function(t,e){var i=[];if(this.options.useFilterSearch&&this.customFilterList&&this.customFilterList.filterHistory.column.length>0){var o=this.getCustomFilterListJSON({colID:t,headerID:e}),s=this.headerInfoHash[e],r=0;s&&s.options.hideCustomFilter&&(r=1);for(var n=2-r;n<o.length;n++)i.push(o[n].id2)}else i=this.dataList.getColData(t);for(var l in this.itemValueObj[this.targetColID])-1!=l.indexOf("auto")&&""!=this.itemValueObj[this.targetColID][l]&&i.push(this.itemValueObj[this.targetColID][l]);this.colDataList=this.getUniqueValueOfArray(i),this.colDataList.sort((function(t,e){var i=t-e;a.Z.isIE("6 7")&&(i=(t+"").localeCompare(e+""));return i}))},A.prototype.showFilterOptions=function(t){this.options.useFilterList?(this.options.searchFilter,this.customFilterList&&this.customFilterScrollView?this.toggleCustomFilterList(t):this.createCustomFilterList(t)):this.showCustomFilter(t)},A.prototype.showCustomFilter=function(t){if(this.noevent=!0,this.options.useFilterList)if(this.groupbyStatus.grouped)if(this.options.groupbyFilterIcon){var e=this.headerToBodyRelation[t];if(e){for(var i=!1,o=this.getColumnIndex(e),s=0;s<this.groupbyStatus.sortIndexArr.length;s++)if(this.groupbyStatus.sortIndexArr[s]==o){i=!0;break}var r={};r.render=this.getElementById(this.id+"_"+t),r.parentRender=this.render.getElementsByTagName("div")[0],r.headerID=t,r.headerIndex=this.getHeaderIndex(r.headerID),r.isGroupbyColumn=i,this.groupbyFilterList?this.toggleGroupbyFilterList(r):this.createGroupbyFilterList(r)}}else this._showCustomFilter(t);else this.showFilterOptions(t);else this._showCustomFilter(t)},A.prototype.showCustomFilter2=function(t){this.noevent=!0,this._showCustomFilter(t)},A.prototype._showCustomFilter=function(t){var e,i;(this.headerID=t,this.targetColID=this.getColIdByHeaderId(t),null==this.customFilter&&(this.itemValueObj={},this.customFilterStatusObj={}),this.itemValueObj[this.targetColID]||(this.itemValueObj[this.targetColID]={}),this.setAutoCompleteItem(this.targetColID,t),this.makeCustomFilter(this.targetColID,t),"BODY"==this.render.parentNode.tagName)?(e=this.render.offsetTop,i=this.render.offsetLeft):(e=WebSquare.style.getAbsoluteTop(this.render),i=WebSquare.style.getAbsoluteLeft(this.render),a.Z.isIEAllVersion("5 6 7")||(e-=WebSquare.style.getAbsoluteTop(document.body)));var o=this.getHeaderPosition(t,"top"),s=this.getHeaderPosition(t,"left"),r=this.getHeaderSize(t,"width"),n=this.getHeaderSize(t,"height"),l=0,h=0;"number"==typeof window.innerWidth?(l=window.innerWidth,h=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(l=document.body.clientWidth,h=document.body.clientHeight);var d,u,p=parseInt(a.Z.getStyleProperty(this.customFilter.render,"width"),10),c=parseInt(a.Z.getStyleProperty(this.customFilter.render,"height"),10),g=0,f=0;a.Z.isIE("6 7 8")?(d=document.documentElement.scrollTop,u=document.documentElement.scrollLeft):(d=window.pageYOffset,u=window.pageXOffset),g=i+s+r+p<=l+u?i+s+r:i+s-p,f=e+o+n+c<=h+d?e+o+n:e+this.render.offsetHeight-c,g<u&&(g=(l-p)/2+u,(f=e+this.render.offsetHeight)+c>h+d&&(f=e-c)),f<d&&(f=(h-c)/2+d),this.customFilter.render.style.left=g+"px",this.customFilter.render.style.top=f+"px",this.customFilter.show();var m=a.Z.getComponentById(this.id+"_item_0_selectbox_"+this.headerID);m&&m.focus()},A.prototype.addCustomFilterItem=function(t){this.customFilterItemCnt++;var e=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute;",className:"w2grid_customFilter_item"});this.customFilter.addControl(e),this.groupList.push(e);var i=new WebSquare.uiplugin.radio(e.id+"_radio",{style:"position:absolute; left:50px; height:20px;",className:"w2grid_customFilter_radio",selectedIndex:0,cols:2,rows:1});e.addControl(i)
;var o=this,s=new WebSquare.uiplugin.selectbox(e.id+"_selectbox",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],i=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? matches any single character."),i.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* matches matches zero or more characters."),o.setChildrenPosition(),o.customFilterMetacharPos|=1<<t+1):(o.customFilterMetacharPos&=~(1<<t+1),o.customFilterMetacharPos<=0&&(e.setLabel(""),i.setLabel(""),o.setChildrenPosition()))}}}]});e.addControl(s);var r=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",n=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",l=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",d=new WebSquare.uiplugin.autoComplete(e.id+"_autocomplete",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,submenuSize:r,displayMode:n,searchTarget:l,delimiter:h});if(d.__setSelectedIndex1=d.setSelectedIndex1,d.setSelectedIndex1=function(t,e){d.__setSelectedIndex1(t,e);var i=d.getValue(),s=this.parentControl.id;if(s)var r=a.Z.getComponentById(s+"_selectbox");if(r){if(isNaN(i)){for(var n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);for(var l=r.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&r.setSelectedIndex(0)}else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}},e.addControl(d),"label"==n||"value delim label"==n||"label delim value"==n)for(var u=this.changeItemValue("label",this.targetColID,this.colDataList,!1),p=0;p<this.colDataList.length;p++)d.addItem(u[p],this.colDataList[p]);else if(this.colDataList)for(p=0;p<this.colDataList.length;p++)d.addItem(this.colDataList[p],this.colDataList[p])},A.prototype.setChildrenPosition=function(){for(var t=this.customFilter.getChildren(),e=1;e<=t.length;e++){var i=WebSquare.style.getStyle(t[e-1].render,"top");if(i="auto"===i?"0":i,e===t.length)break;var o=WebSquare.style.getStyle(t[e-1].render,"margin-bottom");o="auto"===o?"0":o,t[e].render.style.top=t[e-1].render.offsetHeight+5+parseInt(i||"0",10)+parseInt(o||"0",10)+"px"}var s=this.customFilter.dom.closeButton.parentNode.offsetHeight,r=t[e-1].render.offsetHeight+10+parseInt(i||"0",10);this.customFilter.setSize(this.customFilter.render.offsetWidth,s+r+6)},A.prototype.replacechar=function(t){return"^"==t||"$"==t||"."==t||"["==t||"]"==t||"{"==t||"}"==t||"+"==t||"("==t||")"==t||"|"==t||"*"==t||"?"==t||"\\"==t?"\\"+t:void 0},A.prototype.setCustomFilterExpression=function(){try{this.dataList.removeColumnFilter(this.targetColID,{noRefreshAfter:!0});for(var t=!0,e=[],i=0;i<this.groupList.length;i++){for(var o={},r=this.groupList[i].getChildren(),a=0;a<r.length;a++){var n=r[a];if(-1!=n.id.indexOf("_selectbox"))o.select=n.getSelectedIndex(),this.itemValueObj[this.targetColID]["select"+i]=n.getSelectedIndex(),t=t&&0==n.getSelectedIndex(),o.dataType=this.getDataType(this.targetColID);else if(-1!=n.id.indexOf("_autocomplete")){var h=this;o.auto=n.getValue()!=n.options.chooseOptionLabel?(n.getValue()+"").replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return h.replacechar(t)})):"",this.itemValueObj[this.targetColID]["auto"+i]=n.getValue(),t=t&&n.getValue()==n.options.chooseOptionLabel}else-1!=n.id.indexOf("_radio")&&(o.radio=n.getSelectedIndex(),this.itemValueObj[this.targetColID]["radio"+i]=n.getSelectedIndex())}o.select&&e.push(o)}
var d=this.getCellInfo(this.targetColID);"select"!==d.options.inputType&&"checkcombobox"!==d.options.inputType&&"autoComplete"!==d.options.inputType||(e.itemArr=d.getItemArray(),e.isSelectCol=!0),this.customFilterStatusObj[this.headerID]=!0;var u={type:"func",colIndex:this.targetColID,key:this.customFilterOperator,condition:"and",columnfilterchangeFire:!1,param:e},c=!1;if(this.customFilterList&&this.customFilterList.customFilterListFilterInfo){var g=this.customFilterList.customFilterListFilterInfo[this.targetColID];this.customFilterList.customFilterListFilterInfo[this.targetColID]=JSON.stringify(u,(function(t,e){return"function"==typeof e||"object"===(0,l.A)(e)&&e.constructor===RegExp?e.toString():e})),g!==this.customFilterList.customFilterListFilterInfo[this.targetColID]&&(c=!0,p.f.fireEvent(this._dataList,"onbeforecolumnfilterchange"))}this.dataList.setColumnFilter(u),c&&p.f.fireEvent(this._dataList,"onaftercolumnfilterchange");var f=this.getElementById(this.id+"_"+this.headerID+"_filter");t||0==e.length?WebSquare.style.removeClass(f,"w2grid_customFilter_filter"):WebSquare.style.addClass(f,"w2grid_customFilter_filter"),this.customFilter.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.customFilterOperator=function(t,e,i){try{for(var o=!0,r=0;r<e.length;r++){var a,n=!0,l=e[r].dataType,h=e[r].select,d=e[r].auto,u=e[r].auto.replace(".*","~~").replace(".","~"),p=u;if(!0===e.isSelectCol&&e.itemArr&&e.itemArr.length){for(var c=!1,g=0;g<e.itemArr.length;g++)if(e.itemArr[g].value===d){c=!0;break}if(!1===c)for(var f=0;f<e.itemArr.length;f++)if(e.itemArr[f].value===t){t=e.itemArr[f].label;break}}var m=t;if(h>=3&&h<=6)if("bigDecimal"===l){u=d.replace("\\.",".");var y=WebSquare.bigDecimal(u);"NaN"===y.big?!1:(p=y,m=WebSquare.bigDecimal(t))}else"number"!==l&&"float"!==l||(p=(u=d.replace("\\.",".")).toString().indexOf(".")>-1?parseFloat(u):parseInt(u,10));switch(e[r].select){case 1:(a=new RegExp(d,"g")).lastIndex=0,n=t==a.exec(t);break;case 2:(a=new RegExp(d,"g")).lastIndex=0,n=t!=a.exec(t);break;case 3:n="bigDecimal"===l?m.minus(p)>0:m>p;break;case 4:n="bigDecimal"===l?m.minus(p)>=0:m>=p;break;case 5:n="bigDecimal"===l?m.minus(p)<0:m<p;break;case 6:n="bigDecimal"===l?m.minus(p)<=0:m<=p;break;case 7:d=(d=d.replace(/\\\*/g,".*")).replace(/\\\?/g,".");var b=(a=new RegExp(d,"g")).exec(t);n=t==b||d==b;break;case 8:n=""==d?t==d:!!(a=new RegExp("^("+d+")","g")).test(t);break;case 9:n=!!(a=new RegExp("^[^("+d+")]","g")).test(t);break;case 10:n=""==d?t==d:!!(a=new RegExp("("+d+")$","g")).test(t);break;case 11:n=!!(a=new RegExp("[^("+d+")]$","g")).test(t);break;case 12:n=""==d?t==d:!!(a=new RegExp(d,"g")).test(t);break;case 13:n=""==d?t!=d:!!(a=new RegExp("^(?!.*"+d+").*","g")).test(t);break;default:n=t==d}if(1===e.length){o=n;break}0!==r?o=0==e[r].radio?o&&n:o||n:o=n}return o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.syncWithSortStatus=function(){try{this.headerSortStatusArr=[];for(var t=this._linkedDataList||this._dataList,e=0;e<t.sortStatusArr.length;e++){var i=t.sortStatusArr[e];"number"==typeof this.getColumnIndex(i.colID)&&(this.headerSortStatusArr.push(i),this.headerSortStatusArr[i.colID]=i)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getFixedColumnLastIndex=function(t){try{if(!this.options.rowNumStatusFixed&&0===this.options.fixedColumn||!1===t)var e=this.options.fixedColumn;else e=this.options.fixedColumn+this.defaultColCnt;if(e<1)return 0;if(!this.options.fixedColumnWithHidden)for(var i=0,o=0;o<this.hiddenList.length;o++)if(this.hiddenList[o]||i++,i==e)return o+1;return e}catch(t){return s.Y.printStackTrace(t,null,this),this.options.fixedColumn+this.defaultColCnt}},A.prototype.getFixedRightColumnLastIndex=function(){try{var t=this.colWidthList.length-this.options.fixedRightColumn,e=0;if(this.colWidthList.length!=t)for(var i=this.hiddenList.length-1;i>=0;i--)if(this.hiddenList[i])t--;else if(e++,this.options.fixedRightColumn==e)break;return t}catch(t){return s.Y.printStackTrace(t,null,this),
this.colWidthList.length-this.options.fixedRightColumn}},A.prototype.columnValue=function(t,e){try{return e=this.getColumnID(e),null!=t.nodeType&&void 0!==t.selectSingleNode?null==this.options.valueNode||""==this.options.valueNode?a.Z.getTextNodeValue(t.selectSingleNode(e)):t.selectSingleNode(e).getAttribute(this.options.valueNode):t[e]}catch(t){s.Y.printStackTrace(t,null,this)}return""},A.prototype.rowIndexValue=function(t){return t},A.prototype.getColumnOption=function(t,e){try{var i="";if(this.successBinding){var o=this.cellInfoHash[t];if("dataType"==e)if(o){var r=o.options.dataType;i=r||this._dataList.getColumnOption(t,e)}else(i=this._dataList.getColumnOption(t,e))||(i="text");else i=o.options[e]||"";return i}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnOption=function(t,e,i){try{this.successBinding&&this._dataList.setColumnOption(t,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getColumnDataListInfo=function(t){try{var e=this.getCellInfo(t);return"select"==e.options.inputType||"autoComplete"==e.options.inputType||"checkcombobox"==e.options.inputType?e.getColumnDataListInfo():null}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setInitStyle=function(t){if(WebSquare.initStyle[this.id]){for(var e,i=/([\w-]*)\s*:\s*([^;]*)/g,o={};e=i.exec(WebSquare.initStyle[this.id].style);)o[e[1]]=e[2].wq_trim();var s=o[t]?t:"";if(s){var r=s.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()})),a=o[s]?o[s]:o[s.toUpperCase()];document.getElementById(this.id).style[r]=a}else document.getElementById(this.id).style.cssText=WebSquare.initStyle[this.id].style,this.rowStyleArr=[],this.colStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this._cellSelectedIndex=[],this._removeAllTDCellClass(),this._removeAllTRClass(),this.applyStyleOptions(this.getTotalRow());document.getElementById(this.id).className=WebSquare.initStyle[this.id].className}},A.prototype.refresh=function(t){try{this._dataList.broadcast({gridView:["notifyRefresh",[t]]})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.checkAdaptiveGridType=function(){try{if(this.options.groupbyZone){var t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] Adaptive mode not supported for this grid.";return!1}if(!this.render)return!1;var e=this.htmlInfo.head.rowAttrArr.length,i=this.htmlInfo.body.rowAttrArr.length,o=0;if(this.hasSubtotal)for(var r=this.htmlInfo.subtotalArr,n=0;n<r.length;n++)o+=r[n].rowAttrArr.length;if(1==e&&1==i&&(this.adaptiveGridType=1),1==e&&2==i?this.adaptiveGridType=2:2==e&&1==i?this.adaptiveGridType=3:2==e&&2==i?this.adaptiveGridType=4:3==e&&1==i&&(this.adaptiveGridType=5),e>3||i>2||o>3){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] Adaptive mode not supported for this grid.";return $l(t),!1}if(e+(i>o?i:o)>4){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] Adaptive mode not supported for this grid.";return $l(t),!1}return!(a.Z.isIE(6)||a.Z.isIE(7)||a.Z.isIE(8)||a.Z.isIE(9))}catch(t){s.Y.printStackTrace(t)}},A.prototype.setAdaptiveGridBodyHeight=function(){try{for(var t=function(t){var e=this.getColumnIndex(t),i=parseInt(this.getAdaptiveColumnStyleValue(e,"height"),10);isNaN(i)||(this.orgBodyHeightObj[t]=this.getColumnStyleValue(e,"height"),this.setColumnStyle(t,"height",i+"px"))},e=this.htmlInfo.head.rowArr,i=0;i<e.length;i++)for(var o=e[i],r=0;r<o.length;r++){var a=o[r],n=parseInt(a.colSpan,10),l=a.id,h=this.headerToBodyRelation[l],d=this.getColumnIndex(h);if(!isNaN(n)&&n>1)for(var u=0;u<n;u++)t.call(this,this.getColumnID(d+u));else t.call(this,h)}}catch(t){s.Y.printStackTrace(t)}},A.prototype.removeAdaptiveGridBodyHeight=function(){try{for(var t in this.orgBodyHeightObj)this.setColumnStyle(t,"height",this.orgBodyHeightObj[t])}catch(t){s.Y.printStackTrace(t)}},A.prototype.setAdaptiveGridHeaderHeight=function(){try{
var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"),10),i=parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"),10);0===e&&null!=this.oldOptions.headerPaddingTop&&(e=parseInt(this.oldOptions.headerPaddingTop,10)),0===i&&null!=this.oldOptions.headerPaddingBottom&&(i=parseInt(this.oldOptions.headerPaddingBottom,10));for(var o=e+i,r=this.htmlInfo.head.rowArr,a=0;a<r.length;a++)for(var n=r[a],l=0;l<n.length;l++){var h=n[l],d=parseInt(h.colSpan,10),u=h.id,p=this.headerToBodyRelation[u],c=this.getColumnIndex(p),g=parseInt(this.getCellInfo(c).options.colSpan,10),f=0,m=0,y=this.headerInfoHash[u];if(y&&y.options&&"string"==typeof y.options.style)for(var b=y.options.style.split(";"),v=0;v<b.length;v++){if("height"==(I=b[v].split(":"))[0]){m=parseInt(I[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(u,"height"),10);if(null!=c)if(d>0){var w=d;for(v=c;v<c+d;v++)this.hiddenList[v]?w--:(f+=parseInt(this.getColumnStyleValue(v,"height"),10),f+=o);m!=(f-=o-(w-1))&&(null==this.orgHeaderHeightObj[u]&&(this.orgHeaderHeightObj[u]=m+"px"),w>0&&this.setHeaderStyle(u,"height",f+"px"))}else if(f=parseInt(this.getColumnStyleValue(c,"height"),10),g>1){f-=(o+1)*(g-1);var C=Math.round(f/g);for(v=l;v<l+g;v++){if(u=(h=n[v]).id,this.headerInfoHash[u])for(b=this.headerInfoHash[u].options.style.split(";"),v=0;v<b.length;v++){var I;if("height"==(I=b[v].split(":"))[0]){m=parseInt(I[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(u,"height"),10);v==l+g-1?(this.orgHeaderHeightObj[u]=m+"px",this.setHeaderStyle(u,"height",f+"px")):(this.orgHeaderHeightObj[u]=m+"px",this.setHeaderStyle(u,"height",C+"px"),f-=C)}}else m!=f&&(null==this.orgHeaderHeightObj[u]&&(this.orgHeaderHeightObj[u]=m+"px"),this.hiddenList[c]||this.setHeaderStyle(u,"height",f+"px"))}if(this.hasFooter){var _=this.htmlInfo.foot.rowArr;for(a=0;a<_.length;a++){var x=_[a];for(l=0;l<x.length;l++){var S=x[l],R=parseInt(S.colSpan),D=S.id,T=(c=l,f=0,parseInt(this.getFooterStyle(D,"height")));if(R>0){for(v=c;v<c+R;v++)f+=parseInt(this.getColumnStyleValue(v,"height")),f+=o;f-=o-(R-1)}else f=parseInt(this.getColumnStyleValue(c,"height"));T!=f&&(this.orgFooterHeightObj[D]=T+"px",this.setFooterStyle(D,"height",f+"px"))}}}}catch(t){s.Y.printStackTrace(t)}},A.prototype.removeAdaptiveGridHeaderHeight=function(){try{for(var t in this.orgHeaderHeightObj)this.setHeaderStyle(t,"height",this.orgHeaderHeightObj[t]);for(var t in this.orgFooterHeightObj)this.setFooterStyle(t,"height",this.orgFooterHeightObj[t])}catch(t){s.Y.printStackTrace(t)}},A.prototype.setAdaptiveGridSubtotalHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"))+parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"));if(0==this.orgSubtotalHeightArr.length)for(var i=0;i<this.drawedSubtotal.length;i++)for(var o=0;o<this.drawedSubtotal[i].length;o++)for(var r=this.drawedSubtotal[i][o].childNodes,a=this.defaultColCnt;a<r.length;a++){var n=parseInt(r[a].getAttribute("colSpan")),l=0,h=r[a].style.height;if(null!=n&&n>0){for(var d=a;d<a+n;d++)l+=parseInt(this.getColumnStyleValue(d-this.defaultColCnt,"height")),l+=e;l-=e-(n-1)}else l=h;h!=l&&(this.orgSubtotalHeightArr.push({height:h,elem:r[a]}),r[a].style.height=l+"px")}}catch(t){s.Y.printStackTrace(t)}},A.prototype.removeAdaptiveGridSubtotalHeight=function(){try{for(var t=0;t<this.orgSubtotalHeightArr.length;t++){var e=this.orgSubtotalHeightArr[t];e.elem.style.height=e.height}this.orgSubtotalHeightArr=[]}catch(t){s.Y.printStackTrace(t)}},A.prototype.setDrillDownDragDrop=function(t){try{this.drillDownDragDrop=a.Z.getBoolean(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getDataListInfo=function(){try{if(this.successBinding){var t={};return t.id=this.options.dataList,t}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getInputType=function(t){try{return this.getCellInfo(t).options.inputType}catch(t){s.Y.printStackTrace(t)}},A.prototype.getDataType=function(t){try{
return this.getCellInfo(t).options.dataType||this._dataList.getCellInfo(t).options.dataType}catch(t){s.Y.printStackTrace(t)}},A.prototype.getFakeExpressionArr=function(){try{for(var t=[],e=[],i=0;i<this.dataList.getRowCount();i++)(t=this._dataList.getRowData(i)).push(""),e=e.concat(t);return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setUseFilterList=function(t){try{this.options.useFilterList=a.Z.getBoolean(t),this.options.sortable&&this.options.showSortableImage&&(this.options.showSortableUseFilter=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setUseFilter=function(t,e){try{var i=t,o=this.headerInfoHash[i];if(null==o&&(i=this.bodyToHeaderRelation[i],null==(o=this.headerInfoHash[i])))return!1;var r=o.options.useFilter,n=a.Z.getBoolean(e);if(r===n)return!1;o.options.useFilter=n;var l,h=this.getHeaderLayer(i);if(this._clearHeaderSortImage(h,"table"),this._clearHeaderSortImage(h,"div"),!0===r)null!=(l=document.getElementById(this.id+"_"+i+"_filter"))&&(l.style.display="none");else if(null!=(l=document.getElementById(this.id+"_"+i+"_filter")))l.style.display="";else{var d=this.headerObj[i],u=h.innerHTML,p=h.getElementsByTagName("td");d&&(u=""),h.innerHTML="<table style='width:100%;height:100%;'><tr><td style='width:100%;'>"+u+"</td><td><input type='button' id='"+this.id+"_"+i+"_filter' class='w2trigger w2grid_customFilter_open' onclick='"+this.id+'.showCustomFilter("'+i+"\");'/></td></tr></table>",d&&(d.render?p[0].appendChild(d.render):p[0].appendChild(d))}var c=a.Z.getDataPrefix("useFilter");return n?h.setAttribute(c,n):h.removeAttribute(c),this.drawHeaderSortImages(),!0}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getFixedRow=function(){var t=parseInt(this.options.fixedRow,10);return t=isNaN(t)?0:t},A.prototype.getLastFixedRow=function(){var t=parseInt(this.options.lastFixedRow,10);return t=isNaN(t)?0:t},A.prototype.isVirtualCursor=function(){try{if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum)if(this.getLastFocusedCell().focusedRowIndex>this.lastIndex&&0==this.getElementById(this.id+"_scrollY_div").scrollTop)return!0;return!1}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeCell=function(t){try{if(null==t||null==t.rowIndex||null==t.colIndex)return void c.v.printLog("gridView mergeCell error : invalid argument ["+this.id+"]");null==t.rowSpan&&(t.rowSpan=1),null==t.colSpan&&(t.colSpan=1);var e=parseInt(t.rowIndex,10),i=parseInt(t.colIndex,10),o=parseInt(t.rowSpan,10),r=parseInt(t.colSpan,10),n=this.getRealRowIndex(e);o>1||r>1?(this.cellMergeInfo[e+"_"+i]={rowSpan:o,colSpan:r},this.cellMergeRealInfo[e+"_"+i]=n):null!=this.cellMergeInfo[e+"_"+i]&&(delete this.cellMergeInfo[e+"_"+i],delete this.cellMergeRealInfo[e+"_"+i]);for(var l=!(!this.isDrillDown||!this._dataList.options.depthColumn),h=l?e:n,d=this.dataList._getCellData(h,i,"3"),u=0;u<o;u++)for(var p=0;p<r;p++)if(0!==u||0!==p){var g={filteredRowIndex:e+u,colID:i+p,data:d,useRealRowIndex:l};this.dataList._setCellData(g),this.cellMergeInfo[e+u+"_"+(i+p)]&&delete this.cellMergeInfo[e+u+"_"+(i+p)]}this.dynamicMergeHTML(),this.options.oddEvenColorDisplay&&!0===this._isBrowserScroll()&&a.Z.setTimeout(this.redrawTable,{key:this.id+"_mergeCell",delay:100,caller:this})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeFocusedCell=function(){try{if(this.focusedCell.length>1){var t=this.focusedCell.length-1;this.mergeCell({rowIndex:this.focusedCell[0].focusedRowIndex,colIndex:this.focusedCell[0].focusedColIndex,rowSpan:this.focusedCell[t].focusedRowIndex-this.focusedCell[0].focusedRowIndex+1,colSpan:this.focusedCell[t].focusedColIndex-this.focusedCell[0].focusedColIndex+1})}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeSplitFocusedCell=function(){try{for(var t=0;t<this.focusedCell.length;t++)this.mergeCell({rowIndex:this.focusedCell[t].focusedRowIndex,colIndex:this.focusedCell[t].focusedColIndex,rowSpan:1,colSpan:1})}catch(t){s.Y.printStackTrace(t,null,this)}},
A.prototype.mergeClear=function(t){try{void 0!==t&&null!=t||(t={}),this.cellMergeInfo={},this.cellMergeRealInfo={},this.options.mergeCells="never",this.options.mergeCellsFixedCols="never",this.options.mergeCellsFixedRows="never",!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeNotifyRowChanged=function(t,e){try{var i="removeRow"===t?-1:1,o={};for(var r in this.cellMergeInfo){var a=r.split("_"),n=parseInt(a[0],10),l=parseInt(a[1],10),h=this.cellMergeInfo[r];if(n<=e&&e<n+h.rowSpan)if(-1===i){if(h.rowSpan--,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}else if(n<e){var d=h.rowSpan-(e-n);if((d>1||1==d&&h.colSpan>1)&&(o[e+1+"_"+l]={rowSpan:d,colSpan:h.colSpan}),h.rowSpan-=d,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}(n>e||n==e&&-1!==i)&&(n+=i),o[n+"_"+l]=h}this.cellMergeInfo=o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeNotifyFilter=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols){var t={};for(var e in this.cellMergeRealInfo._hidden){var i=e.split("_"),o=parseInt(i[0],10),r=parseInt(i[1],10),a=this.getDisplayRowIndex(o);isNaN(a)||(t[a+"_"+r]=this.cellMergeRealInfo._hidden[e],delete this.cellMergeRealInfo._hidden[e],this.cellMergeRealInfo[a+"_"+r]=o)}for(var n in this.cellMergeInfo){var l=n.split("_"),h=(r=parseInt(l[1],10),this.cellMergeInfo[n]);o=this.cellMergeRealInfo[n],a=this.getDisplayRowIndex(o);isNaN(a)?(this.cellMergeRealInfo._hidden||(this.cellMergeRealInfo._hidden={}),this.cellMergeRealInfo._hidden[o+"_"+r]=h,delete this.cellMergeRealInfo[n]):(t[a+"_"+r]=h,delete this.cellMergeRealInfo[n],this.cellMergeRealInfo[a+"_"+r]=o)}this.cellMergeInfo=t}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByFree=function(t,e,i,o){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:i-t+1,colSpan:o-e+1})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.unmergeByFree=function(t,e){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:1,colSpan:1})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeCells=function(t,e){try{this._mergeCells(t,e,{type:"mergeCells"})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByCol=function(t){try{this._mergeCells("bycol",t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByRow=function(t){try{this._mergeCells("byrow",t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByColRec=function(t){try{this._mergeCells("bycolrec",t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByRowRec=function(t){try{this._mergeCells("byrowrec",t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByRestricCol=function(t){try{this._mergeCells("byrestriccol",t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeByRestricRow=function(t){try{this._mergeCells("byrestricrow",t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeCells=function(t,e,i){try{var o=this.options.rollbackCommit;this.options.rollbackCommit=!1;var r=t.toLowerCase();switch(void 0!==i&&null!=i||(i={type:"mergeCells"}),this.options[i.type]=r,r){case"never":this.cellMergeInfo={},this.cellMergeRealInfo={},e&&!0===e.noDraw||this.dynamicMergeHTML();break;case"bycol":this._mergeByCol(e);break;case"byrow":this._mergeByRow(e);break;case"bycolrec":this._mergeByColRec(e);break;case"byrowrec":this._mergeByRowRec(e);break;case"byrestriccol":this._mergeByRestricCol(e);break;case"byrestricrow":this._mergeByRestricRow(e)}this.options.rollbackCommit=o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeRefresh=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols)return;var t={noDraw:!0};this.cellMergeInfo={},this.cellMergeRealInfo={},"never"!==this.options.mergeCells&&this.mergeCells(this.options.mergeCells,t),
this.options.mergeCellsFixedColsFirst?("never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t),"never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t)):("never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t),"never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeByCol=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,r=this.options.fixedColumn,a=i-this.options.fixedRightColumn,n=e,l={},h=this.getSubtotalRowList({returnType:"object"});!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var d={};!0===t.keepMerge&&(d=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,r=0,a=i);var u=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(r=i-this.options.fixedRightColumn,a=i):0==this.options.fixedRightColumn?(r=0,a=this.options.fixedColumn):(r=0,a=i,u=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var p=!(!this.isDrillDown||!this._dataList.options.depthColumn),c=r;c<a;c++){if(t.mergeCol){if(!1===t.mergeCol[c])continue}else if(!1===this.mergeColObj[c])continue;if(!(u&&c>=this.options.fixedColumn&&c<a-this.options.fixedRightColumn)&&!(this.htmlInfo.body.rowAttrArr.length>1&&1==this.colIndexInfo.body.colInfo.rowSpanArr[c+this.defaultColCnt]))for(var g=this.tdIdList[c],f=o;f<n;f++){var m=p?this.getRealRowIndex(f):f,y=this.dataList._getCellData(f,g),b=1;if(!0===t.keepMerge&&(b=0),!0===t.upperColumn&&(l[f]=!0),t.mergeRow){if(!1===t.mergeRow[m])continue}else if(!1===this.mergeRowObj[m])continue;for(;b<n-f&&!this._isExcludeValue(y);){var v=p?this.getRealRowIndex(f+b):f+b;if(t.mergeRow){if(!1===t.mergeRow[v])break}else if(!1===this.mergeRowObj[v])break;if(f+b>n)break;if(y!=(0===b?y:this.dataList._getCellData(f+b,g)))break;if(!0===t.keepMerge&&!0===d[v+"_"+c])break;if(!0===t.upperColumn&&!0===l[f+b])break;if(!0===h[f+b])break;b++}b>1&&(this.cellMergeInfo[m+"_"+c]={rowSpan:b,colSpan:1},f=f+b-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeByRow=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,r=this.options.fixedColumn,a=i-this.options.fixedRightColumn,n=e,l={};!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var h={};!0===t.keepMerge&&(h=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,r=0,a=i);var d=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(r=i-this.options.fixedRightColumn,a=i):0==this.options.fixedRightColumn?(r=0,a=this.options.fixedColumn):(r=0,a=i,d=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var u=!(!this.isDrillDown||!this._dataList.options.depthColumn),p=o;p<n;p++){var c=u?this.getRealRowIndex(p):p;if(t.mergeRow){if(!1===t.mergeRow[c])continue}else if(!1===this.mergeRowObj[c])continue;for(var g=r;g<a;g++)if(!(d&&g>=this.options.fixedColumn&&g<a-this.options.fixedRightColumn)){var f=this.dataList._getCellData(p,this.tdIdList[g]),m=1;if(!0===t.keepMerge&&(m=0),!0===t.upperRow&&(l[g]=!0),t.mergeCol){if(!1===t.mergeCol[g])continue}else if(!1===this.mergeColObj[g])continue;for(;m<a-g&&!this._isExcludeValue(f);){if(t.mergeCol){if(!1===t.mergeCol[g+m])break}else if(!1===this.mergeColObj[g+m])break;if(d){if(g+m>=this.options.fixedColumn&&g+m<a-this.options.fixedRightColumn)break}else if(g+m>a)break;if(f!=(0===m?f:this.dataList._getCellData(p,this.tdIdList[g+m])))break;if(!0===t.keepMerge&&!0===h[c+"_"+(g+m)])break;if(!0===t.upperRow&&!0===l[g+m])break;m++}m>1&&(this.cellMergeInfo[c+"_"+g]={rowSpan:1,colSpan:m},g=g+m-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){
s.Y.printStackTrace(t,null,this)}},A.prototype._mergeByColRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t),i=o.q.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByCol(e),this._mergeByRow(i),this._mergeAdjacentCell("col"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeByRowRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t),i=o.q.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByRow(e),this._mergeByCol(i),this._mergeAdjacentCell("row"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeAdjacentCell=function(t){try{var e="row"===t?[0,1]:"col"===t?[1,0]:null;if(null==e)return;var i={},o={},r=this.getSubtotalRowList({returnType:"object"});for(var a in this.cellMergeInfo){var n=a.split("_"),l=parseInt(n[e[0]],10),h=parseInt(n[e[1]],10),d=0===e[0]?this.cellMergeInfo[a].colSpan:this.cellMergeInfo[a].rowSpan,u=0===e[0]?this.cellMergeInfo[a].rowSpan:this.cellMergeInfo[a].colSpan;null!=i[h+"_"+d]?(null==o[h+"_"+d]&&(o[h+"_"+d]=[i[h+"_"+d]]),o[h+"_"+d].push({row:l,rowSpan:u})):i[h+"_"+d]={row:l,rowSpan:u}}for(var a in o){var p=parseInt(a.split("_")[0]),c=0===e[0]?"rowSpan":"colSpan";o[a].sort((function(t,e){return t.row>e.row}));for(var g=o[a].length-1;g>=1;g--){var f=!0===r[o[a][g].row];if(o[a][g-1].row+o[a][g-1].rowSpan>=o[a][g].row&&!f)if((0===e[0]?this.dataList._getCellData(o[a][g-1].row,p):this.dataList.getCellData(p,o[a][g-1].row))===(0===e[0]?this.dataList._getCellData(o[a][g].row,p):this.dataList.getCellData(p,o[a][g].row))){o[a][g-1].rowSpan=o[a][g].row+o[a][g].rowSpan-o[a][g-1].row;var m=0===e[0]?o[a][g].row+"_"+p:p+"_"+o[a][g].row;delete this.cellMergeInfo[m];var y=0===e[0]?o[a][g-1].row+"_"+p:p+"_"+o[a][g-1].row;this.cellMergeInfo[y][c]=o[a][g-1].rowSpan}}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeByRestricCol=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t);e.upperColumn=!0,this._mergeByCol(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._mergeByRestricRow=function(t){try{void 0!==t&&null!=t||(t={});var e=o.q.extend({},t);e.upperRow=!0,this._mergeByRow(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeCellsFixedRows=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedRows){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedRows=!0,e.fixedCols=!1,this._mergeCells(t,e,{type:"mergeCellsFixedRows"})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeCellsFixedCols=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedCols){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedCols=!0,e.fixedRows=!1,this._mergeCells(t,e,{type:"mergeCellsFixedCols"})}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeCol=function(t,e){try{t=this.getColumnIndex(t);isNaN(t)||(this.mergeColObj[t]=e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.mergeRow=function(t,e){try{this.mergeRowObj[t]=e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getMerged=function(t,e){try{if(this.cellMergeInfo[t+"_"+e])return!0;for(var i in this.cellMergeInfo){var o=i.split("_"),r=this.cellMergeInfo[i],a=parseInt(o[0],10),n=parseInt(o[1],10);if(a<=t&&n<=e&&a+r.rowSpan-1>=t&&n+r.colSpan-1>=e)return!0}}catch(t){s.Y.printStackTrace(t,null,this)}return!1},A.prototype.getMergedInfo=function(t,e){try{var i={merged:!1};if(this.cellMergeInfo[t+"_"+e])i.merged=!0,i.startRowIndex=t,i.startColIndex=e;else for(var o in this.cellMergeInfo){var r=o.split("_"),a=this.cellMergeInfo[o],n=parseInt(r[0],10),l=parseInt(r[1],10);n<=t&&l<=e&&n+a.rowSpan-1>=t&&l+a.colSpan-1>=e&&(i.merged=!0,i.startRowIndex=n,i.startColIndex=l,i.endRowIndex=n+a.rowSpan-1,i.endColIndex=l+a.colSpan-1)}}catch(t){s.Y.printStackTrace(t,null,this)}return i},
A.prototype.getMergeAll=function(t,e){try{for(var i,o=[],r=[],a=t.split(","),n=0;n<a.length;n++)o[n]=parseInt(a[n],10);for(var l in!0===e&&this.hasSubtotal&&(i=this.getSubtotalRowList().sort((function(t,e){return t-e}))),this.cellMergeInfo){var h=l.split("_"),d=this.cellMergeInfo[l],u=parseInt(h[0],10),p=parseInt(h[1],10),c=d.rowSpan,g=d.colSpan,f=p+g-1,m=0,y=0,b=0,v=0;if(!0===e&&this.hasSubtotal){for(var w=0;w<i.length&&u>=i[w];w++)v++;var C=1;for(var I in this.subtotalTableList)C=this.subtotalTableList[I].rows.length;u+=v*C}if(""!=t){o=o.sort();for(n=0;n<o.length;n++)p>(m=o[n])?b++:p<=m&&m<=f&&(p==m&&1==g?g=-1:y++);g-=y,p-=b}-1!=g&&(g>1||c>1)&&r.push({x:p,y:u,r:c,c:g})}return JSON.stringify(r)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getMergedCells=function(){try{var t={};for(var e in this.cellMergeInfo){var i=e.split("_"),o=this.cellMergeInfo[e],r=parseInt(i[0],10),a=parseInt(i[1],10),n=o.rowSpan||1,l=o.colSpan||1;if(l>1||n>1)for(var h=0;h<n;h++)for(var d=0;d<l;d++)t[r+h+"_"+(a+d)]=!0}return t}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setMergedCellData=function(t,e,i){try{var o=t+"_"+e;if(null!=this.cellMergeInfo[o])for(var r=this.cellMergeInfo[o].rowSpan,a=this.cellMergeInfo[o].colSpan,n=0;n<r;n++)for(var l=0;l<a;l++)0===n&&0===l||this.dataList.__setCellData(t+n,e+l,i)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._isExcludeValue=function(t){try{if(this.options.mergeExcludeValue)for(var e=this.options.mergeExcludeValue.split(","),i=0;i<e.length;i++){if(t.constructor==Number&&(t+=""),e[i]==t)return!0;if("$blank"==e[i]&&""===t)return!0}return!1}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.refreshGrid=function(t){try{var e=null,i=t.op;this.hiddenRowObj.length>0&&"setInstanceValue"!=i&&(e=JSON.stringify(this.hiddenRowObj),this.clearRowVisible());var o,r,a=t.xpath;if("setInstanceValue"==i){o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.options.repeatNode,null,this.scope_id);var n,l=(c=a.split("/"))[c.length-1],h=this.getColumnIndex(l);if(h>=0){n=this.getCellInfo(l),c.pop();var d=WebSquare.ModelUtil.findInstanceNode(c.join("/"),null,this.scope_id);r=this.getInstanceIndex(o,d);var u=this._dataList.getFilteredRowIndex(r);"radio"==n.options.inputType&&t.value+""==n.options.trueValue&&n.resetOthers(u,!0),u>=0?this._dataList.setCellData(u,h,t.value):this._dataList._setData(r,h,t.value)}}else if("setInstanceNode"==i){if(!(m=this.options.ref==t.replacexpath&&"replace"==t.type?this.xmlData2ArrData(t.replaceNode,!0):this.xmlData2ArrData(t.node,!0)).length)return;this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type?this.insertRow(null,{insertData:m}):"insertBeforeSibling"==t.type?(r=this.getInstanceIndex(o,t.node),this.insertRow(r,{insertData:m})):"replace"==t.type&&this._dataList.setData(m),this.insertRowByInstance=!1}else if("setInstanceChildNodes"==i){if(this.options.ref==t.replacexpath&&"replace"==t.type)m=this.xmlData2ArrData(t.replaceNode,!0);else t.baseNode&&t.baseNode!=this.options.baseNode&&(f=t.baseNode),m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if(!m.length&&"append"==t.type)return;var p=this.getTotalCol();if(this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type)for(;m.length>0;)y=m.splice(0,p),this.insertRow(null,{insertData:y});else"replace"==t.type&&this._dataList.setData(m);this.insertRowByInstance=!1}else if("setInstanceLastNodeChildNodes"==i||"copyLastNodeChildrenNodes"==i){if(!(m=this.xmlData2ArrData(t.node,!0,{repeatNode:t.repeatNode,isRepeatNode:!0})).length)return;this.insertRowByInstance=!0,"replace"!=t.type&&"replaceAll"!=t.type&&"append"!=t.type||this.setRowData(parseInt(t.changeIndex)-1,m,!0),this.insertRowByInstance=!1}else if("removeInstanceNode"==i)this.removeRowByInstance=!0,r=t.deleteIndex,this.removeRow(r),
this.removeRowByInstance=!1;else if("removeInstanceNodeAll"==i)this.removeRowByInstance=!0,this.dataList.removeAll(),this.removeRowByInstance=!1;else if("copyChildrenNodes"==i){var c,g,f;t.copiedXPath&&(g=(c=t.copiedXPath.split("/"))[c.length-1]),t.baseNode&&g!=this.options.baseNode&&(f=g);var m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if("replaceAll"==t.type)this.setData(m);else if("append"==t.type){var y;p=this.getTotalCol();for(this.insertRowByInstance=!0;m.length>0;)y=m.splice(0,p),this.insertRow(null,{insertData:y});this.insertRowByInstance=!1}}e&&"setInstanceValue"!=i&&(this.hiddenRowObj=JSON.parse(e),this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),this.setScrollYHeight(),this._mergeRefresh(),this.applyStyleOptions(this.lastIndex))}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getInstanceIndex=function(t,e){try{if(!Array.prototype.indexOf||a.Z.isIEAllVersion()&&parseInt(r.I.browserVersion(),10)>8){for(var i=t.length;i--;)if(t[i]===e)return i;return}return t.indexOf(e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getArrayIndexOf=function(t,e){try{if(Array.prototype.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]==e)return i;return}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setRef=function(t){try{if(t&&t.ref){this.options.ref=t.ref,t.baseNode&&(this.options.baseNode=t.baseNode),t.repeatNode&&(this.options.repeatNode=t.repeatNode);var e=null==t.aliasDataCollection?this.scope_id:t.aliasDataCollection,i=WebSquare.ModelUtil.findInstanceNode(this.options.ref,null,e);this.setXML(i,null,{ref:this.options.ref,aliasDataCollection:e})}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setRef=function(t,e){try{this.filteredRepeatNode=!1,this.repeatNodeChildTagName=[],this.repeatNodeTagName=this.options.repeatNode.split("/"),this.filteredRepeatNodeTagName=[];this.options.ref;for(var i=0;i<this.repeatNodeTagName.length;i++){var o=this.repeatNodeTagName[i];i==this.repeatNodeTagName.length-1&&o.indexOf("[")>=0&&(o.indexOf("[@")>=0||(this.repeatNodeTagNameFilter=!0,o=o.split("[")[0])),1==this.repeatNodeTagNameFilter?this.filteredRepeatNodeTagName.push(o):this.filteredRepeatNodeTagName.push(this.repeatNodeTagName[i]),i!=this.repeatNodeTagName.length-1&&"/"+this.repeatNodeTagName[i]}for(var r=0;r<WebSquare.WebSquaredoc.instanceRefElement.length;r++){var a=WebSquare.WebSquaredoc.instanceRefElement[r].id;try{a==this.id&&WebSquare.WebSquaredoc.instanceRefElement.splice(r,1)}catch(t){s.Y.printStackTrace(t,null,this)}}var n=this.options.aliasDataCollection?this.options.aliasDataCollection:this.scope_id;for(var l in WebSquare.WebSquaredoc.instanceRefElement.push(new WebSquare.ModelUtil.createInstanceRefElement(this.options.ref,this.id,this.options.baseNode,this.repeatNodeTagName,this.cellIdList,n)),this.cellInfoHash)this.repeatNodeChildTagName.push(l)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setImageSrc=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if(!e||"textImage"!=o)return;i.options.imageSrc=e,this.refreshColumn(t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setSyncScroll=function(t,e){try{this.options.syncScroll=t,null!=e&&(this.options.syncScrollId=e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.resetExpressionFunc=function(){try{if(this.useExpression)for(var t=this.getTotalCol(),e=0;e<t;e++){var i=this.getCellInfo(e);if(i&&i.options&&"expression"==i.options.inputType)for(var o=this.drawedRowLength,r=0;r<o;r++)i.options.expressionFunc&&i.options.expressionFunc[r]&&i.options.expressionFunc[r].changeCount&&(i.options.expressionFunc[r]={})}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellDataType=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e),a=r.id;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[n]?r.cellManagerHashByRowIndex[n]:r,!0;var l=r.options.inputType
;if("text"!=l&&"textarea"!=l&&"input"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;var h=this.getInput(r);h.setValue(this._dataList.getCellData(o,a));var d=h.getValue();h.setDataType(i),r.options.dataType="float";var u=h.formatter.unformat(d),p=h.validator.validateString(u);h.setValueNM(p),d!==p&&this._dataList.setCellData(o,a,p)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellAllowChar=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e),a=r.id;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[n]?r.cellManagerHashByRowIndex[n]:r,!0;var l=r.options.inputType;if("text"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;var h=this.getInput(r);if(h&&h.options&&("input"===h.options.pluginName||"textarea"===h.options.pluginName)){h.setValue(this._dataList.getCellData(o,a)),h.setAllowChar(i);var d=h.getValue();this._dataList.setCellData(o,a,d)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellDisplayFormat=function(t,e,i){try{e=this.getColumnIndex(e);var o,r=t,a=this.getCellInfo(e);if(0==a.internal&&"custom"==a.options.inputType){var n=this.dataList.getRealRowIndex(r);o=a.getCellManager({element:a.element,rowIndex:r,realRowIndex:n})}if(!o)return!1;var l=o.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;if(o.options.displayFormat=i,o.initFormatter(),o.options.embeddedInput){var h=this.data_td_list[e+(r-this.rowIndex)*this.oneRowDataLength];if(h){var d=this.getInput(o,h);d&&"function"==typeof d.setDisplayFormat&&d.setDisplayFormat(i)}}this.refreshCell(r,e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellDisplayFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e);if(0!=r.internal||"custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r,!0;var n=r.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("Invalid cell input type."),!1;r.options.displayFormatter=i,r.initFormatter(),this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellMaxLength=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e),a=r.id;if(0!=r.internal||"custom"!=r.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[n]?r.cellManagerHashByRowIndex[n]:r,!0;var l=r.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("Invalid cell input type."),!1;var h=this.getInput(r);h.setValue(this._dataList.getCellData(o,a)),"float"===r.options.dataType?r.setFloatMaxLength(i.toString()):r.setMaxLength(i);var d=h.getValue();this._dataList.setCellData(o,a,d)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellCustomFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e);if(0!=r.internal||"custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r,!0;var n=r.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("Invalid cell input type."),!1;r.options.customFormatter=i,r.initFormatter(),this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setCellDisableEdit=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,r=this.getCellInfo(e);if("custom"!=r.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);if("autoComplete"!=(r=r.cellManagerHashByRowIndex[a]?r.cellManagerHashByRowIndex[a]:r).options.inputType)return $l("Invalid cell input type."),!1;r.options.disableEdit=i,r.autoComplete&&(r.autoComplete.options.disableEdit=i),this.refreshCell(o,e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._removeDom=function(t){try{
var e=this.dom[t];if(e){var i=WebSquare.idCache[e.uuid];i&&"function"==typeof i.remove&&i.remove(),delete this.dom[t]}}catch(t){s.Y.printStackTrace(t)}},A.prototype.setCellInputType=function(t,e,i){try{if(i&&i.inputType){if("drilldown"===i.inputType)return;if(e=this.getColumnID(e)){if(this._linkedDataList){var o=this._linkedDataList.filteredRowIndexArr[t];"number"!=typeof(t=this._dataList.getFilteredRowIndex(o))&&(t=o)}var r={};for(var a in i)r[a]=i[a];this._setCellInputType(t,e,null,r)}}}catch(t){s.Y.printStackTrace(t)}},A.prototype._setCellInputType=function(t,e,i,o){try{null==i&&(i=""),null==this.editedCell||this.getCellOption(t,e,"embeddedInput")||this.editedCell.handleCancelEdit();var r=this._dataList.getTotalRow();this.groupbyStatus&&this.groupbyStatus.grouped&&(r=this._dataList.filteredRowIndexArr.length);this._dataList.getTotalCol();var a,n=!0;a=this.options&&"grid"===this.options.pluginName&&this.isDrillDown&&this.options.drilldownRealRowIndex||o&&!0===o.useRealRowIndex?t:this.dataList.getRealRowIndex(t);var l=this.getDisplayRowIndex(a);(isNaN(l)||l<0)&&(n=!1);var h=t,d=(e=this.getColumnID(e),this.getColumnIndex(e));this._dataList.getColumnIndex(e);if(t>=0&&t<r){var u=this.cellInfoHash[this.tdIdList[d]];if("custom"==u.options.inputType&&!u.options.embeddedInput){var p;p=!0===o.useRealRowIndex?l-(this.rowIndex>0?this.rowIndex:0):t-(this.rowIndex>0?this.rowIndex:0);var c,g=this.data_td_list[d+p*this.oneRowDataLength];if(g&&n)!1===(c=u.getCellManager({element:u.element,rowIndex:h,realRowIndex:a,options:o,td:g,dynamicInputType:!0}))?g.innerHTML=this.dataTagOpen+o.value+this.dataTagClose:(u.clearStyle(c,g),null==o.value||!0===c.existGridViewItemsetNode?i=this.dataList._getCellData(h,e):(i=o.value,this.dataList.setCellData(h,e,i,null,!0,!0)),this.isColMerge&&u.options.colMerge&&!this.groupbyStatus.grouped?this.setColMergeCellData(p,h,d):c.setInnerHTML(g,i,h,d));else(c=u.getCellManager({element:u.element,rowIndex:h,realRowIndex:a,options:o,dynamicInputType:!0}))&&(null!=c.customValue?(i=c.customValue,this.dataList.setCellData(h,e,i,null,!0,!0)):null==o.value||!0===c.existGridViewItemsetNode?i=this.dataList._getCellData(h,e):(i=o.value,this.dataList.setCellData(h,e,i,null,!0,!0)))}}}catch(t){s.Y.printStackTrace(t)}},A.prototype.setDataDragDrop=function(t){this._setDataDragOption("Drop",t)},A.prototype.setDataDragDropSelf=function(t){this._setDataDragOption("DropSelf",t)},A.prototype.setDataDragDropOther=function(t){this._setDataDragOption("DropOther",t)},A.prototype.setDataDragDropCell=function(t){this._setDataDragOption("DropCell",t)},A.prototype.setDataDragSelect=function(t){this._setDataDragOption("Select",t)},A.prototype.setDataDragSelectAutoScroll=function(t){this._setDataDragOption("SelectAutoScroll",t)},A.prototype.getDataDragDrop=function(){return this.options.dataDragDrop},A.prototype.getDataDragDropSelf=function(t){return this.options.dataDragDropSelf},A.prototype.getDataDragDropOther=function(t){return this.options.dataDragDropOther},A.prototype.getDataDragDropCell=function(t){return this.options.dataDragDropCell},A.prototype.getDataDragSelect=function(t){return this.options.dataDragSelect},A.prototype.getDataDragSelectAutoScroll=function(t){return this.options.dataDragSelectAutoScroll},A.prototype._setDataDragOption=function(t,e){try{var i="dataDrag"+t,o=this.options[i];if("boolean"==typeof e&&o!==e){if(this.options[i]=e,"dataDragSelectAutoScroll"===i)return;if("dataDragSelect"===i)!0===e&&(this.isMobile||this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.handleDragSelectEvent)));else if("dataDragDropOther"!==i&&"dataDragDropSelf"!==i||(this._useShiftKey=!1),!0===e)if(1==this.isMobile){if(this.isHammerEnabled()){var r=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(r=inquires("externalJS/hammer.min.js"));var a=this.uuid;r.then((function(t,e){var i=WebSquare.idCache[a]
;i._manager=new Hammer.Manager(i.getElementById(i.id+"_dataLayer")),i._manager.add(new Hammer.Press({time:i.options.hammerPressTime})),i._manager.on("press",i.event.bindAsEventListener(i,(function(t){i.handleDragEvent(t)}))),i._bindPressEvent=!0}))}}else!1===this._bindDrag&&(this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0);else this._bindDrag=!1}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setUseShiftKey=function(t){"boolean"==typeof t&&this.options.useShiftKey!==t&&(this.options.useShiftKey=t)},A.prototype.dragFinish=function(){try{this.options.dataDragDrop||this.options.dataDragDropSelf||!this.options.dataDragSelect||this.isMobile||WebSquare.dragdrop.gDragManager&&WebSquare.dragdrop.gDragManager.options&&(WebSquare.dragdrop.gDragManager.options.id===this.id+"_dragSelect"||WebSquare.dragdrop.gDragManager.options.id===this.id+"_drag")&&WebSquare.dragdrop.gDragManager.finish()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._fireOnviewchange=function(t,e,i,r){try{r=r||{};var a,n=this.getCellInfo(t),l=n.editRowIndex,h=this._dataList.getColumnIndex(n.id),d=this.getColumnIndex(n.id),u=this.getRealRowIndex(l),c=this._dataList.dataArr[u*this._dataList.getColumnCount()+h],g=n.comp&&n.comp.selectedIndex,f=this.lastEvent;r.beforeFunc&&r.beforeFunc.apply(r.beforeFunc,r.beforeFuncArgs);var m=!1;if(e)if("handleEndEdit"!=e&&"_handleEndEdit_focus"!=e&&"handleScrollY"!=e||i[2]&&i[2].otherClick)a=n[e].apply(n,i);else{m=!0;var y=i.slice(0);y[2]={from_fireOnviewchange:!0},o.q.extend(y[2],i[2]),a=n[e].apply(n,y)}if(r&&r.checkFunc&&!1===r.checkFunc(a))return!1;var b=this._dataList.dataArr[u*this._dataList.getColumnCount()+h];if(0===c&&(c="0"),0===b&&(b="0"),c!=b){var v={oldValue:c,newValue:b,rowIndex:l,colIndex:d,colId:this.getColumnID(d)};isNaN(g)||(v.oldSelectedIndex=g,v.newSelectedIndex=n.comp&&n.comp.selectedIndex),p.f.fireEvent(this,"onviewchange",v)}var w=this._getGroupbyDisplayRowIndex(l);return this.options.viewChangeAfterEdit&&1==m&&p.f.fireEvent(this,"onafteredit",w,d,b,f),!0}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._refreshInstance=function(t,e){try{if(!this.options.ref)return;e||WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],scopeId:this.scope_id,gridNoRefresh:!0}),t||(t=this._dataList.dataArr);var i,o=t.length/this.oneRowDataLength,r=[],a=this.repeatNodeTagName[0],n=WebSquare.xml.parse("<"+a+"></"+a+">").documentElement,l=this._dataList.getBroadcast();this._dataList.setBroadcast(!1);for(var h=0;h<o;h++)if(this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){if(0==h){var d,u=n,p=a;this.repeatNodeTagName.length>1&&(p=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(var c=1;c<this.repeatNodeTagName.length;c++)u=WebSquare.xml.createNode(u,this.repeatNodeTagName[c],!1);i=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(n,p):n;for(c=0;c<this.repeatNodeChildTagName.length;c++){if(d=WebSquare.xml.createNode(i,this.repeatNodeChildTagName[c],!1),r.push(d),f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){var g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}}else for(c=0;c<this.repeatNodeChildTagName.length;c++){var f;if(d=r[c],f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}WebSquare.ModelUtil.setInstanceNode(n,this.options.ref,null,"append",!1,this.scope_id)}this._dataList.setBroadcast(l)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.isHammerEnabled=function(){try{return(this.isMobile||a.Z.isTouchDevice())&&this.options.hammerEnabled}catch(t){
s.Y.printStackTrace(t,null,this)}},A.prototype.endEdit=function(){try{this._endEdit()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getColumnIdListMultiRow=function(){try{for(var t=[],e=this.colIndexes.bodyColInfo.colIndexMatch,i={},o=this.defaultColCnt;o<e.length;o++)for(var r=e[o],a=0;a<r.length;a++){null==t[a]&&(t[a]=[]);var n=this.getColumnID(r[a]-this.defaultColCnt);null==i[n]&&(t[a].push(n),i[n]=!0)}return t}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getLocationRowCol=function(t,e){try{var i,o,r=this.struct.body.rowAttrArr.length,a=this.getColumnOrder(),n=[];for(var l in a)n[a[l]]=parseInt(l,10);var h,d=this.cellMergeInfo;for(var u in d){var p=u.split("_"),c=parseInt(p[0]),g=parseInt(p[1]),f=d[u].rowSpan,m=d[u].colSpan;if(t>=c&&t<c+f&&e>=g&&e<g+m){i=f,o=m;break}}for(var y=0,b=e;b>=0;)h=b,b-=this.struct.body.rowArr[y].length,y++;if(y--,this.options.focusDefaultColumn&&y<0)o=1,i=1,v=t,h=e;else{o=o||parseInt(this.struct.body.rowArr[y][h].colSpan||1),i=i||parseInt(this.struct.body.rowArr[y][h].rowSpan||1),h=this.struct.body.rowArr[y][h]["@col"];var v=t*r+y;h=n[h]}return{rowIndex:v,colIndex:h,rowSize:i,colSize:o}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.getOriginalRowCol=function(t,e){try{for(var i=this.htmlInfo.body.rowAttrArr.length,o=(this.getColumnOrder(),!1),r=!0,a=t%i,n=1,l=1,h=[],d=0;d<i;d++){for(var u=[],p=0;p<this.htmlInfo.body.rowArr[d].length;p++)u.push({colSpan:parseInt(this.htmlInfo.body.rowArr[d][p].colSpan||1),rowSpan:parseInt(this.htmlInfo.body.rowArr[d][p].rowSpan||1),oriColIndex:parseInt(this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[d][p].col_id]),positionCalColIndex:parseInt(this.htmlInfo.body.rowArr[d][p]["@col"])});h.push(u)}for(d=0;d<i;d++){var c=0;for(p=0;p<h[d].length;p++){if(h[d][p].rowSpan>1)for(var g=1;g<h[d][p].rowSpan;g++)if(d+g<i){var f={oriRowAttrNum:d,rowIndex:d+g,oriColIndex:h[d][p].oriColIndex,colIndex:c,rowSpan:1,colSpan:h[d][p].colSpan,oriRowSpan:h[d][p].rowSpan,positionCalColIndex:h[d][p].positionCalColIndex};h[d+g].splice(h[d][p].positionCalColIndex||c,0,f)}c+=h[d][p].colSpan}}for(d=0;d<i;d++)h[d].sort((function(t,e){return t.positionCalColIndex-e.positionCalColIndex}));var m,y=h[a],b=0;for(p=0;p<y.length;p++){var v=parseInt(y[p].colSpan);if((b+=v)>e){e!==b-v&&(e=b-v,o=!0,r=!1),l=v,m=p;break}}n=y[m].rowSpan,void 0!==y[m].oriRowAttrNum&&(a+=y[m].oriRowAttrNum-y[m].rowIndex,n=y[m].oriRowSpan,o=!0),m=y[m].oriColIndex;var w=Math.floor(t/i),C=this.cellMergeInfo;for(var I in C){var _=I.split("_"),x=(u=parseInt(_[0]),parseInt(_[1])),S=C[I].rowSpan,R=C[I].colSpan;if(w>=u&&w<u+S&&m>=x&&m<x+R){if(w==u&&m==x){n=S,l=R;break}m!=x&&(r=!1),w=u,m=x,n=S,l=R,o=!0;break}}return{rowIndex:w,colIndex:m,rowSize:n,colSize:l,noLeftTop:o,leftCell:r}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setImeMode=function(t,e){try{var i=this.getCellInfo(t);"text"!=i.options.inputType&&"textImage"!=i.options.inputType&&"textArea"!=i.options.inputType&&"drilldown"!=i.options.inputType||(i.options.imeMode=e)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._isGridViewItemTable=function(){try{return!(!this.parentControl||!this.parentControl.options||"gridItemTable"!==this.parentControl.options.pluginName&&"gridViewItemTable"!==this.parentControl.options.pluginName)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.searchData=function(t){try{void 0!==t&&null!=t||(t={}),this.clearSearchData({noRefresh:!0});var e=t.column;e=e?e.split(","):this.tdIdList.slice(0);for(var i=this.getRowCount(),o=[],r=[],a=0;a<i;a++){for(var n=!1,h=this.__getGroupbyGroupedRowIndex(a),d=this.getRealRowIndex(h),u=0;u<e.length;u++){var p=this.getColumnIndex(e[u]);this.getCellDisplayData(a,p).indexOf(t.data)>=0&&(n=!0,r.unshift([d,p]))}n&&o.push(d)}if(this.groupbyStatus.grouped){var c={};for(a=0;a<o.length;a++)c[o[a]+""]=!0;this.groupbyStatus.groupbyRowIndexArr=o.slice(0);var g=this.groupbyStatus.groupedRowIndexArr;this._beforeSearch={groupbyRowIndexArr:o.slice(0),
groupedRowIndexArr:g.slice(0)};var f=[];for(a=0;a<g.length;a++)if("object"===(0,l.A)(g[a])){if(0===g[a].depth&&f.length>0&&"object"===(0,l.A)(f[f.length-1]))for(;f.length>0&&"object"===(0,l.A)(f[f.length-1]);)f.pop();f.push(g[a])}else!0===c[g[a]+""]&&f.push(g[a]);for(;f.length>0&&"object"===(0,l.A)(f[f.length-1]);)f.pop();this.groupbyStatus.groupedRowIndexArr=f}var m={type:"direct",key:o,filterId:this.id+"_searchData"};this.dataList.setFilter(m);for(a=0;a<r.length;a++){var y=this.getDisplayRowIndex(r[a][0]),b=this.__getGroupbyGroupedRowIndex(y);this.setFocusedCell(b,r[a][1],!1,{ctrled:!0})}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.clearSearchData=function(t){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;void 0!==t&&null!=t||(t={});var e={filterId:this.id+"_searchData",noRefresh:t.noRefresh};this.groupbyStatus.grouped&&this._beforeSearch&&(this.groupbyStatus.groupbyRowIndexArr=this._beforeSearch.groupbyRowIndexArr.slice(0),this.groupbyStatus.groupedRowIndexArr=this._beforeSearch.groupedRowIndexArr.slice(0)),this._beforeSearch=null,this.dataList.removeFilter(e),this.removeFocusedCell(),!0===t.clearValue&&this.groupbyZone_searchinput.setValue("")}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._groupbyZoneSearch=function(){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;var t=this.groupbyZone_searchinput.getValue();if(""===t)this.clearSearchData();else{var e={};e.data=t,this.searchData(e)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setBlockSelect=function(t,e){try{if(!0!==e&&!1!==e)return;var i=this.getCellInfo(t);if(i&&i.options.blockSelect!==e){var o=this.getColumnIndex(t);i.options.blockSelect=e;for(var r=0;r<this.focusedCell.length;r++)if(this.focusedCell[r].focusedColIndex===o){var a=this.focusedCell[r];this._applyFocusedCellOut(a)}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setVisibleRowNum=function(t){try{if(t=parseInt(t,10),isNaN(t)||t<=0)return!1;this.options.initFixedHeightByRowNum>-1&&(this.options.initFixedHeightByRowNum=t);for(var e=this.options.visibleRowNum,i=this.getColumnOrder(),o=this.getColCnt(),r=[],a=0;a<o;a++)r.push(a);var n=!1,l=!0;("all"==e||""==e||parseInt(e,10))&&(n=!0);for(a=0;a<i.length;a++)if(i[a]!==r[a]){l=!1;break}this.options.visibleRowNum=t,this._dynamicVisibleRowNum=t,!l&&n&&this.setColumnOrder(r);var h=this._getVisibleRowNumHeight(!0);this.setTrRowTable(),this.getScrollTop()>0?(this.setSize(null,h),this.handleResize({startPoint:"0"}),this.scrollEvent=!1,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0):this.setSize(null,h),!l&&n&&this.setColumnOrder(i)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.enableAllDate=function(t){try{var e=this.getCellInfo(t);if("calendar"!=e.options.inputType)return $l("Invalid cell input type."),!1;var i=this.getInput(e);e.options.disableBeforeDate="",e.options.disableAfterDate="",i&&i.enableAllDate()}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setEditModeEvent=function(t,e){try{if(t&&(this.options.editModeEvent=t,e))for(var i=0;i<this.getColumnCount();i++){var o=this.getCellInfo(i);o.options.editModeEvent&&(o.options.editModeEvent=t,this.refreshColumn(o.colID))}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setColumnEditModeEvent=function(t,e){try{if(e){var i=this.getCellInfo(t);if(bRefreshColumn)for(var o=0;o<this.getColumnCount();o++){(i=this.getCellInfo(o)).options.editModeEvent&&(i.options.editModeEvent=e,this.refreshColumn(i.colID))}}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setFocusMode=function(t){try{if(this.options.focusMode===t||"cell"!==t&&"row"!==t&&"both"!==t)return;this.removeFocusedCell(),this.options.focusMode=t}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setRedrawTextAreaColumn=function(t){try{for(var e=!1,i=0;i<this.getColumnCount();i++){var o=this.getCellInfo(i);"textarea"==o.options.inputType&&"all"==o.options.displayType&&(e=!0,t||this.redrawColumn(i))}
if(t&&e&&"all"===this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&this.getRowCount()>0){var r=document.getElementById(this.id+"_body_table").offsetHeight;this.render.offsetHeight!=r&&this.setSize(null,r)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getSelectedIndex=function(t,e){try{var i=-1,o=this.getCellInfo(e);if("custom"==o.options.inputType){var r=this.dataList.getRealRowIndex(t);o=o.cellManagerHashByRowIndex[r]?o.cellManagerHashByRowIndex[r]:o}if(o&&"select"==o.options.inputType){var a=this.getColumnIndex(e);null!=(r=this._getStyleRowIndex(t))&&"number"==typeof r&&void 0===(i=this._cellSelectedIndex[r*this.oneRowDataLength+a])&&(this._cellSelectedIndex[r*this.oneRowDataLength+a]=-1,i=-1)}return i}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setSelectedIndex=function(t,e,i){try{e=this.getColumnIndex(e);var o=this._getStyleRowIndex(t);if(null==o)return;"number"==typeof o&&(this._cellSelectedIndex[o*this.oneRowDataLength+e]=i)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._setFirsCellFocus=function(t){try{for(var e=0,i=this.getRowCount()-1,o=this.getLeftMostFocusableColIndex(e);e<i&&null==o;)e+=1,o=this.getRightMostFocusableColIndex(e);var r=this.getCellInfo(o);if("button"===r.options.inputType||"radio"===r.options.inputType||"checkbox"===r.options.inputType||"user"===r.options.inputType){var a=0,n=this.getCheckedIndex(r.colID)[0];n>0&&(a=n),this._setFocusedCell(a,o,!1,{tabDirection:"right"}),WebSquare.event.stopEvent(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._isNumberType=function(t){try{return!(!t||"float"!=t&&"number"!=t&&"bigDecimal"!=t&&"euro"!=t&&"tenge"!=t&&"rupee"!=t)}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getOperator=function(t){try{var e,i;return 0==t.indexOf(">=")?(i=t.replace(">=",""),e=">="):0==t.indexOf(">")?(i=t.replace(">",""),e=">"):0==t.indexOf("<=")?(i=t.replace("<=",""),e="<="):0==t.indexOf("<")?(i=t.replace("<",""),e="<"):0==t.indexOf("==")?(i=t.replace("==",""),e="=="):0==t.indexOf("!=")?(i=t.replace("!=",""),e="!="):t&&(e="==",i=t),{operator:e,value:i}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._isMatched=function(t,e,i,o){try{var r=!0,a=t,n=e;return this._isNumberType(o)&&(a=parseFloat(a),n=parseFloat(n),isNaN(Number(n))&&(n=0)),">"==i?n>a||(r=!1):">="==i?n>=a||(r=!1):"<"==i?n<a||(r=!1):"<="==i?n<=a||(r=!1):"!="==i?n==a&&(r=!1):"=="==i&&n!=a&&(r=!1),r}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._ShiftKeyMultiCheck=function(t,e,i){try{var o=this.getCellInfo(i),r=o.id,a=this.getColumnIndex(r);if(t.beforeChecked){for(var n=parseInt(t.beforeChecked.rowIndex),l=parseInt(e.rowIndex),h=Math.min(n,l),d=Math.max(n,l),u=0;u<t.getDataLength()&&!(u>d);u++)h<=u&&u<=d&&t._dataList.setCellData(u,r,o.options.trueValue);o.options.blockSelect||(t.applyFocusedCellOut(),t.focusedCell=[],t._applyFocusedMultiCell(n,a,l,a)),!0!==e.checked&&(i.getElementsByTagName("input")[0].checked=!0)}}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.setConfigOptions=function(t,e){try{var i,o;if("header"===e)i=this.headerConfigOptions,o="h";else if("footer"===e)i=this.footerConfigOptions,o="f";else{if("subtotal"!==e)return;i=this.subtotalConfigOptions,o="s"}if(!t||!t.id)return;var n=a.Z.getDataPrefix("inputType"),l=this.options.pluginName,h=t.getAttribute(n),d=r.I.getConfig(l+"/"+e+"[@inputType='"+h+"']"),u=r.I.getConfigurationJSON("/WebSquare/"+l+"/"+o+"column",{type:"array"})||[],p=!1;u instanceof Array||(u=[u],p=!0);for(var c=0;c<u.length;c++){var g=u[c],f=g["@inputType"];if(g&&(p||!f||f===h))for(var m in g)if("@inputType"!==m){var y=g[m];if(y&&null==d.item){var b=y["@value"];if("number"==typeof b||"string"==typeof b||"boolean"==typeof b){if("string"==typeof b){var v=b.toLocaleLowerCase().wq_trim();"true"===v||"false"===v?b=a.Z.getBoolean(b):"$blank"===v&&(b="")}d[m]=b}}}}i[t.id]=d}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype.show=function(t){try{WebSquare.xfControl.prototype.show.call(this,t),
0===this._dataList.getDataLength()&&(this.displayNoResultMessage(),this.setScrollYHeight())}catch(t){s.Y.printStackTrace(t)}},A.prototype._swapArr=function(t,e,i){try{var o=t[e];t[e]=t[i],t[i]=o}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getDefinedFormatIndex=function(t){try{var e;if("yyyy/MM/dd"===t)e=55;return e}catch(t){s.Y.printStackTrace(t,null,this)}},A.prototype._getExcelFooterData=function(t,e,i,o){try{var r=[];if(o)for(var a=o.split(","),n=0;n<a.length;n++){var l=parseInt(a[n],10);isNaN(l)||r.push(l)}return"0"==e?this.getExcelAllFooterXMLDisplay(t,r,!1):0==i?this.getExcelAllFooterXML(t,r):1==i?this.getExcelAllFooterXMLDisplay(t,r):this.getExcelAllFooterXMLRaw(t,r)}catch(t){s.Y.printStackTrace(t,null,this)}};var E=function(){};E.prototype.getColumnReadOnly=function(t){var e=this.getCellInfo(t);return""!=e.options.readOnly?a.Z.getBoolean(e.options.readOnly):""},E.prototype.setColumnReadOnly=function(t,e){try{var i=this.getCellInfo(t);""!=e&&(e=a.Z.getBoolean(e));var o=i.options.readOnly;if(i.options.readOnly=e,o!==e){if(null!=this.editedCell){var r=a.Z.getDataPrefix("tdindex"),n=parseInt(this.editedCell.editTd.getAttribute(r))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=n==t}else this.rollbackCommitFlag=!1;this.drawColumnData(t),this.applyStyleOptions(this.lastIndex)}}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.getRowReadOnly=function(t,e){try{var i=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===e?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),o=this.rowReadOnlyArr[i];return 1!=o&&0!=o?"":o}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setRowReadOnly=function(t,e,i){try{var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),r=o||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));""!=e&&(e=a.Z.getBoolean(e));var n=o||!0===i?this.getDisplayRowIndex(r):this._getGroupbyGroupedRowIndex(t),l=this.rowReadOnlyArr[r];this.rowReadOnlyArr[r]=e,l!==e&&(null!=this.editedCell&&this.editedCell.editRowIndex==r?this.rollbackCommitFlag=!0:this.rollbackCommitFlag=!1,n>=0&&(this.drawRowData(n-this.rowIndex,n,!0),this.applyRowStyleOptions(n)))}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.getCellReadOnly=function(t,e,i){try{e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),r=this.cellReadOnlyArr[o*this.oneRowDataLength+e];return 1!=r&&0!=r?"":r}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setCellReadOnly=function(t,e,i){try{if(""!=i&&(i=a.Z.getBoolean(i)),(e=this.getColumnIndex(e))>=this.getColumnCount())return;var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),r=o?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),n=o?this.getDisplayRowIndex(r):this._getGroupbyGroupedRowIndex(t),l=this.cellReadOnlyArr[r*this.oneRowDataLength+e];if(this.cellReadOnlyArr[r*this.oneRowDataLength+e]=i,l!==i){var h=this.rollbackCommitFlag;if(null!=this.editedCell&&this.editedCell.editRowIndex==r){var d=a.Z.getDataPrefix("tdindex"),u=parseInt(this.editedCell.editTd.getAttribute(d))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=u==e}else this.rollbackCommitFlag=!1;n>=0&&(this.notifyCellChanged(n,e),this.rollbackCommitFlag=h,this.applyCellStyleOptions(n,e))}}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.getColumnDisabled=function(t){var e=this.getCellInfo(t);return a.Z.getBoolean(e.options.disabled)},E.prototype.setColumnDisabled=function(t,e){try{e=a.Z.getBoolean(e);var i=this.getCellInfo(t),o=i.options.disabled;i.options.disabled=e,o!==e&&(this.drawColumnData(t),this.applyColumnStyleOptions(t))}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.getRowDisabled=function(t){try{
var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));return a.Z.getBoolean(this.rowDisabledArr[e])}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setRowDisabled=function(t,e){try{e=a.Z.getBoolean(e);var i=!(!this.isDrillDown||!this._dataList.options.depthColumn),o=i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),r=i?this.getDisplayRowIndex(o):this._getGroupbyGroupedRowIndex(t),n=this.rowDisabledArr[o];this.rowDisabledArr[o]=e,n!==e&&r>=0&&(this.drawRowData(r-this.rowIndex,r,!0),this.applyRowStyleOptions(r))}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.getCellDisabled=function(t,e,i){try{e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));i&&(o=t);var r=this.cellDisabledArr[o*this.oneRowDataLength+e];return 1!=r&&0!=r?"":r}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setCellDisabled=function(t,e,i,o){try{i=a.Z.getBoolean(i);e=this.getColumnIndex(e);var r=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=r?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),l=r?this.getDisplayRowIndex(n):this._getGroupbyGroupedRowIndex(t);o&&(n=t,l=this.getDisplayRowIndex(t));var h=this.cellDisabledArr[n*this.oneRowDataLength+e];this.cellDisabledArr[n*this.oneRowDataLength+e]=i,h!==i&&l>=0&&(this.notifyCellChanged(l,e),this.applyCellStyleOptions(l,e))}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setTDStyle=function(t,e,i,o,s){""!=this.options.readOnlyBackgroundColor&&this.___getEditReadOnly(e,i)&&(s="background-color:"+this.options.readOnlyBackgroundColor+";"+s),this._getEditDisabled(e,i)?(t.disabled=!0,""!=this.options.disabledBackgroundColor&&(s+=";background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(s+=";color:"+this.options.disabledFontColor)):t.disabled=!1,t.style.cssText=o+";"+s},E.prototype.setStyleAll=function(t){try{var e=t.type,i=e.charAt(0).toUpperCase()+e.slice(1),o=t.target||"";"all"!==o&&"default"!==e&&"init"!==e||(o=""),"cell"!==e&&"disabledCell"!==e||(o="");var r=o?o.charAt(0).toUpperCase()+o.slice(1):"",a=t.styleName,n=t.styleValue,l=t.noRefresh,h=t.rowIndex,d=t.useRealRowIndex;d||(h=this._getGroupbyGroupedRowIndex(h));var u,p=t.colIndex;if("column"===e||"cell"===e||"default"===e||"init"===e){if(p=this.getColumnIndex(p),!this.getColumnID(p)&&!this.successBinding)return;if(!this.getColumnID(p)&&!this._dataList.getColumnID(p))return void c.v.printLog("[Warning] Invalid colIndex("+p+").["+this.id+"] set"+i+"Style"+r)}var g="ValueObj";"column"===e||"adaptiveColumn"===e||"default"===e||"init"===e?(u=p,i="Column"):"disabledCell"===e?(u=h+"_"+p,i="Cell",g="Obj"):null==(u=null==p?this["get"+i+"Style"+r+"ClassName"](h,d):this["get"+i+"Style"+r+"ClassName"](h,p,d))&&(this[e+"Style"+r+"Index"]++,u=this.id+"_"+e+"style"+o+"_"+this[e+"Style"+r+"Index"]+"_",null==p?this["set"+i+"Style"+r+"ClassName"](h,u,d):this["set"+i+"Style"+r+"ClassName"](h,p,u)),null==(t=this[e+"Style"+r+g][u])&&(t={}),t[a]=n;var f=[];for(var a in t){var m=t[a];"style"!=a&&""!=m&&f.push(a+":"+m)}if(t.style=f.join(";"),this[e+"Style"+r+g][u]=t,!0!==l)if(null==h)this["apply"+i+"StyleOptions"](p);else!(!this.isDrillDown||!this._dataList.options.depthColumn)&&!d&&(h=this.getDisplayRowIndex(h)),!d||"cell"!=e&&"row"!=e?this["apply"+i+"StyleOptions"](h,p):"cell"==e?this["apply"+i+"StyleOptions"](h,p,void 0,void 0,d):this["apply"+i+"StyleOptions"](h,d)}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setRowBackgroundColor=function(t,e,i){this.setRowStyle(t,"background-color",e,i)},E.prototype.setRowColor=function(t,e,i){this.setRowStyle(t,"color",e,i)},E.prototype.setRowStyle=function(t,e,i,o){this.setStyleAll({type:"row",rowIndex:t,styleName:e,styleValue:i,useRealRowIndex:o})},E.prototype.getRowBackgroundColor=function(t){
return this.getRowStyleValue(t,"background-color")},E.prototype.getRowColor=function(t){return this.getRowStyleValue(t,"color")},E.prototype.getRowStyleValue=function(t,e){t=this._getGroupbyGroupedRowIndex(t);var i=this.getRowStyleClassName(t);return null==i?"":this.rowStyleValueObj[i][e]||""},E.prototype._getRowStyleStr=function(t){return this.rowStyleValueObj[t].style},E.prototype.setColumnBackgroundColor=function(t,e){this.setColumnStyle(t,"background-color",e)},E.prototype.setColumnColor=function(t,e){this.setColumnStyle(t,"color",e)},E.prototype.setColumnStyle=function(t,e,i){this.setStyleAll({type:"column",colIndex:t,styleName:e,styleValue:i})},E.prototype.setDefaultStyle=function(t,e,i){this.setStyleAll({type:"default",colIndex:t,styleName:e,styleValue:i})},E.prototype._setInitStyle=function(t,e,i){this.setStyleAll({type:"init",colIndex:t,styleName:e,styleValue:i})},E.prototype.setAdaptiveColumnStyle=function(t,e,i){this.setStyleAll({type:"adaptiveColumn",colIndex:t,styleName:e,styleValue:i,noRefresh:!0})},E.prototype.getColumnBackgroundColor=function(t){return this.getColumnStyleValue(t,"background-color")},E.prototype.getColumnColor=function(t){return this.getColumnStyleValue(t,"color")},E.prototype.getColumnStyleValue=function(t,e){var i=this.columnStyleValueObj[t];return null==i?this.getDefaultStyleValue(t,e):i[e]||this.getDefaultStyleValue(t,e)},E.prototype._getColumnStyleStr=function(t){return this.columnStyleValueObj[t].style},E.prototype.getDefaultStyleValue=function(t,e){var i=this.defaultStyleValueObj[t];return null==i?"":i[e]||""},E.prototype._getInitStyleValue=function(t,e){var i=this.initStyleValueObj[t];return null==i?"":i[e]||""},E.prototype._getDefaultStyleStr=function(t){return this.defaultStyleValueObj[t].style},E.prototype.getAdaptiveColumnStyleValue=function(t,e){var i=this.adaptiveColumnStyleValueObj[t];return null==i?"":i[e]||""},E.prototype.setCellBackgroundColor=function(t,e,i,o){this.setCellStyle(t,e,"background-color",i,void 0,o)},E.prototype.setCellColor=function(t,e,i,o){this.setCellStyle(t,e,"color",i,void 0,o)},E.prototype.setCellStyle=function(t,e,i,o,s,r){var a=this.getColumnID(e);if(this.mergeCellBkStatus&&this.mergeCellBkStatus[a]){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);this.mergeCellBkStatus[a][n]=null,delete this.mergeCellBkStatus[a][n]}this.setStyleAll({type:"cell",rowIndex:t,colIndex:e,styleName:i,styleValue:o,noRefresh:s,useRealRowIndex:r})},E.prototype._refreshCellStyle=function(t){var e=[],i=this.cellStyleValueObj[t];for(var o in i){var s=i[o];"style"!=o&&""!=s&&e.push(o+":"+s)}i.style=e.join(";"),this.cellStyleValueObj[t]=i},E.prototype.setDisabledCellStyle=function(t,e,i,o){e=this.getColumnIndex(e);this._getEditDisabled(t,e)&&this.setStyleAll({type:"disabledCell",rowIndex:t,colIndex:e,styleName:i,styleValue:o})},E.prototype.getCellBackgroundColor=function(t,e){return this.getCellStyleValue(t,e,"background-color")},E.prototype.getCellColor=function(t,e){return this.getCellStyleValue(t,e,"color")},E.prototype.getCellStyleValue=function(t,e,i,o){try{t=this._getGroupbyGroupedRowIndex(t);var r=this.getCellStyleClassName(t,e);return null==r?(!0!==o&&c.v.printLog("[Warning] Is not exist cell!["+this.id+"]"),""):this.cellStyleValueObj[r][i]||""}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype._getCellStyleStr=function(t){return this.cellStyleValueObj[t].style},E.prototype.setHeaderCellStyle=function(t,e,i){try{var o=this.getHeaderLayer(t);WebSquare.style.setStyle(o,e,i)}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setHeaderBackgroundColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"background-color",e),this.headerCellStyleValueObj[t]={"background-color":e}}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.setHeaderColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"color",e)}catch(t){s.Y.printStackTrace(t,null,this)}},
E.prototype.getHeaderCellStyleValue=function(t,e){try{var i=this.getHeaderLayer(t);return WebSquare.style.getStyle(i,e)}catch(t){s.Y.printStackTrace(t,null,this)}},E.prototype.getHeaderBackgroundColor=function(t){return this.getHeaderCellStyleValue(t,"background-color")},E.prototype.getHeaderColor=function(t){return this.getHeaderCellStyleValue(t,"color")},E.prototype._setMergeCellBackground=function(t,e,i){var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t),s=this.getColumnID(e),r=this.getColumnIndex(e);if(this.options.groupbyZone&&(this.mergeCellBkStatus||(this.mergeCellBkStatus={}),this.mergeCellBkStatus[s]||(this.mergeCellBkStatus[s]={}),null==this.mergeCellBkStatus[s][o])){var a=this.getCellStyleValue(t,s,"background-color",!0)||this.getColumnStyleValue(r,"background-color");this.mergeCellBkStatus[s][o]=a}var n=this.setCellDefaultStyleClassName(o,r,!0);this.cellStyleValueObj[n]["background-color"]=i,this._refreshCellStyle(n)},E.prototype._clearMergeCellBackground=function(){if(this.mergeCellBkStatus){for(var t in this.mergeCellBkStatus)for(var e in this.mergeCellBkStatus[t]){var i=parseInt(e,10),o=this.mergeCellBkStatus[t][e],s=this.setCellDefaultStyleClassName(i,t,!0);this.cellStyleValueObj[s]["background-color"]=o,this._refreshCellStyle(s),o||delete this.cellStyleValueObj[s]["background-color"]}delete this.mergeCellBkStatus}};var M=function(t){this.statusArr=[],this.mainGrid=null,this.options=null,this.mode=null};M.prototype.initialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(c.v.printLog("Warning: Filters not applicable in drilldown mode. All previously applied filters have been removed.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,r=!0,a=parseInt(this.options.showDepth,10),n=0;n<s;n++){var l=t._linkedDataList.initialRowIndexArr[n];this.statusArr[l]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(l,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(l,this.mainGrid.getColumnID(i))))<=a&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0,r=!1)}if(!0===r)for(l=0;l<s;l++)this.mainGrid._linkedDataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0}else{t._dataList.filteredRowIndexArr=[],this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),r=!0,a=parseInt(this.options.showDepth,10),l=0;l<s;l++){this.statusArr[l]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(l,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(l,this.mainGrid.getColumnID(i))))<=a&&(this.mainGrid._dataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0,r=!1)}if(!0===r)for(l=0;l<s;l++)this.mainGrid._dataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0}},M.prototype.getDepth=function(t){return"dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(t,this.mainGrid._dataList.getColumnID(this.options.depthColumn))):parseInt(this.mainGrid.dataList._getData(t,this.mainGrid.getColumnID(this.options.depthColumn)))},M.prototype.isOpen=function(t){var e=this.getDepth(this.mainGrid.getRealRowIndex(t)),i=0;i="linkedDataList"===this.mode?this.mainGrid._linkedDataList.filteredRowIndexArr[t+1]:this.mainGrid._dataList.filteredRowIndexArr[t+1];var o=this.getDepth(i);return!isNaN(e)&&!isNaN(o)&&e<o},M.prototype.hasChild=function(t){if("linkedDataList"===this.mode){
var e=this.mainGrid._linkedDataList.filteredRowIndexArr[t],i=this.mainGrid._linkedDataList.getLinkedRowIndex(t),o=this.mainGrid._linkedDataList.initialRowIndexArr[i+1],s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));var r=parseInt(this.mainGrid.dataList._getData(e,s)),a=parseInt(this.mainGrid.dataList._getData(o,s));return r<(a=isNaN(a)?0:a)}o=(e=this.mainGrid.getRealRowIndex(t))+1,s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));r=parseInt(this.mainGrid.dataList._getData(e,s)),a=parseInt(this.mainGrid.dataList._getData(o,s));return r<(a=isNaN(a)?0:a)},M.prototype.getOriginalRowIndex=function(t){return this.openRowIndexArr[t]},M.prototype.getDisplayRowIndex=function(t){if("linkedDataList"===this.mode){if(this.mainGrid._linkedDataList.filteredRowIndexArr)for(var e=0;e<this.mainGrid._linkedDataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid._linkedDataList.filteredRowIndexArr[e])return e}else if(this.mainGrid._dataList.filteredRowIndexArr)for(e=0;e<this.mainGrid._dataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid.getRealRowIndex(e))return e;return t},M.prototype.getChildRowArr=function(t,e){var i=t,o=this.getDepth(t),s=this.mainGrid.getTotalRow(),r=[],a=this.options.depthColumn,n=this.mainGrid.getColumnID(a);if("dataList"==this.options.dataColumn&&(n=this.mainGrid._dataList.getColumnID(a)),"linkedDataList"===this.mode)for(var l=i+1;l<s;l++){var h=this.mainGrid._linkedDataList.initialRowIndexArr[l];if(this.mainGrid.dataList._getData(h,n)==o+1&&r.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&r.push(h),this.mainGrid.dataList._getData(h,n)<=o)break}else for(h=i+1;h<s&&(this.mainGrid.dataList._getData(h,n)==o+1&&r.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&r.push(h),!(this.mainGrid.dataList._getData(h,n)<=o));h++);return r},M.prototype.pasteDrilldownInitialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(c.v.printLog("Warning: Filters not applicable in drilldown mode. All previously applied filters have been removed.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,r=0;r<s;r++){var a=t._linkedDataList.initialRowIndexArr[r];this.statusArr[a]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(a,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(a,this.mainGrid.getColumnID(i))))<=parseInt(this.options.showDepth,10)&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(a),this.statusArr[a]=!0)}}else{this.statusArr=[],this.options=o.q.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),a=0;a<s;a++)this.statusArr[a]=!0}},M.prototype.getChildrenRowArr=function(t){var e=[];if(this.mainGrid){var i=this.mainGrid.getTotalRow(),o=this.options.depthColumn,s=this.mainGrid.getColumnID(o);if("dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(o)),"linkedDataList"===this.mode){var r=this.mainGrid._linkedDataList.initialRowIndexArr[t+1],a=parseInt(this.mainGrid.dataList._getData(this.mainGrid._linkedDataList.initialRowIndexArr[t],s),10);if(r<i&&this.mainGrid.dataList._getData(r,s)>a){e.push(r);var n=parseInt(this.mainGrid.dataList._getData(r,s),10),l=!0}if(l)for(var h=t+2;h<i;h++){r=this.mainGrid._linkedDataList.initialRowIndexArr[h];if(this.mainGrid.dataList._getData(r,s)<a+1)break;this.mainGrid.dataList._getData(r,s)<n+1&&(e.push(r),
n=parseInt(this.mainGrid.dataList._getData(r,s),10))}}else{r=t+1,a=parseInt(this.mainGrid.dataList._getData(t,s),10);if(r<i&&this.mainGrid.dataList._getData(r,s)>a){e.push(r);n=parseInt(this.mainGrid.dataList._getData(r,s),10),l=!0}if(l)for(r=t+2;r<i&&!(this.mainGrid.dataList._getData(r,s)<a+1);r++)this.mainGrid.dataList._getData(r,s)<n+1&&(e.push(r),n=parseInt(this.mainGrid.dataList._getData(r,s),10))}}return e},M.prototype.getParentRowIndex=function(t){if(this.mainGrid){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=parseInt(this.mainGrid.dataList._getData(t,i));if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var r=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(r,i)<o)return r}else for(r=t-1;r>=0;r--)if(this.mainGrid.dataList._getData(r,i)<o)return r}return-1},M.prototype.makeOpenRowIndexArr=function(){if("linkedDataList"===this.mode){this.mainGrid._linkedDataList.filteredRowIndexArr=[];for(var t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._linkedDataList.filteredRowIndexArr.push(t)}else{this.mainGrid._dataList.filteredRowIndexArr=[];for(t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._dataList.filteredRowIndexArr.push(t)}},M.prototype.toggle=function(t){var e=this.isOpen(t),i=[];t="linkedDataList"===this.mode?this.mainGrid._linkedDataList.getLinkedRealRowIndex(t):this.mainGrid.getRealRowIndex(t),i=e?this.getChildRowArr(t,!0):this.getChildrenRowArr(t);for(var o=0;o<i.length;o++)this.statusArr[i[o]]=!e;this.makeOpenRowIndexArr(),p.f.fireEvent(this.mainGrid,"ontoggleclick",e,t)},M.prototype.getAncestorRowArr=function(t){if("number"!=typeof t)return!1;for(var e=[],i=t;i>=0;)e.push(i),i=this.getParentRowIndex(i);return e.shift(),e},M.prototype.drillTo=function(t){if("number"!=typeof t)return!1;var e=this.getAncestorRowArr(t);e.unshift(t);for(var i=0;i<e.length;i++){var o=e[i];if(this.statusArr[o]=!0,0!=i)for(var s=this.getChildrenRowArr(o),r=0;r<s.length;r++)this.statusArr[s[r]]=!0}return this.makeOpenRowIndexArr(),this.getDisplayRowIndex(e[e.length-1])},M.prototype.isLastChild=function(t){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=this.mainGrid.dataList._getData(t,i);if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var r=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(r,i)<o)return r}else for(r=t+1;r<this.mainGrid.getTotalRow();r++){if(this.mainGrid.dataList._getData(r,i)==o)return!1;if(this.mainGrid.dataList._getData(r,i)<o)return!0}return!0},M.prototype.getRecursiveRowIndex=function(t){try{for(var e=[],i=this.getChildrenRowArr(t),o=0;o<i.length;o++){var r=i[o];e.push(r),e=e.concat(this.getRecursiveRowIndex(r))}return e}catch(t){s.Y.printStackTrace(t,null,this)}},M.prototype.getRecursiveRowCount=function(t){try{for(var e=0,i=this.getChildrenRowArr(t),o=0;o<i.length;o++)e+=this.getRecursiveRowCount(i[o]),e++;return e}catch(t){s.Y.printStackTrace(t,null,this)}},M.prototype.appendChild=function(t,e){try{if(e){var i=t+this.getRecursiveRowCount(t);return this.mainGrid._toggle(this.getDisplayRowIndex(t)),this.mainGrid.dataList.setRowData(i+1,e)}$l("data is null. check data.["+this.id+"]")}catch(t){s.Y.printStackTrace(t,null,this)}},M.prototype.moveNode=function(t,e){try{var i;if(t<e){if(!this.bodyDrop)i=e-(this.getRecursiveRowCount(t)+1)}else(t>e||t==e)&&(i=e);var o=this.detachNode(t),r=this.appendNode(i,o);return"number"!=typeof i&&(i=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1)),this.bodyDrop=!1,{detachedData:o,insertedData:r,insertedRowIndex:i}}catch(t){s.Y.printStackTrace(t,null,this)}},M.prototype.appendNode=function(t,e){try{
var i,o,r,a=this.mainGrid._dataList.getColumnCount(),n=e.length/a,l=this.mainGrid._dataList.getColumnID(this.options.depthColumn);if(this.options.depthColumn=parseInt(this.options.depthColumn,10),this.bodyDrop){this.bodyDrop=!1;var h=this,d=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1),u=this.getDisplayRowIndex(function t(e){var i=h.getParentRowIndex(e);return i=i>-1?t(i):e}(d));i=parseInt(this.mainGrid.dataList.getCellData(u,l),10),o=parseInt(e[a*(n-1)+parseInt(this.options.depthColumn)],10),t=d+this.getRecursiveRowCount(d)+1,r=i-o}else{u=this.getDisplayRowIndex(t-1);r=(i=parseInt(this.mainGrid.dataList.getCellData(u,l),10))-(o=parseInt(e[a*(n-1)+parseInt(this.options.depthColumn)],10))+1}for(var p=[],c=0;c<n;c++)for(var g=0;g<a;g++){var f=e[a*c+g];g==this.options.depthColumn&&(f-=0,f+=r),p.push(f)}this.mainGrid.dataList._insertData(t,p,-1);var m=this.getDisplayRowIndex(t);return this.isOpen(m)&&this.mainGrid._toggle(m),p}catch(t){s.Y.printStackTrace(t,null,this)}},M.prototype.detachNode=function(t){try{for(var e=[],i=this.mainGrid.dataList.removeRow(t,{skipNotify:!0}),o=0;o<i.length;o++)e=e.concat(i[o]);return e}catch(t){s.Y.printStackTrace(t,null,this)}},M.prototype.insertNextSibling=function(t,e){try{this.options.depthColumn=parseInt(this.options.depthColumn,10);var i=this.mainGrid.dataList.getColumnCount(),o=e.length/this.mainGrid.dataList.getColumnCount(),r=this.mainGrid.getDisplayRowIndex(t),a=parseInt(this.mainGrid.dataList.getCellData(r,this.options.depthColumn),10)-parseInt(e[i*(o-1)+parseInt(this.options.depthColumn)],10),n=[];t+=this.getRecursiveRowCount(t)+1;for(var l=0;l<o;l++)for(var h=0;h<i;h++){var d=e[i*l+h];h==this.options.depthColumn&&(d-=0,d+=a),n.push(d)}if(this.mainGrid.dataList._insertData(t,n,-1),this.mainGrid.options.closeDrillDownSibling)for(l=0;l<o;l++){var u=this.getDisplayRowIndex(t+l);this.isOpen(u)&&this.mainGrid._toggle(u)}return n}catch(t){s.Y.printStackTrace(t,null,this)}};var O=i(3925),N=function(t){this._linkedDataList._grid=t};N.prototype.getLinkedRowIndex=function(t){return this._linkedDataList.getLinkedRowIndex(t)},N.prototype.getRealRowIndex=function(t){return this._linkedDataList.filteredRowIndexArr[t]},N.prototype.getFilteredRowIndex=function(t){return this._linkedDataList.getFilteredRowIndex(t)},N.prototype.getTotalRow=function(){try{return this._linkedDataList.initialRowIndexArr.length}catch(t){s.Y.printStackTrace(t)}},N.prototype.getTotalCol=function(){try{return this._linkedDataList._dataList.getTotalCol()}catch(t){s.Y.printStackTrace(t)}},N.prototype.getRowCount=function(){try{return this._linkedDataList.getDataLength()}catch(t){s.Y.printStackTrace(t)}},N.prototype.getCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getCellData(i,e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getOriginalCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getOriginalCellData(i,e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getDataLength=function(){return this._linkedDataList.filteredRowIndexArr.length},N.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.Y.printStackTrace(t,null,this)}},N.prototype.getRowPosition=function(){try{return this._linkedDataList._dataList.getRowPosition()}catch(t){s.Y.printStackTrace(t,null,this)}},N.prototype.getColData=function(t){try{for(var e=[],i=0;i<this._linkedDataList.initialRowIndexArr.length;i++)e.push(this._linkedDataList.getCellData(i,t));return e}catch(t){s.Y.printStackTrace(t)}},N.prototype.getRowData=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getRowData(e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getDataRow=function(t){try{var e=this._linkedDataList.getRealRowIndex(t)
;return this._linkedDataList._dataList.getDataRow(e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getMatchedData=function(t,e,i,o,r){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var a=[],n=this._linkedDataList.getMatchedIndex(t,e,i,o,r),l=0;l<n.length;l++)a.push(this._linkedDataList.getRowData(n[l]));return a}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUnmatchedData=function(t,e,i,o,r){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var a=[],n=this._linkedDataList.getUnmatchedIndex(t,e,i,o,r),l=0;l<n.length;l++)a.push(this._linkedDataList.getRowData(n[l]));return a}catch(t){s.Y.printStackTrace(t)}},N.prototype.getMatchedColumnData=function(t,e,i,o,r,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getMatchedIndex(t,e,o,r,a),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUnmatchedColumnData=function(t,e,i,o,r,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getUnmatchedIndex(t,e,o,r,a),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){s.Y.printStackTrace(t)}},N.prototype.getFilteredColData=function(t){for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++)e.push(this._linkedDataList.getCellData(this._linkedDataList.filteredRowIndexArr[i],t));return e},N.prototype.getMatchedIndex=function(t,e,i,o,r){try{i=void 0===i||null==i||i,0!=(i=a.Z.getBoolean(i))&&(i=!0);var n=this._linkedDataList._dataList.getColumnIndex(t),l=this._linkedDataList.getFilteredColData(n),h=[];"number"!=typeof o&&(o=0),"number"!=typeof r&&(r=l.length),r>l.length&&(r=l.length);for(var d=o;d<r;d++){var u=l[d],p=this._linkedDataList.getRealRowIndex(d);1==i?u===e&&h.push(p):u.indexOf(e)>-1&&h.push(p)}return h}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUnmatchedIndex=function(t,e,i,o,r){try{0!=i&&(i=!0);var a=this._linkedDataList._dataList.getColumnIndex(t),n=this._linkedDataList.getFilteredColData(a),l=[];"number"!=typeof o&&(o=0),"number"!=typeof r&&(r=n.length),r>n.length&&(r=n.length);for(var h=o;h<r;h++){var d=n[h],u=this._linkedDataList.getRealRowIndex(h);1==i?d!==e&&l.push(u):d.indexOf(e)<=-1&&l.push(u)}return l}catch(t){s.Y.printStackTrace(t)}},N.prototype.getRangeData=function(t,e){try{var i=[];if(t>e){var o=e;e=t,t=o}t<0&&(t=0),e>this._linkedDataList.getDataLength()&&(e=this._linkedDataList.getDataLength());for(var r=t;r<e;r++){var a=this._linkedDataList.getRealRowIndex(r);i=i.concat(this._linkedDataList.getRowData(a))}return i}catch(t){s.Y.printStackTrace(t)}},N.prototype.getAllData=function(){try{return this._linkedDataList._dataList.getAllFilteredData()}catch(t){s.Y.printStackTrace(t)}},N.prototype.getAllFilteredData=function(){this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=0;e<this._linkedDataList.getDataLength();e++)t=t.concat(this._linkedDataList.getRowData(e));return t},N.prototype.getColumnDistinctDataArray=function(t){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var e=[],i=[];"string"==typeof t&&(t=this._linkedDataList._dataList.bodyIdColIndexMap[t]);for(var o=this._linkedDataList._dataList.getCellInfo(t),r=this._linkedDataList.getColData(t),a=0;a<r.length;a++){i[r[a]]=1}for(var n in i)e.push(n);return"text"==o.options.dataType?e.sort():e.sort(this._linkedDataList.comparator),e}catch(t){s.Y.printStackTrace(t)}},N.prototype.getRangeXML=function(t,e){try{return this._linkedDataList.getRangeXML(t,e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getMatchedXML=function(t,e,i,o,r){try{return this._linkedDataList.getMatchedXML(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUnmatchedXML=function(t,e,i,o,r){try{return this._linkedDataList.getUnmatchedXML(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getRowXML=function(t){try{return this._linkedDataList.getRowXML(t)}catch(t){s.Y.printStackTrace(t)}},
N.prototype.getAllXML=function(t){try{return this._linkedDataList.getAllXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getAllFilteredXML=function(t){return this._linkedDataList.getAllFilteredXML(t)},N.prototype.getRowJSON=function(t,e){try{return this._linkedDataList.getRowJSON(t,e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getAllJSON=function(t){try{return this._linkedDataList.getAllJSON(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getRangeJSON=function(t,e,i){try{return this._linkedDataList.getRangeJSON(t,e,i)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getMatchedJSON=function(t,e,i,o,r){try{return this._linkedDataList.getMatchedJSON(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUnmatchedJSON=function(t,e,i,o,r){try{return this._linkedDataList.getUnmatchedJSON(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getFusionChartData=function(t,e,i,o){return this._linkedDataList.getFusionChartData(t,e,i,o)},N.prototype.getRowStatusValue=function(t){try{return this._linkedDataList.getRowStatusValue(t)}catch(t){s.Y.printStackTrace(t,null,this)}},N.prototype.getRowStatus=function(t){try{return this._linkedDataList.getRowStatus(t)}catch(t){s.Y.printStackTrace(t,null,this)}},N.prototype.getRowIndexByStatus=function(t){try{for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++){var o=this._linkedDataList.getRealRowIndex(i);t.indexOf(this._linkedDataList._dataList.getRowStatus(o))>-1&&e.push(o)}return e}catch(t){s.Y.printStackTrace(t)}},N.prototype.getInsertedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("C")}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUpdatedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("U")}catch(t){s.Y.printStackTrace(t)}},N.prototype.getDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("DV")}catch(t){s.Y.printStackTrace(t)}},N.prototype.getOnlyDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("D")}catch(t){s.Y.printStackTrace(t)}},N.prototype.getVoidIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("V")}catch(t){s.Y.printStackTrace(t)}},N.prototype.getModifiedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("CUD")}catch(t){s.Y.printStackTrace(t)}},N.prototype.getInsertedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getInsertedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getInsertedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getInsertedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getDeletedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getVoidData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t
}catch(t){s.Y.printStackTrace(t)}},N.prototype.getVoidXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getVoidIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getVoidJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getOnlyDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getOnlyDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getOnlyDeletedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getOnlyDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUpdatedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUpdatedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getUpdatedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getUpdatedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getModifiedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.getModifiedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getModifiedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.getModifiedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.Y.printStackTrace(t)}},N.prototype.setColumnFilter=function(t,e,i,o){return"object"!==(0,l.A)(t)||a.Z.isString(t)||(t.internal=!0),this._linkedDataList.setColumnFilter(t,e,i,o)},N.prototype.removeColumnFilter=function(t){return this._linkedDataList.removeColumnFilter(t,{internal:!0})},N.prototype.clearSortFilter=function(){return this._linkedDataList.clearSortFilter()},N.prototype.removeColumnFilterAll=function(){return this._linkedDataList.removeColumnFilterAll()},N.prototype.setFilter=function(t){return t&&(t.internal=!0),this._linkedDataList.setFilter(t)},N.prototype.removeFilter=function(t,e){return t&&(t.internal=!0),this._linkedDataList.removeFilter(t,e)},N.prototype.clearFilter=function(){return this._linkedDataList.clearFilter()},N.prototype.sort=function(t,e){return this._linkedDataList.sort(t,e)},N.prototype.clearSort=function(){return this._linkedDataList.clearSort()},N.prototype.multisort=function(t){return this._linkedDataList.multisort(t)},N.prototype.getRowArray=function(t){try{return this._linkedDataList.getRowArray(t)}catch(t){s.Y.printStackTrace(t)}},N.prototype.removeRow=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._grid._dataList.removeRow(i,e)}catch(t){
s.Y.printStackTrace(t)}},N.prototype.removeRows=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(this._linkedDataList.getRealRowIndex(t[i]));return this._grid._dataList.removeRows(e)}catch(t){s.Y.printStackTrace(t)}},N.prototype.setRowData=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowData(o,e,i)}catch(t){s.Y.printStackTrace(t)}},N.prototype.setRowXML=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowXML(o,e,i)}catch(t){s.Y.printStackTrace(t)}},N.prototype.insertData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.insertData(i,e)}catch(t){s.Y.printStackTrace(t)}};var H=i(7455),G=function(t,e,i){var o;this.options=this._getDefaultOptionsMinimum(),t&&(o=t.getAttribute("escape")),!o&&e.element&&(o=e.element.getAttribute("escape"));var s=a.Z.getEscape(o,e.options.pluginName);this.options.escape=s?a.Z.getBoolean(s):this.options.escape,this.internal=!1,(i||"TD"==t.getTagName().toUpperCase())&&(this.internal=!0),this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),null!=this.mainGrid.scope_obj&&(this.options._scope_obj_uuid=this.mainGrid.scope_obj.uuid,this.scope_id=this.mainGrid.scope_obj.id),""!=this.options.value&&""==this.options.defaultValue&&(this.options.defaultValue=this.options.value),""==this.options.value&&""!=this.options.defaultValue&&(this.options.value=this.options.defaultValue),this.colID=this.options.col_id,this.id=this.options.col_id,this.options.id=this.options.col_id,this.setController(),this.initFormatter(t),this.initializeCellInfo(t,i),this.expressionStr=null,this.style="",this.heightGap=0;var n=r.I.browserVersion();if(r.I.browserCheck.ie&&"8"!=n&&(this.heightGap=2),""!=this.options.importExp&&(this.options.importExp=this.options.importExp.replace(/[cC][oO][lL][\s]*[(]/g,"_this.columnValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[xX][pP][aA][tT][hH][\s]*[(]/g,"_this.xpathValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.rowIndexValue(obfuscator_i")),(0==this.options.colSpan||isNaN(this.options.colSpan))&&(this.options.colSpan=1),(0==this.options.rowSpan||isNaN(this.options.rowSpan))&&(this.options.rowSpan=1),t){var l=!this.options.groupName||!this.options.groupValue,h=this.options.inputType;if(l&&("button"!=h&&"image"!=h)&&this.mainGrid.successBinding){var d=e._dataList.getCellInfo(this.id);!(!d||!d.element&&d.id!==this.id)||(this.options.readOnly=!0)}}"radio"==this.options.inputType&&this.options.groupName&&(this.mainGrid.radioGroupRepChk[this.options.groupName]=!0),"$blank"==this.options.NaNFormat&&(this.options.NaNFormat=""),this.changedCellHeight=0,this.dynamicAttrInfo={},"custom"==this.options.inputType&&(this.mainGrid.hasCustomInputType=!0),"expression"===this.options.inputType&&"true"!==this.options.expressionSort&&(this.mainGrid.expressionHeaderInfo[this.mainGrid.bodyToHeaderRelation[this.id]]=!0),"string"==typeof this.options.useItemLocale&&(this.options.useItemLocale=WebSquare.util.getBoolean(this.options.useItemLocale))};for(var W in G.prototype.defaultOptions={id:"",col_id:"",colIndex:"",colSpan:0,rowSpan:0,defaultValue:"",value:"",inputType:"text",useFilter:!1,blockSelect:!1,dataType:"",valueType:"binary",viewType:"",trueValue:null,falseValue:null,editType:"",applyFormat:"display",displayFormat:"",displayFormatter:"",chooseOptionLabel:"",chooseOptionValue:"",chooseOption:!1,allOption:!1,title:"",voidNull:!1,adjustMaxLength:!1,useMaxLength:!1,depthColumn:"",showDepth:0,importExp:"",importFormatter:"",expression:"",colMerge:!1,colMergeEdit:!1,upperColumn:"",readOnly:"",imageWidth:"",imageHeight:"",imageClickFunction:"",imageSrc:"",imageSrcDisabled:"",imageSrcReadOnly:"",useImageClick:!1,alt:"",calendarValueType:"yearMonthDate",disabled:"",textAlign:"",exportFormatter:"",imeMode:"",selectSetter:"",ignoreStatus:!1,
dateValidCheck:"",embeddedInput:"",groupName:"",escape:"false"!==r.I.getConfiguration("/WebSquare/escape/@value"),setRecursive:!1,showReadOnly:!1,customFormatter:"",escapeFormatter:"",depthType:"nbsp",moveFocusByChoice:"",directItemChoice:"",directOpen:!1,focusOutOnCheckHeaderClick:!0,keepFocusOnCheckHeaderClick:!1,usePartialCheck:!0,partialCheckNextClick:"",footerDiv:!1,displayRowIndex:!1,NaNFormat:"NaN",disabledClass:"",hiddenClass:"",displayMode:"0",delimiter:"\t",skipKeyMoveEditMode:!1,skipKeyMove:!1,checkboxLabel:"",checkboxLabelPosition:"right",checkboxLabelColumn:"",checkboxLabelFormatter:"",radioLabel:"",radioLabelPosition:"right",radioLabelColumn:"",radioLabelFormatter:"",checkAlways:!1,fixColumnWidth:!1,sortLabel:!1,useIOFormatLength:!1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",tooltipTime:1,minWidth:20,eventPriority:"onviewchange",customModelFormatter:"",customModelUnformatter:"",useMonthYearFormat:!1,editModeEventIcon:"",keepCellClass:!1,inputReadOnly:!1,keyMoveListSync:!1,tableRender:"",copyOption:"",invalidMessageFunc:"",dateValidSetCustom:!1,checkcomboboxUseDrag:!1,checkcomboboxUseEdit:!1,checkcomboboxRangeSeparator:"",checkcomboboxValidateOnInput:!1,checkcomboboxVisibleRowNum:0,checkcomboboxVisibleColNum:1,checkcomboboxVisibleColMax:1,placeholder:"",selectedData:!0,selectedDataDisplay:!0,refInitSync:!1,eventPropagation:!1,autoDecimalPoint:!1,useLocale:!1,noDisabledOnReadOnly:!1},G.prototype._getDefaultOptionsMinimum=function(){return{id:G.prototype.defaultOptions.id,col_id:G.prototype.defaultOptions.col_id,colIndex:G.prototype.defaultOptions.colIndex,value:G.prototype.defaultOptions.value,defaultValue:G.prototype.defaultOptions.defaultValue,inputType:G.prototype.defaultOptions.inputType,valueType:G.prototype.defaultOptions.valueType,viewType:G.prototype.defaultOptions.viewType,applyFormat:G.prototype.defaultOptions.applyFormat,displayFormat:G.prototype.defaultOptions.displayFormat,chooseOptionLabel:G.prototype.defaultOptions.chooseOptionLabel,chooseOptionValue:G.prototype.defaultOptions.chooseOptionValue,chooseOption:G.prototype.defaultOptions.chooseOption,title:G.prototype.defaultOptions.title,selectedData:G.prototype.defaultOptions.selectedData,selectedDataDisplay:G.prototype.defaultOptions.selectedDataDisplay,depthColumn:G.prototype.defaultOptions.depthColumn,showDepth:G.prototype.defaultOptions.showDepth,importExp:G.prototype.defaultOptions.importExp,expression:G.prototype.defaultOptions.expression,upperColumn:G.prototype.defaultOptions.upperColumn,readOnly:G.prototype.defaultOptions.readOnly,imageWidth:G.prototype.defaultOptions.imageWidth,imageHeight:G.prototype.defaultOptions.imageHeight,alt:G.prototype.defaultOptions.alt,calendarValueType:G.prototype.defaultOptions.calendarValueType,disabled:G.prototype.defaultOptions.disabled,textAlign:G.prototype.defaultOptions.textAlign,exportFormatter:G.prototype.defaultOptions.exportFormatter,imeMode:G.prototype.defaultOptions.imeMode,selectSetter:G.prototype.defaultOptions.selectSetter,dateValidCheck:G.prototype.defaultOptions.dateValidCheck,escape:G.prototype.defaultOptions.escape,depthType:G.prototype.defaultOptions.depthType,NaNFormat:G.prototype.defaultOptions.NaNFormat,disabledClass:G.prototype.defaultOptions.disabledClass,hiddenClass:G.prototype.defaultOptions.hiddenClass,displayMode:G.prototype.defaultOptions.displayMode,delimiter:G.prototype.defaultOptions.delimiter,skipKeyMove:G.prototype.defaultOptions.skipKeyMove,minWidth:G.prototype.defaultOptions.minWidth,keepCellClass:G.prototype.defaultOptions.keepCellClass,usePartialCheck:G.prototype.defaultOptions.usePartialCheck}},G.prototype._defaultOptionsKeyLowerCase={},G.prototype.defaultOptions)G.prototype._defaultOptionsKeyLowerCase[W.toLowerCase()]=W;G.prototype.setOptions=function(t,e){try{var i=this.mainGrid.options.pluginName,n=t.getAttribute("calendarValueType")||this.options.calendarValueType,l=t.getAttribute("inputType")||"text"
;this.configOptions=o.q.extend({},r.I.getConfig(i+"/column[@inputType='"+l+"']"));var h=t.getAttribute("dataType")||"text";this.configOptions2=o.q.extend({},r.I.getConfig(i+"/column[@dataType='"+h+"']")),"calendar"==l&&"grid"==i?this.configOptions.displayFormat=r.I.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@value')||r.I.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat/@value'):"calendar"==l&&"gridView"==i&&(this.configOptions.displayFormat=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@value')||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat/@value')||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@defaultValue')),"textarea"===l&&(this.configOptions.keepCellClass=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/keepCellClass/@value')),this.options=o.q.extendKeepingType(o.q.extendKeepingType(this.options,this.configOptions2),this.configOptions);var d=WebSquare.Parser.parseAttribute(t);for(var u in d){var p=d[u];"class"==u?this.options.className=p:""!=String(p).wq_trim()&&(this._defaultOptionsKeyLowerCase[u]&&(u=this._defaultOptionsKeyLowerCase[u]),"boolean"==typeof this.defaultOptions[u]?p=a.Z.getBoolean(p):"number"==typeof this.defaultOptions[u]&&(p=a.Z.getNumber(p)),this.options[u]=p)}if(!(h=this.options.dataType)&&this.mainGrid.successBinding&&(h=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"==h&&!this.options.displayFormat){if("calendar"===this.options.inputType&&this.options.displayFormatFunc){var c=a.Z.getGlobalFunction(this.options.displayFormatFunc,this.mainGrid.scope_id);"function"==typeof c&&(this.options.displayFormat=c.call(this,this.options.calendarValueType))}this.options.displayFormat||(this.options.displayFormat=r.I.getConfiguration("/WebSquare/"+i+"/dataType/date/@displayFormat"))}if("date"==h&&this.options.calendarDisplayFormatFunc&&!this.options.calendarDisplayFormat){var g=a.Z.getGlobalFunction(this.options.calendarDisplayFormatFunc,this.mainGrid.scope_id);"function"==typeof g&&(this.options.calendarDisplayFormat=g.call(this,this.options.calendarValueType))}if("time"!=h||this.options.displayFormat||(this.options.displayFormat="HH:mm"),this.mainGrid.options.senseReader&&"false"!==this.options.embeddedInput){var f=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textImage"]/embeddedInput/@value');switch(this.options.inputType||"text"){case"secret":case"text":case"textImage":"none"==this.mainGrid.options.focusMode&&"false"!=this.options.readOnly&&(this.options.readOnly=!0);case"select":case"checkbox":case"radio":case"calendar":"textImage"===this.options.inputType?a.Z.getBoolean(f)&&(this.options.embeddedInput=!0):this.options.embeddedInput=!0}}else this.options.embeddedInput=a.Z.getBoolean(this.options.embeddedInput);if("textarea"==this.options.inputType&&(this.options.showReadOnly=!0),this.element=t,"expression"==this.options.inputType){var m=this.options.expression;""!=m&&(m=m.replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(")).match("rowStatus")&&this.mainGrid.rowStatusColIDArr.push(this.options.col_id)}this.options.editModeEventIcon||(this.options.editModeEventIcon=this.mainGrid.options.editModeEventIcon);if(!0!=={onclick:!0,ondblclick:!0}[this.options.editModeEventIcon]&&(this.options.editModeEventIcon="onclick"),this.options.copyOption||(this.options.copyOption=this.mainGrid.options.copyOption),
this.options.chooseOptionLabel||("autoComplete"===this.options.inputType?this.options.chooseOptionLabel=WebSquare.language.getMessage("AutoComplete_choose")||"-choose-":"checkcombobox"===this.options.inputType?this.options.chooseOptionLabel=WebSquare.language.getMessage("CheckCombobox_choose")||"-choose-":this.options.chooseOptionLabel=WebSquare.language.getMessage("SelectBox_choose")||"-choose-"),this.options.embeddedInput&&"text"===this.options.inputType&&a.Z.getBoolean(this.options.readOnly)&&this.options.displayFormatter){var y=a.Z.getGlobalFunction(this.options.displayFormatter,this.mainGrid.scope_id);if("function"==typeof y){var b=y.toString(),v=b.match(/return\s+["'`].*?<.*>.*?["'`]/);if(v&&v.length>0){var w=v[0],C=w.match(/<\s*([A-Za-z]+)\s+/);C&&C.length>1&&(this._realInputType=C[1])}}}!this.element.getAttribute("minWidth")&&this.mainGrid.options.minWidth&&(this.options.minWidth=this.mainGrid.options.minWidth)}catch(t){s.Y.printStackTrace(t,null,this)}},G.prototype.setController=function(){switch(this.mainGrid.options.useTextMultiLink&&"text"===this.options.inputType&&this.options.customFormatter&&(this.options.inputType="user"),this.options.inputType){case"text":default:o.q.extend(this,WebSquare.uiplugin.cellInfo.text.prototype);break;case"link":o.q.extend(this,WebSquare.uiplugin.cellInfo.link.prototype);break;case"checkbox":o.q.extend(this,WebSquare.uiplugin.cellInfo.checkbox.prototype);break;case"button":o.q.extend(this,WebSquare.uiplugin.cellInfo.button.prototype);break;case"image":o.q.extend(this,WebSquare.uiplugin.cellInfo.image.prototype);break;case"radio":o.q.extend(this,WebSquare.uiplugin.cellInfo.radio.prototype);break;case"select":o.q.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.select.prototype);break;case"calendar":o.q.extend(this,WebSquare.uiplugin.cellInfo.calendar.prototype);break;case"textarea":o.q.extend(this,WebSquare.uiplugin.cellInfo.textarea.prototype);break;case"expression":o.q.extend(this,WebSquare.uiplugin.cellInfo.expression.prototype);break;case"drilldown":o.q.extend(this,WebSquare.uiplugin.cellInfo.text.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.drilldown.prototype);break;case"textImage":o.q.extend(this,WebSquare.uiplugin.cellInfo.textImage.prototype);break;case"checkcombobox":o.q.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.checkcombobox.prototype);break;case"autoComplete":o.q.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(this,WebSquare.uiplugin.cellInfo.autoComplete.prototype);break;case"spinner":o.q.extend(this,WebSquare.uiplugin.cellInfo.spinner.prototype);break;case"custom":o.q.extend(this,WebSquare.uiplugin.cellInfo.custom.prototype);break;case"user":o.q.extend(this,WebSquare.uiplugin.cellInfo.user.prototype)}},G.prototype.setInnerHTML=function(t,e,i,o,s){this.mainGrid._getWrapperCell(t,i).innerHTML=this.mainGrid.dataTagOpen+this.getDisplayData(e)+this.mainGrid.dataTagClose},G.prototype.setEditMode=function(t,e){this.mainGrid.editedCell=null,this.mainGrid.editMode=!1},G.prototype.initFormatter=function(t){try{var e=this.options.dataType;if(!e&&this.mainGrid.successBinding&&(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),!e&&this.options.expression){var i=this.options.expression;(i=(i=(i=(i=(i=(i=(i=(i=i.replace(/[sS][uU][mM][\s]*[(]/g,"NUMBER(")).replace(/[aA][vV][gG][\s]*[(]/g,"NUMBER(")).replace(/[mM][aA][xX][\s]*[(]/g,"NUMBER(")).replace(/[mM][iI][nN][\s]*[(]/g,"NUMBER(")).replace(/rowStatus[\s]*[(]/gi,"NUMBER(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"STRING(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"STRING(")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"STRING(")).indexOf("NUMBER(")>-1?e="number":i.indexOf("STRING(")>-1&&(e="text")}var o=e,a=this.mainGrid._isNumberType(e);a&&"\t"===this.options.delimiter&&(this.options.delimiter="")
;var n,l,h=this.options.displayFormat;if("text"==this.options.inputType&&!h)if(a)"euro"==e?(h||(h=this.mainGrid.options.euroMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/euroMask/@value')||""),n=".",l=","):"rupee"==e?(h||(h=this.mainGrid.options.rupeeMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/rupeeMask/@value')||""),n=",",l="."):"tenge"==e?(h||(h=this.mainGrid.options.tengeMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/tengeMask/@value')||""),n=" ",l=","):"number"!=e&&"float"!=e&&"bigDecimal"!=e||(h||(h=this.mainGrid.options.numberMask||r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/numberMask/@value')||""),n=",",l="."),this.options.displayFormat=h,this.options.delimiter||(this.options.delimiter=n),this.options.decimalDelimiter||(this.options.decimalDelimiter=l),this.options.customModelFormatter||(this.options.customModelFormatter=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelFormatter/@value')||""),this.options.customModelUnformatter||(this.options.customModelUnformatter=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelUnformatter/@value')||"");"date"!=o||"calendar"!=this.options.inputType||this.options.ioFormat||(this.options.ioFormat=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/ioFormat[@valueType="'+this.options.calendarValueType+'"]/@defaultValue'),this.options.ioFormat||("yearMonthDate"==this.options.calendarValueType?this.options.ioFormat="yyyyMMdd":"yearMonth"==this.options.calendarValueType?this.options.ioFormat="yyyyMM":"yearMonthDateTime"==this.options.calendarValueType?this.options.ioFormat="yyyyMMddHHmm":"yearMonthDateTimeSec"==this.options.calendarValueType&&(this.options.ioFormat="yyyyMMddHHmmSS"))),"default"==this.options.maskFormat&&this.options.displayFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("numberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("textMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):"reverse"==this.options.maskFormat&&this.options.displayFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("reverseNumberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("reverseTextMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):this.formatter="float"===o||"bigDecimal"===o?WebSquare.format.createFormatter(o,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.mainGrid.scope_id,this.mainGrid.id):WebSquare.format.createFormatter(o,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,null,null,this.mainGrid.scope_id,this.mainGrid.id),this.emptyFormatter=WebSquare.format.createFormatter(o,"",null,null,null,null,this.mainGrid.scope_id,this.mainGrid.id)
}catch(t){s.Y.printStackTrace(t)}},G.prototype.getDisplayData=function(t){return this.formatter&&(t=this.formatter.format(t)),"secret"==this.options.inputType&&(t=t.replace(/./gi,"")),t},G.prototype.getLocaleValue=function(t){try{var e;if(t)t===this.options.chooseOptionLabel?this.options.chooseOptionLabelLocaleRef&&(e=this.mainGrid.getLocaleValue(this.options.chooseOptionLabelLocaleRef)):(!0===this.options.useItemLocale||void 0===this.options.useItemLocale&&!0===this.mainGrid.useItemLocale)&&(e=this.mainGrid.getLocaleValue(t)),e&&(t=e);return t}catch(t){s.Y.printStackTrace(t,null,this)}},G.prototype.initializeCellInfo=function(){},G.prototype.handleEndEdit=function(t,e,i){try{if(t=t||{},i=i||{},this.options.embeddedInput)return!0;if(this.mainGrid.rollbackCommitFlag=!1,this.mainGrid.editedCell&&0==this.mainGrid.editMode&&(this.mainGrid.editMode=!0),this.mainGrid.editMode){var o=this.mainGrid.editedCell;if(o._getEditedValue){var a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.editRowIndex,l=this.mainGrid._getGroupbyDisplayRowIndex(n),h=o._getEditedValue();if(!0===this._editendCalled)return;if(this._editendCalled=!0,d=p.f.fireEvent(this.mainGrid,"oneditend",l,a,h,t),this._editendCalled=!1,d+""=="false")return this.mainGrid.getInput(this).focus(),p.f.stopEvent(t),!1}if(!o.validate())return p.f.stopEvent(t),!1;if(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,!i.otherClick){c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),this._handleEndEdit(t,e,i));var d=this._afterEndEdit(o,c,i);return o=null,d}var u=null,c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),u=this._handleEndEdit(t,e,i)),r.I.setTimer((function(t,e){null!=this.editTd&&this._handleEndEdit_focus(e),this._afterEndEdit(t,c,i),t=null,e=null}),{key:this.id+"_handleClickEventDocument",caller:this,args:[o,u]}),u=null,o=null}}catch(t){s.Y.printStackTrace(t,null,this)}},G.prototype._afterEndEdit=function(t,e,i){i=i||{};var o,s=this.mainGrid.dataList._getCellData(this.editRowIndex,t.options.id),r=this.editRowIndex,n=t.options.id,l=r,h=this.mainGrid.getColumnIndex(n);if(this.editTd){var d=a.Z.getDataPrefix("colMerged");o=this.editTd.getAttribute(d)}if("0"==o&&!t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped){var u=function(t,i,o,s){for(var r=t;t+1<this.mainGrid.getDataLength();){t+=1;var a=this.mainGrid.upperGroupingTest(t,i),n=this.mainGrid.dataList._getCellData(t,i);if(!a){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}for(t=r;t-1>=0;){a=this.mainGrid.upperGroupingTest(t,i);t-=1;n=this.mainGrid.dataList._getCellData(t,i);if(!a){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var h,l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}i=this.mainGrid.getColumnIndex(i);this.mainGrid.applyColumnStyleOptions(i)};u.call(this,r,n,h,s);var c=this.mainGrid.upperToLowerColumnRelation[n];if(c)for(var g=0;g<c.length;g++){var f=c[g],m=this.mainGrid.dataList._getCellData(r,f),y=this.mainGrid.getColumnIndex(f),b=this.mainGrid.getCellInfo(f);u.call(b,r,f,y,m)}}t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped&&this.mainGrid.setColMergeCellData(l-this.mainGrid.rowIndex,l,h);var v=this.mainGrid.dataList._getCellData(l,h);this.mainGrid.setMergedCellData(l,h,v);Math.abs(this.changedCellHeight)>3&&this.mainGrid.notifyRowChanged(l);var w=this.mainGrid._getGroupbyDisplayRowIndex(l)
;if(!this.mainGrid.options.viewChangeAfterEdit||!i.from_fireOnviewchange&&!i.from_handleClickEvent)var C=p.f.fireEvent(this.mainGrid,"onafteredit",w,h,v,this.mainGrid.lastEvent);return this.mainGrid.lastEvent=null,C=0!=C,this.mainGrid.rollbackCommitFlag=!0,C},G.prototype.handleScrollY=function(t,e,i){return this.validate()?this.handleEndEdit(t,void 0,i):this.handleCancelEdit(t)},G.prototype.validate=function(){return!0},G.prototype._handleEndEdit=function(t,e,i){var o=this._handleEndEdit_common(t);if((i=i||{}).otherClick)return o;this._handleEndEdit_focus(o,e,i.focuseChanged)},G.prototype._handleEndEdit_common=function(t,e){return null},G.prototype._handleEndEdit_focus=function(t){return null},G.prototype.handleCancelEdit=function(t){this.options.embeddedInput||(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,this._handleCancelEdit(t))},G.prototype._handleCancelEdit=function(t){},G.prototype.removeCellData=function(t,e){},G.prototype.doDefaultAction=function(t){},G.prototype.setMergedCol=function(t,e,i,o){var s=t,r=new Array;for(r[t]=!0;t<this.mainGrid.getDataLength();){if(t+=1,!(a=this.mainGrid.upperGroupingTest(t,e)))break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),r[t]=!0}for(t=s;t>0;){var a=this.mainGrid.upperGroupingTest(t,e);if(t-=1,!a)break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),r[t]=!0}e=this.mainGrid.getColumnIndex(e);return this.mainGrid.applyColumnStyleOptions(e),r},G.prototype.getEscape=function(){var t=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;return t=WebSquare.util.getBoolean(t)},G.prototype.getColumnIndex=function(t){return t||(t=this.colID),this.mainGrid.getColumnIndex(t)},G.prototype.setMaxLength=function(t){try{if(this.options.maxlength=this.options.maxLength=t,"autoComplete"==this.options.inputType)this.autoComplete&&this.autoComplete.setMaxLength(t);else if("text"!==this.options.inputType&&"secret"!==this.options.inputType||1!=this.options.embeddedInput){this.mainGrid.getInput(this).setMaxLength(t)}else for(var e=this.mainGrid.tdIdList.length,i=this.mainGrid.getColumnIndex(this.options.id),o=this.mainGrid.getRowCount(),r=0;r<o;r++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[r*e+i]).setMaxLength(t)}catch(t){s.Y.printStackTrace(t,null,this)}},G.prototype.setFloatMaxLength=function(t){try{this.options.maxlength=this.options.maxLength="-1",this.mainGrid.getInput(this).setFloatMaxLength(t)}catch(t){s.Y.printStackTrace(t,null,this)}},G.prototype.refreshCell=function(){},G.prototype._checkFastScroll=function(t,e,i,o){try{var r="string"!=typeof t||!1===this.mainGrid._regDetectDOM.test(t);return e&&null!=e.textContent&&this.mainGrid.hasClass(e,i)&&r&&!0===o}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl=function(){},G.itemsetControl.prototype.initializeCellInfo=function(t){try{if(this.internal&&this.initializeInfo?this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.initializeInfo.rowIndex+"_"+this.colID+"_"+this.id:this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.colID,"select"===this.options.inputType&&""!=this.options.selectSetter)this.selectSetted=!1,this.resetMatchInfo=!0;else{var e="";if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var i=(e=a.Z.isIE("6 7")&&this.internal&&t._element.outerHTML?WebSquare.xml.nodeWellFormed(t._element.outerHTML):WebSquare.xml.serialize(t._element)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"",r=this.options.inputType;e=(e=e.wq_replaceAll("<w2:column","<w2:"+r+i)).wq_replaceAll("</w2:column","</w2:"+r);var n=WebSquare.xml.parse(e,!0);this.xml=new WebSquare.Elem(n.documentElement)}o.q.extend(this,H.t.prototype),this.hasRef=!1,
"checkcombobox"!==this.options.inputType&&("select"===this.options.inputType?this.options.selectedIndex&&(this.selectedIndex=parseInt(this.options.selectedIndex,10)):this.selectedIndex=void 0===this.options.selectedIndex?-1:parseInt(this.options.selectedIndex,10)),this.options.selectedDataDisplay||(this.options.selectedData=!1),this.internal?this.itemsetObj=this.initializeInfo.itemSet?this.initializeInfo.itemSet:{nodeset:"",label:"",value:""}:this.itemsetObj=WebSquare.WebSquareparser.parseItemset(this.xml),this.resetMatchInfo=!0;var l=this.itemsetObj.nodeset.wq_replaceAll(" ","");if(this.internal&&"gridViewItemset"==this.options.itemTableType?this.existGridViewItemsetNode=!0:(this.existGridViewItemsetNode=WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:gridViewItemset")[0],this.existGridViewItemsetNode&&this.options.embeddedInput&&(c.v.printLog("not support embeddedInput in gridViewItemset ["+this.mainGrid.id+"."+this.id+"]"),this.options.embeddedInput=!1)),""!=this.itemsetObj.nodeset&&l.indexOf("ref(")>=0){this.hasRef=!0;var h=this.itemsetObj.nodeset;this.refStr='"'+this.refReplace(h)+'"';for(var d=h.match(/ref\('([^']*)'\)/g),u=0;u<d.length;u++){var p=d[u].slice(5,-2),g=this.mainGrid.getCellInfo(p);g.refArr||(g.refArr=[]),g.refArr.push(this.colID)}if(this.refHash=[],this.refItemArr=[],"select"===this.options.inputType&&this.options.embeddedInput)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset","")}else if(""!=this.itemsetObj.nodeset&&l.indexOf("data:")>=0){var f=this.itemsetObj.nodeset.replace("data:","").split(".");this.dataComp=f[0]}else this.matchInfo=this.setMatchInfo()}this.refArr||(this.refArr=[]),this._initializeCellInfo()}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype.getItemText=function(t){try{var e="";if(t>-1&&t<this.itemArr.length){e=this.itemArr[t].orgLabel||this.itemArr[t].label;var i=this.options.delimiter;switch(!0!==a.Z.getBoolean(this.options.hideDelimiter)||this.itemArr[t].value&&e||(i=""),this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}switch(this.options.displayMode){case"0":break;case"1":e=this.itemArr[t].value+i+e;break;case"2":e=e+i+this.itemArr[t].value;break;case"3":e=this.itemArr[t].value}}return e}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype._initDisplayMode=function(t){try{switch(this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype.setColumnNodeSet=function(t,e,i,o){try{if(this.internal)this.itemsetObj.nodeset=t,this.itemsetObj.label=e,this.itemsetObj.value=i;else{if("json"===this.xml._elementType){var a=[];a.push({N:"w2:label",T:1,A:{ref:e}}),a.push({N:"w2:value",T:1,A:{ref:i}});var n=WebSquare.Elem.api.getElementsByTagName(this.xml,"itemset",r.I._XML_NAMESPACE.W2)[0];n?(n._element.A.nodeset=t,n._element.E=a):this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:itemset",A:{nodeset:t},E:a}]}]}else{var l=WebSquare.xml.findNode(this.xml,"*['choices'=local-name()]['"+r.I._XML_NAMESPACE.W2+"'=namespace-uri()]");for(null==l&&(l=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,l));l&&l.firstChild;)l.removeChild(l.firstChild);var h="<w2:itemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+t+"'><w2:label ref='"+e+"'></w2:label><w2:value ref='"+i+"'></w2:value></w2:itemset>",d=WebSquare.xml.parse(h,!0).documentElement;WebSquare.xml.appendChild(l,d)}this.itemArr=[],this.initializeCellInfo(this.xml)}var u=this.options.inputType;if(1==this.options.embeddedInput){
var p=this.mainGrid.tdIdList.length,c=this.mainGrid.getColumnIndex(this.options.id);if(isNaN(o))for(var g=this.mainGrid.getRowCount(),f=this.mainGrid.rowIndex;f<g;f++){(m=this.mainGrid.data_td_list[(f-this.mainGrid.rowIndex)*p+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}else{var m,y=o-this.mainGrid.rowIndex;if(y>=0)(m=this.mainGrid.data_td_list[y*p+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}}else this[u]&&this[u].setNodeSet(t,e,i);t.indexOf("data:")>=0&&(this.dataComp=t.slice(5))}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype.setColumnGridItemset=function(t){try{if("select"!==this.options.inputType&&"autoComplete"!==this.options.inputType)return;var e=t.nodeset,i=t.label,o=t.value;if(this.internal)this.itemsetObj.nodeset=e,this.itemsetObj.label=i,this.itemsetObj.value=o;else{if("json"===this.xml._elementType){var a=[],n={};for(var h in t)"object"!==(0,l.A)(t[h])&&"function"!=typeof t[h]&&null!=t[h]&&(n[h]=t[h]);for(var d=0;d<t.item.length;d++)a.push({N:"w2:item",T:1,A:t.item[d]});var u=WebSquare.Elem.api.getElementsByTagName(this.xml,"gridViewItemset",r.I._XML_NAMESPACE.W2)[0];if(u){for(var h in n)u._element.A[h]=n[h];u._element.E=a}else this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:gridViewItemset",A:n,E:a}]}]}else{var p=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",r.I._XML_NAMESPACE.W2);for(null==p&&(p=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,p));p&&p.firstChild;)p.removeChild(p.firstChild);if(r.I.isXML(t))WebSquare.xml.appendChild(p,t);else{var c="<w2:gridViewItemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+e+"'></w2:gridViewItemset>",g=WebSquare.xml.parse(c,!0),f=g.documentElement;for(var m in t)if("item"===m)for(d=0;d<t.item.length;d++){var y=WebSquare.xml.createElement(g,"w2:item"),b=t.item[d];for(var v in b)y.setAttribute(v,b[v]);WebSquare.xml.appendChild(f,y)}else"nodeset"!==m&&f.setAttribute(m,t[m]);WebSquare.xml.appendChild(p,f)}}this.initializeCellInfo(this.xml)}if("select"===this.options.inputType&&1==this.options.embeddedInput){var w=this.mainGrid.tdIdList.length,C=this.mainGrid.getColumnIndex(this.options.id),I=this.mainGrid.getRowCount();for(d=0;d<I;d++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[d*w+C]).setGridItemset(t)}this[this.options.inputType]&&this[this.options.inputType].setGridItemset(t),e.indexOf("data:")>=0&&(this.dataComp=e.slice(5))}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype.getColumnDataListInfo=function(){try{if(this[this.options.inputType])return this[this.options.inputType].getDataListInfo();var t=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",r.I._XML_NAMESPACE.W2)[0];if(t){var e=WebSquare.WebSquareparser.parseItemset(t),i={};return e&&""!==e.nodeset?(e.nodeset.match("data:")?(i.nodeset=e.nodeset.slice(0),i.id=i.nodeset.wq_replaceAll("data:",""),i.value=e.value,i.label=e.label):(i.nodeset=e.nodeset.slice(0),i.value=e.value,i.label=e.label),i):null}return null}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype.getDisplayData=function(t,e,i){var o=this.getData(t,e,i);return null==o&&(o=""),i&&i.emptyValue&&o===i.emptyValue?o="":o!=t&&""==o&&(o=t),o},G.itemsetControl.prototype.setMatchInfo=function(t){this.modelControl=new WebSquare.modelControl(this.colID,this.options.model,this.options.ref,this.options.bind,this.options._scope_obj_uuid),this.existGridViewItemsetNode?this.initializeGridViewItemArr(this.xml):this.initializeItemArr(this.xml),0==this.itemArr.length?this.resetMatchInfo=!0:this.resetMatchInfo=!1;for(var e=0;e<this.itemArr.length;e++)this.itemArr[e].label=this.getItemText(e);var i={};if(1==this.options.allOption){var o=WebSquare.language.getMessage("Grid_all")||"-all-";this.itemArr=[{label:o,value:WebSquare.allValue}].concat(this.itemArr)}if(1==this.options.chooseOption&&"checkcombobox"!==this.options.inputType){var s=this.options.chooseOptionLabel;"$blank"==s&&(s=""),this.itemArr=[{label:s,
value:this.options.chooseOptionValue}].concat(this.itemArr)}this.hasRef&&(this.refItemArr[this.itemsetObj.nodeset]=this.itemArr);var r=this.options.inputType.toUpperCase();for(e=0;e<this.itemArr.length;e++){var a=this.itemArr[e];i[r+"_"+a.value]=a.label}return i},G.itemsetControl.prototype.getMatchInfo=function(t){var e=[];return"select"===this.options.inputType&&""!=this.options.selectSetter?e=this.matchInfo:this.hasRef?e=this.getRefMatchInfo(t):this.hasRef||(this.resetMatchInfo&&(this.matchInfo=this.setMatchInfo(t)),e=this.matchInfo),e},G.itemsetControl.prototype.getRefMatchInfo=function(t){this.targetRowIndex=t;var e=new Function("_this","return "+this.refStr)(this);if(null==this.refHash[e]||this.resetMatchInfo){this.itemsetObj.nodeset=e,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",e);var i=this.setMatchInfo(t);return this.refHash[e]=i,i}return this.refHash[e]},G.itemsetControl.prototype.getRefItemArr=function(t){this.getRefMatchInfo(t);var e=new Function("_this","return "+this.refStr)(this);return this.refItemArr[e]},G.itemsetControl.prototype.getRefValue=function(t){return'"'+this.mainGrid.dataList._getCellData(this.targetRowIndex,t)+'"'},G.itemsetControl.prototype.refReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"\"+_this.getRefValue('$1')+\"");return e!=t?this.refReplace(e):e}catch(t){s.Y.printStackTrace(t,null,this)}},G.itemsetControl.prototype.refXmlReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"'+_this.getRefValue('$1')+'");return e!=t?this.refXmlReplace(e):e}catch(t){s.Y.printStackTrace(t,null,this)}},G.text=function(){},G.text.prototype.getDisplayData=function(t){(this.formatter&&(t=this.formatter.format(t)),"text"==this.options.inputType&&this.options.editFormat&&""!=t)&&(t=WebSquare.text.dynamicMask(t,this._editFormat,this._editTokens).value);return"secret"==this.options.inputType&&(t=t.replace(/./gi,"")),t},G.text.prototype.setInnerHTML=function(t,e,i,o,n){var l=this.mainGrid._getGroupbyDisplayRowIndex(i),h=this.mainGrid._getWrapperCell(t,i);if(!this.options.embeddedInput||this.mainGrid._getEditDisabled(i,o)||this.mainGrid.___getEditReadOnly(i,o)||this.mainGrid.groupbyStatus.grouped){if(this.mainGrid.options.titleFormatter)try{var d;if("function"!=typeof this.mainGrid.options.titleFormatter){var u=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof u&&(this.mainGrid.options.titleFormatter=u,d=u.call(this,i,o,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",d)}catch(t){s.Y.printStackTrace(t,null,this)}else if(this.options.title)t.setAttribute("title",this.options.title);else if(this.mainGrid.options.titleAuto){var p=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.colID])||"";t.setAttribute("title",p)}var c=WebSquare.util.getDataPrefix("editModeEvent");"onclick"===this.options.editModeEvent||"ondblclick"===this.options.editModeEvent||"onsecondclick"===this.options.editModeEvent?t.setAttribute(c,this.options.editModeEvent):t.setAttribute(c,"");var g=null;if(this.options.escapeFormatter)try{"function"==typeof this.options.escapeFormatter?g=this.options.escapeFormatter:"function"==typeof(g=a.Z.getGlobalFunction(this.options.escapeFormatter,this.scope_id))&&(this.options.escapeFormatter=g)}catch(t){g=null}Y=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?Y=this.options.customFormatter:"function"==typeof(Y=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=Y)}catch(t){Y=null}var f=null;if(this.options.customModelUnformatter)try{"function"==typeof this.options.customModelUnformatter?f=this.options.customModelUnformatter:"function"==typeof(f=a.Z.getGlobalFunction(this.options.customModelUnformatter,this.scope_id))&&(this.options.customModelUnformatter=f)}catch(t){f=null}var m=e;if(f&&this.options.customModelUnformatter?(this.useCustomModelFormatter=!0,
m=f.call(this.mainGrid,e,l,o)):this.useCustomModelFormatter=!1,this.options.maskFormat&&this.options.displayFormat&&(m=this.mainGrid.getInput(this,t,e).maskFormatModelUnFormat(m)),"function"==typeof g?(this.useEscapeFormatter=!0,m=g.call(this.mainGrid,e,l,o)):this.useEscapeFormatter=!1,this.getEscape()&&(m=this.useCustomModelFormatter||this.options.maskFormat&&this.options.displayFormat?WebSquare.xml._encode(m+""):WebSquare.xml._encode(e+"")),this.options.maskFormat){m=this.maskFormatModelFormat(m);z=this.mainGrid._dataList.getColumnIndex(this.colID),U=this.mainGrid._grid.getRealRowIndex(i);this.mainGrid._dataList.dataArr[U*this.mainGrid._dataList.getColumnCount()+z]=m}Z=m;if(this.options.editFormat&&this.options.editFormat.length>0){var y={"#":{pattern:/\d/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},"!":{escape:!0}},b=this.options.editFormat.split("||").sort((function(t,e){return t.replace(/[^a-z^A-Z^0-9]/g,"").length-e.replace(/[^a-z^A-Z^0-9]/g,"").length}));Z=WebSquare.text.dynamicMask(Z,b,y).value,this._editFormat=b,this._editTokens=y}j=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat||this._changeDisplayFormat;if(this.formatter&&j&&(Z=this.formatter.format(m)),"secret"==this.options.inputType&&(Z=Z.replace(/./gi,"")),"function"==typeof Y?(this.useCustomFormatter=!0,X=Y.call(this.mainGrid,e,Z,l,o)):(this.useCustomFormatter=!1,X=Z),this.mainGrid.options.plainText&&!1===this.useCustomFormatter&&!this.options.displayFormatter&&h.firstChild&&h.firstChild.firstChild)h.firstChild.firstChild.data=X;else{var v=this.mainGrid.___getEditReadOnly(i,o),w=this.mainGrid._getEditDisabled(i,o),C="",I=[];I.push("w2grid_input"),this.mainGrid.options.checkEditableInputClass&&(v||w)&&(I=[]),"secret"==this.options.inputType&&r.I.browserCheck.ieAllVersion&&I.push("w2grid_secret"),v&&I.push("w2grid_input_readonly"),w&&I.push("w2grid_input_disabled");var _=h.firstChild,x=this._checkFastScroll(X,_,"w2grid_input",n&&!0===n.scroll);if(_&&(!w&&_.className.indexOf("w2grid_input_disabled")>-1||w&&-1===_.className.indexOf("w2grid_input_disabled")||!v&&_.className.indexOf("w2grid_input_readonly")>-1||v&&-1===_.className.indexOf("w2grid_input_readonly"))&&(x=!1),x&&this.getEscape()){var S="string"==typeof X?WebSquare.xml.__decode2(X):X;_.textContent=S}else{"span"==this.mainGrid.options.dataTag&&I.push("w2grid_span"),C=" class='",C+=I.join(" "),C+="'";var R=!1,D=h.firstChild;this.getEscape()&&D&&("NOBR"===D.tagName||"SPAN"===D.tagName&&D.className.indexOf("w2grid_span")>-1)&&" class='"+D.getAttribute("class")+"'"===C&&1===D.attributes.length&&(R=!0),R?h.firstChild.innerHTML=X:h.innerHTML="<"+this.mainGrid.options.dataTag+" "+C+">"+X+this.mainGrid.dataTagClose}this.mainGrid.hasClass(t,"w2grid_input_table")||(t.className="w2grid_input_table "+t.className)}}else{var T=this.mainGrid.getInput(this,t,e);null==this.mainGrid._getWrapperTD(T.render.parentNode)&&(h.innerHTML="",h.appendChild(T.render)),T.blur();var L=a.Z.getDataPrefix("rowindex");T.render.setAttribute(L,i);var k=!1;if(this.mainGrid.options.autoResizeEmbeddedInput){var F=!1;this.mainGrid.__bResizeObj?(F=this.mainGrid.__bResizeObj.width!==this.mainGrid.resizeObj.width||this.mainGrid.__bResizeObj.height!==this.mainGrid.resizeObj.height,this.mainGrid.__bResizeObj.width=this.mainGrid.resizeObj.width,this.mainGrid.__bResizeObj.height=this.mainGrid.resizeObj.height):this.mainGrid.__bResizeObj={width:this.mainGrid.resizeObj.width,height:this.mainGrid.resizeObj.height},k=!0!==T._autoResizeEmbeddedInput&&!1===F||this.mainGrid.__bResizeObj.isColumnResizing}if(!0===k){var A=0,E=0,M=!1,O=(this.mainGrid.oneRowLength,this.mainGrid._bodyIdMultiRowIndexMap[this.colID]);if("none"==t.parentNode.style.display){for(var N=O,H=t.parentNode;N>0;)"none"==H.previousElementSibling.style.display&&(H.previousElementSibling.style.display=""),H=H.previousElementSibling,N--;t.parentNode.style.display="",M=!0}null==this.mainGrid._getWrapperTD(T.render.parentNode)&&(h.innerHTML="",
h.appendChild(T.render)),this.mainGrid.embeddedStyleObj||(this.mainGrid.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(T.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(T.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(T.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(T.render,"padding-right"),10)});var G=parseInt(WebSquare.style.getStyle(T.render,"border-top-width"),10),W=parseInt(WebSquare.style.getStyle(T.render,"border-bottom-width"),10),B=parseInt(WebSquare.style.getStyle(T.render,"border-left-width"),10),V=parseInt(WebSquare.style.getStyle(T.render,"border-right-width"),10);A=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),A-=this.mainGrid.embeddedStyleObj.top+this.mainGrid.embeddedStyleObj.bottom,A-=G+W;var q=o;if(this.mainGrid.embeddedWidthObj[q]&&!this.mainGrid.embeddedWidthObj[q].isChanged||(this.mainGrid.embeddedWidthObj[q]={isChanged:!1,width:t.clientWidth}),E=this.mainGrid.embeddedWidthObj[o].width,E-=this.mainGrid.embeddedStyleObj.left+this.mainGrid.embeddedStyleObj.right,E-=B+V,E-=this.mainGrid.embeddedStyleObj.inputLeft+this.mainGrid.embeddedStyleObj.inputRight,M){for(N=O,H=t.parentNode;N>0;)H.previousElementSibling.style.display="none",H=H.previousElementSibling,N--;t.parentNode.style.display="none"}else(a.Z.isIE("6 7")||a.Z.isSpartan())&&(A-=2);a.Z.isOpera()&&(A+=2),T.setSize(E-2,A-(this.mainGrid.embeddedStyleObj.inputTop+this.mainGrid.embeddedStyleObj.inputBottom)),T.setStyle("lineHeight",A+"px"),T._autoResizeEmbeddedInput=!0}else null==this.mainGrid._getWrapperTD(T.render.parentNode)&&(h.innerHTML="",h.appendChild(T.render));"all"==this.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||(e=this.getDisplayData(e));var Y=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?Y=this.options.customFormatter:"function"==typeof(Y=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=Y)}catch(t){Y=null}var Z=e,j=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.options.maskFormat){var P=Z;this.options.displayFormat&&(P=T.maskFormatModelUnFormat(P)),P=this.maskFormatModelFormat(P);var z=this.mainGrid._dataList.getColumnIndex(this.colID),U=this.mainGrid._grid.getRealRowIndex(i);this.mainGrid._dataList.dataArr[U*this.mainGrid._dataList.getColumnCount()+z]=P}if(this.formatter&&j&&(Z=this.formatter.format(Z)),T.setValue(e),"function"==typeof Y){this.useCustomFormatter=!0;var X=Y.call(this.mainGrid,e,Z,l,o);T.render.value=X}this.options.textAlign?T.setStyle("text-align",this.options.textAlign):T.setStyle("text-align",""),t.removeAttribute("tabIndex"),t.removeAttribute("title")}},G.text.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);this.comp=i,this.options.maskFormat&&this.options.displayFormat||(i.formatter="all"==this.options.applyFormat||!0===this._changeDisplayFormat||"date"==this.options.dataType?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat);var o=this.mainGrid.dataList._getCellData(e,this.colID);if("all"===this.options.applyFormat&&this.options.displayFormat&&"text"!=this.options.dataType&&"date"!=this.options.dataType&&"time"!=this.options.dataType){var r=this.options.decimalDelimeter||".",n=(o+"").split(r);n[1]&&0==parseInt(n[1])&&(o=n[0])}i.setValue(o),document.activeElement!=i.render&&i.focus(),
!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType?i.select():"focus"==i.options.editType&&(a.Z.isIEAllVersion()||a.Z.isFF()||a.Z.isSpartan())&&WebSquare.text.setCaretPos(i.render,i.render.value.length)}catch(t){s.Y.printStackTrace(t,null,this)}},G.text.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(a.Z.isFF()?t={top:-1,left:0,width:0,height:0}:a.Z.isOpera()?t={top:0,left:0,width:0,height:1}:a.Z.isIEAllVersion("9 10 11")?t={top:-1,left:-1,width:0,height:0}:a.Z.isSpartan()&&(t={top:0,left:-1,width:0,height:0}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,r=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}this.mainGrid.hasClass("w2grid_adaptive_crosstab")&&(s-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,l.render.style.lineHeight=n+"px");l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=r+"px",l.render.style.height=n+"px",a.Z.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(l.render.id,3)},G.text.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},G.text.prototype._handleEndEdit_common=function(t){try{if(!this.options.embeddedInput){var e=this.mainGrid.getInput(this);return this.setEditData(e),e}}catch(t){s.Y.printStackTrace(t,null,this)}},G.text.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t&&t.hide()},G.text.prototype._getEditedValue=function(t){return"bigDecimal"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")?WebSquare.bigDecimal(this.mainGrid.getInput(this).getValue()).toString():this.mainGrid.getInput(this).getValue()},G.text.prototype._handleCancelEdit=function(t){try{var e,i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide(),e=window.getSelection?window.getSelection():document.selection;var o=document.createRange();o.selectNodeContents(this.editTd),e.removeAllRanges(),e.addRange(o),e.collapseToStart()}catch(t){s.Y.printStackTrace(t,null,this)}},G.text.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.text.prototype.setEditData=function(t){try{var e=t.getValue();if("number"==(o=this.mainGrid.getColumnOption(this.id,"dataType"))||"float"==o){var i=e.wq_trim();"."!==i&&"-"!==i&&"+"!==i||(e="")}e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var o=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==o&&""!=e&&(e=Number(e));var r={};r[this.mainGrid.id]=!0;var n=a.Z.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof n){this.useCustomModelFormatter=!0;var l=this.getDisplayData(e);e=n.call(this.mainGrid,e,l,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1
;if(e=this.maskFormatModelFormat(e),"float"===o&&e[e.length-1]===t.options.decimalDelimiter){var h=e.split(t.options.decimalDelimiter);e=h[0]}this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,r)}catch(t){s.Y.printStackTrace(t,null,this)}},G.text.prototype.maskFormatModelFormat=function(t){try{if(!t)return t;var e="";if(this.options.maskFormat&&this.options.displayFormat)if(this.options.maskFormatModelExcludeChar)for(var i=this.options.maskFormatModelExcludeChar.split(""),o=0;o<t.length;o++){for(var r=!1,a=0;a<i.length;a++)if(t[o]==i[a]){r=!0;break}r||(e+=t[o])}else e=t;else e=t;return e}catch(t){s.Y.printStackTrace(t,null,this)}},G.link=function(){},G.link.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l=" tabIndex='-1' ";"none"==this.mainGrid.options.focusMode?l=" tabIndex='0' ":1==this.mainGrid.options.keyMoveEditMode&&(l=""),this.getEscape()&&(e=WebSquare.xml._encode(e+""));var h,d,u=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),p=this.getDisplayData(e);if("function"==typeof u?(this.useCustomFormatter=!0,h=u.call(this.mainGrid,e,p,i,o)):(this.useCustomFormatter=!1,h=p),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var c=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof c&&(this.mainGrid.options.titleFormatter=c,d=c.call(this,i,o,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.Y.printStackTrace(t,null,this)}var g="";(d?g=" title='"+d+"'":this.options.title&&(g=" title='"+this.options.title+"'"),g)||this.mainGrid.options.titleAuto&&(g=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.colID])||"")+"'");var f=this.options.voidNull?"javascript:void(null);":"",m="";1==this.mainGrid.options.accessibility&&(m="id='"+this.mainGrid.id+"_link_"+i+"_"+o+"'"),n.innerHTML=h||g?this.mainGrid.dataTagOpen+"<a "+m+" href='"+f+"' onclick='event.returnValue=false; return false;'"+l+" "+g+">"+h+"</a>"+this.mainGrid.dataTagClose:this.mainGrid.dataTagOpen+this.mainGrid.dataTagClose},G.link.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=p.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=a.Z.getDataPrefix("col_id"),r=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),r=n.focusedColIndex}this.mainGrid._getEditDisabled(i,r)||this.mainGrid.___getEditReadOnly(i,r)||p.f.fireEvent(this.mainGrid,"oncellclick",o,r,this.options.id)},G.checkbox=function(){},G.checkbox.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":"$blank"==this.options.trueValue&&(this.options.trueValue=""),"$blank"==this.options.falseValue&&(this.options.falseValue=""),this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.embeddedInput&&(this.mainGrid.options.preventMultipleClick=!1),this.options.checkboxLabelColumn)for(var e=this.options.checkboxLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}void 0!==this.options.focusOutOnCheckHeaderClick&&(this.options.keepFocusOnCheckHeaderClick=!this.options.focusOutOnCheckHeaderClick)},G.checkbox.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},G.checkbox.prototype.setInnerHTML=function(t,e,i){var o,r=this.mainGrid._getWrapperCell(t,i),n=e+""==this.options.trueValue,l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("rowindex")
;if(o=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute(l)):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute(l)),this.options.embeddedInput){var d=this.mainGrid.getInput(this,t,n);d.setAttribute(h,i),d.checked=n,d.disabled=o}else{var u,g;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var f=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.mainGrid.options.titleFormatter=f,g=this.mainGrid.getColumnIndex(this.options.id),u=f.call(this,i,g,e))}else u=this.mainGrid.options.titleFormatter.call(this,i,g,e)}catch(t){s.Y.printStackTrace(t,null,this)}var m=u||this.options.title||"";if(m)m=" title='"+m+"'";else if(this.mainGrid.options.titleAuto){var y=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.colID])||"";m=n?" title='"+y+WebSquare.language.getMessage("Grid_title")+"'":" title='"+y+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}var b="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",v=n?" checked":"",w=o?" disabled='true'":"",C=this.options.visibleFunc,I="";if(this.options.checkboxLabel||this.options.checkboxLabelColumn||this.options.checkboxLabelFormatter){var _=this.mainGridId+"_checkbox_"+this.id,x=_+"_"+i,S=this.options.checkboxLabel||"";if(this.options.checkboxLabelColumn){for(var R=this.options.checkboxLabelColumn.split(","),D="",T=this.options.checkboxLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",L=0;L<R.length;L++){var k=this.mainGrid.bodyToHeaderRelation[R[L]];if(L===R.length-1)this.mainGrid.options.showCheckboxLabelUserFormat?D+=" "+this.mainGrid.getHeaderValue(k)+" "+this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0}):D+=this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0});else if(this.mainGrid.options.showCheckboxLabelUserFormat){var F=WebSquare.language.getMessage("Grid_row")||"row";D+=(0===L?i+1+F+T:"")+" "+this.mainGrid.getHeaderValue(k)+" "+this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0})+T}else D+=this.mainGrid._getCellDisplayData(i,R[L],{removeTag:!0})+T}S=S?D+T+S:D}if(this.options.checkboxLabelFormatter)try{var A=a.Z.getGlobalFunction(this.options.checkboxLabelFormatter,this.scope_id);"function"==typeof A&&(S=A.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),S))}catch(t){c.v.printLog(this.mainGrid.id+"_"+this.id+" checkboxLabelFormatter error : "+t.message)}S&&this.mainGrid.options.titleAuto&&!this.options.title&&(m=m.substring(0,m.length-1)+" "+S+"'"),I="<INPUT type='checkbox' "+m+b+v+w+" id='"+x+"' name='"+_+"'/>",this.getEscape()&&(S=WebSquare.xml._encode(S+""));var E="<label class='w2checkbox_label ' for='"+x+"'>"+S+"</label>";"left"===this.options.checkboxLabelPosition?I=E+I:I+=E}else I="<INPUT type='checkbox' "+m+b+v+w+" />";if(C){var M,O=a.Z.getGlobalFunction(C,this.scope_id);"function"==typeof O&&(M=O(i)),r.innerHTML=M?I:""}else r.innerHTML=I;if(this.options.noDisabledOnReadOnly)(N=r.getElementsByTagName("input")[0])&&(p.f.addListener(N,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&p.f.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(N,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(N,this.mainGrid.options.readOnlyClass+"_nodisabled"));if(this.mainGrid.options.preventMultipleClick){var N=r.getElementsByTagName("input")[0],H=r.getElementsByTagName("label")[0];this.labelClicked=!1,N&&p.f.addListener(N,"onclick",function(t,e,i){return function(o){t.options.eventPropagation||p.f.stopPropagation(o);var s=!1,r=t.colID;t.mainGrid.getColumnIndex(r);if(!0===t.mainGrid.options.useShiftKeyCheck&&o.shiftKey){var a={td:e[1],rowIndex:e[0],checked:this.checked};t.mainGrid._ShiftKeyMultiCheck(t.mainGrid,a,e[1]),s=!0}e[2]=o.detail,e[3]=s,i.apply(t,e,o)}
}(this,[i,t],(function(t,e,i,o){i=this.labelClicked?0:1,this.labelClicked=!1;var s,r,a,n,l,h,d,u=null!=this.mainGrid.editedCell;u&&(s=this.mainGrid.editedCell.editRowIndex,r=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),d=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.mainGrid._grid.getRealRowIndex(s),l=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+r],h=d.comp&&d.comp.selectedIndex);var c,f,m,y=e.getElementsByTagName("input")[0];if(y&&(c=y.checked,f=this.options.falseValue,c&&(f=this.options.trueValue),""!=(m=this.mainGrid.dataList._getCellData(t,this.colID))||c||(f=m)),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):!0!==o&&this.mainGrid._addFocus(e)),this.handleClick(e,t,!0),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):!0!==o&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),!0===this.mainGrid.options.useShiftKeyCheck&&(this.mainGrid.beforeChecked={td:e,rowIndex:t,checked:y.checked}),t=this.mainGrid._getGroupbyDisplayRowIndex(t),y&&m!=f){var b=this.mainGrid.getColumnIndex(this.options.id),v={oldValue:m,newValue:f,rowIndex:t,colIndex:b,colId:this.mainGrid.getColumnID(b)};p.f.fireEvent(this.mainGrid,"onviewchange",v)}if(this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,g)&&p.f.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:c}),u){var w=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+r];if(l!=w){var C={oldValue:l,newValue:w,rowIndex:s,colIndex:a,colId:this.mainGrid.getColumnID(a)};isNaN(h)||(C.oldSelectedIndex=h,C.newSelectedIndex=d&&d.comp&&d.comp.selectedIndex),p.f.fireEvent(this.mainGrid,"onviewchange",C)}}}))),H&&p.f.addListener(H,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}},G.checkbox.prototype.getDisplayData=function(t){return t},G.checkbox.prototype.handleClick=function(t,e,i){var o=a.Z.getDataPrefix("col_id");if(this.mainGrid.__getEditReadOnly(t,e)||this.mainGrid._getEditDisabled(e,t.getAttribute(o))||!this.options.embeddedInput&&this.mainGrid.options.preventMultipleClick&&!i&&!this.mainGrid.options.checkOnCellClick)return!0;null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var s=t.getElementsByTagName("input")[0];if(s){var r=s.checked,n=this.options.falseValue;r&&(n=this.options.trueValue);var l=this.mainGrid.dataList._getCellData(e,this.colID);""!=l||r||(n=l);var h=null;(h={})[this.mainGrid.id]=!0,this.mainGrid._isGridViewItemTable()||this.mainGrid.dataList.__setCellData(e,this.colID,n,null,null,null,h);var d=a.Z.getDataPrefix("colMerged");"0"==t.getAttribute(d)&&this.setMergedCol(e,this.colID,l,n);var u=this.mainGrid.getColumnIndex(this.colID);if(this.mainGrid.setMergedCellData(e,u,n),l!=n&&!i){var c={oldValue:l,newValue:n,rowIndex:e,colIndex:u,colId:this.mainGrid.getColumnID(u)};p.f.fireEvent(this.mainGrid,"onviewchange",c)}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}return!0},G.checkbox.prototype.checkHeader=function(){try{return this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}catch(t){s.Y.printStackTrace(t,null,this)}},G.checkbox.prototype.doDefaultAction=function(t){if(!this.options.embeddedInput){var e=p.f.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(e.focus();e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID
}else i=this.mainGrid.getLastFocusedCell().focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID;var r=!1;if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var a,n,l=e.getElementsByTagName("input")[0];if(l&&(l.checked?(a=this.options.falseValue,l.checked=!1):(a=this.options.trueValue,l.checked=!0),n=this.mainGrid.dataList._getCellData(i,s)),this.handleClick(e,i,!0),a!=n){var h=this.mainGrid.getColumnIndex(s);p.f.fireEvent(this.mainGrid,"onviewchange",{oldValue:n,newValue:a,rowIndex:o,colIndex:h,colId:this.mainGrid.getColumnID(h)})}r=!0}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID]),this.mainGrid.options.preventMultipleClick&&r&&p.f.fireEvent(this.mainGrid,"oncellclick",i,this.mainGrid.getColumnIndex(s),this.options.id,{checked:l.checked})}},G.checkbox.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.button=function(){},G.button.prototype.setInnerHTML=function(t,e,i){try{var o=a.Z.getDataPrefix("col_id"),r=this.mainGrid._getEditDisabled(i,t.getAttribute(o)),n="";r&&(n=" disabled ");var l,h=this.mainGrid._getWrapperCell(t,i),d=this.mainGrid.getColumnIndex(t.getAttribute(o)),u=" tabIndex='-1'";if(this.mainGrid.___getEditReadOnly(i,d)||r?u=" tabIndex='-1'":"none"==this.mainGrid.options.focusMode?u=" tabIndex='0'":1==this.mainGrid.options.keyMoveEditMode&&(u="",u=0==this.mainGrid.getColumnVisible(d)?" tabIndex='-1'":""),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var c=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof c&&(this.mainGrid.options.titleFormatter=c,l=c.call(this,i,d,e))}else l=this.mainGrid.options.titleFormatter.call(this,i,d,e)}catch(t){s.Y.printStackTrace(t,null,this)}var g=l||this.options.title||"";if(g)g=" title='"+g+"'";else if(this.mainGrid.options.titleAuto)g=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.colID])||"")+"'";this.getEscape()&&(e=WebSquare.xml._encode(e+""));var f="id='"+this.mainGrid.id+"_button_"+i+"_"+d+"'";if(h.innerHTML="<button type='button' "+f+" style='width:100%;height:100%' "+n+u+g+">"+this.getDisplayData(e)+"</button>",1==this.internal){var m=h.childNodes[0];if(0==m.clientHeight){var y=t.clientHeight-2;WebSquare.style.setSize(m,"height",y)}}this._listener=(b=this,v=[i,d,t],w=function(t,e,i,o){null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit(),(!0===this.mainGrid.options.readOnlyButtonFocusAllow?!this.mainGrid._getEditDisabled(e,i):!this.mainGrid._getEditDisabled(e,i)&&!this.mainGrid.___getEditReadOnly(e,i))&&(this.options.blockSelect||this.mainGrid.__setFocusedCell(t,o,{editMode:"none"==this.options.focusMode})),this.mainGrid._getEditDisabled(e,i)||p.f.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(e),i,this.options.id)},function(t){w.apply(b,[t||window.event].concat(v))}),p.f.addListener(h.getElementsByTagName("button")[0],"onclick",this._listener)}catch(t){s.Y.printStackTrace(t,null,this)}var b,v,w},G.button.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=p.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=a.Z.getDataPrefix("col_id"),r=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),r=n.focusedColIndex}this.mainGrid._getEditDisabled(i,r)||this.mainGrid.___getEditReadOnly(i,r)||p.f.fireEvent(this.mainGrid,"oncellclick",o,r,this.options.id)},G.image=function(){},
G.image.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l="";""!=this.options.imageWidth&&(l+=";width:"+parseInt(this.options.imageWidth)+"px"),""!=this.options.imageHeight&&(l+=";height:"+parseInt(this.options.imageHeight)+"px"),t.removeAttribute("alt");var h="";""!=this.options.alt&&(h="alt='"+this.options.alt+"' ");var d=a.Z.getDataPrefix("col_id"),u=this.mainGrid._getEditDisabled(i,t.getAttribute(d)),c="";u&&(c=" disabled='true' "),null==e||""==e?e=this.options.imageSrc?this.options.imageSrc.startsWith("javascript:void")?this.options.imageSrc:this.mainGrid.getImageURL(this.options.imageSrc):"":"string"!=typeof e||e.startsWith("javascript:void")||(e=this.mainGrid.getImageURL(e));var g="";try{this.options.onerror&&(g=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.Y.printStackTrace(t,null,this)}var f,m=this.options.imageTabIndex?" tabIndex='"+this.options.imageTabIndex+"'":"";if(this.mainGrid.options.senseReader&&this.mainGrid.options.focusImage?n.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(u?" w2grid_image_disabled":"")+"' style='"+l+"' "+h+c+g+m+"tabIndex='0' />":n.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(u?" w2grid_image_disabled":"")+"' style='"+l+"' "+h+c+g+m+" />",this.options.imageClickFunction&&(f=this.mainGrid._getEditDisabled(i,o)),this.options.imageClickFunction&&(this.options.useImageClick||0==f)){var y=n.firstChild,b=function(t,e,i){return function(o){p.f.stopPropagation(o),t._setFocusedCell(e,i),t.fireImageClick(e,i)}}(this.mainGrid,i,this.colID);p.f.addListener(y,"onclick",b)}if(this.mainGrid.options.titleFormatter)try{var v;o=this.mainGrid.getColumnIndex(t.getAttribute(d));if("function"!=typeof this.mainGrid.options.titleFormatter){var w=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof w&&(this.mainGrid.options.titleFormatter=w,v=w.call(this,i,o,e))}else v=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",v)}catch(t){s.Y.printStackTrace(t,null,this)}},G.image.prototype.getDisplayData=function(t){return t},G.radio=function(){},G.radio.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.groupRef&&(this.options.groupValue=WebSquare.ModelUtil.getInstanceValue(this.options.groupRef,null,this.scope_id)),this.options.radioLabelColumn)for(var e=this.options.radioLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}},G.radio.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},G.radio.prototype.setInnerHTML=function(t,e,i){try{var o=this.mainGrid._getWrapperCell(t,i),r=this.getColumnIndex(this.colID);if(this.mainGrid.getMerged(i,r)&&!this.mainGrid.cellMergeInfo[i+"_"+r])return;var n=a.Z.getDataPrefix("col_id"),l=a.Z.getDataPrefix("rowindex"),h=this.mainGridId+"_radio_"+(this.options.groupName?this.options.groupName+"_"+i:this.colID);this.options.cellGroupName&&(h=this.mainGridId+"_radio_"+this.options.cellGroupName);var d,u=e+""==this.options.trueValue;if(d=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute(n)):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute(n)),this.options.embeddedInput){var g=this.mainGrid.getInput(this,t,u);g.setAttribute(l,i),g.checked=!1,g.name=h,g.checked=u,g.disabled=d}else{var f;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var m=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof m&&(this.mainGrid.options.titleFormatter=m,r=this.mainGrid.getColumnIndex(this.options.id),f=m.call(this,i,r,e))
}else f=this.mainGrid.options.titleFormatter.call(this,i,r,e)}catch(t){s.Y.printStackTrace(t,null,this)}var y=f||this.options.title||"";if(y)y=" title='"+y+"'";else if(this.mainGrid.options.titleAuto){var b=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.colID])||"";y=u?" title='"+b+WebSquare.language.getMessage("Grid_title")+"'":" title='"+b+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}var v="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",w=u?" checked":"",C=d?" disabled='true'":"",I="";if(this.options.radioLabel||this.options.radioLabelColumn||this.options.radioLabelFormatter){var _=this.mainGridId+"_radio_"+this.id+"_"+i,x=this.options.radioLabel||"";if(this.options.radioLabelColumn){for(var S=this.options.radioLabelColumn.split(","),R="",D=this.options.radioLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",T=0;T<S.length;T++){var L=this.mainGrid.bodyToHeaderRelation[S[T]];if(T===S.length-1)this.mainGrid.options.showRadioLabelUserFormat?R+=" "+this.mainGrid.getHeaderValue(L)+" "+this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0}):R+=this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0});else if(this.mainGrid.options.showRadioLabelUserFormat){var k=WebSquare.language.getMessage("Grid_row")||"row";R+=(0===T?i+1+k+D:"")+" "+this.mainGrid.getHeaderValue(L)+" "+this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0})+D}else R+=this.mainGrid._getCellDisplayData(i,S[T],{removeTag:!0})+D}x=x?R+D+x:R}if(this.options.radioLabelFormatter)try{var F=a.Z.getGlobalFunction(this.options.radioLabelFormatter,this.scope_id);"function"==typeof F&&(x=F.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),x))}catch(t){c.v.printLog(this.mainGrid.id+"_"+this.id+" radioLabelFormatter error : "+t.message)}x&&this.mainGrid.options.titleAuto&&!this.options.title&&(y=y.substring(0,y.length-1)+" "+x+"'"),I="<INPUT type='radio' "+y+v+w+C+" id='"+_+"' name='"+h+"'/>",this.getEscape()&&(x=WebSquare.xml._encode(x+""));var A="<label class='w2radio_label ' for='"+_+"'>"+x+"</label>";"left"===this.options.radioLabelPosition?I=A+I:I+=A}else I="<INPUT type='radio' name='"+h+"'"+y+v+w+C+" />";o.innerHTML=I;var E=o.getElementsByTagName("input")[0];if(this.options.noDisabledOnReadOnly&&E&&(p.f.addListener(E,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&p.f.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(E,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(E,this.mainGrid.options.readOnlyClass+"_nodisabled")),this.mainGrid.options.preventDuplicateFocusedCell&&this.mainGrid.options.preventMultipleClick){var M=o.getElementsByTagName("label")[0];this.labelClicked=!1,E&&p.f.addListener(E,"onclick",(O=this,N=[i,t],H=function(t,e,i){i=this.labelClicked?0:1,this.labelClicked=!1;var o,s,a,n,l,h,d,c=null!=this.mainGrid.editedCell;if(c&&(o=this.mainGrid.editedCell.editRowIndex,s=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),d=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.mainGrid._grid.getRealRowIndex(o),l=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+s],h=d.comp&&d.comp.selectedIndex),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):this.mainGrid._addFocus(e)),this.handleClick(e,t),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),
this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,r)&&p.f.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:u}),c){var g=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+s];if(l!=g){var f={oldValue:l,newValue:g,rowIndex:o,colIndex:a,colId:this.mainGrid.getColumnID(a)};isNaN(h)||(f.oldSelectedIndex=h,f.newSelectedIndex=d&&d.comp&&d.comp.selectedIndex),p.f.fireEvent(this.mainGrid,"onviewchange",f)}}},function(t){O.options.eventPropagation||p.f.stopPropagation(t),N[2]=t.detail,H.apply(O,N,t)})),M&&p.f.addListener(M,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}}catch(t){s.Y.printStackTrace(t,null,this)}var O,N,H},G.radio.prototype.getDisplayData=function(t){return t},G.radio.prototype.handleClick=function(t,e){try{var i=t.getElementsByTagName("input")[0];if(!i)return!0;if(this.options.noDisabledOnReadOnly&&this.mainGrid._getEditReadOnly(e,this.colID))return!0;this.mainGrid.options.preventDuplicateFocusedCell&&null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var o=this.mainGrid.dataList._getCellData(e,this.colID),r=o;if(o==this.options.trueValue)return!0;i.checked&&(r=this.options.trueValue,this.resetOthers(e),this.options.groupName&&this.mainGrid.radioGroupRepChk[this.options.groupName]&&this.mainGrid.dataList.__setCellData(e,this.options.groupName,this.options.groupValue)),this.mainGrid.dataList.__setCellData(e,this.colID,r);var n=a.Z.getDataPrefix("colMerged");"0"!=t.getAttribute(n)||this.mainGrid.groupbyStatus.grouped||this.setMergedCol(e,this.colID,o,r);var l=this.getColumnIndex(this.colID);if(this.mainGrid.setMergedCellData(e,l,r),o!=r){var h={oldValue:o,newValue:r,colIndex:l,rowIndex:e,colId:this.mainGrid.getColumnID(l)};p.f.fireEvent(this.mainGrid,"onviewchange",h)}return!0}catch(t){s.Y.printStackTrace(t,null,this)}},G.radio.prototype.resetOthers=function(t){if(this.options.groupName)for(var e=this.mainGrid.getColumnCount(),i=0;i<e;i++){"custom"==(s=this.mainGrid.getCellInfo(i)).options.inputType&&(s=s.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(t)]),s!=this&&"radio"==s.options.inputType&&s.options.groupName==this.options.groupName&&this.mainGrid.dataList.__setCellData(t,i,s.options.falseValue)}else if(this.options.cellGroupName)for(var o=0;o<this.mainGrid.getDataLength();o++){var s;"custom"==(s=this.mainGrid.getCellInfo(this.getColumnIndex(this.colID))).options.inputType&&(s=s.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(o)]);"radio"==s.options.inputType&&s.options.cellGroupName==this.options.cellGroupName&&this.mainGrid.dataList._getCellData(o,this.colID)+""==s.options.trueValue&&this.mainGrid.dataList.__setCellData(o,this.colID,s.options.falseValue)}else if(this.mainGrid.isDrillDown&&this.mainGrid._dataList.options.depthColumn)for(o=0;o<this.mainGrid.getTotalRow();o++)this.mainGrid._dataList.getCellData(o,this.colID)+""==this.options.trueValue&&this.mainGrid._dataList.setCellData(o,this.colID,this.options.falseValue);else for(o=0;o<this.mainGrid.getDataLength();o++)this.mainGrid.dataList._getCellData(o,this.colID)+""==this.options.trueValue&&this.mainGrid.dataList.__setCellData(o,this.colID,this.options.falseValue)},G.radio.prototype.doDefaultAction=function(t){var e=p.f.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(;e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=a.Z.getDataPrefix("col_id"),s=this.mainGrid.getColumnIndex(e.getAttribute(o))}else{var r=this.mainGrid.getLastFocusedCell();i=r.focusedRowIndex,s=r.focusedColIndex;this.options.embeddedInput&&"INPUT"==e.tagName.toUpperCase()&&(e=r.focusedTd)}if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var n=this.mainGrid.dataList._getCellData(i,this.colID)
;("INPUT"==e.tagName.toUpperCase()?e:e.getElementsByTagName("input")[0]).checked=n==this.options.trueValue?this.options.falseValue:this.options.trueValue,this.handleClick(e,i)}},G.radio.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.select=function(){},G.select.prototype._initializeCellInfo=function(){try{this.col_index=this.mainGrid.getColumnIndex(this.colID),"auto"===this.options.renderType&&a.Z.isMobile()&&!0!==this.options.embeddedInput&&(this.options.embeddedInput=!0)}catch(t){s.Y.printStackTrace(t,null,this)}},G.select.prototype._createComponent=function(t){try{if(this.comp)return;var e=this;if(this.xml.setAttribute("class",this.mainGridId+"_select_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("chooseOptionValue",this.options.chooseOptionValue),this.xml.setAttribute("allOption",this.options.allOption+""),this.xml.setAttribute("tableRender",this.options.tableRender),this.xml.setAttribute("submenuSize",this.options.submenuSize?this.options.submenuSize:"auto"),this.xml.setAttribute("direction","auto"),this.xml.setAttribute("style",this.style),this.setFirst=!0,this.hasRef&&!this.useLinkedDataList)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.setFirst=!1,this.configOptions.chooseOption=this.options.chooseOption,this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel,this.configOptions.labelWidthAuto=!1,this.configOptions.displayMode=this.options.displayMode,this.configOptions.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay,this.configOptions.itemTooltipFormatter=this.options.itemTooltipFormatter,this.options.itemTooltipFormatter&&(this.configOptions._rowIndex=t,this.configOptions._colIndex=this.mainGrid.getColumnIndex(this.colID)),this.configOptions.tooltipTime=this.options.tooltipTime,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.configOptions.tableRender=this.options.tableRender,this.internal&&(this.options.visibleRowNum&&(this.configOptions.visibleRowNum=this.options.visibleRowNum),this.options.textAlign&&(this.configOptions.textAlign=this.options.textAlign),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions));var i=this.internal?this.mainGridId+"_selectbox_"+t+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;this.internal&&this.options.emptyItem&&(this.configOptions.emptyItem=this.options.emptyItem),this.select=new WebSquare.uiplugin.selectbox(i,this.configOptions,this.xml),this.mainGrid.dom[this.select.id]=this.select,this.comp=this.select,this.select.setSelectedIndex1=function(t,i){void 0!==i&&null!=i||(i={});var o=this.selectedIndex,s=this.getValue(),r=e.mainGrid.getColumnIndex(e.mainGrid.editedCell.id);if(this.setSelectedIndex(t),e.mainGrid._setSelectedIndex(e.editRowIndex,r,t),"oneditend"===e.options.eventPriority){if(!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit()),o!=this.selectedIndex){var a=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:r,colId:e.mainGrid.getColumnID(r)};p.f.fireEvent(e.mainGrid,"onviewchange",n)}}else{if(o!=this.selectedIndex){a=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),
oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:r,colId:e.mainGrid.getColumnID(r)};p.f.fireEvent(e.mainGrid,"onviewchange",n)}!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit())}},this.existGridViewItemsetNode&&(this.select._setSubLayer=this.select.setSubLayer,this.select.setSubLayer=function(t){this._setSubLayer(t),this.itemTable.addKeyDownEventListener((function(t){if(27===t.keyCode)e.handleCancelEdit(t)}))}),this.select.__openSubLayer=this.select.openSubLayer,this.select.openSubLayer=function(){this.__openSubLayer()},this.select.__closeSubLayer=this.select.closeSubLayer,this.select.closeSubLayer=function(t){this.__closeSubLayer(t),e.mainGrid._setFocusedCell()},this.select._handleClickEvent=this.select.handleClickEvent,this.select.handleClickEvent=function(t){this._handleClickEvent(t),p.f.stopEvent(t),e.handleEndEdit()},this.select._refreshItemset=this.select.refreshItemset,this.select.refreshItemset=function(t){e.resetMatchInfo=!0,!0!==this.refreshStopItemTable&&this._refreshItemset(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.select.prototype.createSelectbox=function(t,e){var i=this.mainGrid._getWrapperCell(t,e);this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this._createComponent(e),i.innerHTML=this.select.toHTML();try{!this.select.modelControl.isBinded()&&-1===this.select.selectedIndex&&this.select.getItemCount()>0&&!this.select.options.chooseOption&&this.select.options.allOption}catch(t){s.Y.printStackTrace(t,null,this)}if(this.select.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),""!=this.options.selectSetter)for(var o=0;o<this.itemArr.length;o++)this.select.addItem(this.itemArr[o].value,this.itemArr[o].label);this._setSize(t),this.select.render.style.border="1px solid "+this.mainGrid.options.selectedCellColor},G.select.prototype._setSize=function(t){try{var e={top:0,left:0,bottom:0,right:0};if(a.Z.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(e.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),e.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),e.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),e.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else{var i=WebSquare.style.getComputedStyle(t);i&&(i.padding||i.paddingTop||i.paddingBottom||i.paddingLeft||i.paddingRight)&&(e.left=parseInt(i.paddingLeft,10),e.right=parseInt(i.paddingRight,10),e.top=parseInt(i.paddingTop,10),e.bottom=parseInt(i.paddingBottom,10))}this.select.setSize(t.clientWidth-(2+e.left+e.right),t.clientHeight-(2+e.top+e.bottom))}catch(t){s.Y.printStackTrace(t,null,this)}},G.select.prototype.createItemTable=function(t,e){var i=this;this.existGridViewItemsetNode&&this.select._openOtherLayer(),this.select.setSubLayer();var o=this.select.itemTable;o.addClickEventListener((function(t,e){i.select.setSelectedIndex1(e);var o=i.mainGrid.getLastFocusedCell();if(i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell(),i.options.moveEditModeByChoice){var s=!0,r=i.options.moveEditModeByChoice;switch(r){case"down":i.mainGrid.moveVertical({},r,s);break;case"right":i.mainGrid.moveHorizontal({byApi:!0},r,s)}}})),this.existGridViewItemsetNode?o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t);var e=i.mainGrid.getLastFocusedCell();i.editRowIndex==e.focusedRowIndex&&i.col_index==e.focusedColIndex&&("down"==i.mainGrid.options.tabKeyMove?i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode):"none"==i.mainGrid.options.tabKeyMove||i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode));break;case 27:i.handleCancelEdit(t)}
})):o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:if("ul"==this.options.tableRender){var e=this.getSelectedIndex();e=parseInt(e),this.endReached&&(this.endReached=!1,i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid._setFocusedCell())}else{this.fireClick(t);var o=i.mainGrid.getLastFocusedCell();i.editRowIndex==o.focusedRowIndex&&i.col_index==o.focusedColIndex&&("down"==i.mainGrid.options.tabKeyMove?i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode):"none"==i.mainGrid.options.tabKeyMove||i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode))}break;case 13:o=i.mainGrid.getLastFocusedCell();i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||(i.mainGrid.options.fastEditMode?"none"==i.mainGrid.options.enterKeyMove||("right"==i.mainGrid.options.enterKeyMove?i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode):i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode)):i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell());break;case 27:i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell()}})),a.Z.isOpera()&&o.event.addListener(o.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||p.f.preventDefault(t)})),this.mainGrid._moveKeyEdit(o.uuid,"keyDownFunc",{itemTable:!0}),WebSquare.WebSquaredoc.itemsetElement.length>0&&WebSquare.WebSquaredoc.itemsetElement[WebSquare.WebSquaredoc.itemsetElement.length-1].id==this.mainGridId+"_selectbox_"+this.colID&&WebSquare.WebSquaredoc.itemsetElement.pop()},G.select.prototype.setInnerHTML=function(t,e,i,o,r){var n=this.mainGrid._getWrapperCell(t,i),l=a.Z.getDataPrefix("col_id"),h=a.Z.getDataPrefix("rowindex"),d=this.mainGrid._getGroupbyDisplayRowIndex(i);if(this.options.embeddedInput&&!this.mainGrid.groupbyStatus.grouped){var u=this.mainGrid.getInput(this,t,e);if(u.render.setAttribute(h,i),""==this.options.selectSetter||this.dataComp||(this.initSelectSetter(),u.itemArr=this.itemArr,u.setSelectOptions()),this.hasRef&&!this.dataComp){var c=this.mainGrid.getElemRowIndex(t);u.itemArr=this.getRefItemArr(c),u.setSelectOptions()}if(this.dataComp){var g=this.mainGrid.modelControl.getDataComp(this.dataComp);if("linkedDataList"===g.initializeType&&null!=g.conditionInfo&&g.conditionInfo.filterInfo.useRef){var f=g.conditionInfo.targetInfo,m={};for(var y in f){var b=this.mainGrid.modelControl.getDataComp(y);if(b&&null!=b.initializeType&&"dataMap"!==b.initializeType){var v=b.getRowPosition();v!=i&&(m[y]=v,"linkedDataList"===b.initializeType?b._dataList.rowPosition=b.filteredRowIndexArr[i]:b.rowPosition=i)}}for(var w in u.stopRefreshItemTable(!0),g.syncWithParent(),u.stopRefreshItemTable(!1),m){var C=this.mainGrid.modelControl.getDataComp(w);"linkedDataList"===C.initializeType?C._dataList.rowPosition=C.filteredRowIndexArr[m[w]]:C.rowPosition=m[w]}for(var I=g.getAllJSON(),_=[],x=0;x<I.length;x++)_.push({label:I[x][this.itemsetObj.label],value:I[x][this.itemsetObj.value]});if(u.setNodeSet("",this.itemsetObj.label,this.itemsetObj.value),u.itemArr=_,1==u.options.allOption&&(u.itemArr=[{label:u.defaultAllOptionLabel,value:WebSquare.allValue}].concat(u.itemArr)),1==u.options.chooseOption){var S=u._getChooseOptionLabel();S=WebSquare.xml.decode(S).replace("&nbsp;"," "),u.itemArr=[{label:S,value:u.options.chooseOptionValue}].concat(u.itemArr)}u.setSelectOptions()}}u.setValue(e);var R=u.getValue();if(!u.setValueNM(e)&&!this.dataComp||""===e&&R!==e){var D={};D[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(u.render.getAttribute(h),o,R,null,null,null,D)}var T=!1;this.mainGrid._getEditDisabled(i,o)?(u.setDisabled(!0),T=!0):u.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?(u.setReadOnly(!0),!0===this.options.noDisabledOnReadOnly?this.mainGrid.addClass(t,this.mainGrid.options.readOnlyClass+"_nodisabled"):T=!0):(u.setReadOnly(!1),
!0===this.options.noDisabledOnReadOnly&&this.mainGrid.removeClass(t,this.mainGrid.options.readOnlyClass+"_nodisabled")),u.dom.select.disabled=!!T,t.removeAttribute("tabIndex")}else{this.initSelectSetter();c=i;null==e&&(e="");var L,k=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof k){this.useCustomFormatter=!0;S=this.getDisplayData(e,c);this.getEscape()&&(S=WebSquare.xml._encode(S+"")),L=k.call(this.mainGrid,e,S,d,o)}else this.useCustomFormatter=!1,L=this.getData(e,c),this.getEscape()&&(L=WebSquare.xml._encode(L+""));var F,A=this.internal?this.mainGridId+"_selectbox_"+i+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var E=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof E&&(this.mainGrid.options.titleFormatter=E,F=E.call(this,i,o,e))}else F=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.Y.printStackTrace(t,null,this)}var M=F||this.options.title||"";if(M)t.setAttribute("title",M);else if(this.mainGrid.options.titleAuto){var O=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.colID])||"";M=""!==e?" title='"+O+" "+e+"'":" title='"+O+WebSquare.language.getMessage("Grid_select")+"'"}if(a.Z.isSafari()&&-1!=navigator.userAgent.indexOf("Windows"))if(this.mainGrid.options.plainText&&n.firstChild&&n.firstChild.firstChild)n.firstChild.firstChild.data=L;else{n.innerHTML="";var N=document.createElement(this.mainGrid.options.dataTag);"span"==this.mainGrid.options.dataTag&&(N.className="w2grid_span"),N.style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:100%;","ul"==this.options.tableRender?N.innerHTML="<a href='#"+A+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+M+">"+L+"</a>":N.textContent=L,n.appendChild(N)}else if(this.mainGrid.options.plainText&&n.firstChild&&n.firstChild.firstChild)n.firstChild.firstChild.data=L;else if("icon"==this.options.viewType){n.innerHTML="";N=document.createElement(this.mainGrid.options.dataTag);"span"==this.mainGrid.options.dataTag&&(N.className="w2grid_span"),N.style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:auto;","ul"==this.options.tableRender?N.innerHTML="<a href='#"+A+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+M+">"+L+"</a>":N.innerHTML=L,n.appendChild(N)}else{var H="";if("span"==this.mainGrid.options.dataTag&&(H=" w2grid_span"),"ul"==this.options.tableRender)n.innerHTML="<"+this.mainGrid.options.dataTag+"style='overflow : hidden; text-overflow:ellipsis; display:block; width:auto;'><a href='#"+A+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main"+H+"'"+M+">"+L+"</a>"+this.mainGrid.dataTagClose;else{var G=n.firstChild,W="w2grid_select"+H;if(this._checkFastScroll(L,G,W,r&&!0===r.scroll)){var B="string"==typeof L?WebSquare.xml.__decode(L):L;G.textContent=B}else n.innerHTML="<"+this.mainGrid.options.dataTag+" class='"+W+"'>"+L+this.mainGrid.dataTagClose}}var V=this.mainGrid.dataList.getRealRowIndex(i),q=this.mainGrid.getCellOption(V,o,"viewType"),Y=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),Z=a.Z.getDataPrefix("editModeEvent");if("icon"==q||""==q&&"own"==Y?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute(Z,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent||"ondblclick"==this.options.editModeEvent||"onsecondclick"==this.options.editModeEvent?t.setAttribute(Z,this.options.editModeEvent):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute(Z,"")),"ul"==this.options.tableRender){var j=this;this.mainGrid.event.addListener(t,"onfocus",this.mainGrid.event.bindAsEventListener(this.mainGrid,(function(t){var e=p.f.getTarget(t);j.mainGrid.lastEvent=t
;var o=j.mainGrid.getLastFocusedCell();if((0!=o.focusedColIndex||0!=o.focusedRowIndex)&&(!a.Z.isIEAllVersion()||!o.focusedRowIndex||o.focusedRowIndex==i)&&(o.focusedTd==e||j.mainGrid.focusedByApi||j.mainGrid._setFocusedCell(i,e.getAttribute(l)),j.mainGrid.focusedByApi=!1,e.childNodes[0]&&e.childNodes[0].childNodes[0])){var s=e.childNodes[0].childNodes[0];"A"==s.tagName&&s.focus()}})))}}},G.select.prototype.setColumnChooseOption=function(t,e){this.options.chooseOption=!0,this.options.chooseOptionValue=t,this.options.chooseOptionLabel=e,this.select&&this.select.changeChooseOption(t,e)},G.select.prototype.showChooseOption=function(t){if(this.options.chooseOption=t,this.matchInfo=this.setMatchInfo(),this.select&&t)this.select.showChooseOption(t);else if(this.select&&!t){this.select.showChooseOption(t),this.select.itemArr.length>1&&0!=this.select.selectedIndex?this.select.selectedIndex-=1:this.select.selectedIndex=0,this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).innerHTML=this.mainGrid.dataTagOpen+this.getData(this.select.getValue(),this.select.selectedIndex)+this.mainGrid.dataTagClose}},G.select.prototype.getData=function(t,e,i){try{var o,a="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice(5))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var u in h){var p=this.mainGrid.modelControl.getDataComp(u);if(p&&null!=p.initializeType&&"dataMap"!==p.initializeType){var c=p.getRowPosition();c!=e&&(d[u]=c,"linkedDataList"===p.initializeType?p._dataList.rowPosition=p.filteredRowIndexArr[e]:p.rowPosition=e)}}for(var g in this.select&&this.select.stopRefreshItemTable(!0),o.syncWithParent(),this.select&&this.select.stopRefreshItemTable(!1),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var v=m.getTotalRow();y=[];for(var w=0;w<v;w++)y.push(w)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}var C=!1;if("linkedDataList"===o.initializeType&&this.select){var I=this.select.getItemCount(),_=this.select.itemArr;0===I?C=!0:1!=I||_[0].label!==this.select._getChooseOptionLabel()&&_[0].label!==this.select.defaultAllOptionLabel?2==I&&_[0].label===this.select._getChooseOptionLabel()&&_[1].label===this.select.defaultAllOptionLabel&&(C=!0):C=!0}if((!this.select||C)&&null!=m)try{var x,S;a="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)x=this.itemsetObj.label,S=this.itemsetObj.value;else{var R=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),D=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);R.length>0&&D.length>0&&(x=WebSquare.Elem.api.getAttribute(R[0],"ref"),S=WebSquare.Elem.api.getAttribute(D[0],"ref"))}var T=null!=x?m.bodyIdColIndexMap[x]:m.bodyIdColIndexMap[this.itemsetObj.label],L=null!=S?m.bodyIdColIndexMap[S]:m.bodyIdColIndexMap[this.itemsetObj.value];for(w=0;w<y.length;w++){var k=y[w]*m.cellIdList.length;if(t==m.dataArr[k+L])return a=m.dataArr[k+T],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t),i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}
var F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],A=this.selectedIndex||this.mainGrid._getSelectedIndex(e,F);if(A>=0&&A<b.length&&!this.options.chooseOption){a=m.dataArr[b[A]*m.cellIdList.length+T],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t);k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var E=this.mainGrid._dataList.cellIdList.length,M=(F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],m.dataArr[y[A]*m.cellIdList.length+L]);this.mainGrid._dataList.dataArr[k*E+F]=M}else if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)a=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)a="";else{k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];E=this.mainGrid._dataList.cellIdList.length,F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[k*E+F]="",a=""}else a=this.options.selectedDataDisplay?t:"";return i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}catch(e){return s.Y.printStackTrace(e,null,this),a=this.getLocaleValue(t)}var O=!1;for(w=0;w<this.select.itemArr.length;w++)if((t||-1!=N)&&this.select.itemArr[w].value==t){O=!0,a=this.select.itemArr[w].label;break}var N=this.mainGrid._getSelectedIndex(e,this.mainGrid._dataList.bodyIdColIndexMap[this.colID]);if(!O&&o.options&&o.options.validateAllItemsetData)for(w=0;w<this.select.allItemArr.length;w++)if(this.select.allItemArr[w].value==t){O=!0,a=this.select.allItemArr[w].label;break}if(!O)if(""!=t||-1==N||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?a=this.options.chooseOptionLabel:this.options.selectedData||(a=this.options.selectedDataDisplay?t:"");else this.select.itemArr.length>0?(a=this.select.itemArr[N].label,this.mainGrid.dataList.__setCellData(e,this.colID,a)):a=t}else{var H=this.getMatchInfo(e);N=this.mainGrid._getSelectedIndex(e,this.mainGrid.bodyIdColIndexMap[this.colID]);""!=t||-1==N||this.options.chooseOption?a=H["SELECT_"+t]:(this.mainGrid.dataList.__setCellData(e,t),a=H["SELECT_"+this.itemArr[N].label])}if(i&&i.emptyValue&&(""===a||"$blank"==a))a=i.emptyValue;else if(void 0===a||"$blank"==a)return"";return a=this.getLocaleValue(a)}catch(t){s.Y.printStackTrace(t,null,this)}},G.select.prototype.initSelectSetter=function(){if(0==this.selectSetted&&""!=this.options.selectSetter&&!this.dataComp){this.selectSetted=!0;var t=[];try{this.options.selectSetter=this.options.selectSetter.wq_trim(),this.options.selectSetter.indexOf("(")<0&&(this.options.selectSetter+="()"),t=new Function("return "+this.options.selectSetter)()}catch(t){s.Y.printStackTrace(t)}this.itemArr=t,this.matchInfo=[];for(var e=0;e<t.length;e++){var i=t[e];null==i.value&&(i.value=""),this.matchInfo["SELECT_"+i.value]=i.label}}},G.select.prototype.setEditMode=function(t,e){if(!this.options.embeddedInput){var i=this.mainGrid._getWrapperCell(t,e);if(this.dataComp){var o=this.mainGrid.modelControl.getDataComp(this.dataComp);o&&"linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef&&o.syncWithParent()}if(!0!==this._init?(this.createSelectbox(t,e),this._init=!0):(i.innerHTML="",this.mainGrid.cellMergeInfo&&this._setSize(t),i.appendChild(this.select.render),this.options.itemTooltipFormatter&&(this.select.options._rowIndex=e)),this.mainGrid.directItemChoiceKeyObj.select){
this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID));var s=this.select.findItemStartedWithKeyChar(this.mainGrid.directItemChoiceKeyObj.select);if(this.mainGrid.dataList.__setCellData(e,this.colID,this.select.getValue()),this.mainGrid.directItemChoiceKeyObj.select=null,this.options.moveFocusByChoice&&s&&this.moveFocus(this.editRowIndex,this.colID),s)return;this.mainGrid.editedCell=this.mainGrid.getCellInfo(t),i.innerHTML="",i.appendChild(this.select.render)}if(this.select.itemTable||this.mainGrid.directItemChoiceKeyObj.select||(this.existGridViewItemsetNode&&(this.editTd=t),this.createItemTable(t,e)),this.hasRef&&!this.dataComp){var r=this.mainGrid.getElemRowIndex(t);this.select.itemArr=this.getRefItemArr(r),this.select.itemTable.show(),this.select.setSelectOptions()}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),0==this.select.getItemCount()&&(this.select.selectedIndex=-1,this.select.dom.label.innerHTML=""),this.existGridViewItemsetNode&&this.select.gridViewOptions.width)this.select.openSubLayer();else{var n=t.clientWidth-2,l={top:0,left:0,bottom:0,right:0};if(a.Z.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(l.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),l.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),l.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),l.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(p=WebSquare.style.getComputedStyle(t))&&(p.padding||p.paddingTop||p.paddingBottom||p.paddingLeft||p.paddingRight)&&(l.left=parseInt(p.paddingLeft,10),l.right=parseInt(p.paddingRight,10),l.top=parseInt(p.paddingTop,10),l.bottom=parseInt(p.paddingBottom,10));this.select.setSize(t.clientWidth-(2+l.left+l.right),t.clientHeight-(2+l.top+l.bottom)),this.select.itemTable.setStyle("width",t.clientWidth-4+"px"),this.select.openSubLayer();var h=this.mainGrid.render.offsetWidth,d=this.select.itemTable.render.offsetWidth,u=this.select.itemTable.render.firstChild.offsetWidth;if(d-2>n&&(n=d-2),this.select.itemTable.render.clientHeight>=this.select.itemTable.render.scrollHeight||this.select.getItemCount()<=this.select.options.visibleRowNum)this.select.itemTable.render.firstChild.style.width=n+"px",h>d&&u<d&&this.select.itemTable.render.firstChild.firstChild&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=n&&this.select.itemTable.setStyle("width",n+"px");else{this.select.itemTable.render.firstChild.style.width=n-17+"px";var p;l={top:0,left:0,bottom:0,right:0};if(a.Z.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(l.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),l.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),l.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),l.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(p=WebSquare.style.getComputedStyle(t))&&(p.padding||p.paddingTop||p.paddingBottom||p.paddingLeft||p.paddingRight)&&(l.left=parseInt(p.paddingLeft,10),l.right=parseInt(p.paddingRight,10),l.top=parseInt(p.paddingTop,10),l.bottom=parseInt(p.paddingBottom,10));this.select.setSize(t.clientWidth-(2+l.left+l.right),t.clientHeight-(2+l.top+l.bottom)),h>d&&u+17<=d-2&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=n&&this.select.itemTable.setStyle("width",n+"px")}}t.style.textOverflow="ellipsis"}},G.select.prototype._handleEndEdit_common=function(t){try{this.select.closeSubLayer();var e=this.select.getValue();try{if(this.mainGrid._getWrapperTD(this.select.render.parentNode))this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.select.render)}catch(t){return}
this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.select.prototype._handleEndEdit_focus=function(){this.options.moveFocusByChoice&&this.moveFocus(this.editRowIndex,this.colID)},G.select.prototype._getEditedValue=function(t){return this.select.getValue()},G.select.prototype._handleCancelEdit=function(t){this.select.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.select.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID))},G.select.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.select.prototype.moveFocus=function(t,e){if(this.options.moveFocusByChoice)switch(this.options.moveFocusByChoice){case"down":this.mainGrid._setFocusedCell(t+1,e,!1);break;case"right":var i=this.mainGrid.getColumnIndex(e)+1;this.mainGrid._setFocusedCell(t,i,!1)}},G.select.prototype.refreshCell=function(){try{if(!this.options.selectedData)return;if(!this.dataComp)return;var t=this.mainGrid.modelControl.getDataComp(this.dataComp);if(!t)return;var e,i=null,o=null;if("linkedDataList"===t.initializeType?(i=t._dataList,o=t.initialRowIndexArr):"dataList"===t.initializeType&&(o=(i=t).filteredRowIndexArr),null==i)return;if(this.internal)this.itemsetObj.label,e=this.itemsetObj.value;else{var a=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),n=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);a.length>0&&n.length>0&&(WebSquare.Elem.api.getAttribute(a[0],"ref"),e=WebSquare.Elem.api.getAttribute(n[0],"ref"))}var h,d=null!=e?i.bodyIdColIndexMap[e]:i.bodyIdColIndexMap[this.itemsetObj.value];h=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var u=this.mainGrid._dataList.cellIdList.length,p=this.mainGrid._dataList.bodyIdColIndexMap[this.id],c=0;c<h.length;c++){var g=h[c];if("object"!==(0,l.A)(g)){var f=this.mainGrid._dataList.dataArr[g*u+p];if(!(this.options.allOption&&f==WebSquare.allValue||this.options.chooseOption&&f==this.options.chooseOptionValue||!(""!==f||this.selectedIndex>=0))){var m=!1;if("linkedDataList"===t.initializeType&&null!=t.conditionInfo&&t.conditionInfo.filterInfo.useRef){var y=t.conditionInfo.targetInfo,b={};for(var v in y){var w=this.mainGrid.modelControl.getDataComp(v);if(null!=w.initializeType&&"dataMap"!=w.initializeType){var C=w.getRowPosition();C!=c&&(b[v]=C,"linkedDataList"===w.initializeType?w._dataList.rowPosition=w.filteredRowIndexArr[c]:w.rowPosition=c)}}var I=t.getBroadcast();for(var _ in t.setBroadcast(!1),t.syncWithParent(),t.setBroadcast(I),b){var x=this.mainGrid.modelControl.getDataComp(_);"linkedDataList"===x.initializeType?x._dataList.rowPosition=x.filteredRowIndexArr[b[_]]:x.rowPosition=b[_]}o=t.initialRowIndexArr}for(var S=0;S<o.length;S++)if(f==i.dataArr[o[S]*i.cellIdList.length+d]){m=!0;break}if(!m){var R="";this.selectedIndex>=0&&this.selectedIndex<o.length&&!this.options.chooseOption&&(R=i.dataArr[o[this.selectedIndex]*i.cellIdList.length+d]),this.mainGrid._dataList.dataArr[g*u+p]=R}}}}}catch(t){s.Y.printStackTrace(t,null,this)}},G.checkcombobox=function(){},G.checkcombobox.prototype._initializeCellInfo=function(){try{this.separator=this.options.separator||" "}catch(t){s.Y.printStackTrace(t,null,this)}},G.checkcombobox.prototype.setInnerHTML=function(t,e,i,o,r){try{var n=this.mainGrid._getWrapperCell(t,i);null==e&&(e="");var l=this.getData(e,i);this.getEscape()&&(l=WebSquare.xml._encode(l+"")),n.innerHTML=this.mainGrid.dataTagOpen+l+this.mainGrid.dataTagClose
;var h,d=this.mainGrid.dataList.getRealRowIndex(i),u=this.mainGrid.getCellOption(d,o,"viewType"),p=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),c=a.Z.getDataPrefix("editModeEvent");if("icon"==u||""==u&&"own"==p?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute(c,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute(c,"onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute(c,"")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var g=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof g&&(this.mainGrid.options.titleFormatter=g,h=g.call(this,i,o,e))}else h=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",h)}catch(t){s.Y.printStackTrace(t,null,this)}}catch(t){WebSquare.exception.printStackTrace(t,null,this)}},G.checkcombobox.prototype.getData=function(t,e,i){try{var o="";t=t.split(this.separator);var a,n,l=[],h=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var d=this.itemsetObj.nodeset;d.indexOf("data:")>=0&&(h=d.slice(5))}if(h&&(n=this.mainGrid.modelControl.getDataComp(h)),h&&n){if("linkedDataList"===n.initializeType&&null!=n.conditionInfo&&n.conditionInfo.filterInfo.useRef){var u=n.conditionInfo.targetInfo,p={};for(var c in u){var g=this.mainGrid.modelControl.getDataComp(c);if(null!=g.initializeType&&"dataMap"!=g.initializeType){var f=g.getRowPosition();f!=e&&(p[c]=f,"linkedDataList"===g.initializeType?g._dataList.rowPosition=g.filteredRowIndexArr[e]:g.rowPosition=e)}}for(var m in this.checkcombobox&&this.checkcombobox.stopRefreshItemTable(!0),n.syncWithParent(),this.checkcombobox&&this.checkcombobox.stopRefreshItemTable(!1),p){var y=this.mainGrid.modelControl.getDataComp(m);"linkedDataList"===y.initializeType?y._dataList.rowPosition=y.filteredRowIndexArr[p[m]]:y.rowPosition=p[m]}}var b=null,v=null;if("linkedDataList"===n.initializeType?(b=n._dataList,v=n.initialRowIndexArr):"dataList"===n.initializeType&&(v=(b=n).filteredRowIndexArr),!this.checkcombobox&&null!=b)try{var w,C;o="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)w=this.itemsetObj.label,C=this.itemsetObj.value;else{var I=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),_=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);0!=I.length&&0!=_.length&&(w=WebSquare.Elem.api.getAttribute(I[0],"ref"),C=WebSquare.Elem.api.getAttribute(_[0],"ref"))}for(var x=b.bodyIdColIndexMap[w],S=b.bodyIdColIndexMap[C],R=0;R<v.length;R++)for(var D=v[R]*b.cellIdList.length,T=0;T<t.length;T++)t[T]==b.dataArr[D+S]&&(o=b.dataArr[D+x],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?o=t[T]+this.options.delimiter+o:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?o=o+this.options.delimiter+t[T]:"value"!==this.options.displayMode&&3!=this.options.displayMode||(o=t[T]),i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),o=this.getLocaleValue(o),l.push(o));if(l.length>0)return l.join(this.separator);if(this.options.allOption&&t==WebSquare.allValue)o=WebSquare.language.getMessage("Grid_all")||"-all-";else if(this.options.chooseOption&&t==this.options.chooseOptionValue)o=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)o="";else{D=0;D=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var L=this.mainGrid._dataList.cellIdList.length,k=this.mainGrid._dataList.bodyIdColIndexMap[this.id];this.mainGrid._dataList.dataArr[D*L+k]="",o="",this.options.chooseOption&&!this.options.chooseOptionValue&&(o=this.options.chooseOptionLabel)}else o=t
;return i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),o=this.getLocaleValue(o)}catch(e){return s.Y.printStackTrace(e,null,this),o=this.getLocaleValue(t)}var F=!1;a={};for(R=0;R<this.checkcombobox.itemArr.length;R++)for(T=0;T<t.length;T++)this.checkcombobox.itemArr[R].value==t[T]&&(l.push(this.checkcombobox.itemArr[R].label),a[R+"_"]=!0,F=!0);F||(""==l&&1==this.options.chooseOption?(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,o=WebSquare.xml.decode(o).replace("&nbsp;"," ")):this.options.selectedData||(o=t),o=this.getLocaleValue(o),l.push(o),a=null),o=l.join(this.separator)}else{var A=this.getMatchInfo(e);for(F=!1,R=0;R<t.length;R++)void 0!==(o=A["CHECKCOMBOBOX_"+t[R]])&&(o=this.getLocaleValue(o),l.push(o),F=!0);if(F){if(this.options.checkcomboboxRangeSeparator&&this.checkcombobox){a={};for(R=0;R<this.checkcombobox.itemArr.length;R++)for(T=0;T<t.length;T++)this.checkcombobox.itemArr[R].value==t[T]&&(a[R+"_"]=!0)}}else""==l&&1==this.options.chooseOption?(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,o=WebSquare.xml.decode(o).replace("&nbsp;"," ")):this.options.selectedData||(o=t),o=this.getLocaleValue(o),l.push(o);o=l.join(this.separator)}if(i&&i.emptyValue&&(""===o||"$blank"==o))o=i.emptyValue;else if(void 0===o||"$blank"==o)return"";return this.options.checkcomboboxRangeSeparator&&this.checkcombobox&&a?this.checkcombobox._getRangeText(this.checkcombobox.itemArr,this.checkcombobox.itemArr.length,this.separator,a):o}catch(t){s.Y.printStackTrace(t,null,this)}},G.checkcombobox.prototype._createComponent=function(t){try{if(this.comp)return;this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_checkcombobox_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("allOption",this.options.allOption+""),"column"===this.options.submenuSize?this.xml.setAttribute("submenuSize","column"):this.xml.setAttribute("submenuSize","auto"),this.xml.setAttribute("style",this.style),this.xml.setAttribute("disabled",this.mainGrid.getDisabled("cell",this.mainGrid._getGroupbyDisplayRowIndex(t),this.colID)),this.xml.setAttribute("useDrag",this.options.checkcomboboxUseDrag),this.xml.setAttribute("useEdit",this.options.checkcomboboxUseEdit),this.xml.setAttribute("rangeSeparator",this.options.checkcomboboxRangeSeparator),this.xml.setAttribute("validateOnInput",this.options.checkcomboboxValidateOnInput),this.options.checkcomboboxVisibleRowNum>1&&this.xml.setAttribute("visibleRowNum",this.options.checkcomboboxVisibleRowNum),this.options.checkcomboboxVisibleColNum>1&&this.xml.setAttribute("visibleColNum",this.options.checkcomboboxVisibleColNum),this.options.checkcomboboxVisibleColMax>1&&this.xml.setAttribute("visibleColMax",this.options.checkcomboboxVisibleColMax),this.configOptions.separator=this.separator,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.internal&&(this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions)),this.configOptions.accessibility=this.mainGrid.options.accessibility,this.checkcombobox=new WebSquare.uiplugin.checkcombobox(this.mainGridId+"_checkcombobox_"+this.id,this.configOptions,this.xml),this.comp=this.checkcombobox;var e=this;this.checkcombobox.__closeSubLayer=this.checkcombobox.closeSubLayer,this.checkcombobox.closeSubLayer=function(){this.__closeSubLayer(),e.handleEndEdit()},this.checkcombobox.toggle=function(){if(this.isOpen){var i=this.getValue(),o=this.getInfoArray()
;this.__closeSubLayer();var s=this.getValue(),r=e.mainGrid.getColumnIndex(e.options.id);if(i!=s){var a={oldInfo:o,newInfo:this.getInfoArray(),oldValue:i,newValue:s,rowIndex:t,colIndex:r,colId:e.mainGrid.getColumnID(r)};p.f.fireEvent(e.mainGrid,"onviewchange",a)}e.handleEndEdit()}else this.openSubLayer()},this.checkcombobox._parent_uuid=this.mainGrid.uuid}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.checkcombobox.prototype.setEditMode=function(t,e){try{var i=this.mainGrid._getWrapperCell(t,e);if(this.dataComp){var o=this.mainGrid.modelControl.getDataComp(this.dataComp);o&&"linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef&&o.syncWithParent()}if(!0!==this._init){if(this._createComponent(e),i.innerHTML=this.checkcombobox.toHTML(),this.checkcombobox.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setSubLayer(),!this.existGridViewItemsetNode){var r=this.checkcombobox.itemTable,a=this;r.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:a.checkcombobox.closeSubLayer(),a.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",a.mainGrid.options.keyMoveEditMode);break;case 13:a.mainGrid.options.fastEditMode?"none"==a.mainGrid.options.enterKeyMove||("right"==a.mainGrid.options.enterKeyMove?a.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",a.mainGrid.options.keyMoveEditMode):a.mainGrid.moveVertical(t,t.shiftKey?"up":"down",a.mainGrid.options.keyMoveEditMode)):a.checkcombobox.closeSubLayer();break;case 27:a.mainGrid.editedCell.handleCancelEdit(t)}})),this.mainGrid._moveKeyEdit(r.uuid,"keyDownFunc",{itemTable:!0})}this._init=!0}else i.innerHTML="",this.mainGrid.cellMergeInfo&&this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),i.appendChild(this.checkcombobox.render);if(this.hasRef&&!this.dataComp){var n=this.mainGrid.getElemRowIndex(t);this.checkcombobox.itemArr=this.getRefItemArr(n),this.checkcombobox.setSelectOptions()}this.existGridViewItemsetNode?(this.checkcombobox.openSubLayer(),this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID))):(this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.checkcombobox.openSubLayer()),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t);var l=this.checkcombobox.itemTable.render.firstChild.clientWidth;l<t.clientWidth-2&&(l=t.clientWidth-2),l<this.checkcombobox.itemTable.render.offsetWidth-2&&(l=this.checkcombobox.itemTable.render.offsetWidth-2),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setItemTable(),t.style.textOverflow="ellipsis"}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.checkcombobox.prototype._handleEndEdit_common=function(t){try{this.checkcombobox.__closeSubLayer&&this.checkcombobox.__closeSubLayer();var e=this.checkcombobox.getValue();try{this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.checkcombobox.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.checkcombobox.prototype._handleEndEdit_focus=function(){this.mainGrid._setFocusedCell()},G.checkcombobox.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.checkcombobox.prototype._handleCancelEdit=function(t){this.checkcombobox.__closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},G.checkcombobox.prototype._getEditedValue=function(t){
return this.checkcombobox.getValue()},G.checkcombobox.prototype.refreshItemArr=function(t){var e=WebSquare.WebSquareparser.parseChoices(this.xml,"");if(e.length>0?this.itemArr=e:this.itemArr=this.modelControl.getItemsetData(),1==this.options.allOption){var i=WebSquare.language.getMessage("Grid_all")||"-all-";this.itemArr=[{label:i,value:WebSquare.allValue}].concat(this.itemArr)}},G.autoComplete=function(){},G.autoComplete.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i);null==e&&(e="");var h=this.mainGrid._getGroupbyDisplayRowIndex(i),d=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof d){this.useCustomFormatter=!0;var u=this.getDisplayData(e,i);this.getEscape()&&(u=WebSquare.xml._encode(u+"")),n=d.call(this.mainGrid,e,u,h,o)}else{this.useCustomFormatter=!1,n=this.getData(e,i),this.getEscape()&&(n=WebSquare.xml._encode(n+""));var c=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;n&&this.formatter&&c&&(n=this.formatter.format(n))}var g=this.mainGrid.dataList.getRealRowIndex(i),f=this.mainGrid.getCellOption(g,o,"viewType"),m=a.Z.getDataPrefix("col_id"),y=a.Z.getDataPrefix("rowIndex"),b=a.Z.getDataPrefix("colIndex");if(this.options.embeddedInput){var v=this.mainGrid.getInput(this,t,e),w=0,C=0,I=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",I=!0),this.mainGrid.embeddedAutoCompleteStyleObj||(this.mainGrid.embeddedAutoCompleteStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),w=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),w-=this.mainGrid.embeddedAutoCompleteStyleObj.top+this.mainGrid.embeddedAutoCompleteStyleObj.bottom,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),C=this.mainGrid.embeddedWidthObj[o].width,C-=this.mainGrid.embeddedAutoCompleteStyleObj.left+this.mainGrid.embeddedAutoCompleteStyleObj.right,I?t.parentNode.style.display="none":WebSquare.util.isIE("6 7")&&(w-=2),v._setSize(C-2,w),v.render.setAttribute(y,i),v.setValue(e),""!==n&&(v.dom.label.innerHTML=n),this.mainGrid._getEditDisabled(i,o)?v.setDisabled(!0):v.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?v.setReadOnly(!0):v.setReadOnly(!1),t.removeAttribute("tabIndex")}else if("icon"==f&&"true"==this.options.viewTypeIconImage){l.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+m+"='"+this.colID+"' "+y+"='"+i+"' "+b+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose,"</td>","<td "+m+"='"+this.colID+"' "+y+"='"+i+"'  "+b+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_div_img' />","</td>","</table>"].join("");var _=this,x=t,S=l.getElementsByTagName("div")[0];p.f.addListener(S,"onclick",(function(t){_.mainGrid._getEditDisabled(i,o)||_.mainGrid.___getEditReadOnly(i,o)||(_.autoCompleteImageClicked=!0,_.options.directOpen&&(_.mainGrid.__setFocusedCell(t,x),_.mainGrid.setEditMode(x)))}))}else{l.innerHTML=this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose;var R,D=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),T=a.Z.getDataPrefix("editModeEvent");if("icon"==f||""==f&&"own"==D?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),
t.setAttribute(T,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute(T,"onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute(T,"")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var L=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof L&&(this.mainGrid.options.titleFormatter=L,R=L.call(this,i,o,e))}else R=this.mainGrid.options.titleFormatter.call(this,i,o,n);t.setAttribute("title",R)}catch(t){s.Y.printStackTrace(t,null,this)}}}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.autoComplete.prototype.getInput=function(t,e,i,o){try{var r=o.titleStr,a=o.input_id,n=o.dataRowIndex,l=o.dataCol_id,h=t.mainGrid,d=r||t.options.title||"";if(h.options.titleAuto&&!d){var u=h.getHeaderValue(h.bodyToHeaderRelation[t.id])||"";d=""!==i&&null!=i?u+" "+(h.changeItemValue("label",t.id,[i])[0]||i):u+WebSquare.language.getMessage("Grid_autoComplete")}var c=new WebSquare.uiplugin.autoComplete(a,{className:"w2grid_embedded_select",style:"$blank",pluginName:"autoComplete",renderType:"native",title:d,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.mainGrid.options.accessibility,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(n),10),i=h._getWrapperTD(this.render.parentNode).getAttribute(l),o=h.getColumnIndex(i);WebSquare.event.fireEvent(h,"oncellclick",e,o,i)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:case 13:return void p.f.stopPropagation(t)}}}}]},t.xml);this.mainGrid._getWrapperCell(e,e.getAttribute(n)).innerHTML=c.toHTML();var g=WebSquare.uiplugin.autoComplete.prototype.setSelectedIndex1;if(c.setSelectedIndex1=function(t,e,i){var o=h._getWrapperTD(this.render.parentNode).getAttribute(l),s=parseInt(this.render.getAttribute(n),10),r=h._getGroupbyDisplayRowIndex(s),a=h.getColumnIndex(o),d=this.selectedIndex,u=this.getValue();if(g.call(this,t,e,i),h.dataList.__setCellData(s,o,this.getValue()),h._dataList.setRowPosition(s),d!=this.selectedIndex){var c={oldValue:u,newValue:this.getValue(),oldSelectedIndex:d,newSelectedIndex:this.selectedIndex,rowIndex:s,colIndex:a,colId:h.getColumnID(a)};p.f.fireEvent(h,"onviewchange",c)}p.f.fireEvent(h,"onafteredit",r,a,this.getValue())},c.activate(),!0!==this.mainGrid.options.accessibility){var f=c.uuid;c.event.addListener2(c.dom.input,"onfocus",(function(t){h.lastEvent=t;var e=WebSquare.idCache[f];h.getLastFocusedCell().focusedTd==h._getWrapperTD(e.render.parentNode)||h.focusedByApi||h._setFocusedCell(e.render.getAttribute(n),h._getWrapperTD(e.render.parentNode).getAttribute(l)),h.focusedByApi=!1}))}return c}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.autoComplete.prototype._initializeCellInfo=function(t){try{"useData"==this.options.noResult&&(this.useDataInfo={}),this.internal&&!0===this.options.viewTypeIconImage&&(this.options.viewTypeIconImage="true")}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.autoComplete.prototype.getData=function(t,e,i){try{var o,a="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice(5))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var u in h){var p=this.mainGrid.modelControl.getDataComp(u);if(null!=p.initializeType&&"dataMap"!=p.initializeType){var c=p.getRowPosition();c!=e&&(d[u]=c,"linkedDataList"===p.initializeType?p._dataList.rowPosition=p.filteredRowIndexArr[e]:p.rowPosition=e)}}for(var g in o.syncWithParent(),d){var f=this.mainGrid.modelControl.getDataComp(g)
;"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var v=m.getTotalRow();y=[];for(var w=0;w<v;w++)y.push(w)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}if(!this.autoComplete&&null!=m)try{var C,I;a="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)C=this.itemsetObj.label,I=this.itemsetObj.value;else{var _=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",r.I._XML_NAMESPACE.W2),x=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",r.I._XML_NAMESPACE.W2);_.length>0&&x.length>0&&(C=WebSquare.Elem.api.getAttribute(_[0],"ref"),I=WebSquare.Elem.api.getAttribute(x[0],"ref"))}var S=null!=C?m.bodyIdColIndexMap[C]:m.bodyIdColIndexMap[this.itemsetObj.label],R=null!=I?m.bodyIdColIndexMap[I]:m.bodyIdColIndexMap[this.itemsetObj.value];for(w=0;w<y.length;w++){var D=y[w]*m.cellIdList.length;if(t==m.dataArr[D+R])return a=m.dataArr[D+S],"value delim label"===this.options.displayMode||1==this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||2==this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&3!=this.options.displayMode||(a=t),i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}if(this.selectedIndex>=0&&this.selectedIndex<b.length&&!this.options.chooseOption)a=m.dataArr[b[this.selectedIndex]*m.cellIdList.length+S],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t);else if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)a=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)a="";else{D=0;D=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var T=this.mainGrid._dataList.cellIdList.length,L=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[D*T+L]="",a=""}else a=t;return i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a=this.getLocaleValue(a)}catch(e){return s.Y.printStackTrace(e,null,this),a=this.getLocaleValue(t)}var k=!1;for(w=0;w<this.autoComplete.itemArr.length;w++)if(this.autoComplete.itemArr[w].value==t){k=!0,a=this.autoComplete.itemArr[w].label;break}if(!k&&o.options&&o.options.validateAllItemsetData)for(w=0;w<this.autoComplete.allItemArr.length;w++)if(this.autoComplete.allItemArr[w].value==t){k=!0,a=this.autoComplete.allItemArr[w].label;break}if(!k)if(""!=t||-1==this.selectedIndex||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-all-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?a=this.options.chooseOptionLabel:this.options.selectedData||(a=t);else a=this.autoComplete.itemArr[this.selectedIndex].label,this.mainGrid.dataList.__setCellData(e,this.colID,a)}else{var F=this.getMatchInfo(e);"useData"==this.options.noResult&&(this.useDataInfo["AUTOCOMPLETE_"+t]||(this.useDataInfo["AUTOCOMPLETE_"+t]=t),F["AUTOCOMPLETE_"+t]||(this.matchInfo["AUTOCOMPLETE_"+t]=t,this.itemArr=[{label:t,value:""}].concat(this.itemArr))),a=F["AUTOCOMPLETE_"+t]}if(i&&i.emptyValue&&(""===a||"$blank"==a))a=i.emptyValue;else if(void 0===a||"$blank"==a)return"";return a=this.getLocaleValue(a)}catch(t){s.Y.printStackTrace(t,null,this)}return t},
G.autoComplete.prototype._createComponent=function(t){try{if(this.comp)return;if(this.options.disableEdit?this.style="position:relative;left:0px;top:0px;":this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_autoComplete_"+this.colID),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.interactionMode&&(this.configOptions.interactionMode=this.options.interactionMode),this.options.submission&&(this.configOptions.submission=this.options.submission),this.options.sortOption&&(this.configOptions.sortOption=this.options.sortOption),this.options.displayMode&&(this.configOptions.displayMode=this.options.displayMode),this.options.search&&(this.configOptions.search=this.options.search),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.submenuSize&&(this.configOptions.submenuSize=this.options.submenuSize),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.allOption&&(this.configOptions.allOption=this.options.allOption),this.options.chooseOptionLabel&&(this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel),this.options.noResult&&(this.configOptions.noResult=this.options.noResult),this.options.disableEdit&&(this.configOptions.disableEdit=this.options.disableEdit),this.options.findItemFirstKey&&(this.configOptions.findItemFirstKey=this.options.findItemFirstKey),this.options.findItemKor&&(this.configOptions.findItemKor=this.options.findItemKor),this.options.maxlength&&(this.configOptions.maxlength=this.options.maxlength),a.Z.isIEAllVersion()&&this.xml.removeAttribute("readOnly"),this.internal&&(this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions),this.options.caseSensitive&&(this.configOptions.caseSensitive=this.options.caseSensitive)),this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.hasRef)this.targetRowIndex=t,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.autoComplete=new WebSquare.uiplugin.autoComplete(this.mainGridId+"_autoComplete_"+t+"_"+this.colID+"_"+this.id,this.configOptions,this.xml),this.autoComplete.options.disabled=!1,this.comp=this.autoComplete,this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setItemSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value);var e=this;this.autoComplete._handleClickEvent=this.autoComplete.handleClickEvent,this.autoComplete.handleClickEvent=function(t){this._handleClickEvent(t),p.f.stopEvent(t)},this.existGridViewItemsetNode?(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete._parentGridUUID=this.mainGrid.uuid,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),"down"==e.mainGrid.options.tabKeyMove?e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode):"none"==e.mainGrid.options.tabKeyMove||e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){
e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit()}))}):(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),"down"==e.mainGrid.options.tabKeyMove?e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode):"none"==e.mainGrid.options.tabKeyMove||e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 13:e.mainGrid.options.fastEditMode&&("none"==e.mainGrid.options.enterKeyMove||("right"==e.mainGrid.options.enterKeyMove?e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode):e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode)));break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit(),e.options.directOpen&&e.mainGrid._setFocusedCell()})),i.addMouseUpEventListener((function(t){e.mainGrid._setFocusedCell()})),e.mainGrid._moveKeyEdit(i.uuid,"keyDownFunc",{itemTable:!0})}),this.autoComplete.showEditMode=function(t){try{t?(this.dom.label.style.display="none",this.dom.label.style.visibility="hidden",this.dom.input.style.display="block",this.dom.input.style.visibility="visible"):(this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible")}catch(t){s.Y.printStackTrace(t,null,this)}},this.autoComplete._inputKeyDown=this.autoComplete.inputKeyDown,this.autoComplete.inputKeyDown=function(t,i){27==t.keyCode||(e.autoComplete._inputKeyDown(t,i),13===t.keyCode&&e.options.directOpen&&(e.mainGrid._setFocusedCell(),p.f.stopPropagation(t)))},this.mainGrid._moveKeyEdit(this.autoComplete.uuid,"_inputKeyDown",{skipVertical:!0}),this.autoComplete.setSelectedIndex1=function(t){var i=this.selectedIndex,o=this.getValue();if(this.setSelectedIndex(t),i!=this.selectedIndex){var s=e.mainGrid.getColumnIndex(e.options.id),r=e.editRowIndex,a={oldValue:o,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex,rowIndex:r,colIndex:s,colId:e.mainGrid.getColumnID(s)};p.f.fireEvent(e.mainGrid,"onviewchange",a)}this.closeSubLayer(),e.editTd&&e.handleEndEdit(),e.existGridViewItemsetNode&&e.options.directOpen&&e.mainGrid._setFocusedCell()},this.autoComplete._refreshItemset=this.autoComplete.refreshItemset,this.autoComplete.refreshItemset=function(t){"gridViewItemset"!==this.options.itemTableType&&(e.matchInfo=e.setMatchInfo()),this._refreshItemset(t)},this.autoComplete.options.handleOtherClick=!1}catch(t){s.Y.printStackTrace(t,null,this)}},G.autoComplete.prototype.setEditMode=function(t,e){try{var i=this.mainGrid._getWrapperCell(t,e);if(!0!==this._init?(this._createComponent(e),i.innerHTML=this.autoComplete.toHTML(),this.autoComplete.activate(),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this._init=!0,this.options.placeholder&&this.autoComplete.dom.input.setAttribute("placeholder",this.options.placeholder)):(i.innerHTML="",this.mainGrid.cellMergeInfo&&this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),i.appendChild(this.autoComplete.render)),
this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this.hasRef){var o=this.mainGrid.getElemRowIndex(t);this.autoComplete.itemArr=this.getRefItemArr(o)}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.autoComplete.itemArr.length>0||this.autoComplete.allItemArr.length>0){var r=this.mainGrid.dataList._getCellData(e,this.colID);if(this.autoComplete.setValue(r),!0===this.autoComplete.options.disableEdit||!0===this.autoCompleteImageClicked){if(this.autoCompleteImageClicked&&this.options.directOpen)if(this.autoComplete.viewArr=[],this.existGridViewItemsetNode);else for(var a=0;a<this.autoComplete.itemArr.length;a++)this.autoComplete.viewArr.push({label:this.autoComplete.itemArr[a].label,value:this.autoComplete.itemArr[a].value,orgLabel:this.autoComplete.itemArr[a].orgLabel,index:a,_hidden:this.autoComplete.itemArr[a]._hidden});this.autoComplete.openSubLayer(),this.autoCompleteImageClicked=!1}else this.autoComplete.setInputFocus()}else this.autoComplete.options.disableEdit||this.autoComplete.setInputFocus(),this.autoComplete.dom.input.value="";0==this.autoComplete.getItemCount()&&(this.autoComplete.selectedIndex=-1,this.autoComplete.dom.label.innerHTML="")}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.autoComplete.prototype.setColumnDisableEdit=function(t){try{this.options.disableEdit=!0,this.autoComplete&&this.autoComplete.disableEdit(t)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.autoComplete.prototype._handleEndEdit_common=function(t){try{this.autoComplete.endEdit({noEvent:!0}),this.autoComplete.closeSubLayer();var e=this.autoComplete.getValue();try{this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.autoComplete.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i),this.options.directOpen&&(this.autoComplete.editmode=!1)}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.autoComplete.prototype._handleEndEdit_focus=function(t,e,i){!1===i&&this.mainGrid._setFocusedCell()},G.autoComplete.prototype._handleCancelEdit=function(t){this.autoComplete.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.mainGrid.getRealRowIndex(this.editRowIndex),this.colID);this.mainGrid._getWrapperCell(this.editTd,this.editRowIndex).removeChild(this.autoComplete.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},G.autoComplete.prototype._getEditedValue=function(t){return this.autoComplete.getValue()},G.autoComplete.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.calendar=function(){},G.calendar.prototype.initializeCellInfo=function(t){try{this.options.useIOFormatLength&&this.refreshDataArr(),this.internal&&!0===this.options.viewTypeIconImage&&(this.options.viewTypeIconImage="true")}catch(t){s.Y.printStackTrace(t,null,this)}},G.calendar.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i);if(this.options.embeddedInput){var h=this.mainGrid.getInput(this,t,e);h.render&&null==this.mainGrid._getWrapperTD(h.render.parentNode)&&(l.innerHTML="",l.appendChild(h.render));var d=0,u=0,c=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",c=!0),this.mainGrid.embeddedCalendarStyleObj||(this.mainGrid.embeddedCalendarStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),d=t.getBoundingClientRect().height-parseFloat(WebSquare.style.getStyle(t,"border-top-width"))-parseFloat(WebSquare.style.getStyle(t,"border-bottom-width")),
d-=this.mainGrid.embeddedCalendarStyleObj.top+this.mainGrid.embeddedCalendarStyleObj.bottom,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),u=this.mainGrid.embeddedWidthObj[o].width,u-=this.mainGrid.embeddedCalendarStyleObj.left+this.mainGrid.embeddedCalendarStyleObj.right,c?t.parentNode.style.display="none":a.Z.isIE("6 7")&&(d-=2);var g=a.Z.getDataPrefix("rowindex");h.setSize(u-2,d),h.render.setAttribute(g,i),h._setValue(e,{skipValidate:!0}),this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,o)?h.setDisabled(!0):h.setDisabled(!1),t.removeAttribute("tabIndex")}else{this.getEscape()&&(e=WebSquare.xml._encode(e+"")),this.options.useMonthYearFormat&&(e=WebSquare.date.getIOFormatDate(e,this.options.ioFormat,this.options.calendarValueType));var f=this.getDisplayData(e),m=this.mainGrid._dataList.filteredRowIndexArr[i],y=this.mainGrid.getCellOption(m,o,"viewType"),b=a.Z.getDataPrefix("rowIndex"),v=a.Z.getDataPrefix("colIndex"),w=a.Z.getDataPrefix("col_id");if("icon"==y&&"true"==this.options.viewTypeIconImage){l.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+w+"='"+this.colID+"' "+b+"='"+i+"' "+v+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+f+this.mainGrid.dataTagClose,"</td>","<td "+w+"='"+this.colID+"' "+b+"='"+i+"'  "+v+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_calendar_div_img' />","</td>","</table>"].join("");var C=this,I=l.getElementsByTagName("div")[0];p.f.addListener(I,"onclick",(function(t){C.mainGrid._getEditDisabled(i,o)||C.mainGrid.___getEditReadOnly(i,o)||(C.calendarImageClicked=!0)}))}else{var _=a.Z.getDataPrefix("editModeEvent");l.innerHTML=this.mainGrid.dataTagOpen+f+this.mainGrid.dataTagClose,"icon"==y||""==y&&"own"==this.options.dataType?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_calendar"),t.setAttribute(_,this.options.editModeEventIcon)):this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar")}}if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var x=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof x&&(this.mainGrid.options.titleFormatter=x,n=x.call(this,i,o,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.Y.printStackTrace(t,null,this)}var S=n||this.options.title||"";S&&t.setAttribute("title",S)}catch(t){s.Y.printStackTrace(t,null,this)}},G.calendar.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;var i=this.mainGrid._getWrapperCell(t,e);if("true"==this.options.viewTypeIconImage){var o=i.getElementsByTagName("div")[0];this.mainGrid.removeClass(o,this.mainGrid.options.bodyTdClass+"_calendar_div_img")}else this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar");this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var r=this.mainGrid.getInput(this);this.comp=r;for(var a=i.firstChild;null!=a;a=a.nextSibling)if("NOBR"==a.nodeName.toUpperCase()||"SPAN"==a.nodeName.toUpperCase()&&a.className.indexOf("w2grid_span")>-1){WebSquare.style.setStyle(a,"visibility","hidden");break}if(1==r.options.renderDiv||"true"==r.options.renderDiv){
var n=document.getElementById(this.mainGridId+this.id),l=t.offsetWidth-6,h=t.offsetHeight,d=document.getElementById(this.mainGridId+this.id+"_div_input"),u=l-18-5,p=h-3,c=document.getElementById(this.mainGridId+this.id+"_input"),g=u-(parseInt(WebSquare.style.getStyle(c,"border-right-width"),10)+parseInt(WebSquare.style.getStyle(c,"border-left-width"),10)+parseInt(WebSquare.style.getStyle(c,"padding-right"),10)+parseInt(WebSquare.style.getStyle(c,"padding-left"),10)),f=p-2,m=document.getElementById(this.mainGridId+this.id+"_img"),y=p/2-m.offsetHeight/2;if(1==this.options.useAnchor||"true"==this.options.useAnchor){var b=document.getElementById(this.mainGridId+this.id+"_a");WebSquare.style.setStyle(b,"top",y+"px")}else WebSquare.style.setStyle(m,"top",y+"px");WebSquare.style.setStyle(n,"width",Math.max(l,0)+"px"),WebSquare.style.setStyle(d,"width",Math.max(u,0)+"px"),WebSquare.style.setStyle(c,"width",Math.max(g,0)+"px"),WebSquare.style.setStyle(n,"height",Math.max(h-3,0)+"px"),WebSquare.style.setStyle(d,"height",Math.max(p,0)+"px"),WebSquare.style.setStyle(c,"height",Math.max(f,0)+"px")}var v=this.mainGrid.dataList._getCellData(e,this.colID);this.options.useMonthYearFormat&&(v=WebSquare.date.getIOFormatDate(v,this.options.ioFormat,this.options.calendarValueType)),r._setValue(v,{noFormat:!0,skipValidate:!0}),"icon"==this.options.viewType&&"true"==this.options.viewTypeIconImage&&1==this.calendarImageClicked?(this.calendarImageClicked=!1,r.toggle()):(r.focus(),"select"==r.options.editType&&r.select()),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0)}catch(t){s.Y.printStackTrace(t,null,this)}},G.calendar.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};if(a.Z.isIE(8)?t={top:1,left:0,width:0,height:0}:a.Z.isFF()?t={top:0,left:-1,width:0,height:0}:a.Z.isChrome()||a.Z.isSafari()?t={top:1,left:0,width:0,height:0}:a.Z.isOpera()&&(t={top:1,left:0,width:0,height:1}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+t.top,r=i.offsetLeft+1+t.left,n=i.clientWidth-5+t.width,l=i.clientHeight-3+t.height,h=l-1;if(this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))r-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var u=this.mainGrid.getInput(this);u.show(),u.render.style.top=o+"px",u.render.style.left=r+"px",u.render.style.width=n+"px",u.render.style.height=l+"px",u.render.firstChild.style.height=l+"px",u.dom.input.style.height=h+"px",u.dom.input.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,a.Z.isIE()&&(u.dom.input.style.lineHeight=l+"px"),!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(u.render.id,3)}catch(t){s.Y.printStackTrace(t,null,this)}},G.calendar.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},G.calendar.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);e.hideCalendar();var i=e.getValue();i=e.validator.validateString(i),this.options.useIOFormatLength||(i=e.sub_validator.validateString(i)),this.options.useMonthYearFormat&&(i=WebSquare.date.getIOUnFormatDate(i,e.options.ioFormat,e.options.calendarValueType)),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};return o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){s.Y.printStackTrace(t,null,this)}},
G.calendar.prototype._handleEndEdit_focus=function(t,e){!0!==e&&t.hide()},G.calendar.prototype.validate=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue(),o=WebSquare.historyManager.get(e.options.pluginName,e.id);if(this.options.disableDateValidSet&&e.disableValidate(i))null!=o.value&&e._setValue(o.value,{skipValidate:!0}),this.mainGrid.getInput(this).blur();else{if(e.validate())return!0;if(""==i)return!0;if(this.options.dateValidSet&&(e._skipDateValidSet=!0),this.options.dateValidSet&&this.options.dateValidSetCustom)this.mainGrid.getInput(this).blur();else if(this.options.dateValidSet&&null!=o.value&&e._setValue(o.value,{skipValidate:!0}),this.mainGrid.getInput(this).blur(),"false"!==this.options.displaymessage){var r=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"Invalid date format.";e.options.invalidMessageFunc||alert(r)}}return this.mainGrid.getInput(this).focus(),!1}catch(t){s.Y.printStackTrace(t,null,this)}},G.calendar.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},G.calendar.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){s.Y.printStackTrace(t,null,this)}},G.calendar.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.calendar.prototype.refreshDataArr=function(){try{var t;t=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var e=this.mainGrid._dataList.cellIdList.length,i=this.mainGrid._dataList.bodyIdColIndexMap[this.id],o=this.mainGrid.getInput(this),r=0;r<t.length;r++){var a=t[r],n=this.mainGrid._dataList.dataArr[a*e+i],l=o.sub_validator.validateString(n);this.mainGrid._dataList.dataArr[a*e+i]=l}}catch(t){s.Y.printStackTrace(t,null,this)}},G.expression=function(){},G.expression.prototype.initializeCellInfo=function(){var t=this.options.expression;if(this.mainGrid.useExpression=!0,this.expIdArr=[],""!=t){var e=t.match(/(sum|avg|max|min|display|rowindex|rowstatus|datalist)[\s]*[(][\S\s]*?[)]/gi);if(null!=e){t="";for(var i=0;i<e.length;i++)t+=e[i],i<e.length-1&&(t+="+")}t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"_this.getCalcExpressionTarget(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/rowStatus[\s]*[(]/gi,"_this.getExpressionTarget(")}try{new Function("_this",t)(this)}catch(t){s.Y.printStackTrace(t,null,this)}},G.expression.prototype.getExpressionTarget=function(){for(var t=0;t<arguments.length;t++)null==this.expIdArr[arguments[t]]&&(this.expIdArr[arguments[t]]=arguments[t],this.mainGrid.setExpressionAssociation(arguments[t],this.colID));return 1},G.expression.prototype.getCalcExpressionTarget=function(t){var e=t.wq_replaceAll("(",",").wq_replaceAll(")",",").wq_replaceAll("+",",").wq_replaceAll("-",",").wq_replaceAll("*",",").wq_replaceAll("/",",").wq_replaceAll("%",",").wq_replaceAll(" ","");e=e.split(",");for(var i=0;i<e.length;i++)""!==e[i]&&null==this.expIdArr[e[i]]&&(this.expIdArr[e[i]]=e[i],this.mainGrid.setExpressionAssociation(e[i],this.colID));return 1},G.expression.prototype.setInnerHTML=function(t,e,i,o,r){try{
var n,l=this.mainGrid._getWrapperCell(t,i),h=this.mainGrid.dataList.getRealRowIndex(i),d=this.mainGrid._getGroupbyDisplayRowIndex(i),u=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),p=this.getDisplayData(null,h);"function"==typeof u?(this.useCustomFormatter=!0,n=u.call(this.mainGrid,e,p,d,o)):(this.useCustomFormatter=!1,n=p);var c=l.innerHTML.replace(/\r(\n)?/,"\n"),g=this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose;c!==g&&(l.innerHTML=g.replace("NaN",this.options.NaNFormat),this.mainGrid.drawFooter(this.colID))}catch(t){s.Y.printStackTrace(t,null,this)}},G.expression.prototype.getDisplayData=function(t,e,i){return t=this.getExpressionValue(e),this.formatter&&!0!==i?this.formatter.format(t):t},G.expression.prototype.getExpressionValue=function(t){if(this.rowIndex=t,!this.options.expressionFunc){var e=this.options.expression;""!=e&&(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[sS][uU][mM][\s]*[(]/g,"this.colsum(rowIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"this.colavg(rowIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.colmax(rowIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.colmin(rowIndex,")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"this.colcalc(rowIndex,")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"this.display(rowIndex,")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"this.datalist(rowIndex,")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"this.getRowIndex(rowIndex")).replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(rowIndex"),e=a.Z.scopingFuncBody(e,this.scope_id)),this.options.expressionFunc=Function("rowIndex",e),this.options.expressionFunc.changeCount=0}var i=this.mainGrid.changeCount,o="";return this.options.expressionFunc[t]&&i==this.options.expressionFunc[t].changeCount?o=this.options.expressionFunc[t].oldValue:(this.options.expressionFunc[t]||(this.options.expressionFunc[t]={}),this.options.expressionFunc[t].changeCount=i,o=this.options.expressionFunc.call(this,t),this.options.expressionFunc[t].oldValue=o),o},G.expression.prototype.colsum=function(){for(var t=arguments[0],e=0,i=1;i<arguments.length;i++){var o=this.mainGrid.getColumnIndex(arguments[i]),s=this.options.dataType;"gridView"==this.mainGrid.options.pluginName&&(s=this.mainGrid._dataList.getCellInfo(this.options.col_id).options.dataType),"bigDecimal"===s?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,o)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,o))||0}return e},G.expression.prototype.colavg=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);"bigDecimal"===i?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,s))||0}return"bigDecimal"===i?e=WebSquare.bigDecimal(e).divide(WebSquare.bigDecimal(arguments.length-1)).toString():e/=arguments.length-1,e},G.expression.prototype.colmax=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0;else{var r=parseFloat(this.mainGrid.dataList._getData(t,s))||0;r>e&&(e=r)}}return e},G.expression.prototype.colmin=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e="0"===WebSquare.bigDecimal(e).toString()?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)):WebSquare.bigDecimal(e),e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)),!0)||0;else{var r=parseFloat(this.mainGrid.dataList._getData(t,s))||0;(1==o||r<e)&&(e=r)}}return e},G.expression.prototype.colcalc=function(t,e){function i(t,e){t[t.length]=e}
function o(t){var e=t[t.length-1];return delete t[t.length-1],t.length--,e}function r(t){return!a(t)&&"("!=t&&")"!=t}function a(t){return"+"==t||"-"==t||"*"==t||"/"==t||"^"==t||"%"==t}function n(t){return t[t.length-1]}function l(t){return 0==t.length}function h(t){return"^"==t?5:"*"==t||"/"==t||"%"==t?4:"+"==t||"-"==t?3:"("==t?2:")"==t?1:void 0}function d(t,e,i){var o;try{return"+"==i&&(o=t.plus(e)),"-"==i&&(o=t.minus(e)),"*"==i&&(o=t.times(e)),"/"==i&&(o=t.divide(e)),"^"==i&&(o=t.pow(e)),"%"==i&&(o=t.mod(e)),o}catch(t){s.Y.printStackTrace(t)}}var u=function(t,e,s){e=new Array;var d=new Array,u=0;t=function(t){for(var e=t.split(""),i="",o=new Array,s=0,n=0;n<e.length;n++)r(e[n])&&null==e[n].match(/\s/)&&(i+=e[n]),(a(e[n])||")"==e[n]||"("==e[n])&&(""!=i&&(o[s]=i,s++),i="",o[s]=e[n],s++),n==e.length-1&&""!=i&&(o[s]=i);return o}(t);for(var p=0;p<t.length;p++){if(r(t[p])&&(e[u]=t[p],u++),a(t[p])){if("^"!=t[p])for(;!l(d)&&h(t[p])<=h(n(d));)e[u]=n(d),o(d),u++;else for(;!l(d)&&h(t[p])<h(n(d));)e[u]=n(d),o(d),u++;i(d,t[p])}if("("==t[p]&&i(d,t[p]),")"==t[p]){for(;"("!=n(d);)e[u]=o(d),u++;o(d)}}for(;!l(d);)"("==n(d)?o(d):e[e.length]=o(d);var c="";for(p=0;p<e.length;p++)c+=e[p];return 0==s?c:e}(e);for(var p in u){var c=this.mainGrid.getColumnIndex(u[p]);u[p]=null!=c?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,c)):u[p]}return function(t){for(var e,s,a=new Array,l=0;l<t.length;l++)if(r(t[l]))i(a,t[l]);else{(e=new Function("return "+n(a))()).constructor!=WebSquare.bigDecimalObj&&(e=WebSquare.bigDecimal(e)),o(a),(s=new Function("return "+n(a))()).constructor!=WebSquare.bigDecimalObj&&(s=WebSquare.bigDecimal(s));var h=d(s,e,t[l]);o(a),i(a,h)}return n(a)}(u)},G.expression.prototype.display=function(){var t=arguments[0],e=this.mainGrid.getColumnIndex(arguments[1]);return this.mainGrid.dataList._getData(t,e)},G.expression.prototype.datalist=function(t,e){return e=this.mainGrid._dataList.getColumnIndex(e),this.mainGrid._dataList._getCellData(t,e,!0)},G.expression.prototype.getRowIndex=function(){var t=arguments[0];return this.mainGrid.getDisplayRowIndex(t)},G.expression.prototype.rowStatus=function(){var t=arguments[0];switch(this.mainGrid.dataList.getRowStatusValue(t)){case 0:return"R";case 1:return"U";case 2:return"C";case 3:return"D";case 4:return"V"}},G.textarea=function(){},G.textarea.prototype.initializeCellInfo=function(t){try{if(t){var e=t.getAttribute("showReadOnly");if(e)this.options.showReadOnly=a.Z.getBoolean(e);else{var i=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/showReadOnly/@value')||"true";this.options.showReadOnly=a.Z.getBoolean(i)}}}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype.setInnerHTML=function(t,e,i,o,r){try{var n,l=this.mainGrid._getWrapperCell(t,i);if(this.options.embeddedInput){var h=this.mainGrid.getInput(this,t);h.show(),l.innerHTML="",l.appendChild(h.render);var d=a.Z.getDataPrefix("rowindex");h.render.setAttribute(d,i),h.render.style.top="0",h.render.style.left="0",h.render.style.width="100%",h.render.style.height="100%",h.render.style.imeMode=this.options.imeMode,this.options.placeholder&&(h.render.placeholder=this.options.placeholder),h.setValue(this.mainGrid.dataList._getCellData(i,this.id)),this.mainGrid._getEditDisabled(i,o)?h.setDisabled(!0):h.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?h.setReadOnly(!0):h.setReadOnly(!1)}else{var u;!0!==this.mainGrid._isBrowserScroll()?(u=t.clientWidth-8)<0&&(u=this.mainGrid.getColumnWidth(o,!0)-8):u=this.mainGrid.getColumnWidth(o,!0);var p=u>=0?" width:"+u+"px; ":" ",c=this.getDisplayData(e),g=this.mainGrid._getGroupbyDisplayRowIndex(i),f=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),m=c,y=this.options.textAlign?"text-align:"+this.options.textAlign+";":"",b="pre-wrap";a.Z.isIEAllVersion("6 7")&&(b="normal");var v="all"===this.options.displayType?"word-break:break-all;white-space:"+b+";":"";"function"==typeof f?(this.useCustomFormatter=!0,
m=f.call(this.mainGrid,e,c,g,o)):this.useCustomFormatter=!1,l.innerHTML="<div class='w2grid_textarea' style='"+y+p+v+"' >"+(this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(m+"")):this.getDisplayData(m))+"</div>"}if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var w=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof w&&(this.mainGrid.options.titleFormatter=w,n=w.call(this,i,o,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",n)}catch(t){s.Y.printStackTrace(t,null,this)}if("all"===this.options.displayType&&"all"===this.mainGrid.options.visibleRowNum&&!0!==this.mainGrid._isBrowserScroll()&&this.mainGrid.getRowCount()>0){var C=this.mainGrid.getElementById(this.mainGrid.id+"_body_table"),I=this.mainGrid.getElementById(this.mainGrid.id+"_foot_table"),_=C.offsetHeight;I&&(_+=I.offsetHeight),this.mainGrid.render.offsetHeight!=_&&this.mainGrid.setSize(null,_)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this._setEditMode(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype._setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);if(i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),!this.options.disabled){var o=document.getElementById(this.mainGrid.id+"_dataLayer");t.offsetHeight>=o.offsetHeight?i.render.focus({preventScroll:!0}):i.focus()}!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),this.options.disabled||"select"!=this.options.editType&&"select"!=this.mainGrid.options.editType||i.select()}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};a.Z.isIE(8)?t={top:-1,left:-1,width:0,height:0}:a.Z.isFF()?t={top:-2,left:0,width:0,height:0}:a.Z.isOpera()?t={top:0,left:0,width:0,height:1}:a.Z.isChrome()&&(t={top:0,left:0,width:0,height:0});var e=this.editTd;if(!0===this.mainGrid._isNativeScroll("both")){var i=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=i.scrollTop,t.left-=i.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var o=e.offsetTop+1+t.top,r=e.offsetLeft+1+t.left,n=e.clientWidth>150?e.clientWidth-5+t.width:150,l=e.clientHeight>60?e.clientHeight-2+t.height:60;if(this.mainGrid.options.groupbyZone){var h=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(h=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=h}if(this.mainGrid.gridWidth<r+n){var d=(e.clientWidth>150?0:5+t.width)-2;r=e.offsetLeft-n+e.clientWidth-d}var u=this.mainGrid.scrollX_right;if(!0!==this.mainGrid._isBrowserScroll()&&this.mainGrid.render.offsetHeight-u.offsetHeight<o+l){var p=e.clientHeight>60?0:2-t.top;(o-=o+l-(e.offsetTop+e.clientHeight)+p)<0&&(o=1+t.top),l>this.mainGrid.render.offsetHeight&&(l=this.mainGrid.render.offsetHeight-6+t.height)}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))r-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;r=r<0?0:r,o=o<0?0:o;var c=document.getElementById(this.mainGrid.id+"_scrollY_div");this.mainGrid.render.offsetWidth-c.offsetWidth<r+n&&(r=this.mainGrid.render.offsetWidth-c.offsetWidth-n-3);var g=this.mainGrid.getInput(this);if(this.comp=g,g.show(),g.render.style.top=o+"px",g.render.style.left=r+"px",g.render.style.width=n+"px",g.render.style.height=l+"px",g.render.style.imeMode=this.options.imeMode,
(!0===this.mainGrid._isHybridScroll()||!0===this.mainGrid._isNativeScroll())&&(this.mainGrid._adjustHybridEditedPosition(g.render.id,3),"all"===this.options.displayType)){var f=document.getElementById(this.mainGrid.id+"_head_table"),m=document.getElementById(this.mainGrid.id+"_scrollX_div");g.render.style.overflowY="auto",g.render.style.maxHeight=this.mainGrid.render.offsetHeight-f.offsetHeight-m.offsetHeight-3+"px"}}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},G.textarea.prototype.showReadonly=function(t,e){this.mainGrid._endEdit();var i=this.mainGrid.getInput(this),o=a.Z.getDataPrefix("col_id"),s=t.getAttribute(o);(this.options.disabled||this.mainGrid._getEditDisabled(e,s))&&i.setDisabled(!0),(this.options.readOnly||this.mainGrid.___getEditReadOnly(e,s))&&i.setReadOnly(!0),this._setEditMode(t,e),this.mainGrid.editedCell=this},G.textarea.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();"number"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")&&""!=i&&(i=Number(i));var o=this.editTd.offsetHeight;this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var r=this.editTd.offsetHeight;this.changedCellHeight=r-o;var a={};return a[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,a),e}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype._handleEndEdit_focus=function(t){t.hide(),t.setDisabled(!1),t.setReadOnly(!1)},G.textarea.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},G.textarea.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getInput(this);i.hide(),i.setDisabled(!1),i.setReadOnly(!1)}catch(t){s.Y.printStackTrace(t,null,this)}},G.textarea.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.drilldown=function(){},G.drilldown.prototype.setInnerHTML=function(t,e,i){var o=i,s=100,r=this.options.depthColumn;if("linkedDataList"===this.mode){if(null!=this.mainGrid._linkedDataList.filteredRowIndexArr&&this.mainGrid._linkedDataList.filteredRowIndexArr.length>0){o=this.mainGrid._linkedDataList.filteredRowIndexArr[i];var n=this.mainGrid._linkedDataList.filteredRowIndexArr.length-1;s=o<this.mainGrid._linkedDataList.filteredRowIndexArr[n]?parseInt(this.mainGrid.dataList._getCellData(i+1,r),10):null}}else null!=this.mainGrid._dataList.filteredRowIndexArr&&this.mainGrid._dataList.filteredRowIndexArr.length>0&&(s=(o=this.mainGrid.dataList.getRealRowIndex(i))<this.mainGrid.dataList.getRealRowIndex(this.mainGrid.getDataLength()-1)?parseInt(this.mainGrid.dataList._getCellData(i+1,r),10):null);for(var l=parseInt(this.mainGrid.dataList._getCellData(i,r),10),h="",d=o,u=1;u<l;u++)"div"==this.options.depthType?h+="<div class='w2grid_depthBlank'></div>":"line"==this.options.depthType?(h="<div class='w2grid_depth"+(1===u?this.mainGrid.drilldown.isLastChild(d)?"_line_L":"_line_T":this.mainGrid.drilldown.isLastChild(d)?"Blank":"_line_I")+"'></div>"+h,d=this.mainGrid.drilldown.getParentRowIndex(d)):"none"==this.options.depthType?h+="":h+="&nbsp;&nbsp;";var p=0,c="w2grid_plus";null!=s&&l<s?(p=1,c="w2grid_minus"):this.mainGrid.hasChild(i)||(p=2,c="w2grid_leaf"),1==l&&(c+=" w2grid_root");var g="",f=a.Z.getDataPrefix("openStatus");g=a.Z.isMobile()?"<span class='"+c+"' style='display:inline-block;' "+f+"='"+p+"' ontouchstart='this.clicked=true'></span>":"<span class='"+c+"' style='display:inline-block;' "+f+"='"+p+"' onclick='this.clicked=true'></span>";var m="<div class='w2grid_depthBlank";"1"==l&&(m+=" w2grid_depthBlank_root"),2===p&&(m+=" w2grid_depthBlank_leaf"),m+="'>"
;var y=this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(e+"")):this.getDisplayData(e),b="";"span"==this.mainGrid.options.dataTag&&(b=" w2grid_span"),"div"==this.options.depthType?(g=m+g+"</div>",t.innerHTML="<"+this.mainGrid.options.dataTag+" class='w2grid_drilldown_nobr"+b+"'>"+h+g+y+this.mainGrid.dataTagClose):"line"==this.options.depthType?(g=m+g+"</div>",t.innerHTML=h+g+"<"+this.mainGrid.options.dataTag+" class='w2grid_drilldown_nobr"+b+"'>"+y+this.mainGrid.dataTagClose):(this.options.depthType,t.innerHTML=this.mainGrid.dataTagOpen+h+g+y+this.mainGrid.dataTagClose)},G.drilldown.prototype.handleClick=function(t,e){for(var i,o=t.getElementsByTagName("span"),s=0;s<o.length;s++)if(-1==o[s].className.indexOf("w2grid_span")){i=o[s];break}if(1==i.clicked){i.clicked=!1;var r=a.Z.getDataPrefix("openStatus");if("2"!=i.getAttribute(r)){if(!1===p.f.fireEvent(this.mainGrid,"onbeforetoggleclick",e))return!1;this.mainGrid._toggle(e,!0)}return!0}return!1},G.drilldown.prototype.setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.setPosition();var i=this.mainGrid.getInput(this);i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat,i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),document.activeElement!=i.render&&i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType&&i.select()}catch(t){s.Y.printStackTrace(t,null,this)}},G.drilldown.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(a.Z.isFF()?t={top:-1,left:-1,width:0,height:0}:a.Z.isOpera()?t={top:0,left:0,width:0,height:1}:a.Z.isIE(9)&&(t={top:-1,left:-1,width:0,height:0}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,r=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=r+"px",l.render.style.height=n+"px",a.Z.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(l.render.id,3)},G.drilldown.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},G.drilldown.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);return this.setEditData(e),e}catch(t){s.Y.printStackTrace(t,null,this)}},G.drilldown.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t.hide()},G.drilldown.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},G.drilldown.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){s.Y.printStackTrace(t,null,this)}},G.drilldown.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.drilldown.prototype.setEditData=function(t){try{var e=t.getValue();e=t.validator.validateString(e),t.setValueNM(e,!0),
this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==i&&""!=e&&(e=Number(e));var o={};o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,o)}catch(t){s.Y.printStackTrace(t,null,this)}},G.textImage=function(){},G.textImage.prototype.setInnerHTML=function(t,e,i,o,r){try{var n=this.mainGrid._getGroupbyDisplayRowIndex(i),l=this.mainGrid._getWrapperCell(t,i),h=a.Z.getDataPrefix("col_id"),d=a.Z.getDataPrefix("rowindex"),u=this.options.imageSrc?this.mainGrid.getImageURL(this.options.imageSrc):"",c=!1,g=!1;this.mainGrid._getEditDisabled(i,o)?(c=!0,this.options.imageSrcDisabled&&(u=this.mainGrid.getImageURL(this.options.imageSrcDisabled))):this.mainGrid.___getEditReadOnly(i,o)&&(g=!0,this.options.imageSrcReadOnly&&(u=this.mainGrid.getImageURL(this.options.imageSrcReadOnly)));var f=this.options.imageAlign?this.options.imageAlign:"right";if(!this.options.embeddedInput||this.mainGrid._getEditDisabled(i,o)||this.mainGrid.___getEditReadOnly(i,o)||this.mainGrid.groupbyStatus.grouped){var m=this.mainGrid.getElemRowIndex(t),y=this.mainGrid.dataList.getRealRowIndex(m),b=this.mainGrid.getColumnIndex(this.colID),v=this.mainGrid.getCellOption(y,b,"viewType"),w=(this.mainGrid.getColumnID(o),e),C=(P=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),a.Z.getGlobalFunction(this.options.customModelUnformatter,this.scope_id));"function"==typeof C&&(w=C.call(this.mainGrid,e,n,o)),this.getEscape()&&(w=WebSquare.xml._encode(w+""));var I;z=this.getDisplayData(w);if("function"==typeof P?(this.useCustomFormatter=!0,X=P.call(this.mainGrid,e,z,n,o)):(this.useCustomFormatter=!1,X=z),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var _=a.Z.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof _&&(this.mainGrid.options.titleFormatter=_,I=_.call(this,i,o,e))}else I=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",I)}catch(t){s.Y.printStackTrace(t,null,this)}if("icon"==v||""==v&&"own"==this.options.dataType||r&&!0===r.visibleIcon){var x="";try{this.options.onerror&&(x=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.Y.printStackTrace(t,null,this)}var S="w2grid_textImage_image";"div"===this.options.textImageRenderType&&(S="w2grid_textImage_button"),c?S+=" w2grid_textImage_disabled":g&&(S+=" w2grid_textImage_readonly");var R=a.Z.getDataPrefix("tdIndex"),D=a.Z.getDataPrefix("rowIndex"),T=a.Z.getDataPrefix("colIndex"),L=t.getAttribute(R);t.removeAttribute("alt");var k="";if(""!=this.options.alt&&(k=" alt='"+this.options.alt+"' "),"div"===this.options.textImageRenderType){G=""!=this.options.imageWidth?" width:"+parseInt(this.options.imageWidth)+"px;":"",W="<div class='w2grid_textImage_div' "+h+"='"+this.colID+"' "+D+"='"+i+"'  "+T+"='"+o+"'>",B="<div class='w2grid_textImage_div_input'>"+this.mainGrid.dataTagOpen+X+this.mainGrid.dataTagClose,V="<button type='button' class='"+S+"' style='background-image:url("+u+"); "+G+"'></button>",q="</div>";N="left"===f?[W,V,B,q,q]:[W,B,q,V,q],l.innerHTML=N.join("")}else{l.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<tr class='bodyTextImageAlign'>","</tr>","</table>"].join("");var F=l.querySelector(".bodyTextImageAlign")
;"left"===f?F.innerHTML=["<td "+h+"='"+this.colID+"' "+D+"='"+i+"'  "+T+"='"+o+"' class='"+S+"' style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'>","<img src='"+u+"' "+x+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'"+k+" />","</td>","<td "+h+"='"+this.colID+"' "+D+"='"+i+"' "+T+"='"+o+"' tdIndex='"+L+"' class='w2grid_textImage' style='overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+X+this.mainGrid.dataTagClose,"</td>"].join(""):"right"===f&&(F.innerHTML=["<td "+h+"='"+this.colID+"' "+D+"='"+i+"' "+T+"='"+o+"' tdIndex='"+L+"' class='w2grid_textImage' style='overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+X+this.mainGrid.dataTagClose,"</td>","<td "+h+"='"+this.colID+"' "+D+"='"+i+"'  "+T+"='"+o+"' class='"+S+"' style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'>","<img src='"+u+"' "+x+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'"+k+" />","</td>"].join(""))}var A=this,E="div"===this.options.textImageRenderType?l.getElementsByTagName("button")[0]:l.getElementsByTagName("img")[0],M=a.Z.getGlobalFunction(this.options.imageClickFunction,this.scope_id);c||g||"function"!=typeof M||(E.style.cursor="pointer");var O=this.options.imageClickEvent?this.options.imageClickEvent:"onclick";"onclick"!==O&&"ondblclick"!==O&&(O="onclick"),p.f.addListener(E,O,(function(t){p.f.stopPropagation(t);var s=A.mainGrid._getEditDisabled(i,o);if(A.options.useImageClick||0==s){var r="";if(A.mainGrid.editedCell){var a=A.mainGrid._getGroupbyDisplayRowIndex(A.mainGrid.editedCell.editRowIndex),l=A.mainGrid.editedCell.colID,h=A.mainGrid._dataList.getCellData(a,l);A.mainGrid.editedCell.handleEndEdit();var d=A.mainGrid._dataList.getCellData(a,l),u=A.mainGrid.getColumnIndex(l);d!=h&&p.f.fireEvent(A.mainGrid,"onviewchange",{oldValue:h,newValue:d,rowIndex:a,colIndex:u,colId:A.mainGrid.getColumnID(u)}),r=A.getDisplayData(d)}else r=A.getDisplayData(e);p.f.fireEvent(A.mainGrid,"ontextimageclick",i,o),A.mainGrid._setFocusedCell(i,o),"function"==typeof M&&(E.style.cursor="pointer",A.options.displayRowIndex?M.call(A.mainGrid,n,A.colID,r):M.call(A.mainGrid,y,A.colID,r))}}))}else l.innerHTML=this.mainGrid.dataTagOpen+X+this.mainGrid.dataTagClose}else{if(!l.getElementsByClassName("w2grid_textImage_div_input")[0]){var N,H=this.mainGrid.id+"_textImage_"+i+"_"+o,G=""!=this.options.imageWidth?" width:"+parseInt(this.options.imageWidth)+"px;":"",W="<div class='w2grid_textImage_div' "+h+"='"+this.colID+"' "+D+"='"+i+"'  "+T+"='"+o+"'>",B="<div class='w2grid_textImage_div_input'>",V="<button type='button' class='w2grid_textImage_button' style='background-image:url("+u+"); "+G+"'></button>",q="</div>";N="left"===f?[W,V,B,q,q]:[W,B,q,V,q],l.innerHTML=N.join("")}var Y=this.mainGrid.getInput(this,t,e,{id:H});this.mainGrid._getWrapperTD(Y.render.parentNode),Y.blur(),Y.render.setAttribute(d,i);var Z=!1;if(this.mainGrid.options.autoResizeEmbeddedInput){var j=!1;this.mainGrid.__bResizeObj?(j=this.mainGrid.__bResizeObj.width!==this.mainGrid.resizeObj.width||this.mainGrid.__bResizeObj.height!==this.mainGrid.resizeObj.height,this.mainGrid.__bResizeObj.width=this.mainGrid.resizeObj.width,this.mainGrid.__bResizeObj.height=this.mainGrid.resizeObj.height):this.mainGrid.__bResizeObj={width:this.mainGrid.resizeObj.width,height:this.mainGrid.resizeObj.height},Z=!0!==Y._autoResizeEmbeddedInput&&!1===j||this.mainGrid.__bResizeObj.isColumnResizing}!0===Z||null==this.mainGrid._getWrapperTD(Y.render.parentNode)&&(l.innerHTML="",l.appendChild(Y.render)),
"all"==this.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||(e=this.getDisplayData(e));var P=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?P=this.options.customFormatter:"function"==typeof(P=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=P)}catch(t){P=null}var z=e,U=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&U&&(z=this.formatter.format(z)),Y.setValue(e),"function"==typeof P){this.useCustomFormatter=!0;var X=P.call(this.mainGrid,e,z,n,o);Y.render.value=X}this.options.textAlign?Y.setStyle("text-align",this.options.textAlign):Y.setStyle("text-align",""),t.removeAttribute("tabIndex"),t.removeAttribute("title")}}catch(t){s.Y.printStackTrace(t,null,this)}},G.textImage.prototype.setEditMode=function(t,e){try{try{this.options.onerror&&' onerror="('+this.options.onerror+').call(this,event);" '}catch(t){s.Y.printStackTrace(t,null,this)}if(this.editRowIndex=e,this.editTd=t,"icon"!=this.options.viewType&&(""!=this.options.viewType||"own"!=this.options.dataType)){this.setInnerHTML(this.editTd,null,this.editRowIndex,this.getColumnIndex(this.colID),{visibleIcon:!0})}this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);this.comp=i,i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat,i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType?i.select():"focus"==i.options.editType&&(a.Z.isIE()||a.Z.isFF())&&WebSquare.text.setCaretPos(i.render,i.render.value.length)}catch(t){s.Y.printStackTrace(t,null,this)}},G.textImage.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0,tdWidth:0};if(a.Z.isFF()?t={top:-1,left:-1,width:0,height:0,tdWidth:0}:a.Z.isOpera()&&(t={top:0,left:0,width:0,height:1,tdWidth:0}),!0===this.mainGrid._isNativeScroll("both")){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i,o,r=this.editTd,n=this.options.imageAlign?this.options.imageAlign:"right";"div"===this.options.textImageRenderType?o=(i=r.getElementsByTagName("button"))[0]:(i=r.getElementsByTagName("td"),o="right"===n?i[1].firstChild:i[0].firstChild);var l=r.clientWidth-o.offsetWidth-1+t.tdWidth,h=r.offsetTop+1+t.top,d=r.offsetLeft+1+t.left+("right"===n?0:o.offsetWidth),u=r.clientWidth-o.offsetWidth-6+t.width,p=r.clientHeight-2+t.height;if(this.mainGrid.options.groupbyZone){var c=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(c=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),h+=c}if("div"!==this.options.textImageRenderType)("right"===n?i[0]:i[1]).style.width=l+"px";var g=this.mainGrid.getInput(this);if(""!=this.options.imeMode)g.render.style.imeMode=this.options.imeMode;else{var f=this.mainGrid.getColumnOption(this.options.col_id,"dataType");g.render.style.imeMode="number"==f?"disabled":""}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))h-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,g.render.style.lineHeight=p+"px";g.show(),g.render.style.top=h+"px",g.render.style.left=d+"px",g.render.style.width=u+"px",g.render.style.height=p+"px",g.render.style.lineHeight=p+"px",g.render.style.textAlign=""==r.style.textAlign?"center":r.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(g.render.id,3)}catch(t){s.Y.printStackTrace(t,null,this)}},
G.textImage.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},G.textImage.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();i=e.validator.validateString(i),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};o[this.mainGrid.id]=!0;var r=a.Z.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof r){this.useCustomModelFormatter=!0;var n=this.getDisplayData(i);i=r.call(this.mainGrid,i,n,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;return this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){s.Y.printStackTrace(t,null,this)}},G.textImage.prototype._handleEndEdit_focus=function(t){t.setDisabled(!1),t.setReadOnly(!1),t.hide()},G.textImage.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},G.textImage.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.getInput(this),i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),e.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},G.textImage.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.textImage.prototype.showReadonly=function(t,e){this.setEditMode(t,e);var i=this.mainGrid.getInput(this);i.setDisabled(!0),i.setReadOnly(!0),this.mainGrid.editedCell=this},G.prototype.setDataListCellRefresh=function(t){try{if(t){this.initFormatter(t);var e=this.options.dataType;e||(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"!=e||this.options.displayFormat||(this.options.displayFormat=r.I.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/dataType/date/@displayFormat")),"time"!=e||this.options.displayFormat||(this.options.displayFormat="HH:mm");var i=!this.options.groupName||!this.options.groupValue,o=this.options.inputType;if(i&&("button"!=o&&"image"!=o)){var a=this.mainGrid._dataList.getCellInfo(this.colID),n=!(!a||!a.element&&a.id!==this.id);this.options.readOnly=!n||t.getAttribute("readOnly")}}}catch(t){s.Y.printStackTrace(t,null,this)}},G.spinner=function(){},G.spinner.prototype.initializeCellInfo=function(t){try{if(!this.xml)if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var e="",i=(e=a.Z.isIE("6 7")&&this.internal?WebSquare.xml.nodeWellFormed(t.outerHTML):WebSquare.xml.serialize(t)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"";e=(e=e.wq_replaceAll("<w2:column","<w2:spinner"+i)).wq_replaceAll("</w2:column","</w2:spinner");var o=WebSquare.xml.parse(e,!0);this.xml=o.documentElement}}catch(t){s.Y.printStackTrace(t,null,this)}},G.spinner.prototype.setInnerHTML=function(t,e,i,o,s){null==e&&(e="");var r=this.mainGrid._getWrapperCell(t,i);this.spinner&&this.spinner.render&&r.firstChild==this.spinner.render&&r.removeChild(this.spinner.render),r.innerHTML=this.mainGrid.dataTagOpen+this.getDisplayData(e,i)+this.mainGrid.dataTagClose;var n=this.mainGrid.dataList.getRealRowIndex(i),l=this.mainGrid.getCellOption(n,o,"viewType"),h=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),d=a.Z.getDataPrefix("editModeEvent");("icon"==l||""==l&&"own"==h)&&(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_spinner"),t.setAttribute(d,this.options.editModeEventIcon))},G.spinner.prototype.setEditMode=function(t,e){try{var i=this.mainGrid._getWrapperCell(t,e);if(""==this.style){var o=a.Z.getDataPrefix("tdindex");this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_spinner_"+this.id),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.dataType&&(this.configOptions.dataType=this.options.dataType),this.options.buttonSize&&(this.configOptions.buttonSize=this.options.buttonSize),
this.options.dateIncrementType&&(this.configOptions.dateIncrementType=this.options.dateIncrementType),this.options.displayFormat&&(this.configOptions.displayFormat=this.options.displayFormat),this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.increment&&(this.configOptions.increment=this.options.increment),this.options.min&&(this.configOptions.min=this.options.min),this.options.max&&(this.configOptions.max=this.options.max),this.options.editType&&(this.configOptions.editType=this.options.editType);var r=t.getAttribute(o);this.mainGrid._getEditDisabled(e,r)?this.configOptions.disabled=!0:this.configOptions.disabled=!1,this.configOptions.xmlEvents=[{name:"ondblclick",action:"script",param:{handler:function(t){p.f.stopPropagation(t)}}}],this.spinner=new WebSquare.uiplugin.spinner(this.mainGridId+"_spinner_"+this.id,this.configOptions,this.xml),this.spinner.isGridCellComponent=!0;var n=this;this.spinner._handleClickEvent=this.spinner.handleClickEvent,this.spinner.handleClickEvent=function(t){var e=n.mainGrid.getElemRowIndex(this.render.parentElement),i=n.mainGrid._getGroupbyDisplayRowIndex(e),s=this.render.parentElement.getAttribute(o);if(this.options.customFormatter){try{var r=null,l={};if("function"==typeof(r=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id)))for(var h in l=r(i,s))this.options.hasOwnProperty(h)&&(this.options[h]=l[h])}catch(t){r=null}this._handleClickEvent(t)}else this._handleClickEvent(t);p.f.stopEvent(t)},this.spinner._inputKeyDown=this.spinner.inputKeyDown,this.spinner.inputKeyDown=function(t,e){27==t.keyCode||n.spinner._inputKeyDown(t,e)},i.innerHTML=this.spinner.toHTML(),this.spinner.activate(),this.spinner.setSize(t.clientWidth-2,t.clientHeight-2)}else i.innerHTML="",i.appendChild(this.spinner.render),this.spinner.show();this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),this.editColIndex=this.mainGrid.getColumnIndex(this.id),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.spinner.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),"select"!=this.options.editType&&"focus"!=this.options.editType||this.spinner.focus()}catch(t){s.Y.printStackTrace(t,null,this.mainGrid)}},G.spinner.prototype._handleEndEdit_common=function(t){try{var e=this.spinner.getValue();if("number"==this.spinner.options.dataType){Number(e);this.options.customFormatter?(this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)):!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)}else this.spinner.options.dataType;this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.colID),this.spinner.hide()}catch(t){s.Y.printStackTrace(t,null,this)}},G.spinner.prototype._handleCancelEdit=function(t){},G.spinner.prototype._handleEndEdit_focus=function(){try{return null}catch(t){s.Y.printStackTrace(t,null,this)}},G.spinner.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},G.custom=function(){},G.custom.prototype.initializeCellInfo=function(t,e){try{this.parseTypeGetter(),this.isValidTypeGetter?(this.cellManagerHashByID={},this.cellManagerHashByRowIndex={},this.cellManagerIDByRowIndex={}):(this.cellManagerHashByRowIndex=[],this.cellManagerIDByRowIndex=[],this.cellManagerInfoByRowIndex=[])}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.initializeCellManager=function(t,e){try{var i=e.inputType?e.inputType:e.tagName;if(t.id=e.id,t.colID=this.id,t._position={
colIndex:this.mainGrid.getColumnIndex(this.colID),colID:this.id,realRowIndex:e.realRowIndex,displayRowIndex:e.displayRowIndex},t.parentColumnInfo=this,t.options.inputType=i,t.initializeInputType=this.getTagName(i),t.initializeInfo=e,"gridViewItemset"===e.itemTableType&&!e.itemSet)for(var o in t.initializeInfo.itemSet={nodeset:e.nodeset,label:e.label,value:e.value},t.options.itemSet=t.initializeInfo.itemSet,t.options.item=e.item,t.options.gridViewOptions={},t.options.itemTableType="gridViewItemset",e)t.options.gridViewOptions[o]=e[o];for(var o in e.options)t.options[o]=e.options[o];t.initFormatter()}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.getMapping=function(t,e){try{switch(t){case"text":default:return o.q.extend(e,WebSquare.uiplugin.cellInfo.text.prototype),!0;case"link":return o.q.extend(e,WebSquare.uiplugin.cellInfo.link.prototype),!0;case"checkbox":return o.q.extend(e,WebSquare.uiplugin.cellInfo.checkbox.prototype),!0;case"button":return o.q.extend(e,WebSquare.uiplugin.cellInfo.button.prototype),!0;case"image":return o.q.extend(e,WebSquare.uiplugin.cellInfo.image.prototype),!0;case"radio":return o.q.extend(e,WebSquare.uiplugin.cellInfo.radio.prototype),!0;case"select":return o.q.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(e,WebSquare.uiplugin.cellInfo.select.prototype),!0;case"calendar":return o.q.extend(e,WebSquare.uiplugin.cellInfo.calendar.prototype),!0;case"textarea":return o.q.extend(e,WebSquare.uiplugin.cellInfo.textarea.prototype),!0;case"expression":return o.q.extend(e,WebSquare.uiplugin.cellInfo.expression.prototype),!0;case"textImage":return o.q.extend(e,WebSquare.uiplugin.cellInfo.textImage.prototype),!0;case"checkcombobox":return o.q.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(e,WebSquare.uiplugin.cellInfo.checkcombobox.prototype),!0;case"autoComplete":return o.q.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.q.extend(e,WebSquare.uiplugin.cellInfo.autoComplete.prototype),!0;case"spinner":return o.q.extend(e,WebSquare.uiplugin.cellInfo.spinner.prototype),!0}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.getTagName=function(t){try{switch(t){case"text":return"input";case"link":return"anchor";case"button":return"trigger";case"select":return"selectbox";default:return t}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.parseTypeGetter=function(){try{this.options.typeGetter?(this.typeGetter=a.Z.getGlobalFunction(this.options.typeGetter,this.scope_id),this.isValidTypeGetter=!0):(this.isValidTypeGetter=!1,0==this.mainGrid.options.setCellInputTypeCustom&&$l("An error occurred while creating a custom type grid. property typeGetter is undefined.  gridView ["+this.mainGrid.id+"] column:["+this.id+"]"))}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.updateCellManagerHash=function(t,e,i,o,r){try{this.isValidTypeGetter?(this.cellManagerHashByID[t]=i,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t):(this.cellManagerInfoByRowIndex[e]=r,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t),o&&i.itemsetObj&&o.nodeset!==i.itemsetObj.nodeset&&i.setColumnNodeSet(o.nodeset,o.label,o.value)}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.createCellManager=function(t,e){try{var i=e.id,r=e.realRowIndex,a=o.q.extend({},this);if(a.internal=!0,a.options=o.q.extend({},this.options),a.options["data-col_id"]&&(a.options.col_id=a.options["data-col_id"]),a.initializeCellInfo=function(){},this.mainGrid.options.senseReader&&"false"!==a.options.embeddedInput&&("secret"!=e.inputType&&"text"!=e.inputType&&"select"!=e.inputType&&"checkbox"!=e.inputType&&"radio"!=e.inputType&&"calendar"!=e.inputType||(a.options.embeddedInput=!0,e.options&&(e.options.embeddedInput=!0))),e&&"radio"==e.inputType&&e.options&&e.options.groupName&&e.options.groupValue&&(this.mainGrid.radioGroupRepChk[e.options.groupName]=!0,
this.options.readOnly&&!e.options.readOnly&&e.td&&(this.options.readOnly=!1,this.options.readOnlyClass&&this.mainGrid.removeClass(e.td,this.options.readOnlyClass),this.mainGrid.options.readOnlyClass&&this.mainGrid.removeClass(e.td,this.mainGrid.options.readOnlyClass))),this.getMapping(e.inputType,a)){if(this.initializeCellManager(a,e),a.initializeCellInfo(t,e.options),a.isLocked=!0,this.updateCellManagerHash(i,r,a,null,e),!0===a.options.embeddedInput){var n=e.itemSet;n&&"function"==typeof a.setColumnNodeSet&&a.setColumnNodeSet(n.nodeset,n.label,n.value,e.displayRowIndex)}return this.cellManagerHashByRowIndex[r]}var l=this.options.id,h=this.mainGrid.getColumnIndex(l);return $l("An error occurred while creating a custom type grid. gridView ["+this.mainGrid.id+"] column:["+this.id+"] inputType:["+e.inputType+"] realRowIndex:["+r+"] colIndex["+h+"]"),!1}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.getCellManager=function(t){try{var e=t.managerID,i=t.element,o=t.rowIndex,r=t.realRowIndex,a=this.options.id,n=this.mainGrid.getColumnIndex(a),l=this.mainGrid.dataList.getCellData(o,n),h={colID:a,colIndex:n,rowIndex:o,displayRowIndex:t.rowIndex,realRowIndex:t.realRowIndex,value:l};try{var d,u;if(1!=this.mainGrid.options.setCellInputTypeCustom||this.isValidTypeGetter){if(this.cellManagerHashByID&&this.cellManagerHashByID[e])return this.cellManagerHashByID[e];if(this.isValidTypeGetter){var p=!1;if((u=this.typeGetter(h))&&"drilldown"===u.inputType)return;u&&u.options&&null!=u.options.readOnly&&this.mainGrid.setCellReadOnly(r,this.id,u.options.readOnly),u&&u.options&&null!=u.options.disabled&&this.mainGrid.setCellDisabled(r,this.id,u.options.disabled);m=this.cellManagerIDByRowIndex[r];if((f=this.cellManagerHashByRowIndex[r])&&f.options.embeddedInput&&t.td){var c=this.mainGrid._getWrapperCell(t.td,r);c.firstChild?c.firstChild&&c.firstChild.id!==this.mainGrid.id+"_"+m&&(p=!0):p=!0}if(!u||m!==u.id||p)if(m)g=!0===f.options.embeddedInput?this.mainGridId+"_"+m:this.mainGridId+m,this.mainGrid._removeDom(g),delete this.cellManagerHashByID[m],delete this.cellManagerHashByRowIndex[r],delete this.cellManagerIDByRowIndex[r]}else if(this.parseTypeGetter(),this.isValidTypeGetter&&(u=this.typeGetter(h)),u&&"drilldown"===u.inputType)return}else if(1==t.dynamicInputType){if((u=t.options).id="dynamic_"+u.inputType+"_"+o+"_"+n,u.td=t.td,u.dynamicInputType=!0,this.cellManagerHashByRowIndex[r]){var g,f=this.cellManagerHashByRowIndex[r],m=this.cellManagerIDByRowIndex[r];g=!0===f.options.embeddedInput?this.mainGrid.id+"_"+m:this.mainGridId+m,this.mainGrid._removeDom(g),delete this.cellManagerIDByRowIndex[r],delete this.cellManagerHashByRowIndex[r]}}else if(this.cellManagerHashByRowIndex[r]&&!t.dynamicInputType)return this.cellManagerHashByRowIndex[r];return u?(u.isUDC||((d=1==this.mainGrid.options.setCellInputTypeCustom?this.cellManagerHashByRowIndex[r]:this.cellManagerHashByID[u.id])?(this.updateCellManagerHash(u.id,r,d,u.itemSet),d.isLocked):(u.realRowIndex=r,u.rowIndex=o,u.displayRowIndex=o,d=this.createCellManager(i,u))),1!=this.mainGrid.options.setCellInputTypeCustom&&(d.customValue=u.value)):d=this.createCellManager(i,{id:this.colID+"_"+r+"__default",inputType:"text",td:t.td,realRowIndex:r}),d}catch(t){return $l("An error occurred while creating a custom type grid. gridView ["+this.mainGrid.id+"] column:["+this.id+"] realRowIndex:["+r+"] colIndex["+n+"]"),!1}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.setInnerHTML=function(t,e,i,o,r){try{var a=this.mainGrid.getRealRowIndex(i),n=this.mainGrid._getWrapperCell(t,a);if(this.mainGrid.options.setCellInputTypeCustom&&!this.isValidTypeGetter&&this.mainGrid.options.senseReader){this.cellManagerInfoByRowIndex[a];if(this.cellManagerIDByRowIndex&&!this.cellManagerIDByRowIndex[a]&&this.cellManagerInfoByRowIndex[a])return void this.mainGrid._setCellInputType(i,o,null,this.cellManagerInfoByRowIndex[a]);var l=this.cellManagerHashByRowIndex[a];if(l&&l.options.embeddedInput){
var h=this.cellManagerIDByRowIndex[a],d=this.mainGrid.id+"_"+h;if(!n.firstChild||n.firstChild&&n.firstChild.id!=d)return this.mainGrid._removeDom(d),this.cellManagerHashByRowIndex[a]=null,this.cellManagerIDByRowIndex[a]=null,void this.mainGrid._setCellInputType(i,o,null,this.cellManagerInfoByRowIndex[a])}}var u=this.getCellManager({element:this.element,rowIndex:i,realRowIndex:a,td:t});if(!1===u)n.innerHTML=this.mainGrid.dataTagOpen+e+this.mainGrid.dataTagClose;else{this.clearStyle(u,t);var p="class";!0===this.isValidTypeGetter&&u.options[p]&&this.mainGrid.addClass(t,u.options[p]),u.setInnerHTML(t,e,i,o),null!=u.customValue&&(e=u.customValue,this.mainGrid.dataList.__setCellData(i,this.colID,e)),this.useCustomFormatter=u.useCustomFormatter,this.useCustomModelFormatter=u.useCustomModelFormatter,this.useEscapeFormatter=u.useEscapeFormatter}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.setEditMode=function(t,e){try{if(!this.internal){var i=this.mainGrid.getRealRowIndex(e),o=this.cellManagerHashByRowIndex[i];o&&o.setEditMode(t,e)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.setPosition=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];e&&e.setPosition()}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype._handleEndEdit_common=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];if(i)return i._handleEndEdit_common(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype._handleEndEdit_focus=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];i&&i._handleEndEdit_focus(t)}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype._handleCancelEdit=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i._handleCancelEdit()}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.doDefaultAction=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i.doDefaultAction()}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.clearStyle=function(t,e){try{var i=a.Z.getDataPrefix("editModeEvent");"calendar"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_calendar")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_calendar"),e.setAttribute(i,"")),"select"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_select")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_select"),e.setAttribute(i,"")),"autoComplete"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete"),e.setAttribute(i,"")),"checkcombobox"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox"),e.setAttribute(i,"")),"spinner"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_spinner")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_spinner"),e.setAttribute(i,""))}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype.validate=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];return!e||("calendar"!==e.options.inputType||e.validate())}}catch(t){s.Y.printStackTrace(t,null,this)}},G.custom.prototype._getEditedValue=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];if(e&&e._getEditedValue)return e._getEditedValue()}return""}catch(t){
s.Y.printStackTrace(t,null,this)}},G.custom.prototype.refreshCellManagerHash=function(){try{for(var t=this.mainGrid.getRowCount(),e=0;e<t;e++)this.getCellManager({element:this.element,rowIndex:e,realRowIndex:this.mainGrid.getRealRowIndex(e)})}catch(t){s.Y.printStackTrace(t,null,this)}},G.user=function(){},G.user.prototype.setInnerHTML=function(t,e,i,o,s){var r,n=this.mainGrid._getWrapperCell(t,i),l=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id),h=this.mainGrid._getGroupbyDisplayRowIndex(i),d=this.getDisplayData(e);"function"==typeof l?(this.useCustomFormatter=!0,r=l.call(this.mainGrid,e,d,h,o)):(this.useCustomFormatter=!1,r=d),n.innerHTML=this.mainGrid.dataTagOpen+r+this.mainGrid.dataTagClose},G.user.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=p.f.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=a.Z.getDataPrefix("col_id"),r=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),r=n.focusedColIndex}this.mainGrid._getEditDisabled(i,r)||this.mainGrid.___getEditReadOnly(i,r)||p.f.fireEvent(this.mainGrid,"oncellclick",o,r,this.options.id)};var B=function(t,e,i){n.q.call(this,t,e,i)};o.q.extend(B.prototype,n.q.prototype),B.prototype.defaultOptions={useConfig:!0,pluginType:"uiplugin.gridView",pluginName:"gridView",serializable:!0,userEvents:["oncellclick","oncelldblclick","onrightbuttonclick","ontextimageclick","ondateselect","oneditdblclick","oncellindexchange","onrowindexchange","oncolumnindexchange","onfilereadend","onscrollend","onscrollstart","onbeforeedit","oneditend","oneditkeydown","onafteredit","onscrolly","onscrollx","onsort","onbeforesort","onheaderclick","onheaderrightbuttonclick","onheaderdblclick","onheadermouseover","onheadermouseout","onheadertextimageclick","onfooterclick","onsubtotalclick","onsubtotaldblclick","onbodymouseover","onbodymouseout","ongroupby","onbeforetoggleclick","ontoggleclick","onclick","onblankclick","onkeydown","onkeyup","onviewchange","onbeforepaste","onafterpaste","oncolumnwidthchange","onbeforecolumnmove","onaftercolumnmove","onaftercolumnresize","ondatadragstart","ondatadragover","ondatadrop","oncontextopen","oncontextclick","oneditkeyup","ongridmouseleave","ongridmouseenter"],rowNumVisible:!1,rowNumRowSpan:!0,rowNumHeaderValue:"",rowNumLocaleRef:"",rowNumBackgroundColor:"",rowNumRowMouseOverColor:!1,rowNumStatusResize:!1,cellStatusVisible:!1,cellStatusIconPosition:"right",rowStatusVisible:!1,rowStatusRowSpan:!0,rowStatusColSpan:!1,rowStatusHeaderValue:"",rowStatusLocaleRef:"",overflowX:"auto",overflowY:"auto",fixedColumn:0,fixedColumnWithHidden:!0,fixedColumnNoBGColor:!1,fixedColumnScrollHidden:!1,fixedColumnNoMove:!1,fixedColumnScrollReset:!0,fixedColumnLineDiv:!1,fixedColumnLineDivStart:"tbody",rowNumStatusFixed:!0,fixedRightColumn:0,fixedRow:0,lastFixedRow:0,lastFixedRowStartIndex:0,resize:!0,rowResize:!1,baseNode:"vector",repeatNode:"data/INFO",valueNode:"",focusMode:"cell",selectedCellColor:"#FCA73C",selectedRowColor:"#FCA73C",oddEvenColorDisplay:!1,oddRowBackgroundColor:"#EFF7FF",evenRowBackgroundColor:"#FFFFFF",rowMouseOver:!1,rowMouseOverColor:"#ffff80",selectedCellOverColor:"",selectedRowOverColor:"",editModeEvent:"ondblclick",editModeEventIcon:"onclick",keyMoveEditMode:!1,enterKeyMove:"down",skipMultiRowMove:!1,sortable:!1,sortHeaderDiv:!1,sortOrderReverse:!1,noSortInit:!1,showSortableImage:!1,preventMultisort:!1,useCtrlOnMultisort:!0,useCtrlKey:!0,sortedImagePosition:"",sortedIconPosition:"",sortEvent:"ondblclick",headerTooltipDisplay:!1,rowStatusTooltipDisplay:!1,tabKeyMove:"right",tooltipDisplay:!1,tooltipDisplayTime:0,tooltipClass:"",tooltipStyle:"",tooltipHide:"click",tooltipShowAlways:!1,tooltipShowAlwaysColumns:"",tooltipHideInputType:"",tooltipHeaderShowAlways:!1,tooltipFormatter:"",
tooltipFormatterHeader:"",tooltipPositionX:"20",tooltipPositionY:"3+cellHeight",tooltipDisplayColumn:"",tooltipHeader:!1,showImageTooltip:!1,captionTitle:"",captionAuto:!1,noResultMessageVisibleAlways:!1,noResultMessageVisible:!1,noResultMessageExclude:"",noResultMessage:"",noResultMessageClass:"",noResultMessageStyle:"",noResultMessageStylePriority:!1,useNoResultMessageURL:!1,noResultMessageURL:"",noResultMessageCenter:!1,hiddenClass:"",readOnly:"",readOnlyPriority:"",readOnlyBackgroundColor:"",readOnlyBackgroundImg:"",readOnlyBackgroundImgCSS:"",readOnlyTabIgnore:!1,ignoreNonEditableCell:!1,ignoreNonEditableCellTabEnter:!1,disabledPriority:"",disabledBackgroundColor:"",disabledFontColor:"",summary:"",footerCaption:"",footerCaptionAuto:!1,footerSummary:"",footerSummaryAuto:!1,drawLimitTime:70,drawLimitRow:4,loadCount:0,minWidth:0,autoFit:"",autoFitMinWidth:"",autoFitCellMinWidth:"",autoFitFixYScroll:!1,fastScroll:"",lazyDrawHiddenColumn:!1,defaultCellHeight:-1,defaultHeaderCellHeight:-1,hideHeader:!1,dataDragDropCell:!1,dataDragDrop:!1,dataDragDropOther:!1,dataDragDropSelf:!1,dataDragDropStatus:!1,keepDataDragSelection:!1,dataDragSelect:!1,dataDragSelectAutoScroll:!1,dataDragSelectAutoScrollDPI:5,dataDragSelectAutoScrollPeriod:70,dataDragSelectAutoScrollDelay:50,dataDragSelectAutoScrollLevel:1300,dragDisplayColumn:"",dragStartFunction:"",dragEndFunction:"",headFiller:!1,focusMove:"true",focusFlow:"default",scrollMsg:"",visibleRowNum:"",visibleRowNumFix:!1,fixHeight:!1,fastEditMode:!1,iScrollMoveEffectTime:500,iScrollSlideTime:800,iScrollSlidePeriod:100,rollbackCommit:!0,numberCasting:!1,backgroundColorMode:"lazy",senseReader:!1,senseReaderLinkFocus:!1,useStartEndDiv:!0,showLastRow:!1,autoScope:!1,autoResizeEmbeddedInput:!1,servletPopup:!1,excelUploadPopupURL:"",advancedExcelUploadPopupURL:"",advancedExcelMultiUploadPopupURL:"",advancedExcelDownloadPopupURL:"",excelUploadURL:"",excelDownloadURL:"",csvDownloadURL:"",csvUploadPopupURL:"",csvUploadURL:"",advancedExcelUploadURL:"",advancedExcelDownloadURL:"",excelFileNameEncode:!1,drilldownRealRowIndex:!0,drilldownRealRowIndexAll:!1,drilldownToggleScrollFix:!1,escape:!0,fixPrint:!1,xmlEncode:!1,wheelRows:3,wheelStop:!1,scrollByColumn:!1,scrollByColumnAdaptive:!1,rowNumWidth:"",rowStatusWidth:"",keepDefaultColumnWidth:!1,columnMove:!1,columnMoveWithFooter:!1,columnOrder:"",copyAmount:"",copyOption:"",copyType:"default",pasteOption:"",rowCopy:!1,noUseCSVParser:!1,customPasteFormatter:"",checkReadOnlyOnPaste:!1,checkDisabledOnPaste:!1,checkReadOnlyOnCut:!0,checkDisabledOnCut:!0,checkBlankRowOnPaste:!1,checkEditableInputClass:!1,checkEditOnPaste:!1,checkOnCellClick:!1,setDefaultValueOnPaste:!1,preventAddRowOnPaste:!1,preventCopy:!1,preventPaste:!1,groupbyZone:!1,groupbyZoneSearch:!1,groupbyListVisibleRowNum:10,groupbyZoneMessage:"",groupbyZoneHeight:"50",groupbyMaxCount:-1,groupbyDisplayRowIndex:!1,groupbyFilterIcon:!1,plainText:!1,hideDeletedRow:!1,excludeDeletedRows:!1,excludeModifiedRows:!1,initFixedHeightByRowNum:-1,moveKeyEditMode:!1,moveKeyEditModeAll:!1,keepBeforeDisplayData:!1,touchScrollDelta:5,dataList:"",useFilterSearch:!1,useSearchFilter:!1,useFilterList:!1,useFilterListSync:!1,useFilterListFormat:!1,useResizeFilterList:!1,filterListRowHeight:20,filterListVisibleRowNum:0,filterListWidth:0,caseSensitive:!1,displayValueOnUseFilterList:!1,customFilterListVisibleRowNum:10,showAllFilterList:!1,useFilterEmptyMsg:"",useFilterNullMsg:"",filterDisplayMode:"label",filterSearchTarget:"label",filterShowAlways:!1,duplicateColumnId:!1,filterFocusMode:"",focusOnSetData:!1,focusDefaultColumn:!1,focusAutoRemove:!1,scrollFix:!1,scrollRowHeight:!1,applyAllColumnStyle:!1,disabledScrollHidden:!1,hammerEnabled:!1,hammerPressTime:351,dynamic:!1,ignoreCellClick:!1,ignoreToggleOnDisabled:!1,adaptive:"",autoFitFilterList:!1,summaryAuto:!1,summaryOnlyAuto:!1,arrowMove:!1,filterBoxvisibleRowNum:4,groupbyFilterBox:!1,groupbyFilterBoxLocation:"bottom",groupbyFilterBoxLabelSize:3,customFilterBox:!1,
customFilterFrameModal:!1,fixAdaptive:!1,groupbyFilterBoxFormatter:"",showSortableUseFilter:!1,customFormatterRealRowIndex:!1,oddEvenColorMerged:!1,showCustomFilterReset:!1,setCellInputTypeCustom:!1,useHeaderCheckboxLabelFor:!0,returnTrueFalseValue:!1,keepEditMode:!1,initStyle:!1,mergeCol:"",mergeRow:"",mergeCells:"never",noImageTooltip:!1,mergeCellsFixedCols:"never",mergeCellsFixedRows:"never",mergeExcludeValue:"",rowNumStatusUniqueId:!1,checkHeaderOnly:!1,checkAllType:"include",useDefaultStyle:!1,foldAll:!1,contextMenu:!1,useHeaderContextMenu:!1,contextMenuRowHeight:20,contextMenuAltClick:!1,useAccessibleContextMenu:!1,titleAuto:!1,syncScroll:!1,disabledClass:"w2grid_default_disabled",readOnlyClass:"w2grid_default_readonly",selectByLabel:!1,syncWithScrollTrack:!1,aliasDataCollection:"",editInputClass:"",directEdit:!1,numberMask:"",euroMask:"",rupeeMask:"",tengeMask:"",useMaxLength:!1,noSelect:!1,scrollFocus:!1,postMsg:!1,useXHR:!1,preventDuplicateFocusedCell:!1,alwaysTriggerScrollStart:!1,CellClickFixScrollX:!1,drawType:"virtual",mergeRefreshAlways:!0,subtotalStyleFormatter:"",mergeCellsFixedColsFirst:!1,useImageClick:!1,hideSortIconOnNoData:!1,hideFilterIconOnNoData:!1,showCheckboxLabelUserFormat:!1,showRadioLabelUserFormat:!1,useMoreButton:!1,moreButtonTitle:"",useTextMultiLink:!1,dataTag:"nobr",ctrlShiftKey:!1,scrollXNative:!1,scrollXNativeMobile:"",accessibility:!1,contentCellClick:!1,useDataDragDropGuideLine:!1,viewChangeAfterEdit:!1,hybridRowNum:50,useMobileTooltip:!1,useShiftKeyCheck:!1,focusMoveByUpDownKey:!1,rowMouseOverClass:"",syncRowPositionOption:"",wrapperCell:!1,wrapperCellElem:"div",readOnlyButtonFocusAllow:!1},B.prototype.initialize=function(t){if(this.initializeType="gridView",isNaN(parseInt(this.options.visibleRowNum,10))||(this.options.initFixedHeightByRowNum=-1),this.options.initFixedHeightByRowNum>0&&""===this.options.visibleRowNum&&(this.options.visibleRowNum=this.options.initFixedHeightByRowNum),this.firstEmbeddedInputResize=!0,"none"===this.options.autoFit&&(this.options.autoFit=""),this._isNativeScroll()&&(this.options.visibleRowNum="all"),"native"===this.options.copyType&&(this.options.noSelect=!1),t){for(var e=!1,i=!1,s=t.getChildNodes(),r=0;r<s.length;r++)"w2:header"!=s[r].getTagName()?"w2:gBody"!=s[r].getTagName()||(e=!0):i=!0;if(!e||!i)return this.uncompleted=!0,void(this.options.dynamic||$l(" gridView error : cannot find <w2:header> or <w2:gBody>.["+this.id+"]"))}if(this.options.dataList=this.options.dataList.wq_replaceAll("data:",""),this._dataList=null,this.options.dataList&&(this._dataList=this.modelControl.getDataComp(this.options.dataList,{type:"aliasDataCollection"})),this._dataList)switch(this._grid=this,this._dataList.addChild(this),this._dataList=WebSquare.DataCollection.api.getObj(this._dataList),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.q.extend(this,WebSquare.uiplugin.linkedMappingController.prototype),o.q.extend(this.dataList,WebSquare.uiplugin.linkedMappingController.prototype),this.dataList._linkedDataList=this._linkedDataList):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}else $l(" gridView error : invalid dataList("+this.options.dataList+").["+this.id+"]"),this.successBinding=!1,this._dataList={};this.skipPreActivate=!0;var n=this.options.dataList;null!=this.scope_obj&&(n=this.scope_obj.id+"_"+this.options.dataList),WebSquare.DataCollection.api.addRelation(this.id,n,!1),this.skipPreActivate=!1,this.myhelper=new WebSquare.korHelper,(a.Z.isIEAllVersion()||a.Z.isSpartan())&&(this.options.useResizeFilterList=!1),(this.options.useSearchFilter||this.options.useResizeFilterList)&&(this.options.useFilterSearch=!1),
this.options.useNoResultMessageURL&&(this.options.noResultMessageStyle="",this.options.noResultMessageClass="",this.options.noResultMessageExclude="",this.options.noResultMessageVisibleAlways=!1,this.options.noResultMessage="",this.options.noResultMessageStylePriority=!1,this.options.noResultMessageVisible=!0,this.options.noResultMessageURL||(this.options.noResultMessageURL=o.q._resourceURI+"message/noResultMessage/gridView_noResultMessage.xml")),!0===this.options.hideDeletedRow&&(this.options.excludeDeletedRows=!0),this.options.noResultMessageCenter&&!this.options.noResultMessageStylePriority&&(this.options.noResultMessageStyle="",this.options.noResultMessageClass=""),this._initialize()},B.prototype._initialize=function(t){if(this.focusedCellInfo={},this.extraData={grid:{},row:[],col:[],cell:[]},this.drilldown=new WebSquare.uiplugin.drilldown,"false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove||(this.options.enterKeyMove="none"),this.options.groupbyFilterBox&&(this.groupbyFilterBox_select=null,this.groupbyFilterBox_history=[]),!0===this.options.accessibility){this.options.senseReader=!0,this.options.focusMove="false",this.options.keyMoveEditMode=!0,this.options.autoResizeEmbeddedInput=!0,this.options.scrollFocus=!0,this.options.titleAuto=!0,this.options.sortHeaderDiv=!0,this.options.drawType="native";var e=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;e>0&&(this.options.initFixedHeightByRowNum=e,this.options.visibleRowNumFix=!0),this.options.visibleRowNum="all"}this.date=new Date,this.isDrillDown=!1,this.depthColumn="",this.showDepth="",this.removed=!1,this.useExpression=!1,this.colWidthList=[],this.gridWidth=0,this.resizeStarted=!1,this.headerHeight=0,this.footerHeight=0,this.hgap=[],this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autofitDone=!1,this.resizeStatus="init",this.scrollWidthSize=18,this.scrollLayerWidthSize=18,this.hiddenList=[],this.headerFocus=!1,this.headerObjArr=[],this.tmpSelectbox=null,this.noevent=!1,this.rowIndex=-1,this.lastIndex=-1,this.oelIndex=-1,this.initializeDrawController(),this.drawedRowLength=0,this.maxRowLength=0,this.drawSizeChanged=!1,this.drawSizeAdded=!1,this.isExistTextarea=!1,this.bodyHeight=0,this.scrollEvent=!0,this.isColMerge=!1,this.isColMergeAnd=!1,this.upperToLowerColumnRelation={},this.hasSubtotal=!1,this.startRowNumber=0,this.dataRowList=[],this.subtotalRowHash={},this.subtotalDataArr={},this.subtotalObj={},this.drawSetTimeoutKey=[],this.overElem=null,this.outElem=null,this.hasFooter=!1,this.footerDataObj=null,this.drawFooterStatus=!0,this.bScrollTop=-1,this.bScrollY=0,this.drawedTime=0,this.defaultColCnt=0,this.options.rowNumVisible&&this.defaultColCnt++,this.options.rowStatusVisible&&this.defaultColCnt++,this.loadCheck=[],this.beforeDataLength=-1,this.beforeMaxRowLength=-1,this.checkScrollStart=!0,this.editEnd=!1,this.lastOverSrc=null,this.headerInfoHash={},this.headerInfoHash2={},this.cellInfoHash={},this.cellInfoHash2={},this.expressionAssArr=[],this.labelColumnAssArr=[],this.rowStyleValueObj={},this.columnStyleValueObj={},this.cellStyleValueObj={},this.defaultStyleValueObj={},this.initStyleValueObj={},this.adaptiveColumnStyleValueObj={},this.rowStyleFixedValueObj={},this.rowStyleDataValueObj={},this.columnStyleFixedValueObj={},this.columnStyleDataValueObj={},this.disabledCellStyleObj={},this.headerCellStyleValueObj={},this.headerCellClassObj={},this.rowStyleIndex=0,this.cellStyleIndex=0,this.rowStyleFixedIndex=0,this.rowStyleDataIndex=0,this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowClassArr=[],this.tdCellClassArr=[],this.trRowClassArr=[],this._cellSelectedIndex=[],this.columnClassObj={},this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.focusedCell=[],this.focusedRow=[],
this.headerToBodyRelation={},this.bodyToHeaderRelation={},this.passiveColSpanRelation={},this.colMoveBolockedHeaderObj={},this.backupHeaderHTML={},this.expressionHeaderInfo={},this.columnOrder=[],this.isIE6=a.Z.isIE("6"),"BackCompat"==document.compatMode&&(this.isIE6=!0),this.isIE7=a.Z.isIE("7"),this.isIE6or7=this.isIE6||this.isIE7,this.isMobile=a.Z.isMobile(),this.isWebKit=/webkit/.test(navigator.userAgent.toLowerCase()),this.tmpCnt=0,this.initFlag=!1,this.options.rowNumBackgroundColor=this.options.rowNumBackgroundColor.wq_trim(),this.options.selectedCellColor=this.options.selectedCellColor.wq_trim(),this.options.selectedRowColor=this.options.selectedRowColor.wq_trim(),this.options.oddRowBackgroundColor=this.options.oddRowBackgroundColor.wq_trim(),this.options.evenRowBackgroundColor=this.options.evenRowBackgroundColor.wq_trim(),this.options.rowMouseOverColor=this.options.rowMouseOverColor.wq_trim(),this.options.readOnlyBackgroundColor=this.options.readOnlyBackgroundColor.wq_trim(),this.options.disabledBackgroundColor=this.options.disabledBackgroundColor.wq_trim(),this.options.disabledFontColor=this.options.disabledFontColor.wq_trim(),a.Z.getBoolean(this.options.focusOnSetData)&&(this.options.focusOnSetData=!0),this.options.senseReader&&(this.options.focusFlow="linear","all"===this.options.visibleRowNum&&(this.options.showLastRow=!0),this.element&&"false"!=this.element.getAttribute("autoScope")&&(this.options.autoScope=!0),this.senseReaderMode=!0),this.embeddedWidthObj={},this.options.sortable&&this.options.sortHeaderDiv&&(this.options.showSortableImage=!0,this.options.sortEvent="onclick"),this.radioGroupRepChk={},this.options.excelUploadPopupURL=this.options.excelUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/fileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/fileUpload.html"),{baseURI:!0})),this.options.advancedExcelUploadPopupURL=this.options.advancedExcelUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedfileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.html"),{baseURI:!0})),this.options.advancedExcelMultiUploadPopupURL=this.options.advancedExcelMultiUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedMultiUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedMultiUpload.html"),{baseURI:!0})),this.options.advancedExcelDownloadPopupURL=this.options.advancedExcelDownloadPopupURL||this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/download/advancedfileDownload.html"),{baseURI:!0}),this.options.excelUploadURL=this.options.excelUploadURL||WebSquare.baseServletURI+"excelToGrid.wq",this.options.excelDownloadURL=this.options.excelDownloadURL||WebSquare.baseServletURI+"xmlToExcel.wq",this.options.csvDownloadURL=this.options.csvDownloadURL||WebSquare.baseServletURI+"xmlToCSV.wq",this.options.csvUploadURL=this.options.csvUploadURL||WebSquare.baseServletURI+"csvToXML.wq",this.options.csvUploadPopupURL=this.options.csvUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/csvfileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.html"),{baseURI:!0})),this.options.advancedExcelUploadURL=this.options.advancedExcelUploadURL||WebSquare.baseServletURI+"excelToGrid2.wq",this.options.advancedExcelDownloadURL=this.options.advancedExcelDownloadURL||WebSquare.baseServletURI+"xmlToExcel2.wq",this.groupbyStatus={},this.groupbyZoneStatus={},this.groupbyDisplayOptions={},this.directItemChoiceKeyObj={},this.rowStatusColIDArr=[],this.cellIdList=[],this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.beforeEditedCellInfo=null,this.hiddenAdaptiveList=[],
this.adaptiveEmbeddedInputIdList=[],this.hideThresholdObj={},this.orgBodyHeightObj={},this.orgHeaderHeightObj={},this.orgFooterHeightObj={},this.orgSubtotalHeightArr=[],this.oldOptions={},this.adaptiveGridType=0,this.tooltipPositionParse=!1,this.oneRowScrollHeight=20,this._manager=null,this.beforeEditedCellInfo=null,this.options.noResultMessage=this.options.noResultMessage||WebSquare.language.getMessage("Grid_noResultMessage")||"No search result.",this.options.scrollMsg=this.options.scrollMsg||WebSquare.language.getMessage("Grid_scrollMsg")||"Updating...",this.cellMergeInfo={},this.cellMergeRealInfo={},this.tdMergeInfo={},this.mergeColObj={},this.mergeRowObj={},this.hiddenRowObj={length:0,extraRow:0,row:{},init:!1},this.hiddenCellObj={length:0,init:!1},!0===this.options.moveKeyEditModeAll&&(this.options.moveKeyEditMode=!0),this.filterEmptyStr=this.options.useFilterEmptyMsg||WebSquare.language.getMessage("GRID_useFilterEmptyMsg"),this.filterNullStr=this.options.useFilterNullMsg||WebSquare.language.getMessage("GRID_useFilterNullMsg")||"Null",this.useFilterEmptyValueInfo={"":!0};var i=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];i.push("");for(var o=0;o<i.length;o++)i[o]=i[o].trim(),this.useFilterEmptyValueInfo[i[o]]=!0;this._regDetectDOM=new RegExp("<[^<]+>","i"),this._regRemoveDOM=new RegExp("<[/]{0,1}[^></]+[/]{0,1}>","g"),this._bindDrag=!1,this._subtotalDisplayFormat="",this._dynamicVisibleRowNum=-1,"span"==this.options.dataTag?(this.dataTagOpen="<span class='w2grid_span'>",this.dataTagClose="</span>"):(this.dataTagOpen="<"+this.options.dataTag+">",this.dataTagClose="</"+this.options.dataTag+">"),WebSquare.util.isMobile()&&this.options.scrollXNativeMobile&&(this.options.scrollXNative=a.Z.getBoolean(this.options.scrollXNativeMobile)),this._setOverflowYScrollFlag=!1,this._setOverflowYHiddenFlag=!1,this._editendCalled=!1,this._hybridScrollYPos=0,this._hybridRowIndex=0,this._hybridScrollHeight=20,this._hybridScrollDupHeight=0,this._hybridScrollLastTop=NaN,this._hybridScrollHash={},this._hybridWheelCntX=0,this._hybridWheelCntY=0,this._hybridMobileStartX=0,this._hybridMobileStartY=0,this._hybridRefreshCnt=0,this._hybridRefreshMax=2,!0===this._isHybridScroll()&&(this.options.initFixedHeightByRowNum=-1),this.headerConfigOptions={},this.footerConfigOptions={},this.subtotalConfigOptions={},this._headerOverElemId=""},B.prototype.setPreAction=function(){try{var t=this.render.offsetWidth,e=this.render.offsetHeight;this.resizeObj={width:t,height:e,scrollLeft:0,scrollTop:0,clientWidth:this.render.clientWidth};var i=this.getElementById(this.id+"_head_table").getElementsByTagName("tr"),o=i[i.length-1],r=this.getElementById(this.id+"_body_table");this.gridLastTrBottomFix=r.offsetHeight-o.offsetTop-o.offsetHeight,this.setTableLayout(),this._handleScrollX(),this.setCellInfo(),this.setDataListCellInfo(),1==this.isDrillDown&&this.initDrilldown(),!0!==this.options.preventCopy&&!0!==this.options.noSelect||this.addClass("w2noselect")}catch(t){s.Y.printStackTrace(t,null,this)}},B.prototype._findParentControl=function(){try{for(var t,e=this.scope_obj;null!=e&&e!==e.scope_obj;e=e.scope_obj)if(e.options.adaptiveFrame){t=e;break}return t}catch(t){s.Y.printStackTrace(t)}},B.prototype.setAction=function(){try{if(this.initializeEvent(),this.options.columnOrder&&this.setColumnOrder(this.options.columnOrder),this.options.mergeCol){for(var t=this.getColumnCount(),e=0;e<t;e++)this.mergeColObj[e]=!1;var i=this.options.mergeCol.split(",");for(e=0;e<i.length;e++){var o=i[e];isNaN(o)||(o=Number(o)),this.mergeCol(i[e],!0)}}this._noResultMessageDivTop=WebSquare.util.getStyleProperty(this.getElementById(this.id+"_noresult"),"top");for(e=0;e<this.oneRowDataLength;e++){var r=this.getColumnID(e),n=this.getCellInfo(e);if(""!=this.options.hiddenClass||""!=n.options.hiddenClass){var l=this.options.hiddenClass;""!=n.options.hiddenClass&&(l=n.options.hiddenClass)
;var h=this._getRealColIndex("body",r)+this.defaultColCnt,d=null!=this.bodyToHeaderRelation[r]?this.getHeaderLayer(this.bodyToHeaderRelation[r]):null;this.hiddenList[h]?null==d||this.hasClass(d,l)||this.addClass(d,l):null!=d&&this.hasClass(d,l)&&this.removeClass(d,l)}}!this.startedDisplayNone&&this.getRowCount&&this.getRowCount()>0?this.notifyDataChanged({refreshScroll:!0}):!0===this._isHybridScroll()&&this.setScrollYHeightHybrid(),!this.startedDisplayNone&&this.options.focusOnSetData&&this._setFocusedCell(0,0),this.successBinding&&this._dataList&&this._dataList.options.initRowPosition&&this._dataList.broadcast({linkedDataList:["notifyRowPositionChanged"]});var u=WebSquare.BootLoader.fullViewed||!1,p=a.Z.fullViewed||!1;if(!u&&!p&&!this.startedDisplayNone&&this.checkAdaptiveGridType()&&(""!=this.options.adaptive||0!=Object.keys(this.hideThresholdObj).length)){this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive();var c=this._findParentControl();c?c._resizeChildComp.push(this.uuid):this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive))}if(1==this.options.summaryAuto&&!0!==a.Z.isHTML5()){var g=this.getHeaderValueList(),f="",m="";for(e=0;e<g.length;e++)f.length>0&&(m=","),f=f+m+g[e];this.setSummary(f)}if(this.changeCount=0,a.Z.getBoolean(this.options.captionAuto)){for(g=this.getHeaderValueList(),f="",m="",e=0;e<g.length;e++)f.length>0&&(m=","),f=f+m+g[e];var y=this.options.accessibility?". "+WebSquare.language.getMessage("Grid_caption_shortcut"):"";this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+f+WebSquare.language.getMessage("Grid_caption")+y):this.setCaption(f+WebSquare.language.getMessage("Grid_caption")+y)}if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var b=document.getElementById(this.id).style.cssText,v=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:b,className:v}}if(this.startedDisplayNone||this._setVisibleRowNumFix(),this.options.noResultMessageVisibleAlways&&this.displayNoResultMessage(),this.options.groupbyZone){if(this.delayedDraw({}))return;this._drawGroupbyZone()}}catch(t){s.Y.printStackTrace(t,null,this)}},B.prototype.setDataList=function(){try{if(!this.successBinding&&(this._dataList=this.modelControl.getDataComp(this.options.dataList),this._dataList)){switch(this._grid=this,this._dataList.addChild(this),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.q.extend(this,WebSquare.uiplugin.linkedMappingController.prototype)):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}for(var t=0;t<this.oneRowDataLength;t++)this.getCellInfo(t).setDataListCellRefresh(this.getCellInfo(t).element);this.render&&this.notifyDataChanged({refreshScroll:!0})}}catch(t){s.Y.printStackTrace(t,null,this)}},B.prototype.resetDataList=function(){try{this.successBinding=!1,this.setDataList()}catch(t){s.Y.printStackTrace(t,null,this)}},B.prototype.serialize=function(){return this.focusedCell},B.prototype.restore=function(t){try{for(var e=0,i=t.length;e<i;e++)this._setFocusedCell(t[e].focusedRowIndex,t[e].focusedColIndex,null,{useShiftKey:!0})}catch(t){return s.Y.printStackTrace(t),!1}return!0},B.prototype.onComplete=function(){this.uncompleted||(this._setRedrawTextAreaColumn(),this.displayFixedColumnLine(),n.q.prototype.onComplete.call(this))},o.q.extend(B.prototype,h.prototype),o.q.extend(B.prototype,f.prototype),o.q.extend(B.prototype,m.prototype),o.q.extend(B.prototype,y.prototype),o.q.extend(B.prototype,b.prototype),o.q.extend(B.prototype,_.prototype),o.q.extend(B.prototype,x.prototype),
o.q.extend(B.prototype,S.prototype),o.q.extend(B.prototype,R.prototype),o.q.extend(B.prototype,T.prototype),o.q.extend(B.prototype,L.prototype),o.q.extend(B.prototype,k.prototype),o.q.extend(B.prototype,A.prototype),o.q.extend(B.prototype,E.prototype)},3925:function(t,e,i){i.d(e,{b:function(){return l}});var o=i(2284),s=(i(5461),i(8971)),r=i(2338),a=i(1204),n=i(2256),l=function(t){this._grid=t};l.prototype.getRealRowIndex=function(t){try{var e;if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var i in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[i])return this._grid._dataList.getRealRowIndex(t);e=this._grid.groupbyStatus.groupedRowIndexArr[t]}else e=this._grid._dataList.getRealRowIndex(t);return e}catch(t){s.Y.printStackTrace(t)}},l.prototype.getTotalRow=function(){try{return this._grid._dataList.getTotalRow()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getTotalCol=function(){try{return this._grid.oneRowDataLength}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowCount=function(){try{return this._grid._dataList.getDataLength()}catch(t){s.Y.printStackTrace(t)}},l.prototype._getData=function(t,e){try{e=this._grid.getColumnID(e);var i=this._grid.cellInfoHash[e]||{options:{}};if((1!=this._grid.options.moveKeyEditModeAll||"checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)&&this._grid.editEndBeforeGetData(),i&&"expression"==i.options.inputType)return i.getExpressionValue(t);var o=this._grid._dataList._getData(t,e);return null==o&&(o=""),o}catch(t){s.Y.printStackTrace(t)}},l.prototype.getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);return"2"==(i=null==i||void 0===i?"0":i+"")?this._getCellData(t,e,i):this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?this._getCellData(t,e,"0"===i?3:i):this._getCellData(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype._getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);if("2"==(i=null==i||void 0===i?"0":i+""))return this._grid._getCellDisplayData(t,e);var o=this._grid.getRealRowIndex(t);return"3"!=i&&null!=o&&(t=o),this._getData(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getOriginalCellData=function(t,e){try{e=this._grid.getColumnID(e);return this._grid._dataList.getOriginalCellData(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.getColData=function(t,e){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColData(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowData=function(t,e){try{for(var i=[],o=0;o<this._grid.getColumnCount();o++)"displayData"!=e?i.push(this.getCellData(t,o)):i.push(this._grid._getCellDisplayData(t,o));return i}catch(t){s.Y.printStackTrace(t)}},l.prototype._getRowData=function(t,e){try{for(var i=[],o=0;o<this._grid.getColumnCount();o++)"displayData"!=e?i.push(this._getData(t,o)):i.push(this._grid._getDisplayData(t,o));return i}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDataRow=function(t){try{return this._grid._dataList.getDataRow(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getMatchedData=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedData(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUnmatchedData=function(t,e,i,o,r){try{return this._grid._dataList.getUnmatchedData(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getMatchedColumnData=function(t,e,i,o,r,a){try{return this._grid._dataList.getMatchedColumnData(t,e,i,o,r,a)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUnmatchedColumnData=function(t,e,i,o,r,a){try{return this._grid._dataList.getUnmatchedColumnData(t,e,i,o,r,a)}catch(t){s.Y.printStackTrace(t)}},
l.prototype.getMatchedIndex=function(t,e,i,o,r){try{return this._grid._dataList.getMatchedIndex(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUnmatchedIndex=function(t,e,i,o,r){try{return this._grid._dataList.getUnmatchedIndex(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRangeData=function(t,e,i){try{var o=[];if(t>e){var r=e;e=t,t=r}t<0&&(t=0),e>this._grid.getDataLength()&&(e=this._grid.getDataLength());for(var a=t;a<e;a++)o=o.concat(this.getRowData(a,i));return o}catch(t){s.Y.printStackTrace(t)}},l.prototype.getAllData=function(){try{return this._grid._dataList.getAllData()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getColumnDistinctDataArray=function(t){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColumnDistinctDataArray(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRangeXML=function(t,e){try{return this._grid._dataList.getRangeXML(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getMatchedXML=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedXML(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUnmatchedXML=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedXML(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowXML=function(t){try{return this._grid._dataList.getRowXML(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getAllXML=function(){try{return this._grid._dataList.getAllXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowJSON=function(t){try{return this._grid._dataList.getRowJSON(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getAllJSON=function(){try{return this._grid._dataList.getAllJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRangeJSON=function(t,e){try{return this._grid._dataList.getRangeJSON(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getMatchedJSON=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedJSON(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUnmatchedJSON=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedJSON(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowArray=function(t){try{return this._grid._dataList.getRowArray(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getAllArray=function(){try{return this._grid._dataList.getAllArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRangeArray=function(t,e){try{return this._grid._dataList.getRangeArray(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getMatchedArray=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedArray(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUnmatchedArray=function(t,e,i,o,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedArray(t,e,i,o,r)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setCellData=function(t,e,i,o,r,a,n,l){try{e=this._grid.getColumnID(e);if(this._grid._linkedDataList){var h=this._grid._linkedDataList.filteredRowIndexArr[t];"number"!=typeof t&&(t=h)}this._setCellData(t,e,i,null,o,r,a,n,l)}catch(t){s.Y.printStackTrace(t)}},l.prototype._setCellData=function(t,e,i,a,n,l,h,d,u){try{var p=!1;if("object"==(0,o.A)(t)&&null!=t){e=t.colID,i=t.data,a=t.noDraw,n=t.direction,l=t.skipBroadCast,h=t.noEvent,d=t.excludeId,u=t.skipInstance,p=t.useRealRowIndex;var c=t.filteredRowIndex;t=null,t=c}null==i&&(i=""),null==this._grid.editedCell||this._grid.getCellOption(t,e,"embeddedInput")||this._grid.editedCell.handleCancelEdit();var g,f=this._grid._dataList.getTotalRow(),m=this._grid._dataList.getTotalCol();g=!0===p||this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?t:this._grid.getRealRowIndex(t);var y=t,b="",v=(e=this._grid.getColumnID(e),
this._grid.getColumnIndex(e)),w=this._grid._dataList.getColumnIndex(e),C=this._grid._linkedDataList||this._grid.groupbyStatus.grouped?g:t;if(this._grid.isDrillDown&&this._grid._dataList.options.depthColumn?b=this.getCellData(g,e,"3"):C>=0&&C<f&&w>=0&&w<m&&(b=this.getCellData(t,e)),C>=0&&C<f&&w>=0&&w<m){var I=this._grid.cellInfoHash[this._grid.tdIdList[v]]||{options:{}},_=I.options.inputType||"text";if(("text"==_||"textImage"==_||"drilldown"==_)&&"all"==I.options.applyFormat&&!I.options.embeddedInput){var x=this._grid.getInput(I);b=I.formatter.format(b),b=x.validator.validateString(b)}var S=this._grid.getColumnOption(I.options.col_id,"dataType");if("bigDecimal"==S&&"string"==typeof i?i=WebSquare.bigDecimal(i).toString():"bigDecimal"==S&&($l("If dataType is bigDecimal, data must be entered to String.["+this.id+"]"),i=WebSquare.bigDecimal(i).toString()),i.toString().replace(/\r(\n)?/,"\n")!==b.toString().replace(/\r(\n)?/,"\n")){var R=t;if((this._grid._linkedDataList||this._grid.isDrillDown&&this._grid._dataList.options.depthColumn)&&(R=g),this._grid.groupbyStatus.grouped?this._grid._dataList._setCellData({filteredRowIndex:g,colID:e,value:i,direction:n,skipBroadCast:l,noEvent:h,excludeId:d,realRowIndex:!0,notifyRowIndex:t,skipInstance:u}):this._grid._dataList._setCellData(R,e,i,n,l,h,d,u),null==this._grid._dataList.getColumnID(e)&&this._grid.notifyCellChanged(y,v),r.f.fireEvent(this._grid,"onchange",t,v,i,b),"radio"==I.options.inputType&&I.options.groupName&&I.options.trueValue==i&&(I.resetOthers(t),this._grid.radioGroupRepChk[I.options.groupName]&&this.setCellData(t,I.options.groupName,I.options.groupValue)),this._grid.radioGroupRepChk[I.options.id]){for(var D=this._grid.getColumnCount(),T=0;T<D;T++){var L=this._grid.cellInfoHash[this._grid.tdIdList[T]]||{options:{}};if("radio"==L.options.inputType&&L.options.groupName==I.options.id&&L.options.groupValue==i){this.setCellData(t,T,L.options.trueValue,n,l,h,d,u);break}}T==D&&this._grid._resetRadioGroup(t,I.id,!1)}if(this._grid.isDrillDown)if(this._grid.drilldown.options.depthColumn==v)this._grid.notifyDataChanged({keepTop:!0}),0==this._grid.getDataLength()&&this._grid.removeFocusedCell(),this._grid.setScrollYHeight();else if("checkbox"==I.options.inputType&&I.options.setRecursive)for(var k=this._grid.drilldown.getChildRowArr(t,!0),F=0;F<k.length;F++)this._getData(k[F],v)!=i&&this._setCellData(k[F],v,i,a,n,l,h,d,u)}else null==this._grid.editedCell||a||this._grid.notifyCellChanged(y,v)}}catch(t){s.Y.printStackTrace(t)}},l.prototype.__setCellData=function(t,e,i,o,r,a,n){try{var l;e=this._grid.getColumnID(e);this._grid._linkedDataList?(l=this._grid._linkedDataList.filteredRowIndexArr[t],"number"!=typeof t&&(t=l)):l=this._grid.dataList.getRealRowIndex(t),this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList&&(t=l),this._setCellData(t,e,i,null,o,r,a,n)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList.setOriginalCellData(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype._setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList._setOriginalCellData(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setColumnDefaultValue=function(t,e){try{t=this._grid.getColumnID(t);this._grid._dataList.setColumnDefaultValue(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.setRowData=function(t,e,i){try{this._grid._dataList.setRowData(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setDataFile=function(t,e){try{t=this._grid._dataList.toArray(t);for(var i,o=[],r=0;r<this._grid.oneRowDataLength;r++){"expression"==(n=this._grid.getCellInfo(r)).options.inputType&&o.push(r)}i=t.length/this._grid.oneRowDataLength;for(r=0;r<o.length;r++)for(var a=0;a<i;a++){t[u=a*this._grid.oneRowDataLength+parseInt(o[r],10)]=""}for(r=0;r<this._grid.oneRowDataLength;r++){
var n,l=(n=this._grid.getCellInfo(r)).options.dataType;if("select"==n.options.inputType){var h=[];for(a=0;a<n.itemArr.length;a++){h[(d=n.itemArr[a]).label]=d.value}for(a=0;a<i;a++){t[u=a*this._grid.oneRowDataLength+r]=h[t[u]]}}else if("checkcombobox"==n.options.inputType){for(h=[],a=0;a<n.itemArr.length;a++){var d;h[(d=n.itemArr[a]).label]=d.value}for(a=0;a<i;a++){for(var u=a*this._grid.oneRowDataLength+r,p=[],c=t[u].split(n.separator),g=0;g<c.length;g++)p.push(h[c[g]]);t[u]=p.join(n.separator)}}if(""!=n.options.displayFormat)for(a=0;a<i;a++){var f,m=t[u=a*this._grid.oneRowDataLength+r],y=n.options.displayFormat;f="number"==l||"bigDecimal"==l?WebSquare.text.unformatCurrency(y,m):"date"==l?WebSquare.text.unformatDate(y,m):"time"==l?WebSquare.text.unformatTime(y,m):WebSquare.text.unformatText(y,m),t[u]=f}}this._grid._dataList.setData(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setData=function(t,e,i){try{this._grid._dataList.setData(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.insertData=function(t,e){try{this._grid._dataList.insertData(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype._insertData=function(t,e,i){try{this._grid._dataList._insertData(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDataLength=function(){try{var t;if(this._grid.successBinding)if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var e in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[e])return this._grid._dataList.getDataLength();t=this._grid.groupbyStatus.groupedRowIndexArr.length}else t=this._grid._dataList.getDataLength();else t=0;return t}catch(t){s.Y.printStackTrace(t)}},l.prototype.setRowXML=function(t,e,i){try{this._grid._dataList.setRowXML(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setXML=function(t,e,i){try{if("grid"==this._grid.initializeType&&i&&i.ref&&(this._grid.options.ref=i.ref,this._grid._dataList.options.ref=i.ref,i.baseNode&&(this._grid.options.baseNode=i.baseNode,this._grid._dataList.options.baseNode=i.baseNode),i.repeatNode&&(this._grid.options.repeatNode=i.repeatNode,this._grid._dataList.options.repeatNode=i.repeatNode),i.aliasDataCollection&&(this._grid.options.aliasDataCollection=i.aliasDataCollection,this._grid._dataList.options.aliasDataCollection=i.aliasDataCollection),this._grid._setRef(),this._grid._dataList.repeatNodeTagName=this.repeatNodeTagName),null==t)return void n.v.printLog("[WebSquare.uiplugin.mappingController.setXML] XML is null["+this.id+"]");var o=this._grid.xmlData2ArrData(t);if(void 0===o)return void n.v.printLog("[WebSquare.uiplugin.mappingController.setXML] DataArray which converted from XML is undefined.["+this.id+"]");this.setData(o,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.insertXML=function(t,e){try{this._grid._dataList.insertXML(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setJSON=function(t,e){try{if(null==t)return void n.v.printLog("[WebSquare.uiplugin.mappingController.setJSON] JSON is null["+this.id+"]");var i=this._grid.jsonData2ArrData(t);if(void 0===i)return void n.v.printLog("[WebSquare.uiplugin.mappingController.setJSON] DataArray which converted from JSON is undefined.["+this.id+"]");this.setData(i,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setRowJSON=function(t,e,i){try{this._grid._dataList.setRowJSON(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.insertJSON=function(t,e){try{this._grid._dataList.insertJSON(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.rowMoveUp=function(t){try{this._grid._dataList.rowMoveUp(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.rowMoveDown=function(t){try{this._grid._dataList.rowMoveDown(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.rowMoveUpFiltered=function(t){try{this._grid._dataList.rowMoveUpFiltered(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.rowMoveDownFiltered=function(t){try{this._grid._dataList.rowMoveDownFiltered(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.insertRow=function(t,e){try{e=e||{}
;return this._grid.options.insertIntoSortedRow&&(e.insertIntoSortedRow=this.options.insertIntoSortedRow),"grid"==this.initializeType&&this.options.ref&&1==this.repeatNodeTagNameFilter&&(t=null),this._grid._dataList.insertRow(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.removeRow=function(t,e){try{return this._grid._dataList.removeRow(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.removeRows=function(t){try{return this._grid._dataList.removeRows(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.removeAll=function(){try{return this._grid._dataList.removeAll()}catch(t){s.Y.printStackTrace(t)}},l.prototype.removeRange=function(t,e){try{return this._grid._dataList.removeRange(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.reform=function(){try{this._grid._dataList.reform()}catch(t){s.Y.printStackTrace(t)}},l.prototype.undoRow=function(t){try{this._grid._dataList.undoRow(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype._undoRow=function(t){try{this._grid._dataList._undoRow(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.undoAll=function(){try{this._grid._dataList.undoAll()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowStatusValue=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatusValue(e)}catch(t){s.Y.printStackTrace(t)}},l.prototype._getRowStatusValue=function(t){try{return this._grid._dataList._getRowStatusValue(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowStatus=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatus(e)}catch(t){s.Y.printStackTrace(t)}},l.prototype._getRowStatus=function(t){try{return this._grid._dataList._getRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRowIndexByStatus=function(t){try{return this._grid._dataList.getRowIndexByStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.getInsertedIndex=function(){try{return this.getRowIndexByStatus("C")}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUpdatedIndex=function(){try{return this.getRowIndexByStatus("U")}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDeletedIndex=function(){try{return this.getRowIndexByStatus("DV")}catch(t){s.Y.printStackTrace(t)}},l.prototype.getOnlyDeletedIndex=function(){try{return this.getRowIndexByStatus("D")}catch(t){s.Y.printStackTrace(t)}},l.prototype.getVoidIndex=function(){try{return this.getRowIndexByStatus("V")}catch(t){s.Y.printStackTrace(t)}},l.prototype.getModifiedIndex=function(){try{return this.getRowIndexByStatus("CUD")}catch(t){s.Y.printStackTrace(t)}},l.prototype.getInsertedData=function(){try{return this._grid._dataList.getInsertedData()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getInsertedXML=function(){try{return this._grid._dataList.getInsertedXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getInsertedJSON=function(){try{return this._grid._dataList.getInsertedJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getInsertedArray=function(){try{return this._grid._dataList.getInsertedArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDeletedData=function(){try{return this._grid._dataList.getDeletedData()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDeletedXML=function(){try{return this._grid._dataList.getDeletedXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDeletedJSON=function(){try{return this._grid._dataList.getDeletedJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getDeletedArray=function(){try{return this._grid._dataList.getDeletedArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRemovedXML=function(){try{return this._grid._dataList.getRemovedXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRemovedJSON=function(){try{return this._grid._dataList.getRemovedJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getRemovedArray=function(){try{return this._grid._dataList.getRemovedArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getVoidData=function(){try{return this._grid._dataList.getVoidData()}catch(t){s.Y.printStackTrace(t)
}},l.prototype.getVoidXML=function(){try{return this._grid._dataList.getVoidXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getVoidJSON=function(){try{return this._grid._dataList.getVoidJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getVoidArray=function(){try{return this._grid._dataList.getVoidArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getOnlyDeletedData=function(){try{return this._grid._dataList.getOnlyDeletedData()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getOnlyDeletedXML=function(){try{return this._grid._dataList.getOnlyDeletedXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getOnlyDeletedJSON=function(){try{return this._grid._dataList.getOnlyDeletedJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getOnlyDeletedArray=function(){try{return this._grid._dataList.getOnlyDeletedArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUpdatedData=function(){try{return this._grid._dataList.getUpdatedData()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUpdatedXML=function(){try{return this._grid._dataList.getUpdatedXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUpdatedJSON=function(){try{return this._grid._dataList.getUpdatedJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getUpdatedArray=function(){try{return this._grid._dataList.getUpdatedArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getModifiedData=function(){try{return this._grid._dataList.getModifiedData()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getModifiedXML=function(){try{return this._grid._dataList.getModifiedXML()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getModifiedJSON=function(){try{return this._grid._dataList.getModifiedJSON()}catch(t){s.Y.printStackTrace(t)}},l.prototype.getModifiedArray=function(){try{return this._grid._dataList.getModifiedArray()}catch(t){s.Y.printStackTrace(t)}},l.prototype._setRowStatus=function(t,e){try{return this._grid._dataList._setRowStatus(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype._initRowStatus=function(t){try{this._grid._dataList._initRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.initRowStatus=function(t){try{this._grid._dataList.initRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype._createRowStatus=function(t){try{this._grid._dataList._createRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype._updateRowStatus=function(t){try{this._grid._dataList._updateRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.removeRowStatus=function(t){try{return this._grid._dataList.removeRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.deleteRow=function(t){try{this._grid._dataList.deleteRow(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype._deleteRowStatus=function(t){try{this._grid._dataList._deleteRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.undeleteRow=function(t){try{this._grid._dataList.undeleteRow(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype._undeleteRowStatus=function(t){try{this._grid._dataList._undeleteRowStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.modifyAllStatus=function(t){try{this._grid._dataList.modifyAllStatus(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.modifyRangeStatus=function(t,e,i){try{var o=[],a=this.getDataLength()+1;if(0<=t&&e<a)for(var n=t;n<e;n++){var l=this.getRealRowIndex(n),h=this._setRowStatus(l,i);i!=h&&o.push({rowIndex:n,newRowStatus:i,oldRowStatus:h})}r.f.fireEvent(this,"onrowstatuschange",o),this.broadcast({gridView:["notifyModifyRangeStatus",[t,e,i]]})}catch(t){s.Y.printStackTrace(t)}},l.prototype.modifyMatchedStatus=function(t,e,i){try{this._grid._dataList.modifyMatchedStatus(t,e,i)}catch(t){s.Y.printStackTrace(t)}},l.prototype.modifyRowStatus=function(t,e){try{this._grid._dataList.modifyRowStatus(t,e)}catch(t){s.Y.printStackTrace(t)}},l.prototype.setColumnFilter=function(t,e,i,r){try{"object"!==(0,o.A)(t)||a.Z.isString(t)||(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.setColumnFilter(t,e,i,r):this._grid._dataList.setColumnFilter(t,e,i,r)
}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.removeColumnFilter=function(t){try{t=this._grid.getColumnID(t);this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilter(t,{internal:!0}):this._grid._dataList.removeColumnFilter(t,{internal:!0})}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.clearSortFilter=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSortFilter():this._grid._dataList.clearSortFilter()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.removeColumnFilterAll=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilterAll():this._grid._dataList.removeColumnFilterAll()}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.setFilter=function(t){try{if(this._grid._linkedDataList)t.internal=!0,this._grid._linkedDataList.setFilter(t);else{if(t){var e=this._grid.getColumnID(t.sortIndex),i=this._grid.cellInfoHash[e]||{options:{}};if(t.isExpressionArr=[],t.cellInfoArr=[],t.gridId=this._grid.id,i&&"expression"==i.options.inputType&&"gridView"==this._grid.initializeType&&isNaN(this._grid._dataList.getColumnIndex(t.sortIndex))&&(t.fakeExpressionArr=this._grid.getFakeExpressionArr()),e){var o=e.split(" "),r=[];t.isCustomCol=[],t.sortLabel=[];for(var a=0;a<o.length;a++){i=this._grid.cellInfoHash[o[a]];var n=!1;if("custom"!=i.options.inputType||i.internal?"expression"==i.options.inputType?(t.isExpression=!0,t.isExpressionArr.push(!0)):t.isExpressionArr.push(!1):(n=!0,t.isExpressionArr.push(!1)),t.cellInfoArr.push(o[a]),n)if(t.isCustomCol.push(!0),t.customSortItemsetIdObj=[],i.options.sortLabel){for(var l=this.getTotalRow(),h={},d={},u=0;u<l;u++){var p=i.cellManagerHashByRowIndex[u]?i.cellManagerHashByRowIndex[u]:i;if("select"==p.options.inputType||"autoComplete"==p.options.inputType){var c=p.dataComp;if(c&&!h[c])"linkedDataList"==(g=this._grid.modelControl.getDataComp(c)).initializeType?h[c]=g._dataList.getAllJSON():h[c]=g.getAllJSON();d[u]=c,t.customSortItemsetIdObj[u]={label:p.itemsetObj.label,value:p.itemsetObj.value}}else d[u]=""}t.customCellDataListInfo=d,t.customDataListInfoHash=h,t.sortLabel.push(!0)}else r[a]=[],t.sortLabel.push(!1);else if(t.isCustomCol.push(!1),!i.options.sortLabel||"select"!=i.options.inputType&&"autoComplete"!=i.options.inputType)r[a]=[],t.sortLabel.push(!1);else{var g;if(i.dataComp)"linkedDataList"==(g=this._grid.modelControl.getDataComp(i.dataComp)).initializeType?r[a]=g._dataList.getAllJSON():r[a]=g.getAllJSON();else r[a]=i.getItemArray();t.sortItemsetIdObj={label:i.itemsetObj.label,value:i.itemsetObj.value},t.sortLabel.push(!0)}}r.length>0&&(t.sortItemArr=r)}}t.internal=!0,this._grid._dataList.setFilter(t),"outfocus"==t.focuseMode&&this._grid.setScrollTop(0)}}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.removeFilter=function(t,e){try{t&&(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.removeFilter(t,e):this._grid._dataList.removeFilter(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.clearFilter=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.clearFilter(t):this._grid._dataList.clearFilter(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.sort=function(t,e){try{this._grid._linkedDataList?this._grid._linkedDataList.sort(t,e):this._grid._dataList.sort(t,e)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.clearSort=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSort():(this._grid._dataList.clearSort(),"outfocus"==this._grid.options.filterFocusMode&&this._grid.setScrollTop(0))}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.multisort=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.multisort(t):this._grid._dataList.multisort(t)}catch(t){s.Y.printStackTrace(t,null,this)}},l.prototype.setMatchIgnoreCase=function(t){try{return this._grid._dataList.setMatchIgnoreCase(t)}catch(t){s.Y.printStackTrace(t)}},l.prototype.mappingCommonAPI=function(){try{
this._grid._getData=this._getData,this._grid._getRowData=this._getRowData,this._grid._setCellData=this._setCellData,this._grid._setOriginalCellData=this._setOriginalCellData,this._grid._insertData=this._insertData,this._grid._undoRow=this._undoRow,this._grid._getRowStatusValue=this._getRowStatusValue,this._grid._getRowStatus=this._getRowStatus,this._grid._setRowStatus=this._setRowStatus,this._grid._createRowStatus=this._createRowStatus,this._grid._updateRowStatus=this._updateRowStatus,this._grid._deleteRowStatus=this._deleteRowStatus,this._grid._undeleteRowStatus=this._undeleteRowStatus,this._grid.getRowJSON=this.getRowJSON,this._grid.getRowCount=this.getRowCount,this._grid.getCellData=this.getCellData,this._grid._getCellData=this._getCellData,this._grid.getOriginalCellData=this.getOriginalCellData,this._grid.getColData=this.getColData,this._grid.getRowData=this.getRowData,this._grid.getDataRow=this.getDataRow,this._grid.getMatchedData=this.getMatchedData,this._grid.getUnmatchedData=this.getUnmatchedData,this._grid.getMatchedColumnData=this.getMatchedColumnData,this._grid.getUnmatchedColumnData=this.getUnmatchedColumnData,this._grid.getMatchedIndex=this.getMatchedIndex,this._grid.getUnmatchedIndex=this.getUnmatchedIndex,this._grid.getRangeData=this.getRangeData,this._grid.getAllData=this.getAllData,this._grid.getColumnDistinctDataArray=this.getColumnDistinctDataArray,this._grid.getRangeXML=this.getRangeXML,this._grid.getMatchedXML=this.getMatchedXML,this._grid.getUnmatchedXML=this.getUnmatchedXML,this._grid.getRowXML=this.getRowXML,this._grid.getAllXML=this.getAllXML,this._grid.getRowJSON=this.getRowJSON,this._grid.getAllJSON=this.getAllJSON,this._grid.getRangeJSON=this.getRangeJSON,this._grid.getMatchedJSON=this.getMatchedJSON,this._grid.getUnmatchedJSON=this.getUnmatchedJSON,this._grid.getRowStatusValue=this.getRowStatusValue,this._grid.getRowStatus=this.getRowStatus,this._grid.getRowIndexByStatus=this.getRowIndexByStatus,this._grid.getInsertedIndex=this.getInsertedIndex,this._grid.getUpdatedIndex=this.getUpdatedIndex,this._grid.getDeletedIndex=this.getDeletedIndex,this._grid.getModifiedIndex=this.getModifiedIndex,this._grid.getInsertedData=this.getInsertedData,this._grid.getInsertedXML=this.getInsertedXML,this._grid.getInsertedJSON=this.getInsertedJSON,this._grid.getDeletedData=this.getDeletedData,this._grid.getDeletedXML=this.getDeletedXML,this._grid.getDeletedJSON=this.getDeletedJSON,this._grid.getVoidData=this.getVoidData,this._grid.getVoidXML=this.getVoidXML,this._grid.getVoidJSON=this.getVoidJSON,this._grid.getOnlyDeletedData=this.getOnlyDeletedData,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedJSON=this.getOnlyDeletedJSON,this._grid.getUpdatedData=this.getUpdatedData,this._grid.getUpdatedXML=this.getUpdatedXML,this._grid.getUpdatedJSON=this.getUpdatedJSON,this._grid.getModifiedData=this.getModifiedData,this._grid.getModifiedXML=this.getModifiedXML,this._grid.getModifiedJSON=this.getModifiedJSON,this._grid.setMatchIgnoreCase=this.setMatchIgnoreCase}catch(t){s.Y.printStackTrace(t,null,this)}}},4980:function(t,e,i){i.d(e,{A:function(){return r}});var o=i(2284);function s(t){var e=function(t,e){if("object"!=(0,o.A)(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=(0,o.A)(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==(0,o.A)(e)?e:e+""}function r(t,e,i){return(e=s(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}}}]);