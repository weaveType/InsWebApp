"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[3391],{3391:(e,t,i)=>{i.r(t),i.d(t,{selectbox:()=>p,selectbox_native:()=>c});var s=i(582),o=i(2536),l=i(2710),n=i(9107),r=i(1263),a=i(7249),h=i(5386),d=i(3477),p=function(e,t,i){a.q.call(this,e,t,i)};s.q.extend(p.prototype,a.q.prototype),s.q.extend(p.prototype,h.t.prototype),s.q.extend(p.prototype,d.G.prototype),p.prototype.defaultOptions={pluginType:"uiplugin.selectbox",pluginName:"selectbox",renderType:"component",mobileRenderType:"",serializable:!0,userEvents:["onchange","onclose","onviewchange","onblur","ontooltipshow","ontooltiphide","onselected"],systemEvents:["onclick","ondblclick","onfocus","onblur","onkeydown","onkeyup"],useOtherComponentId:"",useConfig:!0,value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",wmode:!1,visibleRowNum:5,displayMode:"0",delimiter:"\t",textAlign:"",defaultStyle:"",activeStyle:"",defaultClass:"w2SelectDefault",activeClass:"w2SelectActive",disabledClass:"w2selectbox_disabled",useLocale:!1,submenuSize:"auto",direction:"auto",tableRender:"",tooltipDisplay:!1,tooltipShowAlways:!1,tooltipClass:"",tooltipTime:1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",title:"",setDataRemoveAll:!0,escape:!0,emptyItem:!1,emptyValue:"",emptyIndex:0,optionOrder:"choose",animation:"",closeonmouseleave:!1,selectedData:!0,dataListAutoRefresh:!1,refreshSelectedIndex:!1,preventWheelEvent:!1,customFormatter:"",customLabelFormatter:"",keyMoveListSync:!1,keyMoveSync:!0,wheelRows:0,visibleColumn:"",visibleColumnFalseValue:"0,false,FALSE,F",findItemFirstKey:!0,enableColumn:"",enableColumnFalseValue:"0,false,FALSE,F",depthColumn:"",depthColumnWidth:0,depthColumnHeight:0,depthColumnShowPath:!1,depthColumnPathDelimiter:"-",keyBufferResetTime:1e3,customToggleKey:"",selectByTabKey:!1,preventKeyList:"",valueNotInList:"default"},p.prototype.initialize=function(e){try{if(this._initializeCommon(e&&"$blank"==e.getAttribute("chooseOptionLabel")),this.gridOptions={},this.gridViewOptions={},e){var t="xf"==e.getTagName().split(":")[0]?o.I._XML_NAMESPACE.XFORMS:o.I._XML_NAMESPACE.W2,i=WebSquare.Elem.api.getElementsByTagName(e,"choices",t)[0];if(i){var s=WebSquare.Elem.api.getElementsByTagName(i,"gridItemset",o.I._XML_NAMESPACE.W2)[0];null==s&&(s=WebSquare.Elem.api.getElementsByTagName(i,"gridViewItemset",o.I._XML_NAMESPACE.W2)[0]),s&&"w2:gridItemset"==s.getTagName()?this.itemTableMode="grid":s&&"w2:gridViewItemset"==s.getTagName()&&(this.itemTableMode="gridView")}else"gridViewItemset"==this.options.itemTableType&&(this.itemTableMode="gridView")}"grid"==this.itemTableMode?this.initializeGridItemArr(e):"gridView"==this.itemTableMode?this.initializeGridViewItemArr(e):this.initializeItemArr(e);var n=r.Z.isMobile();if("ul"!==this.options.tableRender||"auto"==this.options.renderType&&n||(this.options.renderType="component"),this.options.customLabelFormatter&&(this.customLabelFormatter=r.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),this.myhelper=new WebSquare.korHelper,this._preventKeyObj={},this.options.preventKeyList)if("all"===this.options.preventKeyList)this._preventKeyObj.all=!0;else for(var a=this.options.preventKeyList.split(","),h=0;h<a.length;h++){var d=a[h].wq_trim();d&&(this._preventKeyObj[d]=!0)}this.options.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._initializeCommon=function(e){try{this.itemTable=null,this.isOpen=!1,this.statusSubLayer=!1,this.selectedIndex=-1,this.selectedAllIndex=-1,this.cursorIndex=-1,this.showRowIndex=0,this.displayCount=0,this.tooltip=null,this.timeShowTooltip=null,
this.timeHideTooltip=null,this.defaultAllOptionLabel=WebSquare.language.getMessage("SelectBox_all");var t=o.I.getConfiguration("/WebSquare/"+this.options.pluginName+"/chooseOptionLabel/@value");this.defaultChooseOptionLabel=e||!e&&"$blank"===t?"":WebSquare.language.getMessage("SelectBox_choose"),this._initDisplayMode(),this.options.selectedData="false"!=this.options.selectedData&&!1!==this.options.selectedData,this.refreshStop=!1,this.validator=new WebSquare.validator.validateInvoker(this.id,this.options),this.isFireTooltipEvent=!1,this._keyBuffer="",this.keyCharHash={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"},this.korCharHash={65:"ㅁ",67:"ㅊ",68:"ㅇ",69:"ㄷ",70:"ㄹ",71:"ㅎ",81:"ㅂ",82:"ㄱ",83:"ㄴ",84:"ㅅ",86:"ㅍ",87:"ㅈ",88:"ㅌ",90:"ㅋ"},this.korCharHash2={69:"ㄸ",81:"ㅃ",82:"ㄲ",84:"ㅆ",87:"ㅉ"},this.options.depthColumn&&(this.options.tableRender="ul")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.finalize=function(){try{a.q.prototype.finalize.call(this),this.labelRuler&&(this.labelRuler.parentNode.removeChild(this.labelRuler),this.labelRuler=null),this.itemTable&&(this.itemTable.remove(),this.itemTable=null)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.toHTML=function(){try{var e=[],t=""==this.options.style?"":"style='"+this.options.style+"'",i="";i=!0===this.options.disabled?"":""===this.options.tabIndex?"tabIndex='0'":"tabIndex='"+this.options.tabIndex+"'";var s=""==this.options.title?"":"title='"+this.options.title+"'",o=""==this.options.defaultStyle?"":"style='"+this.options.defaultStyle+"'",n=""==this.options.textAlign?o:"style='text-align:"+this.options.textAlign+";"+this.options.defaultStyle+"'";return"ul"===this.options.tableRender?(e.push("<div id='"+this.id+"' "+t+" class='w2selectbox "+this.options.className+"' "+s+">"),e.push("<a id='"+this.id+"_main_tbody' class='w2selectbox_ul_table_main' href='#"+this.id+"_itemTable' aria-haspopup='true' aria-expanded='false' onclick='event.returnValue=false; return false;'>"),e.push("<div class='w2selectbox_ul_col_label' "+o+"><span id='"+this.id+"_label' class='w2selectbox_ul_label' "+n+"></span></div>"),e.push("<span class='w2selectbox_ul_col_arrow'></span>"),e.push("</a>"),e.push("</div>")):(e.push("<div id='"+this.id+"' role='combobox' aria-labelledby='"+this.id+"_itemTable' aria-autocomplete='none' "+t+" class='w2selectbox "+this.options.className+"' "+i+" "+s+">"),e.push("<table class='w2selectbox_table_main'>"),e.push("<tbody id='"+this.id+"_main_tbody'>"),e.push("<tr class='w2selectbox_row w2selectbox_row_main'>"),e.push("<td class='w2selectbox_col_label' "+o+"><div id='"+this.id+"_label' role='document' aria-live='assertive' aria-automatic='true' class='w2selectbox_label' "+n+"></div></td>"),e.push("<td class='w2selectbox_col_button' id='"+this.id+"_button'  aria-labelledby='"+this.id+"_itemTable' aria-controls='"+this.id+"_itemTable'></td>"),e.push("</tr></tbody>"),e.push("</table>"),e.push("</div>")),e.join("")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setPreAction=function(){try{this.options.itemTooltipDisplay&&this.options.itemTooltipFormatter&&(this.itemTooltipFormatter=r.Z.getGlobalFunction(this.options.itemTooltipFormatter,this.scope_id)),this.dom.button=this.getElementById(this.id+"_button"),this.dom.label=this.getElementById(this.id+"_label"),this.dom.tbody=this.getElementById(this.id+"_main_tbody"),this.options.useOtherComponentId?o.I.setTimer((function(){this.otherComponent=r.Z.getComponentById(this.options.useOtherComponentId),WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.options.useOtherComponentId,WebSquare.getBody().getLayerListener().addListener({
component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.otherComponent.render,"onmousedown",this.event.bindAsEventListener(this.otherComponent,(function(e){n.f.stopPropagation(e)}))),this.otherComponent.hide()}),{key:this.options.useOtherComponentId,caller:this,delay:100}):"grid"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):"gridView"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridViewItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openSubLayer,fnHide:this._closeSubLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),r.Z.isTouchDevice()&&(this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,(function(e){n.f.stopPropagation(e)}))),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,(function(e){1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll(),this._closeSubLayer()})))),this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(e){n.f.stopPropagation(e)}))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyupEvent)),this.event.addListener(this.render,"onmousewheel",this.event.bindAsEventListener(this,this.handleMousewheelEvent)),this.event.addListener(this.render,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.render,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),1==this.options.closeonmouseleave&&this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,this.handleMouseleaveEvent)),this.modelControl.isItemsetBinded()?(this._refreshItemArr(),this.componentRedraw()):!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var e=document.getElementById(this.id).style.cssText,t=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:e,className:t}}if(this.modelControl.isBinded()){var i=this.modelControl.getData();this.setValueNM(i)}if(-1==this.selectedIndex&&this.getItemCount()>0&&(0==this.options.emptyIndex||!this.options.emptyIndex))if(this.modelControl.isBinded()){i=this.getValue();if(this.options.emptyRef){for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value==i){this.setSelectedIndexNM(0),this.modelControl.setData(i);break}}else this.setSelectedIndexNM(0),this.modelControl.setData(i)}else this.setSelectedIndexNM(0),this.broadcast({linkedDataList:["refresh",["replace"]]});else this.options.emptyIndex&&"number"==typeof this.options.emptyIndex?this.modelControl.isBinded()?(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(this.options.emptyIndex),this.broadcast({linkedDataList:["refresh",["replace"]]
})):this.selectedIndex>0&&this.getItemCount()>0&&(this.modelControl.isBinded()||(this.setSelectedIndexNM(this.selectedIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})));this.options.mandatory&&this.onPropertyChange("mandatory",r.Z.getBoolean(this.options.mandatory))}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.onComplete=function(){try{this.options.customFormatter&&(this.customFormatter(),this.setSelectedIndexNM(this.selectedIndex)),a.q.prototype.onComplete.call(this)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.customFormatter=function(){try{var e=null;"grid"===this.itemTableMode||"gridView"===this.itemTableMode||("function"==typeof this.options.customFormatter?e=this.options.customFormatter:null!=(e=r.Z.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=e),"function"==typeof e&&(this.itemArr=e.call(this,this.itemArr)))}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._refreshItemArr=function(){try{this.refreshItemArr(),this.options.customFormatter&&this.completed&&this.customFormatter()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.refreshItemset=function(e,t){try{if(this.refreshStop)return;if(this.modelControl.isItemsetBinded())if(this._refreshItemArr(),this.componentRedraw(!1,e,t),"grid"==this.itemTableMode?(this.refreshGridItemArr(),null!=this.itemTable&&null!=this.itemTable.grid?(this.itemTable.grid.clearFilter(),this.setGridData(),this.options.allOption&&this.gridItemArr.length>0&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))):1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))):"gridView"==this.itemTableMode&&(this.refreshGridViewItemArr(),null!=this.itemTable&&null!=this.itemTable.gridView?"dataList"===this.gridViewOptions.dataComp.initializeType&&this.setGridViewData():1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))),this.modelControl.isBinded())this.refresh();else{if("auto"==this.options.submenuSize&&this.itemTable&&"grid"!==this.itemTableMode&&"gridView"!==this.itemTableMode&&!0!==this.refreshStopItemTable){var i=this.getMaxLabelSize();this.itemTable.setStyle("width",i+"px")}-1!=this.getSelectedIndex()||null!=this.getValue()&&""!==this.getValue()&&"keepValue"!==this.options.valueNotInList||this.setSelectedIndexNM(0)}this.isOpen&&this.setItemTable(),this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.refresh=function(){try{if(this.refreshStop)return;if(this.modelControl.isBinded()){var e=this.modelControl.getDataComp(),t=this.getItemCount();if(e&&"linkedDataList"===e.initializeType&&(this.options.chooseOption||this.options.allOption)&&(1!=t||this.itemArr[0].label!==this._getChooseOptionLabel()&&this.itemArr[0].label!==this.defaultAllOptionLabel?2==t&&this.itemArr[0].label===this._getChooseOptionLabel()&&this.itemArr[1].label===this.defaultAllOptionLabel&&(t-=2):t--),t>0){this.modelControl.isDataCollectionItemsetBinded&&this._refreshItemArr();var i=this.getValue(),s=this.modelControl.getData(),o=this.setValueNM(s);1==o?(i!=this.getValue()&&n.f.fireEvent(this,"onchange",{oldValue:i,newValue:this.getValue()}),null!=this.getValue()&&s!=this.getValue()&&this.modelControl.setData(this.getValue()),this.broadcast({linkedDataList:["refresh",["replace"]]})):isNaN(o)?null!=this.getValue()&&s!=this.getValue()&&this.modelControl.setData(this.getValue()):this._setValueNotInList(s,!1)}}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.changeChooseOption=function(e,t){try{var i=-2;if(!0===this.options.chooseOption){i=-1;for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value===this.options.chooseOptionValue){i=o;break}i>-1&&this.itemArr.splice(i,1)}
this.options.chooseOption=!0,this.options.chooseOptionValue=e,this.options.chooseOptionLabel=t,this.itemArr=[{label:t,value:e}].concat(this.itemArr),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),i!==this.getSelectedIndex()&&-1!==this.getSelectedIndex()||this.setSelectedIndex(0)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.showChooseOption=function(e){try{var t=this._getChooseOptionLabel();t=WebSquare.xml.decode(t).replace("&nbsp;"," ");var i=this.options.chooseOptionValue;if(1==e)this.options.chooseOption!=e&&("all"==this.options.optionOrder&&1==this.options.allOption?this.itemArr.splice(1,0,{label:t,value:i}):this.itemArr=[{label:t,value:i}].concat(this.itemArr));else if(this.options.chooseOptions!=e)for(var s=0;s<this.itemArr.length;s++)if(this.itemArr[s].label==t){this.itemArr.splice(s,1);break}this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),-2!==this.getSelectedIndex()&&-1!==this.getSelectedIndex()&&0!==this.getSelectedIndex()||this.setSelectedIndex(0),this.options.chooseOption=e}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.componentRedraw=function(e,t,i){try{if(this.refreshStop)return;if(this.showRowIndex=0,!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.setSelectOptions(),this.itemArr.length>0){var s=0;if(t||this.options.refreshSelectedIndex&&"insertRow"===i)return"insertRow"!==i&&"replace"!=t&&this.getSelectedIndex()>-1&&(s=this.getSelectedIndex()),void(this.itemArr[s]?this.setSelectedIndexNM(s):this.setSelectedIndexNM(0));if(this.options.refreshSelectedIndex&&"setCellData"===i)s=this.getSelectedIndex();else if(this.modelControl.isItemsetBinded()&&!this.modelControl.isBinded()&&-1!==this.selectedIndex)return void(this.options.emptyItem?this.setSelectedIndexNM(-1):this.setSelectedIndexNM(0));if(this._setLabel(s),this.options.refreshSelectedIndex&&"setCellData"===i)return}else this.dom.label&&(this.dom.label.innerHTML="");this.setValueNM("")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setLabelWidthByItemLength=function(){try{var e=this.getMaxLabelSize();this.render&&(this.render.style.width=e+"px")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.getMaxLabelSize=function(){try{this.labelRuler||(this.labelRuler=document.createElement("div"),this.labelRuler.style.position="absolute",this.labelRuler.style.top="-1000px",this.labelRuler.style.left="-1000px",this.labelRuler.style.visibility="hidden",document.body.appendChild(this.labelRuler));for(var e=0,t=0;t<this.itemArr.length;t++)this.labelRuler.innerHTML=this.itemArr[t].label,this.labelRuler.offsetWidth>e&&(e=this.labelRuler.offsetWidth);var i=document.getElementById(this.id+"_button"),s=0;return i&&(s=i.offsetWidth||parseInt(WebSquare.style.getComputedStyle(i,"width"))),e+s+10}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setSubLayer=function(){try{var e=this;if(null==this.itemTable){if("grid"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridOptions.width||(this.gridOptions.parentWidth=this.render.offsetWidth),this.gridOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridItemTable(this.id+"_gridItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridOptions:this.gridOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.grid.addEvent("oncellclick",(function(t,i){e.focus(),
"dataList"===e.gridViewOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t)),e.setSelectedIndex1(t)})),this.event.addListener(this.itemTable.grid.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.grid,(function(t){var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.focus();var s=this.getFocusedRowIndex();"dataList"===e.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(s)}else 27==i&&(e._closeSubLayer(),e.focus())}))),this.setGridData();else if("gridView"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridViewOptions.width||(this.gridViewOptions.parentWidth=this.render.offsetWidth),this.gridViewOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridViewItemTable(this.id+"_gridViewItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridViewOptions:this.gridViewOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.gridView.addEvent("oncellclick",(function(t,i){e.focus(),"dataList"===e.gridViewOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t)),e.setSelectedIndex1(t)})),this.event.addListener(this.itemTable.gridView.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.gridView,(function(t){var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.focus();var s=this.getFocusedRowIndex();"dataList"===e.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(s)}else 27==i&&(e._closeSubLayer(),e.focus())}))),this.setGridViewData();else{if("ul"===this.options.tableRender){var t=this.options.textAlign?"text-align:"+this.options.textAlign+";":"";this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",{row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:t+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_sb",w2table_main:"w2table_sb_ul_main",w2table_row:"w2table_sb_ul_row",w2table_col:"w2table_sb_ul_col",w2table_col_over:this.options.depthColumn?"":"w2table_sb_ul_col_over",escape:this.options.escape,tableRender:this.options.tableRender,wheelRows:this.options.wheelRows,chooseOption:this.options.chooseOption,allOption:this.options.allOption,findItemKor:this.options.findItemKor,findItem:this.options.findItem,keyBufferResetTime:this.options.keyBufferResetTime,parent_uuid:this.uuid,depthColumn:this.options.depthColumn,depthColumnHeight:this.options.depthColumnHeight,depthColumnWidth:this.options.depthColumnWidth})}else this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",{row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:"text-align:"+this.options.textAlign+";"+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_sb",w2table_main:"w2table_sb_main",w2table_row:"w2table_sb_row",w2table_col:"w2table_sb_col",w2table_col_over:"w2table_sb_col_over",escape:this.options.escape,wheelRows:this.options.wheelRows,chooseOption:this.options.chooseOption,allOption:this.options.allOption,findItemKor:this.options.findItemKor,findItem:this.options.findItem,keyBufferResetTime:this.options.keyBufferResetTime,parent_uuid:this.uuid,depthColumn:this.options.depthColumn,depthColumnHeight:this.options.depthColumnHeight,depthColumnWidth:this.options.depthColumnWidth});this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.addClickEventListener((function(t,i){var s,o=t.charCode?t.charCode:t.keyCode,l=e.selectedIndex,r=e.getValue();if(e.focus(),e.options.depthColumn&&(s={skipClose:!0}),e.setSelectedIndex1(i,s),e.options.keyMoveSync||0!=e.options.keyMoveSync||13!=o||"keydown"!==t.type){var a={oldValue:r,newValue:e.getValue(),
oldSelectedIndex:l,newSelectedIndex:e.selectedIndex};n.f.fireEvent(e,"onselected",a)}})),this.itemTable.addKeyDownEventListener((function(t,i){var s=t.charCode?t.charCode:t.keyCode;if(e.options.customToggleKey==s)e._closeSubLayer(),e.focus();else if(e.options.selectByTabKey&&9==s){var o=e.selectedIndex,l=e.getValue();e.focus(),e.setSelectedIndex1(i);var r={oldValue:l,newValue:e.getValue(),oldSelectedIndex:o,newSelectedIndex:e.selectedIndex};n.f.fireEvent(e,"onselected",r),n.f.preventDefault(t)}else"ul"==this.options.tableRender&&e.itemTable.endReached?(e.itemTable.endReached=!1,e.closeSubLayer(),e.focus()):27==s&&(e._closeSubLayer(),e.focus())})),this.options.keyMoveSync||this.itemTable.addKeyUpEventListener((function(t,i){if(13==(t.charCode?t.charCode:t.keyCode)){var s=e.selectedIndex,o=e.getValue();e.focus(),e.setSelectedIndex1(i);var l={oldValue:o,newValue:e.getValue(),oldSelectedIndex:s,newSelectedIndex:e.selectedIndex};n.f.fireEvent(e,"onselected",l)}})),this.options.keyMoveListSync&&this.itemTable.addOnchangeListener((function(t){try{e.setSelectedIndex1(t,{skipClose:!0})}catch(e){l.Y.printStackTrace(e,null,this)}}));var i=WebSquare.idCache[this.uuid],s=this.options.closeonmouseleave,o=this.options.itemTooltipDisplay;(s||o)&&this.itemTable.addMouseLeaveEventListener((function(t){if(s){var l=e.render.offsetHeight,n=e.getAbsolutePosition("top");t.clientY>=n&&t.clientY<=n+l||e.closeSubLayer()}o&&i.hideTooltip()})),o&&this.itemTable.addMouseOverEventListener((function(e){var t=r.Z.getDataPrefix("index"),s=e,o=WebSquare.style.getAbsoluteLeft(s)+20,l=WebSquare.style.getAbsoluteTop(s)+s.offsetHeight+3,n="ul"===i.options.tableRender?s.innerText:s.innerHTML;if(i.itemTooltipFormatter&&"function"==typeof i.itemTooltipFormatter){var a=parseInt(s.getAttribute(t),10);n=i.itemTooltipFormatter(n,a,i.options._rowIndex,i.options._colIndex)}i.showTooltip(o,l,n)})),this.setSelectOptions(),this.setItemTable()}var a=document.getElementById(this.id+"_main_tbody");a&&a.setAttribute("aria-controls",this.id+"_itemTable")}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setGridData=function(){try{if(this.itemTable.grid.setData(this.gridItemArr),this.options.allOption&&this.gridItemArr.length>0){for(var e=[],t=-1,i=0;i<this.itemsetObj.items.length;i++)-1==t&&this.itemsetObj.items[i].ref==this.itemsetObj.label&&(t=i),e.push("");e[-1==t?0:t]=this.defaultAllOptionLabel,this.itemTable.grid.setRowData(0,e,!1)}if(this.itemsetObj.sortIndex&&this.gridItemArr.length>0){var s=[];if(this.options.allOption){var o=this.itemsetObj.sortIndex.split(" ")[0],n=this.itemTable.grid.getCellInfo(o).options.dataType,r=parseInt(this.itemsetObj.sortOrder.split(" ")[0],10);s[0]=function(e,t,i,s){return 0==i?-1:0==s?1:("number"==n?(e=Number(e),t=Number(t)):(e=e||"",t=t||""),e>t?1*r:e<t?-1*r:0)}}this.itemTable.grid.multisort({sortIndex:this.itemsetObj.sortIndex,sortOrder:this.itemsetObj.sortOrder,sortFuncArr:s})}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setGridViewData=function(){try{var e=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList);if(e.removeAll(),e.setData(this.gridViewOptions.dataComp.getAllFilteredData()),this.options.allOption||this.options.chooseOption){for(var t=[],i=-1,s=0;s<this.itemsetObj.items.length;s++)-1==i&&this.itemsetObj.items[s].ref==this.itemsetObj.label&&(i=e.bodyIdColIndexMap[this.itemsetObj.label]),t.push("");this.options.allOption&&(t[-1==i?0:i]=this.defaultAllOptionLabel,e.setRowData(0,t,!1)),this.options.chooseOption&&(t[-1==i?0:i]=this._getChooseOptionLabel(),e.setRowData(0,t,!1))}for(var o=this.gridViewItemArr.length>0&&this.itemTable.gridView.delayedDrawObj&&this.itemTable.render&&"none"===this.itemTable.render.style.display,n=0;n<this.itemArr.length;n++)this.itemArr[n]._hidden?this.itemTable.gridView.setRowVisible(n,!1):this.itemTable.gridView.setRowVisible(n,!0);o&&this.itemTable.show(),this.itemTable.gridView.notifyDataChanged({keepTop:!0}),o&&this.itemTable.hide()}catch(e){
l.Y.printStackTrace(e,null,this)}},p.prototype.setSelectOptions=function(){try{null!=this.itemTable&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&!0!==this.refreshStopItemTable&&this.itemTable.setItemArr(this.itemArr)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setItemTable=function(){try{var e=this.render.offsetWidth,t=document.body.offsetWidth,i=0,s=WebSquare.style.getAbsoluteLeft(this.render),n=WebSquare.style.getAbsoluteTop(this.render),r=this.itemTable.render.getElementsByTagName("td");if("ul"===this.options.tableRender&&(r=this.itemTable.render.getElementsByTagName("li")),this.options.depthColumn);else if(r&&r.length>0){for(var a=this.options.visibleRowNum,h=0,d=0;d<this.itemArr.length&&a>0;d++)this.options.visibleColumn&&this.options.visibleColumnFalseValue&&!0===this.itemArr[d]._hidden||(i+=r[d].offsetHeight,a--,h++);o.I.browserCheck.moz&&i<34&&1===h&&(i=34),this.itemTable.setStyle("height",i+"px")}else this.itemTable.setStyle("height","0px");"auto"==this.itemTable.getStyle("overflow-x")&&(i+=20,this.itemTable.setStyle("height",i+"px"));var p=WebSquare.style.getSize(this.itemTable.render,"outerwidth")-WebSquare.style.getSize(this.itemTable.render,"width");if(this.options.depthColumn);else if("fixed"==this.options.submenuSize)this.itemTable.setStyle("width",e-p+"px"),this.itemTable.render.offsetHeight>=this.itemTable.render.scrollHeight?this.itemTable.render.firstChild.style.width=e+"px":this.itemTable.render.firstChild.style.width=e-17+"px";else if("auto"==this.options.submenuSize){var c,u=this.render.offsetWidth,m=WebSquare.style.getSize(this.itemTable.render,"innerwidth")-WebSquare.style.getSize(this.itemTable.render,"width"),b=this.itemTable.render.clientWidth-m;if(t>u&&t<b&&(b=t-p),b=u-p,this.itemTable.setStyle("width",b+"px"),this.itemTable.render.clientHeight>=this.itemTable.render.scrollHeight||this.getItemCount()<=this.options.visibleRowNum)this.itemTable.render.firstChild.style.width=b+"px",(c=this.itemTable.render.scrollWidth-p)>b&&(this.itemTable.render.firstChild.style.width=c+"px",this.itemTable.setStyle("width",c+"px"));else this.itemTable.render.firstChild.style.width=b-17+"px",(c=this.itemTable.render.scrollWidth-p)>t&&(c=t-17),c>b-17&&(this.itemTable.render.firstChild.style.width=c+"px",this.itemTable.setStyle("width",c+17+"px"));0===this.getItemCount()&&(this.itemTable.setStyle("width","0px"),this.itemTable.render.firstChild.style.width="0px")}else this.itemTable.render.scrollHeight-this.itemTable.render.offsetHeight>1&&this.itemTable.setStyle("width",this.itemTable.render.firstChild.offsetWidth+17+"px");var f=this.options.direction;if("auto"==f){var y=document.body.scrollTop;y<document.documentElement.scrollTop&&(y=document.documentElement.scrollTop);var g=WebSquare.style.getScale(),v=(n-y)*g,S=document.documentElement.clientHeight-(v+this.render.offsetHeight),T=this.itemTable.render.offsetHeight*g,I=Math.max(S,v);if(I<T&&r&&r.length>0){if(!this.options.depthColumn){var x=0;for(d=0;d<r.length&&!(x+r[d].offsetHeight+2>I);d++)x+=r[d].offsetHeight;this.itemTable.rowCount=d,this.itemTable.setStyle("height",x+"px")}I!==S&&(f="up")}else S<T&&v>T&&(f="up")}if("up"==f?n-=this.itemTable.render.offsetHeight:n+=this.render.offsetHeight,this.options.depthColumn);else if(document.documentElement.clientWidth<s+this.itemTable.render.offsetWidth)(s=s+this.render.offsetWidth-this.itemTable.render.offsetWidth)<0?(s=WebSquare.style.getAbsoluteLeft(this.render),b=document.body.offsetWidth-17-s,this.itemTable.setStyle("width",b+"px"),"auto"!=this.itemTable.getStyle("overflow-x")&&(i+=20),this.itemTable.setStyle("height",i+"px"),this.itemTable.setStyle("overflow-x","auto")):this.itemTable.setStyle("overflow-x","hidden");else{b=this.itemTable.render.firstChild.offsetWidth;var w=this.itemTable.render.clientWidth;if(s+b<t&&"auto"==this.itemTable.getStyle("overflow-x")){var C=b>w?b:w;i-=20,this.itemTable.setStyle("height",i+"px"),this.itemTable.setStyle("width",C+"px"),
this.itemTable.setStyle("overflow-x","hidden")}}this.itemTableDirection=f,this.itemTable.render.style.left=s+"px",this.itemTable.render.style.top=n+"px",WebSquare.style.adjustZIndex(this.uuid,this.itemTable.uuid,"itemTable")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setSelectItemArr=function(){try{if(""!=this.options.sortOption){var e=[],t=null;"label"==this.options.sortOption?t=function(){return this.label}:"value"==this.options.sortOption&&(t=function(){return this.value});for(var i=0;i<this.itemArr.length;i++){var s=this.itemArr[i];s.toString=t,e.push(s)}e.sort(),"descending"==this.options.sortMethod&&e.reverse(),this.itemArr=e}for(i=0;i<this.itemArr.length;i++)this.itemArr[i].orgLabel=this.itemArr[i].orgLabel||this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i);if("all"==this.options.optionOrder){if(1==this.options.chooseOption){var o=this._getChooseOptionLabel();o=WebSquare.xml.decode(o).replace("&nbsp;"," "),this.itemArr=[{label:o,value:this.options.chooseOptionValue}].concat(this.itemArr)}1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr))}else if(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr)),1==this.options.chooseOption){o=this._getChooseOptionLabel();o=WebSquare.xml.decode(o).replace("&nbsp;"," "),this.itemArr=[{label:o,value:this.options.chooseOptionValue}].concat(this.itemArr)}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.toggle=function(){try{this.isOpen?this.closeSubLayer():this.openSubLayer()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.openSubLayer=function(){try{WebSquare.getBody().getLayerListener().show(this.id)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._openSubLayer=function(){try{if(this.setSubLayer(),!this.isOpen){this.itemTable.show(),this.addClass("w2selectbox_open");var e=document.getElementById(this.id+"_main_tbody");if(e&&e.setAttribute("aria-expanded","true"),this.setItemTable(),1==this.options.wmode&&WebSquare.getBody().showWModeFrame(this.getPluginName(),this.itemTable.render),r.Z.isMobile()||this.itemTable.focus(),"ul"==this.options.tableRender&&(this.itemTable.removeClass(this.itemTable.selectedCell,this.itemTable.options.w2table_col_over),this.itemTable.selectedCell=null),this.options.emptyItem?this.itemTable.setSelectedIndex(this.selectedIndex,{noChangeFunc:!0}):-1!=this.selectedIndex&&this.itemTable.setSelectedIndex(this.selectedIndex),""!=this.options.animation&&"string"==typeof this.options.animation){var t="down",i=WebSquare.style.getAbsoluteTop(this.render),s=document.body.scrollTop;s<document.documentElement.scrollTop&&(s=document.documentElement.scrollTop);var o=i-s,n=document.documentElement.clientHeight-(o+this.render.offsetHeight),a=this.itemTable.render.offsetHeight;n<a&&o>a&&(t="up"),"show"==this.options.animation.toLowerCase()?$("#"+this.itemTable.id).hide().show("fast"):"fadein"==this.options.animation.toLowerCase()?$("#"+this.itemTable.id).hide().fadeIn("slow"):"slidedown"==this.options.animation.toLowerCase()&&"down"==t&&$("#"+this.itemTable.id).hide().slideDown("fast")}this.isOpen=!0,this.options.customLabelFormatter&&(this.customLabelFormatter=r.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex)}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._openOtherLayer=function(){try{var e=this.otherComponent;if("grid"==this.itemTableMode?(this.setSubLayer(),this.setGridData(),""!==this.gridOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.grid.render.style.height),e=this.itemTable):"gridView"==this.itemTableMode&&(this.setSubLayer(),this.setGridViewData(),""!==this.gridViewOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.gridView.render.style.height),e=this.itemTable),!this.isOpen){e.setPosition(0,0),e.show(),
this.addClass("w2selectbox_open");var t=WebSquare.style.getAbsoluteLeft(this.render),i=WebSquare.style.getAbsoluteTop(this.render),s=this.options.direction;if("auto"==s){var o=document.body.scrollTop;o<document.documentElement.scrollTop&&(o=document.documentElement.scrollTop);var n=i-o,a=document.documentElement.clientHeight-(n+this.render.offsetHeight),h=e.render.offsetHeight;a<h&&n>h&&(s="up")}"up"==s?"gridView"==this.itemTableMode?i-=e.gridView.render.offsetHeight:i-=e.grid.render.offsetHeight:i+=this.render.offsetHeight,"auto"==this.options.submenuSize&&"gridView"==this.itemTableMode&&(t=WebSquare.style.getAbsoluteLeft(this.render),this.gridViewOptions.width||(e.render.style.width=this.render.offsetWidth+"px")),document.documentElement.clientWidth<t+e.render.offsetWidth&&(t=t+this.render.offsetWidth-e.render.offsetWidth),t<0&&(t=0),e.render.style.left=t+"px",e.render.style.top=i+"px",this.isOpen=!0,this.itemTableDirection=s,WebSquare.style.adjustZIndex(this.uuid,e.uuid,"itemTable"),!r.Z.isMobile()&&this.options.findItemFirstKey&&("grid"==this.itemTableMode?e.grid.render.focus():"gridView"==this.itemTableMode&&e.gridView.render.focus())}-1!=this.selectedIndex&&this.itemTable.setSelectedIndex(this.selectedIndex)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.closeSubLayer=function(e){try{var t={documentClick:e};null!=this.itemTable&&("grid"==this.itemTableMode?this.itemTable.grid.applyFocusedCellOut(this.itemTable.grid.focusedCell[0]):"gridView"==this.itemTableMode&&this.itemTable.gridView.applyFocusedCellOut(this.itemTable.gridView.focusedCell[0])),WebSquare.getBody().getLayerListener().hide(this.id,t)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._closeSubLayer=function(e){try{var t=(e=e||{}).documentClick;if(this.isOpen&&null!=this.itemTable){this.itemTable.hide(),this.removeClass("w2selectbox_open"),this.itemTable.render.setAttribute("aria-expanded","true"),1==this.options.wmode&&WebSquare.getBody().hideWModeFrame(this.getPluginName(),this.itemTable.id),this.isOpen=!1,this.options.customLabelFormatter&&(this.customLabelFormatter=r.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex),!0===t?n.f.fireEvent(this,"onclose",!0):n.f.fireEvent(this,"onclose",!1);var i=document.getElementById(this.id+"_main_tbody");i&&i.setAttribute("aria-expanded","false")}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._closeOtherLayer=function(e){try{var t=(e=e||{}).documentClick,i=this.otherComponent;"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(i=this.itemTable),this.isOpen&&null!=i&&(i.hide(),this.removeClass("w2selectbox_open"),this.isOpen=!1,!0===t?n.f.fireEvent(this,"onclose",!0):n.f.fireEvent(this,"onclose",!1))}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setVisibleRowNum=function(e){try{this.options.visibleRowNum=e,this._closeSubLayer()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setSelectedIndex=function(e,t){try{if(e=parseInt(e,10),isNaN(e))return;if(e<0||e>=this.getItemCount()){if(this.options.emptyItem)if(this.modelControl.isBinded())(1==this.options.selectedData||0!=t)&&this.modelControl.setData(this.options.emptyValue),this.setSelectedIndexNM(-1);else{var i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(-1),-1!=i&&n.f.fireEvent(this,"onchange",{oldValue:s,newValue:this.getValue()})}return}if(this.modelControl.isBinded()){var o=this.modelControl.dataCollectionRefInfo?this.modelControl.dataCollectionRefInfo.dataComp:null;1==this.options.selectedData?(this.modelControl.setData(this.itemArr[e].value),null==o||o.getBroadcast()||this.setSelectedIndexNM(e)):0!=t?this.itemArr[e].value!=WebSquare.allValue?(this.modelControl.setData(this.itemArr[e].value),1==this.options.chooseOption&&0==e?this.setSelectedIndexNM(0):null==o||o.getBroadcast()||this.setSelectedIndexNM(e)):(this.modelControl.setData(""),this.setSelectedIndexNM(e)):this.setSelectedIndexNM(-1)
}else{i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(e),i!=this.getSelectedIndex()&&n.f.fireEvent(this,"onchange",{oldValue:s,newValue:this.getValue()})}this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setSelectedIndexNM=function(e){try{return e=parseInt(e,10),isNaN(e)?!1:e<0||e>=this.getItemCount()?!!this.options.emptyItem&&(this.selectedIndex=-1,this.dom.label.innerHTML="",this.itemTable&&this.itemTable.setSelectedIndex(0),!0):(this.selectedIndex=e,this._setLabel(e),this.itemTable&&this.render.setAttribute("aria-activedescendant",this.itemTable.id+"_"+e),!0)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setAllSelectedIndex=function(e,t){try{if(!this.allItemArr[e])return this.selectedAllIndex=-1,!1;this.selectedIndex=-1,this.selectedAllIndex=e;var i=this.allItemArr[e].label+"";return this.dom.label&&(this.dom.label.innerHTML=this._getLabel(i)),t&&this.modelControl.setData(this.allItemArr[e].value),NaN}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.getSelectedIndex=function(){try{return this.selectedIndex}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.getSelectedRow=function(){try{if("gridView"==this.itemTableMode&&this.itemTable){var e=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList);if(e)return e.getRowArray(this.getSelectedIndex())}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setValue=function(e){try{var t=!0;if(r.Z.isNull(e))return!1;var i=this.getValue();if(this.modelControl.isBinded())this.modelControl.setData(e);else{i=this.getValue();var s=this.setValueNM(e);1==s?i!=this.getValue()&&n.f.fireEvent(this,"onchange",{oldValue:i,newValue:this.getValue()}):isNaN(s)||(this._setValueNotInList(e),t=!1)}return this.broadcast({linkedDataList:["refresh",["replace"]]}),t}catch(e){return l.Y.printStackTrace(e,null,this),!1}},p.prototype.setValueNM=function(e){try{if(r.Z.isNull(e))return;e=e.toString();for(var t=this.getItemCount(),i=0;i<t;i++)if(this.itemArr[i].value==e)return this.setSelectedIndexNM(i),!0;return this.setAllValue(e)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setAllValue=function(e,t){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(e){return!1}if(r.Z.isNull(e))return!1;e=e.toString();for(var i=this.allItemArr.length,s=0;s<i;s++)if(this.allItemArr[s].value==e)return this.setAllSelectedIndex(s,t);return!1}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype._setValueNotInList=function(e,t){try{if("keepValue"===this.options.valueNotInList)if(e)if(this.selectedIndex=-1,null!=this.dom.label.textContent)this.dom.label.textContent=e;else if(null!=this.dom.label.innerText)this.dom.label.innerText=e;else{var i=this._getLabel(e);this.dom.label.innerHTML=i}else this.options.emptyItem?this.setSelectedIndex(-1):this.setSelectedIndex(0);else this.options.emptyItem?this.setSelectedIndex(-1,t):this.setSelectedIndex(0,t)}catch(e){return l.Y.printStackTrace(e,null,this),!1}},p.prototype.getValue=function(){try{if(this.itemArr[this.selectedIndex])return this.itemArr[this.selectedIndex].value;var e=this.getAllValue();return!1!==e?e:this._getValueNotInList()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.getAllValue=function(e,t){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(e){return!1}return!!this.allItemArr[this.selectedAllIndex]&&this.allItemArr[this.selectedAllIndex].value}catch(e){return l.Y.printStackTrace(e,null,this),!1}},p.prototype._getValueNotInList=function(){try{
return"keepValue"===this.options.valueNotInList&&(null!=this.dom.label.textContent?this.dom.label.textContent:null!=this.dom.label.innerText?this.dom.label.innerText:this.dom.label.innerHTML)||(this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null)}catch(e){return l.Y.printStackTrace(e,null,this),null}},p.prototype.setText=function(e,t){try{var i=this.getItemCount(),s="";if(t)for(var o=0;o<i;o++)this.itemArr[o].orgLabel==e&&(s=this.itemArr[o].value);else for(o=0;o<i;o++)this.itemArr[o].label==e&&(s=this.itemArr[o].value);this.setValue(s)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.getText=function(e){try{return this.itemArr[this.selectedIndex]?e?this.itemArr[this.selectedIndex].orgLabel:this.itemArr[this.selectedIndex].label:this.options.emptyItem&&-1==this.selectedIndex?"":null}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.addItemArr=function(e,t,i){try{!0===i||!1===i?this.itemArr.push({label:e,value:t,_hidden:i}):this.itemArr.push({label:e,value:t})}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.addItem=function(e,t,i,s){try{if(i=parseInt(i,10),(isNaN(i)||i<0||i>=this.getItemCount())&&(i=this.getItemCount()),null==s&&(s=this.options.dataListAutoRefresh),this.itemsetObj.nodeset.match("data:")&&s){var o=this.modelControl.getDataComp();if(o&&WebSquare.idCache[o.uuid]){var n={};n[this.itemsetObj.value]=e,n[this.itemsetObj.label]=t,this.stopRefresh(!0),o.insertJSON(i,[n]),this.stopRefresh(!1)}}var r={};return r.value=e,r.label=t,this.itemArr.splice(i,0,r),"0"!=this.options.displayMode&&(this.itemArr[i].orgLabel=this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i)),this.options.emptyItem&&-1==this.selectedIndex&&this.setSelectedIndex(0),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),i}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.deleteItem=function(e,t){try{if(e=parseInt(e,10),isNaN(e))return;if(null==t&&(t=this.options.dataListAutoRefresh),this.itemsetObj.nodeset.match("data:")&&t){var i=this.modelControl.getDataComp();if(i&&WebSquare.idCache[i.uuid]){var s=0;this.options.chooseOption&&s++,this.options.allOption&&s++,this.stopRefresh(!0),i.removeRow(e-s),this.stopRefresh(!1)}}var o=null;return e>=0&&e<this.getItemCount()&&(o=this.itemArr.splice(e,1)[0]),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),this.options.emptyItem&&(-1!=this.selectedIndex&&e!=this.selectedIndex||this.setSelectedIndex(0)),this.options.emptyItem&&"native"==this.options.renderType?this.selectedIndex>e&&e>=0?this.setSelectedIndex(this.selectedIndex-1):this.setSelectedIndex(this.selectedIndex):this.selectedIndex>e&&e>=0&&this.setSelectedIndex(this.selectedIndex-1),o}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.removeAll=function(e){try{var t=this.getValue();if(this.itemArr=new Array,e&&(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr)),1==this.options.chooseOption)){var i=this._getChooseOptionLabel();i=WebSquare.xml.decode(i).replace("&nbsp;"," "),this.itemArr=[{label:i,value:this.options.chooseOptionValue}].concat(this.itemArr)}if(this.setSelectOptions(this.itemArr),this.dom.label)if(this.itemArr.length>0){i=this._getLabel(this.itemArr[0].label+"");this.dom.label.innerHTML=i}else this.dom.label.innerHTML="";if(this.options.setDataRemoveAll&&(e?this.setSelectedIndex(0):(this.selectedIndex=-1,!this.dom.label&&this.dom.select&&(this.dom.select.selectedIndex=-1),this.modelControl.isBinded()&&this.modelControl.setData(""),t!=this.getValue()&&n.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()}))),"grid"==this.itemTableMode)this.gridItemArr=[],
this.itemTable&&this.itemTable.grid.removeAll();else if("gridView"==this.itemTableMode){if(this.gridViewItemArr=[],this.itemTable)this.modelControl.getDataComp(this.itemTable.gridView.options.dataList).removeAll()}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.onPropertyChange=function(e,t){try{switch(e){case"disabled":"component"==this.options.renderType?t&&this.closeSubLayer():t?this.dom.select&&this.dom.select.setAttribute("disabled","disabled"):this.dom.select&&this.dom.select.removeAttribute("disabled");var i=this.dom.button;1==t?(this.addClass(this.render,this.options.disabledClass),null!=i&&this.addClass(i,"w2selectbox_button_disabled")):(this.removeClass(this.render,this.options.disabledClass),null!=i&&this.removeClass(i,"w2selectbox_button_disabled"));break;case"mandatory":1==t?this.addClass(this.render,"w2selectbox_mandatory"):this.removeClass(this.render,"w2selectbox_mandatory")}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setSelectedIndex1=function(e,t){try{void 0!==t&&null!=t||(t={});var i=this.selectedIndex,s=this.getValue();if(this.setSelectedIndex(e),i!=this.selectedIndex){var o={oldValue:s,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex};n.f.fireEvent(this,"onviewchange",o)}!0!==t.skipClose&&this.closeSubLayer()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.validate=function(){try{var e=this.validator.validate(this.getValue());return e||this.focus(),e}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.validateObject=function(){try{var e=this.validator.validate(this.getValue()),t={};return e||(this.focus(),this.validator&&this.validator.obfuscator_invalidObject&&(t.callerId=this.validator.obfuscator_invalidObject.callerId,t.type=this.validator.obfuscator_invalidObject.getType(),t.value=this.validator.obfuscator_invalidObject.getValue())),t}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setInitValue=function(e){try{var t=this.getValue();""===this.options.initValue&&this.itemArr&&this.itemArr[0]&&(this.options.initValue=this.itemArr[0].value),this.setValueNM(this.options.initValue),this.modelControl.setData(this.options.initValue),e.fireEvent&&t!=this.getValue()&&n.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()})}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.hide=function(){try{this.closeSubLayer(),a.q.prototype.hide.call(this)}catch(e){l.Y.printStackTrace(e)}},p.prototype.showTooltip=function(e,t,i){try{if(!i)return;null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var s="";this.options.itemTooltipDisplay&&(s="position:absolute;z-index:10000;");var a=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var h=o.I.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(h){var d=r.Z.getGlobalFunction(h,a.scope_id),p=!0;if("function"==typeof d&&(p=d(a)),!p)return}}catch(e){l.Y.printStackTrace(e)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2selectbox_tooltip "+this.options.tooltipClass,style:s}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i,this.isFireTooltipEvent||(this.isFireTooltipEvent=!0,n.f.fireEvent(this,"ontooltipshow"))})),1e3*this.options.tooltipTime)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&(this.tooltip.setStyle("display","none"),n.f.fireEvent(this,"ontooltiphide"),this.isFireTooltipEvent=!1)
})),1e3*this.options.tooltipTime)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleClickEvent=function(e){try{if(this.options.disabled)return!1;r.Z.isMobile()||this.focus(),this.itemArr.length>0?this.toggle():1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll()}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleKeydownEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode,i=this.getSelectedIndex();if(!0===this._preventKeyObj[t]||!0===this._preventKeyObj.all)return;if(13==t&&this.options.keyMoveSync)return void this.handleClickEvent(e);if(this.options.customToggleKey==t)return void this.toggle();if(this.isOpen)return;if(!this.options.keyMoveSync||38!=t&&40!=t&&33!=t&&34!=t&&35!=t&&36!=t)return 9==t?(this.tabOrderMoveStart=!1,void(e.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,n.f.preventDefault(e)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,n.f.preventDefault(e)))):(this.findItemStartedWithKeyChar(e,t),void(this.options.findItem&&this._keyBuffer&&(r.Z.clearTimeout(this.id+"_selectKeyBuffer"),r.Z.setTimeout((function(){this._keyBuffer=""}),{key:this.id+"_selectKeyBuffer",caller:this,delay:this.options.keyBufferResetTime}))));if(this._oldIndex=this.selectedIndex,this._oldValue=this.getValue(),38==t)i>0&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(i-1),this.targetFocusedIndex=i-1):this.setSelectedIndex1(i-1));else if(40==t)"grid"==this.itemTableMode||"gridView"==this.itemTableMode?i+1<this.getItemCount()&&(this.setSelectedIndex1(i+1),this.targetFocusedIndex=i+1):i+1<this.getItemCount()&&this.setSelectedIndex1(i+1);else if(33==t){if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(s=i-this.options.visibleRowNum)<0&&(s=0),this.setSelectedIndex1(s),this.targetFocusedIndex=s;else(s=i-this.options.visibleRowNum)<0&&(s=0),this.setSelectedIndex1(s)}else if(34==t){var s;if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(s=i+this.options.visibleRowNum)>=this.getItemCount()&&(s=this.getItemCount()-1),this.setSelectedIndex1(s),this.targetFocusedIndex=s;else(s=i+this.options.visibleRowNum)>=this.getItemCount()&&(s=this.getItemCount()-1),this.setSelectedIndex1(s)}else 35==t?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(this.getItemCount()-1),this.targetFocusedIndex=this.getItemCount()-1):this.setSelectedIndex1(this.getItemCount()-1):36==t&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(0),this.targetFocusedIndex=0):this.setSelectedIndex1(0));if(this._oldIndex!=this.selectedIndex){var o={oldValue:this._oldValue,newValue:this.getValue(),oldSelectedIndex:this._oldIndex,newSelectedIndex:this.selectedIndex};n.f.fireEvent(this,"onselected",o)}n.f.stopEvent(e)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleKeyupEvent=function(e){try{var t,i=e.charCode?e.charCode:e.keyCode;if(!0===this._preventKeyObj[i]||!0===this._preventKeyObj.all)return;if(!this.options.keyMoveSync&&this.modelControl.isBinded()){var s=this.getSelectedIndex();if(13==i){for(var o=this.modelControl.getData(),a=-1,h=0;h<this.itemArr.length;h++)if(this.itemArr[h].value==o){a=h;break}var d={oldValue:o,newValue:this.getValue(),oldSelectedIndex:a,newSelectedIndex:s};this.setSelectedIndex(this.getSelectedIndex()),n.f.fireEvent(this,"onselected",d)}else if(38==i||40==i||33==i||34==i||35==i||36==i)if(this._onSelected=!1,this._oldIndex=this.selectedIndex,this._oldValue=this.getValue(),38==i)s>0&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(s-1),this.targetFocusedIndex=s-1):this.setSelectedIndexNM(s-1));else if(40==i)"grid"==this.itemTableMode||"gridView"==this.itemTableMode?s+1<this.getItemCount()&&(this.setSelectedIndexNM(s+1),
this.targetFocusedIndex=s+1):s+1<this.getItemCount()&&this.setSelectedIndexNM(s+1);else if(33==i){if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(p=s-this.options.visibleRowNum)<0&&(p=0),this.setSelectedIndexNM(p),this.targetFocusedIndex=p;else(p=s-this.options.visibleRowNum)<0&&(p=0),this.setSelectedIndexNM(p)}else if(34==i){var p;if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(p=s+this.options.visibleRowNum)>=this.getItemCount()&&(p=this.getItemCount()-1),this.setSelectedIndexNM(p),this.targetFocusedIndex=p;else(p=s+this.options.visibleRowNum)>=this.getItemCount()&&(p=this.getItemCount()-1),this.setSelectedIndexNM(p)}else 35==i?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(this.getItemCount()-1),this.targetFocusedIndex=this.getItemCount()-1):this.setSelectedIndexNM(this.getItemCount()-1):36==i&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(0),this.targetFocusedIndex=0):this.setSelectedIndexNM(0))}if(9==i||13==i&&this.options.nextTabByEnter)if(null!=WebSquare.tabOrder[this.id])if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(t=r.Z.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus(e))}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(t=r.Z.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus(e))}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleMousewheelEvent=function(e){try{if(this.options.preventWheelEvent)return;n.f.stopEvent(e);for(var t=this.event.getTargetIterator(e,this.render);t.next();)if(t.match("w2selectbox_focus")&&!this.isOpen){var i=this.getSelectedIndex();e.wheelDelta>0||e.detail<0?this.setSelectedIndex1(i-1):this.setSelectedIndex1(i+1)}t=null}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleFocusEvent=function(e){try{n.f.stopEvent(e),this.addClass(this.dom.tbody,"w2selectbox_focus"),this.addClass("w2selectbox_body_focus")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleBlurEvent=function(e){try{n.f.stopEvent(e),this.removeClass(this.dom.tbody,"w2selectbox_focus"),this.removeClass("w2selectbox_body_focus"),this.itemTable&&this.itemTable.itemTableFocus||n.f.fireEvent(this,"onblur",e)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleMouseoverEvent=function(e){try{if(n.f.stopEvent(e),this.addClass(this.dom.tbody,"w2selectbox_over"),this.addClass("w2selectbox_body_over"),!this.isOpen){for(var t=this.event.getTargetIterator(e,this.render);t.next();)if(t.match("w2selectbox")&&(1==this.options.tooltipDisplay||1==this.options.tooltipShowAlways)){var i=t.getElement(),s=this.options.depthColumn?"w2selectbox_ul_label":"w2selectbox_label",o=i.getElementsByClassName(s)[0],r=WebSquare.style.getStyle(o,"text-overflow"),a=this.dom.label.innerHTML;if(!0===this.options.tooltipShowAlways){var h=WebSquare.style.getAbsoluteLeft(i)+20,d=WebSquare.style.getAbsoluteTop(i)+this.render.offsetHeight+3;this.showTooltip(h,d,a)}else if("ellipsis"==r){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),document.body.appendChild(this.toolTipRuler),this.toolTipRuler.className=o.className,this.toolTipRuler.innerHTML=o.innerText,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(o,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(o,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(o,"font-weight");var p=this.toolTipRuler.offsetWidth,c=o.clientWidth;if(3!=o.nodeType){var u=WebSquare.style.getStyle(this.toolTipRuler,"padding-left"),m=WebSquare.style.getStyle(this.toolTipRuler,"padding-right");p-=parseInt(u||"0",10),p-=parseInt(m||"0",10),c-=parseInt(WebSquare.style.getStyle(o,"padding-left"),10),c-=parseInt(WebSquare.style.getStyle(o,"padding-right"),10),
c-=parseInt(WebSquare.style.getStyle(i,"padding-left"),10),c-=parseInt(WebSquare.style.getStyle(i,"padding-right"),10)}if(c<p){h=WebSquare.style.getAbsoluteLeft(i)+20,d=WebSquare.style.getAbsoluteTop(i)+this.render.offsetHeight+3;document.body.removeChild(this.toolTipRuler),this.options.tooltipItemLabel&&(a=this.options.tooltipItemLabel),this.showTooltip(h,d,a)}}}t=null}}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleMouseoutEvent=function(e){try{n.f.stopEvent(e),1!=this.options.tooltipDisplay&&1!=this.options.tooltipShowAlways||this.hideTooltip(),this.removeClass(this.dom.tbody,"w2selectbox_over"),this.removeClass("w2selectbox_body_over")}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.handleMouseleaveEvent=function(e){try{var t=this.render.offsetHeight-1,i=this.render.offsetWidth-1,s=this.getAbsolutePosition("top"),o=this.getAbsolutePosition("left");this.isOpen&&("up"==this.itemTableDirection?(e.clientX<o||e.clientX>o+i||e.clientY>s||e.clinetY>s+t)&&this.closeSubLayer():(e.clientX<o||e.clientX>o+i||e.clientY<s||e.clinetY>s+t)&&this.closeSubLayer())}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.findItemStartedWithKeyChar=function(e,t){try{var i=this.keyCharHash[t],s=-1;if(i){var o=this.korCharHash[t],n=this.korCharHash2[t],a=this.selectedIndex;this.options.findItem?(this._keyBuffer+=i,a=0):(this._keyBuffer=i,a++);for(var h=1;;)if(a%=this.itemArr.length,!0!==this.itemArr[a]._hidden){var d=this.itemArr[a].label.toLowerCase();if(0!=a||!0!==this.options.chooseOption&&!0!==this.options.allOption)if(0!=a&&1!=a||!0!==this.options.chooseOption||!0!==this.options.allOption){var p=!1;o&&!e.shiftKey?p=this.myhelper.startWith(d,o):n&&e.shiftKey&&(p=this.myhelper.startWith(d,n));var c=this.options.findItem?this._keyBuffer:i;if(d.startsWith(c)||p&&r.Z.getBoolean(this.options.findItemKor)){s=a;break}if(d.startsWith(c)){this._keyBuffer="",s=a;break}if(h>this.itemArr.length)break;a++,h++}else{if(this.itemArr.length<=2)break;a++}else{if(this.itemArr.length<=1)break;a++}}else a++;if(s>-1)return this.setSelectedIndex1(s),!0}if(-1==s)return this._keyBuffer="",!1}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.setRef=function(e){try{"string"==typeof e&&e.length>0&&(this.modelControl.isBinded()||(this.modelControl.useRef=!0),this.options.ref=e,this.modelControl.setRef(e),this.refresh())}catch(e){l.Y.printStackTrace(e)}},p.prototype.unbindRef=function(){try{this.modelControl.isBinded()&&(this.options.ref="",this.modelControl.unbindRef(),this.refresh())}catch(e){l.Y.printStackTrace(e)}},p.prototype._setLabel=function(e,t){try{if(!this.dom.label||e<0||e>=this.getItemCount())return;var i=t&&t.skipCustomFormatter;if(e<0||e>=this.getItemCount())return;var s=this.itemArr[e].label+"";if(this.options.customLabelFormatter&&!0!==i&&(this.customLabelFormatter=r.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter){var o=this.itemArr[e].value+"",n=this.itemArr[e].orgLabel+"";(0!=e||!0!==this.options.chooseOption&&!0!==this.options.allOption)&&(0!=e&&1!=e||!0!==this.options.chooseOption||!0!==this.options.allOption)&&(s=this.customLabelFormatter.call(this,n,o,this.isOpen))}else{if(this.options.depthColumn&&this.options.depthColumnShowPath){for(var a=[s],h=this.itemArr[e]._depth,d=e-1;d>=0;d--){var p=this.itemArr[d]._depth;if(p<h&&(a.unshift(this.itemArr[d].label),(h=p)<=1))break}s=a.join(this.options.depthColumnPathDelimiter)}s=this._getLabel(s)}this.dom.label.innerHTML=s}catch(e){l.Y.printStackTrace(e)}},p.prototype._getLabel=function(e){try{var t=e;return r.Z.isIE()&&parseInt(o.I.browserVersion(),10)<10?(e.indexOf("&")>-1&&(e=e.wq_replaceAll("&","&amp;")),e=this.options.escape?WebSquare.xml._encode(e):e.wq_replaceAll("&amp;nbsp;","&nbsp;").wq_replaceAll("&amp;nbsp","&nbsp;")):this.options.escape&&(e=WebSquare.xml._encode(e)),t}catch(e){l.Y.printStackTrace(e)}},p.prototype.setDisplayMode=function(e){try{
if("label"==e||"value"==e||"value delim label"==e||"label delim value"==e){var t=this.options.displayMode;this.options.displayMode=e,this._initDisplayMode(),t!=this.options.displayMode&&this._refreshItemTable()}}catch(e){l.Y.printStackTrace(e)}},p.prototype.setDelimiter=function(e){try{this.options.delimiter!=e&&(this.options.delimiter=e||"\t","0"!=this.options.displayMode&&"3"!=this.options.displayMode&&this._refreshItemTable())}catch(e){l.Y.printStackTrace(e)}},p.prototype._refreshItemTable=function(){try{if(this.isOpen&&this.closeSubLayer(),this.setSelectItemArr(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode)if(this.itemTable)this.itemTable.setItemArr(this.itemArr);else if("native"===this.options.renderType){var e=this.getSelectedIndex();this.componentRedraw(),this.setSelectedIndexNM(e)}this._setLabel(this.getSelectedIndex())}catch(e){l.Y.printStackTrace(e)}},p.prototype._getChooseOptionLabel=function(e){try{var t;if("$blank"===this.options.chooseOptionLabel)t="";else if(t=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef){var i=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef);i&&(t=i)}return t}catch(e){l.Y.printStackTrace(e)}},p.prototype.stopRefresh=function(e){try{this.refreshStop=r.Z.getBoolean(e)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.stopRefreshItemTable=function(e){try{this.refreshStopItemTable=r.Z.getBoolean(e)}catch(e){l.Y.printStackTrace(e,null,this)}},p.prototype.focus=function(){"ul"==this.options.tableRender?this.dom.tbody.focus():this.render.focus()},p.prototype.setDisabled=function(e){try{e=r.Z.getBoolean(e),this.options.disabled=e,this.setProperty("disabled",e),!0===e?this.render.removeAttribute("tabIndex"):this.render.setAttribute("tabIndex",this.options.tabIndex||0)}catch(e){l.Y.printStackTrace(e)}return e},p.prototype.serialize=function(){return{selectedIndex:this.getSelectedIndex()}},p.prototype.restore=function(e){this.setSelectedIndex(e.selectedIndex)};var c=function(e,t,i){a.q.call(this,e,t,i)};s.q.extend(c.prototype,p.prototype),c.prototype.defaultOptions={pluginType:"uiplugin.selectbox",pluginName:"selectbox",renderType:"native",userEvents:["onchange","onclose","onviewchange","onfocus"],useConfig:!0,value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",displayMode:"0",delimiter:"\t",textAlign:"",useLocale:!1,disabledClass:"w2selectbox_disabled",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",dataListAutoRefresh:!1,refreshSelectedIndex:!1,title:"",emptyItem:!1,emptyValue:"",emptyIndex:0,findItem:!1,initStyle:!1},c.prototype.initialize=function(e){try{this._initializeCommon(e&&"$blank"==e.getAttribute("chooseOptionLabel")),this.initializeItemArr(e)}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.finalize=function(){a.q.prototype.finalize.call(this)},c.prototype.toHTML=function(){try{var e=[],t=this.options.style?"style='"+this.options.style+"'":"",i=this.options.title?"title='"+this.options.title+"'":"";if("select"==this.options.renderType){var s=this.options.textAlign?"style='text-align:"+this.options.textAlign+";"+this.options.style+"'":t;e.push("<select id='"+this.id+"' "+s+" class='w2selectbox_select "+this.options.className+"' "+i+">");for(var o=0;o<this.itemArr.length;o++)e.push("<option>"+this.itemArr[o].label+"</option>");e.push("</select>")}else{var n=this.options.textAlign?"style='text-align:"+this.options.textAlign+"'":"";e.push("<div id='"+this.id+"' "+t+" class='w2selectbox_native "+(r.Z.isMobile()?"w2selectbox_native_mobile ":"")+(this.options.labelWidthAuto?"":"fixedWidth ")+this.options.className+"'>"),e.push("<div class='w2selectbox_native_innerDiv'>"),e.push("<select class='w2selectbox_native_select' id='"+this.id+"_input_0' "+i+n+">")
;for(o=0;o<this.itemArr.length;o++)e.push("<option>"+this.itemArr[o].label+"</option>");e.push("</select>"),e.push("</div>"),e.push("</div>")}return e.join("")}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.setPreAction=function(){try{if(this.dom.select="select"==this.options.renderType?this.render:this.render.firstChild.firstChild,!(r.Z.isIE(6)||r.Z.isIE(7))&&"native"==this.options.renderType){var e=this.render.clientHeight-this.dom.select.offsetHeight;e>0&&(this.dom.select.style.marginTop=parseInt(e/2,10)+"px")}!0===this.options.labelWidthAuto&&(this.render.style.width=""),this.modelControl.isItemsetBinded()&&(this._refreshItemArr(),this.componentRedraw())}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var e=document.getElementById(this.id).style.cssText,t=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:e,className:t}}if(this.modelControl.isBinded()){var i=this.modelControl.getData();this.setValueNM(i)}if(-1==this.selectedIndex&&this.getItemCount()>0&&(0==this.options.emptyIndex||!this.options.emptyIndex))if(this.modelControl.isBinded()){i=this.getValue();if(this.options.emptyRef){for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value==i){this.setSelectedIndexNM(0),this.modelControl.setData(i);break}}else this.setSelectedIndexNM(0),this.modelControl.setData(i)}else this.setSelectedIndexNM(0),this.broadcast({linkedDataList:["refresh",["replace"]]});else if(this.getItemCount()>0&&this.modelControl.isBinded()&&(0==this.options.emptyIndex||!this.options.emptyIndex)){i=this.getValue();this.modelControl.getData()!==i&&this.modelControl.setData(i)}else this.options.emptyIndex&&"number"==typeof this.options.emptyIndex&&(this.modelControl.isBinded()?(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(this.options.emptyIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})));this.options.mandatory&&this.onPropertyChange("mandatory",r.Z.getBoolean(this.options.mandatory)),this.event.addListener2(this.dom.select,"onchange",this.event.bindAsEventListener(this,this.handleOnchange)),this.event.addListener(this.dom.select,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.dom.select,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),this.event.addListener(this.dom.select,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener(this.dom.select,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyupEvent))}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.componentRedraw=function(e,t,i){try{if(this.refreshStop)return;this.showRowIndex=0;var s=0;if(this.options.refreshSelectedIndex&&"setCellData"===i&&(s=this.getSelectedIndex()),this.setSelectOptions(),this.itemArr.length>0){if(this.options.refreshSelectedIndex&&"setCellData"===i)return void this.setSelectedIndexNM(s);if(t||"insertRow"===i){var o=0;return"insertRow"!==i&&"replace"!=t&&this.getSelectedIndex()>-1&&(o=this.getSelectedIndex()),this.dom.select.selectedIndex=o,void(this.selectedIndex=o)}this.dom.select.selectedIndex=0,this.selectedIndex=0}this.setValueNM("")}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.refreshVisible=function(){try{for(var e=0;e<this.itemArr.length;e++)!0===this.itemArr[e]._hidden&&this.dom.select?this.dom.select.options[e].style.display="none":this.dom.select.options[e].style.display=""}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.refreshEnable=function(){try{for(var e=0;e<this.itemArr.length;e++)!0===this.itemArr[e]._disabled&&this.dom.select?this.dom.select.options[e].setAttribute("disabled",""):this.dom.select.options[e].removeAttribute("disabled")}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.setSelectOptions=function(){try{
for(var e=this.dom.select.options.length;e>=0;e--)this.dom.select.remove(e);for(e=0;e<this.itemArr.length;e++){var t=document.createElement("option");t.text=this.itemArr[e].label,this.dom.select.options[e]=t,!0===this.itemArr[e]._hidden&&(this.dom.select.options[e].style.display="none"),!0===this.itemArr[e]._disabled&&this.dom.select.options[e].setAttribute("disabled","")}}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.setSelectedIndexNM=function(e){try{return e=parseInt(e),!this.options.emptyItem&&(isNaN(e)||e<0||e>=this.getItemCount())?!1:(this.selectedIndex=e,this.dom.select&&(this.dom.select.selectedIndex=e),this.broadcast({linkedDataList:["refresh",["replace"]]}),!0)}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.handleOnchange=function(e){var t=this.dom.select.selectedIndex,i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(t),this.options.emptyItem&&-1==t?this.modelControl.setData(this.options.emptyValue):this.modelControl.setData(this.itemArr[t].value);var o=this.getValue();if(this.selectedIndex=t,i!=this.getSelectedIndex()){n.f.fireEvent(this,"onchange",{oldValue:s,newValue:o});var l={oldValue:s,newValue:o,oldSelectedIndex:i,newSelectedIndex:this.selectedIndex};n.f.fireEvent(this,"onviewchange",l)}},c.prototype.handleKeydownEvent=function(e){try{if(9==(e.charCode?e.charCode:e.keyCode))return this.tabOrderMoveStart=!1,void(e.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,n.f.preventDefault(e)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,n.f.preventDefault(e)))}catch(e){l.Y.printStackTrace(e)}},c.prototype.handleKeyupEvent=function(e){try{var t;if(9==(e.charCode?e.charCode:e.keyCode))if(null!=WebSquare.tabOrder[this.id])if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(t=r.Z.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus(e))}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(t=r.Z.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus(e))}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.handleBlurEvent=function(e){try{n.f.fireEvent(this,"onblur")}catch(e){l.Y.printStackTrace(e,null,this)}},c.prototype.handleFocusEvent=function(e){n.f.fireEvent(this,"onfocus")},c.prototype.focus=function(){this.dom.select.focus()},c.prototype.setDisabled=function(e){try{e=r.Z.getBoolean(e),this.options.disabled=e,this.onPropertyChange("disabled",e)}catch(e){l.Y.printStackTrace(e)}return e},c.prototype._getValueNotInList=function(){try{return this.options.valueNotInList,this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null}catch(e){return l.Y.printStackTrace(e,null,this),null}},c.prototype._setValueNotInList=function(e,t){try{this.options.valueNotInList,this.options.emptyItem?this.setSelectedIndex(-1,t):this.setSelectedIndex(0,t)}catch(e){return l.Y.printStackTrace(e,null,this),!1}}}}]);