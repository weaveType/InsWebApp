"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[1105],{1105:(t,e,i)=>{i.r(e),i.d(e,{mapchart:()=>c});var a=i(1570),o=i(866),r=i(2847),s=i(6323),n=i(2725),l=i(3885),c=function(t,e,i){l.q.call(this,t,e,i)};c.prototype.initAsync=async function(){c.isImported||(await inquires("externalJS/mapchart/d3.min.js"),await inquires("externalJS/mapchart/topojson.min.js"),await inquires("externalJS/mapchart/textures.min.js"),c.isImported=!0)},a.q.extend(c.prototype,l.q.prototype),c.prototype.defaultOptions={pluginType:"uiplugin.mapchart",pluginName:"mapchart",useConfig:!0,userEvents:["onbeforemapchange","onaftermapchange","onmapmouseover","onmapmouseout","onmapclick","onmapdblclick","onmapmousemove","onmapdatachange"],dataMapPath:"",dataMapRatio_level0:"simp1",dataMapRatio_level1:"simp1",dataMapRatio_level2:"simp1",startMap:"0",dataLists:"",zoomMin:"0.2",zoomMax:"5",maxDepth:-1,usePattern:!0,useMarker:!1,markerPositionX:0,markerPositionY:0,markerImage:"",contextFormatter:"",markerDefiner:"",markerClassDefiner:"",showMunicipalityLabel:!0,setTooltipStrFunc:"",event_drillup:"oncontextmenu",event_drilldown:"onclick",event_select:"onmouseover",event_deselect:"onmouseout",event_tooltipon:"onmouseover",event_tooltipoff:"onmouseout",event_zoom:"onzoom",event_drag:"ondrag",accessibility:!1,calloutOverlappedLabel:!1,calloutLabelExceptionHandler:"",calloutLineClass:"",calloutCircleClass:"",hideOverlappedLabel:!1,hideLabelExceptionHandler:"",styleDefiner:""},c.prototype.initialize=function(t){try{if(!this.options.dataMapPath){var e=location.pathname.lastIndexOf("/");this.options.dataMapPath=e>=0?location.pathname.slice(0,e)+"/_websquare_/externalJS/mapchart":"/_websquare_/externalJS/mapchart"}this.currentMap="",this._dataListsObj={},this._load=!1,this.patternList=[],this._colorScales={}}catch(t){o.Y.printStackTrace(t)}},c.prototype.toHTML=function(){try{var t=[],e=""==this.options.style?"":"style='"+this.options.style+"'";return t.push("<div id='"+this.id+"' "+e+" class='w2mapchart "+this.options.className+"'>"),t.push("<div id='"+this.id+"_tooltip' class='w2mapchart_tooltip' style='position:absolute;border:1px solid black;display:none;z-index:10;'></div>"),t.push("<div id='"+this.id+"_marker_tooltip' class='' style='position:absolute;display:none;z-index:10;'></div>"),1==this.options.accessibility&&(t.push("<div id='"+this.id+"_accessibilityZone' class='w2mapchart_accessibility'>"),t.push("<select id='"+this.id+"_level1' class='w2mapchart_accessibility_select'><option value='LEVEL1'>LEVEL1</options></select>"),t.push("<select id='"+this.id+"_level2' class='w2mapchart_accessibility_select'><option value='LEVEL2'>LEVEL2</options></select>"),t.push("<select id='"+this.id+"_level3' class='w2mapchart_accessibility_select'><option value='LEVEL3'>LEVEL3</options></select>"),t.push("</div>")),t.push("</div>"),t.join("")}catch(t){o.Y.printStackTrace(t)}},c.prototype.setAction=function(){try{l.q.addCheckResize(this.uuid,"checkResize"),this.render&&this.render.clientWidth>0&&this.render.clientHeight>0&&(this._marker_tooltip=this.getElementById(this.id+"_marker_tooltip"),this._tooltip=this.getElementById(this.id+"_tooltip"),this.createMap({width:this.render.clientWidth,height:this.render.clientHeight,topoFile:this.getDataMapPath(this.options.startMap),topoObj:this.options.startMap})),this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,(function(t){this._marker_tooltip.style.display="none"})))}catch(t){o.Y.printStackTrace(t)}},c.prototype.refreshItemset=function(){},c.prototype.finalize=function(){},c.prototype.createMap=function(t){try{var e=this;this.currentMap=t.topoObj
;var i=d3.select("#"+this.id).append("svg").attr("width",t.width).attr("height",t.height).attr("id",this.id+"_svg").style("overflow","hidden"),l=i.append("g").attr("class","w2mapchart_map").attr("id",this.id+"_map"),c=i.append("g").attr("class","w2mapchart_places").attr("id",this.id+"_places"),p=this.id,h=this.uuid,d=t.width,u=t.height,f=parseFloat(this.options.zoomMin),v=parseFloat(this.options.zoomMax),m=this.render.offsetTop+this.render.clientTop,y=this.render.offsetLeft+this.render.clientLeft,_=m+this.render.clientHeight,g=y+this.render.clientWidth,k=this.options.event_drillup.replace(/^on/,""),D=this.options.event_drilldown.replace(/^on/,""),B=this.options.event_select.replace(/^on/,""),b=this.options.event_deselect.replace(/^on/,""),S=this.options.event_tooltipon.replace(/^on/,""),M=this.options.event_tooltipoff.replace(/^on/,""),x=this.options.event_drag.replace(/^on/,""),z=this.options.event_zoom.replace(/^on/,""),W=this.patternList,E=null,L=null,w=null,C=null,q=null;this.options.setTooltipStrFunc&&(E=s.Z.getGlobalFunction(this.options.setTooltipStrFunc,this.scope_id)),this.options.contextFormatter&&(L=s.Z.getGlobalFunction(this.options.contextFormatter,this.scope_id)),this.options.markerDefiner&&(w=s.Z.getGlobalFunction(this.options.markerDefiner,this.scope_id)),this.options.markerClassDefiner&&(C=s.Z.getGlobalFunction(this.options.markerClassDefiner,this.scope_id)),this.options.styleDefiner&&(q=s.Z.getGlobalFunction(this.options.styleDefiner,this.scope_id))&&"function"==typeof q&&(this._styleData=q());var O=this.options.markerImage||"m0.99,-32a10.982,10.982 0 0 0 -10.99,10.99c0,8.242 10.99,20.41 10.99,20.41s10.99,-12.168 10.99,-20.41a10.982,10.982 0 0 0 -10.99,-10.99zm0,14.915a3.925,3.925 0 1 1 3.925,-3.925a3.926,3.926 0 0 1 -3.925,3.925z";d3.json(t.topoFile,(function(o,q){e._mapData=q;var T=d/q.transform.scale[0],A=u/q.transform.scale[1]*.8,P=Math.min(T,A)/180,Y=Math.min(1.25*T*q.transform.scale[1],u),j=Math.min(Math.min(T,A)*q.transform.scale[0],d),F=Y+(u-Y)/2-u/100,H=(d-j)/2+d/100,R=d3.geo.mercator().center(q.transform.translate).scale(P).translate([H,F]);if(i.on(k+".drillup",(function(){d3.event.preventDefault(),WebSquare.idCache[h].drillup()})),parseFloat(f)==parseFloat(v)||"none"===z){if("none"!==x){var I=d3.behavior.drag().on(x+".drag",(function(t,i){var a=d3.transform(l.attr("transform")),o=d3.transform(c.attr("transform")),r=[a.translate[0]+d3.event.dx,a.translate[1]+d3.event.dy].toString(),s=[o.translate[0]+d3.event.dx,o.translate[1]+d3.event.dy].toString(),n=[a.scale[0],a.scale[1]].toString(),p=[o.scale[0],o.scale[1]].toString();l.attr("transform",(function(){return"translate("+r+")scale("+n+")"})),c.attr("transform",(function(){return"translate("+s+")scale("+p+")"})),e._tooltip.style.display="none",e._marker_tooltip.style.display="none"}));i.call(I)}}else if("none"===x){(Z=d3.behavior.zoom()).scaleExtent([f,v]),Z.on(z+".zoom",(function(){l.attr("transform","scale("+d3.event.scale+")"),c.attr("transform","scale("+d3.event.scale+")"),e._tooltip.style.display="none",e._marker_tooltip.style.display="none"})),i.call(Z),i.call(Z.event)}else{var Z;(Z=d3.behavior.zoom()).scaleExtent([f,v]),Z.on(z+".zoom",(function(){l.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),c.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),e._tooltip.style.display="none",e._marker_tooltip.style.display="none"}));I=d3.behavior.drag().on(x+".drag",(function(t,i){e._tooltip.style.display="none",e._marker_tooltip.style.display="none"}));i.call(I),i.call(Z),i.call(Z.event)}var G=d3.geo.path().projection(R),V=topojson.feature(q,q.objects[t.topoObj]).features;if(0!=W.length)for(var J in W)i.call(W[J]);var N=l.selectAll("path").data(V).enter().append("path").attr("class",(function(t){var i="municipality c"+t.properties.code,a=e._getMatchedStyleData(t.properties.code);return a&&a.class&&(i+=" "+a.class),i})).attr("d",G);if(0!=W.length&&N.style("fill",(function(t,e){
return W[e%W.length].url()})),"none"!==S&&N.on(S+".tooltipon",(function(t){var i="";i+='<div class="kv">',i+='<span class="key">';var a=t.properties.name,o=e._getMatchedStyleData(t.properties.code);if(o&&o.label&&(a=o.label),"function"==typeof E){var r=E(a,t.properties.code);i+=null!=r?r:a+"("+t.properties.code+")"}else i+=a+"("+t.properties.code+")";i+="</span>",i+="</div>",d3.select("#"+p+"_tooltip").html(i).style("display","block").style("pointer-events","none");var s,n,c=G.centroid(t),h=d3.transform(l.attr("transform"));"31"==t.properties.code||"23"==t.properties.code?(s=(1.1*c[1]+10)*h.scale[1]+h.translate[1],n=(1.1*c[0]+10)*h.scale[0]+h.translate[0]):(s=(c[1]+10)*h.scale[1]+h.translate[1],n=(c[0]+10)*h.scale[0]+h.translate[0]),s+=m,n+=y;var d=e._tooltip.offsetHeight,u=e._tooltip.offsetWidth;s=Math.max(s,m),s=Math.min(s,_-d),n=Math.max(n,y),n=Math.min(n,g-u),e._tooltip.style.top=s+"px",e._tooltip.style.left=n+"px"})),"none"!==B&&N.on(B+".select",(function(t){this.setAttribute("fill-opacity","0.6")})),"none"!==M&&N.on(M+".tooltipoff",(function(){d3.select("#"+p+"_tooltip").style("display","none")})),"none"!==b&&N.on(b+".deselect",(function(){this.setAttribute("fill-opacity","1.0")})),"none"!==D&&N.on(D+".drilldown",(function(t){WebSquare.idCache[h].changeMap(t.properties.code)})),N.on("click.onmapclick",(function(t){r.f.fireEvent(WebSquare.idCache[h],"onmapclick",a.q.extend({},t.properties))})).on("dblclick.onmapdblclick",(function(t){r.f.fireEvent(WebSquare.idCache[h],"onmapdblclick",a.q.extend({},t.properties))})).on("mouseover.onmapmouseover",(function(t){r.f.fireEvent(WebSquare.idCache[h],"onmapmouseover",a.q.extend({},t.properties))})).on("mouseout.onmapmouseout",(function(t){r.f.fireEvent(WebSquare.idCache[h],"onmapmouseout",a.q.extend({},t.properties))})).on("mousemove.onmapmousemove",(function(t){r.f.fireEvent(WebSquare.idCache[h],"onmapmousemove",a.q.extend({},t.properties))})),e.options.useMarker){l.selectAll("text").data(V).enter().append("svg:path").attr("d",(function(t){return w&&"function"==typeof w?!0===w(t.properties.name,t.properties.code)?O:void 0:O})).attr("class",(function(t){if(!C||"function"!=typeof C)return"w2mapchart_marker";var e=C(t.properties.name,t.properties.code);return e||void 0})).attr("transform",(function(t){var i=G.centroid(t);return"31"==t.properties.code?"translate("+[1.1*i[0]+e.options.markerPositionX,1.1*i[1]-e.options.markerPositionY]+") scale(0)":"translate("+[i[0]+e.options.markerPositionX,i[1]-e.options.markerPositionY]+") scale(0)"})).transition().ease("elastic").attr("transform",(function(t){var i=G.centroid(t);return"31"==t.properties.code||"23"==t.properties.code?"translate("+[1.1*i[0]+e.options.markerPositionX,1.1*i[1]-e.options.markerPositionY]+") scale(1.25)":"translate("+[i[0]+e.options.markerPositionX,i[1]-e.options.markerPositionY]+") scale(1.25)"}));var X=".w2mapchart_marker";if(e.options.markerClass){var U=e.options.markerClass.split(",");for(J=0;J<U.length;J++)X+=",."+U[J]}l.selectAll(X).on("mouseover",(function(t){})).on("mouseleave",(function(t){})).on("click",(function(t){var i="";i+='<div class="w2mapchart_marker_tooltip">',i+='<span class="key">';var a=t.properties.name,o=e._getMatchedStyleData(t.properties.code);if(o&&o.label&&(a=o.label),L&&"function"==typeof L){var r=L(a,t.properties.code);i+=null!=r?r:a+"("+t.properties.code+")"}else i+=a+"("+t.properties.code+")";i+="</span>",i+="</div>",d3.select("#"+p+"_marker_tooltip").html(i).style("display","block").style("pointer-events","none");var s,n,c=G.centroid(t),h=d3.transform(l.attr("transform"));"31"==t.properties.code||"23"==t.properties.code?(s=(1.1*c[1]+5)*h.scale[1]+h.translate[1],n=(1.1*c[0]+5)*h.scale[0]+h.translate[0]):(s=(c[1]+5)*h.scale[1]+h.translate[1],n=(c[0]+5)*h.scale[0]+h.translate[0]),s+=m,n+=y;var d=e._marker_tooltip.offsetHeight,u=e._marker_tooltip.offsetWidth;s=Math.max(s,m),s=Math.min(s,_-d),n=Math.max(n,y),n=Math.min(n,g-u),e._marker_tooltip.style.top=s+"px",
e._marker_tooltip.style.left=n+"px"}))}var K=[],Q=[],$=[],tt=0;l.selectAll("text").data(V).enter().append("text").attr("transform",(function(t){if(1==e.options.accessibility){var i=t.properties.code;i.length>=7?(tt=3,$.push({text:t.properties.name,value:t.properties.code})):i.length>=5?(tt=2,Q.push({text:t.properties.name,value:t.properties.code})):i.length>=2&&(tt=1,K.push({text:t.properties.name,value:t.properties.code}))}var a=G.centroid(t);return"31"==t.properties.code||"23"==t.properties.code?"translate("+[1.1*a[0],1.1*a[1]]+")":"translate("+a+")"})).attr("dy",".35em").attr("class",(function(t){var i="municipality-label c"+t.properties.code,a=e._getMatchedStyleData(t.properties.code);return a&&a.labelClass&&(i+=" "+a.labelClass),i})).style("font-size",(function(t){if(!1===e.options.showMunicipalityLabel)return"0px";var i=e._getMatchedStyleData(t.properties.code);return i&&!1===i.showLabel?"0px":void 0})).text((function(t){var i=t.properties.name;if(e.options.regionNameShort){var a="Map_name_"+t.properties.code;i=n.B.getMessage(a)}var o=e._getMatchedStyleData(t.properties.code);return o&&o.label&&(i=o.label),i})),1==e.options.accessibility&&(1==tt?e.setSelectOptions(K,tt):2==tt?e.setSelectOptions(Q,tt):3==tt&&e.setSelectOptions($,tt));var et=WebSquare.idCache[h].options.csvFileName;if(WebSquare.idCache[h].options.csvHandler)var it=s.Z.getGlobalFunction(WebSquare.idCache[h].options.csvHandler);if(et&&"function"==typeof it&&d3.csv(WebSquare.idCache[h].getURL(et),(function(t){it.call(WebSquare.idCache[h],c,t,R)})),r.f.fireEvent(WebSquare.idCache[h],"onaftermapchange"),!WebSquare.idCache[h]._load){WebSquare.idCache[h]._load=!0;var at=WebSquare.idCache[h].options.dataLists.split(",");for(J=0;J<at.length;J++){var ot=at[J].wq_trim(),rt=s.Z.getComponentById(ot,WebSquare.idCache[h].scope_id);null!=rt&&(rt.addChild(WebSquare.idCache[h]),WebSquare.idCache[h].refreshDataLists(rt.id))}}if(e.options.dataLists&&Object.keys(e._colorScales).length>0)for(var st in e._colorScales)e.setColorScale(e._colorScales[st]);e._textStyles&&e.setTextStyle(e._textStyles.attributeArr,e._textStyles.valueArr),e.options.calloutOverlappedLabel?e._calloutOverlappedLabel():e.options.hideOverlappedLabel&&e._hideOverlappedLabel()}))}catch(t){o.Y.printStackTrace(t)}},c.prototype._getMatchedStyleData=function(t){try{if(this._styleData)for(var e=0;e<this._styleData.length;e++)if(this._styleData[e].code==t)return this._styleData[e];return null}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype.setSelectOptions=function(t,e){try{var i=document.getElementById(this.id+"_level"+e);if(1==e)for(var a=1;a<3;a++){for(var r=(s=document.getElementById(this.id+"_level"+(e+a))).options.length;r>=0;r--)s.remove(r);(n=document.createElement("option")).text="LEVEL"+(e+a),n.value="",s.options[0]=n}else if(2==e){var s;for(a=(s=document.getElementById(this.id+"_level"+(e+1))).options.length;a>=0;a--)s.remove(a);(n=document.createElement("option")).text="LEVEL3",n.value="",s.options[0]=n}for(a=0;a<t.length;a++){var n;(n=document.createElement("option")).text=t[a].text,n.value=t[a].value,i.options[a]=n}}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype.drillup=function(){try{if("0"===this.currentMap)return;var t="0";this.currentMap.length>2&&(t=this.currentMap.slice(0,2)),this.changeMap(t)}catch(t){o.Y.printStackTrace(t)}},c.prototype.changeMap=function(t){try{var e;if(this._marker_tooltip.style.display="none",this._tooltip.style.display="none",1==this.options.accessibility)t.length>=7?e=document.getElementById(this.id+"_level3"):t.length>=5?e=document.getElementById(this.id+"_level2"):t.length>=2&&(e=document.getElementById(this.id+"_level1")),e&&(e.value=t);if(t.length<=5){if(!1===r.f.fireEvent(this,"onbeforemapchange",{oldMapCode:this.currentMap,newMapCode:t}))return;d3.select("#"+this.id+"_svg").remove(),d3.select("#"+this.id+"_svg").selectAll("defs").remove();var i=t,a=this.getDataMapPath(i);this.createMap({width:this.render.clientWidth,height:this.render.clientHeight,
topoFile:a,topoObj:i})}}catch(t){o.Y.printStackTrace(t)}},c.prototype.changeMapPath=function(t){try{d3.select("#"+this.id+"_svg").remove(),d3.select("#"+this.id+"_svg").selectAll("defs").remove(),this.options.dataMapPath=t,this.createMap({width:this.render.clientWidth,height:this.render.clientHeight,topoFile:this.getDataMapPath(this.options.startMap),topoObj:this.options.startMap})}catch(t){o.Y.printStackTrace(t)}},c.prototype.getCurrentMap=function(){try{return this.currentMap}catch(t){o.Y.printStackTrace(t)}},c.prototype.getParentMap=function(){try{return this.currentMap.length>2?this.currentMap.slice(0,2):"0"}catch(t){o.Y.printStackTrace(t)}},c.prototype.addMapEvent=function(t,e){try{for(var i=!1,s=0;s<this.options.userEvents.length;s++)if(this.options.userEvents[s]===t){i=!0;break}i||this.options.userEvents.push(t);var n=t.replace("on",""),l=this.uuid;d3.select("#"+this.id+"_svg").select(".w2mapchart_map").selectAll("path").on(n+".onmap"+n,(function(t){r.f.fireEvent(WebSquare.idCache[l],"onmap"+n,a.q.extend({},t.properties))})),this.bind("onmap"+n,e)}catch(t){o.Y.printStackTrace(t)}},c.prototype.setScale=function(t){try{d3.select("#"+this.id+"_map").attr("transform",(function(e){return"scale("+t+")"})),d3.select("#"+this.id+"_places").attr("transform",(function(e){return"scale("+t+")"}))}catch(t){o.Y.printStackTrace(t)}},c.prototype.getDataMapPath=function(t){try{var e=0,i=this.options.dataMapRatio_level0;t.length>=5?(e=2,i=this.options.dataMapRatio_level2):t.length>=2&&(e=1,i=this.options.dataMapRatio_level1);var a=this.options.dataMapPath+"/level"+e+"/"+i+"/"+t+".json";return a=WebSquare.BootLoader.getResourcePostfix(a)}catch(t){o.Y.printStackTrace(t)}},c.prototype.createPattern=function(t,e){try{var i=[{type:"line",size:4,stroke:"#BDBDBD",strokeWidth:1},{type:"line",orientation:["vertical"],size:4,stroke:"#BDBDBD",strokeWidth:1},{type:"line",orientation:["7/8"],size:8,stroke:"#BDBDBD",strokeWidth:.7},{type:"line",orientation:["vertical","horizontal"],size:4,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["2/8"],size:8,stroke:"#BDBDBD",strokeWidth:1},{type:"line",orientation:["1/8","6/8"],size:8,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["3/8","7/8"],size:8,stroke:"#BDBDBD",strokeWidth:.6},{type:"line",orientation:["3/8","7/8"],size:6,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["2/8","6/8"],size:6,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["2/8","6/8"],size:3,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["2/8"],size:2,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["6/8"],size:3,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["1/8","5/8"],size:5,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["3/8"],size:4,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["1/8","4/8","6/8"],size:8,stroke:"#BDBDBD",strokeWidth:.5},{type:"line",orientation:["1/8","4/8","6/8","8/8"],size:8,stroke:"#BDBDBD",strokeWidth:.5},{type:"circle",size:5,radius:1.5,fill:"#BDBDBD"},{type:"circle",size:2,radius:.5,fill:"#BDBDBD"},{type:"circle",size:5,radius:2,fill:"#BDBDBD"},{type:"circle",size:8,radius:2,fill:"#BDBDBD",strokeWidth:.5},{type:"circle",size:3,radius:.4,fill:"#BDBDBD"},{type:"circle",size:10,radius:2,fill:"#BDBDBD"},{type:"circle",size:5,radius:1.5,fill:"#BDBDBD"},{type:"circle",size:10,radius:4,fill:"#BDBDBD"},{type:"circle",size:6,radius:2,fill:"transparent",stroke:"#BDBDBD",strokeWidth:1},{type:"circle",size:8,radius:4,fill:"transparent",stroke:"#BDBDBD",strokeWidth:2},{type:"circle",size:5,radius:1.5,fill:"#EAEAEA",stroke:"#BDBDBD",strokeWidth:2},{type:"path",d:"hexagons",size:3.5,strokeWidth:2,stroke:"#BDBDBD"},{type:"path",d:"crosses",size:8,stroke:"#BDBDBD",strokeWidth:1},{type:"path",d:"caps",size:7,stroke:"#BDBDBD",strokeWidth:.5},{type:"path",d:"woven",size:10,stroke:"#BDBDBD",strokeWidth:1},{type:"path",d:"waves",size:5,stroke:"#BDBDBD",strokeWidth:1},{type:"path",d:"nylon",size:10,stroke:"#BDBDBD",strokeWidth:1},{
type:"path",d:"squares",size:5,stroke:"#BDBDBD",strokeWidth:.7},{type:"path",d:"waves",size:4,stroke:"#BDBDBD",strokeWidth:.5},{type:"path",d:"caps",size:4,stroke:"#BDBDBD",strokeWidth:.3},{type:"path",d:"nylon",size:7,stroke:"#BDBDBD",strokeWidth:.5},{type:"path",d:"woven",size:6,stroke:"#BDBDBD",strokeWidth:1.5},{type:"path",d:"squares",size:2,stroke:"#BDBDBD",strokeWidth:.5}];t&&"object"==typeof t?0!=e&&void 0!==e||(i=t):0!=e&&void 0!==e||(i=[]);for(var a=0;a<i.length;a++){var r=this.createPatternElement(i[a]);this.patternList.push(r);d3.select("#"+this.id).select("svg").call(r).select("pattern")}}catch(t){o.Y.printStackTrace(t)}},c.prototype.addPattern=function(t){try{if(this.options.usePattern){var e=this.createPatternElement(t);this.patternList.push(e);var i=d3.select("#"+this.id).select("svg").call(e).selectAll("pattern")[0];return i[i.length-1].getAttribute("id")}}catch(t){o.Y.printStackTrace(t)}},c.prototype.createPatternElement=function(t){try{var e;switch(t.type){case"line":e=textures.lines();break;case"circle":e=textures.circles();break;case"path":case"userDefine":e=textures.paths();break;default:return e}return t.orientation&&"line"==t.type&&e.orientation.apply(this,t.orientation),t.d&&"path"==t.type&&e.d(t.d),t.radius&&"circle"==t.type&&e.radius(t.radius),t.stroke&&e.stroke(t.stroke),t.strokeWidth&&e.strokeWidth(t.strokeWidth),t.background&&e.background(t.background),t.size&&e.size(t.size),t.fill&&"circle"==t.type&&e.fill(t.fill),e}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype.checkResize=function(){try{if(this.render){var t=this.render.clientWidth,e=this.render.clientHeight;this.resizeObj&&t>0&&e>0&&""===this.currentMap&&0==this.resizeObj.width&&0==this.resizeObj.height&&(this._marker_tooltip=this.getElementById(this.id+"_marker_tooltip"),this.createMap({width:this.render.clientWidth,height:this.render.clientHeight,topoFile:this.getDataMapPath(this.options.startMap),topoObj:this.options.startMap})),this.resizeObj={width:t,height:e}}}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype.setColorScale=function(t,e,i,a){try{t&&e&&i&&a&&(this._colorScales[t]={key:e,scale:d3.scale.linear().domain(i).range(a)});for(var r=this.options.dataLists.split(","),n=0;n<r.length;n++){var l=r[n].wq_trim();if(l){var c=s.Z.getComponentById(l,this.scope_id).getAllJSON();for(n=0;n<c.length;n++){var p=0;5==c[n].code.length?p=1:c[n].code.length>5&&(p=2);var h=this._colorScales[p];if(h)d3.select("#"+this.id+"_map").select(".municipality.c"+c[n].code).style("fill",h.scale(c[n][h.key]))}}}}catch(t){o.Y.printStackTrace(t)}},c.prototype.setTextStyle=function(t,e){try{this._textStyles={attributeArr:t,valueArr:e};var i=d3.select("#"+this.id+"_svg").select(".w2mapchart_map");if(this._mapData)for(var a=this._mapData,r=topojson.feature(a,a.objects[this.currentMap]).features,s=i.selectAll("text").data(r),n=0;n<t.length;n++)s.style(t[n],e[n])}catch(t){o.Y.printStackTrace(t)}},c.prototype._calloutOverlappedLabel=function(){try{var t=this,e=d3.select("#"+this.id+"_svg").select(".w2mapchart_map"),i=e.selectAll(".municipality-label"),a=this._getOverlappedLabel(i);if(this.options.calloutLabelExceptionHandler){var r=s.Z.getGlobalFunction(this.options.calloutLabelExceptionHandler,this.scope_id);if("function"==typeof r){var n=r();if(n&&n.length>0){var l=[];a.forEach((function(t,e){var i=t.datum();-1===n.indexOf(i.properties.name)&&-1===n.indexOf(i.properties.code)&&l.push(t)})),a=l}}}if(a.length>0){var c=d3.select("#"+this.id+"_svg").node().getBoundingClientRect();a.sort((function(t,e){var i=t.node().getBoundingClientRect(),a=e.node().getBoundingClientRect();return Math.abs(i.top-a.top)>15?i.top-a.top:a.left-i.left}));var p=0;a.forEach((function(t,e){var i=t.node().getBoundingClientRect();p=Math.max(i.width,p)})),a.forEach((function(i,a){var o=i.node().getBoundingClientRect(),r=20+p/2,s=40+a*(1.5*o.height),n=o.left-c.left+o.width/2,l=o.top-c.top+o.height/2;i.attr("transform","translate("+r+","+s+")").classed("callout_label",!0),
i.each((function(i){var a="M"+n+" "+l+" L"+(r+p/1.7)+" "+s+" H"+(r+o.width/1.7);e.append("path").attr("d",a).attr("fill","none").attr("class",(function(){var e=["callout_line","c"+i.properties.code];if(t.options.calloutLineClass){var a=t.options.calloutLineClass.split(",");e=e.concat(a)}return e.join(" ")})),e.append("circle").attr("cx",n).attr("cy",l).attr("r",3).attr("class",(function(){var e=["callout_circle","c"+i.properties.code];if(t.options.calloutCircleClass){var a=t.options.calloutCircleClass.split(",");e=e.concat(a)}return e.join(" ")}))}))}));var h=e.selectAll(".callout_label");h.on("mouseover",(function(t){e.selectAll(".c"+t.properties.code).classed("highlight",!0)})).on("mouseout",(function(t){e.selectAll(".c"+t.properties.code).classed("highlight",!1)}));var d=t.options.event_drilldown.replace(/^on/,"");"none"!==d&&h.on(d+".drilldown",(function(e){t.changeMap(e.properties.code)})),e.selectAll(".municipality").on("mouseover",(function(t){e.selectAll(".c"+t.properties.code).classed("highlight",!0)})).on("mouseout",(function(t){e.selectAll(".c"+t.properties.code).classed("highlight",!1)}))}}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype._hideOverlappedLabel=function(){try{var t=this,e=d3.select("#"+this.id+"_svg").select(".w2mapchart_map").selectAll(".municipality-label"),i=[];if(this.options.hideLabelExceptionHandler){var a=s.Z.getGlobalFunction(this.options.hideLabelExceptionHandler,this.scope_id);"function"==typeof a&&(i=a())}var r=this._getOverlappedLabel(e);if(r.length>0){var n=[];i.forEach((function(t){for(var e=r.length-1;e>=0;e--){var i=r[e],a=i.datum();a.properties.code!=t&&a.properties.name!=t||(n.push(i),r.splice(e,1))}})),(r=r.sort((function(t,e){var i=parseFloat(t.attr("data-area"));return parseFloat(e.attr("data-area"))-i}))).forEach((function(e){for(var i=!1,a=0;a<n.length;a++)if(t._isOverlapped(e,n[a])){i=!0;break}i?e.style("display","none"):n.push(e)}))}}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype._getOverlappedLabel=function(t){try{var e=this,i=[];return t.each((function(a,o){var r=d3.select(this);t.each((function(t,a){if(o!==a){var s=d3.select(this);if(e._isOverlapped(r,s)){for(var n=!1,l=!1,c=0;c<i.length;c++)i[c].node()===r.node()&&(n=!0),i[c].node()===s.node()&&(l=!0);n||i.push(r),l||i.push(s)}}}))})),i}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype._isOverlapped=function(t,e){try{var i=t.node().getBoundingClientRect(),a=e.node().getBoundingClientRect();return i.x<a.x+a.width&&i.x+i.width>a.x&&i.y<a.y+a.height&&i.y+i.height>a.y}catch(t){o.Y.printStackTrace(t,null,this)}},c.prototype.refreshDataLists=function(t){try{this._load&&r.f.fireEvent(this,"onmapdatachange",t)}catch(t){o.Y.printStackTrace(t)}}}}]);