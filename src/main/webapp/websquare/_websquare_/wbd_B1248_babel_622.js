"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[622],{8622:function(t,e,i){i.r(e),i.d(e,{fwRealtimeChart:function(){return d}});var a=i(467),s=i(4756),o=i.n(s),r=i(5461),n=i(5375),l=i(8971),h=i(1204),c=i(2256),u=i(2406),d=function(t,e,i){u.q.call(this,t,e,i)};r.q.extend(d.prototype,u.q.prototype),d.prototype.defaultOptions={pluginType:"uiplugin.fwRealtimeChart",pluginName:"fwRealtimeChart",useConfig:!0,seriesType:"simple",plotColor:"2ec6c8,b5a1dd,5ab0ee,f4984e,d77a80,90bddc,fe5d55,b5dc59,9ea7b3,00ba84,878bb6,757a85",timeformat:"HH:mm:ss",version:"3.7"},d.prototype.initialize=function(t){this.fcObj=null,this.chartObj={},this.attributeObj=null,this.streamFlag=0,this.intervals=null,this.updateData=null,!t.getAttribute("version")&&n.I.getConfiguration("/WebSquare/fusionchart/version/@value")&&(this.options.version=n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))},d.prototype.initAsync=(0,a.A)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof FusionCharts){t.next=39;break}if("4.0"!==this.options.version&&(this.options.version||"4.0"!==n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))){t.next=7;break}return this.options.version="4.0",t.next=5,inquires("externalJS/FusionCharts4.0/FusionCharts_all.js");case 5:case 11:case 17:case 23:case 29:case 35:t.next=39;break;case 7:if("3.23"!==this.options.version&&(this.options.version||"3.23"!==n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))){t.next=13;break}return this.options.version="3.23",t.next=11,inquires("externalJS/FusionCharts3.23/FusionCharts_all.js");case 13:if("3.19"!==this.options.version&&(this.options.version||"3.19"!=n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))){t.next=19;break}return this.options.version="3.19",t.next=17,inquires("externalJS/FusionCharts3.19/FusionCharts_all.js");case 19:if("3.15"!==this.options.version&&(this.options.version||"3.15"!=n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))){t.next=25;break}return this.options.version="3.15",t.next=23,inquires("externalJS/FusionCharts3.15.2/FusionCharts_all.js");case 25:if("3.13"!==this.options.version&&(this.options.version||"3.13"!=n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))){t.next=31;break}return this.options.version="3.13",t.next=29,inquires("externalJS/FusionCharts3.13/js/FusionCharts_all.js");case 31:if("3.11"!=this.options.version&&(this.options.version||"3.11"!=n.I.getConfiguration("/WebSquare/fusionchart/version/@value"))){t.next=37;break}return this.options.version="3.11",t.next=35,inquires("externalJS/FusionCharts3.11.0/FusionCharts_all.js");case 37:return t.next=39,inquires("externalJS/FusionCharts3.7/FusionCharts_all.js");case 39:case"end":return t.stop()}}),t,this)}))),d.prototype.toHTML=function(){var t=[],e=""==this.options.style?"":"style='"+this.options.style+"'";return t.push("<div id='"+this.id+"' "+e+" class='w2fwRealtimeChart "+this.options.className+"'>"),t.push("</div>"),t.join("")},d.prototype.setAction=function(){try{if(("3.19"===this.options.version||"3.23"===this.options.version||"4.0"===this.options.version)&&"function"==typeof FusionCharts.options._setActivate){var t,e=WebSquare.core.getConfiguration("/WebSquare/fusionchart/license/@value");e&&(t={key:e,creditLabel:!1}),FusionCharts.options._setActivate(t)}var i,a=this;if(this.setDefaultOption(),this.modelControl.isDataCollectionRefBinded){if((i=this.modelControl.dataCollectionRefInfo.dataComp)&&i.getRowCount()>0){var s={};s.plotColor=this.options.plotColor,this.chartObj=i.getRealtimeData(this.options.labelNode,this.options.seriesNode,this.options.valueNode,s),this.fcObj=new FusionCharts({id:"fw_realtime_"+a.id,type:a.options.chartType,renderAt:a.id,width:a.render.offsetWidth,height:a.render.offsetHeight||"100%",dataFormat:"json",dataSource:a.chartObj,events:{drawComplete:function(){a._feedData()}}}),this.draw()}
}else if(this.fcObj=new FusionCharts({id:"fw_realtime_"+a.id,type:a.options.chartType,renderAt:a.id,width:"100%",height:a.render.offsetHeight||"100%",dataFormat:"json"}),this.options.dataStreamUrl&&this.options.seriesArray){this.chartObj.dataset||(this.chartObj.dataset=[]);var o=this.options.seriesArray;o=o.wq_replaceAll("'",'"'),o=JSON.parse(o);for(var r=this.options.plotColor.split(","),n=0;n<o.length;n++)o[n].color||(o[n].color=r[n]);for(var h=0;h<o.length;h++)this.chartObj.dataset.push(o[h]);this.attributeObj.dataStreamURL=this.options.dataStreamUrl,this.attributeObj.refreshInterval=this.options.refreshInterval,this.attributeObj.dataStamp=this.options.dataStamp||"",this.attributeObj.showRTMenuItem=this.options.showRTMenuItem||0,this.draw()}}catch(t){l.Y.printStackTrace(t)}},d.prototype._feedData=function(){try{if(""!=this.options.ref){var t=this;this.updateData=function(){var e=t.modelControl.dataCollectionRefInfo.dataComp,i=e.getAllJSON(),a=e.getColumnDistinctDataArray(t.options.seriesNode).length,s=t.options.valueNode;if(t.streamFlag>=i.length){var o=WebSquare.ModelUtil.getSubmission(this.options.submissionId,null,{scope_id:this.scope_id});WebSquare.ModelUtil.executeSubmission(o),t.streamFlag=0}for(var r=FusionCharts("fw_realtime_"+t.id),n=new Date,l="",h=WebSquare.date.getFormattedDate(n,t.options.timeformat),c=t.streamFlag;c<a+t.streamFlag;c++)l+=i[c][s]+"|";l=l.substring(0,l.length-1),t.streamFlag=t.streamFlag+a;var u="&label="+h+"&value="+l;r.feedData(u)},h.Z.setInterval((function(){t.updateData()}),{caller:this,delay:1e3*this.options.refreshInterval,key:this.id+"_interval"})}}catch(t){l.Y.printStackTrace(t)}},d.prototype.refresh=function(){try{var t,e=this;if(this.setDefaultOption(),this.modelControl.isDataCollectionRefBinded&&(t=this.modelControl.dataCollectionRefInfo.dataComp)&&t.getRowCount()>0){var i={};i.plotColor=this.options.plotColor,this.chartObj=t.getRealtimeData(this.options.labelNode,this.options.seriesNode,this.options.valueNode,i);var a="fw_realtime_"+this.id;this.fcObj||FusionCharts.items[a]||(this.fcObj=new FusionCharts({id:"fw_realtime_"+e.id,type:e.options.chartType,renderAt:e.id,width:"100%",height:e.render.offsetHeight||"100%",dataFormat:"json",dataSource:e.chartObj,events:{drawComplete:function(){e._feedData()}}}),this.draw())}}catch(t){l.Y.printStackTrace(t)}},d.prototype.fc=function(){try{return FusionCharts.items["fw_realtime_"+this.id]}catch(t){l.Y.printStackTrace(t)}},d.prototype.draw=function(){try{if(null!=this.attributeObj)for(var t in this.chartObj.chart||(this.chartObj.chart={}),this.attributeObj)this.attributeObj.hasOwnProperty(t)&&(this.chartObj.chart[t.toLowerCase()]=this.attributeObj[t]);this.fcObj.setJSONData(this.chartObj),this.fcObj.isActive()||this.fcObj.render(this.id)}catch(t){l.Y.printStackTrace(t)}},d.prototype.setDefaultOption=function(){try{switch(this._realtimearea=function(){this.attributeObj={showrealtimevalue:"1",yaxismaxvalue:"10",numdisplaysets:"10",bgColor:"#ffffff",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",placeValuesInside:"1",rotateValues:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",labeldisplay:"rotate",slantLabels:"1",showLegend:"1",showValues:"0",showRealTimeValue:"0"}},this._realtimecolumn=function(){this.attributeObj={showrealtimevalue:"1",yaxismaxvalue:"10",numdisplaysets:"10",bgColor:"#ffffff",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",placeValuesInside:"1",rotateValues:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",labeldisplay:"rotate",slantLabels:"1",showLegend:"1",showValues:"0",showRealTimeValue:"0"}},
this._realtimeline=function(){this.attributeObj={showrealtimevalue:"1",yaxismaxvalue:"10",numdisplaysets:"10",bgColor:"#ffffff",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",placeValuesInside:"1",rotateValues:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",labeldisplay:"rotate",slantLabels:"1",showLegend:"1",showValues:"0",showRealTimeValue:"0"}},this._realtimestackedarea=function(){this.attributeObj={showrealtimevalue:"1",yaxismaxvalue:"10",numdisplaysets:"10",bgColor:"#ffffff",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",placeValuesInside:"1",rotateValues:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",labeldisplay:"rotate",slantLabels:"1",showLegend:"1",showValues:"0",showRealTimeValue:"0"}},this._realtimestackedcolumn=function(){this.attributeObj={showrealtimevalue:"1",yaxismaxvalue:"10",numdisplaysets:"10",bgColor:"#ffffff",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",placeValuesInside:"1",rotateValues:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",labeldisplay:"rotate",slantLabels:"1",showLegend:"1",showValues:"0",showRealTimeValue:"0"}},this._realtimelinedy=function(){this.attributeObj={showrealtimevalue:"1",yaxismaxvalue:"10",numdisplaysets:"10",bgColor:"#ffffff",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",placeValuesInside:"1",rotateValues:"1",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",labeldisplay:"rotate",slantLabels:"1",showLegend:"1",showValues:"0",showRealTimeValue:"0"}},this.options.chartType.toLowerCase()){case"realtimearea":this._realtimearea();break;case"realtimecolumn":default:this._realtimecolumn();break;case"realtimeline":this._realtimeline();break;case"realtimestackedarea":this._realtimestackedarea();break;case"realtimestackedcolumn":this._realtimestackedcolumn();break;case"realtimelinedy":this._realtimelinedy()}}catch(t){l.Y.printStackTrace(t)}},d.prototype.setChartAttribute=function(t){try{for(var e in null==this.attributeObj&&(this.attributeObj={}),t)t.hasOwnProperty(e)&&(this.attributeObj[e.toLowerCase()]=t[e])}catch(t){l.Y.printStackTrace(t)}},d.prototype.getChartAttribute=function(t){try{return FusionCharts.items["fw_realtime_"+this.id].getChartAttribute(t)}catch(t){l.Y.printStackTrace(t)}},d.prototype.changeType=function(t){try{this.fc().chartType(t),this.options.chartType=t,this.options.realtime&&(this.streamFlag=0)}catch(t){l.Y.printStackTrace(t)}},d.prototype.exportJSChart=function(t){try{t||(t="jpg");var e=this.options.id||"fusionChart",i=this.getSVGString();if(i){var a=encodeURI(i+"ExportType="+t+"ExportFileName="+e),s=r.q._resourceURI+"engine/servlet/exportFusionChart.jsp";n.I.download(s,a,"post")}}catch(t){l.Y.printStackTrace(t)}},d.prototype.getSVGString=function(){try{var t=this.fc().getSVGString();if(t)return t=(t=(t=(t=(t=t.wq_replaceAll('shape-rendering="default"',"shape-rendering='auto'")).wq_replaceAll('visibility=""',"visibility='inherit'")).wq_replaceAll('text-anchor="undefined"',"text-anchor='start'")).wq_replaceAll("1e-006","0.000001")).wq_replaceAll('font-family="15"','font-family="Verdana"');c.v.printLog("not found svg object")}catch(t){l.Y.printStackTrace(t)}},d.prototype.stopUpdate=function(){try{
if(this.modelControl.isDataCollectionRefBinded)this.modelControl.dataCollectionRefInfo.dataComp&&h.Z.clearInterval(this.id+"_interval");else this.fcObj.stopUpdate()}catch(t){l.Y.printStackTrace(t)}},d.prototype.restartUpdate=function(){try{if(this.modelControl.isDataCollectionRefBinded){if(this.modelControl.dataCollectionRefInfo.dataComp){var t=this;h.Z.setInterval((function(){t.updateData()}),{caller:this,delay:1e3*this.options.refreshInterval,key:this.id+"_interval"})}}else this.fcObj.restartUpdate()}catch(t){l.Y.printStackTrace(t)}},d.prototype.clearChart=function(){try{this.fcObj.clearChart()}catch(t){l.Y.printStackTrace(t)}},d.prototype.isUpdateActive=function(){try{return this.modelControl.isDataCollectionRefBinded?!!WebSquare.userIntervalHash[this.id+"_interval"]:this.fcObj.isUpdateActive()}catch(t){l.Y.printStackTrace(t)}},d.prototype.setDataStreamInfo=function(t){try{if(!t&&!t.dataStreamURL&&t.seriesArray)return;this.chartObj.dataset||(this.chartObj.dataset=[]);for(var e=this.options.plotColor.split(","),i=0;i<t.seriesArray.length;i++)t.seriesArray[i].color||(t.seriesArray[i].color=e[i]);for(var a=0;a<t.seriesArray.length;a++)this.chartObj.dataset.push(t.seriesArray[a]);this.attributeObj.dataStreamURL=t.dataStreamURL,this.attributeObj.refreshInterval=t.refreshInterval,this.attributeObj.dataStamp=t.dataStamp||"",this.attributeObj.showRTMenuItem=t.showRTMenuItem||0}catch(t){l.Y.printStackTrace(t)}},d.prototype.getDataListInfo=function(){try{var t={};if(this.modelControl.isDataCollectionRefBinded){var e=this.modelControl.dataCollectionRefInfo.dataComp;return t.id=e.id,t.ref=this.options.ref,t.labelNode=this.options.labelNode,t.seriesNode=this.options.seriesNode,t.valueNode=this.options.valueNode,t}return null}catch(t){l.Y.printStackTrace(t)}}}}]);