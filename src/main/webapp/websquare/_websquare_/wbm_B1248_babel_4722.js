"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[4722],{4722:function(e,t,i){i.r(t),i.d(t,{checkcombobox:function(){return d}});var s=i(5461),o=i(5375),r=i(8971),l=i(2338),n=i(1204),a=i(2406),h=i(7455),c=i(4860),d=function(e,t,i){a.q.call(this,e,t,i)};s.q.extend(d.prototype,a.q.prototype),s.q.extend(d.prototype,h.t.prototype),s.q.extend(d.prototype,c.G.prototype),d.prototype.defaultOptions={pluginType:"uiplugin.checkcombobox",pluginName:"checkcombobox",renderType:"component",userEvents:["onchange","onclose","onviewchange","oncheckboxclick","oncellclick"],systemEvents:["onblur","onclick","ondblclick","onfocus"],serializable:!0,useConfig:!0,separator:" ",value:"",sortOption:"",sortMethod:"",wmode:!1,visibleRowNum:5,visibleColNum:1,visibleColMax:1,displayMode:"0",delimiter:"\t",textAlign:"",chooseOption:!1,chooseOptionLabel:"",allOption:!1,tooltipMode:"none",readOnly:!1,defaultStyle:"",activeStyle:"",defaultClass:"w2checkcombobox_default",activeClass:"w2checkcombobox_active",useLocale:!1,submenuSize:"auto",direction:"auto",checkboxClickSync:!1,showCheckedTop:!1,tooltipDisplay:!1,tooltipShowAlways:!1,tooltipClass:"",tooltipTime:1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",title:"",setDataRemoveAll:!0,escape:!0,closeonmouseleave:!1,animation:"",customLabelFormatter:"",navBtn:!1,displayAllOptionLabel:!1,checkDisabledOnAllCheck:!0,search:"start",searchTarget:"label",editable:!1,editType:"select",editModeEvent:"onclick",handleOtherClick:!0,noResult:"previous",interactionMode:!1,ignoreBlankOnNoResult:!1,useKeywordHighlight:!1,wheelRows:0,visibleColumn:"",visibleColumnFalseValue:"0,false,FALSE,F",enableColumn:"",enableColumnFalseValue:"0,false,FALSE,F",visibleColumnAutoClear:!1,useDrag:!1,useEdit:!1,rangeSeparator:"",validateOnInput:!1,checkTarget:"",accessibility:!1,allOptionChecked:!1,columnEllipsis:!1},d.prototype.initialize=function(e){try{if(this.itemTable=null,this.isOpen=!1,this.statusSubLayer=!1,this.separator=this.options.separator=this.options.separator||" ",this.selectedInfo={},this.originArrInfo=[],this.editable=this.options.editable,this.search=this.options.search,this.myhelper=new WebSquare.korHelper,this.viewArr=[],this.mytime=null,this.hideTime=null,this.noResult="previous"===this.options.noResult||"clear"===this.options.noResult||"noEnd"===this.options.noResult||"useData"===this.options.noResult||"first"===this.options.noResult?this.options.noResult:"previous",this.interactionMode=this.options.interactionMode,this.itemTableLastCell=null,this.navBtnReached=!1,this.mozTrickBuffer="",this.trickBuffer="",this.findStop=!1,this.displayFormatter=null,this.labelColumn=-1,this._currentTarget=null,this._dragGhost=null,this.defaultAllOptionLabel=WebSquare.language.getMessage("CheckCombobox_all"),e&&"$blank"==e.getAttribute("chooseOptionLabel")?this.defaultChooseOptionLabel="":this.defaultChooseOptionLabel=WebSquare.language.getMessage("CheckCombobox_choose"),this._initDisplayMode(),e){var t="xf"==e.getTagName().split(":")[0]?o.I._XML_NAMESPACE.XFORMS:o.I._XML_NAMESPACE.W2,i=WebSquare.Elem.api.getElementsByTagName(e,"choices",t)[0];if(i){var s=WebSquare.Elem.api.getElementsByTagName(i,"gridItemset",o.I._XML_NAMESPACE.W2)[0];null==s&&(s=WebSquare.Elem.api.getElementsByTagName(i,"gridViewItemset",o.I._XML_NAMESPACE.W2)[0]),s&&"w2:gridItemset"==s.getTagName()?this.itemTableMode="grid":s&&"w2:gridViewItemset"==s.getTagName()&&(this.itemTableMode="gridView")}else"gridViewItemset"==this.options.itemTableType&&(this.itemTableMode="gridView")}"grid"==this.itemTableMode?this.initializeGridItemArr(e):"gridView"==this.itemTableMode?this.initializeGridViewItemArr(e):this.initializeItemArr(e),this.itemDisabledArray=new Array
;for(var l=0;l<this.itemArr.length;l++)this.itemDisabledArray.push(!1);!1===this.options.checkboxClickSync&&(this.options.showCheckedTop=!1),!0===this.options.accessibility&&(this.options.renderType="native"),"native"==this.options.renderType&&(this.options.tableRender="ul"),this.validator=new WebSquare.validator.validateInvoker(this.id,this.options),this.options.customLabelFormatter&&(this.customLabelFormatter=n.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),this.options.useEdit&&(this.options.editable=!1,this.options.searchTarget="label","both"!=this.options.checkTarget&&"label"!=this.options.checkTarget&&"value"!=this.options.checkTarget&&(this.options.checkTarget=""))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.finalize=function(){try{a.q.prototype.finalize.call(this),this.itemTable&&(this.itemTable.remove(),this.itemTable=null),this._dragGhost&&this._dragGhost.remove(),this.labelRuler=null}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.toHTML=function(){try{var e=[],t=""==this.options.style?"":"style='"+this.options.style+"'",i=""==this.options.title?"":"title='"+this.options.title+"'",s=""==this.options.defaultStyle?"":"style='"+this.options.defaultStyle+'"',o=""==this.options.textAlign?"":"style= 'text-align:"+this.options.textAlign+";"+this.options.defaultStyle+"'",l="";return l=!0===this.options.disabled?"":""===this.options.tabIndex?"tabIndex='0'":"tabIndex='"+this.options.tabIndex+"'","native"===this.options.renderType?!0===this.options.accessibility?(e.push("<button id='"+this.id+"' "+t+" class='w2checkcombobox_acc_accessibility "+this.options.className+"' tabIndex='0' aria-expanded='false' "+i+">"),e.push("</button>")):(e.push("<div id='"+this.id+"' "+t+" role='combobox' aria-controls='list' aria-labelledby='"+this.id+"_itemTable' class='w2checkcombobox_acc "+this.options.className+"' tabIndex='0' "+i+">"),e.push("<div id='"+this.id+"_nativeLabel' class='w2checkcombobox_acc_custom' style=''>"),this.options.editable||this.options.useEdit?(e.push("<div class='w2checkcombobox_acc_custom_native_useEditLabel' style='"+s+"'>"),e.push("<span id='"+this.id+"_label' class='w2checkcombobox_acc_custom_label' style='"+o+"'></span>"),e.push("<input id='"+this.id+"_input' class='w2checkcombobox_input w2checkcombobox_acc_custom_label' style='margin:0 auto;display:none;visibility:hidden;' type='text' "+i+" />"),e.push("</div>")):(e.push("<div class='w2checkcombobox_acc_custom_native_label' style=''"+s+">"),e.push("<label id='"+this.id+"_label' class='w2checkcombobox_acc_custom_label' style='display:inline-block;' ></label>"),e.push("</div>")),e.push("<a id='"+this.id+"_button' class='w2checkcombobox_acc_custom_arrow w2checkcombobox_acc_custom_arrow_native' aria-hidden='true' style=''></a>"),e.push("</div>"),e.push("</div>")):(e.push("<div id='"+this.id+"' role='combobox' aria-labelledby='"+this.id+"_itemTable' aria-autocomplete='none' "+t+" class='w2checkcombobox "+this.options.className+"' "+l+i+">"),e.push("<table class='w2checkcombobox_table_main'>"),e.push("<tbody id='"+this.id+"_main_tbody'>"),e.push("<tr class='w2checkcombobox_row w2checkcombobox_row_main'>"),this.options.editable||this.options.useEdit?(e.push("<td class='w2checkcombobox_col_label' "+s+">"),e.push("<div class='w2checkcombobox_label'>"),e.push("<span id='"+this.id+"_label' class='w2checkcombobox_label' "+o+"></span>"),e.push("<input id='"+this.id+"_input' class='w2checkcombobox_input' style='border-width:0px; width:100%; padding:0px; display:none;' type='text' "+i+" />"),e.push("</div></td>"),e.push("<td class='w2checkcombobox_col_button' id='"+this.id+"_button' aria-labelledby='"+this.id+"_itemTable' aria-controls='"+this.id+"_itemTable'></td>")):(e.push("<td class='w2checkcombobox_col_label' "+s+"><div id='"+this.id+"_label' role='document' aria-live='assertive' class='w2checkcombobox_label' "+o+"></div></td>"),
e.push("<td class='w2checkcombobox_col_button' id='"+this.id+"_button' aria-labelledby='"+this.id+"_itemTable' aria-controls='"+this.id+"_itemTable'></td>")),e.push("</tr></tbody>"),e.push("</table>"),e.push("</div>")),e.join("")}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setPreAction=function(){try{this.options.itemTooltipDisplay&&this.options.itemTooltipFormatter&&(this.itemTooltipFormatter=n.Z.getGlobalFunction(this.options.itemTooltipFormatter,this.scope_id)),this.dom.button=this.getElementById(this.id+"_button"),this.dom.label=this.getElementById(this.id+"_label"),this.dom.input=this.getElementById(this.id+"_input"),"native"===this.options.renderType&&(this.dom.nativeLabel=this.getElementById(this.id+"_nativeLabel")),this.dom.tbody=this.getElementById(this.id+"_main_tbody")}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.useOtherComponentId?o.I.setTimer((function(){this.otherComponent=n.Z.getComponentById(this.options.useOtherComponentId),WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.options.useOtherComponentId,WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.otherComponent.render,"onmousedown",this.event.bindAsEventListener(this.otherComponent,(function(e){l.f.stopPropagation(e)}))),this.otherComponent.hide()}),{key:this.options.useOtherComponentId,caller:this,delay:100}):"grid"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):"gridView"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridViewItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openSubLayer,fnHide:this._closeSubLayer,paramHide:{documentClick:!0},event:this.options.editable||this.options.useEdit?{onmousedown:this.handleClickEventDocument}:{}}),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),n.Z.isTouchDevice()&&this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,(function(e){1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll(),l.f.stopPropagation(e)}))),this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(e){l.f.stopPropagation(e)}))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.options.useEdit&&this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeyupEvent)),this.event.addListener(this.render,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.render,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),(this.options.editable||this.options.useEdit)&&(this.event.addListener(this.dom.input,"onblur",this.event.bindAsEventListener(this,this.handleblurEventInput)),this.options.validateOnInput&&this.event.addListener(this.dom.input,"oninput",this.event.bindAsEventListener(this,this.handleInputValidator))),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),
1==this.options.closeonmouseleave&&this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,this.handleMouseleaveEvent)),this.modelControl.isItemsetBinded()?(this.refreshItemArr(),this.componentRedraw()):!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength(),this.modelControl.isBinded()){var e=this.modelControl.getData();this.setValueNM(e)}if(1==this.options.chooseOption){var t=this._getChooseOptionLabel();t=WebSquare.xml.decode(t).replace("&nbsp;"," "),!0===this.options.accessibility?this.render.innerHTML=t:this.dom.label&&(this.dom.label.innerHTML=t)}this.options.mandatory&&this.onPropertyChange("mandatory",n.Z.getBoolean(this.options.mandatory)),this.options.visibleColumnAutoClear&&this.bind("onviewchange",this._clearVisibleColumnChecked)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.refreshItemset=function(){try{if(this.modelControl.isItemsetBinded()){this.refreshItemArr(),this.componentRedraw(),this.itemDisabledArray=new Array;for(var e=0;e<this.itemArr.length;e++)this.itemDisabledArray.push(!1);if("grid"==this.itemTableMode)this.refreshGridItemArr(),null!=this.itemTable&&null!=this.itemTable.grid&&(this.itemTable.grid.clearFilter(),this.setGridData(),this.options.allOption&&this.gridItemArr.length>0&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr)));else if("gridView"==this.itemTableMode){if(this.refreshGridViewItemArr(),null!=this.itemTable&&null!=this.itemTable.gridView)this.modelControl.getDataComp(this.itemTable.gridView.options.dataList).setData(this.gridViewItemArr,!1),this.setGridViewData()}if(this.options.editable&&this.itemArr.length<=0&&this.initCheckCombobox(),this.modelControl.isBinded())this.refresh();else{var t=[];for(e=0;e<this.itemArr.length;e++)this.itemArr[e].value!=WebSquare.allValue&&t.push({index:e,checked:!1});this.setSelectedInfoNM(t)}}this.isOpen?this.setItemTable():this.options.useEdit&&this.itemTable&&(this.itemTable.show(),this.setItemTable(),this.itemTable.hide())}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.refresh=function(){try{if(this.modelControl.isBinded()){var e=this.getValue(),t=this.modelControl.getData();1==this.setValueNM(t)&&e!=this.getValue()&&l.f.fireEvent(this,"onchange",{oldValue:e,newValue:this.getValue()})}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.componentRedraw=function(){try{!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.setSelectOptions(),(this.options.editable||this.options.useEdit)&&this.showEditMode(!1),this.setValueNM("")}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setLabelWidthByItemLength=function(){try{this.labelRuler&&document.getElementById("checkcombobox_ruler")||(this.labelRuler=document.createElement("div"),this.labelRuler.style.position="absolute",this.labelRuler.style.top="-1000px",this.labelRuler.style.left="-1000px",this.labelRuler.style.visibility="hidden",this.labelRuler.id="checkcombobox_ruler",document.body.appendChild(this.labelRuler));for(var e=0,t=0;t<this.itemArr.length;t++)this.labelRuler.innerHTML=this.itemArr[t].label,this.labelRuler.offsetWidth>e&&(e=this.labelRuler.offsetWidth);if(this.render){var i=document.getElementById(this.id+"_button");this.render.style.width=e+i.offsetWidth+10+"px"}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.itemTableHandleKeydownEvent=function(e){try{var t=l.f.getTarget(e),i=parseInt(this.itemTable.getSelectedIndex()),s=e.charCode?e.charCode:e.keyCode,o=i,n=this.itemTable.getItemCount(),a=document.getElementById(this.itemTable.id+"_main");if(9==s&&e.shiftKey||38===s)if(l.f.preventDefault(e),!0!==this.navBtnReached)if(o>0){for(;0<=o-1&&this.itemTable._getCellDisabled(o-1)||this.itemTable._getCellHidden(o-1);)0===--o&&(this.itemTable.endReached=!0);if(o>0)this.itemTable.setSelectedIndex(o-1),
(c=this.itemTable.selectedCell.querySelector("#"+this.itemTable.selectedCell.id+"_checkbox"))&&(c.focus(),a.setAttribute("aria-activedescendant",c.id))}else this.itemTable.endReached=!0;else{if(t===this.dom.confirmBtn){this.selectedCell=this.itemTableLastCell;var h=WebSquare.util.getDataPrefix("index");this.dom.confirmBtn.removeAttribute("tabIndex"),this.itemTable.setSelectedIndex(this.selectedCell.getAttribute(h)),(c=this.itemTable.selectedCell.querySelector("#"+this.itemTable.selectedCell.id+"_checkbox"))&&(c.focus(),a.setAttribute("aria-activedescendant",c.id)),this.navBtnReached=!1}t===this.dom.cancelBtn&&this.dom.confirmBtn&&(this.dom.cancelBtn.removeAttribute("tabIndex"),this.dom.confirmBtn.setAttribute("tabIndex",0),this.dom.confirmBtn.focus())}else if(9==s&&!e.shiftKey||40===s){if(l.f.preventDefault(e),o+1<n){for(o++;o+1<=n&&this.itemTable._getCellDisabled(o)||this.itemTable._getCellHidden(o);)++o===n&&(this.options.navBtn?this.navBtnReached=!0:this.itemTable.endReached=!0);if(o<n)this.itemTable.setSelectedIndex(o),(c=this.itemTable.selectedCell.querySelector("#"+this.itemTable.selectedCell.id+"_checkbox"))&&(c.focus(),a.setAttribute("aria-activedescendant",c.id))}else this.options.navBtn?this.navBtnReached=!0:this.itemTable.endReached=!0;!0===this.navBtnReached&&(t!==this.dom.confirmBtn&&t!==this.dom.cancelBtn&&(this.itemTableLastCell=this.itemTable.selectedCell,this.dom.confirmBtn&&(this.dom.confirmBtn.setAttribute("tabIndex",0),this.dom.confirmBtn.focus()),this.removeClass(this.itemTable.selectedCell,this.itemTable.options.w2table_col_over)),t===this.dom.confirmBtn&&this.dom.cancelBtn&&(this.dom.confirmBtn.removeAttribute("tabIndex"),this.dom.cancelBtn.setAttribute("tabIndex",0),this.dom.cancelBtn.focus()),t===this.dom.cancelBtn&&(null!==this.itemTable.selectedCell&&(this.itemTable.selectedCell=null),this.itemTable.endReached=!0,this.navBtnReached=!1,this.isOpen&&this._closeSubLayer(),this.dom.button.focus()))}else if(32==s)if(l.f.preventDefault(e),t===this.dom.confirmBtn)null!==this.itemTable.selectedCell&&(this.itemTable.selectedCell=null),this.dom.confirmBtn.click(),this.navBtnReached=!1,this.dom.button.focus();else if(t===this.dom.cancelBtn)null!==this.itemTable.selectedCell&&(this.itemTable.selectedCell=null),this.dom.cancelBtn.click();else{var c;if(this.itemTable.options.checkbox&&!this.itemTable._getCellDisabled(o)&&i>=0)(c=document.getElementById(this.itemTable.id+"_"+i+"_checkbox")).click()}else 13==s&&t===this.itemTable.selectedCell&&(l.f.preventDefault(e),this.itemTable.endReached=!0);!0===this.itemTable.endReached&&(this.removeClass(this.itemTable.selectedCell,this.itemTable.options.w2table_col_over),this.itemTable.selectedCell=null,this.isOpen&&this._closeSubLayer(),this.itemTable.endReached=null,this.render.focus())}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setSubLayer=function(){try{var e=this;if(null==this.itemTable)if("grid"==this.itemTableMode){if(this.gridItemArr.length<=0)return;this.itemTable=new WebSquare.uiplugin.gridItemTable(this.id+"_gridItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridOptions:this.gridOptions,visibleRowNum:this.options.visibleRowNum,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.grid.addEvent("oncellclick",(function(t,i){e.focus(),"dataList"===e.gridViewOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t)),e.setSelectedIndex1(t)})),this.event.addListener(this.itemTable.grid.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.grid,(function(t){var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.focus();var s=this.getFocusedRowIndex();"dataList"===e.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(s)}else 27==i&&(e._closeSubLayer(),e.focus())}))),this.setGridData()}else if("gridView"==this.itemTableMode){if(this.gridViewItemArr.length<=0)return
;"auto"==this.options.submenuSize&&(this.gridViewOptions.width||(this.gridViewOptions.parentWidth=this.render.offsetWidth),this.gridViewOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridViewItemTable(this.id+"_gridViewItemTable",{itemsetObj:this.itemsetObj,submenuSize:this.options.submenuSize,className:this.options.className,gridViewOptions:this.gridViewOptions,visibleRowNum:this.options.visibleRowNum,navBtn:this.options.navBtn,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.gridView.addEvent("oncellclick",(function(t,i,s,o){e.focus(),o=o||{},"dataList"===e.gridViewOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t));var r=parseInt(e.itemTable.options.gridViewOptions.checkColumn);if("checkbox"===this.getCellInputType(t,i)&&i===r){var n="";if(!0===o.checked){if(0===t&&this.getCellData(t,e.labelColumn)===e.defaultAllOptionLabel){for(var a=1;a<e.itemArr.length;a++)e.addSelectedInfo({index:a,checked:!0});this.checkAll(r,!0),e.checkAll(r,!0)}else e.itemArr[t].checked=!0,e.addSelectedInfo({index:t,checked:!0}),this.setCellChecked(t,i,!0);n=!0}else{if(0===t&&this.getCellData(t,e.labelColumn)===e.defaultAllOptionLabel){for(a=1;a<e.itemArr.length;a++)e.addSelectedInfo({index:a,checked:!1});this.checkAll(r,!1),e.checkAll(r,!1)}else e.itemArr[t].checked=!1,e.addSelectedInfo({index:t,checked:!1}),this.setCellChecked(t,i,!1);n=!1}if(e.options.allOption&&t>0){var h=!0;if(!0===o.checked){for(a=1;a<e.itemArr.length;a++)if(!e.itemArr[a].checked){h=!1;break}}else e.itemArr[t].checked=!1,h=!1;this.setCellChecked(0,i,h)}l.f.fireEvent(e,"oncellclick",t,i,n)}})),this.event.addListener(this.itemTable.gridView.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.gridView,(function(t){27==(t.charCode?t.charCode:t.keyCode)&&(e._closeSubLayer(),e.focus())})));for(var t=parseInt(this.itemTable.options.gridViewOptions.checkColumn),i=this.itemTable.gridView.getRowCount(),s=1==this.options.allOption?1:0,a=s;a<i;a++)"1"===this.itemTable.gridView.getCellData(a,t)?this.addSelectedInfo({index:a+s,checked:!0}):this.addSelectedInfo({index:a+s,checked:!1});this.setGridViewData()}else{var h="fixed"===this.options.submenuSize&&this.options.columnEllipsis?"w2table_ccb_col_ellipsis":"",c="fixed"===this.options.submenuSize&&this.options.columnEllipsis?"w2table_ccb_col_checkbox_ellipsis":"",d="fixed"===this.options.submenuSize&&this.options.columnEllipsis?"w2table_ccb_col_label_ellipsis":"",u={row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:(!0===this.options.accessibility?"":"text-align:"+this.options.textAlign+";")+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_ccb",w2table_main:"w2table_ccb_main",w2table_row:"w2table_ccb_row",w2table_col:"w2table_ccb_col "+h,w2table_col_over:"w2table_ccb_col_over",w2table_col_checkbox:"w2table_ccb_col_checkbox "+c,w2table_col_label:"w2table_ccb_col_label "+d,checkbox:!0,navBtn:this.options.navBtn,escape:this.options.escape,editable:this.options.editable,wheelRows:this.options.wheelRows,parent_uuid:this.uuid,parentPluginName:this.options.pluginName,visibleColNum:this.options.visibleColNum,visibleColMax:this.options.visibleColMax},m=this.options.accessibility?"w2table_ccb_ul_col_over_accessibility":"w2table_ccb_ul_col_over";"native"===this.options.renderType&&(u.w2table="w2table_ccb_native",u.w2table_main="w2table_ccb_ul_main",u.w2table_col="w2table_ccb_ul_col "+h,u.w2table_row="w2table_ccb_ul_row",u.w2table_col_over=m,u.w2table_col_checkbox="w2table_ccb_ul_col_checkbox "+c,u.w2table_col_label="w2table_ccb_ul_col_label "+d,u.tableRender=this.options.tableRender),this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",u);e=this;"native"===this.options.renderType&&(this.itemTable.handleKeydownEvent=function(t){return e.itemTableHandleKeydownEvent(t)}),
this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.addClickEventListener((function(t,i){var s=document.getElementById(e.id+"_itemTable_"+i+"_checkbox");if(s&&s.value==WebSquare.allValue){for(var o=n.Z.getBoolean(s.checked),r=1;r<e.itemArr.length;r++)if(n.Z.getBoolean(e.options.checkDisabledOnAllCheck)||!e.itemDisabledArray[r]){var a=document.getElementById(e.id+"_itemTable_"+r+"_checkbox");a&&a.checked!=o&&(a.checked=o),e.addSelectedInfo({index:r,checked:o})}}else e.options.editable&&(e.mozTrickBuffer="",i=e.viewArr[i].index),e.addSelectedInfo({index:i,checked:s.checked});if(e.options.allOption)if(i>0){var h=!0;if(s.checked)if(e.options.editable&&e.editmode){e.itemArr[i].checked=!0;for(r=1;r<e.itemArr.length;r++)if(!e.itemArr[r].checked){h=!1;break}}else for(r=1;r<e.itemArr.length;r++){var c=document.getElementById(e.id+"_itemTable_"+r+"_checkbox");if(c&&!c.checked){h=!1;break}}else h=!1;document.getElementById(e.id+"_itemTable_0_checkbox").checked=h,e.options.editable&&(e.itemArr[0].allchecked=h)}else e.options.editable&&(e.itemArr[0].allchecked=s.checked);if(e.options.checkboxClickSync){var d=e.getValue(),u=e.getInfoArray(),m=e.convertInfoHash2Array(e.selectedInfo);m.length>0&&e.setSelectedInfo(m);var p=e.getValue();if(d!=p){var b={oldInfo:u,newInfo:e.getInfoArray(),oldValue:d,newValue:p};l.f.fireEvent(e,"onviewchange",b)}}l.f.fireEvent(e,"oncheckboxclick",i,s.checked,s.value)})),this.itemTable.addKeyDownEventListener((function(t,i){var s=t.charCode?t.charCode:t.keyCode;(13==s||27==s)&&(e.focus(),e.closeSubLayer())}));var p=WebSquare.idCache[this.uuid],b=this.options.closeonmouseleave,f=this.options.itemTooltipDisplay;if((b||f)&&this.itemTable.addMouseLeaveEventListener((function(t){if(b){var i=e.render.offsetHeight,s=e.getAbsolutePosition("top");t.clientY>=s&&t.clientY<=s+i||e.closeSubLayer()}f&&p.hideTooltip()})),f&&this.itemTable.addMouseOverEventListener((function(e){var t=n.Z.getDataPrefix("index"),i=e,s=WebSquare.style.getAbsoluteLeft(i)+20,o=WebSquare.style.getAbsoluteTop(i)+i.offsetHeight+3,r="ul"===p.options.tableRender?i.innerText:i.innerHTML;if(p.itemTooltipFormatter&&"function"==typeof p.itemTooltipFormatter){var l=parseInt(i.getAttribute(t),10);r=p.itemTooltipFormatter(r,l,p.options._rowIndex,p.options._colIndex)}p.showTooltip(s,o,r)})),this.options.useDrag&&(this.itemTable.event.addListener(this.itemTable.render,"onmousedown",this.itemTable.event.bindAsEventListener(this,this.handleItemtableMousedown)),this._dragGhost||(this._dragGhost=new WebSquare.uiplugin.group(this.id+"_dragGhost",{className:"w2checkcombobox_ghost"}),this._dragGhost.writeTo(WebSquare.getBody(),null,this.parentFrame),this._dragGhost.activate(),this._dragGhost.onComplete())),this._getSelectedInfo().length>0&&!0===this.options.showCheckedTop){for(a=0;a<this.getItemCount();a++){if(this.itemArr[a].checked)null!=(v=document.getElementById(this.id+"_itemTable_"+a+"_checkbox"))&&(v.checked=!0),this.addSelectedInfo({index:a,checked:null==v||v.checked})}this._sortCheckItemArr()}if(this.setSelectOptions(),this.setItemTable(),"native"===this.options.renderType){var g=WebSquare.language.getMessage("CheckCombobox_label")||"label";document.getElementById(this.itemTable.id+"_main").setAttribute("aria-label",g)}var y=!0;for(a=0;a<this.getItemCount();a++){var v;if(this.itemArr[a].checked)null!=(v=document.getElementById(this.id+"_itemTable_"+a+"_checkbox"))&&(v.checked=!0),this.addSelectedInfo({index:a,checked:null==v||v.checked});else 1==this.options.allOption?(1==this.getItemCount()||this.itemArr[a].value!=WebSquare.allValue)&&(y=!1):y=!1}1==y&&1==this.options.allOption&&this.getItemCount()>0&&(document.getElementById(this.id+"_itemTable_0_checkbox").checked=!0)}if(!this.options.editable)for(a=0;a<this.itemDisabledArray.length;a++)this.setItemDisabled(a,this.itemDisabledArray[a]);if(this.options.enableColumn&&this.refreshEnable(),
this.options.navBtn&&!this.itemTable.getElementById(this.id+"_btnArea")){var T,k=[],A=WebSquare.language.getMessage("itemTable_cancel")||"cancel",_=WebSquare.language.getMessage("itemTable_confirm")||"confirm",S=document.createElement("div");if(S.className="w2checkcombobox_btnArea",S.id=this.id+"_btnArea",S.setAttribute("role","listitem option"),S.setAttribute("aria-setsize",this.options.visibleRowNum),S.setAttribute("aria-posinset",this.options.visibleRowNum),k.push("<div id='"+this.id+"_btn_confirm' class='w2checkcombobox_btn_confirm' role='button' title='"+_+"'>"+_+"</div>"),k.push("<div id='"+this.id+"_btn_cancel' class='w2checkcombobox_btn_cancel' role='button' title='"+A+"'>"+A+"</div>"),k=k.join(""),S.innerHTML=k,n.Z.isIE()&&o.I.browserVersion()<=8){var w,I=this.itemTable.render.getElementsByTagName("div");for(a=0;w=I[a++];)if("w2checkcombobox_btn_div"==w.className){T=w;break}}else T=this.itemTable.render.getElementsByClassName("w2checkcombobox_btn_div")[0];T.appendChild(S),this.dom.confirmBtn&&this.dom.cancelBtn||(this.dom.confirmBtn=this.itemTable.getElementById(this.id+"_btn_confirm"),this.dom.cancelBtn=this.itemTable.getElementById(this.id+"_btn_cancel")),this.event.addListener(this.dom.confirmBtn,"onclick",this.event.bindAsEventListener(this,(function(){this.closeSubLayer()}))),this.event.addListener(this.dom.cancelBtn,"onclick",this.event.bindAsEventListener(this,(function(){if(this.options.editable){var e=0;if(this.options.allOption)document.getElementById(this.id+"_itemTable_0_checkbox").checked=!1,this.itemArr[0].allchecked=!1,e=1;for(var t=e;t<this.viewArr.length;t++){var i=this.viewArr[t].index;if(this.itemArr[i].checked=!1,this.addSelectedInfo({index:i,checked:!1}),(u=document.getElementById(this.id+"_itemTable_"+t+"_checkbox")).checked=!1,this.options.checkboxClickSync){var s=this.getValue(),o=this.getInfoArray(),r=this.convertInfoHash2Array(this.selectedInfo);r.length>0&&this.setSelectedInfo(r);var n=this.getValue();if(s!=n){var a={oldInfo:o,newInfo:this.getInfoArray(),oldValue:s,newValue:n};l.f.fireEvent(this,"onviewchange",a)}}}}else{var h=this.getItemCount();if("gridView"===this.itemTableMode){var c=parseInt(this.itemTable.options.gridViewOptions.checkColumn);for(h=this.itemTable.gridView.getRowCount(),this.options.allOption,t=0;t<h;t++){var d=this.itemTable.gridView._getTdElem(t,c);d&&(d.getElementsByTagName("input")[0].checked=!1),this.addSelectedInfo({index:t,checked:!1})}}else for(t=0;t<h;t++){var u;(u=document.getElementById(this.id+"_itemTable_"+t+"_checkbox"))&&(u.checked=!1,this.addSelectedInfo({index:t,checked:u.checked}))}}})))}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setSelectOptions=function(){try{null!=this.itemTable&&"gridView"!=this.itemTableMode&&!0!==this.refreshStopItemTable&&(this.options.editable?this.editmode?0==this.viewArr.length||this.itemTable.setItemArr(this.viewArr):null!=this.itemArr&&0!=this.itemArr.length?this.itemTable.setItemArr(this.itemArr):this.itemTable.hide():this.itemTable.setItemArr(this.itemArr))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setItemTable=function(){try{if(this.options.editable){for(var e=0;e<this.viewArr.length;e++)this.viewArr[e].checked=!(!this.itemArr[this.viewArr[e].index].checked&&!this.itemArr[this.viewArr[e].index].allchecked)||"";this.itemTable.setItemArr(this.viewArr);for(var t=0;t<this.viewArr.length;t++)this.setItemDisabled(t,this.itemDisabledArray[t])}var i=this.render.offsetWidth-2,s=WebSquare.style.getAbsoluteLeft(this.render),l=WebSquare.style.getAbsoluteTop(this.render),n=this.getVisibleItemCount(),a=0,h=this.options.visibleColNum>1||this.options.visibleColMax>1;if(!0===this.options.navBtn)if(this.getElementById(this.id+"_btnArea"))a=WebSquare.style.getSize(this.getElementById(this.id+"_btn_confirm"),"outermarginwidth")+WebSquare.style.getSize(this.getElementById(this.id+"_btn_cancel"),"outermarginwidth");var c=0
;"auto"==this.options.submenuSize&&"auto"==this.options.submenuSize&&(c=WebSquare.style.getSize(this.itemTable.render,"innerwidth")-WebSquare.style.getSize(this.itemTable.render,"width")),"gridView"===this.itemTableMode||"grid"===this.itemTableMode||"column"===this.options.submenuSize||h||(this.itemTable.setStyle("width",this.render.offsetWidth-c+"px"),this.itemTable.render.firstChild.style.width=this.render.offsetWidth-c+"px");var d=this.itemTable.render.getElementsByTagName("tr"),u=this.itemTable.render.getElementsByTagName("td");if("native"===this.options.renderType)var m=this.itemTable.render.getElementsByTagName("li");if("gridView"!==this.itemTableMode&&"grid"!==this.itemTableMode)if("native"!==this.options.renderType&&u&&u.length>0){var p=0,b=n;h?(g=Math.min(d.length,this.options.visibleRowNum),b=d.length):this.options.editable?(g=Math.min(u.length,this.options.visibleRowNum),b=u.length):g=Math.min(n,this.options.visibleRowNum);var f=0;for(t=0;t<b&&g>0;t++)this.options.visibleColumn&&this.options.visibleColumnFalseValue&&!0===this.itemArr[t]._hidden||(p+=h?d[t].offsetHeight:u[0].offsetHeight,g--,f++);1==this.options.navBtn?(this.getElementById(this.itemTable.id+"_wrapper").style.height=p+"px",p+=u[0].offsetHeight):o.I.browserCheck.moz&&p<34&&1===f&&(p=34),this.itemTable.setStyle("height",p+"px")}else if("native"===this.options.renderType&&m&&m.length>0){var g,y=0;b=n;this.options.editable?(g=Math.min(m.length,this.options.visibleRowNum),b=m.length):g=Math.min(n,this.options.visibleRowNum);for(f=0,t=0;t<b&&g>0;t++)this.options.visibleColumn&&this.options.visibleColumnFalseValue&&!0===this.itemArr[t]._hidden||(y+=parseInt(WebSquare.style.getStyle(m[t],"height").wq_replaceAll("px",""),10)+parseInt(WebSquare.style.getStyle(m[t],"padding-top").wq_replaceAll("px",""),10)+parseInt(WebSquare.style.getStyle(m[t],"padding-bottom").wq_replaceAll("px",""),10)+parseInt(WebSquare.style.getStyle(m[t],"border-top").slice(0,1),10),g--,f++);1==this.options.navBtn?(this.getElementById(this.itemTable.id+"_wrapper").style.height=y+"px",this.getElementById(this.itemTable.id+"_wrapper").style.left="-1px",y+=m[0].offsetHeight):o.I.browserCheck.moz&&p<34&&1===f&&(p=34),this.itemTable.setStyle("height",y+"px")}if("column"==this.options.submenuSize){if(this.itemTable.render.scrollHeight>this.itemTable.render.offsetHeight){var v=this.itemTable.mainTable.offsetWidth+17;this.itemTable.render.offsetWidth!==v&&this.itemTable.setStyle("width",v+"px")}}else if(this.itemTableMode&&this[this.itemTableMode+"Options"].width)!0===this.options.navBtn&&this.getElementById(this.id+"_btnArea")&&(this.getElementById(this.id+"_btnArea").style.width=this.itemTable.render.offsetWidth+"px");else if("fixed"==this.options.submenuSize)this.itemTable.setStyle("width",i+"px"),!0===this.options.navBtn&&(this.itemTable.render.firstChild.firstChild.style.width=i+"px",this.getElementById(this.id+"_btnArea")&&(a>i&&a/2<i&&(p+=u[0].offsetHeight,this.itemTable.setStyle("height",p+"px")),this.getElementById(this.id+"_btnArea").style.width=i+"px")),this.itemTable.render.offsetHeight>=this.itemTable.render.scrollHeight?this.itemTable.render.firstChild.style.width=i+"px":this.itemTable.render.firstChild.style.width=i-17+"px";else if("auto"==this.options.submenuSize){var T=2;"gridView"!==this.itemTableMode&&"grid"!==this.itemTableMode||(T=0);var k=this.render.offsetWidth-c-T,A=this.itemTable.render.clientWidth-c,_=this.itemTable.maxWidth,S=0;if((A=k<_?_:k)<k-2&&(A=k-2),n>this.options.visibleRowNum&&(S=17),A=Math.max(a,A),this.itemTable.setStyle("width",A+"px"),!0===this.options.navBtn&&this.getElementById(this.id+"_btnArea")&&(this.getElementById(this.id+"_btnArea").style.width=A+"px"),this.itemTable.render.clientHeight>=this.itemTable.render.scrollHeight||n<=this.options.visibleRowNum)this.itemTable.render.firstChild.style.width=A+"px",!0===this.options.navBtn&&(this.itemTable.render.firstChild.firstChild.style.width=A+"px");else{this.itemTable.render.firstChild.style.width=A-S+"px"
;var w=this.itemTable.render.firstChild.offsetWidth;w>A-S&&(this.itemTable.render.firstChild.style.width=w+"px",this.itemTable.setStyle("width",Math.max(a,w)+S+"px"))}}else this.itemTable.render.scrollHeight-this.itemTable.render.offsetHeight>1&&this.itemTable.setStyle("width",Math.max(a,this.itemTable.render.firstChild.offsetWidth)+S+"px");var I=this.options.direction;if("auto"==I){var x=document.body.scrollTop;x<document.documentElement.scrollTop&&(x=document.documentElement.scrollTop);var C=l-x,L=document.documentElement.clientHeight-(C+this.render.offsetHeight),E=this.itemTable.render.offsetHeight,O=Math.max(L,C);if(O<E&&u&&u.length>0){var B=0;for(t=0;t<u.length&&!(B+u[t].offsetHeight+2>O);t++)B+=u[t].offsetHeight;this.itemTable.rowCount=t,this.itemTable.setStyle("height",B+"px"),O!==L&&(I="up")}else L<E&&C>E&&(I="up")}if("up"==I?l-=this.itemTable.render.offsetHeight:l+=this.render.offsetHeight,document.documentElement.clientWidth<s+this.itemTable.render.offsetWidth&&(s=s+this.render.offsetWidth-this.itemTable.render.offsetWidth),this.itemTableDirection=I,this.itemTable.render.style.left=s+"px",this.itemTable.render.style.top=l+"px",WebSquare.style.adjustZIndex(this.uuid,this.itemTable.uuid,"itemTable"),this.options.animation&&("slideDown"!==this.options.animation||"up"!==I)){this.getItemCount()<=this.options.visibleRowNum&&this.itemTable.setStyle("overflow-y","hidden");var M="w2"+this.options.animation;this.addClass(this.itemTable.render,M)}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._sortItemArr=function(){try{var e=[],t=null;"label"==this.options.sortOption?t=function(){return this.label}:"value"==this.options.sortOption&&(t=function(){return this.value});for(var i=0;i<this.itemArr.length;i++){var s=this.itemArr[i];s.toString=t,e.push(s)}var o=this.modelControl.getDataComp(),l=o&&o.getCellInfo(this.itemsetObj[this.options.sortOption]);return l&&"number"===l.options.dataType?e.sort((function(e,t){return e.toString().localeCompare(t.toString(),void 0,{numeric:!0,sensitivity:"base"})})):e.sort(),"descending"==this.options.sortMethod&&e.reverse(),e}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setSelectItemArr=function(){try{if(""!=this.options.sortOption&&(this.itemArr=this._sortItemArr()),!0===this.options.showCheckedTop&&(this.originArrInfo=this.itemArr),this.options.editable){for(var e=0;e<this.itemArr.length;e++)this.itemArr[e].orgLabel=this.itemArr[e].orgLabel||this.itemArr[e].label,this.itemArr[e].label=this.getItemText(e);1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,noItem:!0,allchecked:""}].concat(this.itemArr)),this.viewArr=[];for(e=0;e<this.itemArr.length;e++)this.viewArr.push({label:this.itemArr[e].label,value:this.itemArr[e].value,orgLabel:this.itemArr[e].orgLabel,index:e,checked:""})}else{for(e=0;e<this.itemArr.length;e++)this.itemArr[e].orgLabel=this.itemArr[e].orgLabel||this.itemArr[e].label,this.itemArr[e].label=this.getItemText(e);1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr))}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.toggle=function(){try{this.isOpen?this.closeSubLayer():this.openSubLayer()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.openSubLayer=function(){try{WebSquare.getBody().getLayerListener().show(this.id)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._openSubLayer=function(){try{if(this.oldValue=this.getValue(),this.setSubLayer(),!this.isOpen){if(this.itemTable.show(),this.addClass("w2checkcombobox_open"),!0===this.options.accessibility?this.render.setAttribute("aria-expanded","true"):this.itemTable.render.setAttribute("aria-expanded","true"),this.setItemTable(),1==this.options.wmode&&WebSquare.getBody().showWModeFrame(this.getPluginName(),this.itemTable.render),!this.options.editable)if("native"===this.options.renderType){
var e=document.getElementById(this.itemTable.id+"_main");e.setAttribute("tabindex",0),e.focus()}else this.itemTable.focus();if(this.editmode&&void 0!==this.dom.input&&null!=this.dom.input&&this.setfFocus(),this.isOpen=!0,this.options.customLabelFormatter&&(this.customLabelFormatter=n.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter){var t=this._getSelectedInfo();if(t.length>0){var i=this.customLabelFormatter.call(this,t,this.isOpen);!0===this.options.accessibility?this.render.innerHTML=i:this.dom.label&&(this.dom.label.innerHTML=i)}}}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.closeSubLayer=function(e){try{var t={documentClick:e};null!=this.itemTable&&("grid"==this.itemTableMode&&this.gridItemArr.length>0?this.itemTable.grid.applyFocusedCellOut(this.itemTable.grid.focusedCell[0]):"gridView"==this.itemTableMode&&this.gridViewItemArr.length>0&&this.itemTable.gridView.applyFocusedCellOut(this.itemTable.gridView.focusedCell[0])),WebSquare.getBody().getLayerListener().hide(this.id,t)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.closeSubLayer1=function(e){try{var t={documentClick:e};WebSquare.getBody().getLayerListener().hide(this.id,t)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._closeSubLayer=function(e){try{var t=(e=e||{}).documentClick,i=this.getValue(),s=this.getInfoArray();if(this.isOpen&&null!=this.itemTable){1==this.options.wmode&&WebSquare.getBody().hideWModeFrame(this.getPluginName(),this.itemTable.id);var o=this.convertInfoHash2Array(this.selectedInfo);if(o.length>0&&this.setSelectedInfo(o),!0===this.options.showCheckedTop&&this._sortCheckItemArr(),this.itemTable.hide(),this.removeClass("w2checkcombobox_open"),!0===this.options.accessibility?(this.render.setAttribute("aria-expanded","false"),document.getElementById(this.itemTable.id+"_main").removeAttribute("aria-activedescendant")):this.itemTable.render.setAttribute("aria-expanded","false"),this.isOpen=!1,this.options.customLabelFormatter&&(this.customLabelFormatter=n.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter){var a=this._getSelectedInfo(),h=this.customLabelFormatter.call(this,a,this.isOpen);""==h&&1==this.options.chooseOption&&(h=this._getChooseOptionLabel(),h=WebSquare.xml.decode(h).replace("&nbsp;"," ")),!0===this.options.accessibility?this.render.innerHTML=h:this.dom.label&&(this.dom.label.innerHTML=h)}var c=this.getValue();if(i!=c){var d={oldInfo:s,newInfo:this.getInfoArray(),oldValue:i,newValue:c};l.f.fireEvent(this,"onviewchange",d)}!0===t?l.f.fireEvent(this,"onclose",!0):l.f.fireEvent(this,"onclose",!1),this.selectedInfo={},"native"===this.options.renderType&&!0===this.itemTable.inputBlurInside&&(this.itemTable.inputBlurInside=!1)}this._dragGhost&&this._dragGhost.hide()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._originArrInfoHashMap=function(){try{for(var e=this.originArrInfo,t={},i=0;i<e.length;i++)t[e[i].value]=i;return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._originArrHashSortItemArr=function(e){try{for(var t=this._originArrInfoHashMap(),i=0;i<e.length;i++)e[i].value&&(e[i].orgIndex=t[e[i].value]||0);return e.sort((function(e,t){return e.orgIndex-t.orgIndex})),e}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._checkClassification=function(e){try{var t=!1,i=0;if(1==this.options.allOption){i++;var s=document.getElementById(this.id+"_itemTable_0_checkbox");s&&e[0].value===WebSquare.allValue&&(!0===s.checked?t=!0:e.shift())}if(!0!==t){for(var o=[],l=[],n=[],a=0;a<e.length;a++)!0===e[a].checked?(o.push(e[a]),this._deleteSelectedInfo({index:a+i})):l.push(e[a]);if(this._originArrHashSortItemArr(o),this._originArrHashSortItemArr(l),!0===this.options.allOption){var h={label:this.defaultAllOptionLabel,value:WebSquare.allValue};n.push(h)}for(var c=0;c<o.length;c++)n.push(o[c]),this.addSelectedInfo({index:c+i,checked:!0});for(c=0;c<l.length;c++)n.push(l[c])
;this.itemArr=n.slice(0),this.options.enableColumn&&this.refreshEnable()}}catch(e){r.Y.printStackTrace(e)}},d.prototype._sortCheckItemArr=function(){try{var e=this.selectedInfo;if(!0!==n.Z.isEmptyObject(e)){this._checkClassification(this.itemArr),this.setSelectOptions(),this.setItemTable();var t=this.convertInfoHash2Array(e);t.length>0&&this.setSelectedInfoNM(t),this.modelControl.isBinded()&&this.refresh()}}catch(e){r.Y.printStackTrace(e)}},d.prototype.setSelectedInfo=function(e){try{if(this._removeSelectedInfo(e),this.modelControl.isBinded())this.modelControl.setData(this.getInfoValue(e));else{var t=this.getValue();this.setSelectedInfoNM(e)&&t!=this.getValue()&&l.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()})}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._removeSelectedInfo=function(e){try{if(!e||e.length<1)return!1;for(var t=0;t<e.length;t++)!1===e[t].checked&&this.selectedInfo[e[t].index]&&delete this.selectedInfo[e[t].index]}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getInfoValue=function(e){try{for(var t=0;t<this.itemArr.length;t++){var i=this.itemArr[t].checked;if(i){for(var s=null,o=0;o<e.length;o++)if(t==parseInt(e[o].index,10)){s=e[o];break}s||e.push({index:t,checked:i})}}var l=[],n=this.convertInfoArray2Hash(e);for(t=0;t<this.itemArr.length;t++){(s=n[t])&&s.checked&&l.push(this.itemArr[t].value)}return l.join(this.separator)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.convertInfoArray2Hash=function(e){try{for(var t={},i=0;i<e.length;i++)t[e[i].index]=e[i];return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.convertInfoHash2Array=function(e){try{var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.addSelectedInfo=function(e){try{return!(!e||void 0===e.index)&&(this.selectedInfo[e.index]=e,!0)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._deleteSelectedInfo=function(e){try{return!(!e||void 0===e.index)&&(delete this.selectedInfo[e.index],!0)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setSelectedInfoNM=function(e){try{if(!n.Z.isArray(e))return!1;for(var t=0;t<e.length;t++){var i=e[t].index,s=n.Z.getBoolean(e[t].checked);i=parseInt(i);var o=document.getElementById(this.id+"_itemTable_"+i+"_checkbox");o&&(o.checked=s),this.itemArr[i].checked=s}var l="";if(1==this.options.allOption){for(var a=!0,h=document.getElementById(this.id+"_itemTable_0_checkbox"),c=1;c<this.itemArr.length;c++)if(!this.itemArr[c].checked){a=!1;break}if(h&&h.checked!=a&&(h.checked=a),1==this.options.displayAllOptionLabel)if(document.getElementById(this.id+"_itemTable_0_checkbox")){if(h)if(1==h.checked)l=WebSquare.language.getMessage("CheckCombobox_allOption_label")||"choose all";else l=this.getText()}else l=1==a?WebSquare.language.getMessage("CheckCombobox_allOption_label")||"choose all":this.getText();else l=this.getText()}else l=this.getText();return this.options.escape&&(l=this._encode(l)),this.options.customLabelFormatter&&(this.customLabelFormatter=n.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&""==(l=this.customLabelFormatter.call(this,this._getSelectedInfo(),this.isOpen))&&1==this.options.chooseOption&&(l=this._getChooseOptionLabel(),l=WebSquare.xml.decode(l).replace("&nbsp;"," ")),!0===this.options.accessibility?this.render.innerHTML=l:this.dom.label&&(this.dom.label.innerHTML=l),""==l&&1==this.options.chooseOption&&(l=this._getChooseOptionLabel(),l=WebSquare.xml.decode(l).replace("&nbsp;"," "),!0===this.options.accessibility?this.render.innerHTML=l:this.dom.label&&(this.dom.label.innerHTML=l)),(this.options.editable||this.options.useEdit)&&(this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible",this.dom.input.value=l,this.editmode=!1),"title"==this.options.tooltipMode&&(document.getElementById(this.id).title=l),!0
}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setDisplayMode=function(e){try{if("label"==e||"value"==e||"value delim label"==e||"label delim value"==e){var t=this.options.displayMode;this.options.displayMode=e,this._initDisplayMode(),t!=this.options.displayMode&&this._refreshItemTable()}}catch(e){r.Y.printStackTrace(e)}},d.prototype.setDelimiter=function(e){try{this.options.delimiter!=e&&(this.options.delimiter=e||"\t","0"!=this.options.displayMode&&"3"!=this.options.displayMode&&this._refreshItemTable())}catch(e){r.Y.printStackTrace(e)}},d.prototype._refreshItemTable=function(){try{this.isOpen&&this.closeSubLayer(),this.setSelectItemArr();var e=this.getSelectedInfo(),t=this.convertInfoHash2Array(e);"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.itemTable&&this.itemTable.setItemArr(this.itemArr),t.length>0&&this.setSelectedInfo(t)}catch(e){r.Y.printStackTrace(e)}},d.prototype._getChooseOptionLabel=function(){try{var e=this.options.chooseOptionLabel||this.defaultChooseOptionLabel;if(this.options.useLocale&&this.options.chooseOptionLabelLocaleRef){var t=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef);t&&(e=t)}return e}catch(e){r.Y.printStackTrace(e)}},d.prototype.stopRefresh=function(e){try{this.refreshStop=n.Z.getBoolean(e)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.stopRefreshItemTable=function(e){try{this.refreshStopItemTable=n.Z.getBoolean(e)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getSelectedInfo=function(){try{for(var e=this.getItemCount(),t=[],i=0;i<e;i++)this.itemArr[i].checked&&t.push({index:i,label:this.itemArr[i].label,value:this.itemArr[i].value,orgLabel:this.itemArr[i].orgLabel,checked:!0});return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._getSelectedInfo=function(){try{for(var e=this.getItemCount(),t=[],i=0;i<e;i++)if(this.itemArr[i].checked){var s=this.itemArr[i].orgLabel;void 0===s&&(s=this.itemArr[i].label),t.push({index:i,label:s,value:this.itemArr[i].value})}return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getInfo=function(e){try{var t;return this.itemArr.length>e&&((t={}).index=e,t.label=this.itemArr[e].label,t.value=this.itemArr[e].value,t.checked=n.Z.getBoolean(this.itemArr[e].checked)),t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getInfoArray=function(){try{for(var e=[],t=!0,i=0;i<this.itemArr.length;i++){var s={};s.index=i,s.label=this.itemArr[i].label,s.value=this.itemArr[i].value,s.checked=n.Z.getBoolean(this.itemArr[i].checked),e.push(s),!0===this.options.allOptionChecked&&this.itemArr[i].value!==WebSquare.allValue&&this.itemArr[i].label!==this._getChooseOptionLabel()&&!0!==this.itemArr[i].checked&&(t=!1)}return!0===this.options.allOptionChecked&&e[0].value===WebSquare.allValue&&(e[0].checked=t),e}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setValue=function(e){try{if(n.Z.isNull(e))return;var t=this.getValue();if(this.modelControl.isBinded()?this.modelControl.setData(e):1==this.setValueNM(e)&&t!=this.getValue()&&l.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()}),"gridView"===this.itemTableMode)for(var i=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList),s=parseInt(this.itemTable.options.gridViewOptions.checkColumn),o=this.itemTable.gridView.getCellInfo(0,s),a=o.options.trueValue,h=o.options.falseValue,c=1==this.options.allOption?1:0,d=this.itemTable.gridView.getRowCount()-c,u=0;u<d;u++){var m=this.itemTable.gridView._getTdElem(u+c,s);!0===this.itemArr[u+c].checked?(m&&(m.getElementsByTagName("input")[0].checked=!0),this.addSelectedInfo({index:u+c,checked:!0}),i.setCellData(u+c,s,a)):(m&&(m.getElementsByTagName("input")[0].checked=!1),this.addSelectedInfo({index:u+c,checked:!1}),i.setCellData(u+c,s,h))}if(this._getSelectedInfo().length>0&&!0===this.options.showCheckedTop&&null!==this.itemTable&&1==this.setValueNM(e)&&t!=this.getValue()){for(u=0;u<this.getItemCount();u++)if(this.itemArr[u].checked){
var p=document.getElementById(this.id+"_itemTable_"+u+"_checkbox");null!=p&&(p.checked=!0),this.addSelectedInfo({index:u,checked:null==p||p.checked})}this._sortCheckItemArr()}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setValueNM=function(e){try{if(!n.Z.isArray(e)){if(n.Z.isNull(e))return;var t=e.toString();e=t.split(this.separator)}for(var i=[],s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value!=WebSquare.allValue){var l={};l.index=o,l.checked=!1;for(var a=0;a<e.length;a++)if(e[a]==this.itemArr[o].value){l.checked=!0;break}i.push(l)}return this.setSelectedInfoNM(i)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getValue=function(e){try{e||(e=this.separator);for(var t=this.getItemCount(),i=[],s=0;s<t;s++)this.itemArr[s].checked&&i.push(this.itemArr[s].value);return i.join(e).wq_trim()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getValueArray=function(){try{for(var e=this.getItemCount(),t=[],i=0;i<e;i++)this.itemArr[i].checked&&t.push(this.itemArr[i].value);return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setText=function(e){try{for(var t=this.getItemCount(),i=[],s=this._getRangeTextArray(e),o=0;o<t;o++)for(var l=0;l<s.length;l++)if(this.options.useEdit&&this.options.checkTarget){if("both"===this.options.checkTarget){if(this.itemArr[o].orgLabel===s[l]||this.itemArr[o].value===s[l]){i.push(this.itemArr[o].value);break}}else if("value"===this.options.checkTarget){if(this.itemArr[o].value===s[l]){i.push(this.itemArr[o].value);break}}else if("label"===this.options.checkTarget&&(this.itemArr[o].orgLabel===s[l]||this.itemArr[o].label===s[l])){i.push(this.itemArr[o].value);break}}else if(this.itemArr[o].label==s[l]){i.push(this.itemArr[o].value);break}this.setValue(i.join(this.separator))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getText=function(e){try{return this._getRangeText(this.itemArr,this.getItemCount(),e)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._getRangeText=function(e,t,i,s){try{i||(i=this.separator);for(var o,l=[],n=!1,a=!1,h=0;h<t;h++){(s?!0===s[h+"_"]:e[h].checked)?this.options.rangeSeparator?(h-o==1&&h!==t-1?n||(n=!0,l.push(this.options.rangeSeparator),a=!0):(n=!1,l.push(e[h].label)),o=h):l.push(e[h].label):n&&(l.push(e[o].label),n=!1)}var c="";if(a)for(h=0;h<l.length;h++)c+=l[h],h!==l.length-1&&l[h]!==this.options.rangeSeparator&&l[h+1]!==this.options.rangeSeparator&&(c+=i);else c=l.join(i).wq_trim();return c}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getTextArray=function(e){try{for(var t=this.getItemCount(),i=[],s=0;s<t;s++)this.itemArr[s].checked&&i.push(this.itemArr[s].label);return i}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._getRangeTextArray=function(e){try{var t=e.split(this.separator);if(this.options.rangeSeparator&&e.indexOf(this.options.rangeSeparator)>=0){for(var i=[],s=this.getItemCount(),o=0;o<t.length;o++)if(t[o].indexOf(this.options.rangeSeparator)>=0){for(var l=t[o].split(this.options.rangeSeparator),n=NaN,a=NaN,h=0;h<s&&(this.options.checkTarget?"both"===this.options.checkTarget?this.itemArr[h].orgLabel===l[0]||this.itemArr[h].value===l[0]?n=h:this.itemArr[h].orgLabel!==l[1]&&this.itemArr[h].value!==l[1]||(a=h):"value"===this.options.checkTarget?this.itemArr[h].value===l[0]?n=h:this.itemArr[h].value===l[1]&&(a=h):"label"===this.options.checkTarget&&(this.itemArr[h].orgLabel===l[0]||this.itemArr[h].label===l[0]?n=h:this.itemArr[h].orgLabel!==l[1]&&this.itemArr[h].label!==l[1]||(a=h)):this.itemArr[h].label==l[0]?n=h:this.itemArr[h].label==l[1]&&(a=h),isNaN(n)||isNaN(a));h++);for(h=n;h<=a;h++)this.options.checkTarget?"both"===this.options.checkTarget?i.push(this.itemArr[h].orgLabel):"value"===this.options.checkTarget?i.push(this.itemArr[h].value):"label"===this.options.checkTarget&&i.push(this.itemArr[h].orgLabel):i.push(this.itemArr[h].label)}else i.push(t[o]);return i}return t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.addItemArr=function(e,t){try{this.itemArr.push({label:e,
value:t}),this.itemDisabledArray.push(!1)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._addOrgArrInfo=function(e,t){try{for(var i=e,s=this.originArrInfo,o=e;o<s.length;o++)i++,s[o].orgIndex=i;t.orgIndex=e,s.splice(e,0,t)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.addItem=function(e,t,i){try{i=parseInt(i,10),(isNaN(i)||i<0||i>=this.getItemCount())&&(i=this.getItemCount());var s={value:e,label:t};if(!0===this.options.showCheckedTop&&this.itemArr.length>0){this._addOrgArrInfo(i,s);var o=this._getSelectedInfo().length;!0===this.options.allOption&&o++,this.itemArr.splice(o,0,s)}else this.itemArr.splice(i,0,s);if("0"!=this.options.displayMode&&(this.itemArr[i].orgLabel=this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i)),this.itemDisabledArray.splice(i,0,!1),this.options.editable&&this.options.interactionMode){this.viewArr=[];for(var l=0;l<this.itemArr.length;l++)this.viewArr.push({label:this.itemArr[l].label,value:this.itemArr[l].value,orgLabel:this.itemArr[l].orgLabel,index:l})}return this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),this.setValueNM(this.getValue()),i}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.deleteItem=function(e){try{if(e=parseInt(e,10),isNaN(e))return;var t=null;if(e>=0&&e<this.getItemCount()){if(t=this.itemArr.splice(e,1)[0],this.options.editable&&this.options.interactionMode){this.viewArr=[];for(var i=0;i<this.itemArr.length;i++)this.viewArr.push({label:this.itemArr[i].label,value:this.itemArr[i].value,orgLabel:this.itemArr[i].orgLabel,index:i})}this.itemDisabledArray.splice(e,1)}return this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),this.setValueNM(this.getValue()),t}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.removeAll=function(e){try{if(this.itemArr=new Array,e&&(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,noItem:!0}].concat(this.itemArr)),1==this.options.chooseOption)){var t=this._getChooseOptionLabel();this.itemArr=[{label:t,value:this.options.chooseOptionValue,orgLabel:t,noItem:!0}].concat(this.itemArr)}this.setSelectOptions(this.itemArr),this.itemArr.length>0?this.dom.label.innerHTML=this.options.escape?this._encode(this.itemArr[0].label):this.itemArr[0].label:this.dom.label.innerHTML=""}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.onPropertyChange=function(e,t){try{switch(e){case"disabled":var i;if("component"==this.options.renderType||"native"==this.options.renderType)(i=1==this.options.accessibility?document.getElementById(this.id):document.getElementById(this.id+"_label"))&&(i.style.color=t?"#848684":"");var s=this.dom.button;1==t?(this.closeSubLayer(),this.addClass(this.render,"w2checkcombobox_disabled"),null!=s&&this.addClass(s,"w2checkcombobox_button_disabled")):(this.removeClass(this.render,"w2checkcombobox_disabled"),null!=s&&this.removeClass(s,"w2checkcombobox_button_disabled"));break;case"mandatory":1==t?this.addClass(this.render,"w2checkcombobox_mandatory"):this.removeClass(this.render,"w2checkcombobox_mandatory")}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.validate=function(){try{var e=this.validator.validate(this.getValue());return e||this.focus(),e}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.validateObject=function(){try{var e=this.validator.validate(this.getValue()),t={};return e||(this.focus(),this.validator&&this.validator.obfuscator_invalidObject&&(t.callerId=this.validator.obfuscator_invalidObject.callerId,t.type=this.validator.obfuscator_invalidObject.getType(),t.value=this.validator.obfuscator_invalidObject.getValue())),t}catch(e){
r.Y.printStackTrace(e,null,this)}},d.prototype.hide=function(){try{this.closeSubLayer(),a.q.prototype.hide.call(this)}catch(e){r.Y.printStackTrace(e)}},d.prototype.showTooltip=function(e,t,i){try{if(!i)return;null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var s="";this.options.itemTooltipDisplay&&(s="position:absolute;z-index:10000;");var a=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var h=o.I.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(h){var c=n.Z.getGlobalFunction(h,a.scope_id),d=!0;if("function"==typeof c&&(d=c(a)),!d)return}}catch(e){r.Y.printStackTrace(e)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2checkcombobox_tooltip "+this.options.tooltipClass,style:s}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i,this.isFireTooltipEvent||(this.isFireTooltipEvent=!0,l.f.fireEvent(this,"ontooltipshow"))})),1e3*this.options.tooltipTime)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&(this.tooltip.setStyle("display","none"),l.f.fireEvent(this,"ontooltiphide"),this.isFireTooltipEvent=!1)})),1e3*this.options.tooltipTime)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.checkAll=function(e){try{void 0===e&&(e=!0);for(var t=[],i=0;i<this.itemArr.length;i++)this.itemArr[i].value!=WebSquare.allValue&&t.push({index:i,checked:e});return null!=this.itemTable&&1==this.options.allOption&&0!=t.length&&document.getElementById(this.id+"_itemTable_0_checkbox")&&(document.getElementById(this.id+"_itemTable_0_checkbox").checked=!!e),this.setSelectedInfo(t)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setRef=function(e){try{this.modelControl.isBinded()||(this.modelControl.useRef=!0),this.options.ref=e,this.modelControl.setRef(e),this.refresh()}catch(e){r.Y.printStackTrace(e)}},d.prototype.unbindRef=function(){try{this.modelControl.isBinded()&&(this.options.ref="",this.modelControl.unbindRef(),this.refresh())}catch(e){r.Y.printStackTrace(e)}},d.prototype.setInitValue=function(e){try{var t=this.getValue();""===this.options.initValue&&this.itemArr&&this.itemArr[0]&&(this.options.initValue=this.itemArr[0].value),this.setValueNM(this.options.initValue),this.modelControl.setData(this.options.initValue),e.fireEvent&&t!=this.getValue()&&l.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()})}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setItemDisabled=function(e,t){try{if((e=parseInt(e))<0||e>=this.getItemCount()||"gridView"===this.itemTableMode)return;if(t=n.Z.getBoolean(t),this.itemDisabledArray[e]=t,this.itemTable){var i=this.itemTable.getDomList("checkboxArr","input"),s="";s="native"===this.options.renderType?this.itemTable.getDomList("checkboxItemArr","li"):this.itemTable.getDomList("checkboxItemArr","td"),i[e].disabled=t,i[e].itemDisabled=t,1==t?this.addClass(s[e],"w2checkcombobox_item_disabled"):this.removeClass(s[e],"w2checkcombobox_item_disabled")}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getItemDisabled=function(e){try{if((e=parseInt(e))<0||e>=this.getItemCount())return;return this.itemDisabledArray[e]}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleClickEvent=function(e){try{if(this.options.disabled)return!1;if(this.options.editable||this.options.useEdit){this._parent_uuid&&l.f.stopPropagation(e);for(var t=this.event.getTargetIterator(e,this.render);t.next();){
if(t.match("w2checkcombobox_input")&&this.isOpen)return;if(t.match("w2checkcombobox_col_label")||t.match("w2checkcombobox_acc_custom_native_useEditLabel"))return this.isOpen&&!this.options.useEdit?this.closeSubLayer():1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll(),this.changeMode(),void(this.options.useEdit&&this.openSubLayer())}if(this.mozTrickBuffer="",this.editmode=!1,this.options.allOption&&this.getItemDisabled(0)&&this.setItemDisabled(0,!1),!this.options.interactionMode){this.viewArr=[];for(var i=0;i<this.itemArr.length;i++)this.viewArr.push({label:this.itemArr[i].label,value:this.itemArr[i].value,orgLabel:this.itemArr[i].orgLabel,index:i})}"native"===this.options.renderType&&null!==this.itemTable&&null!==this.itemTable.selectedCell&&(this.itemTable.selectedCell=null);var s=this.isOpen;this.setSubLayer(),s==this.isOpen&&(this.itemArr.length>0?this.toggle():1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll()),t=null}else this.focus(),this.itemArr.length>0?this.toggle():1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleKeydownEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode;if(this.options.useEdit&&this.event.isMe(e,this.dom.input))return void(13===t&&this.dom.input.blur());if(this.options.editable){if(this.event.isMe(e,this.dom.input)){if(this.editmode=!0,this.inputKeyDown(e,!1),(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.mozTrickCompare(),n.Z.setInterval(this.mozTrickCompare,{key:this.id+"_mozTrickCompare",caller:this,delay:10})),9==t)if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID)if(l.f.preventDefault(e),i=n.Z.getPreTabbableComp(this.id))return this.endEdit(),this.isOpen&&this.closeSubLayer(),void i.focus(e)}else if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID)if(l.f.preventDefault(e),i=n.Z.getNextTabbableComp(this.id))return this.endEdit(),this.isOpen&&this.closeSubLayer(),void i.focus(e);return}t=e.charCode?e.charCode:e.keyCode;if(o.I.browserCheck.opera){if(18==t&&!this.isOpen)return void this.handleClickEvent(e);if(13==t&&!this.isOpen)return void this.changeMode()}else{if(!(40!=t&&38!=t||this.isOpen))return void this.handleClickEvent(e);if(13==t&&!this.isOpen)return void this.changeMode()}if(9==t)if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(l.f.preventDefault(e),i=n.Z.getPreTabbableComp(this.id)))return this.isOpen&&this.closeSubLayer(),void i.focus(e)}else null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(l.f.preventDefault(e),(i=n.Z.getNextTabbableComp(this.id))&&(this.isOpen&&this.closeSubLayer(),i.focus(e)));if(null!=this.itemTable&&this.viewArr.length>0)1==this.isOpen&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.itemTable.handleKeydownEvent(e),this.editmode=!1;else if(null!=this.itemTable&&""==this.itemTable.render.style.display)return;if(null!=this.itemTable&&""==this.itemTable.render.style.display)return}else{if(13==t||40==t)return void this.handleClickEvent(e);var i;if(9==t)if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(l.f.preventDefault(e),i=n.Z.getPreTabbableComp(this.id)))return void i.focus(e)}else if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(l.f.preventDefault(e),i=n.Z.getNextTabbableComp(this.id)))return void i.focus(e);if(this.isOpen)return}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleKeydownNativeEvent=function(e){try{for(var t=e.charCode?e.charCode:e.keyCode,i=this.event.getTargetIterator(e,this.render);i.next();){if(i.match("w2checkcombobox_acc"))return void(9==t&&(e.shiftKey?this.dom.input&&this.endEdit():this.options.useEdit?(this.showEditMode(!0),
this.changeMode()):this.dom.label.setAttribute("tabIndex",0)));if(i.match("w2checkcombobox_input"))return 9==t&&(this.dom.input.blur(),e.shiftKey||this.dom.button.setAttribute("tabIndex",0)),void(13===t&&this.dom.input.blur());if(i.match("w2checkcombobox_acc_custom_label")&&(this.dom.label.removeAttribute("tabIndex"),this.dom.button.setAttribute("tabIndex",0)),i.match("w2checkcombobox_acc_custom_arrow")){if(9==t){if(e.shiftKey)this.options.useEdit?null!==this.dom.input&&(this.showEditMode(!0),this.changeMode()):this.dom.label.setAttribute("tabIndex",0);else if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID){l.f.preventDefault(e);var s=n.Z.getNextTabbableComp(this.id);if(s)return this.isOpen&&this.closeSubLayer(),void s.focus(e)}}else 13!=t&&40!=t||this.handleClickEvent(e);return}}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleKeyupEvent=function(e){try{if(!this.event.isMe(e,this.dom.input))return;var t;if(e.key)t=e.key;else{var i=e.charCode?e.charCode:e.keyCode;t=String.fromCharCode(i)}if(t===this.options.separator){for(var s=this.getItemCount(),o=[],l=this._getRangeTextArray(this.dom.input.value),n=0;n<s;n++)if(this.itemArr[n].value!==WebSquare.allValue&&this.itemArr[n].value!==this.options.chooseOptionValue){var a={};a.index=n,a.checked=!1;for(var h=0;h<l.length;h++)if(this.options.useEdit&&this.options.checkTarget){if("both"===this.options.checkTarget){if(this.itemArr[n].orgLabel===l[h]||this.itemArr[n].value===l[h]){a.checked=!0;break}}else if("value"===this.options.checkTarget){if(this.itemArr[n].value===l[h]){a.checked=!0;break}}else if("label"===this.options.checkTarget&&(this.itemArr[n].orgLabel===l[h]||this.itemArr[n].label===l[h])){a.checked=!0;break}}else if(this.itemArr[n].label==l[h]){a.checked=!0;break}o.push(a)}for(n=0;n<o.length;n++){var c=o[n].index,d=document.getElementById(this.id+"_itemTable_"+c+"_checkbox");d&&(d.checked=o[n].checked),this.itemArr[c].checked=o[n].checked}}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleFocusEvent=function(e){try{if(l.f.stopEvent(e),(this.options.editable||this.options.useEdit)&&!this.isOpen){var t=document.getElementById(this.id+"_main_tbody");this.addClass(t,"w2checkcombobox_selected"),"onfocus"==this.options.editModeEvent&&this.changeMode()}"native"===this.options.renderType?this.addClass(this.dom.nativeLabel,"w2checkcombobox_focus"):(this.addClass(this.dom.tbody,"w2checkcombobox_focus"),this.addClass("w2checkcombobox_body_focus"))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleClickEventDocument=function(e){try{!this.event.isMe(e,this.render)&&this.options.handleOtherClick&&(null!=this.itemTable&&this.itemTable.inputBlurInside&&this.editmode&&(o.I.setTimer(this.endEdit,{key:this.id+"_handleClickEventDocument",caller:this,delay:1}),this.itemTable.inputBlurInside=!1),this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime),null!=this.itemTable&&0==this.findkeymode?WebSquare.getBody().getLayerListener().isShow(this.id)&&this.closeSubLayer():null!=this.itemTable&&1==this.findkeymode&&(this.findkeymode=!0))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleBlurEvent=function(e){try{l.f.stopEvent(e),"native"===this.options.renderType?this.removeClass(this.dom.nativeLabel,"w2checkcombobox_focus"):(this.removeClass(this.dom.tbody,"w2checkcombobox_focus"),this.removeClass("w2checkcombobox_body_focus"))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleblurEventInput=function(){"none"!=this.dom.input.style.display&&this.options.handleOtherClick&&(null==this.itemTable||null!=this.itemTable&&!this.itemTable.inputBlurInside)&&(this.endEdit(),this.isOpen&&this.closeSubLayer(),"native"===this.options.renderType&&this.showEditMode(!1))},d.prototype.handleMouseoverEvent=function(e){try{if(l.f.stopEvent(e),"native"==this.options.renderType?this.addClass("w2checkcombobox_native_over"):(this.addClass(this.dom.tbody,"w2checkcombobox_over"),
this.addClass("w2checkcombobox_body_over")),!this.isOpen){for(var t=this.event.getTargetIterator(e,this.render);t.next();)if((t.match("w2checkcombobox")||t.match("w2checkcombobox_acc_custom")||t.match("w2checkcombobox_acc_accessibility"))&&(1==this.options.tooltipDisplay||1==this.options.tooltipShowAlways)){var i,s=t.getElement();i=!0===this.options.accessibility?"w2checkcombobox_acc_accessibility":"native"===this.options.renderType?"w2checkcombobox_acc_custom_native_label":"w2checkcombobox_label";var o=this.options.accessibility?s:s.getElementsByClassName(i)[0],n=WebSquare.style.getStyle(o,"text-overflow"),a=this.options.accessibility?o.innerText:this.dom.label.innerHTML;if(!0===this.options.tooltipShowAlways){var h=WebSquare.style.getAbsoluteLeft(s)+20,c=WebSquare.style.getAbsoluteTop(s)+this.render.offsetHeight+3;this.showTooltip(h,c,a)}else if("ellipsis"==n){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),document.body.appendChild(this.toolTipRuler),this.toolTipRuler.className=o.className,this.toolTipRuler.innerHTML=o.innerText,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(o,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(o,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(o,"font-weight");var d=this.toolTipRuler.offsetWidth,u=o.clientWidth;if(3!=o.nodeType){var m=WebSquare.style.getStyle(this.toolTipRuler,"padding-left"),p=WebSquare.style.getStyle(this.toolTipRuler,"padding-right");d-=parseInt(m||"0",10),d-=parseInt(p||"0",10),u-=parseInt(WebSquare.style.getStyle(o,"padding-left"),10),u-=parseInt(WebSquare.style.getStyle(o,"padding-right"),10),u-=parseInt(WebSquare.style.getStyle(s,"padding-left"),10),u-=parseInt(WebSquare.style.getStyle(s,"padding-right"),10)}if(u<d){h=WebSquare.style.getAbsoluteLeft(s)+20,c=WebSquare.style.getAbsoluteTop(s)+this.render.offsetHeight+3;document.body.removeChild(this.toolTipRuler),this.options.tooltipItemLabel&&(a=this.options.tooltipItemLabel),this.showTooltip(h,c,a)}}}t=null}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleMouseoutEvent=function(e){try{l.f.stopEvent(e),1!=this.options.tooltipDisplay&&1!=this.options.tooltipShowAlways||this.hideTooltip(),"native"==this.options.renderType?this.removeClass("w2checkcombobox_native_over"):(this.removeClass(this.dom.tbody,"w2checkcombobox_over"),this.removeClass("w2checkcombobox_body_over"))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleMouseleaveEvent=function(e){try{var t=this.render.offsetHeight-1,i=this.render.offsetWidth-1,s=this.getAbsolutePosition("top"),o=this.getAbsolutePosition("left");this.isOpen&&("up"==this.itemTableDirection?(e.clientX<o||e.clientX>o+i||e.clientY>s||e.clinetY>s+t)&&this.closeSubLayer():(e.clientX<o||e.clientX>o+i||e.clientY<s||e.clinetY>s+t)&&this.closeSubLayer())}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setDisplayAllOptionLabel=function(e){try{if(!this.options.allOption)return;var t=this.options.displayAllOptionLabel,i=n.Z.getBoolean(e);this.options.displayAllOptionLabel=i;var s=document.getElementById(this.id+"_itemTable_0_checkbox");if(t!=i){var o=!0;if(!s||!s.checked)for(var l=1;l<this.getItemCount();l++)if(!this.itemArr[l].checked){o=!1;break}if(!1===o)return;var a="";a=1==i?WebSquare.language.getMessage("CheckCombobox_allOption_label")||"choose all":this.getText(),this.options.escape&&(a=this._encode(a)),this.options.customLabelFormatter&&(this.customLabelFormatter=n.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&(a=this.customLabelFormatter.call(this,this._getSelectedInfo(),this.isOpen)),this.dom.label&&(this.dom.label.innerHTML=a),"title"==this.options.tooltipMode&&(document.getElementById(this.id).title=a)}}catch(e){r.Y.printStackTrace(e,null,this)}},
d.prototype.serialize=function(){return{selectedInfo:this.getSelectedInfo()}},d.prototype.restore=function(e){try{return this.checkAll(!1),this.setSelectedInfo(e.selectedInfo),!0}catch(e){return r.Y.printStackTrace(e,null,this),!1}},d.prototype.changeMode=function(){try{if(this.editmode=!0,this.findStop=!1,"block"!=this.dom.input.style.display){if(this.options.rangeSeparator)return this.dom.input.value=this.getText(),this.showEditMode(!0),void("focus"!=this.options.editType?(this.dom.input.select(),this.setfFocus()):document.activeElement!=this.dom.input&&this.setfFocus());var e="",t=this.options.searchTarget;this.options.useEdit&&this.options.checkTarget&&(t=this.options.checkTarget);var i=this.getCheckedValue(t);i.length>0&&(e=i.join(this.separator).wq_trim());var s=e;if(this.options.useEdit||(s+=" "),"focus"==this.options.editType){this.showEditMode(!0),document.activeElement!=this.dom.input&&this.setfFocus();var o=WebSquare.xml.decode(s);this.dom.input.value=o,(n.Z.isOpera()||n.Z.isFF())&&this.dom.input.setSelectionRange(o.length,o.length)}else this.dom.input.value=WebSquare.xml.decode(s),this.showEditMode(!0),this.dom.input.select(),this.setfFocus()}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getCheckedValue=function(e){try{var t=[];e&&"both"!==e||(e="orgLabel");for(var i=0;i<this.itemArr.length;i++)this.itemArr[i].checked&&t.push(this.itemArr[i][e]);return t}catch(e){r.Y.printStackTrace(e)}},d.prototype.showEditMode=function(e){e?(this.dom.label.style.display="none",this.dom.label.style.visibility="hidden",this.dom.input.style.display="block",this.dom.input.style.visibility="visible"):o.I.setTimer((function(){try{this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible"}catch(e){r.Y.printStackTrace(e)}}),{key:this.id+"_showEditMode",caller:this,delay:1})},d.prototype.setfFocus=function(){try{this.dom.input.focus(),null!=this.itemTable&&(this.itemTable.inputBlurInside=!1)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setDisabled=function(e){try{e=n.Z.getBoolean(e),this.options.disabled=e,this.setProperty("disabled",e),!0===e?this.render.removeAttribute("tabIndex"):this.render.setAttribute("tabIndex",this.options.tabIndex||0)}catch(e){r.Y.printStackTrace(e)}return e},d.prototype.initCheckCombobox=function(){try{this.removeAll(),this.dom.input.value="",this.dummyData=null,this.isOpen&&this.closeSubLayer()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.mozTrickCompare=function(){try{this.dom.input.value!=this.trickBuffer&&(this.trickBuffer=this.dom.input.value,0==this.findStop&&this.inputKeyDown({},!0))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setInputFocus=function(){try{this.changeMode()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.inputKeyDown=function(e,t){try{if(0==t)var i=e.charCode?e.charCode:e.keyCode;if(this.interactionMode){if(this.editmode=!1,0==t)if("default"==this.options.interactionKey||this.isOpen||this.options.interactionEnterKey)if(40!=i||this.isOpen){if(38==i||33==i||40==i||34==i||35==i||36==i)return o.I.browserCheck.chrome||o.I.browserCheck.safari||n.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),this.arrowHandle(e),void(WebSquare.getBody().getLayerListener().isShow(this.id)&&this.itemTable.focus());if(13==i)return void(this.options.interactionEnterKey?this.mytime=this.runSubmission(i):this.enterHandle(e));if(9==i||9==i&&e.shiftKey){if(""==this.dom.input.value||0==this.viewArr.length)return;return this.arrowHandle(e),WebSquare.getBody().getLayerListener().isShow(this.id)&&this.itemTable.focus(),o.I.browserCheck.chrome||o.I.browserCheck.safari||n.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),this.endEdit(),
void(this.isOpen&&this.closeSubLayer())}}else;else this.options.interactionKey;if(!this.options.interactionEnterKey){var s=this;this.mytime=setTimeout((function(){s.runSubmission(i)}),100)}return}if(0==t)if(40!=i||this.isOpen){if(38==i||33==i||40==i||34==i||35==i||36==i)return o.I.browserCheck.chrome||o.I.browserCheck.safari||n.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),this.arrowHandle(e),void(WebSquare.getBody().getLayerListener().isShow(this.id)&&this.itemTable.focus());if(13==i)return void this.enterHandle(e);if(9==i||9==i&&e.shiftKey){if(""==this.dom.input.value||0==this.viewArr.length)return;return this.arrowHandle(e),o.I.browserCheck.chrome||o.I.browserCheck.safari||n.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),void(this.isOpen&&this.closeSubLayer())}}else if(""==this.dom.input.value.wq_trim())return void this.render.click();if(this.itemArr.length>0){s=this;this.mytime=setTimeout((function(){s.find()}),100)}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.arrowHandle=function(e){try{var t=e.charCode?e.charCode:e.keyCode;if(null==this.itemTable)return;var i=this.findinItemArr(this.dom.input.value,this.options.searchTarget);return!this.editmode&&!this.findkeymode||""!=this.dom.input.value&&0!=this.viewArr.length?(9==t||9==t&&e.shiftKey?this.addSelectedInfo({index:i,checked:!0}):this.itemTable.handleKeydownEvent(e),void(this.mozTrickBuffer="")):void l.f.stopEvent(e)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.find=function(){try{var e=this.dom.input.value;if(""==e)return this.mozTrickBuffer=e,void(null!=this.itemTable&&this.closeSubLayer());if(this.mozTrickBuffer==e)return void(this.mozTrickBuffer=e);this.mozTrickBuffer=e,this.isOpen&&this.closeSubLayer(),this.viewArr=[],this.options.caseSensitive||(e=e.toLowerCase());for(var t=0;t<this.itemArr.length;t++)if(!this.itemArr[t].noItem){var i=!1;if(this.itemArr[t].orgLabel||(this.itemArr[t].orgLabel=this.itemArr[t].label,this.itemArr[t].label=this.getItemText(t)),!i&&("label"==this.options.searchTarget||"both"==this.options.searchTarget||"all"==this.options.searchTarget)){var s=this.options.caseSensitive?this.itemArr[t].orgLabel:this.itemArr[t].orgLabel.toLowerCase();"all"==this.options.searchTarget&&(s=this.options.caseSensitive?this.itemArr[t].label:this.itemArr[t].label.toLowerCase()),"contain"==this.search?i=this.myhelper.containWith(s,e):"start"==this.search?i=this.myhelper.startWith(s,e):"none"==this.search&&(i=s==e)}if(!i&&("value"==this.options.searchTarget||"both"==this.options.searchTarget||"all"==this.options.searchTarget)){var o=this.options.caseSensitive?this.itemArr[t].value:this.itemArr[t].value.toLowerCase();"contain"==this.search?i=this.myhelper.containWith(o,e):"start"==this.search?i=this.myhelper.startWith(o,e):"none"==this.search&&(i=o==e)}var l=this.itemArr[t].label;if(this.options.useKeywordHighlight){var n=l.indexOf(this.mozTrickBuffer);n>=0&&(l=l.substring(0,n)+"<span class='w2checkcombobox_keyword'>"+this.mozTrickBuffer+"</span>"+l.substring(n+this.mozTrickBuffer.length,l.length))}i&&this.viewArr.push({value:this.itemArr[t].value,label:l,orgLabel:this.itemArr[t].orgLabel,index:t})}if(this.options.disabled)return!1;this.viewArr.length>0?this.isOpen||(1==this.options.allOption&&(this.viewArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,index:0,noItem:!0}].concat(this.viewArr),this.setItemDisabled(0,!0)),this.openSubLayer({select:!1})):this.closeSubLayer()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.getFormattedValue=function(e,t){try{var i=t;if(this.options.displayFormatter){if(!this.displayFormatter){this.fixedIndex=-1,1==this.options.allOption&&this.fixedIndex++,1==this.options.chooseOption&&this.fixedIndex++;try{
var s=n.Z.getGlobalFunction(this.options.displayFormatter,this.scope_id);"function"==typeof s&&(this.displayFormatter=s)}catch(e){r.Y.printStackTrace(e)}}this.displayFormatter&&e>this.fixedIndex&&(i=this.displayFormatter(t))}return i}catch(e){r.Y.printStackTrace(e)}},d.prototype.enterHandle=function(e){try{var t,i=this.dom.input.value;l.f.fireEvent(this,"oneditend",i);var s=n.Z.getDataPrefix("index");if((null==this.itemTable||null==this.itemTable.selectedCell)&&(null==this.itemTable&&this.setSubLayer(),null==this.itemTable.selectedCell)){var a=this.findinItemArr(this.dom.input.value,this.options.searchTarget);if("clear"===this.noResult);else if("previous"===this.noResult)void 0===a||this.addSelectedInfo({index:a,checked:!0});else if("noEnd"===this.noResult){if(void 0===a)return;this.addSelectedInfo({index:a,checked:!0})}else"useData"===this.noResult||"first"===this.noResult&&(this.viewArr.length>0?(null==a?(this.selectedInfo={},t=this.findinItemArr(this.viewArr[0].value,"value")):t=a,this.addSelectedInfo({index:t,checked:!0})):0!=this.dom.input.value&&void 0!==this.findinItemArr(this.dom.input.value,"value")||this.itemArr.length>0&&(this.selectedInfo={},t=this.findinItemArr(this.itemArr[0].value,"value"),this.addSelectedInfo({index:t,checked:!0})))}if(o.I.browserCheck.opera&&l.f.stopEvent(e),this.mozTrickBuffer="",null!=this.itemTable.selectedCell)if(t=this.findinItemArr(this.dom.input.value,this.options.searchTarget),"clear"===this.noResult);else if("previous"===this.noResult)1==this.interactionMode?void 0===t&&(this.selectedInfo={}):(void 0===t&&void 0===(t=this.itemTable.selectedCell.index)&&(t=this.itemTable.selectedCell.getAttribute(s)),this.addSelectedInfo({index:t,checked:!0}));else if("noEnd"===this.noResult){if(void 0===t)return;this.addSelectedInfo({index:t,checked:!0})}else"useData"===this.noResult||"first"===this.noResult&&(this.viewArr.length>0?(null==t&&(t=this.findinItemArr(this.viewArr[0].value,"value")),this.addSelectedInfo({index:t,checked:!0})):0!=this.dom.input.value&&void 0!==this.findinItemArr(this.dom.input.value,"value")||this.itemArr.length>0&&(t=this.findinItemArr(this.itemArr[0].value,"value"),this.selectedInfo={},this.addSelectedInfo({index:t,checked:!0})));this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime),this.showEditMode(!1),this.focus(),this.closeTable()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.findinItemArr=function(e,t){try{for(var i=t||"label",s=0;s<this.itemArr.length;s++)if("value"===i){if(e==this.itemArr[s].value)return s}else if("label"===i){if(1==this.options.displayMode||2==this.options.displayMode){if(e==this.itemArr[s].orgLabel)return s}else if(e==this.itemArr[s].label)return s}else if("both"===i){if(e==this.itemArr[s].orgLabel||e==this.itemArr[s].value)return s}else if("all"===i&&e==this.itemArr[s].orgLabel+"|"+this.itemArr[s].value)return s;if(this.dummyData&&("value"===i&&this.dummyData.value||"label"===i&&e===this.dummyData.label||"all"===i&&e===this.dummyData.label+"|"+this.dummyData.value))return NaN}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.runSubmission=function(e){try{var t=!0,i=this.dom.input.value,s=n.Z.getStringByteSize(i);if(this.options.interactionMinByteLength>0&&this.options.interactionMinByteLength>s&&(t=!1),"false"!=this.options.allowEmptySubmission&&""==i||"default"==this.options.interactionKey&&this.mozTrickBuffer==i&&(t=!1),t)if(this.mozTrickBuffer=i,""!=this.options.submissionFunc.wq_trim()){var o=n.Z.getGlobalFunction(this.options.submissionFunc,this.scope_id);"function"==typeof o&&o(i,e)}else if(""!=this.options.submission.wq_trim()){var l="<key>"+WebSquare.xml.encode(i)+"</key>";WebSquare.WebSquaredoc.models[0].rebuild(WebSquare.xml.parse(l),this.options.keyInputRef),WebSquare.WebSquaredoc.models[0].refresh(),WebSquare.ModelUtil.executeSubmission(this.options.submission)}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setItemSet=function(e,t,i){try{
void 0===this.itemsetObj&&(this.itemsetObj={});var s=!1;t==this.itemsetObj.label&&i==this.itemsetObj.value||(s=!0),this.itemsetObj.nodeset=e,s&&(this.itemsetObj.label=t,this.itemsetObj.value=i),this.buildItemArr();for(var l=0;l<this.itemArr.length;l++)this.itemArr[l].orgLabel=this.itemArr[l].label,this.itemArr[l].label=this.getItemText(l);if(this.options.interactionMode){if(o.I.clearTimer(this.id+"_showEditMode",!0),1==this.options.allOption&&this.itemArr.length>0&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,noItem:!0}].concat(this.itemArr)),1==this.options.chooseOption){t=this._getChooseOptionLabel();this.itemArr=[{label:t,value:this.options.chooseOptionValue,orgLabel:t,noItem:!0}].concat(this.itemArr)}this.viewArr=[];for(l=0;l<this.itemArr.length;l++){var n=this.itemArr[l].label;if(this.options.useKeywordHighlight){var a=n.indexOf(this.mozTrickBuffer);a>=0&&(n=n.substring(0,a)+"<span class='w2checkcombobox_keyword'>"+this.mozTrickBuffer+"</span>"+n.substring(a+this.mozTrickBuffer.length,n.length))}this.viewArr.push({label:n,orgLabel:this.itemArr[l].orgLabel,value:this.itemArr[l].value,index:l})}}else{if(1==this.options.chooseOption){t=this._getChooseOptionLabel();this.itemArr=[{label:t,value:this.options.chooseOptionValue,orgLabel:t,noItem:!0}].concat(this.itemArr)}this.viewArr=[];for(l=0;l<this.itemArr.length;l++)this.viewArr.push({label:this.itemArr[l].label,value:this.itemArr[l].value,orgLabel:this.itemArr[l].orgLabel,index:l})}var h=this.getCheckedValue(this.options.searchTarget),c="";h.length>0&&(c=h.join(this.separator).wq_trim()),this.itemArr.length>0?!0===this.options.accessibility?this.render.innerHTML=c:this.dom.label.innerHTML=c:!0===this.options.accessibility?this.render.innerHTML="":this.dom.label.innerHTML=""}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.buildItemArr=function(){try{this.modelControl.setItemset(this.itemsetObj.nodeset,this.itemsetObj.label,this.itemsetObj.value),this.itemArr=[],this.itemsetObj.nodeset.match("data:")?(this.itemArr=this.modelControl.getDataCollectionItemsetData(this.id),this.allItemArr=this.modelControl.getDataCollectionItemsetData(this.id,{allData:!0})):this.itemArr=this.modelControl.getItemsetData(),this.options.useLocale&&!1!==this.options.useItemLocale&&(this.itemArr=this.getLocaleItemArr(this.itemArr),this.allItemArr=this.getLocaleItemArr(this.allItemArr))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.closeTable=function(){try{this.closeSubLayer()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.openTable=function(){try{this.showTable()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.endEdit=function(){try{var e=this.dom.input.value;if(l.f.fireEvent(this,"oneditend",e),this.options.useEdit)return void this.setText(e);this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime),this.showEditMode(!1),this.mozTrickBuffer="",(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0,n.Z.clearInterval(this.id+"_mozTrickCompare"))}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.showTable=function(){try{this.openSubLayer({select:!1})}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setGridViewData=function(){try{var e=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList),t=this.gridViewOptions.dataComp.filterManager.filterArr;if(t)for(var i=0;i<t.length;i++)e.setColumnFilter({type:t[i].options.type,colIndex:t[i].options.colIndex,key:t[i].options.key,condition:t[i].options.condition});if(this.options.allOption){var s=e.getAllData(),o=WebSquare.language.getMessage("CheckCombobox_all")||"choose all";if(s[0]!=o){for(var l=[],n=-1,a=0;a<e.cellIdList.length;a++)-1==n&&e.cellIdList[a]==this.itemsetObj.label&&(n=a),l.push("");this.labelColumn=-1==n?0:n,l[this.labelColumn]=this.defaultAllOptionLabel,e.setRowData(0,l,!1)}}
var h=this.gridViewItemArr.length>0&&this.itemTable.gridView.delayedDrawObj&&this.itemTable.render&&"none"===this.itemTable.render.style.display;h&&this.itemTable.show(),this.itemTable.gridView.notifyDataChanged({keepTop:!0}),h&&this.itemTable.hide()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._closeOtherLayer=function(e){try{var t=(e=e||{}).documentClick,i=this.otherComponent;if("grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(i=this.itemTable),this.isOpen&&null!=i){i.hide(),this.removeClass("w2checkcombobox_open");var s=this.getValue(),o=this.getInfoArray(),n=this.convertInfoHash2Array(this.selectedInfo);n.length>0&&this.setSelectedInfo(n),this.isOpen=!1;var a=this.getValue();if(s!=a){var h={oldInfo:o,newInfo:this.getInfoArray(),oldValue:s,newValue:a};l.f.fireEvent(this,"onviewchange",h)}this.isOpen=!1,!0===t?l.f.fireEvent(this,"onclose",!0):l.f.fireEvent(this,"onclose",!1),this.selectedInfo={}}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._openOtherLayer=function(){try{if("gridView"==this.itemTableMode&&this.gridViewItemArr.length<=0)return;var e,t=this.otherComponent;if("grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(this.setSubLayer(),t=this.itemTable),!this.isOpen){t.setPosition(0,0),t.show();var i=0;this.options.navBtn&&(e=this.itemTable.getElementById(this.id+"_btnArea"))&&(i=e.getBoundingClientRect().height,e.style.width=this.itemTable.render.clientWidth+"px"),"grid"==this.itemTableMode?this.itemTable.render.style.height=parseFloat(this.itemTable.grid.render.style.height)+i+"px":"gridView"==this.itemTableMode&&(this.itemTable.render.style.height=parseFloat(this.itemTable.gridView.render.style.height)+i+"px"),this.addClass("w2checkcombobox_open");var s=WebSquare.style.getAbsoluteLeft(this.render),o=WebSquare.style.getAbsoluteTop(this.render),l=this.options.direction;if("auto"==l){var n=document.body.scrollTop;n<document.documentElement.scrollTop&&(n=document.documentElement.scrollTop);var a=o-n,h=document.documentElement.clientHeight-(a+this.render.offsetHeight),c=t.render.offsetHeight;h<c&&a>c&&(l="up")}"up"==l?o-=t.render.offsetHeight:o+=this.render.offsetHeight,document.documentElement.clientWidth<s+t.render.offsetWidth&&(s=s+this.render.offsetWidth-t.render.offsetWidth),"auto"==this.options.submenuSize&&"gridView"==this.itemTableMode&&(s=WebSquare.style.getAbsoluteLeft(this.render),this.gridViewOptions.width||(t.render.style.width=this.render.offsetWidth+"px")),t.render.style.left=s+"px",t.render.style.top=o+"px",this.isOpen=!0,this.itemTableDirection=l,WebSquare.style.adjustZIndex(this.uuid,t.uuid,"itemTable")}if("grid"==this.itemTableMode)null!=this.targetFocusedIndex?d=this.targetFocusedIndex:-1==(d=this.itemTable.grid.getFocusedRowIndex())&&(d=0),this.itemTable.grid.setFocusedCell(d,0),this.targetFocusedIndex=null;else if("gridView"==this.itemTableMode){var d;null!=this.targetFocusedIndex?d=this.targetFocusedIndex:-1==(d=this.itemTable.gridView.getFocusedRowIndex())&&(d=0),this.itemTable.gridView.setFocusedCell(d,0),this.targetFocusedIndex=null}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.setVisibleRowNum=function(e){try{this.options.visibleRowNum=e,this._closeSubLayer()}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._clearVisibleColumnChecked=function(){try{for(var e=!1,t=0;t<this.itemArr.length;t++){var i=this.itemArr[t];!0===i._hidden&&!1!==i.checked&&(i.checked=!1,e=!0)}if(e){var s=this.getValue();this.modelControl.isBinded()&&this.modelControl.setData(s),this.setValueNM(s)}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype._encode=function(e){var t=e;try{var i="<span class='w2checkcombobox_keyword'>",s="</span>",o=e.indexOf(s,38);return t=this.options.useKeywordHighlight&&o>=0&&e.slice(0,38)===i&&e.slice(o,o+7)===s?i+WebSquare.xml._encode(e.slice(38,o))+s+WebSquare.xml._encode(e.slice(o+7)):WebSquare.xml._encode(e)}catch(e){return r.Y.printStackTrace(e,null,this),t}},d.prototype.handleItemtableMousedown=function(e){try{
for(var t=this.itemTable.event.getTargetIterator(e),i=n.Z.getDataPrefix("row"),s=n.Z.getDataPrefix("col");t.next();)if("native"!==this.options.renderType&&t.match(this.itemTable.options.w2table_col,null,"td")||"native"===this.options.renderType&&t.match(this.itemTable.options.w2table_col,null,"li")){var o=t.getElement(),a=l.f.getMouseX(e),h=l.f.getMouseY(e);this._currentTarget={row:parseInt(o.getAttribute(i),10),col:parseInt(o.getAttribute(s),10),mouseX:a,mouseY:h,selectedIndex:{},shiftKey:e.shiftKey},this._dragGhost.setPosition(a,h),this._dragGhost.show();var c={passive:!1};return n.Z.emptySelection(),l.f.preventDefault(e),1==n.Z.isTouchDevice()&&(this.itemTable.event.addListener(document.documentElement,"ontouchmove",this.itemTable.event.bindAsEventListener(this,this.handleItemtableMousemove),c),this.itemTable.event.addListener(document.documentElement,"ontouchend",this.itemTable.event.bindAsEventListener(this,this.handleItemtableMouseup),c)),this.itemTable.event.addListener(document.documentElement,"onmousemove",this.itemTable.event.bindAsEventListener(this,this.handleItemtableMousemove),c),void this.itemTable.event.addListener(document.documentElement,"onmouseup",this.itemTable.event.bindAsEventListener(this,this.handleItemtableMouseup),c)}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleItemtableMousemove=function(e){try{if(!this._currentTarget)return;var t=l.f.getMouseX(e),i=l.f.getMouseY(e),s=t-this._currentTarget.mouseX,o=i-this._currentTarget.mouseY,a=s>0?0:s,h=o>0?0:o;(a<0||h<0)&&this._dragGhost.setPosition(this._currentTarget.mouseX+a,this._currentTarget.mouseY+h),this._dragGhost.setSize(Math.abs(s),Math.abs(o));for(var c=l.f.getTarget(e),d=this.itemTable.event.getTargetIterator(e),u=n.Z.getDataPrefix("row"),m=n.Z.getDataPrefix("col");d.next();)if("native"!==this.options.renderType&&d.match(this.itemTable.options.w2table_col,null,"td")||"native"===this.options.renderType&&d.match(this.itemTable.options.w2table_col,null,"li")){c=d.getElement();for(var p=parseInt(c.getAttribute(u),10),b=parseInt(c.getAttribute(m),10),f=c.parentNode.childNodes.length,g=p-this._currentTarget.row,y=b-this._currentTarget.col,v=Math.abs(g),T=Math.abs(y),k={},A=0;A<=v;A++)for(var _=0;_<=T;_++){var S,w;S=g>0?this._currentTarget.row+A:this._currentTarget.row-A,w=y>0?this._currentTarget.col+_:this._currentTarget.col-_;var I=-1;if(k[I="native"===this.options.renderType?S:S*f+w]=!0,!this._currentTarget.selectedIndex[I])(C=document.getElementById(this.itemTable.id+"_"+I))&&C.firstChild&&C.firstChild.checked===this._currentTarget.shiftKey&&C.click()}for(var x in this._currentTarget.selectedIndex){var C;if(!k[x])(C=document.getElementById(this.itemTable.id+"_"+x))&&C.click()}this._currentTarget.selectedIndex=k,d.stop()}}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleItemtableMouseup=function(e){try{this._currentTarget=null,this._dragGhost.setSize(0,0),this._dragGhost.hide(),1==n.Z.isTouchDevice()&&(this.itemTable.event.removeEvent(document.documentElement,"ontouchmove"),this.itemTable.event.removeEvent(document.documentElement,"ontouchend")),this.itemTable.event.removeEvent(document.documentElement,"onmousemove"),this.itemTable.event.removeEvent(document.documentElement,"onmouseup")}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.handleInputValidator=function(e){try{var t=this.dom.input.value,i=this.validator.validateKeyInput(this.dom.input,t,e);if(i.valid){if(t!==i.str){var s=WebSquare.text.getCaretPos(this.dom.input);n.Z.isIEAllVersion()||(s-=t.length-i.str.length),this.dom.input.value=i.str,WebSquare.text.setCaretPos(this.dom.input,s)}}else l.f.stopEvent(e)}catch(e){r.Y.printStackTrace(e,null,this)}},d.prototype.refreshEnable=function(){try{for(var e=this.getItemCount(),t=0;t<e;t++)this.itemArr[t]&&!0===this.itemArr[t]._disabled?this.setItemDisabled(t,!0):this.setItemDisabled(t,!1)}catch(e){r.Y.printStackTrace(e,null,this)}}}}]);