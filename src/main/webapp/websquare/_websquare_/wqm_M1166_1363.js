"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[1363],{1363:(e,t,i)=>{i.r(t),i.d(t,{treeview:()=>u});var s=i(582),o=i(2536),n=i(2710),l=i(9107),a=i(1263),h=i(2327),r=i(7249),d=i(8713),c=function(){this.index=-1,this.id="",this.label="",this.orgLabel="",this.value="",this.element=null,this.depth=-1,this.parentNode=null,this.childNodes=[],this._isRoot=null,this._hasChild=null,this._isLastChild=null,this.image="",this.selectedImage="",this.expandedImage="",this.checked=!1,this.folder=!1};c.prototype.appendChild=function(e){if(!e)return!1;var t=this;do{if(e==t)return!1;t=t.parentNode}while(t);return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=this,this.childNodes.push(e),!0},c.prototype.removeChild=function(e){if(e){for(var t=[],i=0;i<this.childNodes.length;i++){var s=this.childNodes[i];s!=e&&t.push(s)}this.childNodes=t}},c.prototype.isRoot=function(){return this._isRoot=null,this._isRoot=null==this.parentNode,this._isRoot},c.prototype.hasChild=function(){return this._hasChild=null,this.folder?this.folder:(this._hasChild=0!=this.childNodes.length,this._hasChild)},c.prototype.isLeaf=function(){return!this.hasChild()},c.prototype.isFirstChild=function(){var e=!1;return this.parentNode?(this.parentNode.childNodes[0]&&this===this.parentNode.childNodes[0]&&(e=!0),e):e},c.prototype.isLastChild=function(){if(this._isLastChild=null,!this.parentNode)return!0;var e=this.parentNode.childNodes;return e[e.length-1]==this&&(this._isLastChild=!0),1!=this._isLastChild&&(this._isLastChild=!1),this._isLastChild},c.prototype.isFirstChildByRoot=function(){var e=!1;return this.parentNode?(0!=this.parentNode.depth||this.parentNode.childNodes[0]&&this===this.parentNode.childNodes[0]&&(e=!0),e):e},(c.nodeIterator=function(e,t){this.node=e,this.status=0,this.options=s.q.extend({type:"dfs",pruning:null},s.q.extend({},t)),this.stack=[]}).prototype.next=function(){return!!this.node&&(0==this.status?(this.status=1,!0):("dfs"==this.options.type?(this.stack=this.node.childNodes.concat(this.stack),this.node=this.stack.shift()):"bfs"==this.options.type&&(this.stack=this.stack.concat(this.node.childNodes),this.node=this.stack.shift()),!!this.node))},c.nodeIterator.prototype.stop=function(){this.status=2},c.nodeIterator.prototype.getNode=function(){return this.node};var p=function(){this.nodeCount=0,this.rootNode=null,this.hash_index_node={},this.useXPath=!1,this.useCheckbox=!1,this.useImage=!1;var e="w2:";this.xpath={nodeset:"",label:e+"label",value:e+"value",depth:e+"depth",nodeName:e+"node",checkbox:"",folder:e+"folder"},this.dataPath={},this.imageXPath={image:"",iconImage:"",leafImage:"",selectedImage:"",expandedImage:""},this.checkbox={xpath:"",trueValue:"",falseValue:"",checkboxDisabled:"",checkboxDisabledTrueValue:"",checkboxDisabledFalseValue:"",checkboxDisabledAll:""},this.valueAttribute="",this.displayMode="0",this.delimiter="\t",this.customFormatter="",this.treeView="",this.isInstance=!1};p.prototype.getNodeset=function(){if(""!=this.xpath.nodeset)return this.xpath.nodeset},p.prototype.setXPath=function(e,t,i,s,o,n,l){""!=e&&(this.useXPath=!0,this.xpath.nodeset=e,this.xpath.label=t,this.xpath.value=i,this.xpath.depth=s,this.xpath.nodeName=o,this.xpath.folder=n,this.xpath.auth=l)},p.prototype.setDataPath=function(e,t,i,s,o,n){this.dataPath.label=e,this.dataPath.value=t,this.dataPath.depth=i,this.dataPath.nodeName=s,this.dataPath.folder=o,this.dataPath.checkbox=n},p.prototype.setCheckbox=function(e,t,i,s,o,n,l,a,h,r,d){""!=e&&(this.useCheckbox=!0,this.checkbox.xpath=e,this.checkbox.trueValue=t,this.checkbox.falseValue=i,this.checkbox.checkboxDisabled=s,this.checkbox.checkboxDisabledTrueValue=o,this.checkbox.checkboxDisabledFalseValue=n,this.checkbox.checkboxDisabledAll=l,this.checkbox.refreshCheckboxModel=a,this.checkbox.refreshCheckboxDisableModel=h,this.checkbox.hierarchy=r,this.checkbox.colID=d)},p.prototype.setDisplayMode=function(e,t){this.displayMode=e,this.delimiter=t},
p.prototype.setImage=function(e,t,i,s,o,n){this.useImage=!0,this.imageXPath.image=e||"",this.imageXPath.iconImage=t||"",this.imageXPath.leafImage=i||"",this.imageXPath.selectedImage=s||"",this.imageXPath.expandedImage=o||"",this.imageXPath.imageTitle=n||""},p.prototype.setXML=function(e){e&&(this.nodeCount=0,this.rootNode=null,this.hash_index_node={},1==this.isInstance?(this.rootNode=this.parseNodeInstance(e,0,0),1==this.useImage&&this.parseImageInstance(this.rootNode)):(this.rootNode=this.parseNode(e,0,0),1==this.useImage&&this.parseImage(this.rootNode)))},p.prototype.appendXML=function(e,t){if(e){var i=this.findNodeByIndex(t),s=i.element,o=1;if(1==this.isInstance){for(var n=e.firstChild;null!=n;n=e.firstChild)1==n.nodeType&&n.tagName==this.xpath.nodeName&&i.appendChild(this.parseNodeInstance(n,i.depth+1,o++,i)),s.appendChild(e.removeChild(n));1==this.useImage&&this.parseImageInstance(i)}else{for(var l=e.getChildNodes(),a=0;a<l.length;a++)1==(n=l[a]).nodeType&&n.getTagName()==this.xpath.nodeName&&i.appendChild(this.parseNode(n,i.depth+1,o++,i)),s.appendChild(e.removeChild(n));1==this.useImage&&this.parseImage(i)}return i}},p.prototype.parseNodeInstance=function(e,t,i,s){if(!e)return null;var o=WebSquare.xml.getValue(e,this.xpath.label).wq_trim(),n=!1,l=this.xpath.auth&&WebSquare.xml.getValue(e,this.xpath.auth).wq_trim();if(this.xpath.folder){var a=WebSquare.xml.getValue(e,this.xpath.folder).wq_trim();this.treeview&&this.treeview.options&&this.treeview.options.trueValue&&(n=a==this.treeview.options.trueValue),"true"!=a.toLowerCase()&&"false"!=a.toLowerCase()||(n="true"==a)}for(var h="",r=this.xpath.value.split(" "),d=0;d<r.length;d++)0!=d&&(h+="$$"),h+=WebSquare.xml.getValue(e,r[d]).wq_trim();var p=new c;switch(p.index=this.nodeCount++,p.depthIndex=i,this.displayMode){case"0":default:p.label=o;break;case"1":p.label=h+this.delimiter+o;break;case"2":p.label=o+this.delimiter+h}if(p.orgLabel=p.label,p.value=h,p.element=e,p.depth=t,p.folder=n,p.auth=l,1==t?this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset:t>1&&("recursive"==this.dataType?this.xpath.value?p.xpath=s.xpath+"/"+this.xpath.nodeName+"["+this.xpath.value+"='"+p.value+"']":p.xpath=s.xpath+"/"+this.xpath.nodeName:this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset),1==this.useCheckbox){var u=WebSquare.xml.getValue(e,this.checkbox.xpath).wq_trim();if(p.checkboxXPath=p.xpath+"/"+this.checkbox.xpath,u==this.checkbox.trueValue?(p.checked=!0,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.trueValue)):(p.checked=!1,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){p.checkboxDisableXPath=p.xpath+"/"+this.checkbox.checkboxDisabled;var f=WebSquare.xml.getValue(e,this.checkbox.checkboxDisabled).wq_trim();1==this.checkbox.checkboxDisabledAll?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue)),f==this.checkbox.checkboxDisabledTrueValue?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):f==this.checkbox.checkboxDisabledFalseValue&&(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue))}}for(var g=1,m=e.firstChild;null!=m;m=m.nextSibling)1==m.nodeType&&m.tagName==this.xpath.nodeName&&p.appendChild(this.parseNodeInstance(m,t+1,g++,p));if(1==this.useCheckbox&&1==this.checkbox.hierarchy){var b=0,v=!1
;for(d=0;d<p.childNodes.length;d++){var x=p.childNodes[d];1==x.checked?b++:1==x.partial&&(v=!0)}1==v||0<b&&b<p.childNodes.length?p.partial=!0:b>0&&b==p.childNodes.length?(p.checked=!0,p.checkboxDom||(p.checkboxDom=document.getElementById(this.treeview.id+"_checkbox_"+p.index)),p.checkboxDom&&(p.checkboxDom.checked=!0)):p.partial=!1}if(this.hash_index_node[p.index]=p,"function"==typeof this.customFormatter){var _=this.customFormatter,w=this.getCloneNode(p),y=_.call(this.treeview,p.orgLabel,p.label,w)||p.label;p.label=y}return p},p.prototype.parseNode=function(e,t,i,s){if(!e)return null;var o=WebSquare.jsonUtil.getValue(e._element,this.xpath.label,this.valueAttribute),n=!1,l=this.xpath.auth&&WebSquare.jsonUtil.getValue(e._element,this.xpath.auth,this.valueAttribute);if(this.xpath.folder){var a=WebSquare.jsonUtil.getValue(e._element,this.xpath.folder,this.valueAttribute);this.treeview&&this.treeview.options&&this.treeview.options.trueValue&&(n=a==this.treeview.options.trueValue),"true"!=a.toLowerCase()&&"false"!=a.toLowerCase()||(n="true"==a)}for(var h="",r=this.xpath.value.split(" "),d=0;d<r.length;d++)0!=d&&(h+="$$"),h+=WebSquare.jsonUtil.getValue(e._element,r[d],this.valueAttribute);var p=new c;switch(p.index=this.nodeCount++,p.depthIndex=i,this.displayMode){case"0":default:p.label=o;break;case"1":p.label=h+this.delimiter+o;break;case"2":p.label=o+this.delimiter+h}if(p.orgLabel=p.label,p.value=h,p.element=e,p.depth=t,p.folder=n,p.auth=l,1==t?this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset:t>1&&("recursive"==this.dataType?this.xpath.value?p.xpath=s.xpath+"/"+this.xpath.nodeName+"["+this.xpath.value+"='"+p.value+"']":p.xpath=s.xpath+"/"+this.xpath.nodeName:this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset),1==this.useCheckbox){var u=WebSquare.jsonUtil.getValue(e._element,this.checkbox.xpath,this.valueAttribute);if(p.checkboxXPath=p.xpath+"/"+this.checkbox.xpath,u==this.checkbox.trueValue?(p.checked=!0,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.trueValue)):(p.checked=!1,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){p.checkboxDisableXPath=p.xpath+"/"+this.checkbox.checkboxDisabled;var f=WebSquare.jsonUtil.getValue(e._element,this.checkbox.checkboxDisabled,this.valueAttribute);1==this.checkbox.checkboxDisabledAll?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue)),f==this.checkbox.checkboxDisabledTrueValue?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):f==this.checkbox.checkboxDisabledFalseValue&&(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue))}}var g=1,m=e.getChildNodes();for(d=0;d<m.length;d++){var b=m[d];1==b.nodeType&&b.getTagName()==this.xpath.nodeName&&p.appendChild(this.parseNode(b,t+1,g++,p))}if(1==this.useCheckbox&&1==this.checkbox.hierarchy){var v=0,x=!1;for(d=0;d<p.childNodes.length;d++){var _=p.childNodes[d];1==_.checked?v++:1==_.partial&&(x=!0)}1==x||0<v&&v<p.childNodes.length?p.partial=!0:v>0&&v==p.childNodes.length?(p.checked=!0,p.checkboxDom||(p.checkboxDom=document.getElementById(this.treeview.id+"_checkbox_"+p.index)),p.checkboxDom&&(p.checkboxDom.checked=!0)):p.partial=!1}if(this.hash_index_node[p.index]=p,"function"==typeof this.customFormatter){
var w=this.customFormatter,y=this.getCloneNode(p),I=w.call(this.treeview,p.orgLabel,p.label,y)||p.label;p.label=I}return p},p.prototype.parseNodeByNode=function(e,t,i,s){if(!e)return null;var o=new c;o.index=this.nodeCount++,o.depthIndex=i,o.label=e.label,o.orgLabel=o.label,o.value=e.value,o.element=e.element.cloneNode(!0),o.depth=t,o.folder=e.folder,o.xpath="",o.checkboxXPath="",o.imageTitle=e.imageTitle,o.labelStyle=e.labelStyle,void 0!==e.checked&&(o.checked=e.checked),o.checkboxDisableXPath="",void 0!==e.checkboxDisabled&&(o.checkboxDisabled=e.checkboxDisabled);for(var n=1,l=0;l<e.childNodes.length;l++)o.appendChild(this.parseNodeByNode(e.childNodes[l],t+1,n++,o));return this.hash_index_node[o.index]=o,o},p.prototype.parseImage=function(e){var t="",i="",s="",o="",n="",l=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(l)?this.imageXPath.image:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.image,this.valueAttribute)),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(l)?this.imageXPath.iconImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.iconImage,this.valueAttribute)),""!=this.imageXPath.selectedImage&&(s=this.imageXPath.selectedImage.match(l)?this.imageXPath.selectedImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.selectedImage,this.valueAttribute)),""!=this.imageXPath.expandedImage&&(o=this.imageXPath.expandedImage.match(l)?this.imageXPath.expandedImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.expandedImage,this.valueAttribute)),""!=this.imageXPath.leafImage&&(n=this.imageXPath.leafImage.match(l)?this.imageXPath.leafImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.leafImage,this.valueAttribute)),""!=n&&1==e.isLeaf()&&(t=n),""!=i&&(t=i,s=i,o=i),""==o&&(o=t),this.treeview&&this.treeview.getURL,e.image=""==t?"":this.treeview.getURL(t),e.selectedImage=""==s?"":this.treeview.getURL(s),e.expandedImage=""==o?"":this.treeview.getURL(o),e.imageTitle=this.imageXPath.imageTitle&&WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.imageTitle);for(var a=0;a<e.childNodes.length;a++)this.parseImage(e.childNodes[a])},p.prototype.parseImageInstance=function(e){var t="",i="",s="",o="",n="",l=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(l)?this.imageXPath.image:WebSquare.xml.getValue(e.element,this.imageXPath.image).wq_trim()||""),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(l)?this.imageXPath.iconImage:WebSquare.xml.getValue(e.element,this.imageXPath.iconImage).wq_trim()||""),""!=this.imageXPath.selectedImage&&(s=this.imageXPath.selectedImage.match(l)?this.imageXPath.selectedImage:WebSquare.xml.getValue(e.element,this.imageXPath.selectedImage).wq_trim()||""),""!=this.imageXPath.expandedImage&&(o=this.imageXPath.expandedImage.match(l)?this.imageXPath.expandedImage:WebSquare.xml.getValue(e.element,this.imageXPath.expandedImage).wq_trim()||""),""!=this.imageXPath.leafImage&&(n=this.imageXPath.leafImage.match(l)?this.imageXPath.leafImage:WebSquare.xml.getValue(e.element,this.imageXPath.leafImage).wq_trim()||""),""!=n&&1==e.isLeaf()&&(t=n),""!=i&&(t=i,s=i,o=i),""==s&&(s=t),""==o&&(o=t),this.treeview&&this.treeview.getURL,e.image=""==t?"":this.treeview.getURL(t),e.selectedImage=""==s?"":this.treeview.getURL(s),e.expandedImage=""==o?"":this.treeview.getURL(o),e.imageTitle=this.imageXPath.imageTitle&&WebSquare.xml.getValue(e.element,this.imageXPath.imageTitle);for(var a=0;a<e.childNodes.length;a++)this.parseImageInstance(e.childNodes[a])},p.prototype.parseListToTree=function(e){for(var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0),i=WebSquare.xmljs.xml2json(t).E[0],s=0;s<e.length;s++)e[s]._element.parent=i;var o=i,n=0;this.dataType="list";for(s=0;s<e.length;s++){o=new WebSquare.Elem(o)
;var l=e[s],a=parseInt(WebSquare.jsonUtil.getValue(l._element,this.xpath.depth,this.valueAttribute))||0;n=parseInt(WebSquare.jsonUtil.getValue(o._element,this.xpath.depth,this.valueAttribute))||0;if(0===a&&0!==n&&(l.setNodeValue(this.xpath.depth,n),a=n),n<a)l._element.parent=o._element,l=o.appendChild(l._element);else if(n==a&&0==s)l._element.parent=o._element,l=o.appendChild(l._element);else if(n==a){l._element.parent=o.getParentNode()._element,l=o.getParentNode().appendChild(l._element)}else if(n>a){o=o.getParentNode();for(var h=0;h<n-a;h++)null!=o._element.parent&&(o=o.getParentNode());o.element&&(o=o._element),l._element.parent=o._element,l=o.appendChild(l._element)}o=l}return new WebSquare.Elem(i)},p.prototype.parseListToTreeInstance=function(e){var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0),i=t.documentElement,s=0;this.dataType="list";for(var o=0;o<e.length;o++){var n=e[o].cloneNode(!0),l=parseInt(WebSquare.xml.getValue(n,this.xpath.depth))||0;s=parseInt(WebSquare.xml.getValue(i,this.xpath.depth))||0;if(0===l&&0!==s&&(WebSquare.xml.setValue(n,this.xpath.depth,s),l=s),s<l)n=WebSquare.xml.appendChild(i,n);else if(s==l&&0==o)n=WebSquare.xml.appendChild(i,n);else if(s==l){var a=i.parentNode;n=WebSquare.xml.appendChild(a,n)}else if(s>l){i=i.parentNode;for(var h=0;h<s-l;h++)null!=i.parentNode&&(i=i.parentNode);i.documentElement&&(i=i.documentElement),n=WebSquare.xml.appendChild(i,n)}i=n}return t.documentElement},p.prototype.parseRecursiveToTree=function(e){this.dataType="recursive";var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0);if(e[0]instanceof WebSquare.Elem){for(var i=new WebSquare.Elem(WebSquare.xmljs.xml2json(t).E[0]),s=0;s<e.length;s++){var o=null;o=e[s],i.appendChild(o._element)}return i}for(s=0;s<e.length;s++){o=null;o=a.Z.isOpera()?WebSquare.xml.parse(e[s]).firstChild:e[s].cloneNode(!0),WebSquare.xml.appendChild(t.documentElement,o)}return t.documentElement},p.prototype.parseTreeToList=function(){var e=this.xpath.nodeset;if(e.indexOf("/")>-1){var t=e.split("/");e=t[t.length-2]}e&&""!=e||(e="Treeview");var i=WebSquare.xml.parse("<"+e+' xmlns:w2="http://www.inswave.com/websquare" />',!0),s=i.documentElement,o=this.getNodeIterator({type:"dfs"});for(o.next();o.next();){var n=o.getNode();s.appendChild(n.element)}return i.documentElement},p.prototype.getNodeIterator=function(e){return e=s.q.extend({rootNode:null},e||{}),new c.nodeIterator(e.rootNode||this.rootNode,e)},p.prototype.size=function(){return this.nodeCount},p.prototype.findNodeByValue=function(e){for(var t=null,i=this.getNodeIterator();i.next();)if(i.getNode().value==e){t=i.getNode();break}return i=null,t},p.prototype.findNodeByIndex=function(e){var t=this.hash_index_node[e];return t||null},p.prototype.setRender=function(e,t){e.rendered=t;for(var i=0;i<e.childNodes.length;i++)this.setRender(e.childNodes[i],t)},p.prototype.getCloneNode=function(e){var t={};return t.checkboxDisabled=e.checkboxDisabled,t.checked=e.checked,t.folder=e.folder,t.image=e.image,t.imageTitle=e.imageTitle,t.rendered=e.rendered,t.id=e.id,t.index=e.index,t.value=e.value,t.label=e.label,t.labelStyle=e.labelStyle,t},p.prototype.clearNode=function(e){e.element=null,e.parentNode=null,e.childNodes=[],delete this.hash_index_node[e.index]},p.prototype.changeNodeIndex=function(e,t){var i=this.hash_index_node[e];i.index=t,delete this.hash_index_node[e],this.hash_index_node[t]=i,this.changeDomIndex("node",e,t,!0),this.changeDomIndex("group",e,t,!0),this.changeDomIndex("checkbox",e,t),this.changeDomIndex("label",e,t),this.changeDomIndex("guideline",e,t),this.changeDomIndex("child",e,t),this.changeDomIndex("col_icon_navi",e,t),i.checkboxDom&&(i.checkboxDom=null,delete i.checkboxDom)},p.prototype.changeDomIndex=function(e,t,i,s){var o=document.getElementById(this.treeview.id+"_"+e+"_"+t);if(null!=o&&(o.setAttribute("id",this.treeview.id+"_"+e+"_"+i),s)){var n=a.Z.getDataPrefix("index");o.setAttribute(n,i)}},
p.prototype.getLastChildIndex=function(e){var t=this.findNodeByIndex(e),i=e;if(t.hasChild()){i=this.size();for(var s=t;!s.isRoot()&&s.depthIndex==s.parentNode.childNodes.length;)s=s.parentNode;s.isRoot()||s.depthIndex==s.parentNode.childNodes.length||(i=s.parentNode.childNodes[s.depthIndex].index-1)}return i};var u=function(e,t,i){r.q.call(this,e,t,i)};s.q.extend(u.prototype,r.q.prototype),u.prototype.defaultOptions={useConfig:!0,pluginType:"uiplugin.treeview",pluginName:"treeview",userEvents:["onclick","ondblclick","onchange","onrightbuttonclick","ondrop","oncheckboxclick","onlabelclick","ontoggleclick","onviewchange","oneditend","onlabelover","ontooltipshow","ontooltiphide"],repeatNode:"",useDrag:!1,dataType:"recursive",lineShow:!0,alwaysDraw:!1,imgclass:"",labelclass:"",labelonClickClass:"w2treeview_select_node",defaultImage:"",iconImage:"",selectedImage:"",expandedImage:"",leafImage:"",showTreeDepth:1e3,showCheckbox:!1,trueValue:"true",falseValue:"false",checkAllChildNodes:!1,checkboxDisabled:"",checkboxDisabledTrueValue:"true",checkboxDisabledFalseValue:"false",checkboxDisabledAll:!1,rowHeight:-1,toggleEvent:"ondblclick",tooltipDisplay:!1,tooltipShowAlways:!1,tooltipStyle:"border:2px solid #7BAFE4; background-color:#ffffff;cursor:default;",tooltipClass:"",tooltipTime:1,tooltipGroupClass:!0,hierarchy:!1,refreshCheckboxModel:!1,refreshCheckboxDisableModel:!1,asisAccessibility:void 0,accessibility:!1,autoSelectByFocus:!1,title:"",accordion:!1,dynamicAppend:!1,displayMode:"0",delimiter:"\t",folderOpenToggleImage:s.q._resourceURI+"uiplugin/treeview/images/plus.gif",folderCloseToggleImage:s.q._resourceURI+"uiplugin/treeview/images/minus.gif",leafToggleImage:s.q._resourceURI+"uiplugin/treeview/images/middle.gif",lastToggleImage:s.q._resourceURI+"uiplugin/treeview/images/last.gif",middleToggleImage:s.q._resourceURI+"uiplugin/treeview/images/middle.gif",escape:!0,toggleButtonEvent:"onclick",scrollFix:!1,animation:"",renderType:"table",noFocusOnIconLabelClick:!1,useHirarchySelect:!1,forceRefresh:!1,moveSibling:!1,useXML:!1,iconNaviAriaLabel:""},u.prototype.initialize=function(e){try{switch(this.inlineElement=!1,1==this.options.hierarchy&&(this.options.checkAllChildNodes=!0),this.tree=new p,this.tree.treeview=this,this.selectedInfo={groupDom:null,dom:null,node:null},this.tooltip=null,this.timeShowTooltip=null,this.timeHideTooltip=null,this.openedNodes={},this.originalBackgroundColor="",this.originalColor="",this.originalIconImage="",this.options.animation=this.options.animation?this.options.animation:"",this.options.asisAccessibility=!!e&&a.Z.getBoolean(e.getAttribute("asisAccessibility")),(this.options.asisAccessibility||this.options.accessibility)&&(this.options.lineShow=!1),1==this.options.accordion&&(this.options.showTreeDepth=0),this.useDataCollection=!1,this.successBinding=!1,this.beforeSetRowData={},this.editModeComp=null,this.options.displayMode){case"0":case"1":case"2":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;default:this.options.displayMode="0"}if(this.tree.setDisplayMode(this.options.displayMode,this.options.delimiter),this.options.customFormatter&&(this.tree.customFormatter=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id)),this.resizeObj={width:0,height:0},e){var t=WebSquare.WebSquareparser.parseItemset(e);this.modelControl.setItemset(t.nodeset,t.label,t.value),0==this.options.modelBinding&&(this.options.refreshCheckboxModel=!1,this.options.refreshCheckboxDisableModel=!1);var i=null,s=WebSquare.Elem.api.getElementsByTagName(e,"itemset",o.I._XML_NAMESPACE.W2)[0];if(s){var l=WebSquare.Elem.api.getValue(s,"@nodeset"),h=null;this.useDataCollection=l.match("data:");if(this.useDataCollection){this.modelControl.getDataCollectionItemsetData(this.modelControl.id);var r=this.modelControl.getDataComp();if(null!=r){var d=0===r.filterManager.filterArr.length?r.getAllXML():r.getAllFilteredXML(),c=WebSquare.xmljs.xml2json(d).E[0]
;h=new WebSquare.Elem(c).getChildNodes(),l=r.options.baseNode+"/"+r.options.repeatNode;var u=r.options.repeatNode.split("/");if(0!=u.length&&u.length>1){for(var f=[],g=0;g<h.length;g++)f.push(h[g].getChildNodes()[0]);h=f}r.options.valueAttribute&&(this.tree.valueAttribute=r.options.valueAttribute),this.successBinding=!0}}else{h=WebSquare.ModelUtil.findInstanceNodes(l,null,this.scope_id);this.tree.isInstance=!0}var m=l.replace(/\[[^\[\]]*\]/g,"").match(/[^\/]*$/);m&&(m=m[0]);var b=WebSquare.Elem.api.getElementsByTagName(s,"label",o.I._XML_NAMESPACE.W2)[0],v=WebSquare.Elem.api.getElementsByTagName(s,"value",o.I._XML_NAMESPACE.W2)[0],x=WebSquare.Elem.api.getElementsByTagName(s,"depth",o.I._XML_NAMESPACE.W2)[0],_=WebSquare.Elem.api.getElementsByTagName(s,"folder",o.I._XML_NAMESPACE.W2)[0],w=b?WebSquare.Elem.api.getValue(b,"@ref"):"",y=v?WebSquare.Elem.api.getValue(v,"@ref"):"",I=x?WebSquare.Elem.api.getValue(x,"@ref"):"",N=_?WebSquare.Elem.api.getValue(_,"@ref"):"",k=WebSquare.Elem.api.getElementsByTagName(s,"image",o.I._XML_NAMESPACE.W2)[0],C=WebSquare.Elem.api.getElementsByTagName(s,"iconImage",o.I._XML_NAMESPACE.W2)[0],S=WebSquare.Elem.api.getElementsByTagName(s,"selectedImage",o.I._XML_NAMESPACE.W2)[0],T=WebSquare.Elem.api.getElementsByTagName(s,"expandedImage",o.I._XML_NAMESPACE.W2)[0],D=WebSquare.Elem.api.getElementsByTagName(s,"leafImage",o.I._XML_NAMESPACE.W2)[0],E=WebSquare.Elem.api.getElementsByTagName(s,"checkboxDisabled",o.I._XML_NAMESPACE.W2)[0],B=WebSquare.Elem.api.getElementsByTagName(s,"checkbox",o.I._XML_NAMESPACE.W2)[0],A=WebSquare.Elem.api.getElementsByTagName(s,"imageTitle",o.I._XML_NAMESPACE.W2)[0],L=k?WebSquare.Elem.api.getValue(k,"@ref"):"",P=C?WebSquare.Elem.api.getValue(C,"@ref"):"",W=S?WebSquare.Elem.api.getValue(S,"@ref"):"",q=T?WebSquare.Elem.api.getValue(T,"@ref"):"",V=D?WebSquare.Elem.api.getValue(D,"@ref"):"",M=E?WebSquare.Elem.api.getValue(E,"@ref"):"",X=A?WebSquare.Elem.api.getValue(A,"@ref"):"",R=B?WebSquare.Elem.api.getValue(B,"@ref"):"",F=R;this.useDataCollection&&this.tree.setDataPath(w,y,I,m,N,F),""!=this.options.defaultImage&&(L=this.options.defaultImage),""!=this.options.iconImage&&(P=this.options.iconImage),""!=this.options.selectedImage&&(W=this.options.selectedImage),""!=this.options.expandedImage&&(q=this.options.expandedImage),""!=this.options.leafImage&&(V=this.options.leafImage),""!=this.options.checkboxDisabled&&(M=this.options.checkboxDisabled),this.tree.setXPath(l,w,y,I,m,N),this.tree.setCheckbox(F,this.options.trueValue,this.options.falseValue,M,this.options.checkboxDisabledTrueValue,this.options.checkboxDisabledFalseValue,this.options.checkboxDisabledAll,this.options.refreshCheckboxModel,this.options.refreshCheckboxDisableModel,this.options.hierarchy,R),this.tree.setImage(L,P,V,W,q,X),null!=h&&("recursive"==this.options.dataType?i=this.tree.parseRecursiveToTree(h):"listed"==this.options.dataType&&(i=1==this.tree.isInstance?this.tree.parseListToTreeInstance(h):this.tree.parseListToTree(h)))}else{this.inlineElement=!0,i=e;var Y="w2:";L=Y+"image",P=Y+"iconImage",W=Y+"selectedImage",q=Y+"expandedImage",V=Y+"leafImage";""!=this.options.defaultImage&&(L=this.options.defaultImage),""!=this.options.iconImage&&(P=this.options.iconImage),""!=this.options.selectedImage&&(W=this.options.selectedImage),""!=this.options.expandedImage&&(q=this.options.expandedImage),""!=this.options.leafImage&&(V=this.options.leafImage),this.tree.setImage(L,P,V,W,q,Y+"imageTitle"),this.tree.setCheckbox(Y+"checkbox",this.options.trueValue,this.options.falseValue,Y+"checkboxDisabled",this.options.checkboxDisabledTrueValue,this.options.checkboxDisabledFalseValue,this.options.checkboxDisabledAll,this.options.refreshCheckboxModel,this.options.refreshCheckboxDisableModel,this.options.hierarchy)}i&&this.tree.setXML(i)}this.options=WebSquare.cssManager.styleToClass(this.id,this.options),1==this.options.showCheckbox&&(1==a.Z.isOpera()?this.checkboxStyle="left:-1px;top:-1px":this.checkboxStyle="left:0px;top:0px"),
this.isFireTooltipEvent=!1,this.options.useHirarchySelect&&(this.selectedInfoStack=[])}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.appendData=function(e,t,i){try{if(0==this.options.dynamicAppend){var s=WebSquare.language.getMessage("Treeview_warning1")||"If you are processing the treeview dynamically, it is recommended to set dynamicAppend='true'";$l(s+"["+this.id+"]")}if(void 0===e||null==e||!t)return;i=void 0!==i&&i;var o=this.tree.findNodeByIndex(e);if(!i&&o.childNodes&&o.childNodes[0]&&o.childNodes[0].rendered)return;var l=null;if(1==this.tree.isInstance)var a=t;else if(t[0]){var h=t[0].parentNode;a=new WebSquare.Elem(WebSquare.xmljs.xml2json(h)).getChildNodes()}"recursive"==this.options.dataType?l=this.tree.parseRecursiveToTree(a):"listed"==this.options.dataType&&(l=1==this.tree.isInstance?this.tree.parseListToTreeInstance(a):this.tree.parseListToTree(a)),this.tree.appendXML(l,e),0==e?(o.hasChild(),this.drawContents()):(this.refreshNaviIcon(o),o.childNodes.length>0&&(o.childNodes[0].rendered=!1,this.toggleChild(null,o.index,!0)))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.toHTML=function(){try{var e=a.Z.getDataPrefix("index"),t=[],i=""==this.options.style?"":"style='"+this.options.style+"'",s="",o=""==this.options.title?"":"title='"+this.options.title+"'",l="";return this.options.accessibility?l="class='w2treeview_standard "+this.options.className+"' ":(s=""==this.options.tabIndex?"tabindex='0'":"tabIndex='"+this.options.tabIndex+"'",l="class='w2treeview "+this.options.className+"' "),t.push("<div "+s+" id='"+this.id+"' "+e+"='0' "+i+l+o+">"),t.push("</div>"),t.join("")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setAction=function(){try{var e;this.useDataCollection&&(e=this.modelControl.getDataComp())&&e._getDelayedRefreshComponent&&e._getDelayedRefreshComponent(this.id)&&(this.refreshItemset(),e._setDelayedRefreshComponent(this.id,!1)),this.useDataCollection&&!this.successBinding||(this.tree.rootNode&&this.drawContents(),"none"!=this.options.toggleEvent&&this.event.addListener(this.render,this.options.toggleEvent,this.event.bindAsEventListener(this,this.handleToggleEvent)),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblclickEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),this.event.addListener(this.render,"onselectstart",(function(e){l.f.stopEvent(e)})),this.event.addListener(this.render,"oncontextmenu",this.event.bindAsEventListener(this,this.handleContextmenuEvent)),this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.activateDrag)),this.options.accessibility?this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownAccessbilityEvent)):this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.refreshStop=!1,this.useDataCollection&&e.bind("onbeforecelldatachange",this.event.bindAsEventListener(this,this.notifyValidCheck)))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.refreshItemset=function(e){try{if(this.modelControl.isItemsetBinded()&&!this.refreshStop){this.refreshStop=!0;var t=null,i=this.tree.getNodeset(),s=null,o=!1;if(this.useDataCollection){if(null!=(g=this.modelControl.getDataComp())){this.tree.isInstance=!1;var l="";if(g.options&&"string"==typeof g.options.repeatNode){var a=(l=g.options.repeatNode).lastIndexOf("/");a>=0&&(l=l.slice(a+1))}var h=0===g.filterManager.filterArr.length?g.getAllXML({repeatNode:l}):g.getAllFilteredXML({repeatNode:l}),r=WebSquare.xmljs.xml2json(h).E[0];if(s=new WebSquare.Elem(r).getChildNodes(),!this.successBinding){
var d=(i=g.options.baseNode+"/"+g.options.repeatNode).replace(/\[[^\[\]]*\]/g,"").match(/[^\/]*$/);d&&(d=d[0]),g.options.valueAttribute&&(this.tree.valueAttribute=g.options.valueAttribute);var c=this.tree.xpath.label,p=this.tree.xpath.value,u=this.tree.xpath.depth,f=this.tree.xpath.folder;this.tree.setXPath(i,c,p,u,d,f),this.successBinding=!0,o=!0}}}else s=WebSquare.ModelUtil.findInstanceNodes(i,null,this.scope_id);null!=s&&("recursive"==this.options.dataType?t=this.tree.parseRecursiveToTree(s):"listed"==this.options.dataType&&(t=1==this.tree.isInstance?this.tree.parseListToTreeInstance(s):this.tree.parseListToTree(s))),this.tree.setXML(t);var g,m=this.selectedInfo.node;if(o)if(e&&!0===e.setNodeSet){if(this.drawContents(),this.useDataCollection)(g=this.modelControl.getDataComp()).bind("onbeforecelldatachange",this.event.bindAsEventListener(this,this.notifyValidCheck))}else this.setAction(),this.refreshStop=!0;else this.drawContents();if(this.useDataCollection&&null!=m)null!=(g=this.modelControl.getDataComp())&&null!=g.getRowPosition()&&this.selectNode2(m);this.refreshStop=!1}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.refreshItemArr=function(){this.refreshItemset()},u.prototype.drawContents=function(){try{this.selectedInfo={dom:null,node:null},this.initRenderStatus();var e=[];if(this.options.accessibility)e.push(this._rootNodeToHTMLForAccessibility(this.tree.rootNode,!1));else for(var t=0;t<this.tree.rootNode.childNodes.length;t++)e.push(this.nodeToHTML(this.tree.rootNode.childNodes[t]));this.render.innerHTML=e.join(""),this.tree.rootNode.childNodes.length>0&&(this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight}),this.options.accessibility&&(this.dom.firstIconNavi=this.getElementById(this.id+"_col_icon_navi_1"),this.dom.firstIconNavi&&this.event.addListener(this.dom.firstIconNavi,"onfocus",this.event.bindAsEventListener(this,this.handleIconNaviFocusEvent)))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.selectNode=function(e,t,i,s){try{i=void 0===i||i;var o=a.Z.getBoolean(this.options.useHirarchySelect),h=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,r=null;if(null!=e?r=this.tree.findNodeByValue(e):null!=t&&(r=this.tree.findNodeByIndex(t)),this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.style.backgroundColor=this.originalBackgroundColor,this.selectedInfo.dom.style.color=this.originalColor),this.selectedInfo.node){var d=document.getElementById(this.id+"_icon_"+this.selectedInfo.node.index);d&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfo.node.selectedImage&&(d.style.backgroundImage=this.originalIconImage)}if(o&&this.selectedInfoStack.length>0){for(var c=0;c<this.selectedInfoStack.length;c++){var p=this.selectedInfoStack[c];p.dom&&(this.removeClass(p.dom,this.options.labelonClickClass),p.dom.style.backgroundColor=p.org.background,p.dom.style.color=p.org.color),p.icon&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfo.node.selectedImage&&(p.icon.style.backgroundImage=p.org.iconImage)}this.selectedInfoStack=[]}if(null!=h&&null!=r?h.index!=r.index&&l.f.fireEvent(this,"onchange",h,r):(null==h&&null!=r||null!=h&&null==r)&&l.f.fireEvent(this,"onchange",h,r),this.selectedInfo.node=r,null!=this.selectedInfo.node&&i){for(var u=this.selectedInfo.node.parentNode,f=[];u;){t=u.index;f.push(t),u=u.parentNode}for(var c in f.reverse(),f)this.toggleChild(null,f[c],!0)}this.selectedInfo.dom=document.getElementById(this.id+"_label_"+this.selectedInfo.node.index),this.options.accessibility?this.selectedInfo.groupDom=document.getElementById(this.id+"_node_"+this.selectedInfo.node.index):this.selectedInfo.groupDom=document.getElementById(this.id+"_group_"+this.selectedInfo.node.index),this.addClass(this.selectedInfo.dom,this.options.labelonClickClass),this.originalBackgroundColor=this.selectedInfo.dom.style.backgroundColor,this.originalColor=this.selectedInfo.dom.style.color
;var g=document.getElementById(this.id+"_icon_"+this.selectedInfo.node.index);if(g&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfo.node.selectedImage&&(this.originalIconImage=g.style.backgroundImage),o){for(u=this.selectedInfo.node;u;){var m=document.getElementById(this.id+"_label_"+u.index),b=document.getElementById(this.id+"_icon_"+u.index);this.selectedInfoStack.push({node:u,groupDom:document.getElementById(this.id+"_group_"+u.index),dom:m,org:{background:m?m.style.backgroundColor:null,color:m?m.style.color:null,iconImage:b?b.style.backgroundImage:null},icon:b}),this.selectedInfoStack[this.selectedInfoStack.length-1].dom&&(this.addClass(this.selectedInfoStack[this.selectedInfoStack.length-1].dom,this.options.labelonClickClass),this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.backgroundColor="",this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.color=""),this.selectedInfoStack[this.selectedInfoStack.length-1].iconv&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfoStack[this.selectedInfoStack.length-1].node.selectedImage&&(this.selectedInfoStack[this.selectedInfoStack.length-1].icon.style.backgroundImage="url('"+this.selectedInfoStack[this.selectedInfoStack.length-1].node.selectedImage+"')"),u=u.parentNode}this.selectedInfoStack.reverse()}if(g&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfo.node.selectedImage&&(g.style.backgroundImage="url('"+this.selectedInfo.node.selectedImage+"')"),this.selectedInfo.dom.style.backgroundColor="",this.selectedInfo.dom.style.color="",!0!==s&&(this.options.scrollFix||(this.selectedInfo.groupDom.setAttribute("tabindex",0),this.selectedInfo.groupDom.focus(),this.selectedInfo.groupDom.setAttribute("tabindex",-1)),this.useDataCollection&&this.successBinding)){var v=this.modelControl.getDataComp();if(null!=this.selectedInfo.node){for(var x in v.refCompHash){var _=v.refCompHash[x];null!=_&&WebSquare.idCache[_.uuid]&&"input"==_.options.pluginName&&_.setValue(_.getValue())}v.setRowPosition(this.selectedInfo.node.index-1)}else v.setRowPosition(null)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.selectNode1=function(e,t,i,s){try{if(null!=this.selectedInfo.node){var o=this.tree.getCloneNode(this.selectedInfo.node),a=o.index;if(this.selectNode(e,t,i,s),null!=this.selectedInfo.node)if(a!=this.selectedInfo.node.index){var h={oldNode:o,newNode:this.tree.getCloneNode(this.selectedInfo.node)};l.f.fireEvent(this,"onviewchange",h)}}else if(this.selectNode(e,t,i,s),null!=this.selectedInfo.node){h={oldNode:{},newNode:this.tree.getCloneNode(this.selectedInfo.node)};l.f.fireEvent(this,"onviewchange",h)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.selectNode2=function(e){try{this.selectedInfo.node=e,this.selectedInfo.dom=document.getElementById(this.id+"_label_"+this.selectedInfo.node.index),this.selectedInfo.groupDom=document.getElementById(this.id+"_group_"+this.selectedInfo.node.index),this.addClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom?(this.originalBackgroundColor=this.selectedInfo.dom.style.backgroundColor,this.originalColor=this.selectedInfo.dom.style.color,this.selectedInfo.dom.style.backgroundColor="",this.selectedInfo.dom.style.color=""):(this.originalBackgroundColor="",this.originalColor="")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._focusNodeForAccessibilityWithTrust=function(e,t,i,s,o){try{var l=document.getElementById(this.id+"_col_icon_navi_"+t),a=document.getElementById(this.id+"_label_"+t),h=document.getElementById(this.id+"_checkbox_"+t);o.isIconNavi?l?l.focus():h?h.focus():a.focus():o.isLabel?a.focus():o.isCheckbox&&(h?h.focus():a.focus())}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._selectNodeForAccessibilityWithTrust=function(e,t,i,s,o){try{if(null!=this.selectedInfo.node){var a=this.tree.getCloneNode(this.selectedInfo.node),h=a.index;if(this._selectNodeForAccessibility(e,t,i,s,o),null!=this.selectedInfo.node)if(h!=this.selectedInfo.node.index){
var r={oldNode:a,newNode:this.tree.getCloneNode(this.selectedInfo.node)};l.f.fireEvent(this,"onviewchange",r)}}else if(this._selectNodeForAccessibility(e,t,i,s,o),null!=this.selectedInfo.node){r={oldNode:{},newNode:this.tree.getCloneNode(this.selectedInfo.node)};l.f.fireEvent(this,"onviewchange",r)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._selectNodeForAccessibility=function(e,t,i,s,o){try{i=void 0===i||i;var h=a.Z.getBoolean(this.options.useHirarchySelect),r=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,d=null;if(null!=e?d=this.tree.findNodeByValue(e):null!=t&&(d=this.tree.findNodeByIndex(t)),this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.setAttribute("aria-selected",!1)),h&&this.selectedInfoStack.length>0){for(var c=0;c<this.selectedInfoStack.length;c++){var p=this.selectedInfoStack[c];p.dom&&(this.removeClass(p.dom,this.options.labelonClickClass),p.dom.style.backgroundColor=p.org.background,p.dom.style.color=p.org.color)}this.selectedInfoStack=[]}if(null!=r&&null!=d?r.index!=d.index&&l.f.fireEvent(this,"onchange",r,d):(null==r&&null!=d||null!=r&&null==d)&&l.f.fireEvent(this,"onchange",r,d),this.selectedInfo.node=d,null!=this.selectedInfo.node&&i){for(var u=this.selectedInfo.node.parentNode,f=[];u;){t=u.index;f.push(t),u=u.parentNode}for(var c in f.reverse(),f)this.toggleChild(null,f[c],!0)}if(this.selectedInfo.dom=document.getElementById(this.id+"_label_"+this.selectedInfo.node.index),this.options.accessibility?this.selectedInfo.groupDom=document.getElementById(this.id+"_node_"+this.selectedInfo.node.index):this.selectedInfo.groupDom=document.getElementById(this.id+"_group_"+this.selectedInfo.node.index),this.originalBackgroundColor=this.selectedInfo.dom.style.backgroundColor,this.originalColor=this.selectedInfo.dom.style.color,h){var g;for(u=this.selectedInfo.node;u;){var m=document.getElementById(this.id+"_label_"+u.index);g=this.options.accessibility?document.getElementById(this.id+"_node_"+u.index):document.getElementById(this.id+"_group_"+u.index),this.selectedInfoStack.push({node:u,groupDom:g,dom:m,org:{background:m?m.style.backgroundColor:null,color:m?m.style.color:null}}),this.selectedInfoStack[this.selectedInfoStack.length-1].dom&&(this.addClass(this.selectedInfoStack[this.selectedInfoStack.length-1].dom,this.options.labelonClickClass),this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.backgroundColor="",this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.color=""),u=u.parentNode}this.selectedInfoStack.reverse()}if(!0===s&&this.options.accessibility&&this.selectedInfo.dom.setAttribute("aria-selected",!0),!0!==s){if(!this.options.scrollFix){var b=document.getElementById(this.id+"_col_icon_navi_"+this.selectedInfo.node.index),v=document.getElementById(this.id+"_label_"+this.selectedInfo.node.index),x=document.getElementById(this.id+"_checkbox_"+this.selectedInfo.node.index);o.isIconNavi?b?b.focus():v.focus():o.isLabel?v.focus():o.isCheckbox&&(x?x.focus():v.focus()),(o.isIconNavi||o.isLabel||o.isCheckbox)&&this.addClass(v,this.options.labelonClickClass),this.selectedInfo.dom.setAttribute("aria-selected",!0)}if(this.useDataCollection&&this.successBinding){var _=this.modelControl.getDataComp();if(null!=this.selectedInfo.node){for(var w in _.refCompHash){var y=_.refCompHash[w];null!=y&&WebSquare.idCache[y.uuid]&&"input"==y.options.pluginName&&y.setValue(y.getValue())}_.setRowPosition(this.selectedInfo.node.index-1)}else _.setRowPosition(null)}}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.findNode=function(e,t){try{if(void 0===t&&(t=!0),!0===t){this.selectNode(e,null);var i=WebSquare.style.getAbsoluteTop(this.selectedInfo.dom),s=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight;return s<i&&(this.render.scrollTop=i-s+parseInt(this.render.offsetHeight/2)),this.getSelectedNode()}return this.tree.findNodeByValue(e)}catch(e){
n.Y.printStackTrace(e,null,this)}},u.prototype.findNodeByValue=function(e,t){try{var i=this.tree.findNodeByValue(e);if(!0===t&&i){this.selectNode(e,null);var s=WebSquare.style.getAbsoluteTop(this.selectedInfo.dom),o=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight;return o<s&&(this.render.scrollTop=s-o+parseInt(this.render.offsetHeight/2)),this.getSelectedNode()}return i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.findNodeByIndex=function(e,t){try{var i=this.tree.findNodeByIndex(e);if(!0===t&&i){this.selectNode(null,e);var s=WebSquare.style.getAbsoluteTop(this.selectedInfo.dom),o=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight;return o<s&&(this.render.scrollTop=s-o+parseInt(this.render.offsetHeight/2)),this.getSelectedNode()}return i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.isOpen=function(e){try{if(e>=this.tree.size()||e<1)return;var t=document.getElementById(this.id+"_node_"+e),i=!1;if(t){var s=a.Z.getDataPrefix("opened");i=a.Z.getBoolean(t.getAttribute(s))}return i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedNode=function(){try{return this.selectedInfo?this.selectedInfo.node:null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedDom=function(){try{return this.selectedInfo?this.selectedInfo.dom:null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedLabel=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.label:""}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedValue=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.value:""}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedIndex=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.index:""}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedElement=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.element:null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.isLeaf=function(){try{return!this.selectedInfo||!this.selectedInfo.node||!this.selectedInfo.node.hasChild()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setLabelStyle=function(e,t,i,s){var o;"object"==typeof e&&"number"==typeof e.index?o=e:"number"==typeof e?o=this.tree.findNodeByIndex(e):"string"==typeof e&&(o=this.tree.findNodeByValue(e)),this._setLabelStyle(o,t,i,s)},u.prototype.setCustomFormatter=function(e){if("function"==typeof e){for(var t=this.tree.getNodeIterator();t.next();){var i=t.getNode();if(!i.isRoot()){var s=this.tree.getCloneNode(i),o=e.call(this,i.orgLabel,i.label,s)||i.label;if(i.label=o,i.rendered)document.getElementById(this.id+"_label_"+i.index).firstChild.nodeValue=i.label}}t=null,this.options.customFormatter=e,this.tree.customFormatter=e}},u.prototype._setLabelStyle=function(e,t,i,s){if(null!=e){if(null==e.labelStyle&&(e.labelStyle={}),e.labelStyle[t]=i,this.originalBackgroundColor=e.labelStyle["background-color"]||this.originalBackgroundColor,this.originalColor=e.labelStyle.color||this.originalColor,e.rendered){var o=document.getElementById(this.id+"_label_"+e.index);if(o){for(var n="",l=0;l<t.length;l++)"-"===t.charAt(l)?(n+=t.charAt(l+1).capitalize(),l++):n+=t.charAt(l);o.style[n]=i}}if(!0===s)for(l=0;l<e.childNodes.length;l++){var a=e.childNodes[l];this._setLabelStyle(a,t,i,s)}}},u.prototype.checkNode=function(e,t,i,s,o){try{var l=this.tree.findNodeByIndex(e);if(l.checked=t,l.checkboxDom||(l.checkboxDom=document.getElementById(this.id+"_checkbox_"+e)),l.checkboxDom)if(l.checkboxDom.checked=t,this.options.accessibility)document.getElementById(this.id+"_label_"+e).setAttribute("aria-checked",t);if(1==this.options.refreshCheckboxModel){if(this.stopRefresh(!0),this.useDataCollection&&this.tree.checkbox.colID){var a=this.modelControl.getDataComp(),h=t?this.options.trueValue:this.options.falseValue;null!=a&&a.setCellData(e-1,this.tree.checkbox.colID,h,null,o),
l.element.setAttribute(a.options.valueAttribute,h)}else 1==t?l.checkboxXPath&&null!=WebSquare.ModelUtil.findInstanceNode(l.checkboxXPath)&&WebSquare.ModelUtil.setInstanceValue(l.checkboxXPath,this.options.trueValue,null,this.scope_id):l.checkboxXPath&&null!=WebSquare.ModelUtil.findInstanceNode(l.checkboxXPath)&&WebSquare.ModelUtil.setInstanceValue(l.checkboxXPath,this.options.falseValue,null,this.scope_id);this.stopRefresh(!1)}if(!1!==i&&(1==i||1==this.options.hierarchy||1==this.options.checkAllChildNodes))for(var r=0;r<l.childNodes.length;r++){var d=l.childNodes[r];this.checkNode(d.index,t,!0,!1)}if(1==this.options.hierarchy&&this.partialSelection(l),!1!==s&&l.parentNode.parentNode&&1==this.options.hierarchy){var c=!0;for(r=0;r<l.parentNode.childNodes.length;r++){if(1!=(d=l.parentNode.childNodes[r]).checked){c=!1;break}}1==c?this.checkNode(l.parentNode.index,!0,!1):this.checkNode(l.parentNode.index,!1,!1)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.partialSelection=function(e){try{var t=0,i=!1;if(0==e.childNodes.length)return;for(var s=0;s<e.childNodes.length;s++){var o=e.childNodes[s];1==o.checked?t++:1==o.partial&&(i=!0)}1==i||0<t&&t<e.childNodes.length?(e.partial=!0,e.checkboxDom&&(this.addClass(e.checkboxDom,"w2treeview_partialselect"),e.checkboxDom.checked=!0)):(e.partial=!1,e.checkboxDom&&(this.removeClass(e.checkboxDom,"w2treeview_partialselect"),1==e.checked?e.checkboxDom.checked=!0:e.checkboxDom.checked=!1))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.disableCheckboxByValue=function(e,t,i){try{var s=this.tree.findNodeByValue(e);this.disableCheckbox(s,t,i)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setLabelByIndex=function(e,t,i){this.setLabel(this.tree.findNodeByIndex(e),t,i)},u.prototype.setLabelByValue=function(e,t,i){this.setLabel(this.tree.findNodeByValue(e),t,i)},u.prototype.setLabel=function(e,t,i){try{if(e){var s=this.refreshStop;this.refreshStop=!0;var o=this.tree.valueAttribute,l=this.tree.xpath.label;if(this.modelControl.useItemset&&WebSquare.ModelUtil.setInstanceValue(e.xpath+"/"+this.tree.xpath.label,t),1==this.tree.isInstance)WebSquare.xml.setValue(e.element,"label",t);else if(o){e.element.getElementsByTagName(l)[0].setAttribute(o,t)}else{var h=e.element.getValue(l).getChildNodes();1==h.length&&h[0].setNodeValue(t)}if(this.options.customFormatter&&(this.tree.customFormatter=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id)),"function"==typeof this.tree.customFormatter){var r=this.tree.getCloneNode(e);t=this.tree.customFormatter.call(this,t,t,r)}if(e.label=t,e.orgLabel=t,e.rendered)document.getElementById(this.id+"_label_"+e.index).innerHTML=t;if(this.useDataCollection){var d=this.modelControl.getDataComp();null!=d&&d.setCellData(e.index-1,this.tree.dataPath.label,t,null,i)}this.refreshStop=s}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setValue=function(e,t,i){try{if(e){var s=this.refreshStop;this.refreshStop=!0;var o=this.tree.valueAttribute,l=this.tree.xpath.value;if(this.modelControl.useItemset&&WebSquare.ModelUtil.setInstanceValue(e.xpath+"/"+this.tree.xpath.value,t),1==this.tree.isInstance)WebSquare.xml.setValue(e.element,l,t),e.value=t;else{if(o){e.element.getElementsByTagName(l)[0].setAttribute(o,t)}else{var a=e.element.getValue(l).getChildNodes();1==a.length&&a[0].setNodeValue(t)}e.value=t}if(this.refreshStop=s,this.useDataCollection){var h=this.modelControl.getDataComp();null!=h&&h.setCellData(e.index-1,this.tree.dataPath.value,t,null,i)}}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setValueByIndex=function(e,t,i){this.setValue(this.tree.findNodeByIndex(e),t,i)},u.prototype.disableCheckbox=function(e,t,i){try{if(t=a.Z.getBoolean(t),e.checkboxDom||(e.checkboxDom=document.getElementById(this.id+"_checkbox_"+e.index)),e.checkboxDom&&(e.checkboxDom.disabled=t,e.checkboxDisabled=t),1==this.options.refreshCheckboxDisableModel&&(this.stopRefresh(!0),
1==t?null!=WebSquare.ModelUtil.findInstanceNode(e.checkboxDisableXPath,null,this.scope_id)&&WebSquare.ModelUtil.setInstanceValue(e.checkboxDisableXPath,this.options.checkboxDisabledTrueValue):null!=WebSquare.ModelUtil.findInstanceNode(e.checkboxDisableXPath,null,this.scope_id)&&WebSquare.ModelUtil.setInstanceValue(e.checkboxDisableXPath,this.options.checkboxDisabledFalseValue),this.stopRefresh(!1)),!0===i||!1===i)for(var s=0;s<e.childNodes.length;s++){var o=e.childNodes[s];this.disableCheckbox(o,t,i)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.checkByIndex=function(e,t,i){try{var s=this.tree.findNodeByIndex(e);if(!s)return;this.checkNode(s.index,t,i)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.checkByValue=function(e,t,i){try{var s=this.tree.findNodeByValue(e);if(!s)return;this.checkNode(s.index,t,i)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getParentValue=function(e){try{var t="",i=this.tree.findNodeByValue(e);return i&&i.parentNode&&(t=i.parentNode.value),t}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getChildData=function(e,t){try{for(var i=this.tree.findNodeByValue(e),s=[],o=0;o<i.childNodes.length;o++){if(1==this.options.dynamicAppend||this.useDataCollection){var l=this._getNodeXML(i.childNodes[o],!0);if(l instanceof WebSquare.Elem){var a=WebSquare.xmljs.json2xml(l._element);if(a){var h=WebSquare.xml.parse(a);h&&h.documentElement&&(l=h.documentElement)}}s.push(l)}else s.push(WebSquare.ModelUtil.findInstanceNode(i.childNodes[o].xpath,null,this.scope_id));1==t&&(s=s.concat(this.getChildData(i.childNodes[o].value,!0)))}return s}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getChildNodes=function(e,t){try{for(var i=this.tree.findNodeByValue(e),s=[],o=0;o<i.childNodes.length;o++)s.push(i.childNodes[o]),1==t&&(s=s.concat(this.getChildNodes(i.childNodes[o].value,!0)));return s}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getXPathByValue=function(e){try{return this.tree.findNodeByValue(e).xpath}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.nodeToHTML=function(e){try{if(!e)return"";return this.options.accessibility?this._nodeToHTMLForAccessibility(e,!1):this.nodeToHTMLForAsis(e)}catch(e){WebSquare.exception.printStackTrace(e,null,this)}},u.prototype.nodeToHTMLForAsis=function(e){try{if(!e)return"";e.rendered=!0;var t,i,s=[],o=this.options.asisAccessibility;if(this.options.customFormatter&&(this.tree.customFormatter=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id)),"function"==typeof this.tree.customFormatter){var l=this.tree.getCloneNode(e),h=this.tree.customFormatter.call(this,e.orgLabel,e.label,l)||e.label;t=this.options.escape?WebSquare.xml._encode(h):h,i=this.options.escape?WebSquare.xml._encode(e.value):e.value}else t=this.options.escape?WebSquare.xml._encode(e.label):e.label,i=this.options.escape?WebSquare.xml._encode(e.value):e.value;var r=a.Z.getDataPrefix("index"),d=a.Z.getDataPrefix("opened"),c=a.Z.getDataPrefix("treeNodeValue"),p=a.Z.getDataPrefix("label");o?s.push("<ol tabindex='-1' id='"+this.id+"_group_"+e.index+"' class='w2treeview_group' aria-expanded='true' "+r+"='"+e.index+"' label='"+t+"'>"):s.push("<div tabindex='-1' id='"+this.id+"_group_"+e.index+"' class='w2treeview_group' "+r+"='"+e.index+"' "+p+"='"+t+"'>"),s.push("<table id='"+this.id+"_node_"+e.index+"' "+c+"='"+i+"' "+r+"='"+e.index+"'");var u="";if(e.isLastChild()?u=" w2treeview_last_sibling":e.isFirstChild()&&(u=" w2treeview_first_sibling"),"string"==typeof e.nodeCss&&e.nodeCss&&(u+=" "+e.nodeCss),
e.hasChild()?e.depth>this.options.showTreeDepth||e.folder?s.push("class='w2treeview_node w2treeview_table_node w2treeview_notleaf w2treeview_close_child"+u+"'>"):s.push("class='w2treeview_node w2treeview_table_node w2treeview_notleaf w2treeview_open_child"+u+"' "+d+"='true'>"):e.isFirstChildByRoot()?1==e.parentNode.childNodes.length?s.push("class='w2treeview_node w2treeview_table_node w2treeview_root_single_leaf w2treeview_open_child"+u+"'>"):s.push("class='w2treeview_node w2treeview_table_node w2treeview_root_multi_leaf w2treeview_open_child"+u+"'>"):e.isLastChild()?s.push("class='w2treeview_node w2treeview_table_node w2treeview_leaf w2treeview_last_leaf w2treeview_open_child"+u+"'>"):s.push("class='w2treeview_node w2treeview_table_node w2treeview_leaf w2treeview_open_child"+u+"'>"),s.push("<tr class='w2treeview_row_parent w2treeview_row_depth"+e.depth+"'>"),1==this.options.lineShow?s.push("<td id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_col_icon_navi'><div class='w2treeview_icon_navi'></div></td>"):e.isLeaf()?o?s.push("<td id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_col_icon_navi'></td>"):s.push("<td id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_col_icon_navi'><div class='w2treeview_icon_none'></div></td>"):o?e.depth>this.options.showTreeDepth?s.push("<td id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_col_icon_navi'><img id='"+this.id+"_toggle_"+e.index+"' src='"+this.options.folderOpenToggleImage+"' class='w2treeview_icon_navi_img' /></td>"):s.push("<td id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_col_icon_navi'><img id='"+this.id+"_toggle_"+e.index+"' src='"+this.options.folderCloseToggleImage+"' class='w2treeview_icon_navi_img' /></td>"):s.push("<td id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_col_icon_navi'><div class='w2treeview_icon_navi'></div></td>"),""!=e.image){var f=e.image;1==e.hasChild()&&e.depth<=this.options.showTreeDepth&&(f=e.expandedImage);var g=e.imageTitle?"title='"+e.imageTitle+"'":"";s.push("<td class='w2treeview_col_icon_label'>"),s.push("<div id='"+this.id+"_icon_"+e.index+"' class='w2treeview_icon_label'"+g+" style='background-image:url("+f+")'></div>"),s.push("</td>")}else s.push("<td class='w2treeview_none'></td>");1==this.options.showCheckbox&&(s.push("<td class='w2treeview_col w2treeview_col_icon_checkbox'>"),a.Z.isIE()?s.push("<div style='left:0px;top:-1px;' class='w2treeview_partialdiv'>"):s.push("<div style='left:4px;top:-1px;' class='w2treeview_partialdiv'>"),1==e.checked?1==e.checkboxDisabled?s.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' checked='true' disabled='true' id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox' />"):s.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' checked='true' id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox' />"):1==e.checkboxDisabled?1==e.partial?s.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' checked='true' disabled='true' id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox w2treeview_partialselect' />"):s.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' disabled='true' id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox' /></div>"):1==e.partial?s.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' checked='true' id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox w2treeview_partialselect' />"):s.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox' />"),s.push("          </div>"),s.push("      </td>"));var m="";if("object"==typeof e.labelStyle){var b="";for(var v in e.labelStyle)b+=v+":"+e.labelStyle[v]+";";m=" style='"+b+"'"}
if(-1!=this.options.rowHeight?s.push("<td class='w2treeview_col_label' style='height:"+this.options.rowHeight+"px;'><span id='"+this.id+"_label_"+e.index+"' class='w2treeview_label "+this.options.labelclass+"'"+m+">"+t+"</span></td>"):s.push("<td class='w2treeview_col_label'><span id='"+this.id+"_label_"+e.index+"' class='w2treeview_label "+this.options.labelclass+"'"+m+">"+t+"</span></td>"),s.push("</tr>"),e.hasChild()||1==this.options.dynamicAppend){if(s.push("<tr class='w2treeview_row_child'>"),0==this.options.lineShow||e.isLastChild()?s.push("<td id='"+this.id+"_guideline_"+e.index+"' class='w2treeview_noguideline w2treeview_col_depth"+e.depth+"'></td>"):s.push("<td id='"+this.id+"_guideline_"+e.index+"' class='w2treeview_guideline w2treeview_row_depth"+e.depth+"'></td>"),1==this.options.showCheckbox?s.push("<td colspan='3'>"):s.push("<td colspan='2'>"),e.depth>this.options.showTreeDepth?s.push("<div id='"+this.id+"_child_"+e.index+"' class='w2treeview_child w2treeview_none'>"):s.push("<div id='"+this.id+"_child_"+e.index+"' class='w2treeview_child'>"),!e.folder&&(1==this.options.alwaysDraw||e.depth<=this.options.showTreeDepth))for(var x=0;x<e.childNodes.length;x++)s.push(this.nodeToHTML(e.childNodes[x]));s.push("</div>"),s.push("</td>"),s.push("</tr>")}return s.push("</table>"),o?s.push("</ol>"):s.push("</div>"),s.join("")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._rootNodeToHTMLForAccessibility=function(e){try{if(!e)return"";var t=[],i=a.Z.getDataPrefix("index"),s=a.Z.getDataPrefix("opened");if(this.tree.rootNode.childNodes.length>0){t.push("<ul role='tree' "+s+"='true' class='w2treeview_group' id='"+this.id+"_RootNode_"+(e.index+1)+"' "+i+"='"+(e.index+1)+"'>");for(var o=0;o<this.tree.rootNode.childNodes.length;o++)t.push(this._nodeToHTMLForAccessibility(this.tree.rootNode.childNodes[o],!0));t.push("</ul>")}return t.join("")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._nodeToHTMLForAccessibility=function(e,t){try{if(!e)return"";e.rendered=!0;var i,s,o=[];if(this.options.customFormatter&&(this.tree.customFormatter=a.Z.getGlobalFunction(this.options.customFormatter,this.scope_id)),"function"==typeof this.tree.customFormatter){var l=this.tree.getCloneNode(e),h=this.tree.customFormatter.call(this,e.orgLabel,e.label,l)||e.label;i=this.options.escape?WebSquare.xml._encode(h):h,s=this.options.escape?WebSquare.xml._encode(e.value):e.value}else i=this.options.escape?WebSquare.xml._encode(e.label):e.label,s=this.options.escape?WebSquare.xml._encode(e.value):e.value;var r=a.Z.getDataPrefix("index"),c=a.Z.getDataPrefix("treeNodeValue"),p=a.Z.getDataPrefix("opened"),u="w2treeview_open_child";""==this.options.iconNaviAriaLabel?d.B.getMessage("Treeview_iconNaviAriaLabel"):this.options.iconNaviAriaLabel;if(!t){o.push("<ul id='"+this.id+"_node_"+e.index+"' "+c+"='"+s+"' "+r+"='"+e.index+"' ");var f="";e.isLastChild()?f=" w2treeview_last_sibling":e.isFirstChild()&&(f=" w2treeview_first_sibling"),"string"==typeof e.nodeCss&&e.nodeCss&&(f+=" "+e.nodeCss),e.hasChild()?e.depth>this.options.showTreeDepth||e.folder?(o.push("class='w2treeview_group w2treeview_notleaf w2treeview_close_child"+f+"'>"),u="w2treeview_close_child"):(o.push("class='w2treeview_group w2treeview_notleaf w2treeview_open_child"+f+"' "+p+"='true'>"),u="w2treeview_open_child"):e.isFirstChildByRoot()?(1==e.parentNode.childNodes.length?o.push("class='w2treeview_group w2treeview_root_single_leaf w2treeview_open_child"+f+"'>"):o.push("class='w2treeview_group w2treeview_root_multi_leaf w2treeview_open_child"+f+"'>"),u="w2treeview_open_child"):e.isLastChild()?(o.push("class='w2treeview_group w2treeview_leaf w2treeview_last_leaf w2treeview_open_child"+f+"'>"),u="w2treeview_open_child"):(o.push("class='w2treeview_group w2treeview_leaf w2treeview_open_child"+f+"'>"),u="w2treeview_open_child")}if(e.hasChild()){var g;e.depth>this.options.showTreeDepth||e.folder?(u="w2treeview_close_child",g=""):(u="w2treeview_open_child",g=p+"='true'"),
o.push("<li "+c+"='"+s+"' "+g+" id='"+this.id+"_node_"+e.index+"' class='w2treeview_group w2treeview_node "),o.push(u+" w2treeview_row_parent w2treeview_row_depth"+e.depth+"' "+r+"='"+e.index+"'")}else{var m="";this.options.lineShow||(m=" paddingLeft"),o.push("<li "+c+"='"+s+"' "+p+"='true' id='"+this.id+"_node_"+e.index+"' class='w2treeview_node "),o.push(u+m+" w2treeview_row_parent w2treeview_row_depth"+e.depth+"' "+r+"='"+e.index+"'")}if(o.push(" role='none'"),o.push(">"),e.isLeaf()){if(this.options.lineShow)if(1==e.depth)e.isFirstChild()?o.push("<span id='"+this.id+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline root_first'></span>"):e.isLastChild()?o.push("<span id='"+this.id+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline last'></span>"):o.push("<span id='"+this.id+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline middle'></span>");else{o.push("<span id='"+this.id+"_treeview_noguidline_"+e.index+"' class='w2span w2treeview_guideline first'></span>");var b=e,v=e.depth-2,x=[];for(A=0;A<v;A++){var _=b.parentNode,w=this._getBrotherNextNode(_);_&&w?x.push("<span id='"+this.id+"_leaf_treeview_guidline_"+A+"_"+e.index+"' class='w2span w2treeview_guideline'></span>"):x.push("<span id='"+this.id+"_leaf_treeview_noguidline_"+A+"_"+e.index+"' class='w2span w2treeview_noguideline'></span>"),b=_}for(A=x.length-1;A>=0;A--)o.push(x[A]);e.isLastChild()?o.push("<span id='"+this.id+"_treeview_guidline_leaf"+e.index+"' class='w2span w2treeview_guideline last'></span>"):o.push("<span id='"+this.id+"_treeview_guidline_leaf"+e.index+"' class='w2span w2treeview_guideline middle'></span>")}}else{if(this.options.lineShow)if(e.isFirstChild()){if(e.depth>1)if(e.isLastChild())if(e.parentNode.isLastChild()){b=e,v=e.depth-2;for(A=0;A<v;A++)o.push("<span id='"+this.id+"_"+A+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline'></span>");o.push("<span id='"+this.id+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_noguideline'></span>")}else o.push("<span id='"+this.id+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline'></span>");else{b=e,v=e.depth,x=[];for(A=0;A<v-1;A++){b=b.parentNode;w=this._getBrotherNextNode(b);b&&w?x.push("<span id='"+this.id+"_"+A+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline'></span>"):x.push("<span id='"+this.id+"_"+A+"_treeview_noguidline_"+e.index+"' class='w2span w2treeview_noguideline'></span>")}for(A=x.length-1;A>=0;A--)o.push(x[A])}e.isLastChild()}else{e.depth>1&&o.push("<span id='"+this.id+e.depth+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline first'></span>");b=e,v=e.depth-2;for(A=0;A<v;A++){b=b.parentNode;w=this._getBrotherNextNode(b);b&&w?o.push("<span id='"+this.id+"_"+A+"_treeview_guidline_"+e.index+"' class='w2span w2treeview_guideline'></span>"):o.push("<span id='"+this.id+"_"+A+"_treeview_noguidline_"+e.index+"' class='w2span w2treeview_noguideline'></span>")}}o.push("<button tabindex = '-1' aria-hidden = 'true' id='"+this.id+"_col_icon_navi_"+e.index+"' class='w2treeview_icon_navi_s' "+r+"='"+e.index+"'"),o.push("></button>")}if(""!=e.image){var y=e.image;1==e.hasChild()&&e.depth<=this.options.showTreeDepth&&(y=e.expandedImage);var I=e.imageTitle?"title='"+e.imageTitle+"'":"";o.push("<div class='w2treeview_col_icon_label'>"),o.push("<div id='"+this.id+"_icon_"+e.index+"' class='w2treeview_icon_label'"+I+" style='background-image:url("+y+")'></div>"),o.push("</div>")}else o.push("<div class='w2treeview_none'></div>");if(1==this.options.showCheckbox){var N=this.id+"_checkbox_"+e.index,k=i;o.push("<div class='w2treeview_checkbox'>"),o.push("<div>");var C=e.checked||e.partial?"checked='true' ":"",S=e.checkboxDisabled?"disabled='true' ":"",T=e.partial?" treeview_partialselect":"";o.push("<input tabindex = '-1' aria-hidden = 'true' "+r+"='"+e.index+"' style='"+this.checkboxStyle+"' type='checkbox' "+C+S),
o.push(" id='"+this.id+"_checkbox_"+e.index+"' class='w2treeview_checkbox"+T+"' />"),o.push("<label for='"+N+"'>"+k+"</label>"),o.push("          </div>"),o.push("      </div>")}var D="";if("object"==typeof e.labelStyle){var E="";for(var B in e.labelStyle)E+=B+":"+e.labelStyle[B]+";";D=" style='"+E+"'"}if(o.push("<a href='JavaScript:void(null);'"+c+"='"+s+"' "+r+"='"+e.index+"' id='"+this.id+"_label_"+e.index+"'"),-1!=this.options.rowHeight&&o.push(" style='height:"+this.options.rowHeight+"px;'"),o.push(" aria-level='"+e.depth+"'"),o.push(" aria-setsize='"+e.parentNode.childNodes.length+"'"),o.push(" aria-posinset='"+e.depthIndex+"'"),e.isLeaf()||("w2treeview_open_child"==u?o.push(" aria-expanded='true'"):o.push(" aria-expanded='false'")),1==this.options.showCheckbox&&o.push(" aria-checked='false'"),o.push(" aria-selected='false'"),o.push(" role='treeitem'"),o.push(" class='w2anchor2 w2treeview_label "+this.options.labelclass+"'"+D+">"+i+"</a>"),e.hasChild()||1==this.options.dynamicAppend){o.push("<ul role='group' id='"+this.id+"_child_"+e.index+"' "+c+"='"+s+"' "+r+"='"+e.index+"' ");f="",m="";if(e.isLastChild()?f=1==e.depth?" w2treeview_last_sibling ByRoot":" w2treeview_last_sibling":e.isFirstChild()&&(f=" w2treeview_first_sibling"),this.options.lineShow||(m=" paddingLeft"),e.hasChild()?e.depth>this.options.showTreeDepth||e.folder?o.push("class='w2treeview_group w2treeview_notleaf w2treeview_close_child"+f+m+"'>"):o.push("class='w2treeview_group w2treeview_notleaf w2treeview_open_child"+f+m+"'>"):e.isFirstChildByRoot()?1==e.parentNode.childNodes.length?o.push("class='w2treeview_group w2treeview_root_single_leaf w2treeview_open_child"+f+m+"'>"):o.push("class='w2treeview_group w2treeview_root_multi_leaf w2treeview_open_child"+f+m+"'>"):e.isLastChild()?o.push("class='w2treeview_group w2treeview_leaf w2treeview_last_leaf w2treeview_open_child"+f+m+"'>"):o.push("class='w2treeview_group w2treeview_leaf w2treeview_open_child"+f+m+"'>"),!e.folder&&(1==this.options.alwaysDraw||e.depth<=this.options.showTreeDepth)&&e.childNodes.length>0)for(var A=0;A<e.childNodes.length;A++)o.push(this._nodeToHTMLForAccessibility(e.childNodes[A],!0));o.push("</ul>")}return o.push("</li>"),t||o.push("</ul>"),o.join("")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.toggleChild=function(e,t,i){try{if(null==t&&(t=-1),null!=e)(s=this.tree.findNodeByValue(e))&&(t=s.index);var s=this.tree.findNodeByIndex(t),o=a.Z.getDataPrefix("opened");if(s&&s.depth>0&&s.hasChild()){var l=document.getElementById(this.id+"_node_"+t),h=document.getElementById(this.id+"_child_"+t),r=document.getElementById(this.id+"_icon_"+t),d=(document.getElementById(this.id+"_col_icon_navi_"+t),document.getElementById(this.id+"_label_"+t));if(l&&h){if(!!!(s.childNodes&&s.childNodes[0]&&s.childNodes[0].rendered)||this.options.asisAccessibility){for(var c=[],p=0;p<s.childNodes.length;p++)this.options.accessibility?c.push(this._nodeToHTMLForAccessibility(s.childNodes[p],!0)):c.push(this.nodeToHTML(s.childNodes[p]));h.innerHTML=c.join("")}var u=a.Z.getBoolean(l.getAttribute(o));if(void 0!==i&&null!=i||(i=0==u),s.folder=!i,this.tree.dataPath.folder){var f=i?this.options.falseValue:this.options.trueValue,g=this.modelControl.getDataComp();g&&g.setCellData(s.index-1,this.tree.dataPath.folder,f)}if(1==i){if(1==this.options.accordion){for(var m={},b=s;b.parentNode;)m[(b=b.parentNode).index]=b.depth;for(var p in this.openedNodes)this.openedNodes[p]==s||m[this.openedNodes[p].index]||this.openedNodes[p].depth<=s.depth&&this.toggleChild(null,p,!1);this.openedNodes[t]=s}if(l.setAttribute(o,"true"),h.style.display="block",this.changeClass(l,"w2treeview_close_child","w2treeview_open_child"),this.options.accessibility&&d.setAttribute("aria-expanded","true"),r&&(r.style.backgroundImage="url("+s.expandedImage+")"),this.options.asisAccessibility)(v=document.getElementById(this.id+"_toggle_"+t))&&(v.src=this.options.folderCloseToggleImage)
;"show"==this.options.animation.toLowerCase()?$("#"+h.id).hide().show("fast"):"fadein"==this.options.animation.toLowerCase()?$("#"+h.id).hide().fadeIn("fast"):"slidedown"==this.options.animation.toLowerCase()&&$("#"+h.id).hide().slideDown("fast")}else if(0==i){var v;if(l.setAttribute(o,"false"),this.openedNodes[t]&&delete this.openedNodes[t],""!=this.options.animation?"fadein"==this.options.animation.toLowerCase()?$("#"+h.id).fadeOut("fast"):"slidedown"==this.options.animation.toLowerCase()?$("#"+h.id).slideUp("fast"):h.style.display="none":h.style.display="none",this.changeClass(l,"w2treeview_open_child","w2treeview_close_child"),this.options.accessibility&&d.setAttribute("aria-expanded","false"),r&&(r.style.backgroundImage="url("+s.image+")"),this.options.asisAccessibility)(v=document.getElementById(this.id+"_toggle_"+t))&&(v.src=this.options.folderOpenToggleImage),WebSquare.removeChildren(h)}}}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.spanAll=function(e){try{if(1==this.options.accordion){var t=WebSquare.language.getMessage("Treeview_warning2","spanAll")||"The spanAll API is not supported in treeview's accordion mode.";return void $l(t+"["+this.id+"]")}if(1==e)for(var i=0;i<this.tree.size();i++)this.toggleChild(null,i,e);else if(0==e)for(i=this.tree.size()-1;i>=0;i--)this.toggleChild(null,i,e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.spanNode=function(e,t,i){try{return 0===arguments.length?void 0:1===arguments.length&&"object"==typeof arguments[0]?this._spanNode(arguments[0]):2===arguments.length&&"object"==typeof arguments[0]&&"boolean"==typeof arguments[1]?this._spanNode(arguments[0],arguments[1]):this._spanNode({index:e,applyChildNodes:i},t)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._spanNode=function(e,t){try{if(1==this.options.accordion){var i=WebSquare.language.getMessage("Treeview_warning2","spanNode")||"The spanNode API is not supported in treeview's accordion mode.";return void $l(i+"["+this.id+"]")}var s=e.index,o=e.depth,l=e.applyChildNodes;if(0==s||s){var a=(c=this.findNodeByIndex(s)).childNodes;if(1==t){if(1==l)for(var h=0;h<a.length;h++)a[h].childNodes.length>0&&this.spanNode(a[h].index,t,l)}else if(0==t&&1==l)for(h=a.length-1;h>=0;h--)a[h].childNodes.length>0&&this.spanNode(a[h].index,t,l);this.toggleChild(null,s,t)}else if(0==o||o)for(var r=0,d=this.tree.nodeCount;r<d;r++){var c;if((c=this.tree.hash_index_node[r]).depth===o){if("boolean"==typeof l)for(var p=c.childNodes,u=(h=0,p.length);h<u;h++)p[h].childNodes.length>0&&this.spanNode(p[h].index,t,l);this.toggleChild(null,c.index,t)}}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.showTooltip=function(e,t,i){try{null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var s=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var h=o.I.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(h){var r=a.Z.getGlobalFunction(h,s.scope_id),d=!0;if("function"==typeof r&&(d=r(s)),!d)return}}catch(e){n.Y.printStackTrace(e)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2treeview_tooltip "+this.options.tooltipClass}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.options.tooltipGroupClass||this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i,this.isFireTooltipEvent||(this.isFireTooltipEvent=!0,l.f.fireEvent(this,"ontooltipshow"))})),1e3*this.options.tooltipTime)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.hideTooltip=function(){try{
this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&(this.tooltip.setStyle("display","none"),l.f.fireEvent(this,"ontooltiphide"),this.isFireTooltipEvent=!1)})),1e3*this.options.tooltipTime)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setXML=function(e){try{var t=null;if(1==this.tree.isInstance){var i=this.tree.getNodeset(),s=WebSquare.xml.findNodes(e,i);"recursive"==this.options.dataType?t=this.tree.parseRecursiveToTree(s):"listed"==this.options.dataType&&(t=this.tree.parseListToTreeInstance(s))}else{var o=WebSquare.xmljs.xml2json(e).E[0];s=new WebSquare.Elem(o).getChildNodes();"recursive"==this.options.dataType?t=this.tree.parseRecursiveToTree(s):"listed"==this.options.dataType&&(t=this.tree.parseListToTree(s))}this.tree.setXML(t),this.drawContents()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.activateDrag=function(e){try{l.f.stopEvent(e),1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll();var t=this,i=this.event.getTargetIterator(e,this.render);if(i.element.id===this.id)return;for(var s=!1,o=!1,h=!1,r=!1,d=a.Z.getDataPrefix("index"),c=a.Z.getDataPrefix("tdIndex");i.next();)if(i.match("w2treeview_label")&&(r=!0),(i.match("w2treeview_icon_navi")||i.match("w2treeview_icon_navi_img"))&&(s=!0),i.match("w2treeview_icon_label")&&(o=!0),i.match("w2treeview_checkbox")&&(h=!0),i.match("w2treeview_node")){var p=i.getElement().getAttribute(d);if(null==p){i.stop();break}if("onmousedown"==this.options.toggleButtonEvent){var u=this.tree.findNodeByIndex(p);if(s&&!u.isLeaf()){this.toggleChild(null,p);var f=!!(u.childNodes&&u.childNodes[0]&&u.childNodes[0].rendered);this.inlineElement?l.f.fireEvent(this,"ontoggleclick",null,p,f):l.f.fireEvent(this,"ontoggleclick",u.element,p,f)}}if(r||h||o||s)if(this.options.accessibility){var g={};g.isCheckbox=h,g.isLabel=r,g.isIconNavi=s,this._selectNodeForAccessibilityWithTrust(null,p,!1,!0,g)}else this.selectNode1(null,p,!1,!0);if(1==this.options.useDrag){var m=this.getSelectedLabel();WebSquare.dragdrop.gDragManager.activate(e,i.getElement(),{id:this.id+"_drag",className:"w2treeview_drag",contents:m,delay:15,dropClass:"w2treeview_node",dragoverClass:"w2treeview_label",applyMousePosition:!0,onDrop:function(e,i,s,o,n,h,r){if(e){var p=null,u={},f=null,g=null,m=null;for(u=i?new WebSquare.targetIterator(i,t.render):t.event.getTargetIterator(r);u.next();){if(u.match("w2treeview")){var b=u.getElement().id;a.Z.getComponentById(b)&&(p=a.Z.getComponentById(b)),u.stop()}if(u.match("w2grid")&&(f=u.getElement().id,u.stop()),!g&&u.match(null,null,"td")){var v=u.getElement();g=parseInt(v.getAttribute(c),10)}}if(u=null,p&&!i&&(i=document.getElementById(p.id+"_node_0")),e&&i&&p){var x=e.getAttribute(d),_=i.getAttribute(d),w=t.tree.findNodeByIndex(x),y=p.tree.findNodeByIndex(_);l.f.fireEvent(p,"ondrop",w,y,t,p,r)}if(null!=f&&(m=(f=a.Z.getComponentById(f)).getDataLength(),null!=g&&(m=f.rowIndex+parseInt(g/(f.oneRowDataLength+f.defaultColCnt)))),e&&f){x=parseInt(e.getAttribute(d),10)-1;if(t.useDataCollection)var I=t.modelControl.getDataComp();w=t.tree.findNodeByIndex(x+1);l.f.fireEvent(f,"ondropfromtree",{dataListId:I.id,fromRowIndex:x,toRowIndex:m,dragNode:w})}}},onDragover:function(e,i,s,o,n,h,r){if(e)if(i){for(var c=null,p=new WebSquare.targetIterator(i,t.render);p.next();)if(p.match("w2treeview")){var u=p.getElement().id;a.Z.getComponentById(u)&&(c=a.Z.getComponentById(u)),p.stop()}if(p=null,c){var f=e.getAttribute(d),g=i.getAttribute("id"),m=g.substring(g.lastIndexOf("_")+1,g.length),b=t.tree.findNodeByIndex(f),v=c.tree.findNodeByIndex(m);l.f.fireEvent(c,"ondragover",b,v,t,c,r)}}else l.f.fireEvent(t,"ondragleave",r)}})}i.stop()}i=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.appendXmlNodes=function(e,t){try{this.appendData(e.index,t,!0)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.appendNode=function(e,t){try{if(0==this.options.dynamicAppend){
var i=WebSquare.language.getMessage("Treeview_warning1")||"If you are processing the treeview dynamically, it is recommended to set dynamicAppend='true'";$l(i+"["+this.id+"]")}if(1==this.options.dynamicAppend){var s=e.childNodes?e.childNodes.length+1:1;e.appendChild(this.tree.parseNodeByNode(t,e.depth+1,s,e));for(var o=0;o<e.childNodes.length;o++)this.tree.setRender(e.childNodes[o],!1);this.refreshNaviIcon(e),e.childNodes.length>0&&(e.childNodes[0].rendered=!1,this.toggleChild(null,e.index,!0))}else e.appendChild(t),this.drawContents()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.refreshNaviIcon=function(e){try{if(!e)return;var t=e.index,i=document.getElementById(this.id+"_node_"+t),s=document.getElementById(this.id+"_col_icon_navi_"+t);e.childNodes.length>0?this.options.asisAccessibility?s&&(s.innerHTML="<img id='"+this.id+"_toggle_"+t+"' src='"+this.options.folderOpenToggleImage+"' class='w2treeview_icon_navi_img' />"):(i&&this.removeClass(i,"w2treeview_leaf"),i&&this.removeClass(i,"w2treeview_last_leaf"),i&&this.removeClass(i,"w2treeview_root_single_leaf"),i&&this.removeClass(i,"w2treeview_root_multi_leaf"),e.isFirstChildByRoot()?1==e.parentNode.childNodes.length?s&&this.changeClass(s,"w2treeview_first_leaf","w2treeview_icon_navi"):s&&this.changeClass(s,"w2treeview_root_multi_leaf","w2treeview_icon_navi"):e.isLastChild()?s&&this.changeClass(s,"w2treeview_last_leaf","w2treeview_icon_navi"):s&&this.changeClass(s,"w2treeview_leaf","w2treeview_icon_navi")):this.options.asisAccessibility?s&&(s.innerHTML="<img id='"+this.id+"_toggle_"+t+"' src='"+this.options.leafToggleImage+"' class='w2treeview_icon_navi_img' />"):i&&this.changeClass(i,"w2treeview_notleaf","w2treeview_leaf")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.removeNode=function(e){try{if(!e)return;var t=e.parentNode;if(t){var i=t.index;if(t.removeChild(e),1==this.options.dynamicAppend){var s=e.index,o=document.getElementById(this.id+"_group_"+s);o&&WebSquare.removeChildren(o),0==i?(t._hasChild=t.folder?null:0!=t.childNodes.length,this.drawContents()):this.refreshNaviIcon(t)}else this.drawContents()}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.removeNodeList=function(e){try{for(var t=0;t<e.length;t++)if(e[t]){var i=e[t].parentNode;i&&i.removeChild(e[t])}this.drawContents()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.initRenderStatus=function(){try{this.tree.setRender(this.tree.rootNode,!1)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getCheckedNodeByType=function(e,t){try{"object"==typeof e&&null!=e||(e={});for(var i=[],s=this.tree.getNodeIterator({type:"bfs"});s.next();){var o=s.getNode();(1==o.checked||e.hierarchy&&1==o.partial&&!o.isRoot())&&(e.excludeRoot&&!o.isRoot()||!e.excludeRoot)&&i.push(o[t])}return i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getCheckedValues=function(e){return this.getCheckedNodeByType(e,"value")},u.prototype.getCheckedLabels=function(e){return this.getCheckedNodeByType(e,"label")},u.prototype.getCheckedIndexes=function(e){return this.getCheckedNodeByType(e,"index")},u.prototype.getCheckedNodes=function(e){return this.getCheckedNodeByType(e,"element")},u.prototype.expandNode=function(e,t){try{if("number"==typeof e?this.toggleChild(null,e,!0):this.toggleChild(e,null,!0),t){var i=null;i="number"==typeof e?this.tree.findNodeByIndex(e):this.tree.findNodeByValue(e);for(var s=0;s<i.childNodes.length;s++)this.expandNode(i.childNodes[s].index,t)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.collapseNode=function(e,t){try{if(t){var i=null;i="number"==typeof e?this.tree.findNodeByIndex(e):this.tree.findNodeByValue(e);for(var s=0;s<i.childNodes.length;s++)this.collapseNode(i.childNodes[s].index,t)}"number"==typeof e?this.toggleChild(null,e,!1):this.toggleChild(e,null,!1)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getAllXML=function(){try{var e=null
;return"recursive"==this.options.dataType?e=this.tree.rootNode.element:"listed"==this.options.dataType&&(e=this.tree.parseTreeToList()),e}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.stopRefresh=function(e){try{this.refreshStop=a.Z.getBoolean(e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getNextNode=function(e){for(var t=e.index,i=e.depth,s=document.getElementById(this.id+"_node_"+t),o=a.Z.getDataPrefix("opened"),n=a.Z.getBoolean(s.getAttribute(o)),l=this.tree.getNodeIterator({type:"dfs"}),h=!1;l.next();){var r=l.getNode();if(h){if(n)break;if(r.depth<=i)break}else r.index==t&&(h=!0)}return l.getNode()},u.prototype.getPreviousNode=function(e){for(var t=null,i=e.index,s=this.tree.getNodeIterator({type:"dfs"}),o={};s.next();){var n=s.getNode();if(n.index==i)return t;if(this.options.asisAccessibility)document.getElementById(this.id+"_group_"+n.index)&&(t=n);else{var l=document.getElementById(this.id+"_node_"+n.index),h=a.Z.getDataPrefix("opened"),r=!!l&&a.Z.getBoolean(l.getAttribute(h));o[n.parentNode?n.parentNode.depth:0]||0==n.depth?(0==n.depth&&(r=!0),o[n.depth]=r,t=n):o[n.depth]=!1}}return t},u.prototype.handleToggleEvent=function(e){try{for(var t=!1,i=this.event.getTargetIterator(e,this.render);i.next();)if(i.match("w2treeview_label")&&(t=!0),t&&i.match("w2treeview_node")){var s=a.Z.getDataPrefix("index"),o=i.getElement().getAttribute(s);this.toggleChild(null,o),i.stop()}i=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleDblclickEvent=function(e){try{for(var t=!1,i=this.event.getTargetIterator(e,this.render);i.next();)if(i.match("w2treeview_label")&&(t=!0),t&&i.match("w2treeview_node")){var s=a.Z.getDataPrefix("index"),o=i.getElement().getAttribute(s),h=this.tree.findNodeByIndex(o).value;l.f.fireEvent(this,"ondblclick",h,o),i.stop()}i=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleClickEvent=function(e){try{for(var t=!1,i=!1,s=!1,h=!1,r=a.Z.getDataPrefix("index"),d=a.Z.getDataPrefix("treeNodeValue"),c=this.event.getTargetIterator(e,this.render);c.next();)if(c.match("w2treeview_label")&&(h=!0),(c.match("w2treeview_icon_navi")||c.match("w2treeview_icon_navi_img")||c.match("w2treeview_icon_navi_s"))&&(t=!0),c.match("w2treeview_icon_label")&&(i=!0),c.match("w2treeview_checkbox")&&(s=!0),c.match("w2treeview_node")){var p=c.getElement().getAttribute(d),u=c.getElement().getAttribute(r),f=this.tree.findNodeByIndex(u),g=this._getNodeXML(f);if(t&&!f.isLeaf()&&"onmousedown"!=this.options.toggleButtonEvent){this.toggleChild(null,u);var m=!!(f.childNodes&&f.childNodes[0]&&f.childNodes[0].rendered);this.inlineElement?l.f.fireEvent(this,"ontoggleclick",null,u,m):l.f.fireEvent(this,"ontoggleclick",g,u,m)}if(s&&!f.checkboxDisabled){var b=!f.checked;this.checkNode(u,b),this.inlineElement?l.f.fireEvent(this,"oncheckboxclick",p,null,u):1==this.options.dynamicAppend||this.useDataCollection?l.f.fireEvent(this,"oncheckboxclick",p,g,u):l.f.fireEvent(this,"oncheckboxclick",p,WebSquare.ModelUtil.findInstanceNode(f.xpath,null,this.scope_id),u)}h&&(this.inlineElement?l.f.fireEvent(this,"onlabelclick",p,null,u):l.f.fireEvent(this,"onlabelclick",p,g,u)),i&&(this.inlineElement?l.f.fireEvent(this,"onImageclick",p,null,u):l.f.fireEvent(this,"onImageclick",p,g,u));var v=o.I.getConfiguration("/WebSquare/treeview/useClickEventToggleButton/@value");if(h||s||i||t&&"false"!=v){if(this.options.accessibility){var x={};x.isLabel=h,h&&this._selectNodeForAccessibilityWithTrust(null,u,!1,!1,x)}else this.selectNode1(null,u,!1,this.options.noFocusOnIconLabelClick);l.f.fireEvent(this,"onclick",p,u)}c.stop()}c=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleMouseoverEvent=function(e){try{l.f.stopEvent(e);for(var t=a.Z.getDataPrefix("index"),i=a.Z.getDataPrefix("treeNodeValue"),s=this.event.getTargetIterator(e,this.render);s.next();)if(s.match("w2treeview_label")){if(this.addClass(s.getElement(),"w2treeview_over"),this.options.tooltipDisplay||this.options.tooltipShowAlways){
var o=s.getElement(),h=WebSquare.style.getAbsoluteLeft(o),r=WebSquare.style.getAbsoluteTop(o),d=o.innerHTML,c=WebSquare.style.getAbsoluteLeft(this.render),p=!1;if(this.options.tooltipDisplay)if(h+o.offsetWidth>c+this.render.clientWidth+this.render.scrollLeft)p=!0;else if(a.Z.isIEAllVersion()&&!a.Z.isIE(6)&&!a.Z.isIE(7)){var u=o.style.display;o.style.display="block",o.clientWidth<o.scrollWidth&&(p=!0),o.style.display=u}if(p||this.options.tooltipShowAlways){var f=a.Z.getGlobalFunction(this.options.tooltipFormatter,this.scope_id);if("function"==typeof f){for(var g=new WebSquare.targetIterator(o,this.render),m=-1;g.next();)g.match("w2treeview_node")&&(m=g.getElement().getAttribute(t),g.stop());g=null;try{d=f(d,m,!!p||o.offsetWidth<o.scrollWidth)}catch(e){n.Y.printStackTrace(e,null,this)}}""!=d&&this.showTooltip(h,r,d)}}g=new WebSquare.targetIterator(s.getElement(),this.render),m=-1;for(var b="",v=null;g.next();)g.match("w2treeview_node")&&(m=g.getElement().getAttribute(t),b=g.getElement().getAttribute(i),v=this.tree.findNodeByIndex(m),g.stop());g=null,l.f.fireEvent(this,"onlabelover",m,this._getNodeXML(v),b)}s=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleMouseoutEvent=function(e){try{l.f.stopEvent(e),(this.options.tooltipDisplay||this.options.tooltipShowAlways)&&this.hideTooltip();for(var t=this.event.getTargetIterator(e,this.render);t.next();)t.match("w2treeview_label")&&this.removeClass(t.getElement(),"w2treeview_over");t=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleContextmenuEvent=function(e){try{l.f.stopEvent(e);for(var t=!1,i=!1,s=!1,o=!1,h=a.Z.getDataPrefix("index"),r=this.event.getTargetIterator(e,this.render);r.next();){if(r.match("w2treeview_label")&&(o=!0),r.match("w2treeview_icon_navi")&&(t=!0),r.match("w2treeview_icon_label")&&(i=!0),r.match("w2treeview_checkbox")&&(s=!0),r.match("w2treeview_node")){var d=r.getElement().getAttribute(h);if(t&&this.toggleChild(null,d),s){var c=document.getElementById(this.id+"_checkbox_"+d).checked;this.checkNode(d,c)}(o||s||i)&&(this.selectNode1(null,d),l.f.fireEvent(this,"onrightbuttonclick",this.findNodeByIndex(d),l.f.getMouseX(e),l.f.getMouseY(e))),r.stop()}r.match("w2treeview")&&this.tree.nodeCount<=1&&(l.f.fireEvent(this,"onrightbuttonclick",null,l.f.getMouseX(e),l.f.getMouseY(e)),r.stop())}r=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleIconNaviFocusEvent=function(e){try{var t={};t.isIconNavi=!0,this.options.autoSelectByFocus&&this._selectNodeForAccessibilityWithTrust(null,1,!1,!1,t)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleKeydownAccessbilityEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode,i=0,s=null,o=a.Z.getDataPrefix("index"),h=a.Z.getDataPrefix("treeNodeValue");i=(s=e.srcElement||e.target).getAttribute(o);var r=this.tree.findNodeByIndex(i),d=s.getAttribute(h),c=null,p={};0==i?(i=1,c=this.tree.findNodeByIndex(i)):s.id.indexOf("_col_icon_navi_")>-1?p.isIconNavi=!0:s.id.indexOf("_label_")>-1?p.isLabel=!0:s.id.indexOf("_checkbox_")>-1&&(p.isCheckbox=!0);var u=!(13!==t||!p.isIconNavi);if(37===t||39===t||u){var f=37!==t;13===t?this.toggleChild(null,i,null):this.toggleChild(null,i,f);var g=!!(r.childNodes&&r.childNodes[0]&&r.childNodes[0].rendered);this.inlineElement?l.f.fireEvent(this,"ontoggleclick",null,i,g):l.f.fireEvent(this,"ontoggleclick",r.element,i,g),l.f.stopEvent(e)}else if(13===t&&p.isLabel)this._selectNodeForAccessibilityWithTrust(null,i,!1,!1,p),this.inlineElement?l.f.fireEvent(this,"onlabelclick",d,null,i):l.f.fireEvent(this,"onlabelclick",d,r.element,i),l.f.fireEvent(this,"onclick"),l.f.stopEvent(e);else if(32===t&&p.isLabel){var m=document.getElementById(this.id+"_checkbox_"+i);m&&m.click()}else if(38===t){if((p.isIconNavi||p.isLabel||p.isCheckbox)&&(c=this.getPreviousNode(r)),c){var b=c.index
;document.getElementById(this.id+"_label_"+b)&&(this.options.autoSelectByFocus?this._selectNodeForAccessibilityWithTrust(null,b,!1,!1,p):this._focusNodeForAccessibilityWithTrust(null,b,!1,!1,p)),l.f.stopEvent(e)}}else if(40===t){if((p.isIconNavi||p.isLabel||p.isCheckbox)&&(c=this.getNextNode(r)),c){b=c.index;document.getElementById(this.id+"_label_"+b)&&(this.options.autoSelectByFocus?this._selectNodeForAccessibilityWithTrust(null,b,!1,!1,p):this._focusNodeForAccessibilityWithTrust(null,b,!1,!1,p)),l.f.stopEvent(e)}}else if(9===t&&this.options.autoSelectByFocus&&(c=null)){b=c.index;document.getElementById(this.id+"_label_"+b)&&this._selectNodeForAccessibilityWithTrust(null,b,!1,!0,p)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleKeydownEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode,i=0,s=null,o=a.Z.getDataPrefix("index");this.selectedInfo.node?(s=this.selectedInfo.groupDom,i=this.selectedInfo.node.index):i=(s=e.srcElement||e.target).getAttribute(o);var h=this.tree.findNodeByIndex(i);if(37===t||39===t||13===t){var r=37!==t;13===t?this.toggleChild(null,i,null):this.toggleChild(null,i,r);var d=!!(h.childNodes&&h.childNodes[0]&&h.childNodes[0].rendered);this.inlineElement?l.f.fireEvent(this,"ontoggleclick",null,i,d):l.f.fireEvent(this,"ontoggleclick",h.element,i,d),l.f.stopEvent(e)}else if(38===t){var c=null;if(0==i?(i=1,c=this.tree.findNodeByIndex(i)):s.id.indexOf("_group_")>-1&&(c=this.getPreviousNode(h)),c){var p=c.index;document.getElementById(this.id+"_group_"+p)&&this.selectNode1(null,p,!1),l.f.stopEvent(e)}}else if(40===t){c=null;if(0==i?(i=1,c=this.tree.findNodeByIndex(i)):s.id.indexOf("_group_")>-1&&(c=this.getNextNode(h)),c){p=c.index;document.getElementById(this.id+"_group_"+p)&&this.selectNode1(null,p,!1),l.f.stopEvent(e)}}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.onPropertyChange=function(e,t){try{if("disabled"===e)this.options.disabled=t,t?this.addClass(this.render,"w2treeview_disabled"):this.removeClass(this.render,"w2treeview_disabled")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setDisabled=function(e){e=a.Z.getBoolean(e);var t=r.q.prototype.setDisabled.call(this,e);return this.disableCheckbox(this.tree.rootNode,e,!0),t},u.prototype.setEditMode=function(e){try{var t=document.getElementById(this.id+"_label_"+e);if(null==this.editModeComp||null==this.editModeComp.render){this.editModeComp=new WebSquare.uiplugin.input(this.id+"_input"),this.editModeComp.writeTo(t.parentNode),this.editModeComp.activate();var i=this.uuid;this.editModeComp.bind("onblur",(function(){var e=WebSquare.idCache[i],t=e.modelControl.getDataComp();if(t){var s=this._oldValue,o=this.getValue();t.setCellData(this._index-1,e.tree.dataPath.label,o)}else e.setLabelByIndex(this._index-1,o);e.appendChild(this),this.hide();var n=document.getElementById(e.id+"_label_"+this._index);WebSquare.style.show(n),this.setValueNM(""),l.f.fireEvent(e,"oneditend",{oldValue:s,newValue:o,index:this._index})})),this.editModeComp.bind("onkeydown",(function(e){l.f.stopPropagation(e)})),this.editModeComp.bind("onmousedown",(function(e){l.f.stopPropagation(e)})),this.editModeComp.bind("onselectstart",(function(e){l.f.stopPropagation(e)}))}else this.editModeComp.show(),t.parentNode.appendChild(this.editModeComp.render);this.editModeComp._index=e,WebSquare.style.hide(t),this.editModeComp.setVerticalAlign=function(){};var s=this.findNodeByIndex(e);s&&""!=s.label&&(this.editModeComp.setValueNM(s.label),this.editModeComp._oldValue=s.label),this.editModeComp.focus()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.finalize=function(){r.q.removeCheckResize(this.uuid),null!=this.editModeComp&&WebSquare.idCache[this.editModeComp.uuid]&&this.editModeComp.remove()},u.prototype.notifyValidCheck=function(e){try{if(e.colID===this.tree.dataPath.depth){var t=this.findNodeByIndex(e.rowIndex+1);if(e.newValue<1)throw{message:"Invalid value : [label : "+t.label+", newDepth : "+e.newValue+"]. The depthValue must be greater than 0."
};if(e.oldValue&&e.newValue>e.oldValue&&t.isFirstChild())throw{message:"Invalid value : [label : "+t.label+", newDepth : "+e.newValue+"]. The depthValue must be less than "+(e.oldValue+1)}}else if(e.colID===this.tree.dataPath.value){t=this.findNodeByIndex(e.rowIndex+1);if(this.findNodeByValue(e.newValue))throw{message:"Invalid value : [value : "+t.value+", newValue : "+e.newValue+"]. The treeValue must be unique."}}return!0}catch(e){return n.Y.printStackTrace(e,null,this),!1}},u.prototype.notifyInvalid=function(){},u.prototype.notifySetCellData=function(e,t,i,s){try{if(this.refreshStop||parseInt(s,10)===parseInt(i,10))return;if(t===this.tree.dataPath.label)this.setLabelByIndex(e+1,i,!0);else if(t===this.tree.dataPath.checkbox)i==this.options.trueValue?this.checkNode(e+1,!0):i==this.options.falseValue&&this.checkNode(e+1,!1);else if(t===this.tree.dataPath.depth){if(Math.abs(i-s)>1)return void this.refreshItemset();this.stopRefresh(!0),this.notifyDepthChanged(e+1,i,s),this.stopRefresh(!1);var o=this.findNodeByIndex(e+1);o.parentNode===this.tree.rootNode?this.drawContents():(this.refreshNaviIcon(o),this.toggleChild(null,o.parentNode.index,!0))}else t===this.tree.dataPath.value&&this.setValueByIndex(e+1,i,!0)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyDepthChanged=function(e,t,i){try{var s=this.findNodeByIndex(e),o=this.modelControl.getDataComp();if(t>i){var l=(d=s.parentNode).childNodes[s.depthIndex-2],a=s.childNodes.splice(0,s.childNodes.length);d.childNodes.splice(s.depthIndex-1,1),s.parentNode=l,l.childNodes.push(s),s.depthIndex=l.childNodes.length,l.rendered=!1,s.rendered=!1;for(var h=0;h<a.length;h++)a[h].parentNode=l,l.childNodes.push(a[h]),a[h].depthIndex=l.childNodes.length,a[h].rendered=!1;d.childNodes[0].rendered=!1}else{if(s.hasChild())for(h=s.childNodes.length-1;h>=0;h--){var r=s.childNodes[h];o.setCellData(r.index-1,this.tree.dataPath.depth,r.depth-1),this.notifyDepthChanged(r.index,r.depth-1,r.depth)}var d,c=(d=s.parentNode).parentNode;if(s.depthIndex<d.childNodes.length){var p=d.childNodes.splice(s.depthIndex,d.childNodes.length-s.depthIndex);for(h=0;h<p.length;h++)p[h].parentNode=s,s.childNodes.push(p[h]),p[h].depthIndex=s.childNodes.length,p[h].rendered=!1}d.childNodes.splice(d.childNodes.length-1,1),s.parentNode=c,c.childNodes.splice(d.depthIndex,0,s);for(h=d.depthIndex;h<c.childNodes.length;h++)c.childNodes[h].depthIndex=h+1;c.childNodes[0].rendered=!1}s.depth=t,s.element.setAttribute(o.options.valueAttribute,t)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyInsertRow=function(e){try{if(this.refreshStop)return;var t=this.modelControl.getDataComp(),i=this.findNodeByIndex(e),s=new c;s.index=e+1,s.depthIndex=1,s.depth=i.depth+1,s.rendered=!1,s.parentNode=i;for(var o=t.getRowCount();o>=e+2;o--)this.tree.changeNodeIndex(o-1,o);this.tree.hash_index_node[e+1]=s,t.setCellData(e,this.tree.dataPath.depth,i.depth+1,null,!0);var l=t.getRowJSON(e),a={T:1,N:"data",A:{index:""+e},E:[]};for(var h in l){var r={T:1,N:h,A:{},parent:a};""!=l[h]&&(r.E=[],r.E.push({T:3,text:""+l[h]})),a.E.push(r)}s.element=new WebSquare.Elem(a),i.childNodes.unshift(s);for(o=1;o<i.childNodes.length;o++)i.childNodes[o].depthIndex=o+1;this.refreshNaviIcon(i),this.toggleChild(null,e,!0),this.tree.nodeCount=t.getRowCount()+1}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyInsertData=function(e,t){try{this.refreshItemset()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyBeforeSetRowData=function(e,t){try{if(this.refreshStop)return;var i=this.modelControl.getDataComp();this.beforeSetRowData=t?{depth:i.getCellData(e,this.tree.dataPath.depth),label:i.getCellData(e,this.tree.dataPath.label),checkbox:i.getCellData(e,this.tree.dataPath.checkbox),value:i.getCellData(e,this.tree.dataPath.value),overwrite:t}:{depth:Number(i.getCellData(e-1,this.tree.dataPath.depth))+1,label:"",checkbox:"",value:i.getCellData(e,this.tree.dataPath.value),overwrite:t}}catch(e){n.Y.printStackTrace(e,null,this)}},
u.prototype.notifySetRowData=function(e){try{if(this.refreshStop)return;var t,i=(t=this.modelControl.getDataComp()).getCellData(e,this.tree.dataPath.depth),s=t.getCellData(e,this.tree.dataPath.label),o=t.getCellData(e,this.tree.dataPath.checkbox),l=t.getCellData(e,this.tree.dataPath.value);if(i!=this.beforeSetRowData.depth)if(this.notifyValidCheck({colID:this.tree.dataPath.depth,oldValue:this.beforeSetRowData.depth,newValue:i,rowIndex:e}))this.notifySetCellData(e,this.tree.dataPath.depth,i,this.beforeSetRowData.depth);else(t=this.modelControl.getDataComp()).setCellData(e,this.tree.dataPath.depth,this.beforeSetRowData.depth);if(s!=this.beforeSetRowData.label&&this.notifySetCellData(e,this.tree.dataPath.label,s,this.beforeSetRowData.label),l!=this.beforeSetRowData.value)this.notifyValidCheck({colID:this.tree.dataPath.value,oldValue:this.beforeSetRowData.value,newValue:l,rowIndex:e})&&this.notifySetCellData(e,this.tree.dataPath.value,l,this.beforeSetRowData.value);o!=this.beforeSetRowData.checkbox&&this.notifySetCellData(e,this.tree.dataPath.checkbox,o,this.beforeSetRowData.checkbox),this.beforeSetRowData={},this.tree.nodeCount=t.getRowCount()+1}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyRemoveRow=function(e){try{if(this.options.forceRefresh)return this.stopRefresh(!1),void this.refreshItemset();if(this.refreshStop)return;var t=this.findNodeByIndex(e+1),i=t.parentNode,s=document.getElementById(this.id+"_group_"+t.index);if(s&&WebSquare.removeNode(s),this.stopRefresh(!0),this.notifyRemoveRow_allChildren(e),this.stopRefresh(!1),0==i.index)i._hasChild=i.folder?null:0!=i.childNodes.length,this.drawContents();else{this.refreshNaviIcon(i);var o=this.findNodeByIndex(e);if(o&&!o.isRoot()){if(o.isLastChild()){var l=document.getElementById(this.id+"_node_"+o.index);this.addClass(l,"w2treeview_last_sibling"),this.removeClass(l,"w2treeview_first_sibling"),o.isLeaf()&&this.addClass(l,"w2treeview_last_leaf")}else if(o.isFirstChild()){l=document.getElementById(this.id+"_node_"+o.index);this.addClass(l,"w2treeview_first_sibling")}if(o.parentNode.isLastChild()){var a=document.getElementById(this.id+"_guideline_"+o.parentNode.index);this.removeClass(a,"w2treeview_guideline"),this.addClass(a,"w2treeview_noguideline")}}}var h=this.modelControl.getDataComp();this.tree.nodeCount=h?h.getRowCount()+1:this.tree.nodeCount}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyRemoveRow_allChildren=function(e){try{var t=this.findNodeByIndex(e+1),i=t.parentNode,s=this.modelControl.getDataComp(),o=e,l=s.getRowCount()+1,a=1;if(t.hasChild()){o=l-1;for(var h=t;!h.isRoot()&&h.depthIndex==h.parentNode.childNodes.length;)h=h.parentNode;h.isRoot()||h.depthIndex==h.parentNode.childNodes.length||(o=h.parentNode.childNodes[h.depthIndex].index-2);for(var r=[],d=e;d<o;d++)r.push(d),this.tree.clearNode(this.tree.findNodeByIndex(d+2)),a++;s.removeRows(r)}i.childNodes.splice(t.depthIndex-1,1);for(d=t.depthIndex-1;d<i.childNodes.length;d++)i.childNodes[d].depthIndex=d+1;this.tree.clearNode(t),this.selectedInfo={dom:null,node:null};for(d=o+2;d<=l;d++)this.tree.changeNodeIndex(d,d-a);this.tree.nodeCount=s.getRowCount()+1}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyDataChanged=function(e){try{this.stopRefresh(!1),this.refreshItemset()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.notifyRemovedRows=function(e,t){try{this.refreshItemset()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getDataListInfo=function(){try{if(this.modelControl.isDataCollectionItemsetBinded){var e={};return e.id=this.modelControl.dataCollectionItemsetInfo.dataComp.id,e.nodeset=this.modelControl.itemsetObj.nodeset,e.label=this.modelControl.itemsetObj.label,e.value=this.modelControl.itemsetObj.value,e}return null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getLastChildIndex=function(e){try{var t=this.findNodeByIndex(e),i=e;if(t.hasChild()){i=this.tree.nodeCount-1
;for(var s=t;!s.isRoot()&&s.depthIndex==s.parentNode.childNodes.length;)s=s.parentNode;s.isRoot()||s.depthIndex==s.parentNode.childNodes.length||(i=s.parentNode.childNodes[s.depthIndex].index-1)}return i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.moveNode=function(e,t,i){try{if(!this.useDataCollection)return!1;if(e==t)return!1;if(e<t&&this.getLastChildIndex(e)>=t)return h.v.printLog("treeview moveNode : Invalid argument. [destIndex] must not be child of [srcIndex].["+this.id+"]"),!1;if(1==this.options.moveSibling&&!i)return this._bAppendMoveNode(e,t);for(var s=this.modelControl.getDataComp(),o=e-1,l=t-1,a=this.findNodeByIndex(e),r=this.findNodeByIndex(t),d=this.getLastChildIndex(o+1)-1,c=[],p=this.tree.dataPath.depth,u=0,f=o;f<=d;f++){var g=s.getRowJSON(f);g[p]=i?Number(g[p])+(r.depth-a.depth+1):Number(g[p])+(r.depth-a.depth),"number"!==s.getColumnInfo(p).dataType&&(g[p]=g[p]+""),c.push(g),u++}this.stopRefresh(!0),s.removeRange(o,d),o<l&&(l+=o-d-1);var m=0;if(!i){var b=this.getLastChildIndex(t);m=b-t,t<=o&&b>=d&&(m-=u)}return s.insertJSON(l+1+m,c),this.stopRefresh(!1),this.refreshItemset(),this.selectNode(null,l+2+m),!0}catch(e){return n.Y.printStackTrace(e,null,this),!1}},u.prototype._bAppendMoveNode=function(e,t){try{for(var i=this.modelControl.getDataComp(),s=e-1,o=t-1,l=this.findNodeByIndex(e),a=this.findNodeByIndex(t),h=this.getLastChildIndex(s+1)-1,r=[],d={},c=this.tree.dataPath.depth,p=s;p<=h;p++){var u=i.getRowJSON(p);u[c]=Number(u[c])+(a.depth-l.depth),"number"!==i.getColumnInfo(c).dataType&&(u[c]=u[c]+""),r.push(u),d[p]=u}var f=0;if(s>o){var g=[];if((m=this.getLastChildIndex(t)-1)>=s)for(p=o;p<=m;p++)d[p]||g.push(i.getRowJSON(p));else{for(p=o;p<=s-1;p++)g.push(i.getRowJSON(p));f=h-s}}else{g=[];var m=this.getLastChildIndex(t)-1;for(p=h+1;p<=m;p++)g.push(i.getRowJSON(p))}this.stopRefresh(!0);var b=s<o?s:o,v=m<s?s+f:m+f;i.removeRange(b,v);var x=[];if(s>o){x=r.concat(g);var _=o+1}else{x=g.concat(r);_=e+g.length}return i.insertJSON(b,x),this.stopRefresh(!1),this.refreshItemset(),this.selectNode(null,_),!0}catch(e){return n.Y.printStackTrace(e,null,this),!1}},u.prototype.setNodeSet=function(e,t){try{var i=t||{},s=e;if(e.indexOf("data:")>=0&&(s=e.replaceAll("data:","")),this.modelControl.getDataComp(s)){for(var o in this.useDataCollection=e.match("data:"),this.modelControl.unbindItemset(),this.modelControl.setItemset("data:"+s,i.label,i.value),this.modelControl.dataCollectionBindItemset(),this.modelControl.getDataCollectionItemsetData(this.modelControl.id),t)"string"===t[o]&&t[o],this.tree.xpath[o]=t[o],this.tree.dataPath[o]=t[o],"checkbox"===o&&(this.tree.checkbox.colID=t[o],this.tree.checkbox.xpath=t[o]);this.successBinding=!1,this.tree.valueAttribute="",this.refreshItemset({setNodeSet:!0})}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.deselectNode=function(){try{if(this.selectedInfo&&this.selectedInfo.node){var e=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,t=a.Z.getBoolean(this.options.useHirarchySelect);if(this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.style.backgroundColor=this.originalBackgroundColor,this.selectedInfo.dom.style.color=this.originalColor),this.selectedInfo.node){var i=document.getElementById(this.id+"_icon_"+this.selectedInfo.node.index);i&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfo.node.selectedImage&&(i.style.backgroundImage=this.originalIconImage)}if(t&&this.selectedInfoStack.length>0){for(var s=0;s<this.selectedInfoStack.length;s++){var o=this.selectedInfoStack[s];o.dom&&(this.removeClass(o.dom,this.options.labelonClickClass),o.dom.style.backgroundColor=o.org.background,o.dom.style.color=o.org.color),o.icon&&this.tree.imageXPath.selectedImage&&""!=this.selectedInfo.node.selectedImage&&(o.icon.style.backgroundImage=o.org.iconImage)}this.selectedInfoStack=[]}l.f.fireEvent(this,"onchange",e,null),this.selectedInfo={groupDom:null,dom:null,node:null}}}catch(e){
n.Y.printStackTrace(e,null,this)}},u.prototype.setShowCheckBox=function(e){try{this.options.showCheckbox!=e&&(this.options.showCheckbox=e,this.drawContents())}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.checkResize=function(){try{if(this.render){var e=this.render.offsetWidth,t=this.render.offsetHeight;if(this.resizeObj&&e>0&&t>0){var i=e-this.resizeObj.width,s=t-this.resizeObj.height;0==i&&0==s||this.refreshItemset()}this.resizeObj={width:e,height:t}}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._getNodeXML=function(e,t){try{var i;if(!1===t||!0!==t&&!0!==this.options.useXML)i=e;else if(!this.inlineElement&&(i=e.element)instanceof WebSquare.Elem){var s=WebSquare.xmljs.json2xml(i._element);if(s){var o=WebSquare.xml.parse(s);o&&o.documentElement&&(i=o.documentElement)}}return i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._getDepth1ParentNode=function(e){try{for(var t=null,i=e.index,s=(e.depth,this.tree.getNodeIterator({type:"dfs"}));s.next();){var o,l=s.getNode();if(1==l.depth&&(!0,o=l),l.index==i){t=o;break}}return t}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._getBrotherNextNode=function(e){try{for(var t=null,i=e.index,s=e.depth,o=this.tree.getNodeIterator({type:"dfs"}),l=!1;o.next();){var a=o.getNode();if(l){if(a.depth==s){(1==s||this._getDepth1ParentNode(e)==this._getDepth1ParentNode(a))&&(t=a);break}}else a.index==i&&(l=!0)}return t}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setNodeClass=function(e,t,i){try{var s;if("object"==typeof e&&"number"==typeof e.index?s=e:"number"==typeof e?s=this.tree.findNodeByIndex(e):"string"==typeof e&&(s=this.tree.findNodeByValue(e)),!s||!t||"string"!=typeof t)return;if("string"==typeof s.nodeCss?-1===(" "+s.nodeCss+" ").indexOf(" "+t+" ")&&(s.nodeCss=(s.nodeCss+" "+t).replace(/\s\s/," ").wq_trim()):s.nodeCss=t,s.rendered){var o=document.getElementById(this.id+"_node_"+s.index);this.addClass(o,t)}if(!0===i)for(var l=0,a=s.childNodes.length;l<a;l++){var h=s.childNodes[l];this.setNodeClass(h,t,i)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.removeNodeClass=function(e,t,i){try{var s;if("object"==typeof e&&"number"==typeof e.index?s=e:"number"==typeof e?s=this.tree.findNodeByIndex(e):"string"==typeof e&&(s=this.tree.findNodeByValue(e)),!s)return;var o="string"==typeof i&&i?i:s.nodeCss;if(s.rendered){var l=document.getElementById(this.id+"_node_"+s.index);this.removeClass(l,o)}if("string"==typeof s.nodeCss&&"string"==typeof i?s.nodeCss=(" "+s.nodeCss+" ").replace(new RegExp(" "+i+" ","g")," ").replace(/\s\s/," ").wq_trim():s.nodeCss="",!0===t)for(var a=0,h=s.childNodes.length;a<h;a++){var r=s.childNodes[a];this.removeNodeClass(r,t,i)}}catch(e){n.Y.printStackTrace(e,null,this)}}}}]);