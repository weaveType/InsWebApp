<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper      
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"      
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
	@subject     : 공고정보 관련 처리를 담당하는 Sql Mapper
	@description : 공고정보 관련 처리를 담당하는 Sql Mapper
	@author      : Inswave
	@since       : 2025/07/03
	@modification
	===========================================================
	DATE              AUTHOR             DESC
	===========================================================
	2025/07/03              Inswave             최초 생성
 -->
<mapper namespace="com.demo.proworks.domain.post">
    <insert id="insertPost" parameterType="com.demo.proworks.domain.post.vo.PostVo">
    	<!-- 공고정보를 등록한다. -->	
    		
        INSERT INTO POSTS   /* QueryID : com.demo.proworks.domain.post.insertPost */
        ( 
            JOB_POSTING_ID
            <if test="companyId               != null"> , COMPANY_ID                </if>
            <if test="title                    != null"> , TITLE                     </if>
            <if test="description              != null"> , DESCRIPTION               </if>
            <if test="requiredSkills          != null"> , REQUIRED_SKILLS           </if>
            <if test="experienceLevel         != null"> , EXPERIENCE_LEVEL          </if>
            <if test="salaryRange             != null"> , SALARY_RANGE              </if>
            <if test="location                 != null"> , LOCATION                  </if>
            <if test="workType                != null"> , WORK_TYPE                 </if>
            <if test="preferredDeveloperTypes!= null"> , PREFERRED_DEVELOPER_TYPES </if>
            <if test="expiresAt               != null"> , EXPIRES_AT                </if>
            <if test="postedAt                != null"> , POSTED_AT                 </if>
            <if test="status                   != null"> , STATUS                    </if>
        )
        VALUES  
        ( 
            #{jobPostingId}
            <if test="companyId               != null"> , #{companyId}                </if>
            <if test="title                    != null"> , #{title}                     </if>
            <if test="description              != null"> , #{description}               </if>
            <if test="requiredSkills          != null"> , #{requiredSkills}           </if>
            <if test="experienceLevel         != null"> , #{experienceLevel}          </if>
            <if test="salaryRange             != null"> , #{salaryRange}              </if>
            <if test="location                 != null"> , #{location}                  </if>
            <if test="workType                != null"> , #{workType}                 </if>
            <if test="preferredDeveloperTypes!= null"> , #{preferredDeveloperTypes} </if>
            <if test="expiresAt               != null"> , #{expiresAt}                </if>
            <if test="postedAt                != null"> , #{postedAt}                 </if>
            <if test="status                   != null"> , #{status}                    </if> 
        )          
    </insert>	
	
    <update id="updatePost" parameterType="com.demo.proworks.domain.post.vo.PostVo">
    	<!-- 공고정보를 갱신한다. -->
    	
        UPDATE POSTS    /* QueryID : com.demo.proworks.domain.post.updatePost */      
      	  SET  
                JOB_POSTING_ID            = #{jobPostingId}                   	                       
            <if test="companyId               != null"> , COMPANY_ID                = #{companyId}                </if>
            <if test="title                    != null"> , TITLE                     = #{title}                     </if>
            <if test="description              != null"> , DESCRIPTION               = #{description}               </if>
            <if test="requiredSkills          != null"> , REQUIRED_SKILLS           = #{requiredSkills}           </if>
            <if test="experienceLevel         != null"> , EXPERIENCE_LEVEL          = #{experienceLevel}          </if>
            <if test="salaryRange             != null"> , SALARY_RANGE              = #{salaryRange}              </if>
            <if test="location                 != null"> , LOCATION                  = #{location}                  </if>
            <if test="workType                != null"> , WORK_TYPE                 = #{workType}                 </if>
            <if test="preferredDeveloperTypes!= null"> , PREFERRED_DEVELOPER_TYPES = #{preferredDeveloperTypes} </if>
            <if test="expiresAt               != null"> , EXPIRES_AT                = #{expiresAt}                </if>
            <if test="postedAt                != null"> , POSTED_AT                 = #{postedAt}                 </if>
            <if test="status                   != null"> , STATUS                    = #{status}                    </if>                 
        WHERE   
                JOB_POSTING_ID            = #{jobPostingId}           
    </update>
	
    <delete id="deletePost" parameterType="com.demo.proworks.domain.post.vo.PostVo">
    	<!-- 공고정보를 삭제한다. -->
    	
        DELETE FROM POSTS   /* QueryID : com.demo.proworks.domain.post.deletePost */ 
        WHERE   
                JOB_POSTING_ID            = #{jobPostingId}                   
    </delete>
	
    <select id="selectPost" parameterType="com.demo.proworks.domain.post.vo.PostVo" resultType="com.demo.proworks.domain.post.vo.PostVo">
    	<!-- 공고정보를 상세 조회한다. -->	
        SELECT     /* QueryID : com.demo.proworks.domain.post.selectPost */
            JOB_POSTING_ID as jobPostingId, COMPANY_ID as companyId, TITLE as title, DESCRIPTION as description, REQUIRED_SKILLS as requiredSkills, EXPERIENCE_LEVEL as experienceLevel, SALARY_RANGE as salaryRange, LOCATION as location, WORK_TYPE as workType, PREFERRED_DEVELOPER_TYPES as preferredDeveloperTypes, EXPIRES_AT as expiresAt, POSTED_AT as postedAt, STATUS as status
        FROM POSTS 
        WHERE 
                JOB_POSTING_ID            = #{jobPostingId}           			
    </select>
	
    <select id="selectListPost" parameterType="com.demo.proworks.domain.post.vo.PostVo" resultType="com.demo.proworks.domain.post.vo.PostVo">
    	<!-- 공고정보 목록을 조회한다. -->
           SELECT    /* QueryID : com.demo.proworks.domain.post.selectListPost */
               JOB_POSTING_ID as jobPostingId, COMPANY_ID as companyId, TITLE as title, DESCRIPTION as description, REQUIRED_SKILLS as requiredSkills, EXPERIENCE_LEVEL as experienceLevel, SALARY_RANGE as salaryRange, LOCATION as location, WORK_TYPE as workType, PREFERRED_DEVELOPER_TYPES as preferredDeveloperTypes, EXPIRES_AT as expiresAt, POSTED_AT as postedAt, STATUS as status		       
           FROM (
               SELECT  S.*, CEIL( (@ROWNUM:=@ROWNUM+1) / #{pageSize} ) AS PAGE
               FROM (				
                   SELECT 
                       *  		                  
                   FROM POSTS
                   WHERE  1=1    		
	     																														
               ) S, (SELECT @ROWNUM := 0) TMP
           ) A
            WHERE PAGE = #{pageIndex}
    </select>
	
    <select id="selectListCountPost" parameterType="com.demo.proworks.domain.post.vo.PostVo" resultType="long">
    <!-- 공고정보 목록의 카운트를 조회한다. -->
    
         SELECT    /* QueryID : com.demo.proworks.domain.post.selectListCountPost */
             COUNT(*) totcnt  		                  
         FROM POSTS
         WHERE  1=1    		

    </select>

</mapper>
