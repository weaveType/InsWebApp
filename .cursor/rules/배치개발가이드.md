{
  "문서정보": {
    "제목": "ProWorks5 프레임워크 배치 개발 가이드",
    "설명": "ProWorks5 프레임워크를 활용한 배치 개발 방법 및 구현 가이드",
    "활용대상자": [
      "시스템 관리자",
      "시스템 개발자"
    ]
  },

  "소개": {
    "개요": "Spring 배치 기반 아키텍처 위에 ProWorks5 특화 구조와 IO에디터 연계 Reader/Writer 제공",
    "특징": [
      "빠르고 구조화된 배치 개발 지원",
      "IO에디터와 연계된 Reader/Writer 제공",
      "Spring 배치 기반 아키텍처",
      "전용 Launcher 제공"
    ]
  },

  "배치아키텍처": {
    "배치작업정의": {
      "설명": "일괄처리를 위한 아키텍처",
      "특성": [
        "대량의 데이터 처리",
        "특정시간/데몬 형태 실행",
        "일괄적 처리"
      ]
    },
    
    "아키텍처구조": {
      "기반": "Spring 배치 아키텍처 + ProWorks 전용 Launcher",
      "동작방식": [
        "외부 스케줄러 → 업무Shell 호출",
        "Shell → 표준화된 실행 결과 리턴",
        "Job Invoke Shell을 통한 실행 환경 구성",
        "IO 에디터 작성 VO를 통한 ItemReader/Writer Mapper 기능"
      ],
      "특화기능": [
        "VO, FLD(Fixed Length), Delimiter 자동 변환",
        "표준화된 실행 결과 처리",
        "환경 변수 설정 분리"
      ]
    }
  },

  "구성요소": {
    "Spring배치기본요소": {
      "Job": {
        "설명": "배치 처리 과정을 하나의 단위로 만들어 표현한 객체",
        "예시": [
          "파일처리Job",
          "DB동기화Job",
          "데이터변환Job"
        ]
      },
      "Step": {
        "설명": "Batch job을 구성하는 독립적인 하나의 단계",
        "예시": [
          "데이터읽기Step",
          "데이터가공Step", 
          "데이터쓰기Step"
        ]
      },
      "ExecutionContext": {
        "설명": "Key-value 쌍으로 정보 저장, Framework 관리, 영속성 유지",
        "범위": "JobInstance scope"
      },
      "Item": {
        "설명": "처리할 데이터의 가장 작은 구성 요소",
        "예시": [
          "파일의 한 줄",
          "DB의 한 Row",
          "XML의 특정 element"
        ]
      },
      "Chunk": {
        "설명": "하나의 Transaction 안에서 처리된 Item들",
        "기능": "Commit Interval 정의를 통한 트랜잭션 범위 지정"
      }
    },
    
    "ProWorks배치전용요소": {
      "Shell": {
        "설명": "배치 기동을 위한 쉘",
        "역할": "환경 변수 설정 및 JobLauncher 호출"
      },
      "JobLauncher": {
        "설명": "배치 기동을 위한 Java main() 포함 클래스",
        "특징": "ProWorks5 전용 런처 제공"
      },
      "선후처리": {
        "설명": "메인 Job 호출 전/후 적용되는 기능",
        "용도": "공통 기능 처리"
      }
    },
    
    "데이터처리요소": {
      "ItemReader": {
        "설명": "Step 내에서 입력값을 불러오는 역할",
        "동작": "순차적 값 리턴, 더 이상 Item 없으면 null 반환"
      },
      "ItemProcessor": {
        "설명": "ItemReader로부터 가져온 데이터 가공 역할",
        "선택성": "필수 요소 아님"
      },
      "ItemWriter": {
        "설명": "ItemReader 또는 ItemProcessor로부터 전달받은 데이터 쓰기 역할"
      },
      "Tasklet": {
        "설명": "단순 작업 처리하는 Step 내 사용 요소",
        "적합용도": [
          "System command 실행",
          "Store procedure 실행"
        ]
      },
      "Partitioner": {
        "설명": "병렬 처리용 요소",
        "동작방식": "Master가 Partitioner로 slave 작업 분할, 멀티쓰레드 동시 동작"
      }
    }
  },

  "개발환경": {
    "기본구성": {
      "개발툴": "Eclipse 기반 Plugin (온라인 개발과 동일)",
      "형상관리": "SVN Repository",
      "프로젝트구조": "Maven 기반"
    },
    
    "디렉토리구조": {
      "src/main/java": {
        "설명": "자바 소스 위치",
        "주의사항": "컴파일된 클래스는 실행 환경 시 ClassPath 포함 필요"
      },
      "src/main/resources": {
        "설명": "어플리케이션 리소스 위치",
        "포함내용": "배치 구성 환경 설정 및 Job 구성",
        "하위구조": {
          "batch/Config": {
            "설명": "Spring Batch 구성 환경",
            "관리자": "배치 구성 관리자만 변경 가능"
          },
          "batch/Data": {
            "설명": "배치 샘플의 Input/output 폴더"
          },
          "batch/Job": {
            "설명": "Spring 기반 Job 정의 폴더",
            "필수사항": "Abstract/InswaveJobBase.xml 반드시 import"
          },
          "batch/properties": {
            "설명": "Job 정의 환경 변수 Properties 파일",
            "기본파일": "globals.properties"
          },
          "batch/sh": {
            "설명": "배치 구동 shell 파일",
            "프레임워크Shell": "inc/inswaveInvokeBatch.sh"
          },
          "message": {
            "설명": "Exception 발생 시 메시지 정의 프로퍼티"
          },
          "properties": {
            "설명": "프레임워크 필요 Properties 설정"
          },
          "sqlmap": {
            "설명": "MyBatis 매퍼파일, 업무 SQL 작성",
            "구조": "자바 소스 패키지 구조와 동일"
          }
        }
      }
    }
  },

  "배치개발": {
    "개발Object": {
      "Vo": {
        "설명": "파일/DB IO 처리 Format 정의",
        "제공형식": [
          "FLD(Fixed Length)",
          "Delimiter"
        ],
        "상위클래스": {
          "Body": "com.inswave.elfw.core.BatchVO",
          "Header": "com.inswave.elfw.core.BatchHeadVO",
          "Tail": "com.inswave.elfw.core.BatchTailVO"
        }
      },
      "Job": {
        "설명": "Spring Batch Job 정의 XML",
        "구성요소": [
          "ItemReader",
          "ItemProcessor", 
          "ItemWriter"
        ]
      },
      "ItemProcessor": {
        "설명": "데이터 가공 처리 Java 객체",
        "필수성": "선택사항"
      },
      "Partitioner": {
        "설명": "병렬 처리 Java 객체",
        "필수성": "선택사항"
      },
      "DAO": {
        "설명": "DB 데이터 접근 트랜잭션 객체",
        "필수성": "선택사항 (Job XML에서 직접 SQL ID 처리 가능)"
      },
      "SQL": {
        "설명": "MyBatis Mapper",
        "기능": "파라미터 및 결과값 매핑"
      },
      "Shell": {
        "설명": "배치 구동 Shell",
        "작성단위": "Job ID별",
        "포함내용": "Job ID 등 환경 설정만 포함"
      }
    }
  },

  "구현절차": {
    "개발순서": [
      "VO 작성",
      "SQL 작성 (필요시 DAO 포함)",
      "JOB 작성", 
      "ItemProcessor (필요시)",
      "Shell 작성",
      "테스트 (개발서버)"
    ],
    
    "상세구현": {
      "VO작성": {
        "Body설정": {
          "상위클래스": "com.inswave.elfw.core.BatchVO"
        },
        "Header설정": {
          "상위클래스": "com.inswave.elfw.core.BatchHeadVO"
        },
        "Tail설정": {
          "상위클래스": "com.inswave.elfw.core.BatchTailVO"
        },
        "FixedLength설정": {
          "체크항목": "FLD전문사용",
          "필드설정": "FLD전문 = Yes",
          "추가정보": "길이 정보 입력"
        },
        "Delimiter설정": {
          "체크항목": "Delimiter전문사용",
          "필드설정": "Del전문 = Yes"
        }
      },
      
      "JOB작성": {
        "ItemReader": {
          "FLD": {
            "class": "com.inswave.elfw.batch.io.ElDefaultFldLineMapper",
            "설정항목": {
              "vo": "읽을 FLD 포맷 VO 클래스명",
              "encode": "인코딩 처리 문자열",
              "voHead": "헤더 VO 클래스명",
              "headerLine": "헤더 라인수",
              "voTail": "테일 VO 클래스명",
              "tailLineOfHeadFieldName": "Body 카운트 필드명",
              "tailLineIncludeHeadLine": "헤더 라인 포함 여부",
              "HeadPrefix": "헤더 Prefix 문자열",
              "TailPrefix": "테일 Prefix 문자열"
            }
          },
          "Delimiter": {
            "class": "com.inswave.elfw.batch.io.ElDefaultDelimeterLineMapper",
            "설정항목": {
              "vo": "읽을 Delimiter 포맷 VO 클래스명",
              "delimiter": "필드 구분자",
              "encode": "인코딩 처리 문자열",
              "voHead": "헤더 VO 클래스명",
              "headerLine": "헤더 라인수",
              "voTail": "테일 VO 클래스명"
            }
          }
        },
        
        "ItemWriter": {
          "FLD": {
            "class": "com.inswave.elfw.batch.io.ElDefaultDelimeterLineAggregator",
            "설정항목": {
              "vo": "FLD 포맷 VO 클래스명",
              "encode": "인코딩 처리 문자열"
            }
          },
          "Delimiter": {
            "class": "com.inswave.elfw.batch.io.ElDefaultDelimeterLineAggregator",
            "설정항목": {
              "vo": "Delimiter 포맷 VO 클래스명",
              "delimiter": "필드 구분자",
              "encode": "인코딩 처리 문자열"
            }
          }
        }
      },
      
      "ItemProcessor작성": {
        "인터페이스": "org.springframework.batch.item.ItemProcessor",
        "제네릭타입": "com.inswave.elfw.core.CommVO",
        "구현메소드": "process",
        "입출력타입": "com.inswave.elfw.core.CommVO"
      },
      
      "Shell작성": {
        "필수작성항목": [
          "상단 주석 부분 각 항목 설명",
          "업무 선/후처리 구현체 설정 (BIZ_PRE_POST_PROCESS)",
          "작성된 JOB 설정 (RUN_JOB_LOAD_XML)",
          "JOB ID 설정 (RUN_JOB_ID)",
          "로그레벨 설정 (BATCH_LOG_LEVEL)",
          "SQL 로그 설정 (SQL_LOG_TRACE_YN)"
        ],
        "호출구조": "업무Shell → inc/inswaveInvokeBatch.sh"
      }
    }
  },

  "테스트": {
    "테스트환경": "개발서버",
    "사전조건": "개발 리소스가 개발서버에 모두 반영되어 있어야 함",
    "반영방법": "[Inswave Frame – 서버반영]",
    "실행방법": {
      "Shell위치": "{개발서버 대상 배치 프로젝트}/res/inswave/batch/sh/{대상 Shell}",
      "실행명령": "sh {대상 Shell} 인자",
      "인자형식": "sh {대상 shell} {key}={value} {key}={value}",
      "실행예시": "sh test.sh \"ename=이름\" \"job=직업\""
    },
    "로그확인": {
      "로그위치": "{프로젝트 로그 홈}/app/{JOB ID}/app.log",
      "로그특징": "날짜별 회차별 app.log로 새로 생성"
    }
  },

  "배치샘플": {
    "샘플구성": "Shell로 시작되며 연결된 모든 소스 포함 제공",
    "샘플목록": [
      {
        "항목": "File To File (Delimiter)",
        "Shell": "01_Basic_DelToDelJob.sh",
        "설명": "Delimiter 파일에서 읽어서 Delimiter 파일로 기록"
      },
      {
        "항목": "File To File (FLD)",
        "Shell": "01_Basic_FldToFldJob.sh", 
        "설명": "FLD 파일에서 읽어서 FLD 파일로 기록"
      },
      {
        "항목": "Header/Tail (Delimiter)",
        "Shell": "02_HeadTail_1_DelToDelJob.sh",
        "설명": "Header/Tail 처리 포함, 헤더 라인수 설정 및 body 카운트로 Tail 시작 판단"
      },
      {
        "항목": "Header/Tail (FLD)",
        "Shell": "02_HeadTail_1_FldToFldJob.sh",
        "설명": "Header/Tail 처리 포함하는 FLD 예제"
      },
      {
        "항목": "Header/Tail (Prefix)",
        "Shell": "02_HeadTail_2_DelToDelJob.sh",
        "설명": "라인의 Prefix를 통해 처리하는 Delimiter 예제"
      },
      {
        "항목": "DB To DB (Parameter)",
        "Shell": "03_Param_DbToDbJob.sh",
        "설명": "Shell로부터 파라미터를 전달받아 처리"
      },
      {
        "항목": "Delimiter To DB",
        "Shell": "04_HeadTail_DelToDbJob.sh",
        "설명": "헤더와 테일 처리를 포함하는 예제"
      },
      {
        "항목": "DB To FLD (Multi Step)",
        "Shell": "05_MultiStep_DbToFldJob.sh",
        "설명": "멀티 Step을 처리하는 예제"
      },
      {
        "항목": "DB To DB (Processor)",
        "Shell": "06_Process_DbToDbJob.sh",
        "설명": "Processor 내에 로직을 포함하는 예제"
      },
      {
        "항목": "DB To DB (Partitioner)",
        "Shell": "07_Partitioner_DbToDbJob.sh",
        "설명": "고성능을 요하는 일부 배치용 Spring Partitioner 예제"
      }
    ]
  },

  "주의사항": [
    "배치 구성 관리자만 Config 설정 변경 가능",
    "Abstract/InswaveJobBase.xml 반드시 import 필요",
    "SQL 로그는 대량처리 시 시스템 자원 과부하 주의",
    "JVM_PARAM 설정 시 시스템팀 문의 필수",
    "모든 개발 리소스는 개발서버 반영 후 테스트 수행"
  ]
}